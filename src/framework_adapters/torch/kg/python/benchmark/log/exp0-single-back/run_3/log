Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
random partition 483142 edges into 3 parts
part 0 has 161048 edges
part 1 has 161048 edges
part 2 has 161046 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=False, batch_size=1000, batch_size_eval=16, data_files=None, data_path='data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=3, num_proc=3, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='ckpts/TransE_l1_FB15k_9', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 0.984 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 1][Train](1000/10000) average pos_loss: 0.16471784929186106
[proc 1][Train](1000/10000) average neg_loss: 0.1890043899193406
[proc 1][Train](1000/10000) average loss: 0.17686111965030432
[proc 1][Train](1000/10000) average regularization: 1.231191182978364e-05
[proc 1][Train] 1000 steps take 16.447 seconds
[proc 1] 1000 steps, sample: 1.833, forward: 7.281, backward: 2.605, update: 4.720
[proc 0][Train](1000/10000) average pos_loss: 0.17215593532472848
[proc 0][Train](1000/10000) average neg_loss: 0.19473343398422002
[proc 0][Train](1000/10000) average loss: 0.18344468461722135
[proc 0][Train](1000/10000) average regularization: 1.227589894006087e-05
[proc 0][Train] 1000 steps take 16.516 seconds
[proc 0] 1000 steps, sample: 1.865, forward: 7.329, backward: 2.623, update: 4.674
[proc 2][Train](1000/10000) average pos_loss: 0.16461402408778666
[proc 2][Train](1000/10000) average neg_loss: 0.18904950284212826
[proc 2][Train](1000/10000) average loss: 0.17683176377415658
[proc 2][Train](1000/10000) average regularization: 1.2318495926137985e-05
[proc 2][Train] 1000 steps take 16.445 seconds
[proc 2] 1000 steps, sample: 1.866, forward: 7.002, backward: 2.571, update: 4.912
[proc 0][Train](2000/10000) average pos_loss: 0.06544407676532865
[proc 0][Train](2000/10000) average neg_loss: 0.095666563808918
[proc 0][Train](2000/10000) average loss: 0.08055532040074467
[proc 0][Train](2000/10000) average regularization: 1.706305366496963e-05
[proc 0][Train] 1000 steps take 14.150 seconds
[proc 0] 2000 steps, sample: 1.791, forward: 4.923, backward: 2.688, update: 4.740
[proc 1][Train](2000/10000) average pos_loss: 0.06552351927012205
[proc 1][Train](2000/10000) average neg_loss: 0.09540528412908315
[proc 1][Train](2000/10000) average loss: 0.08046440156549216
[proc 1][Train](2000/10000) average regularization: 1.703148709020752e-05
[proc 1][Train] 1000 steps take 14.151 seconds
[proc 1] 2000 steps, sample: 1.785, forward: 4.926, backward: 2.677, update: 4.740
[proc 2][Train](2000/10000) average pos_loss: 0.06551836537569761
[proc 2][Train](2000/10000) average neg_loss: 0.09573431040346622
[proc 2][Train](2000/10000) average loss: 0.08062633793801069
[proc 2][Train](2000/10000) average regularization: 1.7023594124111697e-05
[proc 2][Train] 1000 steps take 14.150 seconds
[proc 2] 2000 steps, sample: 1.778, forward: 4.643, backward: 2.627, update: 4.927
[proc 1][Train](3000/10000) average pos_loss: 0.05579265583306551
[proc 1][Train](3000/10000) average neg_loss: 0.08340954036265612
[proc 1][Train](3000/10000) average loss: 0.06960109816491604
[proc 1][Train](3000/10000) average regularization: 1.8901727637057775e-05
[proc 1][Train] 1000 steps take 13.964 seconds
[proc 1] 3000 steps, sample: 1.760, forward: 4.886, backward: 2.682, update: 4.627
[proc 2][Train](3000/10000) average pos_loss: 0.05601692057400942
[proc 2][Train](3000/10000) average neg_loss: 0.08394953406602144
[proc 2][Train](3000/10000) average loss: 0.06998322728276253
[proc 2][Train](3000/10000) average regularization: 1.8910285007223138e-05
[proc 2][Train] 1000 steps take 13.963 seconds
[proc 2] 3000 steps, sample: 1.786, forward: 4.625, backward: 2.659, update: 4.879
[proc 0][Train](3000/10000) average pos_loss: 0.05570076157525182
[proc 0][Train](3000/10000) average neg_loss: 0.08398382547870278
[proc 0][Train](3000/10000) average loss: 0.06984229359403253
[proc 0][Train](3000/10000) average regularization: 1.8914894810222906e-05
[proc 0][Train] 1000 steps take 13.964 seconds
[proc 0] 3000 steps, sample: 1.740, forward: 4.818, backward: 2.342, update: 4.680
[proc 2][Train](4000/10000) average pos_loss: 0.0513522876240313
[proc 2][Train](4000/10000) average neg_loss: 0.0780605507493019
[proc 2][Train](4000/10000) average loss: 0.06470641928166151
[proc 2][Train](4000/10000) average regularization: 2.009870362599031e-05
[proc 2][Train] 1000 steps take 14.364 seconds
[proc 2] 4000 steps, sample: 2.156, forward: 4.648, backward: 2.493, update: 5.060
[proc 1][Train](4000/10000) average pos_loss: 0.05108845461159944
[proc 1][Train](4000/10000) average neg_loss: 0.07772035629674792
[proc 1][Train](4000/10000) average loss: 0.06440440552309155
[proc 1][Train](4000/10000) average regularization: 2.0088838293304434e-05
[proc 1][Train] 1000 steps take 14.365 seconds
[proc 1] 4000 steps, sample: 2.082, forward: 4.804, backward: 2.567, update: 4.876
[proc 0][Train](4000/10000) average pos_loss: 0.05133746899291873
[proc 0][Train](4000/10000) average neg_loss: 0.07820913952961564
[proc 0][Train](4000/10000) average loss: 0.0647733042947948
[proc 0][Train](4000/10000) average regularization: 2.0113123231567442e-05
[proc 0][Train] 1000 steps take 14.365 seconds
[proc 0] 4000 steps, sample: 2.100, forward: 4.864, backward: 2.473, update: 4.805
[proc 0][Train](5000/10000) average pos_loss: 0.04863586650043726
[proc 0][Train](5000/10000) average neg_loss: 0.07462988272309304
[proc 0][Train](5000/10000) average loss: 0.06163287455588579
[proc 0][Train](5000/10000) average regularization: 2.0990183553294628e-05
[proc 0][Train] 1000 steps take 14.080 seconds
[proc 0] 5000 steps, sample: 1.780, forward: 4.836, backward: 2.493, update: 4.964
[proc 1][Train](5000/10000) average pos_loss: 0.04841303787380457
[proc 1][Train](5000/10000) average neg_loss: 0.07432563197240233
[proc 1][Train](5000/10000) average loss: 0.06136933491751552
[proc 1][Train](5000/10000) average regularization: 2.096116161192185e-05
[proc 1][Train] 1000 steps take 14.082 seconds
[proc 1] 5000 steps, sample: 1.797, forward: 4.878, backward: 2.580, update: 4.743
[proc 2][Train](5000/10000) average pos_loss: 0.048503102742135526
[proc 2][Train](5000/10000) average neg_loss: 0.07456617579236627
[proc 2][Train](5000/10000) average loss: 0.061534639224410055
[proc 2][Train](5000/10000) average regularization: 2.095954416836321e-05
[proc 2][Train] 1000 steps take 14.082 seconds
[proc 2] 5000 steps, sample: 1.787, forward: 4.577, backward: 2.523, update: 4.970
[proc 1][Train](6000/10000) average pos_loss: 0.046468753665685654
[proc 1][Train](6000/10000) average neg_loss: 0.07173495787382125
[proc 1][Train](6000/10000) average loss: 0.059101855754852294
[proc 1][Train](6000/10000) average regularization: 2.164548812652356e-05
[proc 1][Train] 1000 steps take 13.983 seconds
[proc 1] 6000 steps, sample: 1.741, forward: 4.859, backward: 2.552, update: 4.824
[proc 2][Train](6000/10000) average pos_loss: 0.04664664632454515
[proc 2][Train](6000/10000) average neg_loss: 0.07217040063813329
[proc 2][Train](6000/10000) average loss: 0.05940852339938283
[proc 2][Train](6000/10000) average regularization: 2.1656227592757206e-05
[proc 2][Train] 1000 steps take 13.983 seconds
[proc 2] 6000 steps, sample: 1.783, forward: 4.657, backward: 2.538, update: 4.981
[proc 0][Train](6000/10000) average pos_loss: 0.046596594240516424
[proc 0][Train](6000/10000) average neg_loss: 0.07209192212671041
[proc 0][Train](6000/10000) average loss: 0.05934425824135542
[proc 0][Train](6000/10000) average regularization: 2.1671625740054878e-05
[proc 0][Train] 1000 steps take 13.984 seconds
[proc 0] 6000 steps, sample: 1.788, forward: 4.901, backward: 2.522, update: 4.710
[proc 0][Train](7000/10000) average pos_loss: 0.045274522896856066
[proc 0][Train](7000/10000) average neg_loss: 0.0703992170020938
[proc 0][Train](7000/10000) average loss: 0.057836869817227125
[proc 0][Train](7000/10000) average regularization: 2.224531487081549e-05
[proc 0][Train] 1000 steps take 14.006 seconds
[proc 0] 7000 steps, sample: 1.801, forward: 4.915, backward: 2.572, update: 4.692
[proc 2][Train](7000/10000) average pos_loss: 0.04522037763148546
[proc 2][Train](7000/10000) average neg_loss: 0.07046736128255725
[proc 2][Train](7000/10000) average loss: 0.05784386943653226
[proc 2][Train](7000/10000) average regularization: 2.2221785082365386e-05
[proc 2][Train] 1000 steps take 14.006 seconds
[proc 2] 7000 steps, sample: 1.788, forward: 4.562, backward: 2.531, update: 4.891
[proc 1][Train](7000/10000) average pos_loss: 0.04501997876539826
[proc 1][Train](7000/10000) average neg_loss: 0.0699323144480586
[proc 1][Train](7000/10000) average loss: 0.05747614657878876
[proc 1][Train](7000/10000) average regularization: 2.2214756760149612e-05
[proc 1][Train] 1000 steps take 14.007 seconds
[proc 1] 7000 steps, sample: 1.804, forward: 4.939, backward: 2.558, update: 4.697
[proc 1][Train](8000/10000) average pos_loss: 0.043961778070777655
[proc 1][Train](8000/10000) average neg_loss: 0.06875133915245533
[proc 1][Train](8000/10000) average loss: 0.05635655865073204
[proc 1][Train](8000/10000) average regularization: 2.270016995862534e-05
[proc 1][Train] 1000 steps take 14.027 seconds
[proc 1] 8000 steps, sample: 1.773, forward: 4.892, backward: 2.550, update: 4.805
[proc 0][Train](8000/10000) average pos_loss: 0.044204047050327065
[proc 0][Train](8000/10000) average neg_loss: 0.06896252647414804
[proc 0][Train](8000/10000) average loss: 0.05658328674733639
[proc 0][Train](8000/10000) average regularization: 2.271786783421703e-05
[proc 0][Train] 1000 steps take 14.028 seconds
[proc 0] 8000 steps, sample: 1.789, forward: 4.866, backward: 2.463, update: 4.790
[proc 2][Train](8000/10000) average pos_loss: 0.044180295076221225
[proc 2][Train](8000/10000) average neg_loss: 0.06901294437795877
[proc 2][Train](8000/10000) average loss: 0.05659661972895265
[proc 2][Train](8000/10000) average regularization: 2.2704727711243324e-05
[proc 2][Train] 1000 steps take 14.029 seconds
[proc 2] 8000 steps, sample: 1.790, forward: 4.527, backward: 2.536, update: 4.913
[proc 1][Train](9000/10000) average pos_loss: 0.043054623529314995
[proc 1][Train](9000/10000) average neg_loss: 0.06756287052854895
[proc 1][Train](9000/10000) average loss: 0.055308746978640556
[proc 1][Train](9000/10000) average regularization: 2.3111465028705426e-05
[proc 1][Train] 1000 steps take 14.017 seconds
[proc 1] 9000 steps, sample: 1.913, forward: 4.934, backward: 2.661, update: 4.501
[proc 2][Train](9000/10000) average pos_loss: 0.0432527384236455
[proc 2][Train](9000/10000) average neg_loss: 0.06790740829333664
[proc 2][Train](9000/10000) average loss: 0.055580073297023774
[proc 2][Train](9000/10000) average regularization: 2.3117362356060768e-05
[proc 2][Train] 1000 steps take 14.016 seconds
[proc 2] 9000 steps, sample: 1.946, forward: 4.505, backward: 2.541, update: 4.779
[proc 0][Train](9000/10000) average pos_loss: 0.04329795772209764
[proc 0][Train](9000/10000) average neg_loss: 0.06785234104096889
[proc 0][Train](9000/10000) average loss: 0.0555751493871212
[proc 0][Train](9000/10000) average regularization: 2.314079382631462e-05
[proc 0][Train] 1000 steps take 14.017 seconds
[proc 0] 9000 steps, sample: 1.903, forward: 4.905, backward: 2.670, update: 4.521
[proc 1][Train](10000/10000) average pos_loss: 0.042301796484738585
[proc 1][Train](10000/10000) average neg_loss: 0.0664979207329452
[proc 1][Train](10000/10000) average loss: 0.05439985859021544
[proc 1][Train](10000/10000) average regularization: 2.348386473749997e-05
[proc 1][Train] 1000 steps take 13.997 seconds
[proc 1] 10000 steps, sample: 1.757, forward: 4.915, backward: 2.663, update: 4.655
proc 1 takes 143.040 seconds
[proc 0][Train](10000/10000) average pos_loss: 0.04253393758460879
[proc 0][Train](10000/10000) average neg_loss: 0.06702371492609381
[proc 0][Train](10000/10000) average loss: 0.05477882627397776
[proc 0][Train](10000/10000) average regularization: 2.3506297715357506e-05
[proc 0][Train] 1000 steps take 13.997 seconds
[proc 0] 10000 steps, sample: 1.766, forward: 4.865, backward: 2.702, update: 4.654
proc 0 takes 143.109 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.04249493081122637
[proc 2][Train](10000/10000) average neg_loss: 0.06698334551975131
[proc 2][Train](10000/10000) average loss: 0.05473913811892271
[proc 2][Train](10000/10000) average regularization: 2.3492814754717982e-05
[proc 2][Train] 1000 steps take 13.997 seconds
[proc 2] 10000 steps, sample: 1.764, forward: 4.512, backward: 2.564, update: 4.851
proc 2 takes 143.037 seconds
Successfully xmh. training takes 143.63887476921082 seconds
