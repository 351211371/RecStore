Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
random partition 483142 edges into 3 parts
part 0 has 161048 edges
part 1 has 161048 edges
part 2 has 161046 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=False, batch_size=1000, batch_size_eval=16, data_files=None, data_path='data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=3, num_proc=3, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='ckpts/TransE_l1_FB15k_3', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 1.002 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 1][Train](1000/10000) average pos_loss: 0.16657534430921078
[proc 1][Train](1000/10000) average neg_loss: 0.17807637071609497
[proc 1][Train](1000/10000) average loss: 0.17232585714012386
[proc 1][Train](1000/10000) average regularization: 1.2389362119847647e-05
[proc 1][Train] 1000 steps take 26.622 seconds
[proc 1] 1000 steps, sample: 1.423, forward: 11.227, backward: 2.716, update: 11.250
[proc 0][Train](1000/10000) average pos_loss: 0.16663679897785186
[proc 0][Train](1000/10000) average neg_loss: 0.17788159709423781
[proc 0][Train](1000/10000) average loss: 0.17225919855386018
[proc 0][Train](1000/10000) average regularization: 1.2374375729450549e-05
[proc 0][Train] 1000 steps take 26.622 seconds
[proc 0] 1000 steps, sample: 1.403, forward: 11.195, backward: 2.594, update: 11.330
[proc 2][Train](1000/10000) average pos_loss: 0.19568902625888587
[proc 2][Train](1000/10000) average neg_loss: 0.23513432443886995
[proc 2][Train](1000/10000) average loss: 0.21541167543828488
[proc 2][Train](1000/10000) average regularization: 1.050247845228114e-05
[proc 2][Train] 1000 steps take 26.603 seconds
[proc 2] 1000 steps, sample: 1.305, forward: 5.607, backward: 2.670, update: 4.560
[proc 1][Train](2000/10000) average pos_loss: 0.06681975071132183
[proc 1][Train](2000/10000) average neg_loss: 0.09530374401062727
[proc 1][Train](2000/10000) average loss: 0.08106174733117223
[proc 1][Train](2000/10000) average regularization: 1.66693069268149e-05
[proc 1][Train] 1000 steps take 24.147 seconds
[proc 1] 2000 steps, sample: 1.276, forward: 9.221, backward: 2.655, update: 10.989
[proc 0][Train](2000/10000) average pos_loss: 0.06659008330106735
[proc 0][Train](2000/10000) average neg_loss: 0.09472189997136593
[proc 0][Train](2000/10000) average loss: 0.08065599170699715
[proc 0][Train](2000/10000) average regularization: 1.6670741970301606e-05
[proc 0][Train] 1000 steps take 24.147 seconds
[proc 0] 2000 steps, sample: 1.265, forward: 9.186, backward: 2.440, update: 11.072
[proc 2][Train](2000/10000) average pos_loss: 0.06657996381819248
[proc 2][Train](2000/10000) average neg_loss: 0.09878742334991694
[proc 2][Train](2000/10000) average loss: 0.08268369363993407
[proc 2][Train](2000/10000) average regularization: 1.6090798295408605e-05
[proc 2][Train] 1000 steps take 24.147 seconds
[proc 2] 2000 steps, sample: 1.286, forward: 3.693, backward: 2.689, update: 4.198
[proc 0][Train](3000/10000) average pos_loss: 0.056515440307557584
[proc 0][Train](3000/10000) average neg_loss: 0.08339034719765186
[proc 0][Train](3000/10000) average loss: 0.06995289360359311
[proc 0][Train](3000/10000) average regularization: 1.849001624577795e-05
[proc 0][Train] 1000 steps take 24.344 seconds
[proc 0] 3000 steps, sample: 1.304, forward: 9.259, backward: 2.728, update: 11.028
[proc 1][Train](3000/10000) average pos_loss: 0.056821344263851645
[proc 1][Train](3000/10000) average neg_loss: 0.0839723943732679
[proc 1][Train](3000/10000) average loss: 0.07039686936885119
[proc 1][Train](3000/10000) average regularization: 1.84819121768669e-05
[proc 1][Train] 1000 steps take 24.345 seconds
[proc 1] 3000 steps, sample: 1.322, forward: 9.291, backward: 2.709, update: 11.016
[proc 2][Train](3000/10000) average pos_loss: 0.056066780637949704
[proc 2][Train](3000/10000) average neg_loss: 0.08529276995360852
[proc 2][Train](3000/10000) average loss: 0.07067977525293827
[proc 2][Train](3000/10000) average regularization: 1.814212883436994e-05
[proc 2][Train] 1000 steps take 24.344 seconds
[proc 2] 3000 steps, sample: 1.301, forward: 3.688, backward: 2.638, update: 4.201
[proc 1][Train](4000/10000) average pos_loss: 0.052065136924386024
[proc 1][Train](4000/10000) average neg_loss: 0.07837451083213091
[proc 1][Train](4000/10000) average loss: 0.06521982382982969
[proc 1][Train](4000/10000) average regularization: 1.9651274389616448e-05
[proc 1][Train] 1000 steps take 24.331 seconds
[proc 1] 4000 steps, sample: 1.378, forward: 9.246, backward: 2.729, update: 10.973
[proc 0][Train](4000/10000) average pos_loss: 0.05178808170184493
[proc 0][Train](4000/10000) average neg_loss: 0.07753413795679807
[proc 0][Train](4000/10000) average loss: 0.06466110985353589
[proc 0][Train](4000/10000) average regularization: 1.9665619718580274e-05
[proc 0][Train] 1000 steps take 24.332 seconds
[proc 0] 4000 steps, sample: 1.404, forward: 9.226, backward: 2.659, update: 11.013
[proc 2][Train](4000/10000) average pos_loss: 0.05128973214700818
[proc 2][Train](4000/10000) average neg_loss: 0.07905210457369685
[proc 2][Train](4000/10000) average loss: 0.06517091835662722
[proc 2][Train](4000/10000) average regularization: 1.940833819389809e-05
[proc 2][Train] 1000 steps take 24.332 seconds
[proc 2] 4000 steps, sample: 1.348, forward: 3.648, backward: 2.663, update: 4.155
[proc 0][Train](5000/10000) average pos_loss: 0.04894508800655603
[proc 0][Train](5000/10000) average neg_loss: 0.07420482295379043
[proc 0][Train](5000/10000) average loss: 0.06157495551928878
[proc 0][Train](5000/10000) average regularization: 2.05323410427809e-05
[proc 0][Train] 1000 steps take 24.267 seconds
[proc 0] 5000 steps, sample: 1.259, forward: 9.227, backward: 2.762, update: 10.960
[proc 1][Train](5000/10000) average pos_loss: 0.049195080749690534
[proc 1][Train](5000/10000) average neg_loss: 0.07480940499156713
[proc 1][Train](5000/10000) average loss: 0.06200224284082651
[proc 1][Train](5000/10000) average regularization: 2.0517194667263537e-05
[proc 1][Train] 1000 steps take 24.267 seconds
[proc 1] 5000 steps, sample: 1.288, forward: 9.268, backward: 2.746, update: 10.958
[proc 2][Train](5000/10000) average pos_loss: 0.048344589333981274
[proc 2][Train](5000/10000) average neg_loss: 0.07522580499947071
[proc 2][Train](5000/10000) average loss: 0.06178519709780812
[proc 2][Train](5000/10000) average regularization: 2.0323758755694144e-05
[proc 2][Train] 1000 steps take 24.267 seconds
[proc 2] 5000 steps, sample: 1.211, forward: 3.554, backward: 2.648, update: 4.060
[proc 1][Train](6000/10000) average pos_loss: 0.047236123345792295
[proc 1][Train](6000/10000) average neg_loss: 0.07240192952752113
[proc 1][Train](6000/10000) average loss: 0.05981902641803026
[proc 1][Train](6000/10000) average regularization: 2.1198375909079915e-05
[proc 1][Train] 1000 steps take 24.262 seconds
[proc 1] 6000 steps, sample: 1.283, forward: 9.257, backward: 2.737, update: 10.978
[proc 0][Train](6000/10000) average pos_loss: 0.046932100873440505
[proc 0][Train](6000/10000) average neg_loss: 0.07171022450178861
[proc 0][Train](6000/10000) average loss: 0.05932116275280714
[proc 0][Train](6000/10000) average regularization: 2.121454228654329e-05
[proc 0][Train] 1000 steps take 24.263 seconds
[proc 0] 6000 steps, sample: 1.260, forward: 9.219, backward: 2.758, update: 10.995
[proc 2][Train](6000/10000) average pos_loss: 0.04649169788882136
[proc 2][Train](6000/10000) average neg_loss: 0.07269759888201952
[proc 2][Train](6000/10000) average loss: 0.0595946483835578
[proc 2][Train](6000/10000) average regularization: 2.1047018404715344e-05
[proc 2][Train] 1000 steps take 24.262 seconds
[proc 2] 6000 steps, sample: 1.287, forward: 3.676, backward: 2.663, update: 4.191
[proc 0][Train](7000/10000) average pos_loss: 0.045447833459824324
[proc 0][Train](7000/10000) average neg_loss: 0.0700599828697741
[proc 0][Train](7000/10000) average loss: 0.0577539081312716
[proc 0][Train](7000/10000) average regularization: 2.1778782242108718e-05
[proc 0][Train] 1000 steps take 24.247 seconds
[proc 0] 7000 steps, sample: 1.257, forward: 9.231, backward: 2.780, update: 10.973
[proc 1][Train](7000/10000) average pos_loss: 0.045759146105498076
[proc 1][Train](7000/10000) average neg_loss: 0.0706526298262179
[proc 1][Train](7000/10000) average loss: 0.05820588802918792
[proc 1][Train](7000/10000) average regularization: 2.1767856331280198e-05
[proc 1][Train] 1000 steps take 24.247 seconds
[proc 1] 7000 steps, sample: 1.267, forward: 9.254, backward: 2.753, update: 10.963
[proc 2][Train](7000/10000) average pos_loss: 0.045065383180975915
[proc 2][Train](7000/10000) average neg_loss: 0.07072698540240527
[proc 2][Train](7000/10000) average loss: 0.05789618445187807
[proc 2][Train](7000/10000) average regularization: 2.1635668354065274e-05
[proc 2][Train] 1000 steps take 24.248 seconds
[proc 2] 7000 steps, sample: 1.288, forward: 3.656, backward: 2.676, update: 4.143
[proc 0][Train](8000/10000) average pos_loss: 0.04431439584121108
[proc 0][Train](8000/10000) average neg_loss: 0.06869105694815517
[proc 0][Train](8000/10000) average loss: 0.05650272649526596
[proc 0][Train](8000/10000) average regularization: 2.2266331068749424e-05
[proc 0][Train] 1000 steps take 24.228 seconds
[proc 0] 8000 steps, sample: 1.254, forward: 9.228, backward: 2.777, update: 10.963
[proc 1][Train](8000/10000) average pos_loss: 0.044597558341920376
[proc 1][Train](8000/10000) average neg_loss: 0.06925786816701293
[proc 1][Train](8000/10000) average loss: 0.056927713323384525
[proc 1][Train](8000/10000) average regularization: 2.224812514032237e-05
[proc 1][Train] 1000 steps take 24.228 seconds
[proc 1] 8000 steps, sample: 1.265, forward: 9.247, backward: 2.554, update: 11.023
[proc 2][Train](8000/10000) average pos_loss: 0.04397573161125183
[proc 2][Train](8000/10000) average neg_loss: 0.0692728107944131
[proc 2][Train](8000/10000) average loss: 0.05662427119165659
[proc 2][Train](8000/10000) average regularization: 2.213802525875508e-05
[proc 2][Train] 1000 steps take 24.227 seconds
[proc 2] 8000 steps, sample: 1.290, forward: 3.658, backward: 2.691, update: 4.141
[proc 0][Train](9000/10000) average pos_loss: 0.043405736487358806
[proc 0][Train](9000/10000) average neg_loss: 0.06742780917137861
[proc 0][Train](9000/10000) average loss: 0.055416772786527874
[proc 0][Train](9000/10000) average regularization: 2.268463105428964e-05
[proc 0][Train] 1000 steps take 24.259 seconds
[proc 0] 9000 steps, sample: 1.350, forward: 9.183, backward: 2.707, update: 11.012
[proc 1][Train](9000/10000) average pos_loss: 0.04362534691765904
[proc 1][Train](9000/10000) average neg_loss: 0.06819307825341821
[proc 1][Train](9000/10000) average loss: 0.055909212619066236
[proc 1][Train](9000/10000) average regularization: 2.2666706991003592e-05
[proc 1][Train] 1000 steps take 24.259 seconds
[proc 1] 9000 steps, sample: 1.395, forward: 9.236, backward: 1.624, update: 11.332
[proc 2][Train](9000/10000) average pos_loss: 0.043149388052523135
[proc 2][Train](9000/10000) average neg_loss: 0.06807146668806673
[proc 2][Train](9000/10000) average loss: 0.05561042739823461
[proc 2][Train](9000/10000) average regularization: 2.2567943427930005e-05
[proc 2][Train] 1000 steps take 24.259 seconds
[proc 2] 9000 steps, sample: 1.345, forward: 3.637, backward: 2.688, update: 4.169
[proc 0][Train](10000/10000) average pos_loss: 0.042519181933254005
[proc 0][Train](10000/10000) average neg_loss: 0.06664954015240074
[proc 0][Train](10000/10000) average loss: 0.05458436107262969
[proc 0][Train](10000/10000) average regularization: 2.3054795226926216e-05
[proc 0][Train] 1000 steps take 24.251 seconds
[proc 0] 10000 steps, sample: 1.290, forward: 9.232, backward: 2.658, update: 11.064
proc 0 takes 244.959 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.042900267139077186
[proc 1][Train](10000/10000) average neg_loss: 0.06723411241546273
[proc 1][Train](10000/10000) average loss: 0.05506718981638551
[proc 1][Train](10000/10000) average regularization: 2.3041285978251837e-05
[proc 1][Train] 1000 steps take 24.251 seconds
[proc 1] 10000 steps, sample: 1.300, forward: 9.247, backward: 2.695, update: 11.003
proc 1 takes 244.959 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.04242273524403572
[proc 2][Train](10000/10000) average neg_loss: 0.06710824822634459
[proc 2][Train](10000/10000) average loss: 0.05476549173146486
[proc 2][Train](10000/10000) average regularization: 2.2950746153583166e-05
[proc 2][Train] 1000 steps take 24.251 seconds
[proc 2] 10000 steps, sample: 1.304, forward: 3.672, backward: 2.669, update: 4.201
proc 2 takes 244.940 seconds
Successfully xmh. training takes 245.56275510787964 seconds
