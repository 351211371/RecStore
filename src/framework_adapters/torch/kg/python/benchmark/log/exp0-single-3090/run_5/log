Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
random partition 483142 edges into 5 parts
part 0 has 96629 edges
part 1 has 96629 edges
part 2 has 96629 edges
part 3 has 96629 edges
part 4 has 96626 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=False, batch_size=1000, batch_size_eval=16, data_files=None, data_path='data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3, 4], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=5, num_proc=5, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='ckpts/TransE_l1_FB15k_21', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 1.006 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 4][Train](1000/10000) average pos_loss: 0.1325374369546771
[proc 4][Train](1000/10000) average neg_loss: 0.15609081069380046
[proc 4][Train](1000/10000) average loss: 0.14431412357091905
[proc 4][Train](1000/10000) average regularization: 1.3601052509784495e-05
[proc 4] 1000 steps, total: 17.259, sample: 1.790, forward: 7.528, backward: 2.785, update: 5.149
[proc 2][Train](1000/10000) average pos_loss: 0.1370786112435162
[proc 2][Train](1000/10000) average neg_loss: 0.1595931819602847
[proc 2][Train](1000/10000) average loss: 0.14833589684218168
[proc 2][Train](1000/10000) average regularization: 1.3532897671666433e-05
[proc 2] 1000 steps, total: 17.264, sample: 1.686, forward: 7.322, backward: 2.991, update: 5.012
[proc 3][Train](1000/10000) average pos_loss: 0.13300597511231899
[proc 3][Train](1000/10000) average neg_loss: 0.16100258119404315
[proc 3][Train](1000/10000) average loss: 0.1470042778402567
[proc 3][Train](1000/10000) average regularization: 1.3500142134262204e-05
[proc 3] 1000 steps, total: 17.260, sample: 1.688, forward: 7.416, backward: 2.697, update: 5.282
[proc 1][Train](1000/10000) average pos_loss: 0.1393925898373127
[proc 1][Train](1000/10000) average neg_loss: 0.16339030537754298
[proc 1][Train](1000/10000) average loss: 0.15139144764095544
[proc 1][Train](1000/10000) average regularization: 1.3513576029481556e-05
[proc 1] 1000 steps, total: 17.284, sample: 1.782, forward: 7.436, backward: 2.744, update: 5.173
[proc 0][Train](1000/10000) average pos_loss: 0.13249643722176552
[proc 0][Train](1000/10000) average neg_loss: 0.15843131928145884
[proc 0][Train](1000/10000) average loss: 0.1454638781622052
[proc 0][Train](1000/10000) average regularization: 1.3525799593480769e-05
[proc 0] 1000 steps, total: 17.300, sample: 1.769, forward: 7.528, backward: 2.665, update: 5.016
[proc 4][Train](2000/10000) average pos_loss: 0.057309999093413354
[proc 4][Train](2000/10000) average neg_loss: 0.0849227261915803
[proc 4][Train](2000/10000) average loss: 0.07111636267229915
[proc 4][Train](2000/10000) average regularization: 1.8376452031588997e-05
[proc 4] 2000 steps, total: 14.658, sample: 1.699, forward: 5.013, backward: 2.821, update: 5.118
[proc 2][Train](2000/10000) average pos_loss: 0.05713923904672265
[proc 2][Train](2000/10000) average neg_loss: 0.08518891827762128
[proc 2][Train](2000/10000) average loss: 0.07116407866403461
[proc 2][Train](2000/10000) average regularization: 1.831820779989357e-05
[proc 2] 2000 steps, total: 14.658, sample: 1.604, forward: 4.823, backward: 2.714, update: 5.093
[proc 0][Train](2000/10000) average pos_loss: 0.057427053716033696
[proc 0][Train](2000/10000) average neg_loss: 0.08456828029826284
[proc 0][Train](2000/10000) average loss: 0.07099766704812646
[proc 0][Train](2000/10000) average regularization: 1.836927547083178e-05
[proc 0] 2000 steps, total: 14.658, sample: 1.693, forward: 5.067, backward: 2.776, update: 4.986
[proc 3][Train](2000/10000) average pos_loss: 0.05686713502183557
[proc 3][Train](2000/10000) average neg_loss: 0.08500103994086385
[proc 3][Train](2000/10000) average loss: 0.07093408749997616
[proc 3][Train](2000/10000) average regularization: 1.8324832470170803e-05
[proc 3] 2000 steps, total: 14.658, sample: 1.597, forward: 4.887, backward: 2.675, update: 5.164
[proc 1][Train](2000/10000) average pos_loss: 0.0572778512686491
[proc 1][Train](2000/10000) average neg_loss: 0.08522460320591926
[proc 1][Train](2000/10000) average loss: 0.07125122716650367
[proc 1][Train](2000/10000) average regularization: 1.8354359122895403e-05
[proc 1] 2000 steps, total: 14.658, sample: 1.673, forward: 5.001, backward: 2.741, update: 5.124
[proc 4][Train](3000/10000) average pos_loss: 0.05009273911267519
[proc 4][Train](3000/10000) average neg_loss: 0.0761567962244153
[proc 4][Train](3000/10000) average loss: 0.06312476754933595
[proc 4][Train](3000/10000) average regularization: 2.02185097423353e-05
[proc 4] 3000 steps, total: 14.699, sample: 1.703, forward: 5.042, backward: 2.792, update: 5.155
[proc 1][Train](3000/10000) average pos_loss: 0.050120689686387776
[proc 1][Train](3000/10000) average neg_loss: 0.07649708247929811
[proc 1][Train](3000/10000) average loss: 0.06330888606980443
[proc 1][Train](3000/10000) average regularization: 2.0201886722134076e-05
[proc 1] 3000 steps, total: 14.698, sample: 1.693, forward: 5.006, backward: 2.711, update: 5.161
[proc 2][Train](3000/10000) average pos_loss: 0.05018808941170573
[proc 2][Train](3000/10000) average neg_loss: 0.07625502720102668
[proc 2][Train](3000/10000) average loss: 0.06322155829519033
[proc 2][Train](3000/10000) average regularization: 2.018052705170703e-05
[proc 2] 3000 steps, total: 14.699, sample: 1.621, forward: 4.814, backward: 2.944, update: 4.962
[proc 3][Train](3000/10000) average pos_loss: 0.04980120003223419
[proc 3][Train](3000/10000) average neg_loss: 0.07596236411482096
[proc 3][Train](3000/10000) average loss: 0.06288178203999996
[proc 3][Train](3000/10000) average regularization: 2.0181756626698187e-05
[proc 3] 3000 steps, total: 14.699, sample: 1.616, forward: 4.907, backward: 2.665, update: 5.183
[proc 0][Train](3000/10000) average pos_loss: 0.05006741393357515
[proc 0][Train](3000/10000) average neg_loss: 0.07592693292349577
[proc 0][Train](3000/10000) average loss: 0.06299717343598604
[proc 0][Train](3000/10000) average regularization: 2.0212653847920592e-05
[proc 0] 3000 steps, total: 14.699, sample: 1.701, forward: 5.017, backward: 2.743, update: 4.956
[proc 4][Train](4000/10000) average pos_loss: 0.04669040146097541
[proc 4][Train](4000/10000) average neg_loss: 0.07186989093199372
[proc 4][Train](4000/10000) average loss: 0.05928014609962702
[proc 4][Train](4000/10000) average regularization: 2.1402369739007555e-05
[proc 4] 4000 steps, total: 14.616, sample: 1.680, forward: 5.020, backward: 2.798, update: 5.110
[proc 1][Train](4000/10000) average pos_loss: 0.04664917173609138
[proc 1][Train](4000/10000) average neg_loss: 0.07219387741014362
[proc 1][Train](4000/10000) average loss: 0.059421524573117494
[proc 1][Train](4000/10000) average regularization: 2.1381381722676452e-05
[proc 1] 4000 steps, total: 14.616, sample: 1.661, forward: 5.080, backward: 2.638, update: 5.183
[proc 0][Train](4000/10000) average pos_loss: 0.04676952721178532
[proc 0][Train](4000/10000) average neg_loss: 0.07177659069374204
[proc 0][Train](4000/10000) average loss: 0.05927305896952748
[proc 0][Train](4000/10000) average regularization: 2.1399801626102998e-05
[proc 0] 4000 steps, total: 14.616, sample: 1.676, forward: 5.070, backward: 2.740, update: 5.004
[proc 3][Train](4000/10000) average pos_loss: 0.04643042204901576
[proc 3][Train](4000/10000) average neg_loss: 0.07187831140682101
[proc 3][Train](4000/10000) average loss: 0.059154366694390774
[proc 3][Train](4000/10000) average regularization: 2.1373800833316636e-05
[proc 3] 4000 steps, total: 14.616, sample: 1.591, forward: 4.937, backward: 2.639, update: 5.177
[proc 2][Train](4000/10000) average pos_loss: 0.046650145895779135
[proc 2][Train](4000/10000) average neg_loss: 0.07200980896875263
[proc 2][Train](4000/10000) average loss: 0.059329977404326203
[proc 2][Train](4000/10000) average regularization: 2.136023017919797e-05
[proc 2] 4000 steps, total: 14.616, sample: 1.595, forward: 4.829, backward: 2.664, update: 5.099
[proc 1][Train](5000/10000) average pos_loss: 0.04502535069733858
[proc 1][Train](5000/10000) average neg_loss: 0.06932745622470975
[proc 1][Train](5000/10000) average loss: 0.057176403377205136
[proc 1][Train](5000/10000) average regularization: 2.229405652178684e-05
[proc 1] 5000 steps, total: 16.538, sample: 3.729, forward: 5.001, backward: 2.689, update: 5.112
[proc 0][Train](5000/10000) average pos_loss: 0.04497705741599202
[proc 0][Train](5000/10000) average neg_loss: 0.06898846864327789
[proc 0][Train](5000/10000) average loss: 0.05698276302963495
[proc 0][Train](5000/10000) average regularization: 2.2308651086859754e-05
[proc 0] 5000 steps, total: 16.539, sample: 3.734, forward: 4.958, backward: 2.802, update: 4.854
[proc 4][Train](5000/10000) average pos_loss: 0.04417287040874362
[proc 4][Train](5000/10000) average neg_loss: 0.06931839511170983
[proc 4][Train](5000/10000) average loss: 0.056745632726699115
[proc 4][Train](5000/10000) average regularization: 2.2246152975640144e-05
[proc 4] 5000 steps, total: 16.540, sample: 1.890, forward: 5.101, backward: 2.884, update: 5.233
[proc 3][Train](5000/10000) average pos_loss: 0.043945565693080425
[proc 3][Train](5000/10000) average neg_loss: 0.06927872994169593
[proc 3][Train](5000/10000) average loss: 0.056612147759646174
[proc 3][Train](5000/10000) average regularization: 2.221525916320388e-05
[proc 3] 5000 steps, total: 16.539, sample: 1.800, forward: 5.068, backward: 2.840, update: 5.138
[proc 2][Train](5000/10000) average pos_loss: 0.04429708018153906
[proc 2][Train](5000/10000) average neg_loss: 0.06944856386259199
[proc 2][Train](5000/10000) average loss: 0.056872822038829325
[proc 2][Train](5000/10000) average regularization: 2.2209454413314235e-05
[proc 2] 5000 steps, total: 16.539, sample: 1.806, forward: 5.000, backward: 2.792, update: 5.190
[proc 4][Train](6000/10000) average pos_loss: 0.043421851370483634
[proc 4][Train](6000/10000) average neg_loss: 0.06736785778775811
[proc 4][Train](6000/10000) average loss: 0.05539485467225313
[proc 4][Train](6000/10000) average regularization: 2.2965995294725873e-05
[proc 4] 6000 steps, total: 14.780, sample: 1.694, forward: 5.048, backward: 2.963, update: 5.068
[proc 2][Train](6000/10000) average pos_loss: 0.04338481539860368
[proc 2][Train](6000/10000) average neg_loss: 0.06754786682873964
[proc 2][Train](6000/10000) average loss: 0.05546634109690785
[proc 2][Train](6000/10000) average regularization: 2.2924163118659635e-05
[proc 2] 6000 steps, total: 14.781, sample: 1.593, forward: 4.926, backward: 2.585, update: 5.190
[proc 3][Train](6000/10000) average pos_loss: 0.04309891574829817
[proc 3][Train](6000/10000) average neg_loss: 0.06747755381837488
[proc 3][Train](6000/10000) average loss: 0.055288234803825616
[proc 3][Train](6000/10000) average regularization: 2.292864767696301e-05
[proc 3] 6000 steps, total: 14.782, sample: 1.584, forward: 4.907, backward: 2.724, update: 5.101
[proc 0][Train](6000/10000) average pos_loss: 0.042731819462031126
[proc 0][Train](6000/10000) average neg_loss: 0.06731330740079283
[proc 0][Train](6000/10000) average loss: 0.05502256347239017
[proc 0][Train](6000/10000) average regularization: 2.2955830183491345e-05
[proc 0] 6000 steps, total: 14.783, sample: 1.673, forward: 4.977, backward: 2.963, update: 4.822
[proc 1][Train](6000/10000) average pos_loss: 0.042695080142468214
[proc 1][Train](6000/10000) average neg_loss: 0.06776772900298238
[proc 1][Train](6000/10000) average loss: 0.055231404576450586
[proc 1][Train](6000/10000) average regularization: 2.2928765805772855e-05
[proc 1] 6000 steps, total: 14.783, sample: 1.674, forward: 4.989, backward: 2.656, update: 5.145
[proc 4][Train](7000/10000) average pos_loss: 0.04206403971090913
[proc 4][Train](7000/10000) average neg_loss: 0.06614119287580252
[proc 4][Train](7000/10000) average loss: 0.05410261623933911
[proc 4][Train](7000/10000) average regularization: 2.3531534294306767e-05
[proc 4] 7000 steps, total: 14.726, sample: 1.698, forward: 5.020, backward: 2.788, update: 5.213
[proc 1][Train](7000/10000) average pos_loss: 0.04203878777474165
[proc 1][Train](7000/10000) average neg_loss: 0.0664147909656167
[proc 1][Train](7000/10000) average loss: 0.054226789303123954
[proc 1][Train](7000/10000) average regularization: 2.3504501374191022e-05
[proc 1] 7000 steps, total: 14.725, sample: 1.729, forward: 5.017, backward: 2.722, update: 5.153
[proc 3][Train](7000/10000) average pos_loss: 0.0419156694598496
[proc 3][Train](7000/10000) average neg_loss: 0.06612702853605151
[proc 3][Train](7000/10000) average loss: 0.054021349031478164
[proc 3][Train](7000/10000) average regularization: 2.3493382999731695e-05
[proc 3] 7000 steps, total: 14.725, sample: 1.627, forward: 4.946, backward: 2.730, update: 5.149
[proc 2][Train](7000/10000) average pos_loss: 0.04212119558826089
[proc 2][Train](7000/10000) average neg_loss: 0.06623684105277061
[proc 2][Train](7000/10000) average loss: 0.05417901840060949
[proc 2][Train](7000/10000) average regularization: 2.3489880133638508e-05
[proc 2] 7000 steps, total: 14.726, sample: 1.631, forward: 4.912, backward: 2.637, update: 5.166
[proc 0][Train](7000/10000) average pos_loss: 0.041987872030586
[proc 0][Train](7000/10000) average neg_loss: 0.06608507718890905
[proc 0][Train](7000/10000) average loss: 0.05403647469729185
[proc 0][Train](7000/10000) average regularization: 2.352071731183969e-05
[proc 0] 7000 steps, total: 14.726, sample: 1.723, forward: 5.042, backward: 2.715, update: 4.964
[proc 4][Train](8000/10000) average pos_loss: 0.04130722426623106
[proc 4][Train](8000/10000) average neg_loss: 0.06515803866460919
[proc 4][Train](8000/10000) average loss: 0.053232631485909225
[proc 4][Train](8000/10000) average regularization: 2.4002777581699775e-05
[proc 4] 8000 steps, total: 15.005, sample: 1.807, forward: 5.138, backward: 2.852, update: 5.199
[proc 3][Train](8000/10000) average pos_loss: 0.04105985243991017
[proc 3][Train](8000/10000) average neg_loss: 0.0650642521083355
[proc 3][Train](8000/10000) average loss: 0.053062052275985476
[proc 3][Train](8000/10000) average regularization: 2.397943928917812e-05
[proc 3] 8000 steps, total: 15.004, sample: 1.638, forward: 5.018, backward: 2.791, update: 5.136
[proc 2][Train](8000/10000) average pos_loss: 0.04134770430624485
[proc 2][Train](8000/10000) average neg_loss: 0.06516420822218061
[proc 2][Train](8000/10000) average loss: 0.053255956310778854
[proc 2][Train](8000/10000) average regularization: 2.397059971008275e-05
[proc 2] 8000 steps, total: 15.004, sample: 1.650, forward: 4.986, backward: 2.702, update: 5.174
[proc 0][Train](8000/10000) average pos_loss: 0.041162701796740295
[proc 0][Train](8000/10000) average neg_loss: 0.06512550499662757
[proc 0][Train](8000/10000) average loss: 0.05314410342276096
[proc 0][Train](8000/10000) average regularization: 2.40017260384775e-05
[proc 0] 8000 steps, total: 15.008, sample: 1.648, forward: 4.963, backward: 2.702, update: 4.954
[proc 1][Train](8000/10000) average pos_loss: 0.04119039798527956
[proc 1][Train](8000/10000) average neg_loss: 0.06551482383534313
[proc 1][Train](8000/10000) average loss: 0.05335261095687747
[proc 1][Train](8000/10000) average regularization: 2.3974738722245092e-05
[proc 1] 8000 steps, total: 15.008, sample: 1.652, forward: 4.943, backward: 2.699, update: 5.122
[proc 4][Train](9000/10000) average pos_loss: 0.04065854462608695
[proc 4][Train](9000/10000) average neg_loss: 0.06435620199516416
[proc 4][Train](9000/10000) average loss: 0.05250737334415317
[proc 4][Train](9000/10000) average regularization: 2.4425478017292335e-05
[proc 4] 9000 steps, total: 15.353, sample: 2.058, forward: 5.165, backward: 2.877, update: 5.243
[proc 3][Train](9000/10000) average pos_loss: 0.04038362754136324
[proc 3][Train](9000/10000) average neg_loss: 0.06428865411132574
[proc 3][Train](9000/10000) average loss: 0.05233614080771804
[proc 3][Train](9000/10000) average regularization: 2.439618757853168e-05
[proc 3] 9000 steps, total: 15.354, sample: 1.800, forward: 5.024, backward: 2.725, update: 5.157
[proc 0][Train](9000/10000) average pos_loss: 0.04059735437855125
[proc 0][Train](9000/10000) average neg_loss: 0.0641887191310525
[proc 0][Train](9000/10000) average loss: 0.052393036771565676
[proc 0][Train](9000/10000) average regularization: 2.442036229695077e-05
[proc 0] 9000 steps, total: 15.350, sample: 1.980, forward: 5.003, backward: 2.709, update: 4.962
[proc 1][Train](9000/10000) average pos_loss: 0.04057955015078187
[proc 1][Train](9000/10000) average neg_loss: 0.06469508012756706
[proc 1][Train](9000/10000) average loss: 0.052637315191328526
[proc 1][Train](9000/10000) average regularization: 2.438730502217368e-05
[proc 1] 9000 steps, total: 15.350, sample: 1.955, forward: 4.960, backward: 2.683, update: 5.094
[proc 2][Train](9000/10000) average pos_loss: 0.04064579252153635
[proc 2][Train](9000/10000) average neg_loss: 0.06446548466011882
[proc 2][Train](9000/10000) average loss: 0.05255563862249255
[proc 2][Train](9000/10000) average regularization: 2.4380928291066083e-05
[proc 2] 9000 steps, total: 15.354, sample: 1.870, forward: 4.967, backward: 2.738, update: 5.108
[proc 4][Train](10000/10000) average pos_loss: 0.04003237995505333
[proc 4][Train](10000/10000) average neg_loss: 0.0636319920271635
[proc 4][Train](10000/10000) average loss: 0.051832185998558995
[proc 4][Train](10000/10000) average regularization: 2.478897695618798e-05
[proc 4] 10000 steps, total: 14.613, sample: 1.806, forward: 4.680, backward: 2.910, update: 5.210
proc 4 takes 152.249 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.040149370141327384
[proc 2][Train](10000/10000) average neg_loss: 0.0637625703588128
[proc 2][Train](10000/10000) average loss: 0.051955970287322996
[proc 2][Train](10000/10000) average regularization: 2.4751574401307152e-05
[proc 2] 10000 steps, total: 14.612, sample: 1.672, forward: 4.930, backward: 2.718, update: 5.105
proc 2 takes 152.254 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.04009439801424742
[proc 1][Train](10000/10000) average neg_loss: 0.06395186515152454
[proc 1][Train](10000/10000) average loss: 0.05202313160523772
[proc 1][Train](10000/10000) average regularization: 2.4748289228227805e-05
[proc 1] 10000 steps, total: 14.613, sample: 1.650, forward: 4.923, backward: 2.709, update: 5.090
proc 1 takes 152.274 seconds
[proc 0][Train](10000/10000) average pos_loss: 0.04006875014677644
[proc 0][Train](10000/10000) average neg_loss: 0.06362237013876439
[proc 0][Train](10000/10000) average loss: 0.05184556021168828
[proc 0][Train](10000/10000) average regularization: 2.478510637047293e-05
[proc 0] 10000 steps, total: 14.613, sample: 1.656, forward: 4.965, backward: 2.712, update: 4.951
proc 0 takes 152.290 seconds
[proc 3][Train](10000/10000) average pos_loss: 0.03968674926832318
[proc 3][Train](10000/10000) average neg_loss: 0.06375746754556895
[proc 3][Train](10000/10000) average loss: 0.05172210836783051
[proc 3][Train](10000/10000) average regularization: 2.4749422793320265e-05
[proc 3] 10000 steps, total: 14.614, sample: 1.659, forward: 4.946, backward: 1.600, update: 5.550
proc 3 takes 152.250 seconds
Successfully xmh. training takes 152.91633343696594 seconds
