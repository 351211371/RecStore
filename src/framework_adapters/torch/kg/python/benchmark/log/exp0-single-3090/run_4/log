Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
|Train|: 483142
random partition 483142 edges into 4 parts
part 0 has 120786 edges
part 1 has 120786 edges
part 2 has 120786 edges
part 3 has 120784 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=False, batch_size=1000, batch_size_eval=16, data_files=None, data_path='data', dataset='FB15k', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=14951, no_eval_filter=False, no_save_emb=True, nr_gpus=4, num_proc=4, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='ckpts/TransE_l1_FB15k_10', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 50000
|test|: 59071
Total initialize time 1.010 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 1][Train](1000/10000) average pos_loss: 0.14865403953567147
[proc 1][Train](1000/10000) average neg_loss: 0.17053758466988803
[proc 1][Train](1000/10000) average loss: 0.1595958121716976
[proc 1][Train](1000/10000) average regularization: 1.3046908706655814e-05
[proc 1][Train] 1000 steps take 16.886 seconds
[proc 1] 1000 steps, sample: 1.816, forward: 7.527, backward: 2.540, update: 4.992
[proc 2][Train](1000/10000) average pos_loss: 0.1450886176414788
[proc 2][Train](1000/10000) average neg_loss: 0.17113609459251167
[proc 2][Train](1000/10000) average loss: 0.15811235662549733
[proc 2][Train](1000/10000) average regularization: 1.3020315527228376e-05
[proc 2][Train] 1000 steps take 16.870 seconds
[proc 2] 1000 steps, sample: 1.760, forward: 7.307, backward: 2.820, update: 4.964
[proc 3][Train](1000/10000) average pos_loss: 0.14377504258602858
[proc 3][Train](1000/10000) average neg_loss: 0.16981669910252095
[proc 3][Train](1000/10000) average loss: 0.15679587093740702
[proc 3][Train](1000/10000) average regularization: 1.3017705141010084e-05
[proc 3][Train] 1000 steps take 16.813 seconds
[proc 3] 1000 steps, sample: 1.841, forward: 7.049, backward: 2.655, update: 5.056
[proc 0][Train](1000/10000) average pos_loss: 0.14974577761441468
[proc 0][Train](1000/10000) average neg_loss: 0.17504991263151168
[proc 0][Train](1000/10000) average loss: 0.1623978454247117
[proc 0][Train](1000/10000) average regularization: 1.3003171061654939e-05
[proc 0][Train] 1000 steps take 16.945 seconds
[proc 0] 1000 steps, sample: 1.827, forward: 7.539, backward: 2.610, update: 4.932
[proc 1][Train](2000/10000) average pos_loss: 0.06054279812425375
[proc 1][Train](2000/10000) average neg_loss: 0.08898183001577854
[proc 1][Train](2000/10000) average loss: 0.07476231404766441
[proc 1][Train](2000/10000) average regularization: 1.784735933688353e-05
[proc 1][Train] 1000 steps take 14.537 seconds
[proc 1] 2000 steps, sample: 1.788, forward: 4.973, backward: 3.000, update: 4.766
[proc 0][Train](2000/10000) average pos_loss: 0.06011798533424735
[proc 0][Train](2000/10000) average neg_loss: 0.08911313210427761
[proc 0][Train](2000/10000) average loss: 0.07461555865034461
[proc 0][Train](2000/10000) average regularization: 1.7799760691559642e-05
[proc 0][Train] 1000 steps take 14.537 seconds
[proc 0] 2000 steps, sample: 1.787, forward: 4.926, backward: 2.607, update: 4.892
[proc 3][Train](2000/10000) average pos_loss: 0.060295883867889644
[proc 3][Train](2000/10000) average neg_loss: 0.08916823851317167
[proc 3][Train](2000/10000) average loss: 0.07473206113651396
[proc 3][Train](2000/10000) average regularization: 1.7780868396584994e-05
[proc 3][Train] 1000 steps take 14.537 seconds
[proc 3] 2000 steps, sample: 1.755, forward: 4.563, backward: 2.592, update: 5.094
[proc 2][Train](2000/10000) average pos_loss: 0.06038087695837021
[proc 2][Train](2000/10000) average neg_loss: 0.08933405692502856
[proc 2][Train](2000/10000) average loss: 0.0748574669547379
[proc 2][Train](2000/10000) average regularization: 1.777396059696912e-05
[proc 2][Train] 1000 steps take 14.537 seconds
[proc 2] 2000 steps, sample: 1.663, forward: 4.689, backward: 2.730, update: 4.933
[proc 0][Train](3000/10000) average pos_loss: 0.05220263200253248
[proc 0][Train](3000/10000) average neg_loss: 0.07903668811544776
[proc 0][Train](3000/10000) average loss: 0.06561965996026993
[proc 0][Train](3000/10000) average regularization: 1.9648302584755584e-05
[proc 0][Train] 1000 steps take 14.252 seconds
[proc 0] 3000 steps, sample: 1.807, forward: 4.942, backward: 2.588, update: 4.906
[proc 2][Train](3000/10000) average pos_loss: 0.052501871705055235
[proc 2][Train](3000/10000) average neg_loss: 0.07915351999551058
[proc 2][Train](3000/10000) average loss: 0.06582769587263465
[proc 2][Train](3000/10000) average regularization: 1.964277591650898e-05
[proc 2][Train] 1000 steps take 14.252 seconds
[proc 2] 3000 steps, sample: 1.687, forward: 4.728, backward: 2.679, update: 4.993
[proc 3][Train](3000/10000) average pos_loss: 0.052260007232427595
[proc 3][Train](3000/10000) average neg_loss: 0.07945198951661586
[proc 3][Train](3000/10000) average loss: 0.06585599833726882
[proc 3][Train](3000/10000) average regularization: 1.9630454798971185e-05
[proc 3][Train] 1000 steps take 14.253 seconds
[proc 3] 3000 steps, sample: 1.741, forward: 4.485, backward: 2.580, update: 5.061
[proc 1][Train](3000/10000) average pos_loss: 0.052266200423240664
[proc 1][Train](3000/10000) average neg_loss: 0.07923799358680844
[proc 1][Train](3000/10000) average loss: 0.06575209696218372
[proc 1][Train](3000/10000) average regularization: 1.9668575027026234e-05
[proc 1][Train] 1000 steps take 14.253 seconds
[proc 1] 3000 steps, sample: 1.764, forward: 4.946, backward: 2.543, update: 4.893
[proc 1][Train](4000/10000) average pos_loss: 0.0485905974060297
[proc 1][Train](4000/10000) average neg_loss: 0.0744725099503994
[proc 1][Train](4000/10000) average loss: 0.061531553734093906
[proc 1][Train](4000/10000) average regularization: 2.0845204335273593e-05
[proc 1][Train] 1000 steps take 14.174 seconds
[proc 1] 4000 steps, sample: 1.752, forward: 4.957, backward: 2.557, update: 4.899
[proc 0][Train](4000/10000) average pos_loss: 0.04824984512478113
[proc 0][Train](4000/10000) average neg_loss: 0.07421393332630397
[proc 0][Train](4000/10000) average loss: 0.061231889341026545
[proc 0][Train](4000/10000) average regularization: 2.0820585370529444e-05
[proc 0][Train] 1000 steps take 14.176 seconds
[proc 0] 4000 steps, sample: 1.728, forward: 4.916, backward: 2.579, update: 4.922
[proc 2][Train](4000/10000) average pos_loss: 0.0484646698012948
[proc 2][Train](4000/10000) average neg_loss: 0.07425185930728913
[proc 2][Train](4000/10000) average loss: 0.061358264628797766
[proc 2][Train](4000/10000) average regularization: 2.08156264579884e-05
[proc 2][Train] 1000 steps take 14.176 seconds
[proc 2] 4000 steps, sample: 1.620, forward: 4.622, backward: 3.002, update: 4.758
[proc 3][Train](4000/10000) average pos_loss: 0.04835917924717069
[proc 3][Train](4000/10000) average neg_loss: 0.07435054307803511
[proc 3][Train](4000/10000) average loss: 0.061354861088097096
[proc 3][Train](4000/10000) average regularization: 2.0808071729334188e-05
[proc 3][Train] 1000 steps take 14.175 seconds
[proc 3] 4000 steps, sample: 1.719, forward: 4.489, backward: 2.596, update: 5.034
[proc 1][Train](5000/10000) average pos_loss: 0.04630860024318099
[proc 1][Train](5000/10000) average neg_loss: 0.07131563487276435
[proc 1][Train](5000/10000) average loss: 0.0588121175840497
[proc 1][Train](5000/10000) average regularization: 2.172309202251199e-05
[proc 1][Train] 1000 steps take 14.979 seconds
[proc 1] 5000 steps, sample: 2.515, forward: 4.933, backward: 2.613, update: 4.908
[proc 0][Train](5000/10000) average pos_loss: 0.04607300635054708
[proc 0][Train](5000/10000) average neg_loss: 0.0713113773688674
[proc 0][Train](5000/10000) average loss: 0.058692191835492846
[proc 0][Train](5000/10000) average regularization: 2.16986757786799e-05
[proc 0][Train] 1000 steps take 14.978 seconds
[proc 0] 5000 steps, sample: 2.487, forward: 4.924, backward: 2.621, update: 4.908
[proc 2][Train](5000/10000) average pos_loss: 0.04600303242728114
[proc 2][Train](5000/10000) average neg_loss: 0.07140888197347522
[proc 2][Train](5000/10000) average loss: 0.05870595712587237
[proc 2][Train](5000/10000) average regularization: 2.1657693698216463e-05
[proc 2][Train] 1000 steps take 14.979 seconds
[proc 2] 5000 steps, sample: 1.854, forward: 4.749, backward: 2.715, update: 4.977
[proc 3][Train](5000/10000) average pos_loss: 0.045999297838658096
[proc 3][Train](5000/10000) average neg_loss: 0.0714953698143363
[proc 3][Train](5000/10000) average loss: 0.058747333630919454
[proc 3][Train](5000/10000) average regularization: 2.1677731408999534e-05
[proc 3][Train] 1000 steps take 14.979 seconds
[proc 3] 5000 steps, sample: 1.972, forward: 4.910, backward: 2.675, update: 5.106
[proc 0][Train](6000/10000) average pos_loss: 0.04425369876250625
[proc 0][Train](6000/10000) average neg_loss: 0.06938305138796567
[proc 0][Train](6000/10000) average loss: 0.05681837509945035
[proc 0][Train](6000/10000) average regularization: 2.236119596636854e-05
[proc 0][Train] 1000 steps take 14.317 seconds
[proc 0] 6000 steps, sample: 1.741, forward: 4.973, backward: 2.551, update: 4.949
[proc 3][Train](6000/10000) average pos_loss: 0.044464093580842017
[proc 3][Train](6000/10000) average neg_loss: 0.06931788792461156
[proc 3][Train](6000/10000) average loss: 0.05689099073782563
[proc 3][Train](6000/10000) average regularization: 2.236637761416205e-05
[proc 3][Train] 1000 steps take 14.316 seconds
[proc 3] 6000 steps, sample: 1.817, forward: 4.765, backward: 2.598, update: 5.126
[proc 1][Train](6000/10000) average pos_loss: 0.04449311655014753
[proc 1][Train](6000/10000) average neg_loss: 0.06935489289090037
[proc 1][Train](6000/10000) average loss: 0.056924004759639504
[proc 1][Train](6000/10000) average regularization: 2.238552463313681e-05
[proc 1][Train] 1000 steps take 14.318 seconds
[proc 1] 6000 steps, sample: 1.754, forward: 4.978, backward: 2.547, update: 4.932
[proc 2][Train](6000/10000) average pos_loss: 0.04460362826287746
[proc 2][Train](6000/10000) average neg_loss: 0.06927614298090339
[proc 2][Train](6000/10000) average loss: 0.05693988554552198
[proc 2][Train](6000/10000) average regularization: 2.2352369720465505e-05
[proc 2][Train] 1000 steps take 14.317 seconds
[proc 2] 6000 steps, sample: 1.718, forward: 4.741, backward: 2.673, update: 5.005
[proc 0][Train](7000/10000) average pos_loss: 0.04309551012888551
[proc 0][Train](7000/10000) average neg_loss: 0.0677364049628377
[proc 0][Train](7000/10000) average loss: 0.05541595754772425
[proc 0][Train](7000/10000) average regularization: 2.2925208671949804e-05
[proc 0][Train] 1000 steps take 14.228 seconds
[proc 0] 7000 steps, sample: 1.767, forward: 4.952, backward: 2.596, update: 4.902
[proc 2][Train](7000/10000) average pos_loss: 0.04330419458821416
[proc 2][Train](7000/10000) average neg_loss: 0.06766928699985146
[proc 2][Train](7000/10000) average loss: 0.055486740805208684
[proc 2][Train](7000/10000) average regularization: 2.291471637727227e-05
[proc 2][Train] 1000 steps take 14.228 seconds
[proc 2] 7000 steps, sample: 1.750, forward: 4.765, backward: 2.692, update: 5.014
[proc 1][Train](7000/10000) average pos_loss: 0.043319819159805775
[proc 1][Train](7000/10000) average neg_loss: 0.06787310625612736
[proc 1][Train](7000/10000) average loss: 0.05559646272286773
[proc 1][Train](7000/10000) average regularization: 2.294491579232272e-05
[proc 1][Train] 1000 steps take 14.228 seconds
[proc 1] 7000 steps, sample: 1.758, forward: 4.941, backward: 2.585, update: 4.859
[proc 3][Train](7000/10000) average pos_loss: 0.043029633786529305
[proc 3][Train](7000/10000) average neg_loss: 0.06786486073210836
[proc 3][Train](7000/10000) average loss: 0.055447247222065926
[proc 3][Train](7000/10000) average regularization: 2.2919052958968677e-05
[proc 3][Train] 1000 steps take 14.229 seconds
[proc 3] 7000 steps, sample: 1.802, forward: 4.588, backward: 2.637, update: 5.050
[proc 0][Train](8000/10000) average pos_loss: 0.04222825771197677
[proc 0][Train](8000/10000) average neg_loss: 0.06652581371739506
[proc 0][Train](8000/10000) average loss: 0.054377035792917014
[proc 0][Train](8000/10000) average regularization: 2.3405453888699412e-05
[proc 0][Train] 1000 steps take 14.306 seconds
[proc 0] 8000 steps, sample: 1.767, forward: 4.985, backward: 2.592, update: 4.953
[proc 1][Train](8000/10000) average pos_loss: 0.0424925296343863
[proc 1][Train](8000/10000) average neg_loss: 0.06666442083194851
[proc 1][Train](8000/10000) average loss: 0.054578475285321476
[proc 1][Train](8000/10000) average regularization: 2.3429929078702117e-05
[proc 1][Train] 1000 steps take 14.306 seconds
[proc 1] 8000 steps, sample: 1.741, forward: 5.008, backward: 2.601, update: 4.925
[proc 3][Train](8000/10000) average pos_loss: 0.04225240286439657
[proc 3][Train](8000/10000) average neg_loss: 0.06676087710633874
[proc 3][Train](8000/10000) average loss: 0.05450663992390037
[proc 3][Train](8000/10000) average regularization: 2.3401121581628105e-05
[proc 3][Train] 1000 steps take 14.306 seconds
[proc 3] 8000 steps, sample: 1.786, forward: 4.649, backward: 2.633, update: 5.074
[proc 2][Train](8000/10000) average pos_loss: 0.04228821847587824
[proc 2][Train](8000/10000) average neg_loss: 0.06661444997042418
[proc 2][Train](8000/10000) average loss: 0.054451334226876494
[proc 2][Train](8000/10000) average regularization: 2.338612861785805e-05
[proc 2][Train] 1000 steps take 14.307 seconds
[proc 2] 8000 steps, sample: 1.610, forward: 4.721, backward: 2.675, update: 4.946
[proc 0][Train](9000/10000) average pos_loss: 0.04151628852263093
[proc 0][Train](9000/10000) average neg_loss: 0.06568588995188475
[proc 0][Train](9000/10000) average loss: 0.053601089205592874
[proc 0][Train](9000/10000) average regularization: 2.3813223177057808e-05
[proc 0][Train] 1000 steps take 14.271 seconds
[proc 0] 9000 steps, sample: 1.758, forward: 4.994, backward: 2.571, update: 4.940
[proc 1][Train](9000/10000) average pos_loss: 0.04176923185959459
[proc 1][Train](9000/10000) average neg_loss: 0.06567587354779243
[proc 1][Train](9000/10000) average loss: 0.0537225526496768
[proc 1][Train](9000/10000) average regularization: 2.384254091157345e-05
[proc 1][Train] 1000 steps take 14.271 seconds
[proc 1] 9000 steps, sample: 1.760, forward: 4.980, backward: 2.597, update: 4.918
[proc 3][Train](9000/10000) average pos_loss: 0.04140550814568997
[proc 3][Train](9000/10000) average neg_loss: 0.06573379254341126
[proc 3][Train](9000/10000) average loss: 0.053569650404155254
[proc 3][Train](9000/10000) average regularization: 2.381143005186459e-05
[proc 3][Train] 1000 steps take 14.271 seconds
[proc 3] 9000 steps, sample: 1.768, forward: 4.519, backward: 2.586, update: 5.075
[proc 2][Train](9000/10000) average pos_loss: 0.04156867415085435
[proc 2][Train](9000/10000) average neg_loss: 0.06566237118467688
[proc 2][Train](9000/10000) average loss: 0.053615522678941485
[proc 2][Train](9000/10000) average regularization: 2.380311820343195e-05
[proc 2][Train] 1000 steps take 14.272 seconds
[proc 2] 9000 steps, sample: 1.628, forward: 4.678, backward: 2.530, update: 4.997
[proc 0][Train](10000/10000) average pos_loss: 0.04086046624556184
[proc 0][Train](10000/10000) average neg_loss: 0.06491921692714095
[proc 0][Train](10000/10000) average loss: 0.052889841571450234
[proc 0][Train](10000/10000) average regularization: 2.4176819539206918e-05
[proc 0][Train] 1000 steps take 14.442 seconds
[proc 0] 10000 steps, sample: 1.861, forward: 5.025, backward: 2.594, update: 4.952
proc 0 takes 146.453 seconds
[proc 3][Train](10000/10000) average pos_loss: 0.0407825092561543
[proc 3][Train](10000/10000) average neg_loss: 0.06492728568986059
[proc 3][Train](10000/10000) average loss: 0.05285489746183157
[proc 3][Train](10000/10000) average regularization: 2.4175876980734758e-05
[proc 3][Train] 1000 steps take 14.442 seconds
[proc 3] 10000 steps, sample: 1.934, forward: 4.504, backward: 2.561, update: 5.092
proc 3 takes 146.322 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.041097444675862786
[proc 1][Train](10000/10000) average neg_loss: 0.06502490773797036
[proc 1][Train](10000/10000) average loss: 0.05306117619201541
[proc 1][Train](10000/10000) average regularization: 2.4200946963901515e-05
[proc 1][Train] 1000 steps take 14.442 seconds
[proc 1] 10000 steps, sample: 1.848, forward: 5.022, backward: 2.603, update: 4.946
[proc 2][Train](10000/10000) average pos_loss: 0.041081246841698886
[proc 2][Train](10000/10000) average neg_loss: 0.06491859723627567
[proc 2][Train](10000/10000) average loss: 0.052999922040849926
[proc 2][Train](10000/10000) average regularization: 2.4169486405298812e-05
[proc 2][Train] 1000 steps take 14.441 seconds
[proc 2] 10000 steps, sample: 1.836, forward: 4.810, backward: 2.683, update: 5.053
proc 1 takes 146.395 seconds
proc 2 takes 146.379 seconds
Successfully xmh. training takes 147.04118180274963 seconds
