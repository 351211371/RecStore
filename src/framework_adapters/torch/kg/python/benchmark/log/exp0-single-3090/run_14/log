Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
|Train|: 304727650
random partition 304727650 edges into 5 parts
part 0 has 60945530 edges
part 1 has 60945530 edges
part 2 has 60945530 edges
part 3 has 60945530 edges
part 4 has 60945530 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=False, batch_size=1000, batch_size_eval=16, data_files=None, data_path='data', dataset='Freebase', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3, 4], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=86054151, no_eval_filter=False, no_save_emb=True, nr_gpus=5, num_proc=5, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='ckpts/TransE_l1_Freebase_14', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 16929318
|test|: 16929308
Total initialize time 719.098 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 4][Train](1000/10000) average pos_loss: 0.6724407956600189
[proc 4][Train](1000/10000) average neg_loss: 0.6866366766691208
[proc 4][Train](1000/10000) average loss: 0.6795387362837791
[proc 4][Train](1000/10000) average regularization: 8.442266230758833e-06
[proc 4] 1000 steps, total: 37.861, sample: 15.566, forward: 13.058, backward: 2.848, update: 6.381
[proc 2][Train](1000/10000) average pos_loss: 0.6701407405734062
[proc 2][Train](1000/10000) average neg_loss: 0.6893499919772148
[proc 2][Train](1000/10000) average loss: 0.6797453657388687
[proc 2][Train](1000/10000) average regularization: 8.382168064144934e-06
[proc 2] 1000 steps, total: 38.985, sample: 14.517, forward: 13.187, backward: 2.837, update: 6.545
[proc 0][Train](1000/10000) average pos_loss: 0.6712758430093527
[proc 0][Train](1000/10000) average neg_loss: 0.694880994617939
[proc 0][Train](1000/10000) average loss: 0.6830784182548523
[proc 0][Train](1000/10000) average regularization: 8.316621515405132e-06
[proc 0] 1000 steps, total: 40.087, sample: 14.127, forward: 13.096, backward: 2.870, update: 6.489
[proc 1][Train](1000/10000) average pos_loss: 0.6766259116530419
[proc 1][Train](1000/10000) average neg_loss: 0.6939557447731495
[proc 1][Train](1000/10000) average loss: 0.6852908280491828
[proc 1][Train](1000/10000) average regularization: 8.312303541515576e-06
[proc 1] 1000 steps, total: 39.522, sample: 13.793, forward: 12.921, backward: 2.850, update: 6.496
[proc 3][Train](1000/10000) average pos_loss: 0.6714204868674278
[proc 3][Train](1000/10000) average neg_loss: 0.6874507429599762
[proc 3][Train](1000/10000) average loss: 0.6794356148838997
[proc 3][Train](1000/10000) average regularization: 8.415136412622815e-06
[proc 3] 1000 steps, total: 38.440, sample: 14.868, forward: 12.977, backward: 2.849, update: 6.571
[proc 2][Train](2000/10000) average pos_loss: 0.6907273380160331
[proc 2][Train](2000/10000) average neg_loss: 0.6802774879336357
[proc 2][Train](2000/10000) average loss: 0.6855024136900901
[proc 2][Train](2000/10000) average regularization: 7.243688037306128e-06
[proc 2] 2000 steps, total: 19.776, sample: 2.548, forward: 7.930, backward: 2.856, update: 6.433
[proc 3][Train](2000/10000) average pos_loss: 0.6891888164281845
[proc 3][Train](2000/10000) average neg_loss: 0.679870145380497
[proc 3][Train](2000/10000) average loss: 0.6845294818282127
[proc 3][Train](2000/10000) average regularization: 7.23422028886489e-06
[proc 3] 2000 steps, total: 19.776, sample: 2.525, forward: 7.773, backward: 2.864, update: 6.464
[proc 0][Train](2000/10000) average pos_loss: 0.6890263034105301
[proc 0][Train](2000/10000) average neg_loss: 0.6802856523394585
[proc 0][Train](2000/10000) average loss: 0.6846559783816337
[proc 0][Train](2000/10000) average regularization: 7.254039021518111e-06
[proc 0] 2000 steps, total: 19.776, sample: 2.463, forward: 7.797, backward: 2.791, update: 6.388
[proc 1][Train](2000/10000) average pos_loss: 0.689288757443428
[proc 1][Train](2000/10000) average neg_loss: 0.680303844332695
[proc 1][Train](2000/10000) average loss: 0.6847963003516198
[proc 1][Train](2000/10000) average regularization: 7.2629463156772544e-06
[proc 1] 2000 steps, total: 19.776, sample: 2.392, forward: 7.655, backward: 2.905, update: 6.198
[proc 4][Train](2000/10000) average pos_loss: 0.6894659104347229
[proc 4][Train](2000/10000) average neg_loss: 0.6802208877205849
[proc 4][Train](2000/10000) average loss: 0.6848433996438981
[proc 4][Train](2000/10000) average regularization: 7.254972042119334e-06
[proc 4] 2000 steps, total: 19.779, sample: 2.556, forward: 7.770, backward: 2.816, update: 6.269
[proc 0][Train](3000/10000) average pos_loss: 0.6992721337676048
[proc 0][Train](3000/10000) average neg_loss: 0.6716780523061753
[proc 0][Train](3000/10000) average loss: 0.6854750928282738
[proc 0][Train](3000/10000) average regularization: 6.4719167858129365e-06
[proc 0] 3000 steps, total: 18.382, sample: 2.500, forward: 6.673, backward: 2.834, update: 6.367
[proc 4][Train](3000/10000) average pos_loss: 0.6983895180225372
[proc 4][Train](3000/10000) average neg_loss: 0.6728646610975265
[proc 4][Train](3000/10000) average loss: 0.6856270897984504
[proc 4][Train](3000/10000) average regularization: 6.466439083851583e-06
[proc 4] 3000 steps, total: 18.381, sample: 2.581, forward: 6.616, backward: 2.850, update: 6.237
[proc 3][Train](3000/10000) average pos_loss: 0.698859690964222
[proc 3][Train](3000/10000) average neg_loss: 0.6719536583423614
[proc 3][Train](3000/10000) average loss: 0.6854066749215126
[proc 3][Train](3000/10000) average regularization: 6.468716705057887e-06
[proc 3] 3000 steps, total: 18.383, sample: 2.475, forward: 6.643, backward: 2.640, update: 6.498
[proc 2][Train](3000/10000) average pos_loss: 0.6981627215743065
[proc 2][Train](3000/10000) average neg_loss: 0.671514716386795
[proc 2][Train](3000/10000) average loss: 0.6848387198448181
[proc 2][Train](3000/10000) average regularization: 6.46998005822752e-06
[proc 2] 3000 steps, total: 18.384, sample: 2.662, forward: 6.494, backward: 2.802, update: 6.328
[proc 1][Train](3000/10000) average pos_loss: 0.6988656986355781
[proc 1][Train](3000/10000) average neg_loss: 0.6715150762200356
[proc 1][Train](3000/10000) average loss: 0.6851903873682023
[proc 1][Train](3000/10000) average regularization: 6.47531658069056e-06
[proc 1] 3000 steps, total: 18.383, sample: 2.476, forward: 6.475, backward: 2.815, update: 6.195
[proc 2][Train](4000/10000) average pos_loss: 0.7050991831421852
[proc 2][Train](4000/10000) average neg_loss: 0.6625950319170952
[proc 2][Train](4000/10000) average loss: 0.6838471077084541
[proc 2][Train](4000/10000) average regularization: 6.492121882729407e-06
[proc 2] 4000 steps, total: 18.116, sample: 2.507, forward: 6.331, backward: 2.851, update: 6.419
[proc 3][Train](4000/10000) average pos_loss: 0.7047048686146736
[proc 3][Train](4000/10000) average neg_loss: 0.6630418961048126
[proc 3][Train](4000/10000) average loss: 0.683873382806778
[proc 3][Train](4000/10000) average regularization: 6.491554389867815e-06
[proc 3] 4000 steps, total: 18.116, sample: 2.404, forward: 6.099, backward: 2.758, update: 6.206
[proc 1][Train](4000/10000) average pos_loss: 0.7049292818307876
[proc 1][Train](4000/10000) average neg_loss: 0.6627420335412025
[proc 1][Train](4000/10000) average loss: 0.6838356572985649
[proc 1][Train](4000/10000) average regularization: 6.493142784165684e-06
[proc 1] 4000 steps, total: 18.116, sample: 2.359, forward: 6.138, backward: 2.796, update: 6.215
[proc 0][Train](4000/10000) average pos_loss: 0.7052426024079322
[proc 0][Train](4000/10000) average neg_loss: 0.664496671795845
[proc 0][Train](4000/10000) average loss: 0.6848696372509002
[proc 0][Train](4000/10000) average regularization: 6.490516425856186e-06
[proc 0] 4000 steps, total: 18.117, sample: 2.383, forward: 6.211, backward: 2.826, update: 6.205
[proc 4][Train](4000/10000) average pos_loss: 0.7042720400691033
[proc 4][Train](4000/10000) average neg_loss: 0.661701076745987
[proc 4][Train](4000/10000) average loss: 0.6829865603446961
[proc 4][Train](4000/10000) average regularization: 6.496162821804319e-06
[proc 4] 4000 steps, total: 18.117, sample: 2.500, forward: 6.213, backward: 2.821, update: 6.263
[proc 2][Train](5000/10000) average pos_loss: 0.7076912801861763
[proc 2][Train](5000/10000) average neg_loss: 0.6536948809623718
[proc 2][Train](5000/10000) average loss: 0.6806930801272393
[proc 2][Train](5000/10000) average regularization: 6.640074019287568e-06
[proc 2] 5000 steps, total: 18.139, sample: 2.726, forward: 6.218, backward: 2.820, update: 6.366
[proc 1][Train](5000/10000) average pos_loss: 0.7082631664276123
[proc 1][Train](5000/10000) average neg_loss: 0.6529460636973381
[proc 1][Train](5000/10000) average loss: 0.6806046152710915
[proc 1][Train](5000/10000) average regularization: 6.633868803419318e-06
[proc 1] 5000 steps, total: 18.139, sample: 2.570, forward: 5.926, backward: 2.812, update: 6.175
[proc 4][Train](5000/10000) average pos_loss: 0.7092478812932969
[proc 4][Train](5000/10000) average neg_loss: 0.6523604570031166
[proc 4][Train](5000/10000) average loss: 0.6808041706085205
[proc 4][Train](5000/10000) average regularization: 6.631324949466943e-06
[proc 4] 5000 steps, total: 18.139, sample: 2.742, forward: 5.971, backward: 2.794, update: 5.997
[proc 3][Train](5000/10000) average pos_loss: 0.707179099559784
[proc 3][Train](5000/10000) average neg_loss: 0.6524055072069168
[proc 3][Train](5000/10000) average loss: 0.6797923033833504
[proc 3][Train](5000/10000) average regularization: 6.636200054799701e-06
[proc 3] 5000 steps, total: 18.140, sample: 2.613, forward: 5.914, backward: 2.853, update: 6.228
[proc 0][Train](5000/10000) average pos_loss: 0.7099131354689598
[proc 0][Train](5000/10000) average neg_loss: 0.6525697650909423
[proc 0][Train](5000/10000) average loss: 0.6812414511442184
[proc 0][Train](5000/10000) average regularization: 6.635935206304566e-06
[proc 0] 5000 steps, total: 18.139, sample: 2.712, forward: 5.953, backward: 2.794, update: 6.254
[proc 4][Train](6000/10000) average pos_loss: 0.7101607021093369
[proc 4][Train](6000/10000) average neg_loss: 0.6442381246685982
[proc 4][Train](6000/10000) average loss: 0.6771994134783745
[proc 4][Train](6000/10000) average regularization: 6.785188877984183e-06
[proc 4] 6000 steps, total: 17.580, sample: 2.448, forward: 6.098, backward: 2.870, update: 6.156
[proc 3][Train](6000/10000) average pos_loss: 0.7109699254631996
[proc 3][Train](6000/10000) average neg_loss: 0.6434140543341637
[proc 3][Train](6000/10000) average loss: 0.6771919896006584
[proc 3][Train](6000/10000) average regularization: 6.78973324056642e-06
[proc 3] 6000 steps, total: 17.581, sample: 2.513, forward: 5.869, backward: 2.806, update: 6.215
[proc 2][Train](6000/10000) average pos_loss: 0.7095511819124222
[proc 2][Train](6000/10000) average neg_loss: 0.6431473958492279
[proc 2][Train](6000/10000) average loss: 0.6763492882847786
[proc 2][Train](6000/10000) average regularization: 6.78576193513436e-06
[proc 2] 6000 steps, total: 17.582, sample: 2.413, forward: 5.990, backward: 2.840, update: 6.236
[proc 1][Train](6000/10000) average pos_loss: 0.7101254410743714
[proc 1][Train](6000/10000) average neg_loss: 0.6441311079859734
[proc 1][Train](6000/10000) average loss: 0.6771282740235328
[proc 1][Train](6000/10000) average regularization: 6.7806674605890295e-06
[proc 1] 6000 steps, total: 17.581, sample: 2.265, forward: 5.717, backward: 2.783, update: 6.086
[proc 0][Train](6000/10000) average pos_loss: 0.7097427228093147
[proc 0][Train](6000/10000) average neg_loss: 0.6437691847681999
[proc 0][Train](6000/10000) average loss: 0.6767559540271759
[proc 0][Train](6000/10000) average regularization: 6.787538489788858e-06
[proc 0] 6000 steps, total: 17.581, sample: 2.330, forward: 5.854, backward: 2.778, update: 6.120
[proc 0][Train](7000/10000) average pos_loss: 0.7100425544381141
[proc 0][Train](7000/10000) average neg_loss: 0.6334505667388439
[proc 0][Train](7000/10000) average loss: 0.671746562063694
[proc 0][Train](7000/10000) average regularization: 6.940762852536864e-06
[proc 0] 7000 steps, total: 17.538, sample: 2.560, forward: 5.941, backward: 2.825, update: 6.205
[proc 2][Train](7000/10000) average pos_loss: 0.7092620623111725
[proc 2][Train](7000/10000) average neg_loss: 0.6340726926922798
[proc 2][Train](7000/10000) average loss: 0.6716673775315285
[proc 2][Train](7000/10000) average regularization: 6.9420349364008874e-06
[proc 2] 7000 steps, total: 17.539, sample: 2.610, forward: 5.898, backward: 2.766, update: 6.170
[proc 4][Train](7000/10000) average pos_loss: 0.7107027124166488
[proc 4][Train](7000/10000) average neg_loss: 0.6332079796791077
[proc 4][Train](7000/10000) average loss: 0.6719553465843201
[proc 4][Train](7000/10000) average regularization: 6.9352277564576074e-06
[proc 4] 7000 steps, total: 17.540, sample: 2.571, forward: 5.962, backward: 2.932, update: 5.866
[proc 1][Train](7000/10000) average pos_loss: 0.710080413222313
[proc 1][Train](7000/10000) average neg_loss: 0.6348346661925316
[proc 1][Train](7000/10000) average loss: 0.6724575393795967
[proc 1][Train](7000/10000) average regularization: 6.935938931292185e-06
[proc 1] 7000 steps, total: 17.540, sample: 2.365, forward: 5.656, backward: 2.917, update: 5.918
[proc 3][Train](7000/10000) average pos_loss: 0.7096494386792183
[proc 3][Train](7000/10000) average neg_loss: 0.6334378129839897
[proc 3][Train](7000/10000) average loss: 0.6715436265468597
[proc 3][Train](7000/10000) average regularization: 6.939037294614536e-06
[proc 3] 7000 steps, total: 17.540, sample: 2.384, forward: 5.865, backward: 2.849, update: 6.101
[proc 1][Train](8000/10000) average pos_loss: 0.7091380318403244
[proc 1][Train](8000/10000) average neg_loss: 0.6240428084135056
[proc 1][Train](8000/10000) average loss: 0.6665904201269149
[proc 1][Train](8000/10000) average regularization: 7.087424818109866e-06
[proc 1] 8000 steps, total: 17.507, sample: 2.330, forward: 5.694, backward: 2.719, update: 6.028
[proc 2][Train](8000/10000) average pos_loss: 0.7098630036115646
[proc 2][Train](8000/10000) average neg_loss: 0.6236480659842492
[proc 2][Train](8000/10000) average loss: 0.6667555351257324
[proc 2][Train](8000/10000) average regularization: 7.092037844813604e-06
[proc 2] 8000 steps, total: 17.508, sample: 2.457, forward: 6.033, backward: 2.832, update: 6.178
[proc 4][Train](8000/10000) average pos_loss: 0.7095695106387139
[proc 4][Train](8000/10000) average neg_loss: 0.6246115132570267
[proc 4][Train](8000/10000) average loss: 0.6670905124545098
[proc 4][Train](8000/10000) average regularization: 7.081803959863464e-06
[proc 4] 8000 steps, total: 17.508, sample: 2.418, forward: 5.924, backward: 2.818, update: 6.077
[proc 3][Train](8000/10000) average pos_loss: 0.7083960886001587
[proc 3][Train](8000/10000) average neg_loss: 0.6245445717573166
[proc 3][Train](8000/10000) average loss: 0.6664703306555748
[proc 3][Train](8000/10000) average regularization: 7.0859585089237956e-06
[proc 3] 8000 steps, total: 17.508, sample: 2.369, forward: 5.925, backward: 2.801, update: 6.142
[proc 0][Train](8000/10000) average pos_loss: 0.708998167514801
[proc 0][Train](8000/10000) average neg_loss: 0.6234547820687294
[proc 0][Train](8000/10000) average loss: 0.6662264743447304
[proc 0][Train](8000/10000) average regularization: 7.0889756821088665e-06
[proc 0] 8000 steps, total: 17.509, sample: 2.426, forward: 5.913, backward: 2.819, update: 6.091
[proc 3][Train](9000/10000) average pos_loss: 0.7058839920759201
[proc 3][Train](9000/10000) average neg_loss: 0.6137277973592281
[proc 3][Train](9000/10000) average loss: 0.6598058940172196
[proc 3][Train](9000/10000) average regularization: 7.225037820717261e-06
[proc 3] 9000 steps, total: 17.446, sample: 2.519, forward: 5.940, backward: 2.786, update: 6.193
[proc 4][Train](9000/10000) average pos_loss: 0.706655225276947
[proc 4][Train](9000/10000) average neg_loss: 0.6139647682309151
[proc 4][Train](9000/10000) average loss: 0.6603099967837334
[proc 4][Train](9000/10000) average regularization: 7.226712625651999e-06
[proc 4] 9000 steps, total: 17.446, sample: 2.620, forward: 5.873, backward: 2.799, update: 6.027
[proc 0][Train](9000/10000) average pos_loss: 0.7065455331802368
[proc 0][Train](9000/10000) average neg_loss: 0.6140189809799195
[proc 0][Train](9000/10000) average loss: 0.6602822569012642
[proc 0][Train](9000/10000) average regularization: 7.228720537568734e-06
[proc 0] 9000 steps, total: 17.446, sample: 2.549, forward: 5.725, backward: 2.789, update: 6.060
[proc 1][Train](9000/10000) average pos_loss: 0.7066020894646644
[proc 1][Train](9000/10000) average neg_loss: 0.6133469025790691
[proc 1][Train](9000/10000) average loss: 0.6599744962453842
[proc 1][Train](9000/10000) average regularization: 7.227141787552682e-06
[proc 1] 9000 steps, total: 17.447, sample: 2.486, forward: 5.733, backward: 2.797, update: 5.923
[proc 2][Train](9000/10000) average pos_loss: 0.7058944924473762
[proc 2][Train](9000/10000) average neg_loss: 0.6139515449106693
[proc 2][Train](9000/10000) average loss: 0.6599230191111565
[proc 2][Train](9000/10000) average regularization: 7.228571852465393e-06
[proc 2] 9000 steps, total: 17.448, sample: 2.704, forward: 5.804, backward: 2.665, update: 6.026
[proc 4][Train](10000/10000) average pos_loss: 0.7021010487079621
[proc 4][Train](10000/10000) average neg_loss: 0.6040264787971974
[proc 4][Train](10000/10000) average loss: 0.6530637636780738
[proc 4][Train](10000/10000) average regularization: 7.363570300185529e-06
[proc 4] 10000 steps, total: 17.311, sample: 2.536, forward: 5.935, backward: 2.891, update: 5.941
proc 4 takes 199.664 seconds
[proc 0][Train](10000/10000) average pos_loss: 0.7021394376158714
[proc 0][Train](10000/10000) average neg_loss: 0.604332132011652
[proc 0][Train](10000/10000) average loss: 0.6532357853651046
[proc 0][Train](10000/10000) average regularization: 7.358270740951412e-06
[proc 0] 10000 steps, total: 17.311, sample: 2.475, forward: 5.900, backward: 2.847, update: 6.033
proc 0 takes 201.889 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.7037709501981735
[proc 2][Train](10000/10000) average neg_loss: 0.6031959355771541
[proc 2][Train](10000/10000) average loss: 0.6534834430217743
[proc 2][Train](10000/10000) average regularization: 7.365668298007222e-06
[proc 2] 10000 steps, total: 17.311, sample: 2.469, forward: 6.000, backward: 2.910, update: 5.917
proc 2 takes 200.789 seconds
[proc 3][Train](10000/10000) average pos_loss: 0.702267218530178
[proc 3][Train](10000/10000) average neg_loss: 0.6044861932098865
[proc 3][Train](10000/10000) average loss: 0.6533767051100731
[proc 3][Train](10000/10000) average regularization: 7.356518307460646e-06
[proc 3] 10000 steps, total: 17.312, sample: 2.426, forward: 5.817, backward: 2.896, update: 5.912
proc 3 takes 200.243 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.7031838986873626
[proc 1][Train](10000/10000) average neg_loss: 0.6037444885075093
[proc 1][Train](10000/10000) average loss: 0.6534641947746277
[proc 1][Train](10000/10000) average regularization: 7.360408807926433e-06
[proc 1] 10000 steps, total: 17.312, sample: 2.339, forward: 5.709, backward: 2.894, update: 5.884
proc 1 takes 201.325 seconds
Successfully xmh. training takes 217.74287939071655 seconds
