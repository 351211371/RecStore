WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240210 16:40:50.911981 59304 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240210 16:40:50.915452 59304 IPCTensor.h:369] NewIPCTensor: full_emb [10000000, 32]0x100000002000 1.192 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [59304 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f360d51d8a0>==========
Worker 1 pid=59514
Worker 2 pid=59515
Worker 3 pid=59516
Worker 4 pid=59517
Worker 5 pid=59518
Worker 6 pid=59519
INFO [59304 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [59514 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [59515 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [59516 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [59517 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [59518 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [59517 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59519 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [59516 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59520 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [59518 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59519 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59520 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59304 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240210 16:41:07.784296 59517 IPCTensor.h:348] IPCTensor full_emb already exists
E20240210 16:41:07.784504 59518 IPCTensor.h:348] IPCTensor full_emb already exists
E20240210 16:41:07.784508 59516 IPCTensor.h:348] IPCTensor full_emb already exists
E20240210 16:41:07.784504 59519 IPCTensor.h:348] IPCTensor full_emb already exists
E20240210 16:41:07.784511 59520 IPCTensor.h:348] IPCTensor full_emb already exists
E20240210 16:41:07.785019 59304 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [59515 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240210 16:41:07.786775 59515 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [59514 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240210 16:41:07.788132 59514 IPCTensor.h:348] IPCTensor full_emb already exists
W20240210 16:41:13.418658 59520 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [100000, 32]; dev=7; size=12.21 MB
W20240210 16:41:13.420759 59518 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [100000, 32]; dev=5; size=12.21 MB
W20240210 16:41:13.420907 59515 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [100000, 32]; dev=2; size=12.21 MB
W20240210 16:41:13.420881 59514 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [100000, 32]; dev=1; size=12.21 MB
W20240210 16:41:13.420917 59519 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [100000, 32]; dev=6; size=12.21 MB
W20240210 16:41:13.421300 59517 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [100000, 32]; dev=4; size=12.21 MB
W20240210 16:41:13.421615 59516 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [100000, 32]; dev=3; size=12.21 MB
W20240210 16:41:13.428377 59304 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [100000, 32]; dev=0; size=12.21 MB
W20240210 16:41:16.723207 59514 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10004c4ba000 7.629 MB
W20240210 16:41:16.723395 59514 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10004cc5d000 7.629 MB
W20240210 16:41:16.723484 59514 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10004d400000 122.1 MB
W20240210 16:41:16.723531 59514 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100054e14000 122.1 MB
W20240210 16:41:16.723569 59514 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240210 16:41:16.724624 59514 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240210 16:41:16.744330 59515 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10005c82e000 7.629 MB
W20240210 16:41:16.744539 59515 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10005cfd1000 7.629 MB
W20240210 16:41:16.744634 59515 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10005d774000 122.1 MB
W20240210 16:41:16.744683 59515 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100065188000 122.1 MB
W20240210 16:41:16.744720 59515 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240210 16:41:16.745433 59515 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240210 16:41:16.764094 59517 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10006cba4000 7.629 MB
W20240210 16:41:16.764276 59517 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10006d347000 7.629 MB
W20240210 16:41:16.764340 59517 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10006daea000 122.1 MB
W20240210 16:41:16.764386 59517 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x1000754fe000 122.1 MB
W20240210 16:41:16.764425 59517 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240210 16:41:16.764446 59520 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10007cf12000 7.629 MB
W20240210 16:41:16.764644 59520 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10007d6b5000 7.629 MB
W20240210 16:41:16.764729 59520 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x10007de58000 122.1 MB
W20240210 16:41:16.764779 59520 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x10008586c000 122.1 MB
W20240210 16:41:16.764823 59520 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240210 16:41:16.829670 59519 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10008d284000 7.629 MB
W20240210 16:41:16.829874 59519 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10008da27000 7.629 MB
W20240210 16:41:16.829938 59519 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x10008e1ca000 122.1 MB
W20240210 16:41:16.829988 59519 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x100095bde000 122.1 MB
W20240210 16:41:16.830031 59519 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240210 16:41:16.830106 59518 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10009d5f2000 7.629 MB
W20240210 16:41:16.830298 59518 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10009dd97000 7.629 MB
W20240210 16:41:16.830379 59518 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10009e53a000 122.1 MB
W20240210 16:41:16.830360 59520 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240210 16:41:16.830426 59518 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x1000a5f4e000 122.1 MB
W20240210 16:41:16.830468 59518 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240210 16:41:16.832449 59519 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240210 16:41:16.833599 59518 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240210 16:41:16.847697 59517 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240210 16:41:16.854758 59516 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000ad972000 7.629 MB
W20240210 16:41:16.855141 59516 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000ae115000 7.629 MB
W20240210 16:41:16.855324 59516 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x1000ae8b8000 122.1 MB
W20240210 16:41:16.855479 59516 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000b62cc000 122.1 MB
W20240210 16:41:16.855592 59516 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240210 16:41:16.860946 59516 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240210 16:41:16.880308 59304 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000bdce6000 7.629 MB
W20240210 16:41:16.880613 59304 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000be489000 7.629 MB
W20240210 16:41:16.880681 59304 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x1000bec2c000 122.1 MB
W20240210 16:41:16.880755 59304 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000c6640000 122.1 MB
W20240210 16:41:16.880793 59304 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240210 16:41:16.881162 59304 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
Worker 7 pid=59520
New CachedEmbedding, name=full_emb, shape=(10000000, 32), cache_type=KnownLocalCachedEmbeddingSoftware
fixed cache_range is [(0, 100000), (100000, 200000), (200000, 300000), (300000, 400000), (400000, 500000), (500000, 600000), (600000, 700000), (700000, 800000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240210 16:41:17.330654 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000ce058000 7.629 MB
W20240210 16:41:17.330747 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000cef9e000 7.629 MB
W20240210 16:41:17.330744 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000ce7fb000 7.629 MB
W20240210 16:41:17.330767 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000cf741000 7.629 MB
W20240210 16:41:17.330780 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000d0687000 7.629 MB
W20240210 16:41:17.330821 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000d1d70000 7.629 MB
W20240210 16:41:17.330816 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000d15cd000 7.629 MB
W20240210 16:41:17.330812 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000d0e2a000 7.629 MB
W20240210 16:41:17.330796 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000cfee4000 7.629 MB
W20240210 16:41:17.330909 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000d2513000 7.629 MB
W20240210 16:41:17.330948 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000d2cb6000 7.629 MB
W20240210 16:41:17.330953 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000d3459000 7.629 MB
W20240210 16:41:17.330973 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000d3bfc000 7.629 MB
W20240210 16:41:17.331017 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000d439f000 7.629 MB
W20240210 16:41:17.331033 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000d4b42000 7.629 MB
W20240210 16:41:17.331048 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000d52e5000 7.629 MB
W20240210 16:41:17.331054 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000d5a88000 7.629 MB
W20240210 16:41:17.331059 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000d622b000 7.629 MB
W20240210 16:41:17.331073 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000d69ce000 7.629 MB
W20240210 16:41:17.331089 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000d7171000 7.629 MB
W20240210 16:41:17.331095 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000d7914000 7.629 MB
W20240210 16:41:17.331110 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000d80b7000 7.629 MB
W20240210 16:41:17.331136 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d885a000 7.629 MB
W20240210 16:41:17.331148 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000d8ffd000 7.629 MB
W20240210 16:41:17.331159 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000d97a0000 7.629 MB
W20240210 16:41:17.331166 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000d9f43000 7.629 MB
W20240210 16:41:17.331180 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000da6e6000 7.629 MB
W20240210 16:41:17.331187 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000dae89000 7.629 MB
W20240210 16:41:17.331192 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000db62c000 7.629 MB
W20240210 16:41:17.331224 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000dbdcf000 7.629 MB
W20240210 16:41:17.331229 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000dc572000 7.629 MB
W20240210 16:41:17.331238 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000dcd15000 7.629 MB
W20240210 16:41:17.331243 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000dd4b8000 7.629 MB
W20240210 16:41:17.331259 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000ddc5b000 7.629 MB
W20240210 16:41:17.331291 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000de3fe000 7.629 MB
W20240210 16:41:17.331296 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000deba1000 7.629 MB
W20240210 16:41:17.331302 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000df344000 7.629 MB
W20240210 16:41:17.331317 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000dfae7000 7.629 MB
W20240210 16:41:17.331341 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000e028a000 7.629 MB
W20240210 16:41:17.331362 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000e0a2d000 7.629 MB
W20240210 16:41:17.331367 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000e11d0000 7.629 MB
W20240210 16:41:17.331385 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000e1973000 7.629 MB
W20240210 16:41:17.331393 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000e2116000 7.629 MB
W20240210 16:41:17.331398 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000e28b9000 7.629 MB
W20240210 16:41:17.331405 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000e305c000 7.629 MB
W20240210 16:41:17.331431 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000e37ff000 7.629 MB
W20240210 16:41:17.331447 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000e3fa2000 7.629 MB
W20240210 16:41:17.331470 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000e4745000 7.629 MB
W20240210 16:41:17.331478 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000e4ee8000 7.629 MB
W20240210 16:41:17.331485 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000e568b000 7.629 MB
W20240210 16:41:17.331499 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000e5e2e000 7.629 MB
W20240210 16:41:17.331506 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000e65d1000 7.629 MB
W20240210 16:41:17.331532 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000e6d74000 7.629 MB
W20240210 16:41:17.331552 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000e7517000 7.629 MB
W20240210 16:41:17.331568 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000e7cba000 7.629 MB
W20240210 16:41:17.331573 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000e845d000 7.629 MB
W20240210 16:41:17.331593 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000e8c00000 7.629 MB
W20240210 16:41:17.331600 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000e93a3000 7.629 MB
W20240210 16:41:17.331607 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000e9b46000 7.629 MB
W20240210 16:41:17.331614 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000ea2e9000 7.629 MB
W20240210 16:41:17.331624 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000eaa8c000 7.629 MB
W20240210 16:41:17.331665 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000eb22f000 7.629 MB
W20240210 16:41:17.331681 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000eb9d2000 7.629 MB
W20240210 16:41:17.331699 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000ec175000 7.629 MB
W20240210 16:41:17.331708 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000ec918000 7.629 MB
W20240210 16:41:17.331712 59304 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000ed0bb000 7.629 MB
W20240210 16:41:17.331720 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000ed85e000 7.629 MB
W20240210 16:41:17.331725 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000ee001000 7.629 MB
W20240210 16:41:17.331769 59518 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000ee7a4000 7.629 MB
W20240210 16:41:17.331774 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000eef47000 7.629 MB
W20240210 16:41:17.331781 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000ef6ea000 7.629 MB
W20240210 16:41:17.331800 59304 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000efe8d000 80 B 
W20240210 16:41:17.331810 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000efe8f000 7.629 MB
W20240210 16:41:17.331836 59514 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000f0632000 7.629 MB
W20240210 16:41:17.331842 59515 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000f0dd5000 7.629 MB
W20240210 16:41:17.331849 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000f1578000 7.629 MB
W20240210 16:41:17.331871 59304 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000f1d1b000 8 B 
W20240210 16:41:17.331876 59518 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000f1d1d000 80 B 
W20240210 16:41:17.331880 59516 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000f1d1f000 7.629 MB
W20240210 16:41:17.331904 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000f24c2000 7.629 MB
W20240210 16:41:17.331910 59514 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000f2c65000 80 B 
W20240210 16:41:17.331915 59517 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000f2c67000 7.629 MB
W20240210 16:41:17.331924 59515 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000f340a000 80 B 
W20240210 16:41:17.331930 59304 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000f340c000 8 B 
W20240210 16:41:17.331952 59516 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000f340e000 80 B 
W20240210 16:41:17.331955 59518 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000f3410000 8 B 
W20240210 16:41:17.331975 59514 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000f3412000 8 B 
W20240210 16:41:17.331980 59520 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000f3414000 7.629 MB
W20240210 16:41:17.331987 59515 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000f3bb7000 8 B 
W20240210 16:41:17.331992 59517 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000f3bb9000 80 B 
W20240210 16:41:17.332006 59519 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000f3bbb000 7.629 MB
W20240210 16:41:17.332013 59516 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000f435e000 8 B 
W20240210 16:41:17.332031 59518 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000f4360000 8 B 
W20240210 16:41:17.332043 59514 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000f4362000 8 B 
W20240210 16:41:17.332062 59515 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000f4364000 8 B 
W20240210 16:41:17.332068 59517 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000f4366000 8 B 
W20240210 16:41:17.332075 59516 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000f4368000 8 B 
W20240210 16:41:17.332082 59520 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000f436a000 80 B 
W20240210 16:41:17.332083 59519 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000f436c000 80 B 
W20240210 16:41:17.332120 59517 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000f436e000 8 B 
W20240210 16:41:17.332158 59520 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000f4370000 8 B 
W20240210 16:41:17.332165 59519 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000f4372000 8 B 
W20240210 16:41:17.332216 59519 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000f4374000 8 B 
W20240210 16:41:17.332218 59520 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000f4376000 8 B 
Construct PerfSampler done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct PerfSampler done
Construct PerfSampler done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct PerfSampler done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240210 16:41:17.332720 59516 recstore.cc:66] init folly done
E20240210 16:41:17.332751 59514 recstore.cc:66] init folly done
E20240210 16:41:17.332866 59518 recstore.cc:66] init folly done
E20240210 16:41:17.332867 59517 recstore.cc:66] init folly done
E20240210 16:41:17.332878 59515 recstore.cc:66] init folly done
E20240210 16:41:17.332991 59519 recstore.cc:66] init folly done
E20240210 16:41:17.332991 59520 recstore.cc:66] init folly done
E20240210 16:41:17.333004 59304 recstore.cc:66] init folly done
Before Training
I20240210 16:41:17.372116 59516 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240210 16:41:17.373319 59518 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240210 16:41:17.373345 59517 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240210 16:41:17.383523 59304 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240210 16:41:17.404027 59514 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240210 16:41:17.404088 59515 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240210 16:41:17.405473 59519 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240210 16:41:17.405501 59520 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.142 us                | 130.142 us                |
| GenInput                  | 510.602 us                | 510.602 us                |
| bucket keys               | 68.005 ms                 | 68.005 ms                 |
| forward: join             | 451.897 ms                | 451.897 ms                |
| forward: NN               | 33.514 ms                 | 33.514 ms                 |
| Forward                   | 631.436 ms                | 631.436 ms                |
| back: bucket keys         | 1.870 ms                  | 1.870 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 143.381 us                | 258.210 us                |
| GenInput                  | 694.948 us                | 1.423 ms                  |
| bucket keys               | 843.304 us                | 77.226 ms                 |
| forward: join             | 1.335 ms                  | 451.897 ms                |
| forward: NN               | 95.877 us                 | 33.514 ms                 |
| Forward                   | 15.576 ms                 | 631.436 ms                |
| back: bucket keys         | 428.984 us                | 1.870 ms                  |
| back: a2a                 | 56.379 ms                 | 51.644 s                  |
| back: cache               | 1.762 ms                  | 24.852 ms                 |
| back: aggr dram keys      | 20.705 ms                 | 882.177 ms                |
| back: set dram grad       | 197.856 us                | 1.167 ms                  |
| Backward                  | 124.678 ms                | 52.570 s                  |
| Optimize                  | 10.761 ms                 | 30.670 ms                 |
| OneStep                   | 153.970 ms                | 53.234 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.140 us                | 497.278 us                |
| GenInput                  | 734.084 us                | 2.126 ms                  |
| bucket keys               | 639.127 us                | 77.226 ms                 |
| forward: join             | 14.634 ms                 | 451.897 ms                |
| forward: NN               | 84.158 us                 | 33.514 ms                 |
| Forward                   | 30.238 ms                 | 631.436 ms                |
| back: bucket keys         | 413.560 us                | 1.870 ms                  |
| back: a2a                 | 69.358 ms                 | 51.644 s                  |
| back: cache               | 1.685 ms                  | 24.852 ms                 |
| back: aggr dram keys      | 20.183 ms                 | 882.177 ms                |
| back: set dram grad       | 202.554 us                | 1.167 ms                  |
| Backward                  | 111.000 ms                | 52.570 s                  |
| Optimize                  | 13.082 ms                 | 30.670 ms                 |
| OneStep                   | 153.738 ms                | 53.234 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.416 us                | 338.570 us                |
| GenInput                  | 733.440 us                | 1.890 ms                  |
| bucket keys               | 642.040 us                | 68.467 ms                 |
| forward: join             | 15.891 ms                 | 92.342 ms                 |
| forward: NN               | 85.696 us                 | 191.542 us                |
| Forward                   | 32.020 ms                 | 93.688 ms                 |
| back: bucket keys         | 416.213 us                | 827.125 us                |
| back: a2a                 | 69.819 ms                 | 123.060 ms                |
| back: cache               | 1.672 ms                  | 2.567 ms                  |
| back: aggr dram keys      | 20.328 ms                 | 32.393 ms                 |
| back: set dram grad       | 200.013 us                | 316.632 us                |
| Backward                  | 109.707 ms                | 147.873 ms                |
| Optimize                  | 14.199 ms                 | 29.413 ms                 |
| OneStep                   | 155.141 ms                | 177.945 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank0, time: 68.740, per_step: 0.687399
Step99:rank4, time: 68.740, per_step: 0.687400
Step99:rank6, time: 68.740, per_step: 0.687399
========== Step 100 ========== 
Step99:rank7, time: 68.740, per_step: 0.687400
Step99:rank3, time: 68.740, per_step: 0.687401
========== Step 100 ========== 
Step99:rank5, time: 68.740, per_step: 0.687401
========== Step 100 ========== 
Step99:rank1, time: 68.740, per_step: 0.687402
========== Step 100 ========== 
Step99:rank2, time: 68.740, per_step: 0.687400
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.140 us                | 343.088 us                |
| GenInput                  | 734.084 us                | 3.085 ms                  |
| bucket keys               | 642.040 us                | 68.467 ms                 |
| forward: join             | 16.086 ms                 | 92.342 ms                 |
| forward: NN               | 86.689 us                 | 33.514 ms                 |
| Forward                   | 34.232 ms                 | 93.688 ms                 |
| back: bucket keys         | 416.416 us                | 827.125 us                |
| back: a2a                 | 70.485 ms                 | 124.022 ms                |
| back: cache               | 1.687 ms                  | 2.567 ms                  |
| back: aggr dram keys      | 20.267 ms                 | 32.393 ms                 |
| back: set dram grad       | 200.939 us                | 316.632 us                |
| Backward                  | 106.114 ms                | 147.873 ms                |
| Optimize                  | 13.778 ms                 | 29.413 ms                 |
| OneStep                   | 154.648 ms                | 177.945 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 121.912 us                | 343.088 us                |
| GenInput                  | 739.365 us                | 3.085 ms                  |
| bucket keys               | 644.233 us                | 68.467 ms                 |
| forward: join             | 16.399 ms                 | 92.342 ms                 |
| forward: NN               | 88.842 us                 | 34.975 ms                 |
| Forward                   | 33.998 ms                 | 93.688 ms                 |
| back: bucket keys         | 417.483 us                | 827.125 us                |
| back: a2a                 | 70.473 ms                 | 124.022 ms                |
| back: cache               | 1.713 ms                  | 2.567 ms                  |
| back: aggr dram keys      | 20.183 ms                 | 32.393 ms                 |
| back: set dram grad       | 200.461 us                | 316.632 us                |
| Backward                  | 106.114 ms                | 147.873 ms                |
| Optimize                  | 13.445 ms                 | 29.413 ms                 |
| OneStep                   | 154.648 ms                | 177.945 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.013 us                | 343.088 us                |
| GenInput                  | 734.084 us                | 3.085 ms                  |
| bucket keys               | 639.127 us                | 68.467 ms                 |
| forward: join             | 16.399 ms                 | 92.342 ms                 |
| forward: NN               | 88.274 us                 | 34.975 ms                 |
| Forward                   | 32.020 ms                 | 93.688 ms                 |
| back: bucket keys         | 417.483 us                | 827.125 us                |
| back: a2a                 | 70.473 ms                 | 124.022 ms                |
| back: cache               | 1.712 ms                  | 5.210 ms                  |
| back: aggr dram keys      | 20.257 ms                 | 35.069 ms                 |
| back: set dram grad       | 198.913 us                | 316.632 us                |
| Backward                  | 106.528 ms                | 154.276 ms                |
| Optimize                  | 13.992 ms                 | 29.413 ms                 |
| OneStep                   | 156.408 ms                | 181.478 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.107 us                | 338.570 us                |
| GenInput                  | 733.440 us                | 2.575 ms                  |
| bucket keys               | 643.104 us                | 68.005 ms                 |
| forward: join             | 15.615 ms                 | 89.190 ms                 |
| forward: NN               | 88.800 us                 | 33.514 ms                 |
| Forward                   | 31.367 ms                 | 90.691 ms                 |
| back: bucket keys         | 418.282 us                | 827.125 us                |
| back: a2a                 | 69.819 ms                 | 123.060 ms                |
| back: cache               | 1.713 ms                  | 2.580 ms                  |
| back: aggr dram keys      | 20.101 ms                 | 32.393 ms                 |
| back: set dram grad       | 198.692 us                | 313.246 us                |
| Backward                  | 107.186 ms                | 147.873 ms                |
| Optimize                  | 14.150 ms                 | 24.589 ms                 |
| OneStep                   | 156.403 ms                | 181.478 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
Step199:rank5, time: 15.739, per_step: 0.155834
Step199:rank1, time: 15.739, per_step: 0.155832
Successfully xmh
Step199:rank0, time: 15.739, per_step: 0.155836
Successfully xmh
Step199:rank4, time: 15.739, per_step: 0.155836
Step199:rank2, time: 15.739, per_step: 0.155830
Step199:rank3, time: 15.739, per_step: 0.155835
Step199:rank7, time: 15.739, per_step: 0.155835
Successfully xmh
Step199:rank6, time: 15.739, per_step: 0.155836
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 118.515 us                | 393.482 us                |
| GenInput                  | 753.822 us                | 2.575 ms                  |
| bucket keys               | 641.008 us                | 68.005 ms                 |
| forward: join             | 16.104 ms                 | 89.190 ms                 |
| forward: NN               | 89.069 us                 | 33.514 ms                 |
| Forward                   | 32.948 ms                 | 90.691 ms                 |
| back: bucket keys         | 418.061 us                | 827.125 us                |
| back: a2a                 | 69.727 ms                 | 123.060 ms                |
| back: cache               | 1.706 ms                  | 2.580 ms                  |
| back: aggr dram keys      | 20.101 ms                 | 32.393 ms                 |
| back: set dram grad       | 198.616 us                | 313.246 us                |
| Backward                  | 106.336 ms                | 147.873 ms                |
| Optimize                  | 13.992 ms                 | 24.589 ms                 |
| OneStep                   | 156.408 ms                | 181.478 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 118.515 us                | 393.482 us                |
| GenInput                  | 753.822 us                | 2.575 ms                  |
| bucket keys               | 641.008 us                | 68.005 ms                 |
| forward: join             | 16.104 ms                 | 89.190 ms                 |
| forward: NN               | 89.069 us                 | 33.514 ms                 |
| Forward                   | 32.948 ms                 | 90.691 ms                 |
| back: bucket keys         | 418.061 us                | 827.125 us                |
| back: a2a                 | 69.727 ms                 | 123.060 ms                |
| back: cache               | 1.706 ms                  | 2.580 ms                  |
| back: aggr dram keys      | 20.101 ms                 | 32.393 ms                 |
| back: set dram grad       | 198.616 us                | 313.246 us                |
| Backward                  | 106.336 ms                | 147.873 ms                |
| Optimize                  | 13.992 ms                 | 24.589 ms                 |
| OneStep                   | 156.408 ms                | 181.478 ms                |
+---------------------------+---------------------------+---------------------------+
