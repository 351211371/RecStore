WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240217 17:12:51.002046 14319 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240217 17:12:51.012157 14319 IPCTensor.h:369] NewIPCTensor: full_emb [10000000, 32]0x100000002000 1.192 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [14319 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f9efe50db20>==========
Worker 1 pid=14583
Worker 2 pid=14584
Worker 3 pid=14585
Worker 4 pid=14586
Worker 5 pid=14587
Worker 6 pid=14588
INFO [14319 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [14583 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [14584 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [14585 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [14586 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [14587 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [14588 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [14589 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [14586 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14587 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14589 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14588 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14319 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14583 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14585 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14584 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 17:12:57.395753 14319 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:12:57.395761 14589 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:12:57.395839 14587 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:12:57.396312 14583 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:12:57.396360 14588 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:12:57.396354 14586 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:12:57.397310 14584 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:12:57.398350 14585 IPCTensor.h:348] IPCTensor full_emb already exists
W20240217 17:13:02.979983 14585 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1000000, 32]; dev=3; size=122.1 MB
W20240217 17:13:02.980078 14586 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1000000, 32]; dev=4; size=122.1 MB
W20240217 17:13:02.980168 14584 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1000000, 32]; dev=2; size=122.1 MB
W20240217 17:13:02.980182 14588 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1000000, 32]; dev=6; size=122.1 MB
W20240217 17:13:02.980404 14319 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1000000, 32]; dev=0; size=122.1 MB
W20240217 17:13:02.980826 14589 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1000000, 32]; dev=7; size=122.1 MB
W20240217 17:13:02.980906 14583 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1000000, 32]; dev=1; size=122.1 MB
W20240217 17:13:02.981021 14587 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1000000, 32]; dev=5; size=122.1 MB
W20240217 17:13:03.712652 14584 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10004c4ba000 7.629 MB
W20240217 17:13:03.712859 14584 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10004cc5d000 7.629 MB
W20240217 17:13:03.712922 14584 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10004d400000 122.1 MB
W20240217 17:13:03.712970 14584 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100054e14000 122.1 MB
W20240217 17:13:03.713024 14584 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 17:13:03.728740 14584 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 17:13:03.742386 14586 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10005c82e000 7.629 MB
W20240217 17:13:03.742560 14586 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10005cfd1000 7.629 MB
W20240217 17:13:03.742625 14586 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10005d774000 122.1 MB
W20240217 17:13:03.742666 14586 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100065188000 122.1 MB
W20240217 17:13:03.742705 14586 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 17:13:03.756629 14587 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10006cb9e000 7.629 MB
W20240217 17:13:03.756780 14587 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10006d341000 7.629 MB
W20240217 17:13:03.756843 14587 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10006dae4000 122.1 MB
W20240217 17:13:03.756906 14587 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x1000754f8000 122.1 MB
W20240217 17:13:03.756940 14587 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 17:13:03.757506 14586 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 17:13:03.757943 14587 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 17:13:03.773641 14585 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10007cf16000 7.629 MB
W20240217 17:13:03.773783 14585 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10007d6b9000 7.629 MB
W20240217 17:13:03.773849 14585 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10007de5c000 122.1 MB
W20240217 17:13:03.773895 14585 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100085870000 122.1 MB
W20240217 17:13:03.773931 14585 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 17:13:03.775372 14585 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 17:13:03.879079 14319 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10008d28a000 7.629 MB
W20240217 17:13:03.879316 14319 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10008da2d000 7.629 MB
W20240217 17:13:03.879381 14319 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10008e1d0000 122.1 MB
W20240217 17:13:03.879424 14319 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100095be4000 122.1 MB
W20240217 17:13:03.879465 14319 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 17:13:03.923146 14319 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 17:13:03.948172 14589 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10009d5fe000 7.629 MB
W20240217 17:13:03.948447 14589 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10009dda5000 7.629 MB
W20240217 17:13:03.948547 14583 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10009e548000 7.629 MB
W20240217 17:13:03.948599 14589 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x10009eceb000 122.1 MB
W20240217 17:13:03.948747 14583 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000ae113000 7.629 MB
W20240217 17:13:03.948743 14589 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000a66ff000 122.1 MB
W20240217 17:13:03.948855 14583 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1000af059000 122.1 MB
W20240217 17:13:03.948827 14588 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1000ae8b6000 7.629 MB
W20240217 17:13:03.948868 14589 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 17:13:03.948913 14583 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000b6a6d000 122.1 MB
W20240217 17:13:03.948961 14583 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 17:13:03.949182 14588 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000be481000 7.629 MB
W20240217 17:13:03.949374 14588 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x1000bec24000 122.1 MB
W20240217 17:13:03.949520 14588 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x1000c6638000 122.1 MB
W20240217 17:13:03.949632 14588 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 17:13:03.951184 14588 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 17:13:03.952000 14589 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 17:13:03.952069 14583 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
Worker 7 pid=14589
New CachedEmbedding, name=full_emb, shape=(10000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1000000), (1000000, 2000000), (2000000, 3000000), (3000000, 4000000), (4000000, 5000000), (5000000, 6000000), (6000000, 7000000), (7000000, 8000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
W20240217 17:13:04.361850 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000ce058000 7.629 MB
W20240217 17:13:04.361891 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000ce7fb000 7.629 MB
W20240217 17:13:04.361919 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000cef9e000 7.629 MB
W20240217 17:13:04.361954 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000cf741000 7.629 MB
W20240217 17:13:04.361994 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000d0687000 7.629 MB
W20240217 17:13:04.361995 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000cfee4000 7.629 MB
W20240217 17:13:04.362037 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000d0e2a000 7.629 MB
W20240217 17:13:04.362046 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000d15cd000 7.629 MB
W20240217 17:13:04.362056 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000d1d70000 7.629 MB
W20240217 17:13:04.362071 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000d2513000 7.629 MB
W20240217 17:13:04.362087 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000d2cb6000 7.629 MB
W20240217 17:13:04.362139 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000d3bfc000 7.629 MB
W20240217 17:13:04.362129 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000d3459000 7.629 MB
W20240217 17:13:04.362180 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000d439f000 7.629 MB
W20240217 17:13:04.362185 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000d4b42000 7.629 MB
W20240217 17:13:04.362187 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000d52e5000 7.629 MB
W20240217 17:13:04.362215 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000d5a88000 7.629 MB
W20240217 17:13:04.362242 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000d7171000 7.629 MB
W20240217 17:13:04.362229 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000d622b000 7.629 MB
W20240217 17:13:04.362242 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000d69ce000 7.629 MB
W20240217 17:13:04.362275 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d7914000 7.629 MB
W20240217 17:13:04.362293 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000d80b7000 7.629 MB
W20240217 17:13:04.362304 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000d8ffd000 7.629 MB
W20240217 17:13:04.362303 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000d885a000 7.629 MB
W20240217 17:13:04.362329 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000d97a0000 7.629 MB
W20240217 17:13:04.362337 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000d9f43000 7.629 MB
W20240217 17:13:04.362351 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000da6e6000 7.629 MB
W20240217 17:13:04.362412 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000dae89000 7.629 MB
W20240217 17:13:04.362414 14319 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000db62c000 7.629 MB
W20240217 17:13:04.362421 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000dbdcf000 7.629 MB
W20240217 17:13:04.362448 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000dc572000 7.629 MB
W20240217 17:13:04.362454 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000dcd15000 7.629 MB
W20240217 17:13:04.362468 14319 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000dd4b8000 80 B 
W20240217 17:13:04.362507 14319 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000ddc5d000 8 B 
W20240217 17:13:04.362505 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000dd4ba000 7.629 MB
W20240217 17:13:04.362522 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000ddc5f000 7.629 MB
W20240217 17:13:04.362527 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000de402000 7.629 MB
W20240217 17:13:04.362561 14319 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000dfaeb000 8 B 
W20240217 17:13:04.362551 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000deba5000 7.629 MB
W20240217 17:13:04.362561 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000df348000 7.629 MB
W20240217 17:13:04.362586 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000dfaed000 7.629 MB
W20240217 17:13:04.362591 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000e0290000 7.629 MB
W20240217 17:13:04.362598 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000e0a33000 7.629 MB
W20240217 17:13:04.362604 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000e11d6000 7.629 MB
W20240217 17:13:04.362623 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000e1979000 7.629 MB
W20240217 17:13:04.362670 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000e211c000 7.629 MB
W20240217 17:13:04.362675 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000e28bf000 7.629 MB
W20240217 17:13:04.362708 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000e3062000 7.629 MB
W20240217 17:13:04.362715 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000e3805000 7.629 MB
W20240217 17:13:04.362725 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000e3fa8000 7.629 MB
W20240217 17:13:04.362742 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000e474b000 7.629 MB
W20240217 17:13:04.362764 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000e4eee000 7.629 MB
W20240217 17:13:04.362771 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000e5691000 7.629 MB
W20240217 17:13:04.362826 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000e65d7000 7.629 MB
W20240217 17:13:04.362819 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000e5e34000 7.629 MB
W20240217 17:13:04.362840 14586 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000e6d7a000 7.629 MB
W20240217 17:13:04.362848 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000e751d000 7.629 MB
W20240217 17:13:04.362864 14589 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000e7cc0000 7.629 MB
Construct PerfSampler done
W20240217 17:13:04.362893 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000e8463000 7.629 MB
W20240217 17:13:04.362922 14586 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000e8c06000 80 B 
W20240217 17:13:04.362936 14589 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000e8c08000 80 B 
W20240217 17:13:04.362941 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000e8c0a000 7.629 MB
W20240217 17:13:04.362967 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000e9b50000 7.629 MB
W20240217 17:13:04.362960 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000e93ad000 7.629 MB
W20240217 17:13:04.362994 14589 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000eaa96000 8 B 
I20240217 17:13:04.362994 14319 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240217 17:13:04.362999 14586 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000eaa98000 8 B 
W20240217 17:13:04.362989 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000ea2f3000 7.629 MB
W20240217 17:13:04.363006 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000eaa9a000 7.629 MB
W20240217 17:13:04.363034 14588 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000eb23d000 7.629 MB
W20240217 17:13:04.363052 14589 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000eb9e0000 8 B 
W20240217 17:13:04.363059 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000eb9e2000 7.629 MB
W20240217 17:13:04.363070 14586 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000ec185000 8 B 
W20240217 17:13:04.363117 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000ec187000 7.629 MB
W20240217 17:13:04.363142 14588 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000ec92a000 80 B 
W20240217 17:13:04.363152 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000ec92c000 7.629 MB
W20240217 17:13:04.363164 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000ed0cf000 7.629 MB
W20240217 17:13:04.363173 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000ed872000 7.629 MB
W20240217 17:13:04.363219 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000ee015000 7.629 MB
W20240217 17:13:04.363226 14588 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000ee7b8000 8 B 
W20240217 17:13:04.363255 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000ee7ba000 7.629 MB
W20240217 17:13:04.363293 14587 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000eef5d000 7.629 MB
W20240217 17:13:04.363310 14588 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000ef700000 8 B 
W20240217 17:13:04.363320 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000ef702000 7.629 MB
W20240217 17:13:04.363340 14584 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000efea5000 7.629 MB
W20240217 17:13:04.363350 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000f0648000 7.629 MB
W20240217 17:13:04.363407 14587 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000f0deb000 80 B 
W20240217 17:13:04.363443 14584 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000f0ded000 80 B 
Construct PerfSampler done
Construct PerfSampler done
W20240217 17:13:04.363458 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000f0def000 7.629 MB
W20240217 17:13:04.363476 14587 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000f1592000 8 B 
W20240217 17:13:04.363484 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000f1594000 7.629 MB
W20240217 17:13:04.363514 14584 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000f1d37000 8 B 
W20240217 17:13:04.363546 14587 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000f1d39000 8 B 
W20240217 17:13:04.363584 14584 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000f1d3b000 8 B 
W20240217 17:13:04.363605 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000f1d3d000 7.629 MB
W20240217 17:13:04.363638 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000f24e0000 7.629 MB
I20240217 17:13:04.363706 14589 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240217 17:13:04.363725 14586 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 17:13:04.363726 14583 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000f2c83000 7.629 MB
Construct PerfSampler done
W20240217 17:13:04.363768 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000f3426000 7.629 MB
W20240217 17:13:04.363865 14585 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000f3bc9000 7.629 MB
I20240217 17:13:04.363878 14588 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 17:13:04.363899 14583 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000f436c000 80 B 
W20240217 17:13:04.363986 14583 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000f436e000 8 B 
Construct PerfSampler done
Construct PerfSampler done
W20240217 17:13:04.364017 14585 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000f4370000 80 B 
W20240217 17:13:04.364104 14583 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000f4372000 8 B 
W20240217 17:13:04.364125 14585 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000f4374000 8 B 
I20240217 17:13:04.364147 14584 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240217 17:13:04.364174 14587 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 17:13:04.364202 14585 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000f4376000 8 B 
Construct PerfSampler done
Construct PerfSampler done
I20240217 17:13:04.364795 14583 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240217 17:13:04.364898 14585 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 17:13:04.367280 14319 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16,
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240217 17:13:04.367446 14319 grad_base.h:184] Init GradProcessingBase done
I20240217 17:13:05.577286 14319 grad_async_v2.h:42] Use main thread to update emb.
W20240217 17:13:05.577625 14319 kg_controller.h:78] after init GradAsyncProcessingV2
I20240217 17:13:05.577637 14319 kg_controller.h:84] Construct KGCacheController done
E20240217 17:13:06.380685 14319 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 17:13:06.383682 14589 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 17:13:06.384112 14586 recstore.cc:66] init folly done
E20240217 17:13:06.384112 14588 recstore.cc:66] init folly done
E20240217 17:13:06.384119 14585 recstore.cc:66] init folly done
E20240217 17:13:06.384171 14587 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240217 17:13:06.384543 14583 recstore.cc:66] init folly done
E20240217 17:13:06.384542 14584 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240217 17:13:06.385416 14319 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240217 17:13:07.268471 15849 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240217 17:13:07.268779 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240217 17:13:08.268018 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240217 17:13:08.290118 15849 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240217 17:13:09.268011 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
W20240217 17:13:09.298424 15849 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
Before Training
I20240217 17:13:09.778338 14319 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240217 17:13:09.833720 14584 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:13:09.861287 14585 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:13:09.895715 14586 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:13:09.922858 14587 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:13:09.949496 14588 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:13:09.976840 14589 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:13:10.009403 14583 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 156.719 us                | 354.295 us                |
| ProcessBack:Shuffle       | 434.356 ms                | 434.356 ms                |
+---------------------------+---------------------------+---------------------------+
E20240217 17:13:11.881011 16505 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240217 17:13:11.972653 14319 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240217 17:13:12.034706 15849 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
E20240217 17:13:12.880023 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=958
W20240217 17:13:13.094229 15849 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
E20240217 17:13:13.880009 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=10445
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
W20240217 17:13:14.176873 15849 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 171.067 us                | 1.213 ms                  |
| GenInput                  | 4.522 ms                  | 16.343 ms                 |
| forward: NN               | 109.299 us                | 53.879 ms                 |
| Forward                   | 485.165 us                | 58.252 ms                 |
| Backward                  | 1.073 ms                  | 26.830 ms                 |
| Optimize                  | 242.482 us                | 727.481 us                |
| BarrierTimeBeforeRank0    | 1.689 ms                  | 36.626 ms                 |
| AfterBackward             | 272.722 ms                | 1.820 s                   |
| BlockToStepN              | 133.515 us                | 61.202 ms                 |
| OneStep                   | 277.481 ms                | 2.025 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240217 17:13:14.880080 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=8981
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240217 17:13:15.229830 15849 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240217 17:13:15.880141 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=1835
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
W20240217 17:13:16.249750 15849 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 288.427 us                | 42.006 ms                 |
| ProcessBack:Shuffle       | 246.408 ms                | 434.356 ms                |
| ProcessBack:UpdateCache   | 20.582 ms                 | 1.279 s                   |
| ProcessBack:UpsertPq      | 64.046 us                 | 91.669 ms                 |
| ProcessOneStep            | 267.867 ms                | 1.819 s                   |
| BlockToStepN              | 50.848 us                 | 60.761 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
E20240217 17:13:16.884017 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=389
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
W20240217 17:13:17.269742 15849 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
E20240217 17:13:17.884095 15876 parallel_pq_v2.h:79] insert failed, size(hashtable)=17318
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
W20240217 17:13:18.344521 15849 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
E20240217 17:13:18.884012 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=9622
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 150.685 us                | 1.213 ms                  |
| GenInput                  | 2.042 ms                  | 16.343 ms                 |
| forward: NN               | 103.543 us                | 53.879 ms                 |
| Forward                   | 447.217 us                | 58.252 ms                 |
| Backward                  | 996.569 us                | 26.830 ms                 |
| Optimize                  | 178.206 us                | 964.064 us                |
| BarrierTimeBeforeRank0    | 782.823 us                | 36.626 ms                 |
| AfterBackward             | 266.471 ms                | 1.820 s                   |
| BlockToStepN              | 180.486 us                | 61.202 ms                 |
| OneStep                   | 270.826 ms                | 2.025 s                   |
+---------------------------+---------------------------+---------------------------+
W20240217 17:13:19.494699 15849 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
E20240217 17:13:19.884011 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=4566
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
W20240217 17:13:20.558192 15849 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
E20240217 17:13:20.884030 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=5327
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 330.721 us                | 43.981 ms                 |
| ProcessBack:Shuffle       | 240.252 ms                | 434.356 ms                |
| ProcessBack:UpdateCache   | 19.032 ms                 | 1.279 s                   |
| ProcessBack:UpsertPq      | 67.607 us                 | 91.669 ms                 |
| ProcessOneStep            | 258.012 ms                | 1.819 s                   |
| BlockToStepN              | 105.681 us                | 60.761 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
W20240217 17:13:21.595170 15849 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
E20240217 17:13:21.884020 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=7608
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
W20240217 17:13:22.624091 15849 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
E20240217 17:13:22.884012 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=5180
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
W20240217 17:13:23.677110 15849 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
E20240217 17:13:23.884011 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=1770
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 135.844 us                | 970.226 us                |
| GenInput                  | 1.821 ms                  | 7.276 ms                  |
| forward: NN               | 105.023 us                | 348.945 us                |
| Forward                   | 418.882 us                | 3.109 ms                  |
| Backward                  | 952.399 us                | 3.344 ms                  |
| Optimize                  | 159.403 us                | 727.481 us                |
| BarrierTimeBeforeRank0    | 762.779 us                | 4.304 ms                  |
| AfterBackward             | 264.376 ms                | 1.820 s                   |
| BlockToStepN              | 210.898 us                | 61.202 ms                 |
| OneStep                   | 268.822 ms                | 2.025 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
W20240217 17:13:24.643579 14319 grad_async_v2.h:257] pq is empty
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
W20240217 17:13:24.685866 15849 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
E20240217 17:13:24.884018 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=624
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
W20240217 17:13:25.653046 14319 grad_async_v2.h:257] pq is empty
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
W20240217 17:13:25.693627 15849 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240217 17:13:25.925379 14319 grad_async_v2.h:257] pq is empty
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
E20240217 17:13:25.925988 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240217 17:13:26.176290 14319 grad_async_v2.h:257] pq is empty
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 237.771 us                | 43.535 ms                 |
| ProcessBack:Shuffle       | 243.624 ms                | 276.321 ms                |
| ProcessBack:UpdateCache   | 19.032 ms                 | 30.868 ms                 |
| ProcessBack:UpsertPq      | 67.607 us                 | 138.520 us                |
| ProcessOneStep            | 264.342 ms                | 286.667 ms                |
| BlockToStepN              | 128.369 us                | 7.321 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
W20240217 17:13:26.711196 15849 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
E20240217 17:13:26.925024 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=3935
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240217 17:13:27.730465 15849 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
E20240217 17:13:27.925009 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=3299
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240217 17:13:28.738590 15849 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
E20240217 17:13:28.932089 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=324
W20240217 17:13:29.163285 14319 grad_async_v2.h:257] pq is empty
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 134.184 us                | 970.226 us                |
| GenInput                  | 1.528 ms                  | 7.276 ms                  |
| forward: NN               | 104.529 us                | 348.945 us                |
| Forward                   | 408.037 us                | 3.109 ms                  |
| Backward                  | 952.399 us                | 3.344 ms                  |
| Optimize                  | 141.850 us                | 727.481 us                |
| BarrierTimeBeforeRank0    | 655.091 us                | 4.304 ms                  |
| AfterBackward             | 263.047 ms                | 286.784 ms                |
| BlockToStepN              | 221.019 us                | 7.423 ms                  |
| OneStep                   | 267.593 ms                | 297.455 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 17:13:29.431248 14319 grad_async_v2.h:257] pq is empty
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
W20240217 17:13:29.725342 14319 grad_async_v2.h:257] pq is empty
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
W20240217 17:13:29.751729 15849 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240217 17:13:29.999378 14319 grad_async_v2.h:257] pq is empty
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
E20240217 17:13:30.000540 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 73 ========== 
W20240217 17:13:30.274313 14319 grad_async_v2.h:257] pq is empty
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
W20240217 17:13:30.519623 14319 grad_async_v2.h:257] pq is empty
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
W20240217 17:13:30.797508 15849 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
E20240217 17:13:31.000010 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=7244
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 211.897 us                | 39.945 ms                 |
| ProcessBack:Shuffle       | 243.624 ms                | 276.321 ms                |
| ProcessBack:UpdateCache   | 19.855 ms                 | 30.868 ms                 |
| ProcessBack:UpsertPq      | 65.301 us                 | 143.544 us                |
| ProcessOneStep            | 263.882 ms                | 289.860 ms                |
| BlockToStepN              | 145.392 us                | 7.321 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240217 17:13:31.588423 14319 grad_async_v2.h:257] pq is empty
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240217 17:13:31.797315 15849 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
E20240217 17:13:32.000015 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=9400
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
W20240217 17:13:32.659343 14319 grad_async_v2.h:257] pq is empty
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
W20240217 17:13:32.807281 15849 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240217 17:13:32.931398 14319 grad_async_v2.h:257] pq is empty
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
E20240217 17:13:33.000006 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=4853
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
W20240217 17:13:33.884989 15849 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240217 17:13:34.000010 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=12647
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 125.340 us                | 970.226 us                |
| GenInput                  | 1.431 ms                  | 7.276 ms                  |
| forward: NN               | 104.529 us                | 348.945 us                |
| Forward                   | 402.691 us                | 3.109 ms                  |
| Backward                  | 936.224 us                | 3.344 ms                  |
| Optimize                  | 140.041 us                | 727.481 us                |
| BarrierTimeBeforeRank0    | 628.921 us                | 4.304 ms                  |
| AfterBackward             | 264.376 ms                | 295.072 ms                |
| BlockToStepN              | 260.325 us                | 7.423 ms                  |
| OneStep                   | 268.822 ms                | 300.303 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
W20240217 17:13:34.906992 15849 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240217 17:13:35.008138 15869 parallel_pq_v2.h:79] insert failed, size(hashtable)=7250
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
W20240217 17:13:35.327211 14319 grad_async_v2.h:257] pq is empty
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
W20240217 17:13:35.982513 15849 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240217 17:13:36.004060 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=3461
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 228.795 us                | 43.616 ms                 |
| ProcessBack:Shuffle       | 242.621 ms                | 276.321 ms                |
| ProcessBack:UpdateCache   | 20.328 ms                 | 32.349 ms                 |
| ProcessBack:UpsertPq      | 66.969 us                 | 143.544 us                |
| ProcessOneStep            | 263.882 ms                | 295.013 ms                |
| BlockToStepN              | 171.215 us                | 7.321 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank0, time: 32.543, per_step: 0.325429
Step99:rank2, time: 32.543, per_step: 0.325429
Step99:rank5, time: 32.543, per_step: 0.325430
Step99:rank6, time: 32.543, per_step: 0.325430
Step99:rank7, time: 32.543, per_step: 0.325431
========== Step 100 ========== 
Step99:rank3, time: 32.543, per_step: 0.325430
========== Step 100 ========== 
========== Step 100 ========== 
Step99:rank4, time: 32.543, per_step: 0.325433
Step99:rank1, time: 32.543, per_step: 0.325432
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.404 us                | 970.226 us                |
| GenInput                  | 1.392 ms                  | 7.276 ms                  |
| forward: NN               | 105.023 us                | 348.945 us                |
| Forward                   | 402.691 us                | 3.109 ms                  |
| Backward                  | 932.900 us                | 3.344 ms                  |
| Optimize                  | 141.850 us                | 727.481 us                |
| BarrierTimeBeforeRank0    | 647.233 us                | 4.304 ms                  |
| AfterBackward             | 263.908 ms                | 295.072 ms                |
| BlockToStepN              | 279.810 us                | 7.423 ms                  |
| OneStep                   | 268.979 ms                | 300.303 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
========== Step 100 ========== 
E20240217 17:13:37.004009 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=933
W20240217 17:13:37.007308 15849 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
W20240217 17:13:37.695847 14319 grad_async_v2.h:257] pq is empty
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
W20240217 17:13:37.969872 14319 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
E20240217 17:13:38.004077 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=283
W20240217 17:13:38.011454 15849 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
W20240217 17:13:38.732234 14319 grad_async_v2.h:257] pq is empty
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
W20240217 17:13:39.003041 14319 grad_async_v2.h:257] pq is empty
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
E20240217 17:13:39.004010 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=12
W20240217 17:13:39.026283 15849 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240217 17:13:39.259030 14319 grad_async_v2.h:257] pq is empty
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 122.858 us                | 970.226 us                |
| GenInput                  | 1.286 ms                  | 7.276 ms                  |
| forward: NN               | 105.023 us                | 348.945 us                |
| Forward                   | 400.510 us                | 3.109 ms                  |
| Backward                  | 932.880 us                | 3.344 ms                  |
| Optimize                  | 140.041 us                | 727.481 us                |
| BarrierTimeBeforeRank0    | 587.510 us                | 4.304 ms                  |
| AfterBackward             | 264.376 ms                | 295.072 ms                |
| BlockToStepN              | 283.387 us                | 7.423 ms                  |
| OneStep                   | 268.979 ms                | 300.303 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 17:13:39.536823 14319 grad_async_v2.h:257] pq is empty
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
W20240217 17:13:39.819258 14319 grad_async_v2.h:257] pq is empty
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
E20240217 17:13:40.004015 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=7856
W20240217 17:13:40.083539 14319 grad_async_v2.h:257] pq is empty
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
W20240217 17:13:40.084053 15849 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
W20240217 17:13:41.030493 14319 grad_async_v2.h:257] pq is empty
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
E20240217 17:13:41.031054 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 116 ========== 
W20240217 17:13:41.107748 15849 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240217 17:13:41.303126 14319 grad_async_v2.h:257] pq is empty
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 223.950 us                | 43.365 ms                 |
| ProcessBack:Shuffle       | 242.621 ms                | 276.321 ms                |
| ProcessBack:UpdateCache   | 20.473 ms                 | 32.349 ms                 |
| ProcessBack:UpsertPq      | 66.969 us                 | 143.544 us                |
| ProcessOneStep            | 264.342 ms                | 295.013 ms                |
| BlockToStepN              | 191.316 us                | 7.321 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
E20240217 17:13:42.031013 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=6424
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
W20240217 17:13:42.177613 15849 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240217 17:13:42.395236 14319 grad_async_v2.h:257] pq is empty
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
W20240217 17:13:42.925186 14319 grad_async_v2.h:257] pq is empty
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
E20240217 17:13:43.031008 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=433
W20240217 17:13:43.189810 15849 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240217 17:13:43.456296 14319 grad_async_v2.h:257] pq is empty
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
W20240217 17:13:43.734031 14319 grad_async_v2.h:257] pq is empty
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
W20240217 17:13:44.008801 14319 grad_async_v2.h:257] pq is empty
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
E20240217 17:13:44.044157 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=213
W20240217 17:13:44.198825 15849 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240217 17:13:44.286391 14319 grad_async_v2.h:257] pq is empty
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 121.764 us                | 970.226 us                |
| GenInput                  | 962.599 us                | 7.276 ms                  |
| forward: NN               | 104.130 us                | 1.840 ms                  |
| Forward                   | 400.510 us                | 3.109 ms                  |
| Backward                  | 926.961 us                | 3.344 ms                  |
| Optimize                  | 139.778 us                | 727.481 us                |
| BarrierTimeBeforeRank0    | 574.617 us                | 4.304 ms                  |
| AfterBackward             | 264.604 ms                | 295.229 ms                |
| BlockToStepN              | 293.282 us                | 7.423 ms                  |
| OneStep                   | 268.979 ms                | 300.303 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
E20240217 17:13:45.044014 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=2356
W20240217 17:13:45.209089 15849 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
E20240217 17:13:46.044019 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=229
W20240217 17:13:46.215587 15849 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 206.511 us                | 39.740 ms                 |
| ProcessBack:Shuffle       | 242.621 ms                | 277.891 ms                |
| ProcessBack:UpdateCache   | 20.328 ms                 | 32.349 ms                 |
| ProcessBack:UpsertPq      | 66.448 us                 | 143.544 us                |
| ProcessOneStep            | 263.882 ms                | 295.182 ms                |
| BlockToStepN              | 216.653 us                | 7.321 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
W20240217 17:13:46.712373 14319 grad_async_v2.h:257] pq is empty
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240217 17:13:47.003289 14319 grad_async_v2.h:257] pq is empty
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
E20240217 17:13:47.044013 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240217 17:13:47.232668 15849 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
W20240217 17:13:47.546916 14319 grad_async_v2.h:257] pq is empty
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
W20240217 17:13:47.831403 14319 grad_async_v2.h:257] pq is empty
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
E20240217 17:13:48.044098 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=8400
W20240217 17:13:48.100065 14319 grad_async_v2.h:257] pq is empty
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240217 17:13:48.232901 15849 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240217 17:13:48.359478 14319 grad_async_v2.h:257] pq is empty
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
W20240217 17:13:48.633952 14319 grad_async_v2.h:257] pq is empty
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
W20240217 17:13:48.867779 14319 grad_async_v2.h:257] pq is empty
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
E20240217 17:13:49.044277 15879 parallel_pq_v2.h:79] insert failed, size(hashtable)=7127
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
W20240217 17:13:49.271013 15849 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.874 us                | 970.226 us                |
| GenInput                  | 885.975 us                | 7.276 ms                  |
| forward: NN               | 102.986 us                | 1.840 ms                  |
| Forward                   | 396.528 us                | 3.109 ms                  |
| Backward                  | 926.764 us                | 3.344 ms                  |
| Optimize                  | 139.529 us                | 727.481 us                |
| BarrierTimeBeforeRank0    | 574.617 us                | 4.304 ms                  |
| AfterBackward             | 264.376 ms                | 295.229 ms                |
| BlockToStepN              | 325.042 us                | 7.423 ms                  |
| OneStep                   | 268.632 ms                | 300.303 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
W20240217 17:13:49.656576 14319 grad_async_v2.h:257] pq is empty
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240217 17:13:49.943867 14319 grad_async_v2.h:257] pq is empty
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
E20240217 17:13:50.044010 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=3887
W20240217 17:13:50.226157 14319 grad_async_v2.h:257] pq is empty
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240217 17:13:50.278097 15849 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240217 17:13:50.501842 14319 grad_async_v2.h:257] pq is empty
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
E20240217 17:13:51.044569 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=3280
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
W20240217 17:13:51.290273 15849 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 213.589 us                | 35.769 ms                 |
| ProcessBack:Shuffle       | 242.621 ms                | 276.321 ms                |
| ProcessBack:UpdateCache   | 20.480 ms                 | 30.868 ms                 |
| ProcessBack:UpsertPq      | 65.358 us                 | 138.520 us                |
| ProcessOneStep            | 263.882 ms                | 295.013 ms                |
| BlockToStepN              | 225.287 us                | 989.181 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
E20240217 17:13:52.044045 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=9708
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
W20240217 17:13:52.297231 15849 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240217 17:13:52.980255 14319 grad_async_v2.h:257] pq is empty
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
E20240217 17:13:53.048066 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=1023
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240217 17:13:53.313417 15849 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
E20240217 17:13:54.048065 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
W20240217 17:13:54.332769 15849 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240217 17:13:54.362061 14319 grad_async_v2.h:257] pq is empty
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 118.969 us                | 873.952 us                |
| GenInput                  | 876.626 us                | 6.866 ms                  |
| forward: NN               | 102.116 us                | 348.945 us                |
| Forward                   | 395.495 us                | 2.565 ms                  |
| Backward                  | 918.869 us                | 3.344 ms                  |
| Optimize                  | 136.479 us                | 621.755 us                |
| BarrierTimeBeforeRank0    | 582.890 us                | 4.037 ms                  |
| AfterBackward             | 264.376 ms                | 295.072 ms                |
| BlockToStepN              | 357.741 us                | 3.232 ms                  |
| OneStep                   | 268.632 ms                | 298.785 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
W20240217 17:13:54.902712 14319 grad_async_v2.h:257] pq is empty
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
E20240217 17:13:55.048014 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=1355
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
W20240217 17:13:55.414165 15849 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
E20240217 17:13:56.048045 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=2438
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 229.322 us                | 39.661 ms                 |
| ProcessBack:Shuffle       | 243.293 ms                | 276.321 ms                |
| ProcessBack:UpdateCache   | 20.375 ms                 | 30.868 ms                 |
| ProcessBack:UpsertPq      | 65.301 us                 | 138.520 us                |
| ProcessOneStep            | 264.342 ms                | 295.013 ms                |
| BlockToStepN              | 243.960 us                | 1.096 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
W20240217 17:13:56.458670 15849 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
E20240217 17:13:57.048019 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=535
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
W20240217 17:13:57.527568 15849 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
E20240217 17:13:58.048024 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=1694
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
W20240217 17:13:58.542785 15849 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
E20240217 17:13:59.050330 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=4062
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 118.659 us                | 873.952 us                |
| GenInput                  | 865.334 us                | 6.866 ms                  |
| forward: NN               | 102.116 us                | 348.945 us                |
| Forward                   | 392.347 us                | 2.565 ms                  |
| Backward                  | 912.820 us                | 3.344 ms                  |
| Optimize                  | 136.479 us                | 621.755 us                |
| BarrierTimeBeforeRank0    | 574.617 us                | 4.037 ms                  |
| AfterBackward             | 264.720 ms                | 295.072 ms                |
| BlockToStepN              | 380.184 us                | 3.232 ms                  |
| OneStep                   | 268.972 ms                | 298.785 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240217 17:13:59.615005 15849 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
E20240217 17:14:00.059439 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=426
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240217 17:14:00.630072 15849 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
W20240217 17:14:01.034577 14319 grad_async_v2.h:257] pq is empty
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
E20240217 17:14:01.064157 15848 parallel_pq_v2.h:79] insert failed, size(hashtable)=393
W20240217 17:14:01.313374 14319 grad_async_v2.h:257] pq is empty
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 257.592 us                | 39.954 ms                 |
| ProcessBack:Shuffle       | 244.937 ms                | 276.321 ms                |
| ProcessBack:UpdateCache   | 20.073 ms                 | 30.868 ms                 |
| ProcessBack:UpsertPq      | 65.543 us                 | 138.520 us                |
| ProcessOneStep            | 265.177 ms                | 295.013 ms                |
| BlockToStepN              | 275.022 us                | 1.508 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
W20240217 17:14:01.630199 15849 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
W20240217 17:14:02.110069 14319 grad_async_v2.h:257] pq is empty
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
E20240217 17:14:02.110662 15849 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240217 17:14:02.345515 14319 grad_async_v2.h:257] pq is empty
Step199:rank6, time: 25.441, per_step: 0.251892
Step199:rank7, time: 25.441, per_step: 0.251890
Step199:rank0, time: 25.441, per_step: 0.251893
Step199:rank4, time: 25.441, per_step: 0.251890
Step199:rank3, time: 25.441, per_step: 0.251892
Step199:rank2, time: 25.441, per_step: 0.251893
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
Step199:rank1, time: 25.441, per_step: 0.251890
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 118.618 us                | 873.952 us                |
| GenInput                  | 867.248 us                | 6.866 ms                  |
| forward: NN               | 102.306 us                | 348.945 us                |
| Forward                   | 390.992 us                | 2.565 ms                  |
| Backward                  | 912.645 us                | 3.344 ms                  |
| Optimize                  | 134.980 us                | 621.755 us                |
| BarrierTimeBeforeRank0    | 568.491 us                | 4.037 ms                  |
| AfterBackward             | 265.221 ms                | 295.072 ms                |
| BlockToStepN              | 384.357 us                | 3.232 ms                  |
| OneStep                   | 269.018 ms                | 298.785 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
Successfully xmh
Step199:rank5, time: 25.442, per_step: 0.251897
Successfully xmh
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
ERROR [14319 PsKvstore.py:89] Delete tensor failed, not found
