WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240217 16:54:34.588348 25943 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240217 16:54:34.596665 25943 IPCTensor.h:369] NewIPCTensor: full_emb [10000000, 32]0x100000002000 1.192 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [25943 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7ff1a56d1b20>==========
Worker 1 pid=26310
Worker 2 pid=26311
Worker 3 pid=26312
Worker 4 pid=26313
Worker 5 pid=26314
Worker 6 pid=26315
INFO [25943 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [26310 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [26311 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [26312 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [26314 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [26313 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [26316 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [26315 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [26316 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26315 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26313 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26314 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 16:54:41.075345 26316 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 16:54:41.075459 26315 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 16:54:41.075620 26314 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 16:54:41.075626 26313 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [26312 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25943 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 16:54:41.081049 25943 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 16:54:41.081243 26312 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [26310 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 16:54:41.082238 26310 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [26311 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 16:54:41.083468 26311 IPCTensor.h:348] IPCTensor full_emb already exists
W20240217 16:54:46.663383 26311 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1000000, 32]; dev=2; size=122.1 MB
W20240217 16:54:46.663610 26310 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1000000, 32]; dev=1; size=122.1 MB
W20240217 16:54:46.663591 26312 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1000000, 32]; dev=3; size=122.1 MB
W20240217 16:54:46.663987 26314 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1000000, 32]; dev=5; size=122.1 MB
W20240217 16:54:46.665092 26316 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1000000, 32]; dev=7; size=122.1 MB
W20240217 16:54:46.665915 26315 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1000000, 32]; dev=6; size=122.1 MB
W20240217 16:54:46.665915 26313 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1000000, 32]; dev=4; size=122.1 MB
W20240217 16:54:46.666308 25943 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1000000, 32]; dev=0; size=122.1 MB
W20240217 16:54:47.396013 26310 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10004c4ba000 7.629 MB
W20240217 16:54:47.396221 26310 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10004cc5d000 7.629 MB
W20240217 16:54:47.396329 26310 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10004d400000 122.1 MB
W20240217 16:54:47.396384 26310 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100054e14000 122.1 MB
W20240217 16:54:47.396418 26310 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 16:54:47.397821 26310 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 16:54:47.434631 25943 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10005c82e000 7.629 MB
W20240217 16:54:47.435075 25943 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10005cfd1000 7.629 MB
W20240217 16:54:47.435186 25943 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10005d774000 122.1 MB
W20240217 16:54:47.435237 25943 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100065188000 122.1 MB
W20240217 16:54:47.435314 25943 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 16:54:47.436373 25943 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 16:54:47.453859 26315 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10006cba2000 7.629 MB
W20240217 16:54:47.454102 26315 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10006d345000 7.629 MB
W20240217 16:54:47.454172 26315 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x10006dae8000 122.1 MB
W20240217 16:54:47.454229 26315 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x1000754fc000 122.1 MB
W20240217 16:54:47.454281 26315 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 16:54:47.480572 26315 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 16:54:47.480839 26311 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10007cf14000 7.629 MB
W20240217 16:54:47.481068 26311 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10007d6b7000 7.629 MB
W20240217 16:54:47.481119 26311 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10007de5a000 122.1 MB
W20240217 16:54:47.481156 26311 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10008586e000 122.1 MB
W20240217 16:54:47.481189 26311 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 16:54:47.482703 26314 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10008d284000 7.629 MB
W20240217 16:54:47.482870 26314 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10008da27000 7.629 MB
W20240217 16:54:47.482926 26314 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10008e1cc000 122.1 MB
W20240217 16:54:47.482967 26314 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100095be0000 122.1 MB
W20240217 16:54:47.483003 26314 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 16:54:47.484325 26311 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 16:54:47.485787 26314 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 16:54:47.589130 26316 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10009d5fe000 7.629 MB
W20240217 16:54:47.589524 26316 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10009dda1000 7.629 MB
W20240217 16:54:47.589754 26316 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x10009e544000 122.1 MB
W20240217 16:54:47.589869 26316 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000a5f58000 122.1 MB
W20240217 16:54:47.589987 26316 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 16:54:47.592036 26316 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 16:54:47.593832 26312 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000ad970000 7.629 MB
W20240217 16:54:47.594192 26312 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000ae115000 7.629 MB
W20240217 16:54:47.594348 26312 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x1000ae8b8000 122.1 MB
W20240217 16:54:47.594512 26312 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000b62cc000 122.1 MB
W20240217 16:54:47.594620 26312 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 16:54:47.598811 26312 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 16:54:47.698316 26313 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1000bdce6000 7.629 MB
W20240217 16:54:47.698460 26313 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000be489000 7.629 MB
W20240217 16:54:47.698511 26313 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x1000bec2c000 122.1 MB
W20240217 16:54:47.698555 26313 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x1000c6640000 122.1 MB
W20240217 16:54:47.698596 26313 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 16:54:47.701189 26313 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
Worker 7 pid=26316
New CachedEmbedding, name=full_emb, shape=(10000000, 32), cache_type=KnownLocalCachedEmbeddingSoftware
fixed cache_range is [(0, 1000000), (1000000, 2000000), (2000000, 3000000), (3000000, 4000000), (4000000, 5000000), (5000000, 6000000), (6000000, 7000000), (7000000, 8000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240217 16:54:48.144157 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000ce058000 7.629 MB
W20240217 16:54:48.144464 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000ce7fb000 7.629 MB
W20240217 16:54:48.144520 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000cef9e000 7.629 MB
W20240217 16:54:48.144610 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000cf741000 7.629 MB
W20240217 16:54:48.144677 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000cfee4000 7.629 MB
W20240217 16:54:48.144775 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000d0e2a000 7.629 MB
W20240217 16:54:48.144770 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000d0687000 7.629 MB
W20240217 16:54:48.144929 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000d15cd000 7.629 MB
W20240217 16:54:48.144986 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000d1d70000 7.629 MB
W20240217 16:54:48.145009 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000d2cb6000 7.629 MB
W20240217 16:54:48.145001 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000d2513000 7.629 MB
W20240217 16:54:48.145038 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000d3459000 7.629 MB
W20240217 16:54:48.145161 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000d3bfc000 7.629 MB
W20240217 16:54:48.145185 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000d439f000 7.629 MB
W20240217 16:54:48.145285 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000d4b42000 7.629 MB
W20240217 16:54:48.145326 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000d52e5000 7.629 MB
W20240217 16:54:48.145385 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000d5a88000 7.629 MB
W20240217 16:54:48.145445 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000d622b000 7.629 MB
W20240217 16:54:48.145489 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000d69ce000 7.629 MB
W20240217 16:54:48.145506 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000d7914000 7.629 MB
W20240217 16:54:48.145500 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000d7171000 7.629 MB
W20240217 16:54:48.145618 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d80b7000 7.629 MB
W20240217 16:54:48.145650 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000d885a000 7.629 MB
W20240217 16:54:48.145661 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000d8ffd000 7.629 MB
W20240217 16:54:48.145694 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000d97a0000 7.629 MB
W20240217 16:54:48.145732 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000d9f43000 7.629 MB
W20240217 16:54:48.145800 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000da6e6000 7.629 MB
W20240217 16:54:48.145903 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000db62c000 7.629 MB
W20240217 16:54:48.145911 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000dbdcf000 7.629 MB
W20240217 16:54:48.145900 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000dae89000 7.629 MB
W20240217 16:54:48.145926 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000dc572000 7.629 MB
W20240217 16:54:48.146024 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000dcd15000 7.629 MB
W20240217 16:54:48.146046 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000dd4b8000 7.629 MB
W20240217 16:54:48.146087 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000ddc5b000 7.629 MB
W20240217 16:54:48.146186 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000de3fe000 7.629 MB
W20240217 16:54:48.146211 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000deba1000 7.629 MB
W20240217 16:54:48.146227 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000df344000 7.629 MB
W20240217 16:54:48.146239 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000dfae7000 7.629 MB
W20240217 16:54:48.146306 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000e028a000 7.629 MB
W20240217 16:54:48.146380 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000e0a2d000 7.629 MB
W20240217 16:54:48.146406 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000e11d0000 7.629 MB
W20240217 16:54:48.146456 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000e2116000 7.629 MB
W20240217 16:54:48.146443 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000e1973000 7.629 MB
W20240217 16:54:48.146488 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000e28b9000 7.629 MB
W20240217 16:54:48.146543 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000e305c000 7.629 MB
W20240217 16:54:48.146569 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000e4745000 7.629 MB
W20240217 16:54:48.146559 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000e37ff000 7.629 MB
W20240217 16:54:48.146567 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000e3fa2000 7.629 MB
W20240217 16:54:48.146620 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000e568b000 7.629 MB
W20240217 16:54:48.146620 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000e4ee8000 7.629 MB
W20240217 16:54:48.146665 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000e65d1000 7.629 MB
W20240217 16:54:48.146664 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000e5e2e000 7.629 MB
W20240217 16:54:48.146710 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000e6d74000 7.629 MB
W20240217 16:54:48.146742 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000e7517000 7.629 MB
W20240217 16:54:48.146754 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000e7cba000 7.629 MB
W20240217 16:54:48.146831 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000e8c00000 7.629 MB
W20240217 16:54:48.146822 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000e845d000 7.629 MB
W20240217 16:54:48.146868 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000ea2e9000 7.629 MB
W20240217 16:54:48.146867 26312 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000e9b46000 7.629 MB
W20240217 16:54:48.146859 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000e93a3000 7.629 MB
W20240217 16:54:48.146920 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000eb22f000 7.629 MB
W20240217 16:54:48.146919 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000eaa8c000 7.629 MB
W20240217 16:54:48.146965 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000eb9d2000 7.629 MB
W20240217 16:54:48.146991 25943 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000ec918000 7.629 MB
W20240217 16:54:48.146984 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000ec175000 7.629 MB
W20240217 16:54:48.147022 26312 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000ed0bb000 80 B 
W20240217 16:54:48.147055 26314 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000ed0bd000 7.629 MB
W20240217 16:54:48.147089 25943 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000ee7a6000 80 B 
W20240217 16:54:48.147078 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000ed860000 7.629 MB
W20240217 16:54:48.147089 26313 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000ee003000 7.629 MB
W20240217 16:54:48.147119 26312 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000ee7a8000 8 B 
W20240217 16:54:48.147130 25943 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000ee7aa000 8 B 
W20240217 16:54:48.147167 25943 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000eef4f000 8 B 
W20240217 16:54:48.147168 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000ee7ac000 7.629 MB
W20240217 16:54:48.147202 26312 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000ef6f4000 8 B 
W20240217 16:54:48.147195 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000eef51000 7.629 MB
W20240217 16:54:48.147269 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000ef6f6000 7.629 MB
W20240217 16:54:48.147284 26314 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000f063c000 80 B 
W20240217 16:54:48.147274 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000efe99000 7.629 MB
W20240217 16:54:48.147308 26313 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000f063e000 80 B 
W20240217 16:54:48.147395 26315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000f0640000 7.629 MB
W20240217 16:54:48.147406 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000f0de3000 7.629 MB
W20240217 16:54:48.147418 26313 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000f1586000 8 B 
W20240217 16:54:48.147429 26314 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000f1588000 8 B 
W20240217 16:54:48.147440 26310 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000f158a000 7.629 MB
W20240217 16:54:48.147487 26316 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000f1d2d000 7.629 MB
W20240217 16:54:48.147547 26313 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000f24d0000 8 B 
W20240217 16:54:48.147567 26314 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000f24d2000 8 B 
W20240217 16:54:48.147589 26310 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000f24d4000 80 B 
W20240217 16:54:48.147614 26315 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000f24d6000 80 B 
W20240217 16:54:48.147665 26316 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000f24d8000 80 B 
W20240217 16:54:48.147675 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000f24da000 7.629 MB
W20240217 16:54:48.147693 26310 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000f2c7d000 8 B 
W20240217 16:54:48.147775 26315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000f2c7f000 8 B 
W20240217 16:54:48.147794 26316 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000f2c81000 8 B 
W20240217 16:54:48.147804 26310 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000f2c83000 8 B 
Construct PerfSampler done
W20240217 16:54:48.147915 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000f2c85000 7.629 MB
Construct PerfSampler done
W20240217 16:54:48.147935 26315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000f3428000 8 B 
W20240217 16:54:48.147950 26316 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000f342a000 8 B 
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct PerfSampler done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
W20240217 16:54:48.148387 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000f342c000 7.629 MB
Construct PerfSampler done
W20240217 16:54:48.148550 26311 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000f3bcf000 7.629 MB
Construct KGCacheControllerWrapper done
E20240217 16:54:48.148624 26313 recstore.cc:66] init folly done
E20240217 16:54:48.148644 26312 recstore.cc:66] init folly done
W20240217 16:54:48.148694 26311 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000f4372000 80 B 
Construct PerfSampler done
Construct KGCacheControllerWrapper done
W20240217 16:54:48.148825 26311 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000f4374000 8 B 
E20240217 16:54:48.148895 26310 recstore.cc:66] init folly done
E20240217 16:54:48.148896 26314 recstore.cc:66] init folly done
W20240217 16:54:48.148933 26311 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000f4376000 8 B 
E20240217 16:54:48.149125 26316 recstore.cc:66] init folly done
E20240217 16:54:48.149313 26315 recstore.cc:66] init folly done
E20240217 16:54:48.149338 25943 recstore.cc:66] init folly done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
E20240217 16:54:48.149921 26311 recstore.cc:66] init folly done
Before Training
I20240217 16:54:48.156307 25943 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240217 16:54:48.158962 26313 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 16:54:48.159107 26316 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
Before Training
Before Training
I20240217 16:54:48.159426 26311 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240217 16:54:48.159461 26315 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240217 16:54:48.159502 26312 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240217 16:54:48.159534 26310 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 16:54:48.159674 26314 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 164.718 us                | 164.718 us                |
| GenInput                  | 753.099 us                | 753.099 us                |
| bucket keys               | 71.778 ms                 | 71.778 ms                 |
| forward: software         | 324.828 ms                | 324.828 ms                |
| forward: join             | 368.619 ms                | 368.619 ms                |
| forward: NN               | 30.772 ms                 | 30.772 ms                 |
| Forward                   | 551.065 ms                | 551.065 ms                |
| back: bucket keys         | 1.203 ms                  | 1.203 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 316.378 us                | 431.416 us                |
| GenInput                  | 2.295 ms                  | 4.776 ms                  |
| bucket keys               | 696.182 us                | 71.778 ms                 |
| forward: software         | 1.087 ms                  | 324.828 ms                |
| forward: join             | 66.738 ms                 | 368.619 ms                |
| forward: NN               | 121.475 us                | 30.772 ms                 |
| Forward                   | 68.998 ms                 | 551.065 ms                |
| back: bucket keys         | 581.026 us                | 1.203 ms                  |
| back: a2a                 | 43.231 ms                 | 50.990 s                  |
| back: cache               | 527.407 ms                | 533.754 ms                |
| back: aggr dram keys      | 84.282 ms                 | 971.021 ms                |
| back: set dram grad       | 4.994 ms                  | 7.807 ms                  |
| Backward                  | 658.826 ms                | 52.510 s                  |
| Optimize                  | 69.087 ms                 | 78.271 ms                 |
| OneStep                   | 814.464 ms                | 53.137 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 231.903 us                | 431.416 us                |
| GenInput                  | 1.964 ms                  | 4.776 ms                  |
| bucket keys               | 917.673 us                | 71.778 ms                 |
| forward: software         | 980.854 us                | 324.828 ms                |
| forward: join             | 66.738 ms                 | 368.619 ms                |
| forward: NN               | 109.668 us                | 30.772 ms                 |
| Forward                   | 68.998 ms                 | 551.065 ms                |
| back: bucket keys         | 509.739 us                | 1.203 ms                  |
| back: a2a                 | 43.231 ms                 | 50.990 s                  |
| back: cache               | 527.407 ms                | 560.377 ms                |
| back: aggr dram keys      | 71.242 ms                 | 971.021 ms                |
| back: set dram grad       | 4.994 ms                  | 9.035 ms                  |
| Backward                  | 650.329 ms                | 52.510 s                  |
| Optimize                  | 68.036 ms                 | 106.990 ms                |
| OneStep                   | 789.238 ms                | 53.137 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 202.273 us                | 431.416 us                |
| GenInput                  | 1.964 ms                  | 8.840 ms                  |
| bucket keys               | 799.656 us                | 71.778 ms                 |
| forward: software         | 1.078 ms                  | 324.828 ms                |
| forward: join             | 47.966 ms                 | 368.619 ms                |
| forward: NN               | 101.222 us                | 30.772 ms                 |
| Forward                   | 49.360 ms                 | 551.065 ms                |
| back: bucket keys         | 509.739 us                | 1.203 ms                  |
| back: a2a                 | 62.998 ms                 | 50.990 s                  |
| back: cache               | 525.859 ms                | 566.078 ms                |
| back: aggr dram keys      | 71.242 ms                 | 971.021 ms                |
| back: set dram grad       | 4.073 ms                  | 9.035 ms                  |
| Backward                  | 658.826 ms                | 52.510 s                  |
| Optimize                  | 55.867 ms                 | 106.990 ms                |
| OneStep                   | 782.636 ms                | 53.137 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 202.273 us                | 431.416 us                |
| GenInput                  | 1.964 ms                  | 8.840 ms                  |
| bucket keys               | 771.046 us                | 71.778 ms                 |
| forward: software         | 1.087 ms                  | 324.828 ms                |
| forward: join             | 47.966 ms                 | 368.619 ms                |
| forward: NN               | 103.063 us                | 30.772 ms                 |
| Forward                   | 49.360 ms                 | 551.065 ms                |
| back: bucket keys         | 499.487 us                | 1.203 ms                  |
| back: a2a                 | 43.279 ms                 | 50.990 s                  |
| back: cache               | 525.247 ms                | 571.498 ms                |
| back: aggr dram keys      | 71.242 ms                 | 971.021 ms                |
| back: set dram grad       | 3.872 ms                  | 9.035 ms                  |
| Backward                  | 658.826 ms                | 52.510 s                  |
| Optimize                  | 55.194 ms                 | 106.990 ms                |
| OneStep                   | 783.731 ms                | 53.137 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 196.277 us                | 431.416 us                |
| GenInput                  | 1.912 ms                  | 15.140 ms                 |
| bucket keys               | 696.182 us                | 71.778 ms                 |
| forward: software         | 1.087 ms                  | 324.828 ms                |
| forward: join             | 49.513 ms                 | 368.619 ms                |
| forward: NN               | 101.222 us                | 30.772 ms                 |
| Forward                   | 50.838 ms                 | 551.065 ms                |
| back: bucket keys         | 487.328 us                | 1.203 ms                  |
| back: a2a                 | 43.279 ms                 | 50.990 s                  |
| back: cache               | 524.453 ms                | 571.498 ms                |
| back: aggr dram keys      | 85.367 ms                 | 971.021 ms                |
| back: set dram grad       | 3.872 ms                  | 9.035 ms                  |
| Backward                  | 677.375 ms                | 52.510 s                  |
| Optimize                  | 53.196 ms                 | 106.990 ms                |
| OneStep                   | 782.636 ms                | 53.137 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 195.253 us                | 431.416 us                |
| GenInput                  | 1.741 ms                  | 15.140 ms                 |
| bucket keys               | 692.844 us                | 71.778 ms                 |
| forward: software         | 980.854 us                | 324.828 ms                |
| forward: join             | 38.579 ms                 | 368.619 ms                |
| forward: NN               | 97.508 us                 | 30.772 ms                 |
| Forward                   | 40.119 ms                 | 551.065 ms                |
| back: bucket keys         | 487.328 us                | 1.253 ms                  |
| back: a2a                 | 57.191 ms                 | 50.990 s                  |
| back: cache               | 524.453 ms                | 601.571 ms                |
| back: aggr dram keys      | 85.367 ms                 | 971.021 ms                |
| back: set dram grad       | 3.859 ms                  | 9.035 ms                  |
| Backward                  | 679.010 ms                | 52.510 s                  |
| Optimize                  | 52.602 ms                 | 106.990 ms                |
| OneStep                   | 782.636 ms                | 53.137 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 192.984 us                | 937.416 us                |
| GenInput                  | 1.744 ms                  | 15.140 ms                 |
| bucket keys               | 692.844 us                | 71.778 ms                 |
| forward: software         | 980.854 us                | 324.828 ms                |
| forward: join             | 38.312 ms                 | 368.619 ms                |
| forward: NN               | 97.195 us                 | 30.772 ms                 |
| Forward                   | 39.563 ms                 | 551.065 ms                |
| back: bucket keys         | 485.182 us                | 1.253 ms                  |
| back: a2a                 | 52.679 ms                 | 50.990 s                  |
| back: cache               | 513.720 ms                | 601.571 ms                |
| back: aggr dram keys      | 85.367 ms                 | 971.021 ms                |
| back: set dram grad       | 3.859 ms                  | 9.035 ms                  |
| Backward                  | 677.375 ms                | 52.510 s                  |
| Optimize                  | 52.532 ms                 | 106.990 ms                |
| OneStep                   | 782.070 ms                | 53.137 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 191.818 us                | 995.795 us                |
| GenInput                  | 1.761 ms                  | 15.259 ms                 |
| bucket keys               | 692.844 us                | 71.778 ms                 |
| forward: software         | 943.661 us                | 324.828 ms                |
| forward: join             | 38.312 ms                 | 368.619 ms                |
| forward: NN               | 96.836 us                 | 30.772 ms                 |
| Forward                   | 39.563 ms                 | 551.065 ms                |
| back: bucket keys         | 484.467 us                | 1.253 ms                  |
| back: a2a                 | 57.191 ms                 | 50.990 s                  |
| back: cache               | 518.660 ms                | 601.571 ms                |
| back: aggr dram keys      | 86.071 ms                 | 971.021 ms                |
| back: set dram grad       | 3.834 ms                  | 13.041 ms                 |
| Backward                  | 683.979 ms                | 52.510 s                  |
| Optimize                  | 52.465 ms                 | 106.990 ms                |
| OneStep                   | 783.060 ms                | 53.137 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
Successfully xmh
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
