WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240217 15:05:26.546986 62447 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240217 15:05:26.555670 62447 IPCTensor.h:369] NewIPCTensor: full_emb [10000000, 32]0x100000002000 1.192 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [62447 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fcdb06adb20>==========
Worker 1 pid=62971
Worker 2 pid=62972
Worker 3 pid=62973
Worker 4 pid=62974
Worker 5 pid=62975
Worker 6 pid=62976
INFO [62447 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [62971 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [62972 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [62973 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [62974 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [62975 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [62976 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [62977 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [62447 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [62972 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [62974 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [62977 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [62973 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [62976 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [62975 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [62971 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 15:05:33.105111 62974 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 15:05:33.105121 62977 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 15:05:33.105140 62973 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 15:05:33.105298 62975 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 15:05:33.105398 62447 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 15:05:33.105479 62972 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 15:05:33.105484 62976 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 15:05:33.107158 62971 IPCTensor.h:348] IPCTensor full_emb already exists
W20240217 15:05:38.801545 62974 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1000000, 32]; dev=4; size=122.1 MB
W20240217 15:05:38.804437 62971 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1000000, 32]; dev=1; size=122.1 MB
W20240217 15:05:38.804476 62976 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1000000, 32]; dev=6; size=122.1 MB
W20240217 15:05:38.805032 62973 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1000000, 32]; dev=3; size=122.1 MB
W20240217 15:05:38.806102 62975 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1000000, 32]; dev=5; size=122.1 MB
W20240217 15:05:38.806066 62972 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1000000, 32]; dev=2; size=122.1 MB
W20240217 15:05:38.806002 62977 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1000000, 32]; dev=7; size=122.1 MB
W20240217 15:05:38.806278 62447 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1000000, 32]; dev=0; size=122.1 MB
W20240217 15:05:39.478140 62974 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10004c4ba000 7.629 MB
W20240217 15:05:39.478394 62974 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10004cc5d000 7.629 MB
W20240217 15:05:39.478463 62974 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10004d400000 122.1 MB
W20240217 15:05:39.478513 62974 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100054e14000 122.1 MB
W20240217 15:05:39.478551 62974 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 15:05:39.488005 62974 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 15:05:39.511008 62976 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10005c82e000 7.629 MB
W20240217 15:05:39.511225 62976 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10005cfd1000 7.629 MB
W20240217 15:05:39.511281 62976 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x10005d774000 122.1 MB
W20240217 15:05:39.511344 62976 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x100065188000 122.1 MB
W20240217 15:05:39.511399 62976 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 15:05:39.514315 62976 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 15:05:39.552173 62447 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10006cba2000 7.629 MB
W20240217 15:05:39.552485 62447 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10006d345000 7.629 MB
W20240217 15:05:39.552575 62447 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10006dae8000 122.1 MB
W20240217 15:05:39.552621 62447 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000754fc000 122.1 MB
W20240217 15:05:39.552678 62447 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 15:05:39.553820 62447 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 15:05:39.625573 62975 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10007cf16000 7.629 MB
W20240217 15:05:39.625959 62975 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10007d6b9000 7.629 MB
W20240217 15:05:39.626120 62975 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10007de5c000 122.1 MB
W20240217 15:05:39.626272 62975 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100085872000 122.1 MB
W20240217 15:05:39.626370 62972 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10008d286000 7.629 MB
W20240217 15:05:39.626407 62975 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 15:05:39.626535 62972 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10008da29000 7.629 MB
W20240217 15:05:39.626603 62972 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10008e1ce000 122.1 MB
W20240217 15:05:39.626654 62972 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100095be2000 122.1 MB
W20240217 15:05:39.626691 62972 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 15:05:39.626844 62971 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10009d5f6000 7.629 MB
W20240217 15:05:39.626993 62971 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10009dd99000 7.629 MB
W20240217 15:05:39.627040 62971 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10009e53c000 122.1 MB
W20240217 15:05:39.627079 62971 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000a5f50000 122.1 MB
W20240217 15:05:39.627141 62971 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 15:05:39.629732 62975 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 15:05:39.631160 62972 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 15:05:39.631459 62971 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 15:05:39.682297 62977 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000ad972000 7.629 MB
W20240217 15:05:39.682461 62977 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000ae115000 7.629 MB
W20240217 15:05:39.682520 62977 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x1000ae8b8000 122.1 MB
W20240217 15:05:39.682567 62977 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000b62cc000 122.1 MB
W20240217 15:05:39.682601 62977 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 15:05:39.685725 62977 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 15:05:39.875136 62973 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000bdce6000 7.629 MB
W20240217 15:05:39.875473 62973 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000be489000 7.629 MB
W20240217 15:05:39.875589 62973 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x1000bec2c000 122.1 MB
W20240217 15:05:39.875691 62973 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000c6640000 122.1 MB
W20240217 15:05:39.875779 62973 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 15:05:39.879418 62973 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
Worker 7 pid=62977
New CachedEmbedding, name=full_emb, shape=(10000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1000000), (1000000, 2000000), (2000000, 3000000), (3000000, 4000000), (4000000, 5000000), (5000000, 6000000), (6000000, 7000000), (7000000, 8000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240217 15:05:40.227831 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000ce058000 7.629 MB
W20240217 15:05:40.227938 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000ce7fb000 7.629 MB
W20240217 15:05:40.227977 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000cef9e000 7.629 MB
W20240217 15:05:40.228009 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000cf741000 7.629 MB
W20240217 15:05:40.228024 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000d0687000 7.629 MB
W20240217 15:05:40.228017 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000cfee4000 7.629 MB
W20240217 15:05:40.228087 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000d0e2a000 7.629 MB
W20240217 15:05:40.228093 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000d15cd000 7.629 MB
W20240217 15:05:40.228155 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000d1d70000 7.629 MB
W20240217 15:05:40.228180 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d2513000 7.629 MB
W20240217 15:05:40.228220 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000d2cb6000 7.629 MB
W20240217 15:05:40.228266 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000d3459000 7.629 MB
W20240217 15:05:40.228333 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000d3bfc000 7.629 MB
W20240217 15:05:40.228386 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000d4b42000 7.629 MB
W20240217 15:05:40.228394 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000d52e5000 7.629 MB
W20240217 15:05:40.228425 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000d5a88000 7.629 MB
W20240217 15:05:40.228389 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000d439f000 7.629 MB
W20240217 15:05:40.228466 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000d69ce000 7.629 MB
W20240217 15:05:40.228475 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000d7171000 7.629 MB
W20240217 15:05:40.228533 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000d885a000 7.629 MB
W20240217 15:05:40.228617 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000d9f43000 7.629 MB
W20240217 15:05:40.228613 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000d97a0000 7.629 MB
W20240217 15:05:40.228664 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000da6e6000 7.629 MB
W20240217 15:05:40.228564 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000d7914000 7.629 MB
W20240217 15:05:40.228588 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000d8ffd000 7.629 MB
W20240217 15:05:40.228722 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000dbdcf000 7.629 MB
W20240217 15:05:40.228508 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000d80b7000 7.629 MB
W20240217 15:05:40.228751 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000db62c000 7.629 MB
W20240217 15:05:40.228750 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000dae89000 7.629 MB
W20240217 15:05:40.228785 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000dc572000 7.629 MB
W20240217 15:05:40.228819 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000dcd15000 7.629 MB
W20240217 15:05:40.228746 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000d622b000 7.629 MB
W20240217 15:05:40.228835 62977 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000dd4b8000 7.629 MB
W20240217 15:05:40.228852 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000de3fe000 7.629 MB
W20240217 15:05:40.228868 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000deba1000 7.629 MB
W20240217 15:05:40.228852 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000ddc5b000 7.629 MB
W20240217 15:05:40.228904 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000df344000 7.629 MB
W20240217 15:05:40.228924 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000dfae7000 7.629 MB
W20240217 15:05:40.228942 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000e028a000 7.629 MB
W20240217 15:05:40.228950 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000e0a2d000 7.629 MB
W20240217 15:05:40.228955 62977 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000e11d0000 80 B 
W20240217 15:05:40.228973 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000e11d2000 7.629 MB
W20240217 15:05:40.228989 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000e1975000 7.629 MB
W20240217 15:05:40.228994 62975 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000e2118000 7.629 MB
W20240217 15:05:40.229054 62977 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000e28bb000 8 B 
W20240217 15:05:40.229059 62975 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000e28bd000 80 B 
W20240217 15:05:40.229068 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000e28bf000 7.629 MB
W20240217 15:05:40.229074 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000e3062000 7.629 MB
W20240217 15:05:40.229117 62975 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000e3fa8000 8 B 
W20240217 15:05:40.229110 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000e3805000 7.629 MB
W20240217 15:05:40.229159 62977 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000e474d000 8 B 
W20240217 15:05:40.229168 62975 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000e474f000 8 B 
W20240217 15:05:40.229153 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000e3faa000 7.629 MB
W20240217 15:05:40.229194 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000e4751000 7.629 MB
W20240217 15:05:40.229202 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000e4ef4000 7.629 MB
W20240217 15:05:40.229293 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000e5697000 7.629 MB
W20240217 15:05:40.229301 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000e5e3a000 7.629 MB
W20240217 15:05:40.229372 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000e6d80000 7.629 MB
W20240217 15:05:40.229373 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000e65dd000 7.629 MB
W20240217 15:05:40.229463 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000e7523000 7.629 MB
W20240217 15:05:40.229545 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000e7cc6000 7.629 MB
W20240217 15:05:40.229570 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000e8c0c000 7.629 MB
W20240217 15:05:40.229568 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000e8469000 7.629 MB
Construct PerfSampler done
W20240217 15:05:40.229661 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000e93af000 7.629 MB
Construct PerfSampler done
W20240217 15:05:40.229681 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000e9b52000 7.629 MB
W20240217 15:05:40.229729 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000ea2f5000 7.629 MB
W20240217 15:05:40.229750 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000eaa98000 7.629 MB
I20240217 15:05:40.229758 62975 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240217 15:05:40.229772 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000eb23b000 7.629 MB
I20240217 15:05:40.229789 62977 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 15:05:40.229799 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000eb9de000 7.629 MB
W20240217 15:05:40.229815 62972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000ec181000 7.629 MB
W20240217 15:05:40.229825 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000ec924000 7.629 MB
W20240217 15:05:40.229830 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000ed0c7000 7.629 MB
W20240217 15:05:40.229835 62447 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000ed86a000 7.629 MB
W20240217 15:05:40.229913 62972 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000ee00d000 80 B 
W20240217 15:05:40.229943 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000ee00f000 7.629 MB
W20240217 15:05:40.229965 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000ee7b2000 7.629 MB
W20240217 15:05:40.229969 62447 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000eef55000 80 B 
W20240217 15:05:40.229974 62972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000eef57000 8 B 
W20240217 15:05:40.229993 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000ef6fc000 7.629 MB
W20240217 15:05:40.229987 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000eef59000 7.629 MB
W20240217 15:05:40.230041 62447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000efe9f000 8 B 
W20240217 15:05:40.230057 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000efea1000 7.629 MB
W20240217 15:05:40.230063 62972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000f0644000 8 B 
W20240217 15:05:40.230070 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000f0646000 7.629 MB
W20240217 15:05:40.230108 62971 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000f0de9000 7.629 MB
W20240217 15:05:40.230126 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000f158c000 7.629 MB
W20240217 15:05:40.230130 62447 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000f1d2f000 8 B 
W20240217 15:05:40.230167 62973 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000f1d31000 7.629 MB
W20240217 15:05:40.230211 62971 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000f24d4000 80 B 
W20240217 15:05:40.230226 62976 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000f24d6000 7.629 MB
W20240217 15:05:40.230244 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000f2c79000 7.629 MB
W20240217 15:05:40.230262 62971 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000f341c000 8 B 
W20240217 15:05:40.230269 62973 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000f341e000 80 B 
W20240217 15:05:40.230327 62973 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000f3420000 8 B 
W20240217 15:05:40.230334 62971 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000f3422000 8 B 
W20240217 15:05:40.230362 62976 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000f3424000 80 B 
W20240217 15:05:40.230394 62973 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000f3bc9000 8 B 
W20240217 15:05:40.230389 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000f3426000 7.629 MB
Construct PerfSampler done
W20240217 15:05:40.230437 62976 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000f3bcb000 8 B 
W20240217 15:05:40.230515 62976 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000f4370000 8 B 
W20240217 15:05:40.230508 62974 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000f3bcd000 7.629 MB
I20240217 15:05:40.230552 62972 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 15:05:40.230666 62974 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000f4372000 80 B 
Construct PerfSampler done
W20240217 15:05:40.230798 62974 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000f4374000 8 B 
Construct PerfSampler done
Construct PerfSampler done
I20240217 15:05:40.230926 62973 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 15:05:40.230916 62974 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000f4376000 8 B 
I20240217 15:05:40.230948 62971 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
Construct PerfSampler done
I20240217 15:05:40.231081 62447 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240217 15:05:40.231173 62976 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
Construct PerfSampler done
I20240217 15:05:40.231674 62974 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 15:05:40.233616 62447 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16,
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240217 15:05:40.233839 62447 grad_base.h:184] Init GradProcessingBase done
I20240217 15:05:41.446200 62447 grad_async_v2.h:42] Use main thread to update emb.
W20240217 15:05:41.446597 62447 kg_controller.h:78] after init GradAsyncProcessingV2
I20240217 15:05:41.446610 62447 kg_controller.h:84] Construct KGCacheController done
E20240217 15:05:43.277197 62976 recstore.cc:66] init folly done
E20240217 15:05:43.277238 62447 recstore.cc:66] init folly done
E20240217 15:05:43.277267 62977 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 15:05:43.277284 62974 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 15:05:43.277339 62975 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240217 15:05:43.277911 62973 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 15:05:43.278352 62971 recstore.cc:66] init folly done
E20240217 15:05:43.278496 62972 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240217 15:05:43.279806 62447 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240217 15:05:44.232056 64328 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240217 15:05:44.232357 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240217 15:05:45.232080 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
W20240217 15:05:45.243050 64328 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
Before Training
I20240217 15:05:45.641391 62447 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240217 15:05:45.657723 62971 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 15:05:45.674336 62972 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 15:05:45.690918 62973 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 15:05:45.708132 62974 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 15:05:45.727651 62975 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 15:05:45.744153 62976 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 15:05:45.760550 62977 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240217 15:05:47.399895 64757 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240217 15:05:47.457882 62447 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240217 15:05:47.512076 64328 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
W20240217 15:05:48.230463 62447 grad_async_v2.h:257] pq is empty
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 166.854 us                | 32.001 ms                 |
| ProcessBack:Shuffle       | 226.327 ms                | 333.817 ms                |
| ProcessBack:UpdateCache   | 11.665 ms                 | 1.186 s                   |
| ProcessBack:UpsertPq      | 59.436 us                 | 57.733 ms                 |
| ProcessOneStep            | 238.685 ms                | 1.597 s                   |
| BlockToStepN              | 80.759 us                 | 50.079 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240217 15:05:48.399020 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=12339
W20240217 15:05:48.501914 62447 grad_async_v2.h:257] pq is empty
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
W20240217 15:05:48.539263 64328 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
E20240217 15:05:49.399024 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=844
W20240217 15:05:49.647228 62447 grad_async_v2.h:257] pq is empty
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
W20240217 15:05:49.648175 64328 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 10 ========== 
========== Step 10 ========== 
W20240217 15:05:49.923362 62447 grad_async_v2.h:257] pq is empty
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
W20240217 15:05:50.130658 62447 grad_async_v2.h:257] pq is empty
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 129.003 us                | 557.170 us                |
| GenInput                  | 1.142 ms                  | 8.380 ms                  |
| forward: NN               | 103.021 us                | 50.579 ms                 |
| Forward                   | 475.174 us                | 55.395 ms                 |
| Backward                  | 861.100 us                | 30.923 ms                 |
| Optimize                  | 159.115 us                | 519.477 us                |
| BarrierTimeBeforeRank0    | 512.479 us                | 4.971 ms                  |
| AfterBackward             | 259.867 ms                | 1.598 s                   |
| BlockToStepN              | 144.962 us                | 50.554 ms                 |
| OneStep                   | 262.641 ms                | 1.752 s                   |
+---------------------------+---------------------------+---------------------------+
E20240217 15:05:50.399013 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=4321
W20240217 15:05:50.420491 62447 grad_async_v2.h:257] pq is empty
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240217 15:05:50.643566 62447 grad_async_v2.h:257] pq is empty
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240217 15:05:50.672128 64328 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
W20240217 15:05:51.431887 62447 grad_async_v2.h:257] pq is empty
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
E20240217 15:05:51.432549 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 17 ========== 
W20240217 15:05:51.711592 62447 grad_async_v2.h:257] pq is empty
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
W20240217 15:05:51.712281 64328 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240217 15:05:51.927990 62447 grad_async_v2.h:257] pq is empty
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
W20240217 15:05:52.196705 62447 grad_async_v2.h:257] pq is empty
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
W20240217 15:05:52.447566 62447 grad_async_v2.h:257] pq is empty
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240217 15:05:52.448117 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 21 ========== 
W20240217 15:05:52.655191 62447 grad_async_v2.h:257] pq is empty
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
W20240217 15:05:52.714428 64328 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240217 15:05:52.910702 62447 grad_async_v2.h:257] pq is empty
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
W20240217 15:05:53.128254 62447 grad_async_v2.h:257] pq is empty
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 225.692 us                | 43.395 ms                 |
| ProcessBack:Shuffle       | 241.358 ms                | 333.817 ms                |
| ProcessBack:UpdateCache   | 9.199 ms                  | 1.186 s                   |
| ProcessBack:UpsertPq      | 73.142 us                 | 57.733 ms                 |
| ProcessOneStep            | 252.782 ms                | 1.597 s                   |
| BlockToStepN              | 88.830 us                 | 50.079 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240217 15:05:53.331646 62447 grad_async_v2.h:257] pq is empty
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
E20240217 15:05:53.448019 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=6185
W20240217 15:05:53.562108 62447 grad_async_v2.h:257] pq is empty
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
W20240217 15:05:53.808708 62447 grad_async_v2.h:257] pq is empty
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
W20240217 15:05:53.809235 64328 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240217 15:05:54.032894 62447 grad_async_v2.h:257] pq is empty
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
W20240217 15:05:54.323383 62447 grad_async_v2.h:257] pq is empty
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
E20240217 15:05:54.448014 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=10555
W20240217 15:05:54.539304 62447 grad_async_v2.h:257] pq is empty
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
W20240217 15:05:54.778143 62447 grad_async_v2.h:257] pq is empty
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
W20240217 15:05:54.832979 64328 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240217 15:05:55.032249 62447 grad_async_v2.h:257] pq is empty
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 124.593 us                | 557.170 us                |
| GenInput                  | 884.498 us                | 8.380 ms                  |
| forward: NN               | 101.398 us                | 50.579 ms                 |
| Forward                   | 412.116 us                | 55.395 ms                 |
| Backward                  | 853.044 us                | 30.923 ms                 |
| Optimize                  | 151.710 us                | 519.477 us                |
| BarrierTimeBeforeRank0    | 487.553 us                | 4.971 ms                  |
| AfterBackward             | 247.872 ms                | 1.598 s                   |
| BlockToStepN              | 181.947 us                | 50.554 ms                 |
| OneStep                   | 250.846 ms                | 1.752 s                   |
+---------------------------+---------------------------+---------------------------+
W20240217 15:05:55.244499 62447 grad_async_v2.h:257] pq is empty
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
W20240217 15:05:55.431470 62447 grad_async_v2.h:257] pq is empty
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
E20240217 15:05:55.448005 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1261
W20240217 15:05:55.664295 62447 grad_async_v2.h:257] pq is empty
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
W20240217 15:05:55.850309 64328 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240217 15:05:55.947237 62447 grad_async_v2.h:257] pq is empty
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240217 15:05:56.210080 62447 grad_async_v2.h:257] pq is empty
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
W20240217 15:05:56.455133 62447 grad_async_v2.h:257] pq is empty
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
E20240217 15:05:56.455663 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240217 15:05:56.703598 62447 grad_async_v2.h:257] pq is empty
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
W20240217 15:05:56.908768 62447 grad_async_v2.h:257] pq is empty
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240217 15:05:56.909313 64328 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240217 15:05:57.144063 62447 grad_async_v2.h:257] pq is empty
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
E20240217 15:05:57.455008 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=3849
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
W20240217 15:05:57.831175 62447 grad_async_v2.h:257] pq is empty
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
W20240217 15:05:57.917976 64328 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240217 15:05:58.047189 62447 grad_async_v2.h:257] pq is empty
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 196.407 us                | 39.908 ms                 |
| ProcessBack:Shuffle       | 232.478 ms                | 333.817 ms                |
| ProcessBack:UpdateCache   | 7.199 ms                  | 1.186 s                   |
| ProcessBack:UpsertPq      | 73.142 us                 | 57.733 ms                 |
| ProcessOneStep            | 242.324 ms                | 1.597 s                   |
| BlockToStepN              | 102.143 us                | 50.079 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240217 15:05:58.311599 62447 grad_async_v2.h:257] pq is empty
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
E20240217 15:05:58.460192 64348 parallel_pq_v2.h:79] insert failed, size(hashtable)=10377
W20240217 15:05:58.537273 62447 grad_async_v2.h:257] pq is empty
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
W20240217 15:05:58.750844 62447 grad_async_v2.h:257] pq is empty
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
W20240217 15:05:58.970237 62447 grad_async_v2.h:257] pq is empty
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
W20240217 15:05:58.970779 64328 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240217 15:05:59.197464 62447 grad_async_v2.h:257] pq is empty
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
W20240217 15:05:59.454768 62447 grad_async_v2.h:257] pq is empty
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
E20240217 15:05:59.460003 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=259
W20240217 15:05:59.705293 62447 grad_async_v2.h:257] pq is empty
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240217 15:05:59.996368 64328 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
W20240217 15:06:00.066893 62447 grad_async_v2.h:257] pq is empty
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 114.644 us                | 542.473 us                |
| GenInput                  | 822.828 us                | 5.774 ms                  |
| forward: NN               | 96.012 us                 | 183.510 us                |
| Forward                   | 365.978 us                | 1.347 ms                  |
| Backward                  | 811.500 us                | 11.204 ms                 |
| Optimize                  | 131.325 us                | 483.190 us                |
| BarrierTimeBeforeRank0    | 506.970 us                | 4.534 ms                  |
| AfterBackward             | 241.858 ms                | 294.083 ms                |
| BlockToStepN              | 193.188 us                | 2.231 ms                  |
| OneStep                   | 245.026 ms                | 303.193 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:00.290684 62447 grad_async_v2.h:257] pq is empty
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
E20240217 15:06:00.460239 64352 parallel_pq_v2.h:79] insert failed, size(hashtable)=10100
W20240217 15:06:00.540004 62447 grad_async_v2.h:257] pq is empty
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
W20240217 15:06:00.829154 62447 grad_async_v2.h:257] pq is empty
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
W20240217 15:06:01.024277 64328 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240217 15:06:01.460014 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=2624
W20240217 15:06:01.652840 62447 grad_async_v2.h:257] pq is empty
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240217 15:06:01.890847 62447 grad_async_v2.h:257] pq is empty
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
W20240217 15:06:02.037565 64328 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
W20240217 15:06:02.250720 62447 grad_async_v2.h:257] pq is empty
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240217 15:06:02.414726 62447 grad_async_v2.h:257] pq is empty
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
E20240217 15:06:02.460008 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=2601
W20240217 15:06:02.658913 62447 grad_async_v2.h:257] pq is empty
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
W20240217 15:06:02.916654 62447 grad_async_v2.h:257] pq is empty
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
W20240217 15:06:03.037708 64328 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240217 15:06:03.179708 62447 grad_async_v2.h:257] pq is empty
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 212.817 us                | 36.020 ms                 |
| ProcessBack:Shuffle       | 232.106 ms                | 286.236 ms                |
| ProcessBack:UpdateCache   | 6.662 ms                  | 39.548 ms                 |
| ProcessBack:UpsertPq      | 72.591 us                 | 139.457 us                |
| ProcessOneStep            | 241.102 ms                | 293.987 ms                |
| BlockToStepN              | 118.717 us                | 2.069 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:03.411612 62447 grad_async_v2.h:257] pq is empty
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
E20240217 15:06:03.472035 64330 parallel_pq_v2.h:79] insert failed, size(hashtable)=2971
W20240217 15:06:03.641253 62447 grad_async_v2.h:257] pq is empty
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
W20240217 15:06:03.934581 62447 grad_async_v2.h:257] pq is empty
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
W20240217 15:06:04.051503 64328 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240217 15:06:04.147425 62447 grad_async_v2.h:257] pq is empty
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
W20240217 15:06:04.365386 62447 grad_async_v2.h:257] pq is empty
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
E20240217 15:06:04.460006 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=4474
W20240217 15:06:04.637120 62447 grad_async_v2.h:257] pq is empty
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
W20240217 15:06:04.874600 62447 grad_async_v2.h:257] pq is empty
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
W20240217 15:06:05.111398 62447 grad_async_v2.h:257] pq is empty
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
W20240217 15:06:05.111855 64328 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 113.502 us                | 542.473 us                |
| GenInput                  | 725.286 us                | 5.774 ms                  |
| forward: NN               | 96.012 us                 | 183.510 us                |
| Forward                   | 359.846 us                | 1.347 ms                  |
| Backward                  | 808.370 us                | 12.108 ms                 |
| Optimize                  | 127.428 us                | 519.477 us                |
| BarrierTimeBeforeRank0    | 444.739 us                | 4.534 ms                  |
| AfterBackward             | 238.736 ms                | 294.083 ms                |
| BlockToStepN              | 216.062 us                | 2.231 ms                  |
| OneStep                   | 244.183 ms                | 303.193 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:05.345155 62447 grad_async_v2.h:257] pq is empty
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
E20240217 15:06:05.460026 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=4140
W20240217 15:06:05.590781 62447 grad_async_v2.h:257] pq is empty
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
W20240217 15:06:05.808446 62447 grad_async_v2.h:257] pq is empty
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240217 15:06:06.036792 62447 grad_async_v2.h:257] pq is empty
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
W20240217 15:06:06.123198 64328 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
W20240217 15:06:06.492298 62447 grad_async_v2.h:257] pq is empty
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
E20240217 15:06:06.492858 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 82 ========== 
W20240217 15:06:06.737709 62447 grad_async_v2.h:257] pq is empty
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
W20240217 15:06:06.960939 62447 grad_async_v2.h:257] pq is empty
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
W20240217 15:06:07.202574 62447 grad_async_v2.h:257] pq is empty
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
W20240217 15:06:07.203125 64328 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
E20240217 15:06:07.492010 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=7699
W20240217 15:06:07.630252 62447 grad_async_v2.h:257] pq is empty
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
W20240217 15:06:07.872097 62447 grad_async_v2.h:257] pq is empty
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
W20240217 15:06:08.123539 62447 grad_async_v2.h:257] pq is empty
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
W20240217 15:06:08.222214 64328 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 215.992 us                | 43.356 ms                 |
| ProcessBack:Shuffle       | 227.888 ms                | 286.236 ms                |
| ProcessBack:UpdateCache   | 6.534 ms                  | 39.548 ms                 |
| ProcessBack:UpsertPq      | 72.360 us                 | 139.457 us                |
| ProcessOneStep            | 238.685 ms                | 293.987 ms                |
| BlockToStepN              | 131.881 us                | 2.069 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:08.354805 62447 grad_async_v2.h:257] pq is empty
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
E20240217 15:06:08.512193 64354 parallel_pq_v2.h:79] insert failed, size(hashtable)=9099
W20240217 15:06:08.600602 62447 grad_async_v2.h:257] pq is empty
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
W20240217 15:06:08.878433 62447 grad_async_v2.h:257] pq is empty
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
W20240217 15:06:09.144310 62447 grad_async_v2.h:257] pq is empty
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
W20240217 15:06:09.230618 64328 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240217 15:06:09.394598 62447 grad_async_v2.h:257] pq is empty
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
E20240217 15:06:09.496012 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=5452
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
W20240217 15:06:09.821646 62447 grad_async_v2.h:257] pq is empty
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
W20240217 15:06:10.065474 62447 grad_async_v2.h:257] pq is empty
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 112.336 us                | 542.473 us                |
| GenInput                  | 725.286 us                | 5.774 ms                  |
| forward: NN               | 97.087 us                 | 183.510 us                |
| Forward                   | 359.192 us                | 1.347 ms                  |
| Backward                  | 805.891 us                | 12.108 ms                 |
| Optimize                  | 124.990 us                | 519.477 us                |
| BarrierTimeBeforeRank0    | 449.549 us                | 4.534 ms                  |
| AfterBackward             | 239.707 ms                | 294.083 ms                |
| BlockToStepN              | 222.418 us                | 2.231 ms                  |
| OneStep                   | 244.183 ms                | 303.193 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:10.291347 62447 grad_async_v2.h:257] pq is empty
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
W20240217 15:06:10.291860 64328 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240217 15:06:10.533587 62447 grad_async_v2.h:257] pq is empty
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
E20240217 15:06:10.534111 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240217 15:06:10.768888 62447 grad_async_v2.h:257] pq is empty
Step99:rank0, time: 30.541, per_step: 0.305413
Step99:rank2, time: 30.542, per_step: 0.305415
Step99:rank3, time: 30.542, per_step: 0.305415
Step99:rank5, time: 30.542, per_step: 0.305416
Step99:rank4, time: 30.542, per_step: 0.305417
Step99:rank1, time: 30.542, per_step: 0.305419
========== Step 100 ========== 
========== Step 100 ========== 
Step99:rank7, time: 30.542, per_step: 0.305419
Step99:rank6, time: 30.542, per_step: 0.305417
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 112.336 us                | 542.473 us                |
| GenInput                  | 719.497 us                | 5.774 ms                  |
| forward: NN               | 97.087 us                 | 183.510 us                |
| Forward                   | 359.192 us                | 1.347 ms                  |
| Backward                  | 805.891 us                | 12.108 ms                 |
| Optimize                  | 125.945 us                | 519.477 us                |
| BarrierTimeBeforeRank0    | 449.549 us                | 4.534 ms                  |
| AfterBackward             | 238.914 ms                | 294.083 ms                |
| BlockToStepN              | 222.418 us                | 2.231 ms                  |
| OneStep                   | 243.812 ms                | 303.193 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
W20240217 15:06:11.036568 62447 grad_async_v2.h:257] pq is empty
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
W20240217 15:06:11.226837 62447 grad_async_v2.h:257] pq is empty
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
W20240217 15:06:11.319252 64328 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240217 15:06:11.490670 62447 grad_async_v2.h:257] pq is empty
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
E20240217 15:06:11.534015 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240217 15:06:11.735419 62447 grad_async_v2.h:257] pq is empty
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
W20240217 15:06:12.098748 62447 grad_async_v2.h:257] pq is empty
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
W20240217 15:06:12.338155 62447 grad_async_v2.h:257] pq is empty
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
W20240217 15:06:12.338601 64328 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240217 15:06:12.534013 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=4989
W20240217 15:06:12.652972 62447 grad_async_v2.h:257] pq is empty
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
W20240217 15:06:12.883706 62447 grad_async_v2.h:257] pq is empty
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
W20240217 15:06:13.174496 62447 grad_async_v2.h:257] pq is empty
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 194.592 us                | 36.891 ms                 |
| ProcessBack:Shuffle       | 229.746 ms                | 299.782 ms                |
| ProcessBack:UpdateCache   | 6.635 ms                  | 39.548 ms                 |
| ProcessBack:UpsertPq      | 71.245 us                 | 252.270 us                |
| ProcessOneStep            | 238.685 ms                | 311.694 ms                |
| BlockToStepN              | 138.059 us                | 2.069 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:13.345573 64328 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240217 15:06:13.449808 62447 grad_async_v2.h:257] pq is empty
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
E20240217 15:06:13.534051 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=453
W20240217 15:06:13.669420 62447 grad_async_v2.h:257] pq is empty
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
W20240217 15:06:13.892483 62447 grad_async_v2.h:257] pq is empty
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240217 15:06:14.137825 62447 grad_async_v2.h:257] pq is empty
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
W20240217 15:06:14.363476 62447 grad_async_v2.h:257] pq is empty
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
W20240217 15:06:14.363946 64328 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240217 15:06:14.595867 62447 grad_async_v2.h:257] pq is empty
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
E20240217 15:06:14.596469 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
W20240217 15:06:15.067790 62447 grad_async_v2.h:257] pq is empty
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 112.232 us                | 542.473 us                |
| GenInput                  | 713.523 us                | 5.774 ms                  |
| forward: NN               | 95.244 us                 | 183.510 us                |
| Forward                   | 354.992 us                | 1.347 ms                  |
| Backward                  | 796.859 us                | 12.108 ms                 |
| Optimize                  | 120.754 us                | 519.477 us                |
| BarrierTimeBeforeRank0    | 469.637 us                | 4.534 ms                  |
| AfterBackward             | 237.078 ms                | 311.764 ms                |
| BlockToStepN              | 231.453 us                | 2.231 ms                  |
| OneStep                   | 241.625 ms                | 314.883 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:15.304471 62447 grad_async_v2.h:257] pq is empty
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240217 15:06:15.373353 64328 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240217 15:06:15.522450 62447 grad_async_v2.h:257] pq is empty
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
E20240217 15:06:15.596019 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=4239
W20240217 15:06:15.776203 62447 grad_async_v2.h:257] pq is empty
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
W20240217 15:06:16.240893 62447 grad_async_v2.h:257] pq is empty
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
W20240217 15:06:16.416188 62447 grad_async_v2.h:257] pq is empty
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240217 15:06:16.416663 64328 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240217 15:06:16.633549 62447 grad_async_v2.h:257] pq is empty
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240217 15:06:16.634280 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240217 15:06:16.873773 62447 grad_async_v2.h:257] pq is empty
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240217 15:06:17.250924 62447 grad_async_v2.h:257] pq is empty
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
W20240217 15:06:17.484012 62447 grad_async_v2.h:257] pq is empty
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
W20240217 15:06:17.484565 64328 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240217 15:06:17.644065 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=3635
W20240217 15:06:17.738193 62447 grad_async_v2.h:257] pq is empty
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
W20240217 15:06:18.013720 62447 grad_async_v2.h:257] pq is empty
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
W20240217 15:06:18.281368 62447 grad_async_v2.h:257] pq is empty
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 234.031 us                | 35.748 ms                 |
| ProcessBack:Shuffle       | 227.888 ms                | 299.782 ms                |
| ProcessBack:UpdateCache   | 6.504 ms                  | 39.548 ms                 |
| ProcessBack:UpsertPq      | 71.277 us                 | 252.270 us                |
| ProcessOneStep            | 236.230 ms                | 311.694 ms                |
| BlockToStepN              | 152.236 us                | 11.491 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
W20240217 15:06:18.481470 62447 grad_async_v2.h:257] pq is empty
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240217 15:06:18.496438 64328 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240217 15:06:18.644069 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=3279
W20240217 15:06:18.741961 62447 grad_async_v2.h:257] pq is empty
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
W20240217 15:06:18.964190 62447 grad_async_v2.h:257] pq is empty
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
W20240217 15:06:19.242373 62447 grad_async_v2.h:257] pq is empty
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
W20240217 15:06:19.528095 64328 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240217 15:06:19.644009 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1114
W20240217 15:06:19.745465 62447 grad_async_v2.h:257] pq is empty
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240217 15:06:19.903093 62447 grad_async_v2.h:257] pq is empty
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
W20240217 15:06:20.129007 62447 grad_async_v2.h:257] pq is empty
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 111.524 us                | 542.473 us                |
| GenInput                  | 693.742 us                | 5.774 ms                  |
| forward: NN               | 95.184 us                 | 183.510 us                |
| Forward                   | 352.609 us                | 1.347 ms                  |
| Backward                  | 793.601 us                | 12.108 ms                 |
| Optimize                  | 117.788 us                | 519.477 us                |
| BarrierTimeBeforeRank0    | 449.549 us                | 4.534 ms                  |
| AfterBackward             | 236.030 ms                | 311.764 ms                |
| BlockToStepN              | 238.738 us                | 11.689 ms                 |
| OneStep                   | 239.398 ms                | 314.883 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:20.405314 62447 grad_async_v2.h:257] pq is empty
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
W20240217 15:06:20.540150 64328 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240217 15:06:20.651875 62447 grad_async_v2.h:257] pq is empty
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
E20240217 15:06:20.652675 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240217 15:06:20.846804 62447 grad_async_v2.h:257] pq is empty
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240217 15:06:21.082417 62447 grad_async_v2.h:257] pq is empty
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
W20240217 15:06:21.546964 64328 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
E20240217 15:06:21.656404 64350 parallel_pq_v2.h:79] insert failed, size(hashtable)=1005
W20240217 15:06:21.843214 62447 grad_async_v2.h:257] pq is empty
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
W20240217 15:06:22.065840 62447 grad_async_v2.h:257] pq is empty
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240217 15:06:22.233502 62447 grad_async_v2.h:257] pq is empty
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
W20240217 15:06:22.511723 62447 grad_async_v2.h:257] pq is empty
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240217 15:06:22.562777 64328 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240217 15:06:22.656013 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=2076
W20240217 15:06:22.771330 62447 grad_async_v2.h:257] pq is empty
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
W20240217 15:06:22.999051 62447 grad_async_v2.h:257] pq is empty
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240217 15:06:23.201068 62447 grad_async_v2.h:257] pq is empty
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 217.352 us                | 38.818 ms                 |
| ProcessBack:Shuffle       | 227.680 ms                | 286.236 ms                |
| ProcessBack:UpdateCache   | 6.607 ms                  | 31.595 ms                 |
| ProcessBack:UpsertPq      | 69.767 us                 | 139.457 us                |
| ProcessOneStep            | 235.387 ms                | 293.987 ms                |
| BlockToStepN              | 163.876 us                | 2.069 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:23.481922 62447 grad_async_v2.h:257] pq is empty
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
W20240217 15:06:23.564957 64328 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240217 15:06:23.656577 64357 parallel_pq_v2.h:79] insert failed, size(hashtable)=7082
W20240217 15:06:23.721232 62447 grad_async_v2.h:257] pq is empty
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
W20240217 15:06:23.994061 62447 grad_async_v2.h:257] pq is empty
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
W20240217 15:06:24.237720 62447 grad_async_v2.h:257] pq is empty
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
W20240217 15:06:24.505856 62447 grad_async_v2.h:257] pq is empty
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
W20240217 15:06:24.577590 64328 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240217 15:06:24.729928 62447 grad_async_v2.h:257] pq is empty
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
E20240217 15:06:24.730584 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240217 15:06:24.949156 62447 grad_async_v2.h:257] pq is empty
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240217 15:06:25.182010 62447 grad_async_v2.h:257] pq is empty
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 111.115 us                | 213.983 us                |
| GenInput                  | 696.119 us                | 5.707 ms                  |
| forward: NN               | 94.764 us                 | 183.510 us                |
| Forward                   | 351.862 us                | 1.347 ms                  |
| Backward                  | 770.393 us                | 11.204 ms                 |
| Optimize                  | 117.362 us                | 483.190 us                |
| BarrierTimeBeforeRank0    | 457.123 us                | 2.576 ms                  |
| AfterBackward             | 235.426 ms                | 294.083 ms                |
| BlockToStepN              | 248.738 us                | 2.231 ms                  |
| OneStep                   | 239.307 ms                | 303.193 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:25.454612 62447 grad_async_v2.h:257] pq is empty
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
W20240217 15:06:25.710038 62447 grad_async_v2.h:257] pq is empty
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240217 15:06:25.710624 64328 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240217 15:06:25.730015 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=368
W20240217 15:06:25.938611 62447 grad_async_v2.h:257] pq is empty
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
W20240217 15:06:26.168730 62447 grad_async_v2.h:257] pq is empty
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
W20240217 15:06:26.419275 62447 grad_async_v2.h:257] pq is empty
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
W20240217 15:06:26.651407 62447 grad_async_v2.h:257] pq is empty
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240217 15:06:26.713783 64328 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240217 15:06:26.730003 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=3478
W20240217 15:06:26.886046 62447 grad_async_v2.h:257] pq is empty
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
W20240217 15:06:27.122151 62447 grad_async_v2.h:257] pq is empty
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
W20240217 15:06:27.313223 62447 grad_async_v2.h:257] pq is empty
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
W20240217 15:06:27.550020 62447 grad_async_v2.h:257] pq is empty
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
W20240217 15:06:27.754489 62447 grad_async_v2.h:257] pq is empty
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
W20240217 15:06:27.755007 64328 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240217 15:06:27.755066 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240217 15:06:28.015444 62447 grad_async_v2.h:257] pq is empty
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
W20240217 15:06:28.273618 62447 grad_async_v2.h:257] pq is empty
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 213.132 us                | 38.655 ms                 |
| ProcessBack:Shuffle       | 227.668 ms                | 286.236 ms                |
| ProcessBack:UpdateCache   | 6.534 ms                  | 31.595 ms                 |
| ProcessBack:UpsertPq      | 69.570 us                 | 139.457 us                |
| ProcessOneStep            | 234.219 ms                | 293.987 ms                |
| BlockToStepN              | 170.480 us                | 2.069 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:28.518561 62447 grad_async_v2.h:257] pq is empty
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
W20240217 15:06:28.771049 62447 grad_async_v2.h:257] pq is empty
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
W20240217 15:06:28.771688 64328 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240217 15:06:28.771785 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240217 15:06:29.011159 62447 grad_async_v2.h:257] pq is empty
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
W20240217 15:06:29.255607 62447 grad_async_v2.h:257] pq is empty
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
W20240217 15:06:29.495783 62447 grad_async_v2.h:257] pq is empty
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
W20240217 15:06:29.719458 62447 grad_async_v2.h:257] pq is empty
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
E20240217 15:06:29.771040 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1289
W20240217 15:06:29.795037 64328 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 111.115 us                | 213.983 us                |
| GenInput                  | 697.913 us                | 5.707 ms                  |
| forward: NN               | 94.701 us                 | 183.510 us                |
| Forward                   | 352.302 us                | 1.347 ms                  |
| Backward                  | 770.926 us                | 11.204 ms                 |
| Optimize                  | 114.856 us                | 483.190 us                |
| BarrierTimeBeforeRank0    | 471.564 us                | 3.160 ms                  |
| AfterBackward             | 235.426 ms                | 294.083 ms                |
| BlockToStepN              | 263.183 us                | 2.231 ms                  |
| OneStep                   | 239.398 ms                | 303.193 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:30.448426 62447 grad_async_v2.h:257] pq is empty
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
W20240217 15:06:30.731750 62447 grad_async_v2.h:257] pq is empty
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
E20240217 15:06:30.771010 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=163
W20240217 15:06:30.823297 64328 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240217 15:06:30.992127 62447 grad_async_v2.h:257] pq is empty
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
W20240217 15:06:31.226672 62447 grad_async_v2.h:257] pq is empty
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
W20240217 15:06:31.421411 62447 grad_async_v2.h:257] pq is empty
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
W20240217 15:06:31.636991 62447 grad_async_v2.h:257] pq is empty
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240217 15:06:31.831823 62447 grad_async_v2.h:257] pq is empty
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
W20240217 15:06:31.832345 64328 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240217 15:06:31.832418 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
========== Step 190 ========== 
W20240217 15:06:32.063561 62447 grad_async_v2.h:257] pq is empty
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
W20240217 15:06:32.314131 62447 grad_async_v2.h:257] pq is empty
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
W20240217 15:06:32.510775 62447 grad_async_v2.h:257] pq is empty
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240217 15:06:32.681059 62447 grad_async_v2.h:257] pq is empty
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
E20240217 15:06:32.832012 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=6686
W20240217 15:06:32.907848 62447 grad_async_v2.h:257] pq is empty
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
W20240217 15:06:32.908380 64328 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 195 ========== 
W20240217 15:06:33.142866 62447 grad_async_v2.h:257] pq is empty
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 214.094 us                | 39.964 ms                 |
| ProcessBack:Shuffle       | 227.112 ms                | 286.236 ms                |
| ProcessBack:UpdateCache   | 6.348 ms                  | 31.595 ms                 |
| ProcessBack:UpsertPq      | 69.508 us                 | 139.457 us                |
| ProcessOneStep            | 233.619 ms                | 293.987 ms                |
| BlockToStepN              | 178.095 us                | 2.069 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240217 15:06:33.343408 62447 grad_async_v2.h:257] pq is empty
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
W20240217 15:06:33.766067 62447 grad_async_v2.h:257] pq is empty
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
E20240217 15:06:33.832022 64328 parallel_pq_v2.h:79] insert failed, size(hashtable)=2075
Step199:rank3, time: 23.117, per_step: 0.228881
Step199:rank7, time: 23.117, per_step: 0.228879
Step199:rank6, time: 23.117, per_step: 0.228880
Step199:rank0, time: 23.117, per_step: 0.228879
Successfully xmh
Successfully xmh
Step199:rank4, time: 23.117, per_step: 0.228880
Step199:rank2, time: 23.117, per_step: 0.228880
Step199:rank1, time: 23.117, per_step: 0.228880
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
Step199:rank5, time: 23.118, per_step: 0.228886
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 110.658 us                | 213.983 us                |
| GenInput                  | 704.424 us                | 5.707 ms                  |
| forward: NN               | 94.682 us                 | 183.510 us                |
| Forward                   | 352.394 us                | 1.347 ms                  |
| Backward                  | 765.945 us                | 11.204 ms                 |
| Optimize                  | 114.770 us                | 483.190 us                |
| BarrierTimeBeforeRank0    | 482.166 us                | 4.385 ms                  |
| AfterBackward             | 233.663 ms                | 294.083 ms                |
| BlockToStepN              | 270.995 us                | 2.231 ms                  |
| OneStep                   | 238.671 ms                | 303.193 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
ERROR [62447 PsKvstore.py:89] Delete tensor failed, not found
