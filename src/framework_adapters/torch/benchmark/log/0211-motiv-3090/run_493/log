WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240217 19:04:46.685427 42047 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240217 19:04:46.694140 42047 IPCTensor.h:369] NewIPCTensor: full_emb [10000000, 32]0x100000002000 1.192 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [42047 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f6f59db9b20>==========
Worker 1 pid=42408
Worker 2 pid=42409
Worker 3 pid=42410
Worker 4 pid=42411
Worker 5 pid=42412
Worker 6 pid=42413
INFO [42047 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [42408 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [42409 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [42410 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [42413 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [42412 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [42411 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [42414 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [42410 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42411 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42414 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 19:04:53.362109 42411 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [42412 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42413 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 19:04:53.362105 42410 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:04:53.362118 42414 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [42047 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [42408 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 19:04:53.363265 42412 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:04:53.363425 42047 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:04:53.363588 42413 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [42409 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 19:04:53.365408 42408 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:04:53.365430 42409 IPCTensor.h:348] IPCTensor full_emb already exists
W20240217 19:04:59.063246 42410 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1000000, 32]; dev=3; size=122.1 MB
W20240217 19:04:59.063355 42412 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1000000, 32]; dev=5; size=122.1 MB
W20240217 19:04:59.064127 42047 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1000000, 32]; dev=0; size=122.1 MB
W20240217 19:04:59.064780 42414 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1000000, 32]; dev=7; size=122.1 MB
W20240217 19:04:59.064873 42408 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1000000, 32]; dev=1; size=122.1 MB
W20240217 19:04:59.064944 42413 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1000000, 32]; dev=6; size=122.1 MB
W20240217 19:04:59.064954 42411 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1000000, 32]; dev=4; size=122.1 MB
W20240217 19:04:59.064988 42409 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1000000, 32]; dev=2; size=122.1 MB
W20240217 19:04:59.843529 42412 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10004c4ba000 7.629 MB
W20240217 19:04:59.843748 42412 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10004cc5d000 7.629 MB
W20240217 19:04:59.843798 42412 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10004d400000 122.1 MB
W20240217 19:04:59.843838 42412 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100054e14000 122.1 MB
W20240217 19:04:59.843904 42412 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 19:04:59.844820 42412 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 19:04:59.859513 42409 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10005c82e000 7.629 MB
W20240217 19:04:59.859795 42409 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10005cfd1000 7.629 MB
W20240217 19:04:59.859874 42409 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10005d774000 122.1 MB
W20240217 19:04:59.859932 42409 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100065188000 122.1 MB
W20240217 19:04:59.860013 42409 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 19:04:59.861092 42409 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 19:04:59.874981 42413 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10006cba2000 7.629 MB
W20240217 19:04:59.875133 42413 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10006d345000 7.629 MB
W20240217 19:04:59.875180 42413 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x10006dae8000 122.1 MB
W20240217 19:04:59.875245 42413 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x1000754fc000 122.1 MB
W20240217 19:04:59.875294 42413 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 19:04:59.876511 42413 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 19:04:59.884238 42411 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10007cf16000 7.629 MB
W20240217 19:04:59.884452 42411 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10007d6b9000 7.629 MB
W20240217 19:04:59.884529 42411 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10007de5c000 122.1 MB
W20240217 19:04:59.884581 42411 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100085870000 122.1 MB
W20240217 19:04:59.884634 42411 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 19:04:59.885172 42411 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 19:04:59.899811 42047 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10008d28a000 7.629 MB
W20240217 19:04:59.900091 42047 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10008da2f000 7.629 MB
W20240217 19:04:59.900159 42047 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10008e1d2000 122.1 MB
W20240217 19:04:59.900213 42047 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100095be6000 122.1 MB
W20240217 19:04:59.900262 42047 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 19:04:59.900282 42414 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10009d5fa000 7.629 MB
W20240217 19:04:59.900465 42414 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10009dd9d000 7.629 MB
W20240217 19:04:59.900525 42414 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x10009e540000 122.1 MB
W20240217 19:04:59.900585 42414 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000a5f54000 122.1 MB
W20240217 19:04:59.900650 42414 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 19:04:59.900699 42047 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 19:04:59.901469 42414 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 19:04:59.903658 42408 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000ad972000 7.629 MB
W20240217 19:04:59.903803 42408 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000ae115000 7.629 MB
W20240217 19:04:59.903851 42408 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1000ae8b8000 122.1 MB
W20240217 19:04:59.903887 42408 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000b62cc000 122.1 MB
W20240217 19:04:59.903962 42408 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 19:04:59.904363 42408 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 19:05:00.063709 42410 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000bdce6000 7.629 MB
W20240217 19:05:00.063905 42410 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000be489000 7.629 MB
W20240217 19:05:00.063958 42410 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x1000bec2c000 122.1 MB
W20240217 19:05:00.064002 42410 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000c6640000 122.1 MB
W20240217 19:05:00.064061 42410 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 19:05:00.080210 42410 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
Worker 7 pid=42414
New CachedEmbedding, name=full_emb, shape=(10000000, 32), cache_type=KnownLocalCachedEmbeddingSoftware
fixed cache_range is [(0, 1000000), (1000000, 2000000), (2000000, 3000000), (3000000, 4000000), (4000000, 5000000), (5000000, 6000000), (6000000, 7000000), (7000000, 8000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
W20240217 19:05:00.452428 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000ce7fb000 7.629 MB
W20240217 19:05:00.452431 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000cef9e000 7.629 MB
W20240217 19:05:00.452425 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000ce058000 7.629 MB
W20240217 19:05:00.452473 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000cf741000 7.629 MB
W20240217 19:05:00.452579 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000d0e2a000 7.629 MB
W20240217 19:05:00.452564 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000cfee4000 7.629 MB
W20240217 19:05:00.452570 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000d0687000 7.629 MB
W20240217 19:05:00.452621 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000d15cd000 7.629 MB
W20240217 19:05:00.452636 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000d1d70000 7.629 MB
W20240217 19:05:00.452700 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000d2cb6000 7.629 MB
W20240217 19:05:00.452703 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000d3459000 7.629 MB
W20240217 19:05:00.452701 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000d2513000 7.629 MB
W20240217 19:05:00.452733 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000d3bfc000 7.629 MB
W20240217 19:05:00.452776 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000d4b42000 7.629 MB
W20240217 19:05:00.452771 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000d439f000 7.629 MB
W20240217 19:05:00.452790 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000d52e5000 7.629 MB
W20240217 19:05:00.452808 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000d5a88000 7.629 MB
W20240217 19:05:00.452832 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d622b000 7.629 MB
W20240217 19:05:00.452841 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000d69ce000 7.629 MB
W20240217 19:05:00.452865 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000d7171000 7.629 MB
W20240217 19:05:00.452881 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000d7914000 7.629 MB
W20240217 19:05:00.452896 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000d80b7000 7.629 MB
W20240217 19:05:00.452912 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000d885a000 7.629 MB
W20240217 19:05:00.452917 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000d8ffd000 7.629 MB
W20240217 19:05:00.452945 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000d97a0000 7.629 MB
W20240217 19:05:00.452961 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000d9f43000 7.629 MB
W20240217 19:05:00.452997 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000db62c000 7.629 MB
W20240217 19:05:00.452996 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000dae89000 7.629 MB
W20240217 19:05:00.452991 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000da6e6000 7.629 MB
W20240217 19:05:00.453004 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000dbdcf000 7.629 MB
W20240217 19:05:00.453050 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000dcd15000 7.629 MB
W20240217 19:05:00.453047 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000dc572000 7.629 MB
W20240217 19:05:00.453059 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000dd4b8000 7.629 MB
W20240217 19:05:00.453070 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000ddc5b000 7.629 MB
W20240217 19:05:00.453109 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000deba1000 7.629 MB
W20240217 19:05:00.453115 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000dfae7000 7.629 MB
W20240217 19:05:00.453114 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000df344000 7.629 MB
W20240217 19:05:00.453104 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000de3fe000 7.629 MB
W20240217 19:05:00.453161 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000e0a2d000 7.629 MB
W20240217 19:05:00.453159 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000e028a000 7.629 MB
W20240217 19:05:00.453187 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000e11d0000 7.629 MB
W20240217 19:05:00.453212 42047 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000e1973000 7.629 MB
W20240217 19:05:00.453235 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000e28b9000 7.629 MB
W20240217 19:05:00.453231 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000e2116000 7.629 MB
W20240217 19:05:00.453270 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000e305c000 7.629 MB
W20240217 19:05:00.453274 42047 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000e37ff000 80 B 
W20240217 19:05:00.453300 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000e3801000 7.629 MB
W20240217 19:05:00.453306 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000e3fa4000 7.629 MB
W20240217 19:05:00.453325 42047 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000e4eea000 8 B 
W20240217 19:05:00.453323 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000e4747000 7.629 MB
W20240217 19:05:00.453352 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000e4eec000 7.629 MB
W20240217 19:05:00.453366 42408 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000e5e32000 7.629 MB
W20240217 19:05:00.453368 42047 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000e65d5000 8 B 
W20240217 19:05:00.453362 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000e568f000 7.629 MB
W20240217 19:05:00.453405 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000e65d7000 7.629 MB
W20240217 19:05:00.453419 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000e6d7a000 7.629 MB
W20240217 19:05:00.453428 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000e751d000 7.629 MB
W20240217 19:05:00.453459 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000e7cc0000 7.629 MB
W20240217 19:05:00.453462 42408 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000e8463000 80 B 
W20240217 19:05:00.453493 42414 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000e8465000 7.629 MB
W20240217 19:05:00.453527 42408 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000e93ab000 8 B 
W20240217 19:05:00.453522 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000e8c08000 7.629 MB
W20240217 19:05:00.453541 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000e9b50000 7.629 MB
W20240217 19:05:00.453536 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000e93ad000 7.629 MB
W20240217 19:05:00.453558 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000ea2f3000 7.629 MB
W20240217 19:05:00.453569 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000eaa96000 7.629 MB
W20240217 19:05:00.453593 42414 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000eb239000 80 B 
W20240217 19:05:00.453609 42408 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000eb23b000 8 B 
W20240217 19:05:00.453613 42412 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000eb23d000 7.629 MB
Construct PerfSampler done
W20240217 19:05:00.453671 42414 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000eb9e0000 8 B 
W20240217 19:05:00.453692 42412 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000eb9e2000 80 B 
Construct KGCacheControllerWrapper done
W20240217 19:05:00.453720 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000eb9e4000 7.629 MB
W20240217 19:05:00.453730 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000ec187000 7.629 MB
W20240217 19:05:00.453740 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000ec92a000 7.629 MB
W20240217 19:05:00.453752 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000ed0cd000 7.629 MB
W20240217 19:05:00.453775 42412 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000ed870000 8 B 
W20240217 19:05:00.453791 42414 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000ed872000 8 B 
W20240217 19:05:00.453838 42412 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000ed874000 8 B 
Construct PerfSampler done
Construct KGCacheControllerWrapper done
W20240217 19:05:00.453893 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000ed876000 7.629 MB
W20240217 19:05:00.453903 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000ee019000 7.629 MB
W20240217 19:05:00.453943 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000ee7bc000 7.629 MB
W20240217 19:05:00.453953 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000eef5f000 7.629 MB
W20240217 19:05:00.454033 42409 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000ef702000 7.629 MB
W20240217 19:05:00.454080 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000efea5000 7.629 MB
Construct PerfSampler done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
W20240217 19:05:00.454123 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000f0648000 7.629 MB
Construct KGCacheControllerWrapper done
E20240217 19:05:00.454180 42408 recstore.cc:66] init folly done
W20240217 19:05:00.454176 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000f0deb000 7.629 MB
W20240217 19:05:00.454185 42409 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000f158e000 80 B 
E20240217 19:05:00.454205 42047 recstore.cc:66] init folly done
W20240217 19:05:00.454274 42411 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000f1590000 7.629 MB
W20240217 19:05:00.454300 42409 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000f1d33000 8 B 
W20240217 19:05:00.454311 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000f1d35000 7.629 MB
W20240217 19:05:00.454334 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000f24d8000 7.629 MB
E20240217 19:05:00.454375 42412 recstore.cc:66] init folly done
W20240217 19:05:00.454427 42409 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000f2c7b000 8 B 
W20240217 19:05:00.454437 42411 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000f2c7d000 80 B 
E20240217 19:05:00.454454 42414 recstore.cc:66] init folly done
W20240217 19:05:00.454483 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000f2c7f000 7.629 MB
W20240217 19:05:00.454494 42410 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000f3422000 7.629 MB
W20240217 19:05:00.454566 42411 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000f3bc5000 8 B 
W20240217 19:05:00.454623 42413 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000f3bc7000 7.629 MB
W20240217 19:05:00.454653 42410 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000f436a000 80 B 
W20240217 19:05:00.454699 42411 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000f436c000 8 B 
Construct PerfSampler done
W20240217 19:05:00.454773 42410 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000f436e000 8 B 
W20240217 19:05:00.454780 42413 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000f4370000 80 B 
Construct KGCacheControllerWrapper done
W20240217 19:05:00.454888 42413 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000f4372000 8 B 
W20240217 19:05:00.454897 42410 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000f4374000 8 B 
W20240217 19:05:00.455010 42413 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000f4376000 8 B 
Construct PerfSampler done
Construct KGCacheControllerWrapper done
E20240217 19:05:00.455181 42409 recstore.cc:66] init folly done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
E20240217 19:05:00.455492 42411 recstore.cc:66] init folly done
E20240217 19:05:00.455801 42410 recstore.cc:66] init folly done
E20240217 19:05:00.455843 42413 recstore.cc:66] init folly done
Before Training
Before Training
I20240217 19:05:00.459676 42047 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240217 19:05:00.459734 42412 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:05:00.462656 42408 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:05:00.463629 42414 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:05:00.466141 42409 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:05:00.466640 42411 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240217 19:05:00.467294 42413 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240217 19:05:00.467337 42410 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 248.119 us                | 248.119 us                |
| GenInput                  | 1.294 ms                  | 1.294 ms                  |
| bucket keys               | 74.565 ms                 | 74.565 ms                 |
| forward: software         | 365.798 ms                | 365.798 ms                |
| forward: join             | 396.591 ms                | 396.591 ms                |
| forward: NN               | 31.423 ms                 | 31.423 ms                 |
| Forward                   | 658.824 ms                | 658.824 ms                |
| back: bucket keys         | 1.955 ms                  | 1.955 ms                  |
| back: a2a                 | 53.423 s                  | 53.423 s                  |
| back: cache               | 374.911 ms                | 374.911 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 396.041 us                | 915.665 us                |
| GenInput                  | 3.365 ms                  | 16.262 ms                 |
| bucket keys               | 792.980 us                | 74.565 ms                 |
| forward: software         | 1.218 ms                  | 365.798 ms                |
| forward: join             | 81.702 ms                 | 396.591 ms                |
| forward: NN               | 115.691 us                | 31.423 ms                 |
| Forward                   | 83.144 ms                 | 658.824 ms                |
| back: bucket keys         | 533.342 us                | 1.955 ms                  |
| back: a2a                 | 39.230 ms                 | 53.423 s                  |
| back: cache               | 500.557 ms                | 540.497 ms                |
| back: aggr dram keys      | 101.259 ms                | 1.118 s                   |
| back: set dram grad       | 7.711 ms                  | 11.269 ms                 |
| Backward                  | 676.701 ms                | 54.934 s                  |
| Optimize                  | 77.086 ms                 | 106.202 ms                |
| OneStep                   | 855.001 ms                | 55.682 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 216.934 us                | 915.665 us                |
| GenInput                  | 3.029 ms                  | 16.262 ms                 |
| bucket keys               | 756.025 us                | 74.565 ms                 |
| forward: software         | 1.225 ms                  | 365.798 ms                |
| forward: join             | 70.664 ms                 | 396.591 ms                |
| forward: NN               | 103.819 us                | 31.423 ms                 |
| Forward                   | 72.791 ms                 | 658.824 ms                |
| back: bucket keys         | 496.626 us                | 1.955 ms                  |
| back: a2a                 | 60.516 ms                 | 53.423 s                  |
| back: cache               | 521.566 ms                | 568.182 ms                |
| back: aggr dram keys      | 72.734 ms                 | 1.118 s                   |
| back: set dram grad       | 6.996 ms                  | 11.269 ms                 |
| Backward                  | 676.701 ms                | 54.934 s                  |
| Optimize                  | 76.024 ms                 | 106.202 ms                |
| OneStep                   | 837.194 ms                | 55.682 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 220.762 us                | 915.665 us                |
| GenInput                  | 2.775 ms                  | 16.262 ms                 |
| bucket keys               | 750.780 us                | 74.565 ms                 |
| forward: software         | 1.225 ms                  | 365.798 ms                |
| forward: join             | 42.680 ms                 | 396.591 ms                |
| forward: NN               | 102.351 us                | 31.423 ms                 |
| Forward                   | 44.008 ms                 | 658.824 ms                |
| back: bucket keys         | 492.096 us                | 1.955 ms                  |
| back: a2a                 | 80.883 ms                 | 53.423 s                  |
| back: cache               | 525.969 ms                | 602.182 ms                |
| back: aggr dram keys      | 85.873 ms                 | 1.118 s                   |
| back: set dram grad       | 6.438 ms                  | 11.269 ms                 |
| Backward                  | 684.410 ms                | 54.934 s                  |
| Optimize                  | 77.086 ms                 | 106.202 ms                |
| OneStep                   | 830.384 ms                | 55.682 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 220.762 us                | 915.665 us                |
| GenInput                  | 2.674 ms                  | 16.262 ms                 |
| bucket keys               | 751.257 us                | 74.565 ms                 |
| forward: software         | 1.218 ms                  | 365.798 ms                |
| forward: join             | 53.283 ms                 | 396.591 ms                |
| forward: NN               | 102.120 us                | 31.423 ms                 |
| Forward                   | 55.064 ms                 | 658.824 ms                |
| back: bucket keys         | 495.672 us                | 1.955 ms                  |
| back: a2a                 | 77.776 ms                 | 53.423 s                  |
| back: cache               | 521.566 ms                | 602.182 ms                |
| back: aggr dram keys      | 95.618 ms                 | 1.118 s                   |
| back: set dram grad       | 6.677 ms                  | 11.269 ms                 |
| Backward                  | 679.785 ms                | 54.934 s                  |
| Optimize                  | 76.024 ms                 | 106.202 ms                |
| OneStep                   | 818.022 ms                | 55.682 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 211.884 us                | 915.665 us                |
| GenInput                  | 2.398 ms                  | 16.262 ms                 |
| bucket keys               | 751.257 us                | 74.565 ms                 |
| forward: software         | 1.216 ms                  | 365.798 ms                |
| forward: join             | 42.680 ms                 | 396.591 ms                |
| forward: NN               | 102.120 us                | 31.423 ms                 |
| Forward                   | 44.008 ms                 | 658.824 ms                |
| back: bucket keys         | 494.719 us                | 1.955 ms                  |
| back: a2a                 | 77.776 ms                 | 53.423 s                  |
| back: cache               | 511.616 ms                | 602.182 ms                |
| back: aggr dram keys      | 98.888 ms                 | 1.118 s                   |
| back: set dram grad       | 6.677 ms                  | 11.269 ms                 |
| Backward                  | 679.785 ms                | 54.934 s                  |
| Optimize                  | 76.024 ms                 | 106.202 ms                |
| OneStep                   | 809.160 ms                | 55.682 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 200.111 us                | 915.665 us                |
| GenInput                  | 2.398 ms                  | 16.262 ms                 |
| bucket keys               | 750.780 us                | 74.565 ms                 |
| forward: software         | 1.054 ms                  | 365.798 ms                |
| forward: join             | 65.049 ms                 | 396.591 ms                |
| forward: NN               | 99.416 us                 | 31.423 ms                 |
| Forward                   | 66.226 ms                 | 658.824 ms                |
| back: bucket keys         | 494.719 us                | 1.955 ms                  |
| back: a2a                 | 60.516 ms                 | 53.423 s                  |
| back: cache               | 510.861 ms                | 602.182 ms                |
| back: aggr dram keys      | 99.801 ms                 | 1.118 s                   |
| back: set dram grad       | 6.847 ms                  | 12.356 ms                 |
| Backward                  | 676.701 ms                | 54.934 s                  |
| Optimize                  | 76.024 ms                 | 106.202 ms                |
| OneStep                   | 809.160 ms                | 55.682 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 200.111 us                | 915.665 us                |
| GenInput                  | 2.398 ms                  | 16.262 ms                 |
| bucket keys               | 750.303 us                | 74.565 ms                 |
| forward: software         | 1.140 ms                  | 365.798 ms                |
| forward: join             | 65.926 ms                 | 396.591 ms                |
| forward: NN               | 98.652 us                 | 31.423 ms                 |
| Forward                   | 67.240 ms                 | 658.824 ms                |
| back: bucket keys         | 494.719 us                | 1.955 ms                  |
| back: a2a                 | 46.512 ms                 | 53.423 s                  |
| back: cache               | 509.406 ms                | 602.182 ms                |
| back: aggr dram keys      | 95.618 ms                 | 1.118 s                   |
| back: set dram grad       | 6.919 ms                  | 12.648 ms                 |
| Backward                  | 676.701 ms                | 54.934 s                  |
| Optimize                  | 76.024 ms                 | 106.202 ms                |
| OneStep                   | 805.658 ms                | 55.682 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 200.111 us                | 915.665 us                |
| GenInput                  | 2.398 ms                  | 16.262 ms                 |
| bucket keys               | 743.628 us                | 74.565 ms                 |
| forward: software         | 1.054 ms                  | 365.798 ms                |
| forward: join             | 65.049 ms                 | 396.591 ms                |
| forward: NN               | 98.416 us                 | 31.423 ms                 |
| Forward                   | 66.226 ms                 | 658.824 ms                |
| back: bucket keys         | 495.672 us                | 1.955 ms                  |
| back: a2a                 | 60.516 ms                 | 53.423 s                  |
| back: cache               | 511.616 ms                | 602.182 ms                |
| back: aggr dram keys      | 95.307 ms                 | 1.118 s                   |
| back: set dram grad       | 6.919 ms                  | 12.768 ms                 |
| Backward                  | 677.988 ms                | 54.934 s                  |
| Optimize                  | 76.024 ms                 | 106.202 ms                |
| OneStep                   | 805.658 ms                | 55.682 s                  |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
