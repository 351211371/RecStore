WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240217 14:06:22.216464  7135 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240217 14:06:22.224144  7135 IPCTensor.h:369] NewIPCTensor: full_emb [10000000, 32]0x100000002000 1.192 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [7135 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f044fa81b20>==========
Worker 1 pid=7495
Worker 2 pid=7496
Worker 3 pid=7497
Worker 4 pid=7498
Worker 5 pid=7499
Worker 6 pid=7500
INFO [7135 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [7495 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [7496 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [7497 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [7498 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [7499 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [7501 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [7500 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [7501 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7500 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7499 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7498 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7495 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7496 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 14:06:28.875962  7501 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:06:28.876588  7496 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [7497 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [7135 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 14:06:28.876866  7500 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:06:28.876892  7498 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:06:28.877835  7135 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:06:28.878156  7499 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:06:28.878559  7495 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:06:28.878609  7497 IPCTensor.h:348] IPCTensor full_emb already exists
W20240217 14:06:34.478952  7498 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [500000, 32]; dev=4; size=61.04 MB
W20240217 14:06:34.478986  7500 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [500000, 32]; dev=6; size=61.04 MB
W20240217 14:06:34.478989  7499 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [500000, 32]; dev=5; size=61.04 MB
W20240217 14:06:34.480082  7135 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [500000, 32]; dev=0; size=61.04 MB
W20240217 14:06:34.480428  7501 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [500000, 32]; dev=7; size=61.04 MB
W20240217 14:06:34.480719  7497 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [500000, 32]; dev=3; size=61.04 MB
W20240217 14:06:34.481837  7496 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [500000, 32]; dev=2; size=61.04 MB
W20240217 14:06:34.482067  7495 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [500000, 32]; dev=1; size=61.04 MB
W20240217 14:06:35.222496  7135 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10004c4ba000 7.629 MB
W20240217 14:06:35.222965  7135 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10004cc5d000 7.629 MB
W20240217 14:06:35.223115  7135 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10004d400000 122.1 MB
W20240217 14:06:35.223209  7135 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100054e14000 122.1 MB
W20240217 14:06:35.223312  7135 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 14:06:35.229784  7135 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 14:06:35.297447  7496 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10005c82e000 7.629 MB
W20240217 14:06:35.297647  7496 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10005cfd1000 7.629 MB
W20240217 14:06:35.297703  7496 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10005d774000 122.1 MB
W20240217 14:06:35.297770  7496 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100065188000 122.1 MB
W20240217 14:06:35.297843  7496 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 14:06:35.299886  7496 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 14:06:35.330338  7497 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10006cba0000 7.629 MB
W20240217 14:06:35.330554  7497 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10006d343000 7.629 MB
W20240217 14:06:35.330618  7497 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10006dae6000 122.1 MB
W20240217 14:06:35.330674  7497 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000754fc000 122.1 MB
W20240217 14:06:35.330734  7497 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 14:06:35.332156  7497 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 14:06:35.333220  7499 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10007cf14000 7.629 MB
W20240217 14:06:35.333431  7499 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10007d6b9000 7.629 MB
W20240217 14:06:35.333546  7499 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10007de5c000 122.1 MB
W20240217 14:06:35.333613  7500 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100085872000 7.629 MB
W20240217 14:06:35.333643  7499 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100086015000 122.1 MB
W20240217 14:06:35.333741  7499 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 14:06:35.333824  7500 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10008da29000 7.629 MB
W20240217 14:06:35.333914  7500 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x10008e1cc000 122.1 MB
W20240217 14:06:35.334022  7500 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x100095be0000 122.1 MB
W20240217 14:06:35.334110  7500 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 14:06:35.335886  7499 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 14:06:35.336275  7500 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 14:06:35.365700  7501 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10009d5fe000 7.629 MB
W20240217 14:06:35.365896  7501 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10009dda1000 7.629 MB
W20240217 14:06:35.365953  7501 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x10009e544000 122.1 MB
W20240217 14:06:35.366015  7501 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000a5f58000 122.1 MB
W20240217 14:06:35.366071  7501 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 14:06:35.366468  7501 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 14:06:35.383890  7495 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000ad972000 7.629 MB
W20240217 14:06:35.384100  7495 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000ae115000 7.629 MB
W20240217 14:06:35.384155  7495 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1000ae8b8000 122.1 MB
W20240217 14:06:35.384238  7495 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000b62cc000 122.1 MB
W20240217 14:06:35.384307  7495 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 14:06:35.384727  7495 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 14:06:35.385499  7498 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1000bdce6000 7.629 MB
W20240217 14:06:35.385627  7498 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000be489000 7.629 MB
W20240217 14:06:35.385682  7498 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x1000bec2c000 122.1 MB
W20240217 14:06:35.385737  7498 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x1000c6640000 122.1 MB
W20240217 14:06:35.385792  7498 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 14:06:35.386197  7498 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
Worker 7 pid=7501
New CachedEmbedding, name=full_emb, shape=(10000000, 32), cache_type=KnownLocalCachedEmbeddingSoftware
fixed cache_range is [(0, 500000), (500000, 1000000), (1000000, 1500000), (1500000, 2000000), (2000000, 2500000), (2500000, 3000000), (3000000, 3500000), (3500000, 4000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240217 14:06:35.957252  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000ce058000 7.629 MB
W20240217 14:06:35.957322  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000ce7fb000 7.629 MB
W20240217 14:06:35.957338  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000cef9e000 7.629 MB
W20240217 14:06:35.957377  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000cf741000 7.629 MB
W20240217 14:06:35.957419  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000d0687000 7.629 MB
W20240217 14:06:35.957420  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000cfee4000 7.629 MB
W20240217 14:06:35.957485  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000d0e2a000 7.629 MB
W20240217 14:06:35.957530  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000d15cd000 7.629 MB
W20240217 14:06:35.957540  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000d2513000 7.629 MB
W20240217 14:06:35.957536  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000d1d70000 7.629 MB
W20240217 14:06:35.957598  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000d3459000 7.629 MB
W20240217 14:06:35.957590  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000d2cb6000 7.629 MB
W20240217 14:06:35.957667  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000d4b42000 7.629 MB
W20240217 14:06:35.957629  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000d3bfc000 7.629 MB
W20240217 14:06:35.957659  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000d439f000 7.629 MB
W20240217 14:06:35.957705  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000d5a88000 7.629 MB
W20240217 14:06:35.957700  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000d52e5000 7.629 MB
W20240217 14:06:35.957749  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000d69ce000 7.629 MB
W20240217 14:06:35.957760  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000d7914000 7.629 MB
W20240217 14:06:35.957741  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000d622b000 7.629 MB
W20240217 14:06:35.957755  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000d7171000 7.629 MB
W20240217 14:06:35.957799  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000d80b7000 7.629 MB
W20240217 14:06:35.957840  7135 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000d885a000 7.629 MB
W20240217 14:06:35.957873  7135 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000d8ffd000 80 B 
W20240217 14:06:35.957904  7135 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000d9f45000 8 B 
W20240217 14:06:35.957893  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000d8fff000 7.629 MB
W20240217 14:06:35.957906  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000d97a2000 7.629 MB
W20240217 14:06:35.957932  7135 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000d9f47000 8 B 
W20240217 14:06:35.957950  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d9f49000 7.629 MB
W20240217 14:06:35.957971  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000da6ec000 7.629 MB
W20240217 14:06:35.957983  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000dae8f000 7.629 MB
W20240217 14:06:35.958014  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000db632000 7.629 MB
W20240217 14:06:35.958050  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000dbdd5000 7.629 MB
W20240217 14:06:35.958065  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000dc578000 7.629 MB
W20240217 14:06:35.958098  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000dcd1b000 7.629 MB
W20240217 14:06:35.958115  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000dd4be000 7.629 MB
Construct PerfSampler done
Construct KGCacheControllerWrapper done
W20240217 14:06:35.958182  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000ddc61000 7.629 MB
W20240217 14:06:35.958204  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000de404000 7.629 MB
W20240217 14:06:35.958214  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000deba7000 7.629 MB
W20240217 14:06:35.958223  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000df34a000 7.629 MB
W20240217 14:06:35.958252  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000dfaed000 7.629 MB
W20240217 14:06:35.958261  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000e0290000 7.629 MB
W20240217 14:06:35.958314  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000e0a33000 7.629 MB
W20240217 14:06:35.958353  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000e11d6000 7.629 MB
W20240217 14:06:35.958365  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000e1979000 7.629 MB
W20240217 14:06:35.958386  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000e211c000 7.629 MB
W20240217 14:06:35.958410  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000e28bf000 7.629 MB
W20240217 14:06:35.958431  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000e3062000 7.629 MB
W20240217 14:06:35.958477  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000e3805000 7.629 MB
W20240217 14:06:35.958487  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000e3fa8000 7.629 MB
W20240217 14:06:35.958544  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000e474b000 7.629 MB
W20240217 14:06:35.958573  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000e4eee000 7.629 MB
E20240217 14:06:35.958597  7135 recstore.cc:66] init folly done
W20240217 14:06:35.958585  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000e5691000 7.629 MB
W20240217 14:06:35.958619  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000e5e34000 7.629 MB
W20240217 14:06:35.958629  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000e65d7000 7.629 MB
W20240217 14:06:35.958667  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000e6d7a000 7.629 MB
W20240217 14:06:35.958730  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000e751d000 7.629 MB
W20240217 14:06:35.958766  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000e7cc0000 7.629 MB
W20240217 14:06:35.958778  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000e8463000 7.629 MB
W20240217 14:06:35.958789  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000e8c06000 7.629 MB
W20240217 14:06:35.958820  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000e93a9000 7.629 MB
W20240217 14:06:35.958863  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000e9b4c000 7.629 MB
W20240217 14:06:35.958873  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000ea2ef000 7.629 MB
W20240217 14:06:35.958914  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000eaa92000 7.629 MB
W20240217 14:06:35.958949  7501 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000eb235000 7.629 MB
W20240217 14:06:35.958978  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000eb9d8000 7.629 MB
W20240217 14:06:35.959003  7495 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000ec17b000 7.629 MB
W20240217 14:06:35.959034  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000ec91e000 7.629 MB
W20240217 14:06:35.959045  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000ed0c1000 7.629 MB
W20240217 14:06:35.959081  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000ed864000 7.629 MB
W20240217 14:06:35.959120  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000ee007000 7.629 MB
W20240217 14:06:35.959151  7501 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000ee7aa000 80 B 
W20240217 14:06:35.959175  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000ee7ac000 7.629 MB
W20240217 14:06:35.959213  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000eef4f000 7.629 MB
W20240217 14:06:35.959223  7495 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000ef6f2000 80 B 
W20240217 14:06:35.959246  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000ef6f4000 7.629 MB
W20240217 14:06:35.959264  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000efe97000 7.629 MB
W20240217 14:06:35.959296  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000f063a000 7.629 MB
W20240217 14:06:35.959306  7501 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000f0ddd000 8 B 
W20240217 14:06:35.959354  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000f0ddf000 7.629 MB
W20240217 14:06:35.959383  7495 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000f1582000 8 B 
W20240217 14:06:35.959393  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000f1584000 7.629 MB
W20240217 14:06:35.959411  7498 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000f1d27000 7.629 MB
W20240217 14:06:35.959421  7500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000f24ca000 7.629 MB
W20240217 14:06:35.959447  7496 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000f2c6d000 7.629 MB
W20240217 14:06:35.959473  7501 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000f3410000 8 B 
W20240217 14:06:35.959511  7499 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000f3412000 7.629 MB
W20240217 14:06:35.959550  7495 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000f3bb5000 8 B 
W20240217 14:06:35.959566  7497 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000f3bb7000 7.629 MB
W20240217 14:06:35.959595  7498 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000f435a000 80 B 
W20240217 14:06:35.959609  7500 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000f435c000 80 B 
W20240217 14:06:35.959620  7496 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000f435e000 80 B 
W20240217 14:06:35.959648  7499 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000f4360000 80 B 
W20240217 14:06:35.959694  7497 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000f4362000 80 B 
W20240217 14:06:35.959714  7500 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000f4364000 8 B 
W20240217 14:06:35.959720  7498 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000f4366000 8 B 
W20240217 14:06:35.959726  7496 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000f4368000 8 B 
W20240217 14:06:35.959754  7499 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000f436a000 8 B 
W20240217 14:06:35.959800  7497 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000f436c000 8 B 
W20240217 14:06:35.959805  7500 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000f436e000 8 B 
W20240217 14:06:35.959820  7496 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000f4370000 8 B 
W20240217 14:06:35.959830  7498 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000f4372000 8 B 
W20240217 14:06:35.959852  7499 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000f4374000 8 B 
W20240217 14:06:35.959897  7497 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000f4376000 8 B 
Construct PerfSampler done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct PerfSampler done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct PerfSampler done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct PerfSampler done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240217 14:06:35.960558  7495 recstore.cc:66] init folly done
E20240217 14:06:35.960558  7501 recstore.cc:66] init folly done
E20240217 14:06:35.960659  7500 recstore.cc:66] init folly done
E20240217 14:06:35.960678  7496 recstore.cc:66] init folly done
E20240217 14:06:35.960743  7498 recstore.cc:66] init folly done
E20240217 14:06:35.960753  7497 recstore.cc:66] init folly done
E20240217 14:06:35.960772  7499 recstore.cc:66] init folly done
Before Training
I20240217 14:06:35.962508  7135 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240217 14:06:35.969051  7495 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 14:06:35.969367  7501 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240217 14:06:35.970291  7500 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240217 14:06:35.970335  7496 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240217 14:06:35.970410  7499 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240217 14:06:35.970441  7497 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 14:06:35.970631  7498 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.429 us                | 133.429 us                |
| GenInput                  | 2.509 ms                  | 2.509 ms                  |
| bucket keys               | 65.765 ms                 | 65.765 ms                 |
| forward: software         | 347.867 ms                | 347.867 ms                |
| forward: join             | 374.956 ms                | 374.956 ms                |
| forward: NN               | 32.996 ms                 | 32.996 ms                 |
| Forward                   | 550.667 ms                | 550.667 ms                |
| back: bucket keys         | 1.883 ms                  | 1.883 ms                  |
| back: a2a                 | 53.848 s                  | 53.848 s                  |
| back: cache               | 307.655 ms                | 307.655 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 235.129 us                | 792.097 us                |
| GenInput                  | 1.124 ms                  | 5.775 ms                  |
| bucket keys               | 795.841 us                | 65.765 ms                 |
| forward: software         | 1.200 ms                  | 347.867 ms                |
| forward: join             | 78.901 ms                 | 374.956 ms                |
| forward: NN               | 110.661 us                | 32.996 ms                 |
| Forward                   | 84.095 ms                 | 550.667 ms                |
| back: bucket keys         | 516.176 us                | 1.883 ms                  |
| back: a2a                 | 20.226 ms                 | 53.848 s                  |
| back: cache               | 291.818 ms                | 312.508 ms                |
| back: aggr dram keys      | 107.564 ms                | 1.045 s                   |
| back: set dram grad       | 3.231 ms                  | 5.737 ms                  |
| Backward                  | 380.314 ms                | 55.220 s                  |
| Optimize                  | 41.551 ms                 | 58.017 ms                 |
| OneStep                   | 487.459 ms                | 55.833 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 181.577 us                | 792.097 us                |
| GenInput                  | 1.310 ms                  | 5.775 ms                  |
| bucket keys               | 766.277 us                | 65.765 ms                 |
| forward: software         | 1.012 ms                  | 347.867 ms                |
| forward: join             | 76.039 ms                 | 374.956 ms                |
| forward: NN               | 108.795 us                | 32.996 ms                 |
| Forward                   | 82.207 ms                 | 550.667 ms                |
| back: bucket keys         | 481.367 us                | 1.883 ms                  |
| back: a2a                 | 20.926 ms                 | 53.848 s                  |
| back: cache               | 286.049 ms                | 353.168 ms                |
| back: aggr dram keys      | 70.607 ms                 | 1.045 s                   |
| back: set dram grad       | 3.237 ms                  | 11.744 ms                 |
| Backward                  | 386.147 ms                | 55.220 s                  |
| Optimize                  | 39.856 ms                 | 58.017 ms                 |
| OneStep                   | 492.474 ms                | 55.833 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 188.982 us                | 792.097 us                |
| GenInput                  | 1.258 ms                  | 11.151 ms                 |
| bucket keys               | 767.231 us                | 65.765 ms                 |
| forward: software         | 947.237 us                | 347.867 ms                |
| forward: join             | 76.039 ms                 | 374.956 ms                |
| forward: NN               | 101.097 us                | 32.996 ms                 |
| Forward                   | 82.207 ms                 | 550.667 ms                |
| back: bucket keys         | 479.460 us                | 1.883 ms                  |
| back: a2a                 | 22.338 ms                 | 53.848 s                  |
| back: cache               | 281.040 ms                | 353.168 ms                |
| back: aggr dram keys      | 82.538 ms                 | 1.045 s                   |
| back: set dram grad       | 3.154 ms                  | 11.744 ms                 |
| Backward                  | 386.147 ms                | 55.220 s                  |
| Optimize                  | 39.856 ms                 | 70.151 ms                 |
| OneStep                   | 500.005 ms                | 55.833 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 178.889 us                | 792.097 us                |
| GenInput                  | 1.290 ms                  | 11.151 ms                 |
| bucket keys               | 739.813 us                | 65.765 ms                 |
| forward: software         | 962.257 us                | 347.867 ms                |
| forward: join             | 76.039 ms                 | 374.956 ms                |
| forward: NN               | 98.375 us                 | 32.996 ms                 |
| Forward                   | 82.207 ms                 | 550.667 ms                |
| back: bucket keys         | 479.221 us                | 1.883 ms                  |
| back: a2a                 | 23.079 ms                 | 53.848 s                  |
| back: cache               | 284.154 ms                | 359.683 ms                |
| back: aggr dram keys      | 70.799 ms                 | 1.045 s                   |
| back: set dram grad       | 3.139 ms                  | 11.744 ms                 |
| Backward                  | 384.242 ms                | 55.220 s                  |
| Optimize                  | 39.454 ms                 | 70.151 ms                 |
| OneStep                   | 500.033 ms                | 55.833 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 181.577 us                | 792.097 us                |
| GenInput                  | 1.237 ms                  | 11.151 ms                 |
| bucket keys               | 736.237 us                | 65.765 ms                 |
| forward: software         | 954.151 us                | 347.867 ms                |
| forward: join             | 78.901 ms                 | 374.956 ms                |
| forward: NN               | 95.551 us                 | 32.996 ms                 |
| Forward                   | 82.996 ms                 | 550.667 ms                |
| back: bucket keys         | 478.983 us                | 1.883 ms                  |
| back: a2a                 | 22.338 ms                 | 53.848 s                  |
| back: cache               | 281.040 ms                | 359.683 ms                |
| back: aggr dram keys      | 72.389 ms                 | 1.045 s                   |
| back: set dram grad       | 3.154 ms                  | 11.744 ms                 |
| Backward                  | 384.242 ms                | 55.220 s                  |
| Optimize                  | 38.842 ms                 | 70.151 ms                 |
| OneStep                   | 501.847 ms                | 55.833 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.369 us                | 526.837 us                |
| GenInput                  | 1.124 ms                  | 10.588 ms                 |
| bucket keys               | 736.237 us                | 2.148 ms                  |
| forward: software         | 878.096 us                | 73.091 ms                 |
| forward: join             | 80.221 ms                 | 109.204 ms                |
| forward: NN               | 92.009 us                 | 185.169 us                |
| Forward                   | 82.973 ms                 | 110.483 ms                |
| back: bucket keys         | 476.599 us                | 919.104 us                |
| back: a2a                 | 22.430 ms                 | 101.538 ms                |
| back: cache               | 284.154 ms                | 353.168 ms                |
| back: aggr dram keys      | 70.607 ms                 | 255.229 ms                |
| back: set dram grad       | 3.129 ms                  | 5.737 ms                  |
| Backward                  | 384.242 ms                | 503.784 ms                |
| Optimize                  | 37.870 ms                 | 58.017 ms                 |
| OneStep                   | 501.847 ms                | 565.415 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 174.369 us                | 689.079 us                |
| GenInput                  | 1.124 ms                  | 11.151 ms                 |
| bucket keys               | 735.044 us                | 2.148 ms                  |
| forward: software         | 878.096 us                | 73.091 ms                 |
| forward: join             | 80.235 ms                 | 109.204 ms                |
| forward: NN               | 93.493 us                 | 185.169 us                |
| Forward                   | 82.973 ms                 | 110.483 ms                |
| back: bucket keys         | 478.745 us                | 919.104 us                |
| back: a2a                 | 22.430 ms                 | 101.538 ms                |
| back: cache               | 285.647 ms                | 353.168 ms                |
| back: aggr dram keys      | 66.978 ms                 | 255.229 ms                |
| back: set dram grad       | 3.129 ms                  | 8.621 ms                  |
| Backward                  | 386.147 ms                | 503.784 ms                |
| Optimize                  | 37.186 ms                 | 58.017 ms                 |
| OneStep                   | 505.556 ms                | 565.415 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
Successfully xmh
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
