WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240217 14:54:54.505878 56500 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240217 14:54:54.510421 56500 IPCTensor.h:369] NewIPCTensor: full_emb [10000000, 32]0x100000002000 1.192 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [56500 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fb36ab49b20>==========
Worker 1 pid=56860
Worker 2 pid=56861
Worker 3 pid=56862
Worker 4 pid=56863
Worker 5 pid=56864
Worker 6 pid=56865
INFO [56500 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [56860 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [56861 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [56862 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [56863 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [56864 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [56866 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [56865 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [56862 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56866 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56864 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56863 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56865 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56861 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56860 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 14:55:16.083636 56866 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:55:16.083853 56865 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:55:16.083639 56864 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:55:16.083911 56861 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:55:16.083914 56862 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:55:16.083961 56860 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 14:55:16.083966 56863 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [56500 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 14:55:16.085819 56500 IPCTensor.h:348] IPCTensor full_emb already exists
W20240217 14:55:21.776801 56865 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1000000, 32]; dev=6; size=122.1 MB
W20240217 14:55:21.777827 56863 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1000000, 32]; dev=4; size=122.1 MB
W20240217 14:55:21.778786 56500 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1000000, 32]; dev=0; size=122.1 MB
W20240217 14:55:21.780972 56861 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1000000, 32]; dev=2; size=122.1 MB
W20240217 14:55:21.783102 56860 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1000000, 32]; dev=1; size=122.1 MB
W20240217 14:55:21.783270 56866 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1000000, 32]; dev=7; size=122.1 MB
W20240217 14:55:21.785055 56864 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1000000, 32]; dev=5; size=122.1 MB
W20240217 14:55:21.785101 56862 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1000000, 32]; dev=3; size=122.1 MB
W20240217 14:55:22.525377 56500 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10004c4ba000 7.629 MB
W20240217 14:55:22.525620 56500 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10004cc5d000 7.629 MB
W20240217 14:55:22.525761 56500 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10004d400000 122.1 MB
W20240217 14:55:22.525826 56500 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100054e14000 122.1 MB
W20240217 14:55:22.525858 56500 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 14:55:22.528519 56863 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10005c82a000 7.629 MB
W20240217 14:55:22.528707 56863 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10005cfcd000 7.629 MB
W20240217 14:55:22.528784 56863 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10005d770000 122.1 MB
W20240217 14:55:22.528825 56863 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100065184000 122.1 MB
W20240217 14:55:22.528887 56863 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 14:55:22.529094 56500 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 14:55:22.529480 56865 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10006cb9c000 7.629 MB
W20240217 14:55:22.529721 56865 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10006d33f000 7.629 MB
W20240217 14:55:22.529790 56865 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x10006dae2000 122.1 MB
W20240217 14:55:22.529863 56865 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x1000754f6000 122.1 MB
W20240217 14:55:22.529933 56865 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 14:55:22.542176 56865 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 14:55:22.542866 56863 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 14:55:22.562337 56862 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10007cf16000 7.629 MB
W20240217 14:55:22.562503 56862 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10007d6b9000 7.629 MB
W20240217 14:55:22.562562 56862 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10007de5c000 122.1 MB
W20240217 14:55:22.562608 56862 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100085870000 122.1 MB
W20240217 14:55:22.562669 56862 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 14:55:22.562930 56861 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10008d286000 7.629 MB
W20240217 14:55:22.563060 56861 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10008da29000 7.629 MB
W20240217 14:55:22.563120 56861 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10008e1cc000 122.1 MB
W20240217 14:55:22.563159 56861 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100095be0000 122.1 MB
W20240217 14:55:22.563212 56861 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 14:55:22.563871 56861 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 14:55:22.563870 56862 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 14:55:22.576145 56864 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10009d5fe000 7.629 MB
W20240217 14:55:22.576318 56864 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10009dda1000 7.629 MB
W20240217 14:55:22.576400 56864 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10009e544000 122.1 MB
W20240217 14:55:22.576455 56864 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x1000a5f5a000 122.1 MB
W20240217 14:55:22.576526 56864 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 14:55:22.576730 56866 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000ad96e000 7.629 MB
W20240217 14:55:22.576884 56866 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000ae111000 7.629 MB
W20240217 14:55:22.576952 56866 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x1000ae8b6000 122.1 MB
W20240217 14:55:22.576970 56864 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 14:55:22.577001 56866 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000b62ca000 122.1 MB
W20240217 14:55:22.577059 56866 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 14:55:22.577582 56866 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 14:55:22.761255 56860 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000bdce6000 7.629 MB
W20240217 14:55:22.761746 56860 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000be489000 7.629 MB
W20240217 14:55:22.761883 56860 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1000bec2c000 122.1 MB
W20240217 14:55:22.761951 56860 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000c6640000 122.1 MB
W20240217 14:55:22.762085 56860 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 14:55:22.769114 56860 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
Worker 7 pid=56866
New CachedEmbedding, name=full_emb, shape=(10000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1000000), (1000000, 2000000), (2000000, 3000000), (3000000, 4000000), (4000000, 5000000), (5000000, 6000000), (6000000, 7000000), (7000000, 8000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240217 14:55:23.185933 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000ce058000 7.629 MB
W20240217 14:55:23.186046 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000cef9e000 7.629 MB
W20240217 14:55:23.186040 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000ce7fb000 7.629 MB
W20240217 14:55:23.186070 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000cf741000 7.629 MB
W20240217 14:55:23.186076 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000cfee4000 7.629 MB
W20240217 14:55:23.186115 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000d15cd000 7.629 MB
W20240217 14:55:23.186111 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000d0e2a000 7.629 MB
W20240217 14:55:23.186107 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000d0687000 7.629 MB
W20240217 14:55:23.186172 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000d1d70000 7.629 MB
W20240217 14:55:23.186216 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000d2513000 7.629 MB
W20240217 14:55:23.186221 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000d2cb6000 7.629 MB
W20240217 14:55:23.186228 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000d3459000 7.629 MB
W20240217 14:55:23.186241 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000d3bfc000 7.629 MB
W20240217 14:55:23.186273 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000d439f000 7.629 MB
W20240217 14:55:23.186282 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000d4b42000 7.629 MB
W20240217 14:55:23.186287 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000d52e5000 7.629 MB
W20240217 14:55:23.186332 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000d622b000 7.629 MB
W20240217 14:55:23.186311 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000d5a88000 7.629 MB
W20240217 14:55:23.186357 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000d69ce000 7.629 MB
W20240217 14:55:23.186393 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000d7171000 7.629 MB
W20240217 14:55:23.186401 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000d7914000 7.629 MB
W20240217 14:55:23.186405 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000d80b7000 7.629 MB
W20240217 14:55:23.186442 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000d885a000 7.629 MB
W20240217 14:55:23.186475 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d8ffd000 7.629 MB
W20240217 14:55:23.186480 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000d97a0000 7.629 MB
W20240217 14:55:23.186528 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000d9f43000 7.629 MB
W20240217 14:55:23.186533 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000da6e6000 7.629 MB
W20240217 14:55:23.186561 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000dae89000 7.629 MB
W20240217 14:55:23.186568 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000db62c000 7.629 MB
W20240217 14:55:23.186604 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000dbdcf000 7.629 MB
W20240217 14:55:23.186630 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000dc572000 7.629 MB
W20240217 14:55:23.186657 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000dd4b8000 7.629 MB
W20240217 14:55:23.186643 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000dcd15000 7.629 MB
W20240217 14:55:23.186674 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000ddc5b000 7.629 MB
W20240217 14:55:23.186726 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000de3fe000 7.629 MB
W20240217 14:55:23.186748 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000deba1000 7.629 MB
W20240217 14:55:23.186787 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000df344000 7.629 MB
W20240217 14:55:23.186793 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000dfae7000 7.629 MB
W20240217 14:55:23.186807 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000e028a000 7.629 MB
W20240217 14:55:23.186820 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000e11d0000 7.629 MB
W20240217 14:55:23.186816 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000e0a2d000 7.629 MB
W20240217 14:55:23.186843 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000e1973000 7.629 MB
W20240217 14:55:23.186848 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000e2116000 7.629 MB
W20240217 14:55:23.186882 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000e28b9000 7.629 MB
W20240217 14:55:23.186887 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000e305c000 7.629 MB
W20240217 14:55:23.186901 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000e37ff000 7.629 MB
W20240217 14:55:23.186908 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000e3fa2000 7.629 MB
W20240217 14:55:23.186919 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000e4745000 7.629 MB
W20240217 14:55:23.186957 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000e4ee8000 7.629 MB
W20240217 14:55:23.186966 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000e568b000 7.629 MB
W20240217 14:55:23.186969 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000e5e2e000 7.629 MB
W20240217 14:55:23.186976 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000e65d1000 7.629 MB
W20240217 14:55:23.186981 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000e6d74000 7.629 MB
W20240217 14:55:23.186987 56863 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000e7517000 7.629 MB
W20240217 14:55:23.187034 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000e7cba000 7.629 MB
W20240217 14:55:23.187063 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000e845d000 7.629 MB
W20240217 14:55:23.187088 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000e8c00000 7.629 MB
W20240217 14:55:23.187104 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000e93a3000 7.629 MB
W20240217 14:55:23.187129 56866 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000ea2e9000 7.629 MB
W20240217 14:55:23.187122 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000e9b46000 7.629 MB
W20240217 14:55:23.187137 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000eaa8c000 7.629 MB
W20240217 14:55:23.187160 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000eb22f000 7.629 MB
W20240217 14:55:23.187165 56863 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000eb9d2000 80 B 
W20240217 14:55:23.187214 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000ec177000 7.629 MB
W20240217 14:55:23.187207 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000eb9d4000 7.629 MB
W20240217 14:55:23.187220 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000ec91a000 7.629 MB
W20240217 14:55:23.187229 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000ed0bd000 7.629 MB
W20240217 14:55:23.187235 56861 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000ed860000 7.629 MB
W20240217 14:55:23.187258 56863 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000ee003000 8 B 
W20240217 14:55:23.187276 56866 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000ee005000 80 B 
W20240217 14:55:23.187300 56860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000ee7aa000 7.629 MB
W20240217 14:55:23.187292 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000ee007000 7.629 MB
W20240217 14:55:23.187314 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000eef4d000 7.629 MB
W20240217 14:55:23.187330 56862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000ef6f0000 7.629 MB
W20240217 14:55:23.187336 56863 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000efe93000 8 B 
W20240217 14:55:23.187342 56861 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000efe95000 80 B 
W20240217 14:55:23.187353 56866 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000efe97000 8 B 
W20240217 14:55:23.187363 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000efe99000 7.629 MB
W20240217 14:55:23.187372 56860 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000f063c000 80 B 
W20240217 14:55:23.187414 56500 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000f0640000 7.629 MB
W20240217 14:55:23.187412 56861 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000f063e000 8 B 
W20240217 14:55:23.187422 56862 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000f0de3000 80 B 
W20240217 14:55:23.187426 56866 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000f0de5000 8 B 
W20240217 14:55:23.187440 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000f0de7000 7.629 MB
W20240217 14:55:23.187476 56500 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000f158a000 80 B 
W20240217 14:55:23.187489 56861 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000f158c000 8 B 
W20240217 14:55:23.187520 56500 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000f158e000 8 B 
W20240217 14:55:23.187582 56500 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000f1590000 8 B 
Construct PerfSampler done
W20240217 14:55:23.187608 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000f1592000 7.629 MB
Construct PerfSampler done
W20240217 14:55:23.187708 56862 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000f1d35000 8 B 
W20240217 14:55:23.187719 56860 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000f1d37000 8 B 
I20240217 14:55:23.187726 56863 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240217 14:55:23.187745 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000f1d39000 7.629 MB
Construct PerfSampler done
W20240217 14:55:23.187755 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000f24dc000 7.629 MB
I20240217 14:55:23.187780 56866 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 14:55:23.187786 56862 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000f2c7f000 8 B 
W20240217 14:55:23.187793 56860 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000f2c81000 8 B 
I20240217 14:55:23.187886 56861 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 14:55:23.187889 56864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000f2c83000 7.629 MB
W20240217 14:55:23.187920 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000f3426000 7.629 MB
Construct PerfSampler done
W20240217 14:55:23.188009 56864 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000f3bc9000 80 B 
I20240217 14:55:23.188045 56500 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
Construct PerfSampler done
W20240217 14:55:23.188046 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000f3bcb000 7.629 MB
Construct PerfSampler done
W20240217 14:55:23.188140 56864 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000f436e000 8 B 
I20240217 14:55:23.188171 56862 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 14:55:23.188211 56865 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000f4370000 80 B 
I20240217 14:55:23.188237 56860 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 14:55:23.188234 56864 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000f4372000 8 B 
W20240217 14:55:23.188314 56865 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000f4374000 8 B 
W20240217 14:55:23.188421 56865 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000f4376000 8 B 
Construct PerfSampler done
I20240217 14:55:23.188660 56864 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
Construct PerfSampler done
I20240217 14:55:23.188911 56865 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240217 14:55:23.949126 56860 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 14:55:23.949491 56866 recstore.cc:66] init folly done
E20240217 14:55:23.949486 56861 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240217 14:55:23.949743 56865 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 14:55:23.950330 56863 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 14:55:23.950671 56500 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 14:55:23.951014 56862 recstore.cc:66] init folly done
E20240217 14:55:23.951032 56864 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Before Training
I20240217 14:55:23.962864 56861 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240217 14:55:23.963877 56865 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 14:55:23.964267 56864 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 14:55:23.964851 56866 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240217 14:55:23.965951 56500 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240217 14:55:23.966101 56862 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240217 14:55:23.966150 56863 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240217 14:55:23.966194 56860 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 214.396 us                |
| GenInput                  | 1.002 ms                  | 1.002 ms                  |
| forward: NN               | 44.568 ms                 | 44.568 ms                 |
| Forward                   | 48.149 ms                 | 48.149 ms                 |
| back: bucket keys         | 34.271 ms                 | 34.271 ms                 |
| back: a2a                 | 54.103 s                  | 54.103 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 197.665 us                | 471.025 us                |
| GenInput                  | 772.429 us                | 5.437 ms                  |
| forward: NN               | 160.375 us                | 44.568 ms                 |
| Forward                   | 1.347 ms                  | 48.149 ms                 |
| back: bucket keys         | 1.409 ms                  | 34.271 ms                 |
| back: a2a                 | 15.220 ms                 | 54.103 s                  |
| back: cache               | 470.227 ms                | 491.916 ms                |
| back: aggr dram keys      | 91.487 ms                 | 968.057 ms                |
| back: set dram grad       | 3.335 ms                  | 5.506 ms                  |
| Backward                  | 567.545 ms                | 55.622 s                  |
| Optimize                  | 39.222 ms                 | 315.869 ms                |
| BarrierTimeBeforeRank0    | 68.737 us                 | 366.393 us                |
| BlockToStepN              | 76.054 us                 | 2.009 ms                  |
| OneStep                   | 617.011 ms                | 55.994 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 1.993 ms                  |
| GenInput                  | 880.521 us                | 5.437 ms                  |
| forward: NN               | 174.819 us                | 44.568 ms                 |
| Forward                   | 1.252 ms                  | 48.149 ms                 |
| back: bucket keys         | 997.543 us                | 34.271 ms                 |
| back: a2a                 | 14.408 ms                 | 54.103 s                  |
| back: cache               | 470.227 ms                | 519.089 ms                |
| back: aggr dram keys      | 105.114 ms                | 968.057 ms                |
| back: set dram grad       | 2.802 ms                  | 12.223 ms                 |
| Backward                  | 581.283 ms                | 55.622 s                  |
| Optimize                  | 39.222 ms                 | 315.869 ms                |
| BarrierTimeBeforeRank0    | 75.498 us                 | 382.799 us                |
| BlockToStepN              | 117.270 us                | 2.009 ms                  |
| OneStep                   | 626.505 ms                | 55.994 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 214.396 us                | 1.993 ms                  |
| GenInput                  | 899.475 us                | 5.437 ms                  |
| forward: NN               | 165.979 us                | 44.568 ms                 |
| Forward                   | 1.316 ms                  | 48.149 ms                 |
| back: bucket keys         | 844.240 us                | 34.271 ms                 |
| back: a2a                 | 14.848 ms                 | 54.103 s                  |
| back: cache               | 459.521 ms                | 524.844 ms                |
| back: aggr dram keys      | 105.114 ms                | 968.057 ms                |
| back: set dram grad       | 2.802 ms                  | 12.223 ms                 |
| Backward                  | 601.726 ms                | 55.622 s                  |
| Optimize                  | 39.222 ms                 | 315.869 ms                |
| BarrierTimeBeforeRank0    | 70.171 us                 | 426.836 us                |
| BlockToStepN              | 212.244 us                | 2.009 ms                  |
| OneStep                   | 643.385 ms                | 55.994 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 228.971 us                | 2.213 ms                  |
| GenInput                  | 900.361 us                | 7.026 ms                  |
| forward: NN               | 165.979 us                | 44.568 ms                 |
| Forward                   | 1.101 ms                  | 48.149 ms                 |
| back: bucket keys         | 997.543 us                | 34.271 ms                 |
| back: a2a                 | 14.408 ms                 | 54.103 s                  |
| back: cache               | 463.215 ms                | 544.118 ms                |
| back: aggr dram keys      | 108.001 ms                | 968.057 ms                |
| back: set dram grad       | 2.887 ms                  | 12.223 ms                 |
| Backward                  | 604.308 ms                | 55.622 s                  |
| Optimize                  | 46.825 ms                 | 315.869 ms                |
| BarrierTimeBeforeRank0    | 75.498 us                 | 426.836 us                |
| BlockToStepN              | 184.489 us                | 2.210 ms                  |
| OneStep                   | 649.410 ms                | 55.994 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 247.799 us                | 2.213 ms                  |
| GenInput                  | 1.088 ms                  | 7.026 ms                  |
| forward: NN               | 165.979 us                | 44.568 ms                 |
| Forward                   | 1.047 ms                  | 48.149 ms                 |
| back: bucket keys         | 844.240 us                | 34.271 ms                 |
| back: a2a                 | 14.408 ms                 | 54.103 s                  |
| back: cache               | 459.521 ms                | 544.118 ms                |
| back: aggr dram keys      | 105.114 ms                | 968.057 ms                |
| back: set dram grad       | 2.802 ms                  | 12.223 ms                 |
| Backward                  | 596.432 ms                | 55.622 s                  |
| Optimize                  | 46.825 ms                 | 315.869 ms                |
| BarrierTimeBeforeRank0    | 78.437 us                 | 426.836 us                |
| BlockToStepN              | 175.851 us                | 2.210 ms                  |
| OneStep                   | 646.875 ms                | 55.994 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 241.920 us                | 3.438 ms                  |
| GenInput                  | 1.088 ms                  | 7.026 ms                  |
| forward: NN               | 158.562 us                | 44.568 ms                 |
| Forward                   | 908.032 us                | 48.149 ms                 |
| back: bucket keys         | 842.094 us                | 34.271 ms                 |
| back: a2a                 | 13.919 ms                 | 54.103 s                  |
| back: cache               | 459.521 ms                | 544.118 ms                |
| back: aggr dram keys      | 108.001 ms                | 968.057 ms                |
| back: set dram grad       | 2.740 ms                  | 12.223 ms                 |
| Backward                  | 592.678 ms                | 55.622 s                  |
| Optimize                  | 40.341 ms                 | 315.869 ms                |
| BarrierTimeBeforeRank0    | 74.275 us                 | 426.836 us                |
| BlockToStepN              | 117.270 us                | 2.210 ms                  |
| OneStep                   | 641.122 ms                | 55.994 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 233.369 us                | 3.438 ms                  |
| GenInput                  | 1.112 ms                  | 7.026 ms                  |
| forward: NN               | 151.692 us                | 44.568 ms                 |
| Forward                   | 806.984 us                | 48.149 ms                 |
| back: bucket keys         | 919.104 us                | 34.271 ms                 |
| back: a2a                 | 14.262 ms                 | 54.103 s                  |
| back: cache               | 457.939 ms                | 544.118 ms                |
| back: aggr dram keys      | 108.729 ms                | 968.057 ms                |
| back: set dram grad       | 2.735 ms                  | 12.223 ms                 |
| Backward                  | 590.828 ms                | 55.622 s                  |
| Optimize                  | 40.341 ms                 | 315.869 ms                |
| BarrierTimeBeforeRank0    | 70.171 us                 | 426.836 us                |
| BlockToStepN              | 174.265 us                | 2.210 ms                  |
| OneStep                   | 641.075 ms                | 55.994 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 221.939 us                | 2.213 ms                  |
| GenInput                  | 1.081 ms                  | 5.554 ms                  |
| forward: NN               | 150.870 us                | 6.119 ms                  |
| Forward                   | 806.984 us                | 7.347 ms                  |
| back: bucket keys         | 855.207 us                | 4.676 ms                  |
| back: a2a                 | 14.262 ms                 | 26.947 ms                 |
| back: cache               | 464.306 ms                | 539.628 ms                |
| back: aggr dram keys      | 108.729 ms                | 409.802 ms                |
| back: set dram grad       | 2.629 ms                  | 7.679 ms                  |
| Backward                  | 590.828 ms                | 808.780 ms                |
| Optimize                  | 40.341 ms                 | 149.922 ms                |
| BarrierTimeBeforeRank0    | 68.737 us                 | 422.323 us                |
| BlockToStepN              | 153.081 us                | 2.009 ms                  |
| OneStep                   | 638.819 ms                | 945.482 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
Successfully xmh
