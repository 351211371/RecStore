WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240217 19:24:45.136613 54841 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240217 19:24:45.145316 54841 IPCTensor.h:369] NewIPCTensor: full_emb [10000000, 32]0x100000002000 1.192 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [54841 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f8d25d39b20>==========
Worker 1 pid=55205
Worker 2 pid=55206
Worker 3 pid=55207
Worker 4 pid=55208
Worker 5 pid=55209
Worker 6 pid=55210
INFO [54841 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [55205 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [55206 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [54841 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55205 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55207 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [55211 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [55209 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [55208 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [55210 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [55211 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55208 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55207 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55210 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55209 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 19:24:51.733968 54841 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:24:51.733973 55205 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:24:51.735741 55210 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:24:51.735857 55209 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:24:51.735760 55208 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:24:51.735846 55207 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 19:24:51.735741 55211 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [55206 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 19:24:51.742437 55206 IPCTensor.h:348] IPCTensor full_emb already exists
W20240217 19:24:57.428797 55211 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1000000, 32]; dev=7; size=122.1 MB
W20240217 19:24:57.431393 55206 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1000000, 32]; dev=2; size=122.1 MB
W20240217 19:24:57.431414 55205 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1000000, 32]; dev=1; size=122.1 MB
W20240217 19:24:57.431522 55208 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1000000, 32]; dev=4; size=122.1 MB
W20240217 19:24:57.431552 55210 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1000000, 32]; dev=6; size=122.1 MB
W20240217 19:24:57.431617 55209 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1000000, 32]; dev=5; size=122.1 MB
W20240217 19:24:57.431598 55207 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1000000, 32]; dev=3; size=122.1 MB
W20240217 19:24:57.432480 54841 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1000000, 32]; dev=0; size=122.1 MB
W20240217 19:24:58.191709 55208 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10004c4ba000 7.629 MB
W20240217 19:24:58.191960 55208 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10004cc5d000 7.629 MB
W20240217 19:24:58.192150 55208 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10004d400000 122.1 MB
W20240217 19:24:58.192227 55208 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x100054e14000 122.1 MB
W20240217 19:24:58.192309 55208 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 19:24:58.194525 55208 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 19:24:58.196503 55207 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10005c82e000 7.629 MB
W20240217 19:24:58.196677 55207 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10005cfd1000 7.629 MB
W20240217 19:24:58.196781 55207 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10005d774000 122.1 MB
W20240217 19:24:58.196831 55207 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100065188000 122.1 MB
W20240217 19:24:58.196880 55207 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 19:24:58.197198 55206 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10006cb9e000 7.629 MB
W20240217 19:24:58.197324 55206 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10006d341000 7.629 MB
W20240217 19:24:58.197387 55206 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10006dae4000 122.1 MB
W20240217 19:24:58.197432 55206 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x1000754f8000 122.1 MB
W20240217 19:24:58.197487 55206 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 19:24:58.210453 55207 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 19:24:58.210502 55205 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10007cf10000 7.629 MB
W20240217 19:24:58.210624 55205 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10007d6b3000 7.629 MB
W20240217 19:24:58.210703 55205 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10007de56000 122.1 MB
W20240217 19:24:58.210755 55205 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10008586a000 122.1 MB
W20240217 19:24:58.210813 55205 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 19:24:58.211212 55206 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 19:24:58.211375 55205 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 19:24:58.212179 55210 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10008d28a000 7.629 MB
W20240217 19:24:58.212337 55210 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10008da2d000 7.629 MB
W20240217 19:24:58.212399 55210 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x10008e1d0000 122.1 MB
W20240217 19:24:58.212451 55210 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x100095be4000 122.1 MB
W20240217 19:24:58.212503 55210 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 19:24:58.213021 55210 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 19:24:58.224707 54841 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10009d5fe000 7.629 MB
W20240217 19:24:58.225103 55211 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10009dda3000 7.629 MB
W20240217 19:24:58.225183 54841 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10009e546000 7.629 MB
W20240217 19:24:58.225251 55211 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10009ece9000 7.629 MB
W20240217 19:24:58.225270 54841 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10009f48c000 122.1 MB
W20240217 19:24:58.225330 55211 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x1000a6ea0000 122.1 MB
W20240217 19:24:58.225346 54841 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000ae8b4000 122.1 MB
W20240217 19:24:58.225409 54841 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 19:24:58.225409 55211 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000b62c8000 122.1 MB
W20240217 19:24:58.225482 55211 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 19:24:58.226539 54841 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 19:24:58.226620 55211 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 19:24:58.242513 55209 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1000bdce6000 7.629 MB
W20240217 19:24:58.242638 55209 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1000be489000 7.629 MB
W20240217 19:24:58.242702 55209 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x1000bec2c000 122.1 MB
W20240217 19:24:58.242751 55209 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x1000c6640000 122.1 MB
W20240217 19:24:58.242802 55209 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 19:24:58.243355 55209 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
Worker 7 pid=55211
New CachedEmbedding, name=full_emb, shape=(10000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1000000), (1000000, 2000000), (2000000, 3000000), (3000000, 4000000), (4000000, 5000000), (5000000, 6000000), (6000000, 7000000), (7000000, 8000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
W20240217 19:24:58.877959 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000ce058000 7.629 MB
W20240217 19:24:58.878093 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000ce7fb000 7.629 MB
W20240217 19:24:58.878166 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000cef9e000 7.629 MB
W20240217 19:24:58.878232 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000cfee4000 7.629 MB
W20240217 19:24:58.878242 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000cf741000 7.629 MB
W20240217 19:24:58.878297 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000d0687000 7.629 MB
W20240217 19:24:58.878351 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000d0e2a000 7.629 MB
W20240217 19:24:58.878412 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000d1d70000 7.629 MB
W20240217 19:24:58.878398 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000d15cd000 7.629 MB
W20240217 19:24:58.878465 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000d2513000 7.629 MB
W20240217 19:24:58.878551 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000d2cb6000 7.629 MB
W20240217 19:24:58.878584 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000d3459000 7.629 MB
W20240217 19:24:58.878715 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000d3bfc000 7.629 MB
W20240217 19:24:58.878760 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000d4b42000 7.629 MB
W20240217 19:24:58.878756 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000d439f000 7.629 MB
W20240217 19:24:58.878830 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000d52e5000 7.629 MB
W20240217 19:24:58.878858 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000d5a88000 7.629 MB
W20240217 19:24:58.878876 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000d622b000 7.629 MB
W20240217 19:24:58.878906 55211 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000d7171000 7.629 MB
W20240217 19:24:58.878906 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000d69ce000 7.629 MB
W20240217 19:24:58.878954 55211 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000d7914000 80 B 
W20240217 19:24:58.878991 55211 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000d7916000 8 B 
W20240217 19:24:58.879002 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000d7918000 7.629 MB
W20240217 19:24:58.879027 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000d80bb000 7.629 MB
W20240217 19:24:58.879050 55211 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000d885e000 8 B 
W20240217 19:24:58.879135 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000d8860000 7.629 MB
W20240217 19:24:58.879215 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000d9003000 7.629 MB
W20240217 19:24:58.879253 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000d97a6000 7.629 MB
W20240217 19:24:58.879272 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000d9f49000 7.629 MB
W20240217 19:24:58.879317 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000da6ec000 7.629 MB
W20240217 19:24:58.879356 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000dae8f000 7.629 MB
W20240217 19:24:58.879429 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000db632000 7.629 MB
W20240217 19:24:58.879472 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000dbdd5000 7.629 MB
Construct PerfSampler done
W20240217 19:24:58.879487 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000dc578000 7.629 MB
I20240217 19:24:58.879609 55211 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240217 19:24:58.879562 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000dcd1b000 7.629 MB
W20240217 19:24:58.879638 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000dd4be000 7.629 MB
W20240217 19:24:58.879702 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000de404000 7.629 MB
W20240217 19:24:58.879695 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000ddc61000 7.629 MB
W20240217 19:24:58.879734 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000deba7000 7.629 MB
W20240217 19:24:58.879745 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000dfaed000 7.629 MB
W20240217 19:24:58.879786 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000e0290000 7.629 MB
W20240217 19:24:58.879879 55210 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000e1979000 7.629 MB
W20240217 19:24:58.879803 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000e0a33000 7.629 MB
W20240217 19:24:58.879933 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000e28bf000 7.629 MB
W20240217 19:24:58.879860 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000e11d6000 7.629 MB
W20240217 19:24:58.879957 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000e3062000 7.629 MB
W20240217 19:24:58.879894 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000e211c000 7.629 MB
W20240217 19:24:58.879750 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000df34a000 7.629 MB
W20240217 19:24:58.880060 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000e3807000 7.629 MB
W20240217 19:24:58.880044 55210 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000e3805000 80 B 
W20240217 19:24:58.880095 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000e3faa000 7.629 MB
W20240217 19:24:58.880156 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000e474d000 7.629 MB
W20240217 19:24:58.880183 55210 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000e4ef0000 8 B 
W20240217 19:24:58.880192 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000e4ef2000 7.629 MB
W20240217 19:24:58.880225 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000e5695000 7.629 MB
W20240217 19:24:58.880230 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000e5e38000 7.629 MB
W20240217 19:24:58.880311 55210 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000e65db000 8 B 
W20240217 19:24:58.880326 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000e65dd000 7.629 MB
W20240217 19:24:58.880350 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000e6d80000 7.629 MB
W20240217 19:24:58.880403 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000e7523000 7.629 MB
W20240217 19:24:58.880462 55209 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000e7cc6000 7.629 MB
W20240217 19:24:58.880530 55209 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000e8469000 80 B 
W20240217 19:24:58.880548 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000e846b000 7.629 MB
W20240217 19:24:58.880592 55209 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000e8c0e000 8 B 
W20240217 19:24:58.880657 55209 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000e8c10000 8 B 
W20240217 19:24:58.880662 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000e8c12000 7.629 MB
W20240217 19:24:58.880697 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000e93b5000 7.629 MB
W20240217 19:24:58.880707 55208 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000e9b58000 7.629 MB
W20240217 19:24:58.880714 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000ea2fb000 7.629 MB
W20240217 19:24:58.880741 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000eaa9e000 7.629 MB
W20240217 19:24:58.880754 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000eb241000 7.629 MB
W20240217 19:24:58.880810 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000eb9e4000 7.629 MB
W20240217 19:24:58.880827 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000ec187000 7.629 MB
Construct PerfSampler done
W20240217 19:24:58.880849 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000ec92a000 7.629 MB
W20240217 19:24:58.880892 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000ed870000 7.629 MB
W20240217 19:24:58.880887 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000ed0cd000 7.629 MB
W20240217 19:24:58.880903 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000ee015000 7.629 MB
W20240217 19:24:58.880901 55208 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000ee013000 80 B 
W20240217 19:24:58.880966 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000eef5b000 7.629 MB
W20240217 19:24:58.880965 55207 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000ee7b8000 7.629 MB
W20240217 19:24:58.880972 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000ef6fe000 7.629 MB
I20240217 19:24:58.880980 55210 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 19:24:58.881027 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000efea1000 7.629 MB
W20240217 19:24:58.881071 55208 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000f0644000 8 B 
W20240217 19:24:58.881079 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000f0646000 7.629 MB
W20240217 19:24:58.881089 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000f0deb000 7.629 MB
W20240217 19:24:58.881109 55205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000f158e000 7.629 MB
W20240217 19:24:58.881086 55207 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000f0de9000 80 B 
Construct PerfSampler done
W20240217 19:24:58.881165 55205 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000f1d31000 80 B 
W20240217 19:24:58.881170 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000f1d33000 7.629 MB
W20240217 19:24:58.881208 55207 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000f24d6000 8 B 
W20240217 19:24:58.881220 55208 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000f24d8000 8 B 
W20240217 19:24:58.881238 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000f24dc000 7.629 MB
W20240217 19:24:58.881237 55205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000f24da000 8 B 
W20240217 19:24:58.881255 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000f2c7f000 7.629 MB
I20240217 19:24:58.881263 55209 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 19:24:58.881299 54841 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000f3422000 7.629 MB
W20240217 19:24:58.881318 55207 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000f3bc5000 8 B 
W20240217 19:24:58.881357 54841 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000f3bc7000 80 B 
W20240217 19:24:58.881390 55205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000f436c000 8 B 
W20240217 19:24:58.881387 55206 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000f3bc9000 7.629 MB
W20240217 19:24:58.881414 54841 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000f436e000 8 B 
W20240217 19:24:58.881444 54841 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000f4370000 8 B 
W20240217 19:24:58.881496 55206 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000f4372000 80 B 
W20240217 19:24:58.881580 55206 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000f4374000 8 B 
W20240217 19:24:58.881675 55206 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000f4376000 8 B 
Construct PerfSampler done
Construct PerfSampler done
Construct PerfSampler done
Construct PerfSampler done
I20240217 19:24:58.882112 55208 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240217 19:24:58.882169 55207 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240217 19:24:58.882249 54841 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240217 19:24:58.882267 55205 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
Construct PerfSampler done
I20240217 19:24:58.882400 55206 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 19:24:58.884415 54841 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16,
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240217 19:24:58.884531 54841 grad_base.h:184] Init GradProcessingBase done
I20240217 19:25:00.110865 54841 grad_async_v2.h:42] Use main thread to update emb.
W20240217 19:25:00.111264 54841 kg_controller.h:78] after init GradAsyncProcessingV2
I20240217 19:25:00.111277 54841 kg_controller.h:84] Construct KGCacheController done
E20240217 19:25:01.917543 55205 recstore.cc:66] init folly done
E20240217 19:25:01.917549 55207 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 19:25:01.917634 55209 recstore.cc:66] init folly done
E20240217 19:25:01.917663 55208 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 19:25:01.917675 54841 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240217 19:25:01.918036 55210 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 19:25:01.918146 55206 recstore.cc:66] init folly done
E20240217 19:25:01.918164 55211 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240217 19:25:01.919279 54841 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240217 19:25:02.822094 56480 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240217 19:25:02.822409 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240217 19:25:03.822014 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240217 19:25:03.828545 56480 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240217 19:25:04.822026 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240217 19:25:04.843261 56480 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240217 19:25:05.822026 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240217 19:25:05.877965 56480 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
Before Training
I20240217 19:25:05.981580 54841 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240217 19:25:06.014146 55205 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:25:06.065042 55206 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:25:06.130527 55207 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:25:06.198889 55208 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:25:06.270296 55209 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:25:06.340953 55210 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 19:25:06.415036 55211 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240217 19:25:06.822046 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=106
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 159.404 us                | 423.332 us                |
+---------------------------+---------------------------+---------------------------+
W20240217 19:25:06.934577 56480 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240217 19:25:08.381814 57244 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240217 19:25:08.498432 54841 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240217 19:25:08.605976 56480 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 195.200 us                | 243.788 us                |
| GenInput                  | 1.298 ms                  | 2.906 ms                  |
| forward: NN               | 554.196 us                | 50.363 ms                 |
| Forward                   | 5.894 ms                  | 53.981 ms                 |
| Backward                  | 7.670 ms                  | 27.041 ms                 |
| Optimize                  | 479.607 us                | 579.908 us                |
| BarrierTimeBeforeRank0    | 595.379 us                | 45.273 ms                 |
| AfterBackward             | 225.046 ms                | 1.949 s                   |
| BlockToStepN              | 170.809 us                | 107.153 ms                |
| OneStep                   | 242.143 ms                | 2.190 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
E20240217 19:25:09.381009 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=10055
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
W20240217 19:25:09.617790 56480 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
E20240217 19:25:10.381028 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=9868
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
W20240217 19:25:10.695649 56480 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240217 19:25:11.392135 56498 parallel_pq_v2.h:79] insert failed, size(hashtable)=16219
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 266.491 us                | 36.148 ms                 |
| ProcessBack:Shuffle       | 240.309 ms                | 555.992 ms                |
| ProcessBack:UpdateCache   | 18.943 ms                 | 1.261 s                   |
| ProcessBack:UpsertPq      | 67.512 us                 | 115.203 ms                |
| ProcessOneStep            | 258.149 ms                | 1.948 s                   |
| BlockToStepN              | 35.277 us                 | 106.288 ms                |
+---------------------------+---------------------------+---------------------------+
W20240217 19:25:11.954002 56480 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
E20240217 19:25:12.388008 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1408
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
W20240217 19:25:13.098250 56480 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240217 19:25:13.358307 54841 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=20, sample_step_cpp_seen_[rank]=19
E20240217 19:25:13.388016 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 137.936 us                | 702.965 us                |
| GenInput                  | 1.298 ms                  | 5.836 ms                  |
| forward: NN               | 107.876 us                | 50.363 ms                 |
| Forward                   | 409.173 us                | 53.981 ms                 |
| Backward                  | 1.037 ms                  | 27.041 ms                 |
| Optimize                  | 158.178 us                | 579.908 us                |
| BarrierTimeBeforeRank0    | 572.499 us                | 45.273 ms                 |
| AfterBackward             | 263.329 ms                | 1.949 s                   |
| BlockToStepN              | 144.321 us                | 107.153 ms                |
| OneStep                   | 266.497 ms                | 2.190 s                   |
+---------------------------+---------------------------+---------------------------+
W20240217 19:25:14.152516 56480 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240217 19:25:14.388015 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=2561
W20240217 19:25:14.547714 54841 grad_async_v2.h:257] pq is empty
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
W20240217 19:25:14.855501 54841 grad_async_v2.h:257] pq is empty
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
W20240217 19:25:15.161825 56480 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240217 19:25:15.388022 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=16918
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
W20240217 19:25:16.213716 56480 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
E20240217 19:25:16.388015 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=13533
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 224.249 us                | 32.146 ms                 |
| ProcessBack:Shuffle       | 246.511 ms                | 555.992 ms                |
| ProcessBack:UpdateCache   | 18.480 ms                 | 1.261 s                   |
| ProcessBack:UpsertPq      | 69.920 us                 | 115.203 ms                |
| ProcessOneStep            | 267.968 ms                | 1.948 s                   |
| BlockToStepN              | 82.392 us                 | 106.288 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
W20240217 19:25:17.348620 56480 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240217 19:25:17.388010 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
E20240217 19:25:18.388020 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=7039
W20240217 19:25:18.432796 56480 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 137.936 us                | 702.965 us                |
| GenInput                  | 989.688 us                | 5.836 ms                  |
| forward: NN               | 105.848 us                | 50.363 ms                 |
| Forward                   | 418.818 us                | 53.981 ms                 |
| Backward                  | 1.037 ms                  | 27.041 ms                 |
| Optimize                  | 151.624 us                | 579.908 us                |
| BarrierTimeBeforeRank0    | 451.688 us                | 45.273 ms                 |
| AfterBackward             | 268.114 ms                | 1.949 s                   |
| BlockToStepN              | 175.770 us                | 107.153 ms                |
| OneStep                   | 271.592 ms                | 2.190 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
E20240217 19:25:19.388024 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1727
W20240217 19:25:19.574863 56480 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
E20240217 19:25:20.388021 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=12263
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
W20240217 19:25:20.606114 56480 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
E20240217 19:25:21.388072 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=4426
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
W20240217 19:25:21.666653 56480 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 247.236 us                | 36.217 ms                 |
| ProcessBack:Shuffle       | 247.393 ms                | 555.992 ms                |
| ProcessBack:UpdateCache   | 17.824 ms                 | 1.261 s                   |
| ProcessBack:UpsertPq      | 67.961 us                 | 115.203 ms                |
| ProcessOneStep            | 268.079 ms                | 1.948 s                   |
| BlockToStepN              | 104.685 us                | 106.288 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
E20240217 19:25:22.388010 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1274
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240217 19:25:22.689245 56480 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
E20240217 19:25:23.388018 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=247
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
W20240217 19:25:23.841416 56480 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.591 us                | 546.867 us                |
| GenInput                  | 896.552 us                | 4.447 ms                  |
| forward: NN               | 102.031 us                | 554.196 us                |
| Forward                   | 407.530 us                | 5.894 ms                  |
| Backward                  | 1.061 ms                  | 7.670 ms                  |
| Optimize                  | 144.522 us                | 479.607 us                |
| BarrierTimeBeforeRank0    | 430.103 us                | 1.853 ms                  |
| AfterBackward             | 268.336 ms                | 1.166 s                   |
| BlockToStepN              | 211.371 us                | 883.101 us                |
| OneStep                   | 271.868 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
E20240217 19:25:24.388023 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1826
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240217 19:25:25.008963 56480 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240217 19:25:25.152637 54841 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=61, sample_step_cpp_seen_[rank]=60
E20240217 19:25:25.388029 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=18
W20240217 19:25:26.036890 56480 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
W20240217 19:25:26.354696 54841 grad_async_v2.h:257] pq is empty
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
E20240217 19:25:26.388007 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1635
W20240217 19:25:26.617341 54841 grad_async_v2.h:257] pq is empty
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 154.326 us                | 27.893 ms                 |
| ProcessBack:Shuffle       | 251.046 ms                | 291.121 ms                |
| ProcessBack:UpdateCache   | 18.057 ms                 | 28.877 ms                 |
| ProcessBack:UpsertPq      | 68.514 us                 | 185.258 us                |
| ProcessOneStep            | 269.477 ms                | 1.196 s                   |
| BlockToStepN              | 126.920 us                | 518.113 us                |
+---------------------------+---------------------------+---------------------------+
W20240217 19:25:27.036819 56480 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
E20240217 19:25:27.388015 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=20534
W20240217 19:25:27.411221 54841 grad_async_v2.h:257] pq is empty
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
W20240217 19:25:27.700155 54841 grad_async_v2.h:257] pq is empty
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240217 19:25:27.978291 54841 grad_async_v2.h:257] pq is empty
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
W20240217 19:25:28.069700 56480 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
E20240217 19:25:28.388026 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=8343
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.092 us                | 546.867 us                |
| GenInput                  | 930.231 us                | 4.447 ms                  |
| forward: NN               | 101.038 us                | 554.196 us                |
| Forward                   | 399.850 us                | 5.894 ms                  |
| Backward                  | 1.045 ms                  | 7.670 ms                  |
| Optimize                  | 144.522 us                | 479.607 us                |
| BarrierTimeBeforeRank0    | 431.037 us                | 1.853 ms                  |
| AfterBackward             | 269.519 ms                | 1.196 s                   |
| BlockToStepN              | 223.380 us                | 883.101 us                |
| OneStep                   | 273.396 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
W20240217 19:25:29.075589 56480 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
E20240217 19:25:29.388082 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=6874
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
W20240217 19:25:30.087235 56480 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
E20240217 19:25:30.388033 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
W20240217 19:25:31.163738 56480 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
E20240217 19:25:31.388023 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=14397
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 217.050 us                | 43.501 ms                 |
| ProcessBack:Shuffle       | 249.465 ms                | 291.121 ms                |
| ProcessBack:UpdateCache   | 18.480 ms                 | 28.877 ms                 |
| ProcessBack:UpsertPq      | 67.512 us                 | 185.258 us                |
| ProcessOneStep            | 268.282 ms                | 1.196 s                   |
| BlockToStepN              | 147.547 us                | 524.810 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
W20240217 19:25:32.219771 56480 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
E20240217 19:25:32.388011 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=8615
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
W20240217 19:25:33.351316 56480 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240217 19:25:33.388002 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1513
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.553 us                | 546.867 us                |
| GenInput                  | 865.578 us                | 4.447 ms                  |
| forward: NN               | 101.235 us                | 554.196 us                |
| Forward                   | 392.447 us                | 5.894 ms                  |
| Backward                  | 1.071 ms                  | 7.670 ms                  |
| Optimize                  | 143.502 us                | 479.607 us                |
| BarrierTimeBeforeRank0    | 413.469 us                | 1.853 ms                  |
| AfterBackward             | 268.336 ms                | 1.196 s                   |
| BlockToStepN              | 247.009 us                | 986.370 us                |
| OneStep                   | 271.868 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
W20240217 19:25:34.359607 56480 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240217 19:25:34.388060 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=9624
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
E20240217 19:25:35.388075 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=320
W20240217 19:25:35.503592 56480 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank0, time: 37.274, per_step: 0.372741
Step99:rank7, time: 37.274, per_step: 0.372739
Step99:rank2, time: 37.274, per_step: 0.372741
Step99:rank5, time: 37.274, per_step: 0.372739
Step99:rank3, time: 37.274, per_step: 0.372738
Step99:rank1, time: 37.274, per_step: 0.372739
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
Step99:rank4, time: 37.274, per_step: 0.372742
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
Step99:rank6, time: 37.274, per_step: 0.372743
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.553 us                | 546.867 us                |
| GenInput                  | 865.578 us                | 4.447 ms                  |
| forward: NN               | 101.235 us                | 554.196 us                |
| Forward                   | 388.596 us                | 5.894 ms                  |
| Backward                  | 1.061 ms                  | 7.670 ms                  |
| Optimize                  | 142.405 us                | 479.607 us                |
| BarrierTimeBeforeRank0    | 413.469 us                | 1.853 ms                  |
| AfterBackward             | 268.586 ms                | 1.196 s                   |
| BlockToStepN              | 250.338 us                | 986.370 us                |
| OneStep                   | 272.284 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
E20240217 19:25:36.388020 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=14101
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
W20240217 19:25:36.559610 56480 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 206.987 us                | 36.006 ms                 |
| ProcessBack:Shuffle       | 250.095 ms                | 291.121 ms                |
| ProcessBack:UpdateCache   | 19.671 ms                 | 28.877 ms                 |
| ProcessBack:UpsertPq      | 67.905 us                 | 185.258 us                |
| ProcessOneStep            | 268.542 ms                | 1.196 s                   |
| BlockToStepN              | 168.410 us                | 846.815 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
E20240217 19:25:37.388063 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=3432
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
W20240217 19:25:37.581871 56480 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
E20240217 19:25:38.388015 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=50
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
W20240217 19:25:38.659473 56480 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.553 us                | 546.867 us                |
| GenInput                  | 870.676 us                | 4.447 ms                  |
| forward: NN               | 101.751 us                | 554.196 us                |
| Forward                   | 390.584 us                | 5.894 ms                  |
| Backward                  | 1.061 ms                  | 7.670 ms                  |
| Optimize                  | 142.405 us                | 579.908 us                |
| BarrierTimeBeforeRank0    | 413.469 us                | 1.853 ms                  |
| AfterBackward             | 268.586 ms                | 1.196 s                   |
| BlockToStepN              | 259.402 us                | 4.126 ms                  |
| OneStep                   | 272.284 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
E20240217 19:25:39.388012 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=979
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
W20240217 19:25:39.825088 56480 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
E20240217 19:25:40.388017 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=2563
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240217 19:25:41.081441 56480 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
E20240217 19:25:41.388010 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=5619
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 237.828 us                | 43.335 ms                 |
| ProcessBack:Shuffle       | 249.465 ms                | 291.121 ms                |
| ProcessBack:UpdateCache   | 18.943 ms                 | 36.447 ms                 |
| ProcessBack:UpsertPq      | 67.961 us                 | 185.258 us                |
| ProcessOneStep            | 268.282 ms                | 1.196 s                   |
| BlockToStepN              | 193.515 us                | 6.968 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240217 19:25:42.364990 56480 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240217 19:25:42.388008 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=4334
E20240217 19:25:42.507294 54841 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=124, sample_step_cpp_seen_[rank]=123
W20240217 19:25:43.384259 56480 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240217 19:25:43.388005 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.553 us                | 546.867 us                |
| GenInput                  | 865.578 us                | 4.447 ms                  |
| forward: NN               | 102.031 us                | 554.196 us                |
| Forward                   | 391.620 us                | 5.894 ms                  |
| Backward                  | 1.030 ms                  | 7.670 ms                  |
| Optimize                  | 136.422 us                | 579.908 us                |
| BarrierTimeBeforeRank0    | 411.913 us                | 1.853 ms                  |
| AfterBackward             | 268.586 ms                | 1.196 s                   |
| BlockToStepN              | 301.123 us                | 7.053 ms                  |
| OneStep                   | 272.284 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
E20240217 19:25:44.388532 56499 parallel_pq_v2.h:79] insert failed, size(hashtable)=11457
W20240217 19:25:44.391367 56480 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
E20240217 19:25:45.388043 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=2399
W20240217 19:25:45.436264 56480 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
E20240217 19:25:46.388056 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
W20240217 19:25:46.447185 56480 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 190.160 us                | 43.416 ms                 |
| ProcessBack:Shuffle       | 249.465 ms                | 291.121 ms                |
| ProcessBack:UpdateCache   | 18.480 ms                 | 36.447 ms                 |
| ProcessBack:UpsertPq      | 68.514 us                 | 185.258 us                |
| ProcessOneStep            | 268.542 ms                | 1.196 s                   |
| BlockToStepN              | 231.925 us                | 7.775 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
E20240217 19:25:47.388033 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=5447
W20240217 19:25:47.465157 56480 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240217 19:25:48.388016 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=3974
W20240217 19:25:48.498458 56480 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.092 us                | 546.867 us                |
| GenInput                  | 870.676 us                | 4.447 ms                  |
| forward: NN               | 102.031 us                | 554.196 us                |
| Forward                   | 392.447 us                | 6.290 ms                  |
| Backward                  | 1.020 ms                  | 7.670 ms                  |
| Optimize                  | 133.416 us                | 990.247 us                |
| BarrierTimeBeforeRank0    | 411.913 us                | 1.853 ms                  |
| AfterBackward             | 268.114 ms                | 1.196 s                   |
| BlockToStepN              | 332.682 us                | 7.880 ms                  |
| OneStep                   | 271.841 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
E20240217 19:25:49.388015 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=822
W20240217 19:25:49.513895 56480 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
E20240217 19:25:50.388031 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240217 19:25:50.783143 56480 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
E20240217 19:25:51.396158 56510 parallel_pq_v2.h:79] insert failed, size(hashtable)=1723
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 234.367 us                | 43.159 ms                 |
| ProcessBack:Shuffle       | 249.465 ms                | 285.224 ms                |
| ProcessBack:UpdateCache   | 18.480 ms                 | 28.877 ms                 |
| ProcessBack:UpsertPq      | 67.961 us                 | 161.616 us                |
| ProcessOneStep            | 268.282 ms                | 1.166 s                   |
| BlockToStepN              | 264.662 us                | 6.968 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240217 19:25:51.925715 56480 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
E20240217 19:25:52.396036 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1234
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
W20240217 19:25:53.225606 56480 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
E20240217 19:25:53.400139 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=809
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 129.083 us                | 487.889 us                |
| GenInput                  | 884.440 us                | 4.010 ms                  |
| forward: NN               | 102.067 us                | 393.713 us                |
| Forward                   | 390.584 us                | 5.894 ms                  |
| Backward                  | 1.021 ms                  | 3.396 ms                  |
| Optimize                  | 133.416 us                | 579.908 us                |
| BarrierTimeBeforeRank0    | 413.469 us                | 1.853 ms                  |
| AfterBackward             | 268.336 ms                | 1.166 s                   |
| BlockToStepN              | 367.926 us                | 7.053 ms                  |
| OneStep                   | 272.001 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
W20240217 19:25:54.303500 56480 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240217 19:25:54.345993 54841 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=166, sample_step_cpp_seen_[rank]=165
E20240217 19:25:54.400005 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240217 19:25:55.313452 56480 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
E20240217 19:25:55.400015 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
W20240217 19:25:56.393844 56480 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240217 19:25:56.400002 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=417
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 180.896 us                | 31.475 ms                 |
| ProcessBack:Shuffle       | 250.328 ms                | 285.224 ms                |
| ProcessBack:UpdateCache   | 18.403 ms                 | 29.918 ms                 |
| ProcessBack:UpsertPq      | 67.520 us                 | 161.616 us                |
| ProcessOneStep            | 268.944 ms                | 1.196 s                   |
| BlockToStepN              | 276.100 us                | 6.968 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
E20240217 19:25:57.400022 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240217 19:25:57.521164 56480 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
E20240217 19:25:58.400012 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1606
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
W20240217 19:25:58.586596 56480 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.895 us                | 487.889 us                |
| GenInput                  | 866.672 us                | 4.010 ms                  |
| forward: NN               | 101.948 us                | 393.713 us                |
| Forward                   | 389.197 us                | 5.894 ms                  |
| Backward                  | 1.031 ms                  | 3.396 ms                  |
| Optimize                  | 133.718 us                | 990.247 us                |
| BarrierTimeBeforeRank0    | 413.469 us                | 1.853 ms                  |
| AfterBackward             | 269.004 ms                | 1.196 s                   |
| BlockToStepN              | 390.397 us                | 7.053 ms                  |
| OneStep                   | 272.947 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
E20240217 19:25:59.400022 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1790
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
W20240217 19:25:59.698940 56480 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
E20240217 19:26:00.400046 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=9959
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
W20240217 19:26:00.704432 56480 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
E20240217 19:26:01.400015 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=1555
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240217 19:26:01.863744 56480 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 221.798 us                | 36.584 ms                 |
| ProcessBack:Shuffle       | 249.465 ms                | 285.224 ms                |
| ProcessBack:UpdateCache   | 18.403 ms                 | 29.918 ms                 |
| ProcessBack:UpsertPq      | 67.905 us                 | 161.616 us                |
| ProcessOneStep            | 268.898 ms                | 1.196 s                   |
| BlockToStepN              | 319.004 us                | 6.968 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
E20240217 19:26:02.400015 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=8813
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
W20240217 19:26:02.878672 56480 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
E20240217 19:26:03.400015 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=2107
Step199:rank0, time: 27.410, per_step: 0.271382
Step199:rank7, time: 27.409, per_step: 0.271381
Step199:rank1, time: 27.409, per_step: 0.271379
Step199:rank6, time: 27.409, per_step: 0.271377
Step199:rank5, time: 27.410, per_step: 0.271381
Successfully xmh
Step199:rank3, time: 27.409, per_step: 0.271380
Step199:rank2, time: 27.410, per_step: 0.271382
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
Successfully xmh
Step199:rank4, time: 27.409, per_step: 0.271381
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 126.659 us                | 487.889 us                |
| GenInput                  | 865.349 us                | 4.010 ms                  |
| forward: NN               | 101.676 us                | 437.879 us                |
| Forward                   | 389.197 us                | 5.894 ms                  |
| Backward                  | 1.029 ms                  | 3.396 ms                  |
| Optimize                  | 133.202 us                | 990.247 us                |
| BarrierTimeBeforeRank0    | 410.337 us                | 1.853 ms                  |
| AfterBackward             | 268.932 ms                | 1.196 s                   |
| BlockToStepN              | 437.957 us                | 7.053 ms                  |
| OneStep                   | 272.893 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
Successfully xmh
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 126.659 us                | 487.889 us                |
| GenInput                  | 865.349 us                | 4.010 ms                  |
| forward: NN               | 101.676 us                | 437.879 us                |
| Forward                   | 389.197 us                | 5.894 ms                  |
| Backward                  | 1.029 ms                  | 3.396 ms                  |
| Optimize                  | 133.202 us                | 990.247 us                |
| BarrierTimeBeforeRank0    | 410.337 us                | 1.853 ms                  |
| AfterBackward             | 268.932 ms                | 1.196 s                   |
| BlockToStepN              | 437.957 us                | 7.053 ms                  |
| OneStep                   | 272.893 ms                | 1.202 s                   |
+---------------------------+---------------------------+---------------------------+
W20240217 19:26:04.201310 56480 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
ERROR [54841 PsKvstore.py:89] Delete tensor failed, not found
E20240217 19:26:04.400070 56480 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
