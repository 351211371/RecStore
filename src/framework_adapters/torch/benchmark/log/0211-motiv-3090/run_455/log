WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240217 17:48:53.878762 56865 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240217 17:48:53.888754 56865 IPCTensor.h:369] NewIPCTensor: full_emb [10000000, 32]0x100000002000 1.192 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [56865 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fcbf7481b20>==========
Worker 1 pid=57228
Worker 2 pid=57229
Worker 3 pid=57230
Worker 4 pid=57231
Worker 5 pid=57232
Worker 6 pid=57233
INFO [56865 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [57228 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [57229 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [57230 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [57231 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [57232 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [56865 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57233 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [57234 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [57231 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57230 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57234 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57233 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57229 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57232 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57228 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240217 17:49:00.425580 56865 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:49:00.426298 57234 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:49:00.426301 57230 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:49:00.426311 57232 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:49:00.426326 57228 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:49:00.426549 57229 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:49:00.426558 57233 IPCTensor.h:348] IPCTensor full_emb already exists
E20240217 17:49:00.426563 57231 IPCTensor.h:348] IPCTensor full_emb already exists
W20240217 17:49:06.071800 57231 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [100000, 32]; dev=4; size=12.21 MB
W20240217 17:49:06.071848 57230 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [100000, 32]; dev=3; size=12.21 MB
W20240217 17:49:06.072080 57229 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [100000, 32]; dev=2; size=12.21 MB
W20240217 17:49:06.072098 57232 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [100000, 32]; dev=5; size=12.21 MB
W20240217 17:49:06.073976 57234 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [100000, 32]; dev=7; size=12.21 MB
W20240217 17:49:06.084470 57228 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [100000, 32]; dev=1; size=12.21 MB
W20240217 17:49:06.084494 57233 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [100000, 32]; dev=6; size=12.21 MB
W20240217 17:49:06.085552 56865 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [100000, 32]; dev=0; size=12.21 MB
W20240217 17:49:06.782476 57234 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10004c4ba000 7.629 MB
W20240217 17:49:06.782681 57234 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10004cc5d000 7.629 MB
W20240217 17:49:06.782764 57234 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x10004d400000 122.1 MB
W20240217 17:49:06.782826 57234 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x100054e14000 122.1 MB
W20240217 17:49:06.782860 57234 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 17:49:06.783481 57234 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240217 17:49:06.801908 57232 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10005c82e000 7.629 MB
W20240217 17:49:06.802177 57232 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10005cfd1000 7.629 MB
W20240217 17:49:06.802260 57232 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x10005d774000 122.1 MB
W20240217 17:49:06.802333 57232 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100065188000 122.1 MB
W20240217 17:49:06.802377 57232 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 17:49:06.802939 57232 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240217 17:49:06.809890 57229 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10006cba0000 7.629 MB
W20240217 17:49:06.810032 57229 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10006d343000 7.629 MB
W20240217 17:49:06.810086 57229 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10006dae6000 122.1 MB
W20240217 17:49:06.810142 57229 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x1000754fa000 122.1 MB
W20240217 17:49:06.810171 57229 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 17:49:06.812513 57229 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240217 17:49:06.826787 57230 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10007cf18000 7.629 MB
W20240217 17:49:06.826952 57230 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10007d6bb000 7.629 MB
W20240217 17:49:06.827014 57230 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10007de5e000 122.1 MB
W20240217 17:49:06.827075 57230 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100085872000 122.1 MB
W20240217 17:49:06.827105 57230 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 17:49:06.827199 56865 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10008d286000 7.629 MB
W20240217 17:49:06.827431 56865 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10008da29000 7.629 MB
W20240217 17:49:06.827504 56865 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10008e1cc000 122.1 MB
W20240217 17:49:06.827548 56865 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100095be0000 122.1 MB
W20240217 17:49:06.827600 56865 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 17:49:06.828418 56865 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240217 17:49:06.828440 57230 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240217 17:49:06.866048 57233 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10009d602000 7.629 MB
W20240217 17:49:06.866050 57228 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10009dda5000 7.629 MB
W20240217 17:49:06.866053 57231 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10009e548000 7.629 MB
W20240217 17:49:06.866266 57233 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10009eceb000 7.629 MB
W20240217 17:49:06.866271 57228 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10009f48e000 7.629 MB
W20240217 17:49:06.866286 57231 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10009fc31000 7.629 MB
W20240217 17:49:06.866343 57233 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x1000a03d4000 122.1 MB
W20240217 17:49:06.866361 57231 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x1000a7de8000 122.1 MB
W20240217 17:49:06.866391 57228 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1000af7fc000 122.1 MB
W20240217 17:49:06.866425 57233 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x1000b7210000 122.1 MB
W20240217 17:49:06.866444 57231 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x1000bec24000 122.1 MB
W20240217 17:49:06.866466 57228 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000c6638000 122.1 MB
W20240217 17:49:06.866482 57233 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 17:49:06.866503 57231 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 17:49:06.866528 57228 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240217 17:49:06.867517 57233 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240217 17:49:06.867550 57231 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240217 17:49:06.867571 57228 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
Worker 7 pid=57234
New CachedEmbedding, name=full_emb, shape=(10000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 100000), (100000, 200000), (200000, 300000), (300000, 400000), (400000, 500000), (500000, 600000), (600000, 700000), (700000, 800000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
W20240217 17:49:07.418926 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000ce7fb000 7.629 MB
W20240217 17:49:07.418910 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000ce058000 7.629 MB
W20240217 17:49:07.419041 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000cef9e000 7.629 MB
W20240217 17:49:07.419073 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000cf741000 7.629 MB
W20240217 17:49:07.419095 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000cfee4000 7.629 MB
W20240217 17:49:07.419167 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000d0687000 7.629 MB
W20240217 17:49:07.419263 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000d15cd000 7.629 MB
W20240217 17:49:07.419246 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000d0e2a000 7.629 MB
W20240217 17:49:07.419320 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000d1d70000 7.629 MB
W20240217 17:49:07.419410 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000d2cb6000 7.629 MB
W20240217 17:49:07.419391 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000d2513000 7.629 MB
W20240217 17:49:07.419438 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000d3459000 7.629 MB
W20240217 17:49:07.419579 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000d3bfc000 7.629 MB
W20240217 17:49:07.419631 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000d439f000 7.629 MB
W20240217 17:49:07.419664 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000d4b42000 7.629 MB
W20240217 17:49:07.419705 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000d52e5000 7.629 MB
W20240217 17:49:07.419801 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000d5a88000 7.629 MB
W20240217 17:49:07.419854 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000d622b000 7.629 MB
W20240217 17:49:07.419914 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000d7914000 7.629 MB
W20240217 17:49:07.419910 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000d7171000 7.629 MB
W20240217 17:49:07.419894 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000d69ce000 7.629 MB
W20240217 17:49:07.419945 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000d80b7000 7.629 MB
W20240217 17:49:07.420022 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000d8ffd000 7.629 MB
W20240217 17:49:07.420017 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000d885a000 7.629 MB
W20240217 17:49:07.420038 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000d97a0000 7.629 MB
W20240217 17:49:07.420092 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d9f43000 7.629 MB
W20240217 17:49:07.420156 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000dae89000 7.629 MB
W20240217 17:49:07.420150 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000da6e6000 7.629 MB
W20240217 17:49:07.420176 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000db62c000 7.629 MB
W20240217 17:49:07.420228 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000dbdcf000 7.629 MB
W20240217 17:49:07.420262 57232 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000dcd15000 7.629 MB
W20240217 17:49:07.420256 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000dc572000 7.629 MB
W20240217 17:49:07.420269 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000dd4b8000 7.629 MB
W20240217 17:49:07.420332 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000ddc5b000 7.629 MB
W20240217 17:49:07.420395 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000deba1000 7.629 MB
W20240217 17:49:07.420390 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000de3fe000 7.629 MB
W20240217 17:49:07.420428 57232 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000df344000 80 B 
W20240217 17:49:07.420480 57232 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000df346000 8 B 
W20240217 17:49:07.420502 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000df348000 7.629 MB
W20240217 17:49:07.420532 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000dfaeb000 7.629 MB
W20240217 17:49:07.420562 57232 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000e0a31000 8 B 
W20240217 17:49:07.420562 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000e028e000 7.629 MB
W20240217 17:49:07.420585 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000e0a33000 7.629 MB
W20240217 17:49:07.420668 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000e11d6000 7.629 MB
W20240217 17:49:07.420742 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000e28bf000 7.629 MB
W20240217 17:49:07.420783 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000e3062000 7.629 MB
W20240217 17:49:07.420836 57231 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000e3805000 7.629 MB
W20240217 17:49:07.420730 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000e211c000 7.629 MB
W20240217 17:49:07.420682 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000e1979000 7.629 MB
W20240217 17:49:07.420897 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000e3fa8000 7.629 MB
W20240217 17:49:07.420922 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000e474b000 7.629 MB
W20240217 17:49:07.420945 57231 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000e4eee000 80 B 
W20240217 17:49:07.420985 57231 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000e4ef0000 8 B 
Construct PerfSampler done
W20240217 17:49:07.421059 57231 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000e4ef2000 8 B 
W20240217 17:49:07.421089 57234 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000e4ef4000 7.629 MB
I20240217 17:49:07.421173 57232 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240217 17:49:07.421231 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000e5e3a000 7.629 MB
W20240217 17:49:07.421296 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000e6d80000 7.629 MB
W20240217 17:49:07.421247 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000e65dd000 7.629 MB
W20240217 17:49:07.421332 57234 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000e7523000 80 B 
Construct PerfSampler done
I20240217 17:49:07.421550 57231 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 17:49:07.421223 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000e5697000 7.629 MB
W20240217 17:49:07.421532 57234 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000e7525000 8 B 
W20240217 17:49:07.421612 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000e7cca000 7.629 MB
W20240217 17:49:07.421705 57234 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000e846d000 8 B 
W20240217 17:49:07.421741 57233 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000e846f000 7.629 MB
W20240217 17:49:07.421730 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000e8c12000 7.629 MB
W20240217 17:49:07.421787 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000e93b5000 7.629 MB
W20240217 17:49:07.421981 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000e9b58000 7.629 MB
W20240217 17:49:07.422086 57233 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000ea2fb000 80 B 
W20240217 17:49:07.422164 57233 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000eaaa0000 8 B 
W20240217 17:49:07.422194 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000eaaa2000 7.629 MB
Construct PerfSampler done
W20240217 17:49:07.422250 57233 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000eb245000 8 B 
I20240217 17:49:07.422629 57234 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 17:49:07.422602 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000eb9ea000 7.629 MB
W20240217 17:49:07.422514 57230 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000eb247000 7.629 MB
W20240217 17:49:07.422127 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000ea2fd000 7.629 MB
W20240217 17:49:07.421973 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000e7527000 7.629 MB
W20240217 17:49:07.422820 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000ec18d000 7.629 MB
W20240217 17:49:07.422896 57230 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000ec930000 80 B 
W20240217 17:49:07.422942 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000ec932000 7.629 MB
Construct PerfSampler done
W20240217 17:49:07.423020 57230 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000ed0d5000 8 B 
I20240217 17:49:07.423159 57233 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240217 17:49:07.423175 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000ed0d7000 7.629 MB
W20240217 17:49:07.423192 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000ed87a000 7.629 MB
W20240217 17:49:07.423200 57230 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000ee01d000 8 B 
W20240217 17:49:07.423221 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000ee01f000 7.629 MB
W20240217 17:49:07.423288 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000ee7c2000 7.629 MB
W20240217 17:49:07.423349 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000eef65000 7.629 MB
W20240217 17:49:07.423358 57228 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000ef708000 7.629 MB
W20240217 17:49:07.423377 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000efeab000 7.629 MB
W20240217 17:49:07.423432 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000f064e000 7.629 MB
W20240217 17:49:07.423485 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000f0df1000 7.629 MB
W20240217 17:49:07.423522 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000f1d37000 7.629 MB
W20240217 17:49:07.423511 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000f1594000 7.629 MB
W20240217 17:49:07.423568 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000f24dc000 7.629 MB
W20240217 17:49:07.423550 57228 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000f24da000 80 B 
W20240217 17:49:07.423614 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000f2c7f000 7.629 MB
W20240217 17:49:07.423658 56865 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000f3bc5000 7.629 MB
W20240217 17:49:07.423650 57229 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000f3422000 7.629 MB
W20240217 17:49:07.423707 56865 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000f436a000 80 B 
W20240217 17:49:07.423697 57228 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000f4368000 8 B 
W20240217 17:49:07.423741 56865 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000f436c000 8 B 
W20240217 17:49:07.423769 57229 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000f436e000 80 B 
W20240217 17:49:07.423786 56865 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000f4370000 8 B 
W20240217 17:49:07.423816 57228 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000f4372000 8 B 
W20240217 17:49:07.423861 57229 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000f4374000 8 B 
W20240217 17:49:07.423949 57229 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000f4376000 8 B 
Construct PerfSampler done
Construct PerfSampler done
I20240217 17:49:07.424183 56865 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240217 17:49:07.424321 57230 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
Construct PerfSampler done
Construct PerfSampler done
I20240217 17:49:07.424646 57228 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240217 17:49:07.424696 57229 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240217 17:49:09.196872 56865 recstore.cc:66] init folly done
E20240217 17:49:09.196885 57229 recstore.cc:66] init folly done
E20240217 17:49:09.196911 57233 recstore.cc:66] init folly done
E20240217 17:49:09.196907 57231 recstore.cc:66] init folly done
E20240217 17:49:09.196908 57232 recstore.cc:66] init folly done
E20240217 17:49:09.196931 57228 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240217 17:49:09.196969 57234 recstore.cc:66] init folly done
E20240217 17:49:09.196976 57230 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Before Training
I20240217 17:49:09.251302 57233 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240217 17:49:09.253542 57231 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:49:09.254982 57234 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:49:09.259747 57230 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:49:09.260031 57232 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:49:09.264446 57229 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:49:09.287302 57228 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240217 17:49:09.291214 56865 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 268.277 us                | 268.277 us                |
| GenInput                  | 1.567 ms                  | 1.567 ms                  |
| forward: NN               | 47.950 ms                 | 47.950 ms                 |
| Forward                   | 51.693 ms                 | 51.693 ms                 |
| back: bucket keys         | 62.863 ms                 | 62.863 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 156.547 us                | 268.277 us                |
| GenInput                  | 1.101 ms                  | 1.568 ms                  |
| forward: NN               | 211.499 us                | 47.950 ms                 |
| Forward                   | 721.705 us                | 51.693 ms                 |
| back: bucket keys         | 911.951 us                | 62.863 ms                 |
| back: a2a                 | 14.264 ms                 | 55.497 s                  |
| back: cache               | 321.701 ms                | 334.442 ms                |
| back: aggr dram keys      | 27.856 ms                 | 959.819 ms                |
| back: set dram grad       | 4.184 ms                  | 4.400 ms                  |
| Backward                  | 386.463 ms                | 56.834 s                  |
| Optimize                  | 59.315 ms                 | 351.586 ms                |
| BarrierTimeBeforeRank0    | 84.477 us                 | 178.861 us                |
| BlockToStepN              | 279.167 us                | 565.268 us                |
| OneStep                   | 448.754 ms                | 57.245 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 136.060 us                | 268.277 us                |
| GenInput                  | 966.365 us                | 3.137 ms                  |
| forward: NN               | 123.077 us                | 47.950 ms                 |
| Forward                   | 419.439 us                | 51.693 ms                 |
| back: bucket keys         | 911.951 us                | 62.863 ms                 |
| back: a2a                 | 14.876 ms                 | 55.497 s                  |
| back: cache               | 334.442 ms                | 365.445 ms                |
| back: aggr dram keys      | 21.297 ms                 | 959.819 ms                |
| back: set dram grad       | 4.327 ms                  | 6.368 ms                  |
| Backward                  | 386.377 ms                | 56.834 s                  |
| Optimize                  | 59.315 ms                 | 351.586 ms                |
| BarrierTimeBeforeRank0    | 49.800 us                 | 178.861 us                |
| BlockToStepN              | 210.359 us                | 565.268 us                |
| OneStep                   | 448.754 ms                | 57.245 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 131.265 us                | 268.277 us                |
| GenInput                  | 905.952 us                | 3.137 ms                  |
| forward: NN               | 125.219 us                | 47.950 ms                 |
| Forward                   | 413.048 us                | 51.693 ms                 |
| back: bucket keys         | 677.347 us                | 62.863 ms                 |
| back: a2a                 | 14.560 ms                 | 55.497 s                  |
| back: cache               | 336.540 ms                | 365.445 ms                |
| back: aggr dram keys      | 21.297 ms                 | 959.819 ms                |
| back: set dram grad       | 4.336 ms                  | 6.896 ms                  |
| Backward                  | 382.338 ms                | 56.834 s                  |
| Optimize                  | 59.315 ms                 | 351.586 ms                |
| BarrierTimeBeforeRank0    | 48.291 us                 | 178.861 us                |
| BlockToStepN              | 210.359 us                | 565.268 us                |
| OneStep                   | 441.029 ms                | 57.245 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 129.263 us                | 268.277 us                |
| GenInput                  | 899.002 us                | 3.137 ms                  |
| forward: NN               | 126.478 us                | 47.950 ms                 |
| Forward                   | 413.048 us                | 51.693 ms                 |
| back: bucket keys         | 680.208 us                | 62.863 ms                 |
| back: a2a                 | 14.401 ms                 | 55.497 s                  |
| back: cache               | 332.964 ms                | 365.445 ms                |
| back: aggr dram keys      | 20.369 ms                 | 959.819 ms                |
| back: set dram grad       | 4.369 ms                  | 6.896 ms                  |
| Backward                  | 377.190 ms                | 56.834 s                  |
| Optimize                  | 57.426 ms                 | 351.586 ms                |
| BarrierTimeBeforeRank0    | 48.059 us                 | 178.861 us                |
| BlockToStepN              | 208.127 us                | 1.892 ms                  |
| OneStep                   | 435.084 ms                | 57.245 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.792 us                | 268.277 us                |
| GenInput                  | 905.952 us                | 3.137 ms                  |
| forward: NN               | 126.221 us                | 47.950 ms                 |
| Forward                   | 410.266 us                | 51.693 ms                 |
| back: bucket keys         | 677.347 us                | 62.863 ms                 |
| back: a2a                 | 14.457 ms                 | 55.497 s                  |
| back: cache               | 335.470 ms                | 365.445 ms                |
| back: aggr dram keys      | 20.521 ms                 | 959.819 ms                |
| back: set dram grad       | 4.354 ms                  | 7.274 ms                  |
| Backward                  | 382.111 ms                | 56.834 s                  |
| Optimize                  | 57.426 ms                 | 351.586 ms                |
| BarrierTimeBeforeRank0    | 48.018 us                 | 178.861 us                |
| BlockToStepN              | 208.127 us                | 1.892 ms                  |
| OneStep                   | 436.902 ms                | 57.245 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.792 us                | 208.942 us                |
| GenInput                  | 919.999 us                | 2.132 ms                  |
| forward: NN               | 125.219 us                | 262.229 us                |
| Forward                   | 410.266 us                | 765.128 us                |
| back: bucket keys         | 677.347 us                | 1.947 ms                  |
| back: a2a                 | 14.560 ms                 | 20.874 ms                 |
| back: cache               | 336.084 ms                | 362.713 ms                |
| back: aggr dram keys      | 19.536 ms                 | 55.198 ms                 |
| back: set dram grad       | 4.327 ms                  | 6.896 ms                  |
| Backward                  | 380.167 ms                | 406.938 ms                |
| Optimize                  | 56.604 ms                 | 206.416 ms                |
| BarrierTimeBeforeRank0    | 46.961 us                 | 93.159 us                 |
| BlockToStepN              | 203.065 us                | 565.268 us                |
| OneStep                   | 436.902 ms                | 605.482 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.252 us                | 208.942 us                |
| GenInput                  | 919.999 us                | 2.420 ms                  |
| forward: NN               | 124.844 us                | 262.229 us                |
| Forward                   | 406.315 us                | 765.128 us                |
| back: bucket keys         | 677.347 us                | 1.947 ms                  |
| back: a2a                 | 14.712 ms                 | 20.874 ms                 |
| back: cache               | 336.540 ms                | 365.445 ms                |
| back: aggr dram keys      | 19.536 ms                 | 55.198 ms                 |
| back: set dram grad       | 4.207 ms                  | 7.274 ms                  |
| Backward                  | 380.224 ms                | 420.552 ms                |
| Optimize                  | 57.015 ms                 | 233.660 ms                |
| BarrierTimeBeforeRank0    | 44.108 us                 | 93.159 us                 |
| BlockToStepN              | 203.976 us                | 1.892 ms                  |
| OneStep                   | 438.747 ms                | 655.996 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
Successfully xmh
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.231 us                | 208.942 us                |
| GenInput                  | 919.999 us                | 2.420 ms                  |
| forward: NN               | 124.741 us                | 262.229 us                |
| Forward                   | 402.767 us                | 765.128 us                |
| back: bucket keys         | 677.824 us                | 1.947 ms                  |
| back: a2a                 | 14.712 ms                 | 23.158 ms                 |
| back: cache               | 335.845 ms                | 368.150 ms                |
| back: aggr dram keys      | 19.174 ms                 | 55.198 ms                 |
| back: set dram grad       | 4.198 ms                  | 7.274 ms                  |
| Backward                  | 379.596 ms                | 420.552 ms                |
| Optimize                  | 57.015 ms                 | 233.660 ms                |
| BarrierTimeBeforeRank0    | 43.632 us                 | 93.159 us                 |
| BlockToStepN              | 202.182 us                | 1.892 ms                  |
| OneStep                   | 436.430 ms                | 655.996 ms                |
+---------------------------+---------------------------+---------------------------+
