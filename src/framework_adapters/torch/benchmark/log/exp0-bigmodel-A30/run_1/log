/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
batch size (500) is incompatible to the negative sample size (200). Change the batch size to 600
ARGS:  Namespace(model_name='TransE_l1', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_l1_FB15k_110', no_save_emb=True, max_step=500, batch_size=600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=1000, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=1e-07, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppSync', L=10, kForwardItersPerStep=2, eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
self.part_dict
WARNING: Logging before InitGoogleLogging() is written to STDERR
W20240110 12:30:53.572429 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000
W20240110 12:30:53.572614 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000
W20240110 12:30:53.572647 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000
W20240110 12:30:53.572680 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000
W20240110 12:30:53.572706 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000
W20240110 12:30:53.572731 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000
W20240110 12:30:53.572759 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000
W20240110 12:30:53.572793 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000
W20240110 12:30:53.572824 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000
W20240110 12:30:53.572852 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000
W20240110 12:30:53.572894 1821128 IPCTensor.h:359] NewIPCTensor: step_r0 [10]0x1000007b4000
W20240110 12:30:53.572927 1821128 IPCTensor.h:359] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000
W20240110 12:30:53.572953 1821128 IPCTensor.h:359] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000
W20240110 12:30:53.573055 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000
W20240110 12:30:53.573089 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000
W20240110 12:30:53.573115 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000
W20240110 12:30:53.573140 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000
W20240110 12:30:53.573168 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000
W20240110 12:30:53.573197 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000
W20240110 12:30:53.573241 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000
W20240110 12:30:53.573267 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000
W20240110 12:30:53.573297 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000
W20240110 12:30:53.573325 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000
W20240110 12:30:53.573351 1821128 IPCTensor.h:359] NewIPCTensor: step_r1 [10]0x100000f6c000
W20240110 12:30:53.573374 1821128 IPCTensor.h:359] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000
W20240110 12:30:53.573396 1821128 IPCTensor.h:359] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000
W20240110 12:30:53.573443 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000
W20240110 12:30:53.573478 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000
W20240110 12:30:53.573504 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000
W20240110 12:30:53.573532 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000
W20240110 12:30:53.573560 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000
W20240110 12:30:53.573590 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000
W20240110 12:30:53.573617 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000
W20240110 12:30:53.573642 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000
W20240110 12:30:53.573669 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000
W20240110 12:30:53.573693 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000
W20240110 12:30:53.573719 1821128 IPCTensor.h:359] NewIPCTensor: step_r2 [10]0x100001724000
W20240110 12:30:53.573741 1821128 IPCTensor.h:359] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000
W20240110 12:30:53.573762 1821128 IPCTensor.h:359] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000
W20240110 12:30:53.573803 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000
W20240110 12:30:53.573838 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000
W20240110 12:30:53.573864 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000
W20240110 12:30:53.573889 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000
W20240110 12:30:53.573920 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000
W20240110 12:30:53.573944 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000
W20240110 12:30:53.573972 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000
W20240110 12:30:53.573997 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000
W20240110 12:30:53.574023 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000
W20240110 12:30:53.574050 1821128 IPCTensor.h:359] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000
W20240110 12:30:53.574077 1821128 IPCTensor.h:359] NewIPCTensor: step_r3 [10]0x100001edc000
W20240110 12:30:53.574100 1821128 IPCTensor.h:359] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000
W20240110 12:30:53.574121 1821128 IPCTensor.h:359] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000
W20240110 12:30:53.696523 1821128 IPCTensor.h:359] NewIPCTensor: full_emb [14951, 400]0x100001ee2000
W20240110 12:30:53.696687 1821128 IPCTensor.h:359] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000035b4000
{0: Graph(num_nodes=9480, num_edges=154759,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11158, num_edges=169559,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=11355, num_edges=241153,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10394, num_edges=202691,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9480 N 154759 E
MertisPartition: part 1 has 11158 N 169559 E
MertisPartition: part 2 has 11355 N 241153 E
MertisPartition: part 3 has 10394 N 202691 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([    6,    10,    11,  ...,  2559,  7188, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
After renumbering graph:  {'_ID': tensor([ 1498,  1502,  1503,  ...,  3774,  7933, 13446]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 3])}
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9480, num_edges=154759,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 4.083 seconds
[Rank1] pid = 1821689
[Rank2] pid = 1821754
INFO [1821128 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1821754 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1821689 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [1821818 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [1821128 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1821754 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1821689 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1821818 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240110 12:30:57.101033 1821819 IPCTensor.h:376] Called NewIPCGPUTensor: embedding_cache_0 [374, 400] 0
W20240110 12:30:57.101104 1821819 IPCTensor.h:398] NewIPCGPUTensor: embedding_cache_0 [374, 400] 0
E20240110 12:30:57.101434 1821755 IPCTensor.h:376] Called NewIPCGPUTensor: embedding_cache_2 [374, 400] 2
E20240110 12:30:57.101647 1821820 IPCTensor.h:376] Called NewIPCGPUTensor: embedding_cache_3 [373, 400] 3
E20240110 12:30:57.101655 1821690 IPCTensor.h:376] Called NewIPCGPUTensor: embedding_cache_1 [374, 400] 1
W20240110 12:30:57.101790 1821755 IPCTensor.h:398] NewIPCGPUTensor: embedding_cache_2 [374, 400] 2
W20240110 12:30:57.101895 1821819 IPCTensor.h:359] NewIPCTensor: input_keys_0 [100000]0x1000035c5050
W20240110 12:30:57.102044 1821820 IPCTensor.h:398] NewIPCGPUTensor: embedding_cache_3 [373, 400] 3
W20240110 12:30:57.102048 1821690 IPCTensor.h:398] NewIPCGPUTensor: embedding_cache_1 [374, 400] 1
W20240110 12:30:57.102129 1821819 IPCTensor.h:359] NewIPCTensor: input_keys_neg_0 [100000]0x10000368a050
E20240110 12:30:57.102262 1821819 IPCTensor.h:376] Called NewIPCGPUTensor: backward_grads_0 [100000, 400] 0
W20240110 12:30:57.102304 1821819 IPCTensor.h:398] NewIPCGPUTensor: backward_grads_0 [100000, 400] 0
W20240110 12:30:57.102623 1821755 IPCTensor.h:359] NewIPCTensor: input_keys_2 [100000]0x1000037500a0
W20240110 12:30:57.102862 1821755 IPCTensor.h:359] NewIPCTensor: input_keys_neg_2 [100000]0x1000038150a0
E20240110 12:30:57.102979 1821755 IPCTensor.h:376] Called NewIPCGPUTensor: backward_grads_2 [100000, 400] 2
W20240110 12:30:57.102999 1821755 IPCTensor.h:398] NewIPCGPUTensor: backward_grads_2 [100000, 400] 2
W20240110 12:30:57.103395 1821820 IPCTensor.h:359] NewIPCTensor: input_keys_3 [100000]0x1000038dc140
W20240110 12:30:57.103448 1821690 IPCTensor.h:359] NewIPCTensor: input_keys_1 [100000]0x1000039a1140
W20240110 12:30:57.103677 1821820 IPCTensor.h:359] NewIPCTensor: input_keys_neg_3 [100000]0x100003a67190
W20240110 12:30:57.103694 1821690 IPCTensor.h:359] NewIPCTensor: input_keys_neg_1 [100000]0x100003b2c190
E20240110 12:30:57.103842 1821820 IPCTensor.h:376] Called NewIPCGPUTensor: backward_grads_3 [100000, 400] 3
E20240110 12:30:57.103837 1821819 IPCTensor.h:376] Called NewIPCGPUTensor: backward_grads_neg_0 [100000, 400] 0
E20240110 12:30:57.103852 1821690 IPCTensor.h:376] Called NewIPCGPUTensor: backward_grads_1 [100000, 400] 1
W20240110 12:30:57.103883 1821819 IPCTensor.h:398] NewIPCGPUTensor: backward_grads_neg_0 [100000, 400] 0
W20240110 12:30:57.103883 1821820 IPCTensor.h:398] NewIPCGPUTensor: backward_grads_3 [100000, 400] 3
W20240110 12:30:57.103896 1821690 IPCTensor.h:398] NewIPCGPUTensor: backward_grads_1 [100000, 400] 1
E20240110 12:30:57.103907 1821755 IPCTensor.h:376] Called NewIPCGPUTensor: backward_grads_neg_2 [100000, 400] 2
W20240110 12:30:57.103938 1821755 IPCTensor.h:398] NewIPCGPUTensor: backward_grads_neg_2 [100000, 400] 2
E20240110 12:30:57.106357 1821820 IPCTensor.h:376] Called NewIPCGPUTensor: backward_grads_neg_3 [100000, 400] 3
W20240110 12:30:57.106396 1821820 IPCTensor.h:398] NewIPCGPUTensor: backward_grads_neg_3 [100000, 400] 3
E20240110 12:30:57.106408 1821690 IPCTensor.h:376] Called NewIPCGPUTensor: backward_grads_neg_1 [100000, 400] 1
W20240110 12:30:57.106444 1821690 IPCTensor.h:398] NewIPCGPUTensor: backward_grads_neg_1 [100000, 400] 1
cudaHostRegister 0x100001ee2000
2: KnownLocalCachedEmbedding init done
WARNING [1821754 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank3] pid = 1821818
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 374), (374, 748), (748, 1122), (1122, 1495)]
cudaHostRegister 0x100001ee2000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100001ee2000
1: KnownLocalCachedEmbedding init done
WARNING [1821128 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [1821689 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100001ee2000
3: KnownLocalCachedEmbedding init done
WARNING [1821818 DistTensor.py:56] The tensor name already exists in the kvstore
W20240110 12:30:57.272625 1821819 kg_controller.h:66] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 1,
        "backwardMode": "CppSync",
        "cache_ratio": 0.1
        }
W20240110 12:30:57.272781 1821819 kg_controller.h:162] Init GradProcessingBase done
W20240110 12:30:57.272792 1821819 kg_controller.h:827] after init GradSyncProcessing
I20240110 12:30:57.272795 1821819 kg_controller.h:836] Construct KGCacheController done
I20240110 12:30:57.687798 1821819 kg_controller.h:71] GraphEnv RegTensorsPerProcess
-------Step 0-------
tensor([ 1730, 14902,  2237,  8520, 13385,    38, 13120, 12857,  7838, 11493]) tensor([ 1503,  8545,  7542, 12778,  3070,  1739,  7214, 11676, 10254,  5058])
-------Step 1-------
tensor([ 1730, 14902,  2237,  8520, 13385,    38, 13120, 12857,  7838, 11493]) tensor([ 6334,  5126,  3351, 10095,  1400,  6250,  5440,  8744, 13166, 10665])
-------Step 2-------
tensor([14583,   121,  2634,  5412,  5470,  6096,  3002,   179,  7993,   916]) tensor([11964, 12437, 13614,  4663,  5750,  5388,  1747,  3386,  4663,  2205])
-------Step 3-------
tensor([14583,   121,  2634,  5412,  5470,  6096,  3002,   179,  7993,   916]) tensor([7015,  112, 4811,  785, 5946,  108, 1179, 6914,  525, 8683])
-------Step 4-------
tensor([ 6552, 10700,  5855,   119,  1753,  4325,    71, 14318, 10317,  1606]) tensor([ 9585,  6969,  5566, 10910,  4212,  7371, 11079, 10691,  3536,  9191])
-------Step 5-------
tensor([ 6552, 10700,  5855,   119,  1753,  4325,    71, 14318, 10317,  1606]) tensor([13568,  3787, 11206,  5189, 10759,  6757,  9234, 10364,  8039,  9851])
-------Step 6-------
tensor([ 8505,    66,     0,    17, 11232,   131, 11585,  7049,    21,   368]) tensor([ 7076, 11264, 11988, 10806,  2366,  1617,  5421,  7249,   402,  7823])
-------Step 7-------
tensor([ 8505,    66,     0,    17, 11232,   131, 11585,  7049,    21,   368]) tensor([12554, 12375, 14535,  3417,  2026,  4845, 10467, 13790, 11270,  3714])
-------Step 8-------
tensor([11279,    65,  5388,   256, 12047,  9992,    67,   967,    63,  1225]) tensor([ 4510, 10471,  5956, 10731,  1111, 10719,  3804,  3511,  1177,  4378])
-------Step 9-------
tensor([11279,    65,  5388,   256, 12047,  9992,    67,   967,    63,  1225]) tensor([12313,  3254,  2060,  3858, 10960,  1697,  8831,   167, 14949, 13287])
  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 0/500 [00:00<?, ?it/s]  0%|          | 1/500 [00:02<19:07,  2.30s/it]  0%|          | 1/500 [00:02<19:27,  2.34s/it]  0%|          | 1/500 [00:02<19:09,  2.30s/it]  0%|          | 1/500 [00:02<19:08,  2.30s/it]  1%|          | 5/500 [00:02<03:03,  2.70it/s]  1%|          | 5/500 [00:02<03:06,  2.66it/s]  1%|          | 5/500 [00:02<03:03,  2.70it/s]  1%|          | 5/500 [00:02<03:03,  2.70it/s]  2%|▏         | 8/500 [00:02<01:46,  4.61it/s]  2%|▏         | 8/500 [00:02<01:45,  4.68it/s]  2%|▏         | 8/500 [00:02<01:45,  4.68it/s]  2%|▏         | 8/500 [00:02<01:45,  4.68it/s]  2%|▏         | 11/500 [00:02<01:09,  7.09it/s]  2%|▏         | 11/500 [00:02<01:09,  7.08it/s]  2%|▏         | 11/500 [00:02<01:08,  7.09it/s]  2%|▏         | 11/500 [00:02<01:09,  7.00it/s]  3%|▎         | 14/500 [00:02<00:50,  9.71it/s]  3%|▎         | 14/500 [00:02<00:49,  9.81it/s]  3%|▎         | 14/500 [00:02<00:49,  9.81it/s]  3%|▎         | 14/500 [00:02<00:49,  9.81it/s]  4%|▎         | 18/500 [00:02<00:35, 13.56it/s]  4%|▎         | 18/500 [00:02<00:35, 13.57it/s]  4%|▎         | 18/500 [00:02<00:35, 13.57it/s]  4%|▎         | 18/500 [00:02<00:35, 13.45it/s]  4%|▍         | 21/500 [00:03<00:29, 16.15it/s]  4%|▍         | 21/500 [00:02<00:29, 16.27it/s]  4%|▍         | 21/500 [00:02<00:29, 16.26it/s]  4%|▍         | 21/500 [00:02<00:29, 16.26it/s]  5%|▍         | 24/500 [00:03<00:26, 17.97it/s]  5%|▍         | 24/500 [00:03<00:26, 17.88it/s]  5%|▍         | 24/500 [00:03<00:26, 17.98it/s]  5%|▍         | 24/500 [00:03<00:26, 17.97it/s]  6%|▌         | 28/500 [00:03<00:22, 21.04it/s]  6%|▌         | 28/500 [00:03<00:22, 21.13it/s]  6%|▌         | 28/500 [00:03<00:22, 21.13it/s]  6%|▌         | 28/500 [00:03<00:22, 21.12it/s]  6%|▋         | 32/500 [00:03<00:19, 23.57it/s]  6%|▋         | 32/500 [00:03<00:19, 23.64it/s]  6%|▋         | 32/500 [00:03<00:19, 23.64it/s]  6%|▋         | 32/500 [00:03<00:19, 23.64it/s]  7%|▋         | 36/500 [00:03<00:18, 25.53it/s]  7%|▋         | 36/500 [00:03<00:18, 25.59it/s]  7%|▋         | 36/500 [00:03<00:18, 25.59it/s]  7%|▋         | 36/500 [00:03<00:18, 25.59it/s]  8%|▊         | 39/500 [00:03<00:17, 25.89it/s]  8%|▊         | 39/500 [00:03<00:17, 25.93it/s]  8%|▊         | 39/500 [00:03<00:17, 25.93it/s]  8%|▊         | 39/500 [00:03<00:17, 25.93it/s]  8%|▊         | 42/500 [00:03<00:17, 26.08it/s]  8%|▊         | 42/500 [00:03<00:17, 26.12it/s]  8%|▊         | 42/500 [00:03<00:17, 26.11it/s]  8%|▊         | 42/500 [00:03<00:17, 26.12it/s]  9%|▉         | 46/500 [00:03<00:16, 27.54it/s]  9%|▉         | 46/500 [00:03<00:16, 27.57it/s]  9%|▉         | 46/500 [00:03<00:16, 27.57it/s]  9%|▉         | 46/500 [00:03<00:16, 27.57it/s] 10%|█         | 50/500 [00:04<00:15, 28.51it/s] 10%|█         | 50/500 [00:04<00:15, 28.53it/s] 10%|█         | 50/500 [00:04<00:15, 28.53it/s] 10%|█         | 50/500 [00:03<00:15, 28.53it/s] 11%|█         | 54/500 [00:04<00:15, 29.16it/s] 11%|█         | 54/500 [00:04<00:15, 29.17it/s] 11%|█         | 54/500 [00:04<00:15, 29.17it/s] 11%|█         | 54/500 [00:04<00:15, 29.16it/s] 11%|█▏        | 57/500 [00:04<00:16, 27.55it/s] 11%|█▏        | 57/500 [00:04<00:16, 27.56it/s] 11%|█▏        | 57/500 [00:04<00:16, 27.56it/s] 11%|█▏        | 57/500 [00:04<00:16, 27.56it/s] 12%|█▏        | 61/500 [00:04<00:15, 28.50it/s] 12%|█▏        | 61/500 [00:04<00:15, 28.49it/s] 12%|█▏        | 61/500 [00:04<00:15, 28.50it/s] 12%|█▏        | 61/500 [00:04<00:15, 28.50it/s] 13%|█▎        | 65/500 [00:04<00:14, 29.17it/s] 13%|█▎        | 65/500 [00:04<00:14, 29.17it/s] 13%|█▎        | 65/500 [00:04<00:14, 29.17it/s] 13%|█▎        | 65/500 [00:04<00:14, 29.17it/s] 14%|█▍        | 69/500 [00:04<00:14, 29.47it/s] 14%|█▍        | 69/500 [00:04<00:14, 29.48it/s] 14%|█▍        | 69/500 [00:04<00:14, 29.47it/s] 14%|█▍        | 69/500 [00:04<00:14, 29.47it/s] 14%|█▍        | 72/500 [00:04<00:15, 27.75it/s] 14%|█▍        | 72/500 [00:04<00:15, 27.76it/s] 14%|█▍        | 72/500 [00:04<00:15, 27.76it/s] 14%|█▍        | 72/500 [00:04<00:15, 27.75it/s] 15%|█▌        | 76/500 [00:04<00:14, 28.65it/s] 15%|█▌        | 76/500 [00:04<00:14, 28.66it/s] 15%|█▌        | 76/500 [00:04<00:14, 28.65it/s] 15%|█▌        | 76/500 [00:04<00:14, 28.65it/s] 16%|█▌        | 80/500 [00:05<00:14, 29.21it/s] 16%|█▌        | 80/500 [00:05<00:14, 29.21it/s] 16%|█▌        | 80/500 [00:05<00:14, 29.21it/s] 16%|█▌        | 80/500 [00:05<00:14, 29.21it/s] 17%|█▋        | 84/500 [00:05<00:14, 29.61it/s] 17%|█▋        | 84/500 [00:05<00:14, 29.61it/s] 17%|█▋        | 84/500 [00:05<00:14, 29.61it/s] 17%|█▋        | 84/500 [00:05<00:14, 29.60it/s] 17%|█▋        | 87/500 [00:05<00:14, 28.86it/s] 17%|█▋        | 87/500 [00:05<00:14, 28.87it/s] 17%|█▋        | 87/500 [00:05<00:14, 28.86it/s] 17%|█▋        | 87/500 [00:05<00:14, 28.86it/s] 18%|█▊        | 90/500 [00:05<00:14, 28.31it/s] 18%|█▊        | 90/500 [00:05<00:14, 28.31it/s] 18%|█▊        | 90/500 [00:05<00:14, 28.31it/s] 18%|█▊        | 90/500 [00:05<00:14, 28.31it/s] 19%|█▉        | 94/500 [00:05<00:13, 29.00it/s] 19%|█▉        | 94/500 [00:05<00:13, 29.00it/s] 19%|█▉        | 94/500 [00:05<00:13, 29.01it/s] 19%|█▉        | 94/500 [00:05<00:13, 29.00it/s] 20%|█▉        | 98/500 [00:05<00:13, 29.36it/s] 20%|█▉        | 98/500 [00:05<00:13, 29.36it/s] 20%|█▉        | 98/500 [00:05<00:13, 29.36it/s] 20%|█▉        | 98/500 [00:05<00:13, 29.36it/s]ERROR [1821689 utils.py:53] Timer: Rank1
BlockToStepN: 393.255 us
AfterBackward: 29.867 ms

ERROR [1821128 utils.py:53] Timer: Rank0
BlockToStepN: 497.160 us
AfterBackward: 29.254 ms

ERROR [1821818 utils.py:53] Timer: Rank3
BlockToStepN: 436.730 us
AfterBackward: 30.168 ms

ERROR [1821754 utils.py:53] Timer: Rank2
BlockToStepN: 441.577 us
AfterBackward: 29.137 ms

 20%|██        | 102/500 [00:05<00:13, 29.63it/s] 20%|██        | 102/500 [00:05<00:13, 29.64it/s] 20%|██        | 102/500 [00:05<00:13, 29.64it/s] 20%|██        | 102/500 [00:05<00:13, 29.63it/s] 21%|██        | 105/500 [00:05<00:14, 27.96it/s] 21%|██        | 105/500 [00:05<00:14, 27.96it/s] 21%|██        | 105/500 [00:05<00:14, 27.96it/s] 21%|██        | 105/500 [00:05<00:14, 27.96it/s] 22%|██▏       | 109/500 [00:06<00:13, 28.80it/s] 22%|██▏       | 109/500 [00:06<00:13, 28.80it/s] 22%|██▏       | 109/500 [00:06<00:13, 28.80it/s] 22%|██▏       | 109/500 [00:06<00:13, 28.80it/s] 23%|██▎       | 113/500 [00:06<00:13, 29.32it/s] 23%|██▎       | 113/500 [00:06<00:13, 29.32it/s] 23%|██▎       | 113/500 [00:06<00:13, 29.32it/s] 23%|██▎       | 113/500 [00:06<00:13, 29.32it/s] 23%|██▎       | 117/500 [00:06<00:12, 29.79it/s] 23%|██▎       | 117/500 [00:06<00:12, 29.79it/s] 23%|██▎       | 117/500 [00:06<00:12, 29.79it/s] 23%|██▎       | 117/500 [00:06<00:12, 29.79it/s] 24%|██▍       | 120/500 [00:06<00:13, 27.79it/s] 24%|██▍       | 120/500 [00:06<00:13, 27.79it/s] 24%|██▍       | 120/500 [00:06<00:13, 27.79it/s] 24%|██▍       | 120/500 [00:06<00:13, 27.79it/s] 25%|██▍       | 124/500 [00:06<00:13, 28.57it/s] 25%|██▍       | 124/500 [00:06<00:13, 28.57it/s] 25%|██▍       | 124/500 [00:06<00:13, 28.57it/s] 25%|██▍       | 124/500 [00:06<00:13, 28.56it/s] 26%|██▌       | 128/500 [00:06<00:12, 29.26it/s] 26%|██▌       | 128/500 [00:06<00:12, 29.26it/s] 26%|██▌       | 128/500 [00:06<00:12, 29.26it/s] 26%|██▌       | 128/500 [00:06<00:12, 29.26it/s] 26%|██▋       | 132/500 [00:06<00:12, 30.27it/s] 26%|██▋       | 132/500 [00:06<00:12, 30.27it/s] 26%|██▋       | 132/500 [00:06<00:12, 30.27it/s] 26%|██▋       | 132/500 [00:06<00:12, 30.27it/s] 27%|██▋       | 136/500 [00:07<00:12, 28.89it/s] 27%|██▋       | 136/500 [00:06<00:12, 28.89it/s] 27%|██▋       | 136/500 [00:06<00:12, 28.89it/s] 27%|██▋       | 136/500 [00:06<00:12, 28.89it/s] 28%|██▊       | 140/500 [00:07<00:12, 29.77it/s] 28%|██▊       | 140/500 [00:07<00:12, 29.77it/s] 28%|██▊       | 140/500 [00:07<00:12, 29.77it/s] 28%|██▊       | 140/500 [00:07<00:12, 29.77it/s] 29%|██▉       | 144/500 [00:07<00:11, 30.33it/s] 29%|██▉       | 144/500 [00:07<00:11, 30.33it/s] 29%|██▉       | 144/500 [00:07<00:11, 30.33it/s] 29%|██▉       | 144/500 [00:07<00:11, 30.33it/s] 30%|██▉       | 148/500 [00:07<00:11, 30.87it/s] 30%|██▉       | 148/500 [00:07<00:11, 30.87it/s] 30%|██▉       | 148/500 [00:07<00:11, 30.87it/s] 30%|██▉       | 148/500 [00:07<00:11, 30.87it/s] 30%|███       | 152/500 [00:07<00:11, 29.35it/s] 30%|███       | 152/500 [00:07<00:11, 29.35it/s] 30%|███       | 152/500 [00:07<00:11, 29.35it/s] 30%|███       | 152/500 [00:07<00:11, 29.35it/s] 31%|███       | 156/500 [00:07<00:11, 30.08it/s] 31%|███       | 156/500 [00:07<00:11, 30.08it/s] 31%|███       | 156/500 [00:07<00:11, 30.08it/s] 31%|███       | 156/500 [00:07<00:11, 30.08it/s] 32%|███▏      | 160/500 [00:07<00:11, 30.76it/s] 32%|███▏      | 160/500 [00:07<00:11, 30.76it/s] 32%|███▏      | 160/500 [00:07<00:11, 30.76it/s] 32%|███▏      | 160/500 [00:07<00:11, 30.76it/s] 33%|███▎      | 164/500 [00:07<00:10, 31.18it/s] 33%|███▎      | 164/500 [00:07<00:10, 31.18it/s] 33%|███▎      | 164/500 [00:07<00:10, 31.18it/s] 33%|███▎      | 164/500 [00:07<00:10, 31.18it/s] 34%|███▎      | 168/500 [00:08<00:11, 29.36it/s] 34%|███▎      | 168/500 [00:08<00:11, 29.36it/s] 34%|███▎      | 168/500 [00:08<00:11, 29.36it/s] 34%|███▎      | 168/500 [00:08<00:11, 29.36it/s] 34%|███▍      | 172/500 [00:08<00:10, 30.07it/s] 34%|███▍      | 172/500 [00:08<00:10, 30.08it/s] 34%|███▍      | 172/500 [00:08<00:10, 30.07it/s] 34%|███▍      | 172/500 [00:08<00:10, 30.07it/s] 35%|███▌      | 176/500 [00:08<00:10, 30.51it/s] 35%|███▌      | 176/500 [00:08<00:10, 30.51it/s] 35%|███▌      | 176/500 [00:08<00:10, 30.51it/s] 35%|███▌      | 176/500 [00:08<00:10, 30.51it/s] 36%|███▌      | 180/500 [00:08<00:10, 31.07it/s] 36%|███▌      | 180/500 [00:08<00:10, 31.07it/s] 36%|███▌      | 180/500 [00:08<00:10, 31.07it/s] 36%|███▌      | 180/500 [00:08<00:10, 31.07it/s] 37%|███▋      | 184/500 [00:08<00:10, 29.44it/s] 37%|███▋      | 184/500 [00:08<00:10, 29.44it/s] 37%|███▋      | 184/500 [00:08<00:10, 29.43it/s] 37%|███▋      | 184/500 [00:08<00:10, 29.43it/s] 38%|███▊      | 188/500 [00:08<00:10, 30.16it/s] 38%|███▊      | 188/500 [00:08<00:10, 30.16it/s] 38%|███▊      | 188/500 [00:08<00:10, 30.16it/s] 38%|███▊      | 188/500 [00:08<00:10, 30.16it/s] 38%|███▊      | 192/500 [00:08<00:09, 30.91it/s] 38%|███▊      | 192/500 [00:08<00:09, 30.92it/s] 38%|███▊      | 192/500 [00:08<00:09, 30.91it/s] 38%|███▊      | 192/500 [00:08<00:09, 30.91it/s] 39%|███▉      | 196/500 [00:08<00:09, 31.50it/s] 39%|███▉      | 196/500 [00:08<00:09, 31.50it/s] 39%|███▉      | 196/500 [00:08<00:09, 31.50it/s] 39%|███▉      | 196/500 [00:08<00:09, 31.50it/s]ERROR [1821754 utils.py:53] Timer: Rank2
BlockToStepN: 430.861 us
AfterBackward: 23.121 ms

ERROR [1821128 utils.py:53] Timer: Rank0
BlockToStepN: 486.239 us
AfterBackward: 22.748 ms

ERROR [1821818 utils.py:53] Timer: Rank3
BlockToStepN: 404.258 us
AfterBackward: 23.832 ms

ERROR [1821689 utils.py:53] Timer: Rank1
BlockToStepN: 401.533 us
AfterBackward: 23.759 ms

 40%|████      | 200/500 [00:09<00:10, 29.66it/s] 40%|████      | 200/500 [00:09<00:10, 29.66it/s] 40%|████      | 200/500 [00:09<00:10, 29.66it/s] 40%|████      | 200/500 [00:09<00:10, 29.66it/s] 41%|████      | 204/500 [00:09<00:09, 30.30it/s] 41%|████      | 204/500 [00:09<00:09, 30.31it/s] 41%|████      | 204/500 [00:09<00:09, 30.31it/s] 41%|████      | 204/500 [00:09<00:09, 30.30it/s] 42%|████▏     | 208/500 [00:09<00:09, 30.87it/s] 42%|████▏     | 208/500 [00:09<00:09, 30.87it/s] 42%|████▏     | 208/500 [00:09<00:09, 30.87it/s] 42%|████▏     | 208/500 [00:09<00:09, 30.87it/s] 42%|████▏     | 212/500 [00:09<00:09, 31.36it/s] 42%|████▏     | 212/500 [00:09<00:09, 31.36it/s] 42%|████▏     | 212/500 [00:09<00:09, 31.36it/s] 42%|████▏     | 212/500 [00:09<00:09, 31.36it/s] 43%|████▎     | 216/500 [00:09<00:09, 29.53it/s] 43%|████▎     | 216/500 [00:09<00:09, 29.53it/s] 43%|████▎     | 216/500 [00:09<00:09, 29.53it/s] 43%|████▎     | 216/500 [00:09<00:09, 29.53it/s] 44%|████▍     | 220/500 [00:09<00:09, 30.24it/s] 44%|████▍     | 220/500 [00:09<00:09, 30.24it/s] 44%|████▍     | 220/500 [00:09<00:09, 30.24it/s] 44%|████▍     | 220/500 [00:09<00:09, 30.24it/s] 45%|████▍     | 224/500 [00:09<00:08, 30.85it/s] 45%|████▍     | 224/500 [00:09<00:08, 30.85it/s] 45%|████▍     | 224/500 [00:09<00:08, 30.84it/s] 45%|████▍     | 224/500 [00:09<00:08, 30.85it/s] 46%|████▌     | 228/500 [00:10<00:08, 31.35it/s] 46%|████▌     | 228/500 [00:09<00:08, 31.35it/s] 46%|████▌     | 228/500 [00:09<00:08, 31.35it/s] 46%|████▌     | 228/500 [00:09<00:08, 31.34it/s] 46%|████▋     | 232/500 [00:10<00:09, 29.56it/s] 46%|████▋     | 232/500 [00:10<00:09, 29.57it/s] 46%|████▋     | 232/500 [00:10<00:09, 29.56it/s] 46%|████▋     | 232/500 [00:10<00:09, 29.56it/s] 47%|████▋     | 236/500 [00:10<00:08, 30.29it/s] 47%|████▋     | 236/500 [00:10<00:08, 30.29it/s] 47%|████▋     | 236/500 [00:10<00:08, 30.29it/s] 47%|████▋     | 236/500 [00:10<00:08, 30.29it/s] 48%|████▊     | 240/500 [00:10<00:08, 30.94it/s] 48%|████▊     | 240/500 [00:10<00:08, 30.95it/s] 48%|████▊     | 240/500 [00:10<00:08, 30.94it/s] 48%|████▊     | 240/500 [00:10<00:08, 30.94it/s] 49%|████▉     | 244/500 [00:10<00:08, 31.38it/s] 49%|████▉     | 244/500 [00:10<00:08, 31.38it/s] 49%|████▉     | 244/500 [00:10<00:08, 31.38it/s] 49%|████▉     | 244/500 [00:10<00:08, 31.38it/s] 50%|████▉     | 248/500 [00:10<00:08, 29.68it/s] 50%|████▉     | 248/500 [00:10<00:08, 29.68it/s] 50%|████▉     | 248/500 [00:10<00:08, 29.68it/s] 50%|████▉     | 248/500 [00:10<00:08, 29.68it/s] 50%|█████     | 252/500 [00:10<00:08, 30.33it/s] 50%|█████     | 252/500 [00:10<00:08, 30.33it/s] 50%|█████     | 252/500 [00:10<00:08, 30.33it/s] 50%|█████     | 252/500 [00:10<00:08, 30.33it/s] 51%|█████     | 256/500 [00:10<00:07, 30.80it/s] 51%|█████     | 256/500 [00:10<00:07, 30.81it/s] 51%|█████     | 256/500 [00:10<00:07, 30.81it/s] 51%|█████     | 256/500 [00:10<00:07, 30.80it/s] 52%|█████▏    | 260/500 [00:11<00:07, 30.88it/s] 52%|█████▏    | 260/500 [00:11<00:07, 30.88it/s] 52%|█████▏    | 260/500 [00:11<00:07, 30.88it/s] 52%|█████▏    | 260/500 [00:11<00:07, 30.88it/s] 53%|█████▎    | 264/500 [00:11<00:08, 29.08it/s] 53%|█████▎    | 264/500 [00:11<00:08, 29.08it/s] 53%|█████▎    | 264/500 [00:11<00:08, 29.08it/s] 53%|█████▎    | 264/500 [00:11<00:08, 29.08it/s] 54%|█████▎    | 268/500 [00:11<00:07, 29.61it/s] 54%|█████▎    | 268/500 [00:11<00:07, 29.61it/s] 54%|█████▎    | 268/500 [00:11<00:07, 29.60it/s] 54%|█████▎    | 268/500 [00:11<00:07, 29.60it/s] 54%|█████▍    | 271/500 [00:11<00:07, 29.38it/s] 54%|█████▍    | 271/500 [00:11<00:07, 29.38it/s] 54%|█████▍    | 271/500 [00:11<00:07, 29.38it/s] 54%|█████▍    | 271/500 [00:11<00:07, 29.38it/s] 55%|█████▌    | 275/500 [00:11<00:07, 29.74it/s] 55%|█████▌    | 275/500 [00:11<00:07, 29.74it/s] 55%|█████▌    | 275/500 [00:11<00:07, 29.74it/s] 55%|█████▌    | 275/500 [00:11<00:07, 29.74it/s] 56%|█████▌    | 279/500 [00:11<00:07, 29.19it/s] 56%|█████▌    | 279/500 [00:11<00:07, 29.19it/s] 56%|█████▌    | 279/500 [00:11<00:07, 29.19it/s] 56%|█████▌    | 279/500 [00:11<00:07, 29.19it/s] 56%|█████▋    | 282/500 [00:11<00:07, 28.59it/s] 56%|█████▋    | 282/500 [00:11<00:07, 28.59it/s] 56%|█████▋    | 282/500 [00:11<00:07, 28.59it/s] 56%|█████▋    | 282/500 [00:11<00:07, 28.59it/s] 57%|█████▋    | 286/500 [00:11<00:07, 29.36it/s] 57%|█████▋    | 286/500 [00:11<00:07, 29.36it/s] 57%|█████▋    | 286/500 [00:11<00:07, 29.36it/s] 57%|█████▋    | 286/500 [00:11<00:07, 29.36it/s] 58%|█████▊    | 290/500 [00:12<00:06, 30.25it/s] 58%|█████▊    | 290/500 [00:12<00:06, 30.25it/s] 58%|█████▊    | 290/500 [00:12<00:06, 30.25it/s] 58%|█████▊    | 290/500 [00:12<00:06, 30.25it/s] 59%|█████▉    | 294/500 [00:12<00:06, 30.82it/s] 59%|█████▉    | 294/500 [00:12<00:06, 30.82it/s] 59%|█████▉    | 294/500 [00:12<00:06, 30.82it/s] 59%|█████▉    | 294/500 [00:12<00:06, 30.82it/s] 60%|█████▉    | 298/500 [00:12<00:06, 29.04it/s] 60%|█████▉    | 298/500 [00:12<00:06, 29.04it/s] 60%|█████▉    | 298/500 [00:12<00:06, 29.04it/s] 60%|█████▉    | 298/500 [00:12<00:06, 29.04it/s]ERROR [1821128 utils.py:53] Timer: Rank0
BlockToStepN: 484.521 us
AfterBackward: 20.483 ms

ERROR [1821754 utils.py:53] Timer: Rank2
BlockToStepN: 435.851 us
AfterBackward: 21.074 ms

ERROR [1821689 utils.py:53] Timer: Rank1
BlockToStepN: 414.823 us
AfterBackward: 21.630 ms

ERROR [1821818 utils.py:53] Timer: Rank3
BlockToStepN: 389.813 us
AfterBackward: 21.516 ms

 60%|██████    | 302/500 [00:12<00:06, 29.89it/s] 60%|██████    | 302/500 [00:12<00:06, 29.89it/s] 60%|██████    | 302/500 [00:12<00:06, 29.89it/s] 60%|██████    | 302/500 [00:12<00:06, 29.89it/s] 61%|██████    | 306/500 [00:12<00:06, 30.58it/s] 61%|██████    | 306/500 [00:12<00:06, 30.58it/s] 61%|██████    | 306/500 [00:12<00:06, 30.57it/s] 61%|██████    | 306/500 [00:12<00:06, 30.58it/s] 62%|██████▏   | 310/500 [00:12<00:06, 31.13it/s] 62%|██████▏   | 310/500 [00:12<00:06, 31.14it/s] 62%|██████▏   | 310/500 [00:12<00:06, 31.13it/s] 62%|██████▏   | 310/500 [00:12<00:06, 31.13it/s] 63%|██████▎   | 314/500 [00:12<00:06, 29.16it/s] 63%|██████▎   | 314/500 [00:12<00:06, 29.16it/s] 63%|██████▎   | 314/500 [00:12<00:06, 29.16it/s] 63%|██████▎   | 314/500 [00:12<00:06, 29.16it/s] 64%|██████▎   | 318/500 [00:13<00:06, 29.99it/s] 64%|██████▎   | 318/500 [00:12<00:06, 29.99it/s] 64%|██████▎   | 318/500 [00:12<00:06, 29.99it/s] 64%|██████▎   | 318/500 [00:12<00:06, 29.99it/s] 64%|██████▍   | 322/500 [00:13<00:05, 30.49it/s] 64%|██████▍   | 322/500 [00:13<00:05, 30.49it/s] 64%|██████▍   | 322/500 [00:13<00:05, 30.49it/s] 64%|██████▍   | 322/500 [00:13<00:05, 30.49it/s] 65%|██████▌   | 326/500 [00:13<00:05, 31.06it/s] 65%|██████▌   | 326/500 [00:13<00:05, 31.06it/s] 65%|██████▌   | 326/500 [00:13<00:05, 31.06it/s] 65%|██████▌   | 326/500 [00:13<00:05, 31.06it/s] 66%|██████▌   | 330/500 [00:13<00:05, 29.31it/s] 66%|██████▌   | 330/500 [00:13<00:05, 29.32it/s] 66%|██████▌   | 330/500 [00:13<00:05, 29.31it/s] 66%|██████▌   | 330/500 [00:13<00:05, 29.31it/s] 67%|██████▋   | 334/500 [00:13<00:05, 30.12it/s] 67%|██████▋   | 334/500 [00:13<00:05, 30.12it/s] 67%|██████▋   | 334/500 [00:13<00:05, 30.12it/s] 67%|██████▋   | 334/500 [00:13<00:05, 30.12it/s] 68%|██████▊   | 338/500 [00:13<00:05, 30.72it/s] 68%|██████▊   | 338/500 [00:13<00:05, 30.72it/s] 68%|██████▊   | 338/500 [00:13<00:05, 30.72it/s] 68%|██████▊   | 338/500 [00:13<00:05, 30.72it/s] 68%|██████▊   | 342/500 [00:13<00:05, 31.13it/s] 68%|██████▊   | 342/500 [00:13<00:05, 31.13it/s] 68%|██████▊   | 342/500 [00:13<00:05, 31.13it/s] 68%|██████▊   | 342/500 [00:13<00:05, 31.13it/s] 69%|██████▉   | 346/500 [00:13<00:05, 29.32it/s] 69%|██████▉   | 346/500 [00:13<00:05, 29.32it/s] 69%|██████▉   | 346/500 [00:13<00:05, 29.32it/s] 69%|██████▉   | 346/500 [00:13<00:05, 29.32it/s] 70%|███████   | 350/500 [00:14<00:04, 30.11it/s] 70%|███████   | 350/500 [00:14<00:04, 30.11it/s] 70%|███████   | 350/500 [00:14<00:04, 30.11it/s] 70%|███████   | 350/500 [00:14<00:04, 30.11it/s] 71%|███████   | 354/500 [00:14<00:04, 30.81it/s] 71%|███████   | 354/500 [00:14<00:04, 30.81it/s] 71%|███████   | 354/500 [00:14<00:04, 30.81it/s] 71%|███████   | 354/500 [00:14<00:04, 30.81it/s] 72%|███████▏  | 358/500 [00:14<00:04, 31.16it/s] 72%|███████▏  | 358/500 [00:14<00:04, 31.17it/s] 72%|███████▏  | 358/500 [00:14<00:04, 31.17it/s] 72%|███████▏  | 358/500 [00:14<00:04, 31.16it/s] 72%|███████▏  | 362/500 [00:14<00:04, 29.42it/s] 72%|███████▏  | 362/500 [00:14<00:04, 29.42it/s] 72%|███████▏  | 362/500 [00:14<00:04, 29.42it/s] 72%|███████▏  | 362/500 [00:14<00:04, 29.42it/s] 73%|███████▎  | 366/500 [00:14<00:04, 30.19it/s] 73%|███████▎  | 366/500 [00:14<00:04, 30.20it/s] 73%|███████▎  | 366/500 [00:14<00:04, 30.19it/s] 73%|███████▎  | 366/500 [00:14<00:04, 30.19it/s] 74%|███████▍  | 370/500 [00:14<00:04, 30.86it/s] 74%|███████▍  | 370/500 [00:14<00:04, 30.86it/s] 74%|███████▍  | 370/500 [00:14<00:04, 30.85it/s] 74%|███████▍  | 370/500 [00:14<00:04, 30.86it/s] 75%|███████▍  | 374/500 [00:14<00:04, 31.33it/s] 75%|███████▍  | 374/500 [00:14<00:04, 31.33it/s] 75%|███████▍  | 374/500 [00:14<00:04, 31.33it/s] 75%|███████▍  | 374/500 [00:14<00:04, 31.33it/s] 76%|███████▌  | 378/500 [00:15<00:04, 29.46it/s] 76%|███████▌  | 378/500 [00:14<00:04, 29.46it/s] 76%|███████▌  | 378/500 [00:14<00:04, 29.46it/s] 76%|███████▌  | 378/500 [00:14<00:04, 29.46it/s] 76%|███████▋  | 382/500 [00:15<00:03, 30.26it/s] 76%|███████▋  | 382/500 [00:15<00:03, 30.26it/s] 76%|███████▋  | 382/500 [00:15<00:03, 30.26it/s] 76%|███████▋  | 382/500 [00:15<00:03, 30.26it/s] 77%|███████▋  | 386/500 [00:15<00:03, 30.91it/s] 77%|███████▋  | 386/500 [00:15<00:03, 30.91it/s] 77%|███████▋  | 386/500 [00:15<00:03, 30.91it/s] 77%|███████▋  | 386/500 [00:15<00:03, 30.91it/s] 78%|███████▊  | 390/500 [00:15<00:03, 31.39it/s] 78%|███████▊  | 390/500 [00:15<00:03, 31.39it/s] 78%|███████▊  | 390/500 [00:15<00:03, 31.38it/s] 78%|███████▊  | 390/500 [00:15<00:03, 31.38it/s] 79%|███████▉  | 394/500 [00:15<00:03, 29.51it/s] 79%|███████▉  | 394/500 [00:15<00:03, 29.51it/s] 79%|███████▉  | 394/500 [00:15<00:03, 29.51it/s] 79%|███████▉  | 394/500 [00:15<00:03, 29.51it/s] 80%|███████▉  | 398/500 [00:15<00:03, 30.26it/s] 80%|███████▉  | 398/500 [00:15<00:03, 30.26it/s] 80%|███████▉  | 398/500 [00:15<00:03, 30.26it/s] 80%|███████▉  | 398/500 [00:15<00:03, 30.26it/s]ERROR [1821128 utils.py:53] Timer: Rank0
BlockToStepN: 493.624 us
AfterBackward: 19.278 ms

ERROR [1821818 utils.py:53] Timer: Rank3
BlockToStepN: 387.933 us
AfterBackward: 20.322 ms

ERROR [1821689 utils.py:53] Timer: Rank1
BlockToStepN: 417.572 us
AfterBackward: 20.473 ms

ERROR [1821754 utils.py:53] Timer: Rank2
BlockToStepN: 443.003 us
AfterBackward: 19.917 ms

 80%|████████  | 402/500 [00:15<00:03, 30.90it/s] 80%|████████  | 402/500 [00:15<00:03, 30.91it/s] 80%|████████  | 402/500 [00:15<00:03, 30.90it/s] 80%|████████  | 402/500 [00:15<00:03, 30.90it/s] 81%|████████  | 406/500 [00:15<00:02, 31.35it/s] 81%|████████  | 406/500 [00:15<00:02, 31.35it/s] 81%|████████  | 406/500 [00:15<00:02, 31.35it/s] 81%|████████  | 406/500 [00:15<00:02, 31.35it/s] 82%|████████▏ | 410/500 [00:16<00:03, 29.22it/s] 82%|████████▏ | 410/500 [00:16<00:03, 29.22it/s] 82%|████████▏ | 410/500 [00:16<00:03, 29.22it/s] 82%|████████▏ | 410/500 [00:16<00:03, 29.22it/s] 83%|████████▎ | 414/500 [00:16<00:02, 30.05it/s] 83%|████████▎ | 414/500 [00:16<00:02, 30.06it/s] 83%|████████▎ | 414/500 [00:16<00:02, 30.05it/s] 83%|████████▎ | 414/500 [00:16<00:02, 30.05it/s] 84%|████████▎ | 418/500 [00:16<00:02, 30.77it/s] 84%|████████▎ | 418/500 [00:16<00:02, 30.77it/s] 84%|████████▎ | 418/500 [00:16<00:02, 30.77it/s] 84%|████████▎ | 418/500 [00:16<00:02, 30.77it/s] 84%|████████▍ | 422/500 [00:16<00:02, 31.47it/s] 84%|████████▍ | 422/500 [00:16<00:02, 31.47it/s] 84%|████████▍ | 422/500 [00:16<00:02, 31.47it/s] 84%|████████▍ | 422/500 [00:16<00:02, 31.47it/s] 85%|████████▌ | 426/500 [00:16<00:02, 29.58it/s] 85%|████████▌ | 426/500 [00:16<00:02, 29.58it/s] 85%|████████▌ | 426/500 [00:16<00:02, 29.58it/s] 85%|████████▌ | 426/500 [00:16<00:02, 29.58it/s] 86%|████████▌ | 430/500 [00:16<00:02, 30.32it/s] 86%|████████▌ | 430/500 [00:16<00:02, 30.32it/s] 86%|████████▌ | 430/500 [00:16<00:02, 30.32it/s] 86%|████████▌ | 430/500 [00:16<00:02, 30.32it/s] 87%|████████▋ | 434/500 [00:16<00:02, 31.18it/s] 87%|████████▋ | 434/500 [00:16<00:02, 31.17it/s] 87%|████████▋ | 434/500 [00:16<00:02, 31.17it/s] 87%|████████▋ | 434/500 [00:16<00:02, 31.17it/s] 88%|████████▊ | 438/500 [00:16<00:01, 31.63it/s] 88%|████████▊ | 438/500 [00:16<00:01, 31.63it/s] 88%|████████▊ | 438/500 [00:16<00:01, 31.63it/s] 88%|████████▊ | 438/500 [00:16<00:01, 31.63it/s] 88%|████████▊ | 442/500 [00:17<00:01, 29.69it/s] 88%|████████▊ | 442/500 [00:17<00:01, 29.69it/s] 88%|████████▊ | 442/500 [00:17<00:01, 29.69it/s] 88%|████████▊ | 442/500 [00:17<00:01, 29.69it/s] 89%|████████▉ | 446/500 [00:17<00:01, 30.48it/s] 89%|████████▉ | 446/500 [00:17<00:01, 30.49it/s] 89%|████████▉ | 446/500 [00:17<00:01, 30.48it/s] 89%|████████▉ | 446/500 [00:17<00:01, 30.48it/s] 90%|█████████ | 450/500 [00:17<00:01, 31.11it/s] 90%|█████████ | 450/500 [00:17<00:01, 31.11it/s] 90%|█████████ | 450/500 [00:17<00:01, 31.11it/s] 90%|█████████ | 450/500 [00:17<00:01, 31.12it/s] 91%|█████████ | 454/500 [00:17<00:01, 31.53it/s] 91%|█████████ | 454/500 [00:17<00:01, 31.54it/s] 91%|█████████ | 454/500 [00:17<00:01, 31.53it/s] 91%|█████████ | 454/500 [00:17<00:01, 31.53it/s] 92%|█████████▏| 458/500 [00:17<00:01, 29.60it/s] 92%|█████████▏| 458/500 [00:17<00:01, 29.60it/s] 92%|█████████▏| 458/500 [00:17<00:01, 29.60it/s] 92%|█████████▏| 458/500 [00:17<00:01, 29.60it/s] 92%|█████████▏| 462/500 [00:17<00:01, 30.35it/s] 92%|█████████▏| 462/500 [00:17<00:01, 30.35it/s] 92%|█████████▏| 462/500 [00:17<00:01, 30.35it/s] 92%|█████████▏| 462/500 [00:17<00:01, 30.35it/s] 93%|█████████▎| 466/500 [00:17<00:01, 30.93it/s] 93%|█████████▎| 466/500 [00:17<00:01, 30.93it/s] 93%|█████████▎| 466/500 [00:17<00:01, 30.93it/s] 93%|█████████▎| 466/500 [00:17<00:01, 30.93it/s] 94%|█████████▍| 470/500 [00:17<00:00, 31.41it/s] 94%|█████████▍| 470/500 [00:17<00:00, 31.41it/s] 94%|█████████▍| 470/500 [00:17<00:00, 31.41it/s] 94%|█████████▍| 470/500 [00:17<00:00, 31.40it/s] 95%|█████████▍| 474/500 [00:18<00:00, 29.54it/s] 95%|█████████▍| 474/500 [00:18<00:00, 29.55it/s] 95%|█████████▍| 474/500 [00:18<00:00, 29.54it/s] 95%|█████████▍| 474/500 [00:18<00:00, 29.54it/s] 96%|█████████▌| 478/500 [00:18<00:00, 30.30it/s] 96%|█████████▌| 478/500 [00:18<00:00, 30.30it/s] 96%|█████████▌| 478/500 [00:18<00:00, 30.30it/s] 96%|█████████▌| 478/500 [00:18<00:00, 30.30it/s] 96%|█████████▋| 482/500 [00:18<00:00, 30.92it/s] 96%|█████████▋| 482/500 [00:18<00:00, 30.92it/s] 96%|█████████▋| 482/500 [00:18<00:00, 30.92it/s] 96%|█████████▋| 482/500 [00:18<00:00, 30.92it/s] 97%|█████████▋| 486/500 [00:18<00:00, 31.38it/s] 97%|█████████▋| 486/500 [00:18<00:00, 31.38it/s] 97%|█████████▋| 486/500 [00:18<00:00, 31.38it/s] 97%|█████████▋| 486/500 [00:18<00:00, 31.37it/s] 98%|█████████▊| 490/500 [00:18<00:00, 29.56it/s] 98%|█████████▊| 490/500 [00:18<00:00, 29.56it/s] 98%|█████████▊| 490/500 [00:18<00:00, 29.56it/s] 98%|█████████▊| 490/500 [00:18<00:00, 29.55it/s] 99%|█████████▉| 494/500 [00:18<00:00, 30.31it/s] 99%|█████████▉| 494/500 [00:18<00:00, 30.31it/s] 99%|█████████▉| 494/500 [00:18<00:00, 30.31it/s] 99%|█████████▉| 494/500 [00:18<00:00, 30.30it/s]100%|█████████▉| 498/500 [00:18<00:00, 30.68it/s]100%|█████████▉| 498/500 [00:18<00:00, 30.69it/s]100%|█████████▉| 498/500 [00:18<00:00, 30.68it/s]100%|█████████▉| 498/500 [00:18<00:00, 30.68it/s]ERROR [1821128 utils.py:53] Timer: Rank0
BlockToStepN: 494.383 us
AfterBackward: 18.554 ms

ERROR [1821689 utils.py:53] Timer: Rank1
BlockToStepN: 420.769 us
AfterBackward: 19.826 ms

ERROR [1821818 utils.py:53] Timer: Rank3
BlockToStepN: 385.029 us
AfterBackward: 19.625 ms

ERROR [1821754 utils.py:53] Timer: Rank2
BlockToStepN: 443.578 us
AfterBackward: 19.216 ms

100%|██████████| 500/500 [00:18<00:00, 26.33it/s]
Successfully xmh. training takes 18.992947101593018 seconds
100%|██████████| 500/500 [00:18<00:00, 26.39it/s]
100%|██████████| 500/500 [00:18<00:00, 26.38it/s]100%|██████████| 500/500 [00:18<00:00, 26.38it/s]

[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
