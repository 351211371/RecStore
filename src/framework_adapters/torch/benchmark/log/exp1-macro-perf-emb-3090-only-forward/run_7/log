perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fbd0de3fe50>==========
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 3/1000 [00:00<00:33, 29.63it/s]  2%|▏         | 17/1000 [00:00<00:10, 93.50it/s]  4%|▎         | 35/1000 [00:00<00:07, 129.52it/s]  5%|▌         | 52/1000 [00:00<00:06, 144.27it/s]  7%|▋         | 73/1000 [00:00<00:05, 165.80it/s] 10%|▉         | 96/1000 [00:00<00:04, 184.49it/s]Step99:rank0, time: 0.643, per_step: 0.006434
 12%|█▏        | 116/1000 [00:00<00:04, 186.87it/s] 14%|█▎        | 137/1000 [00:00<00:04, 192.25it/s] 16%|█▌        | 159/1000 [00:00<00:04, 198.55it/s] 18%|█▊        | 182/1000 [00:01<00:03, 205.67it/s]Step199:rank0, time: 0.473, per_step: 0.004680
 20%|██        | 205/1000 [00:01<00:03, 212.42it/s] 23%|██▎       | 229/1000 [00:01<00:03, 219.07it/s] 25%|██▌       | 253/1000 [00:01<00:03, 225.04it/s] 28%|██▊       | 278/1000 [00:01<00:03, 230.85it/s]Step299:rank0, time: 0.423, per_step: 0.004189
 30%|███       | 302/1000 [00:01<00:03, 230.63it/s] 33%|███▎      | 326/1000 [00:01<00:02, 231.02it/s] 35%|███▌      | 350/1000 [00:01<00:02, 229.60it/s] 37%|███▋      | 373/1000 [00:01<00:02, 216.32it/s] 40%|███▉      | 398/1000 [00:01<00:02, 223.75it/s]Step399:rank0, time: 0.450, per_step: 0.004455
 42%|████▏     | 422/1000 [00:02<00:02, 226.90it/s] 45%|████▍     | 448/1000 [00:02<00:02, 235.70it/s] 47%|████▋     | 472/1000 [00:02<00:02, 236.72it/s] 50%|████▉     | 498/1000 [00:02<00:02, 241.89it/s]Step499:rank0, time: 0.406, per_step: 0.004019
 52%|█████▏    | 524/1000 [00:02<00:01, 246.74it/s] 55%|█████▌    | 551/1000 [00:02<00:01, 249.95it/s] 58%|█████▊    | 578/1000 [00:02<00:01, 253.12it/s]Step599:rank0, time: 0.386, per_step: 0.003819
 60%|██████    | 605/1000 [00:02<00:01, 255.48it/s] 63%|██████▎   | 632/1000 [00:02<00:01, 257.03it/s] 66%|██████▌   | 659/1000 [00:03<00:01, 258.20it/s] 68%|██████▊   | 685/1000 [00:03<00:01, 255.51it/s]Step699:rank0, time: 0.390, per_step: 0.003858
 71%|███████   | 711/1000 [00:03<00:01, 254.28it/s] 74%|███████▎  | 737/1000 [00:03<00:01, 253.75it/s] 76%|███████▋  | 763/1000 [00:03<00:00, 253.82it/s] 79%|███████▉  | 789/1000 [00:03<00:00, 253.44it/s]Step799:rank0, time: 0.401, per_step: 0.003975
 82%|████████▏ | 815/1000 [00:03<00:00, 248.87it/s] 84%|████████▍ | 840/1000 [00:03<00:00, 248.18it/s] 86%|████████▋ | 865/1000 [00:03<00:00, 241.33it/s] 89%|████████▉ | 890/1000 [00:03<00:00, 233.16it/s]Step899:rank0, time: 0.427, per_step: 0.004227
 92%|█████████▏| 915/1000 [00:04<00:00, 236.05it/s] 94%|█████████▍| 940/1000 [00:04<00:00, 239.43it/s] 96%|█████████▋| 965/1000 [00:04<00:00, 239.70it/s] 99%|█████████▉| 991/1000 [00:04<00:00, 242.54it/s]Step999:rank0, time: 0.413, per_step: 0.004093
100%|██████████| 1000/1000 [00:04<00:00, 226.87it/s]
Worker 0 pid=57876
Successfully xmh
