perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f6e58edce50>==========
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 4/1000 [00:00<00:25, 38.88it/s]  4%|▍         | 38/1000 [00:00<00:04, 212.81it/s]  9%|▉         | 92/1000 [00:00<00:02, 360.67it/s]Step99:rank0, time: 0.336, per_step: 0.003359
 15%|█▍        | 149/1000 [00:00<00:01, 440.52it/s]Step199:rank0, time: 0.176, per_step: 0.001741
 21%|██        | 207/1000 [00:00<00:01, 490.40it/s] 27%|██▋       | 267/1000 [00:00<00:01, 526.91it/s]Step299:rank0, time: 0.167, per_step: 0.001656
 33%|███▎      | 327/1000 [00:00<00:01, 548.61it/s] 39%|███▊      | 387/1000 [00:00<00:01, 562.31it/s]Step399:rank0, time: 0.170, per_step: 0.001685
 44%|████▍     | 445/1000 [00:00<00:00, 565.66it/s]Step499:rank0, time: 0.174, per_step: 0.001722
 50%|█████     | 503/1000 [00:01<00:00, 568.92it/s] 56%|█████▌    | 560/1000 [00:01<00:00, 565.57it/s]Step599:rank0, time: 0.177, per_step: 0.001751
 62%|██████▏   | 618/1000 [00:01<00:00, 568.89it/s] 68%|██████▊   | 676/1000 [00:01<00:00, 569.45it/s]Step699:rank0, time: 0.175, per_step: 0.001728
 74%|███████▎  | 735/1000 [00:01<00:00, 573.39it/s] 79%|███████▉  | 794/1000 [00:01<00:00, 577.32it/s]Step799:rank0, time: 0.170, per_step: 0.001687
 85%|████████▌ | 852/1000 [00:01<00:00, 561.45it/s]Step899:rank0, time: 0.188, per_step: 0.001859
 91%|█████████ | 909/1000 [00:01<00:00, 558.02it/s] 97%|█████████▋| 967/1000 [00:01<00:00, 564.39it/s]Step999:rank0, time: 0.172, per_step: 0.001705
100%|██████████| 1000/1000 [00:01<00:00, 529.96it/s]
Worker 0 pid=23934
Successfully xmh
