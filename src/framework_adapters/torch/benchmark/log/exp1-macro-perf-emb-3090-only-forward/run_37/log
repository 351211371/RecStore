perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f3e30ba7e50>==========
Worker 0 pid=19085
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<03:38,  4.57it/s]  0%|          | 1/1000 [00:00<03:05,  5.37it/s]  3%|▎         | 29/1000 [00:00<00:08, 112.28it/s]  3%|▎         | 29/1000 [00:00<00:07, 123.43it/s]  6%|▋         | 64/1000 [00:00<00:04, 208.44it/s]  6%|▋         | 64/1000 [00:00<00:04, 196.40it/s]Step99:rank1, time: 0.529, per_step: 0.005292
Step99:rank0, time: 0.492, per_step: 0.004923
 10%|█         | 103/1000 [00:00<00:03, 271.54it/s] 10%|█         | 103/1000 [00:00<00:03, 261.15it/s] 14%|█▍        | 144/1000 [00:00<00:02, 308.39it/s] 14%|█▍        | 144/1000 [00:00<00:02, 316.51it/s] 19%|█▉        | 188/1000 [00:00<00:02, 349.89it/s] 19%|█▉        | 188/1000 [00:00<00:02, 356.06it/s]Step199:rank1, time: 0.236, per_step: 0.002333
Step199:rank0, time: 0.236, per_step: 0.002332
 23%|██▎       | 232/1000 [00:00<00:02, 377.86it/s] 23%|██▎       | 232/1000 [00:00<00:02, 382.46it/s] 28%|██▊       | 277/1000 [00:00<00:01, 398.51it/s] 28%|██▊       | 277/1000 [00:00<00:01, 401.81it/s]Step299:rank1, time: 0.226, per_step: 0.002236
Step299:rank0, time: 0.226, per_step: 0.002236
 32%|███▏      | 322/1000 [00:01<00:01, 411.66it/s] 32%|███▏      | 322/1000 [00:00<00:01, 414.02it/s] 37%|███▋      | 367/1000 [00:01<00:01, 422.01it/s] 37%|███▋      | 367/1000 [00:01<00:01, 423.68it/s]Step399:rank1, time: 0.225, per_step: 0.002227
Step399:rank0, time: 0.225, per_step: 0.002227
 41%|████      | 412/1000 [00:01<00:01, 429.94it/s] 41%|████      | 412/1000 [00:01<00:01, 431.12it/s] 46%|████▌     | 456/1000 [00:01<00:01, 433.17it/s] 46%|████▌     | 456/1000 [00:01<00:01, 432.33it/s]Step499:rank1, time: 0.224, per_step: 0.002223
Step499:rank0, time: 0.224, per_step: 0.002223
 50%|█████     | 502/1000 [00:01<00:01, 438.31it/s] 50%|█████     | 502/1000 [00:01<00:01, 438.91it/s] 55%|█████▍    | 547/1000 [00:01<00:01, 440.88it/s] 55%|█████▍    | 547/1000 [00:01<00:01, 440.38it/s] 59%|█████▉    | 592/1000 [00:01<00:00, 438.86it/s] 59%|█████▉    | 592/1000 [00:01<00:00, 439.14it/s]Step599:rank1, time: 0.227, per_step: 0.002244
Step599:rank0, time: 0.227, per_step: 0.002244
 64%|██████▍   | 638/1000 [00:01<00:00, 443.31it/s] 64%|██████▍   | 638/1000 [00:01<00:00, 443.47it/s] 68%|██████▊   | 684/1000 [00:01<00:00, 446.65it/s] 68%|██████▊   | 684/1000 [00:01<00:00, 446.76it/s]Step699:rank1, time: 0.220, per_step: 0.002177
Step699:rank0, time: 0.220, per_step: 0.002177
 73%|███████▎  | 730/1000 [00:01<00:00, 448.58it/s] 73%|███████▎  | 730/1000 [00:01<00:00, 448.68it/s] 78%|███████▊  | 775/1000 [00:02<00:00, 446.19it/s] 78%|███████▊  | 775/1000 [00:02<00:00, 446.03it/s]Step799:rank0, time: 0.223, per_step: 0.002209
Step799:rank1, time: 0.223, per_step: 0.002210
 82%|████████▏ | 821/1000 [00:02<00:00, 449.56it/s] 82%|████████▏ | 821/1000 [00:02<00:00, 449.47it/s] 87%|████████▋ | 866/1000 [00:02<00:00, 408.09it/s] 87%|████████▋ | 866/1000 [00:02<00:00, 408.29it/s]Step899:rank0, time: 0.282, per_step: 0.002794
Step899:rank1, time: 0.282, per_step: 0.002797
 91%|█████████ | 908/1000 [00:02<00:00, 380.99it/s] 91%|█████████ | 908/1000 [00:02<00:00, 380.36it/s] 95%|█████████▍| 947/1000 [00:02<00:00, 372.27it/s] 95%|█████████▍| 947/1000 [00:02<00:00, 371.80it/s] 99%|█████████▊| 986/1000 [00:02<00:00, 375.57it/s] 99%|█████████▊| 986/1000 [00:02<00:00, 375.26it/s]Step999:rank1, time: 0.275, per_step: 0.002723
100%|██████████| 1000/1000 [00:02<00:00, 376.67it/s]Step999:rank0, time: 0.276, per_step: 0.002728
100%|██████████| 1000/1000 [00:02<00:00, 381.37it/s]

Worker 1 pid=19086
Successfully xmh
