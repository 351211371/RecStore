perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f6a37460e50>==========
Worker 0 pid=29993
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<04:06,  4.06it/s]  0%|          | 1/1000 [00:00<03:59,  4.18it/s]  0%|          | 3/1000 [00:00<01:41,  9.86it/s]  0%|          | 4/1000 [00:00<01:14, 13.38it/s]  1%|          | 6/1000 [00:00<00:59, 16.70it/s]  1%|          | 7/1000 [00:00<00:52, 18.98it/s]  1%|          | 10/1000 [00:00<00:45, 21.67it/s]  1%|          | 11/1000 [00:00<00:43, 22.70it/s]  1%|▏         | 13/1000 [00:00<00:42, 23.30it/s]  2%|▏         | 15/1000 [00:00<00:39, 24.96it/s]  2%|▏         | 17/1000 [00:00<00:37, 26.11it/s]  2%|▏         | 19/1000 [00:00<00:37, 26.39it/s]  2%|▏         | 20/1000 [00:00<00:41, 23.75it/s]  2%|▏         | 22/1000 [00:01<00:43, 22.52it/s]  2%|▏         | 23/1000 [00:01<00:45, 21.52it/s]  2%|▎         | 25/1000 [00:01<00:43, 22.60it/s]  3%|▎         | 26/1000 [00:01<00:55, 17.67it/s]  3%|▎         | 28/1000 [00:01<00:54, 17.90it/s]  3%|▎         | 30/1000 [00:01<00:44, 21.76it/s]  3%|▎         | 31/1000 [00:01<00:48, 19.95it/s]  3%|▎         | 33/1000 [00:01<00:41, 23.41it/s]  4%|▎         | 37/1000 [00:01<00:34, 28.21it/s]  4%|▍         | 40/1000 [00:01<00:29, 32.84it/s]  4%|▍         | 42/1000 [00:01<00:30, 31.42it/s]  4%|▍         | 44/1000 [00:01<00:30, 31.29it/s]  5%|▍         | 46/1000 [00:01<00:31, 30.47it/s]  5%|▍         | 48/1000 [00:01<00:29, 32.60it/s]  5%|▌         | 51/1000 [00:02<00:27, 33.92it/s]  5%|▌         | 52/1000 [00:02<00:28, 33.84it/s]  6%|▌         | 56/1000 [00:02<00:26, 35.69it/s]  6%|▌         | 57/1000 [00:02<00:25, 36.73it/s]  6%|▌         | 61/1000 [00:02<00:24, 38.32it/s]  6%|▌         | 62/1000 [00:02<00:23, 39.80it/s]  7%|▋         | 69/1000 [00:02<00:19, 47.26it/s]  7%|▋         | 69/1000 [00:02<00:19, 47.48it/s]  7%|▋         | 74/1000 [00:02<00:20, 44.39it/s]  7%|▋         | 74/1000 [00:02<00:21, 42.35it/s]  8%|▊         | 79/1000 [00:02<00:24, 37.93it/s]  8%|▊         | 79/1000 [00:02<00:24, 37.96it/s]  8%|▊         | 83/1000 [00:02<00:25, 36.12it/s]  8%|▊         | 84/1000 [00:02<00:25, 36.09it/s]  9%|▉         | 89/1000 [00:02<00:22, 40.26it/s]  9%|▉         | 89/1000 [00:02<00:23, 39.11it/s]  9%|▉         | 94/1000 [00:03<00:24, 36.69it/s]  9%|▉         | 94/1000 [00:03<00:24, 36.67it/s]Step99:rank0, time: 3.253, per_step: 0.032529
 10%|█         | 100/1000 [00:03<00:22, 40.86it/s]Step99:rank1, time: 3.230, per_step: 0.032303
 10%|█         | 100/1000 [00:03<00:21, 41.46it/s] 11%|█         | 106/1000 [00:03<00:19, 45.49it/s] 11%|█         | 107/1000 [00:03<00:19, 46.14it/s] 11%|█▏        | 113/1000 [00:03<00:18, 49.03it/s] 11%|█▏        | 114/1000 [00:03<00:18, 48.16it/s] 12%|█▏        | 119/1000 [00:03<00:20, 43.38it/s] 12%|█▏        | 119/1000 [00:03<00:20, 42.10it/s] 12%|█▏        | 124/1000 [00:03<00:24, 35.56it/s] 12%|█▏        | 124/1000 [00:03<00:24, 35.79it/s] 13%|█▎        | 128/1000 [00:03<00:25, 34.33it/s] 13%|█▎        | 128/1000 [00:03<00:25, 34.24it/s] 13%|█▎        | 132/1000 [00:04<00:24, 35.06it/s] 13%|█▎        | 132/1000 [00:04<00:24, 35.27it/s] 14%|█▎        | 137/1000 [00:04<00:22, 38.50it/s] 14%|█▎        | 137/1000 [00:04<00:22, 38.60it/s] 14%|█▍        | 142/1000 [00:04<00:23, 36.27it/s] 14%|█▍        | 142/1000 [00:04<00:23, 36.88it/s] 15%|█▍        | 146/1000 [00:04<00:25, 33.10it/s] 15%|█▍        | 146/1000 [00:04<00:26, 32.36it/s] 15%|█▌        | 150/1000 [00:04<00:32, 26.00it/s] 15%|█▌        | 150/1000 [00:04<00:33, 25.52it/s] 15%|█▌        | 153/1000 [00:04<00:36, 23.50it/s] 15%|█▌        | 153/1000 [00:04<00:35, 23.90it/s] 16%|█▌        | 156/1000 [00:05<00:36, 23.17it/s] 16%|█▌        | 156/1000 [00:05<00:36, 23.29it/s] 16%|█▌        | 161/1000 [00:05<00:30, 27.29it/s] 16%|█▌        | 161/1000 [00:05<00:30, 27.43it/s] 16%|█▋        | 165/1000 [00:05<00:28, 29.06it/s] 16%|█▋        | 165/1000 [00:05<00:29, 28.70it/s] 17%|█▋        | 169/1000 [00:05<00:28, 29.40it/s] 17%|█▋        | 169/1000 [00:05<00:28, 29.29it/s] 17%|█▋        | 173/1000 [00:05<00:26, 31.34it/s] 17%|█▋        | 174/1000 [00:05<00:25, 32.52it/s] 18%|█▊        | 177/1000 [00:05<00:29, 28.30it/s] 18%|█▊        | 178/1000 [00:05<00:28, 28.37it/s] 18%|█▊        | 180/1000 [00:05<00:31, 25.77it/s] 18%|█▊        | 181/1000 [00:05<00:33, 24.30it/s] 18%|█▊        | 183/1000 [00:05<00:30, 26.72it/s] 19%|█▊        | 187/1000 [00:06<00:26, 31.08it/s] 19%|█▉        | 188/1000 [00:06<00:25, 31.59it/s] 19%|█▉        | 191/1000 [00:06<00:26, 30.17it/s] 19%|█▉        | 192/1000 [00:06<00:26, 30.38it/s] 20%|█▉        | 195/1000 [00:06<00:30, 26.71it/s] 20%|█▉        | 196/1000 [00:06<00:30, 25.97it/s] 20%|█▉        | 198/1000 [00:06<00:29, 27.21it/s]Step199:rank1, time: 3.265, per_step: 0.032325
Step199:rank0, time: 3.266, per_step: 0.032336
 20%|██        | 201/1000 [00:06<00:28, 28.54it/s] 20%|██        | 201/1000 [00:06<00:29, 27.15it/s] 20%|██        | 204/1000 [00:06<00:28, 28.07it/s] 20%|██        | 205/1000 [00:06<00:26, 30.12it/s] 21%|██        | 209/1000 [00:06<00:24, 32.44it/s] 21%|██        | 210/1000 [00:06<00:23, 34.05it/s] 21%|██▏       | 214/1000 [00:06<00:21, 36.38it/s] 22%|██▏       | 216/1000 [00:06<00:20, 38.97it/s] 22%|██▏       | 218/1000 [00:07<00:24, 32.35it/s] 22%|██▏       | 220/1000 [00:07<00:24, 32.04it/s] 22%|██▏       | 222/1000 [00:07<00:23, 32.73it/s] 22%|██▏       | 224/1000 [00:07<00:25, 30.08it/s] 23%|██▎       | 226/1000 [00:07<00:25, 30.59it/s] 23%|██▎       | 228/1000 [00:07<00:26, 28.84it/s] 23%|██▎       | 230/1000 [00:07<00:26, 29.27it/s] 23%|██▎       | 232/1000 [00:07<00:27, 28.03it/s] 23%|██▎       | 234/1000 [00:07<00:25, 29.71it/s] 24%|██▍       | 238/1000 [00:07<00:21, 35.13it/s] 24%|██▍       | 240/1000 [00:07<00:21, 35.85it/s] 24%|██▍       | 243/1000 [00:07<00:20, 37.62it/s] 24%|██▍       | 245/1000 [00:07<00:19, 39.30it/s] 25%|██▍       | 249/1000 [00:07<00:18, 39.75it/s] 25%|██▌       | 250/1000 [00:07<00:20, 35.91it/s] 25%|██▌       | 254/1000 [00:08<00:21, 34.91it/s] 25%|██▌       | 254/1000 [00:08<00:22, 33.49it/s] 26%|██▌       | 258/1000 [00:08<00:22, 32.96it/s] 26%|██▌       | 258/1000 [00:08<00:22, 32.31it/s] 26%|██▌       | 262/1000 [00:08<00:23, 32.00it/s] 26%|██▌       | 262/1000 [00:08<00:23, 31.28it/s] 27%|██▋       | 266/1000 [00:08<00:24, 29.62it/s] 27%|██▋       | 266/1000 [00:08<00:25, 28.82it/s] 27%|██▋       | 271/1000 [00:08<00:21, 34.32it/s] 27%|██▋       | 272/1000 [00:08<00:21, 34.10it/s] 28%|██▊       | 275/1000 [00:08<00:20, 35.05it/s] 28%|██▊       | 276/1000 [00:08<00:20, 35.09it/s] 28%|██▊       | 279/1000 [00:08<00:20, 35.14it/s] 28%|██▊       | 280/1000 [00:08<00:19, 36.10it/s] 29%|██▊       | 286/1000 [00:08<00:16, 43.13it/s] 29%|██▊       | 287/1000 [00:08<00:16, 43.94it/s] 29%|██▉       | 291/1000 [00:09<00:17, 41.43it/s] 29%|██▉       | 292/1000 [00:09<00:17, 39.45it/s] 30%|██▉       | 296/1000 [00:09<00:18, 38.18it/s] 30%|██▉       | 297/1000 [00:09<00:19, 36.91it/s]Step299:rank1, time: 2.934, per_step: 0.029051
Step299:rank0, time: 2.945, per_step: 0.029162
 30%|███       | 300/1000 [00:09<00:22, 31.22it/s] 30%|███       | 301/1000 [00:09<00:22, 31.72it/s] 30%|███       | 304/1000 [00:09<00:21, 31.87it/s] 30%|███       | 305/1000 [00:09<00:21, 32.17it/s] 31%|███       | 308/1000 [00:09<00:23, 28.96it/s] 31%|███       | 309/1000 [00:09<00:24, 28.75it/s] 31%|███       | 312/1000 [00:09<00:25, 27.08it/s] 31%|███▏      | 313/1000 [00:09<00:24, 27.73it/s] 32%|███▏      | 315/1000 [00:10<00:25, 26.80it/s] 32%|███▏      | 316/1000 [00:10<00:25, 26.84it/s] 32%|███▏      | 318/1000 [00:10<00:25, 26.61it/s] 32%|███▏      | 319/1000 [00:10<00:26, 25.93it/s] 32%|███▏      | 322/1000 [00:10<00:23, 29.21it/s] 32%|███▏      | 324/1000 [00:10<00:23, 29.04it/s] 33%|███▎      | 326/1000 [00:10<00:21, 30.64it/s] 33%|███▎      | 328/1000 [00:10<00:22, 30.07it/s] 33%|███▎      | 330/1000 [00:10<00:24, 27.89it/s] 33%|███▎      | 332/1000 [00:10<00:22, 29.06it/s] 34%|███▎      | 335/1000 [00:10<00:20, 32.02it/s] 34%|███▎      | 337/1000 [00:10<00:20, 32.38it/s] 34%|███▍      | 339/1000 [00:10<00:20, 31.53it/s] 34%|███▍      | 341/1000 [00:10<00:20, 32.67it/s] 34%|███▍      | 343/1000 [00:10<00:20, 32.42it/s] 34%|███▍      | 345/1000 [00:10<00:21, 30.58it/s] 35%|███▍      | 347/1000 [00:11<00:20, 31.65it/s] 35%|███▍      | 349/1000 [00:11<00:20, 31.37it/s] 35%|███▌      | 351/1000 [00:11<00:21, 30.69it/s] 35%|███▌      | 353/1000 [00:11<00:20, 31.22it/s] 36%|███▌      | 355/1000 [00:11<00:20, 31.56it/s] 36%|███▌      | 358/1000 [00:11<00:18, 35.51it/s] 36%|███▌      | 362/1000 [00:11<00:15, 39.89it/s] 36%|███▋      | 365/1000 [00:11<00:14, 43.13it/s] 37%|███▋      | 369/1000 [00:11<00:13, 45.47it/s] 37%|███▋      | 370/1000 [00:11<00:14, 44.23it/s] 37%|███▋      | 374/1000 [00:11<00:13, 46.00it/s] 38%|███▊      | 375/1000 [00:11<00:14, 43.69it/s] 38%|███▊      | 379/1000 [00:11<00:14, 41.91it/s] 38%|███▊      | 380/1000 [00:11<00:15, 40.64it/s] 38%|███▊      | 384/1000 [00:11<00:15, 38.87it/s] 38%|███▊      | 385/1000 [00:11<00:16, 38.24it/s] 39%|███▉      | 388/1000 [00:12<00:17, 34.82it/s] 39%|███▉      | 389/1000 [00:12<00:17, 35.86it/s] 39%|███▉      | 393/1000 [00:12<00:16, 37.79it/s] 39%|███▉      | 394/1000 [00:12<00:15, 38.68it/s] 40%|███▉      | 397/1000 [00:12<00:17, 34.34it/s] 40%|███▉      | 398/1000 [00:12<00:17, 33.96it/s]Step399:rank0, time: 2.942, per_step: 0.029128
Step399:rank1, time: 2.958, per_step: 0.029282
 40%|████      | 402/1000 [00:12<00:16, 36.72it/s] 40%|████      | 403/1000 [00:12<00:16, 36.78it/s] 41%|████      | 408/1000 [00:12<00:14, 42.24it/s] 41%|████      | 409/1000 [00:12<00:13, 42.33it/s] 41%|████▏     | 413/1000 [00:12<00:19, 29.84it/s] 41%|████▏     | 414/1000 [00:12<00:19, 29.82it/s] 42%|████▏     | 417/1000 [00:12<00:18, 31.80it/s] 42%|████▏     | 418/1000 [00:12<00:18, 31.09it/s] 42%|████▏     | 422/1000 [00:13<00:16, 35.60it/s] 42%|████▏     | 424/1000 [00:13<00:15, 37.38it/s] 43%|████▎     | 428/1000 [00:13<00:14, 39.61it/s] 43%|████▎     | 430/1000 [00:13<00:13, 40.85it/s] 43%|████▎     | 433/1000 [00:13<00:13, 40.90it/s] 44%|████▎     | 435/1000 [00:13<00:13, 40.38it/s] 44%|████▍     | 438/1000 [00:13<00:15, 36.84it/s] 44%|████▍     | 440/1000 [00:13<00:15, 35.86it/s] 44%|████▍     | 442/1000 [00:13<00:16, 34.34it/s] 44%|████▍     | 444/1000 [00:13<00:16, 33.03it/s] 45%|████▍     | 446/1000 [00:13<00:16, 33.43it/s] 45%|████▍     | 449/1000 [00:13<00:14, 36.85it/s] 45%|████▌     | 451/1000 [00:13<00:14, 36.76it/s] 45%|████▌     | 453/1000 [00:13<00:15, 36.29it/s] 46%|████▌     | 455/1000 [00:13<00:14, 37.18it/s] 46%|████▌     | 458/1000 [00:13<00:14, 37.47it/s] 46%|████▌     | 459/1000 [00:14<00:14, 37.14it/s] 46%|████▌     | 462/1000 [00:14<00:15, 33.77it/s] 46%|████▋     | 463/1000 [00:14<00:15, 35.36it/s] 47%|████▋     | 467/1000 [00:14<00:14, 37.01it/s] 47%|████▋     | 467/1000 [00:14<00:14, 35.73it/s] 47%|████▋     | 471/1000 [00:14<00:15, 33.88it/s] 47%|████▋     | 471/1000 [00:14<00:16, 32.85it/s] 48%|████▊     | 475/1000 [00:14<00:15, 33.61it/s] 48%|████▊     | 475/1000 [00:14<00:15, 33.49it/s] 48%|████▊     | 479/1000 [00:14<00:15, 32.83it/s] 48%|████▊     | 479/1000 [00:14<00:16, 32.18it/s] 48%|████▊     | 483/1000 [00:14<00:16, 32.27it/s] 48%|████▊     | 483/1000 [00:14<00:16, 31.67it/s] 49%|████▊     | 487/1000 [00:14<00:16, 31.67it/s] 49%|████▊     | 487/1000 [00:14<00:16, 30.76it/s] 49%|████▉     | 491/1000 [00:15<00:15, 32.08it/s] 49%|████▉     | 491/1000 [00:15<00:16, 31.28it/s] 50%|████▉     | 495/1000 [00:15<00:15, 33.13it/s] 50%|████▉     | 496/1000 [00:15<00:15, 32.58it/s] 50%|████▉     | 499/1000 [00:15<00:15, 33.32it/s]Step499:rank0, time: 2.895, per_step: 0.028661
Step499:rank1, time: 2.894, per_step: 0.028657
 50%|█████     | 500/1000 [00:15<00:14, 33.96it/s] 50%|█████     | 505/1000 [00:15<00:13, 36.01it/s] 50%|█████     | 505/1000 [00:15<00:13, 35.89it/s] 51%|█████     | 509/1000 [00:15<00:14, 33.32it/s] 51%|█████     | 509/1000 [00:15<00:14, 33.56it/s] 52%|█████▏    | 516/1000 [00:15<00:11, 41.54it/s] 52%|█████▏    | 516/1000 [00:15<00:11, 41.15it/s] 52%|█████▏    | 523/1000 [00:15<00:10, 47.30it/s] 52%|█████▏    | 524/1000 [00:15<00:09, 49.20it/s] 53%|█████▎    | 530/1000 [00:15<00:09, 50.04it/s] 53%|█████▎    | 530/1000 [00:15<00:10, 46.81it/s] 54%|█████▎    | 535/1000 [00:16<00:10, 46.23it/s] 54%|█████▎    | 536/1000 [00:16<00:10, 45.65it/s] 54%|█████▍    | 541/1000 [00:16<00:09, 46.67it/s] 54%|█████▍    | 542/1000 [00:16<00:09, 47.20it/s] 55%|█████▍    | 546/1000 [00:16<00:09, 46.32it/s] 55%|█████▍    | 547/1000 [00:16<00:10, 44.90it/s] 55%|█████▌    | 551/1000 [00:16<00:09, 47.22it/s] 55%|█████▌    | 552/1000 [00:16<00:09, 46.05it/s] 56%|█████▌    | 557/1000 [00:16<00:09, 46.69it/s] 56%|█████▌    | 558/1000 [00:16<00:09, 47.49it/s] 56%|█████▌    | 562/1000 [00:16<00:10, 41.95it/s] 56%|█████▋    | 563/1000 [00:16<00:10, 41.29it/s] 57%|█████▋    | 567/1000 [00:16<00:10, 39.70it/s] 57%|█████▋    | 568/1000 [00:16<00:10, 40.44it/s] 57%|█████▋    | 572/1000 [00:16<00:10, 41.98it/s] 57%|█████▋    | 573/1000 [00:16<00:10, 41.56it/s] 58%|█████▊    | 579/1000 [00:17<00:08, 48.19it/s] 58%|█████▊    | 580/1000 [00:17<00:08, 47.82it/s] 58%|█████▊    | 584/1000 [00:17<00:08, 47.67it/s] 59%|█████▊    | 586/1000 [00:17<00:08, 50.28it/s] 59%|█████▉    | 592/1000 [00:17<00:07, 55.87it/s] 59%|█████▉    | 594/1000 [00:17<00:07, 57.34it/s]Step599:rank1, time: 2.030, per_step: 0.020097
Step599:rank0, time: 2.033, per_step: 0.020132
 60%|██████    | 600/1000 [00:17<00:06, 61.97it/s] 60%|██████    | 602/1000 [00:17<00:06, 61.14it/s] 61%|██████    | 607/1000 [00:17<00:06, 62.60it/s] 61%|██████    | 610/1000 [00:17<00:06, 64.70it/s] 61%|██████▏   | 614/1000 [00:17<00:05, 64.39it/s] 62%|██████▏   | 617/1000 [00:17<00:06, 60.39it/s] 62%|██████▏   | 621/1000 [00:17<00:06, 58.12it/s] 62%|██████▏   | 624/1000 [00:17<00:06, 57.09it/s] 63%|██████▎   | 628/1000 [00:17<00:06, 59.81it/s] 63%|██████▎   | 633/1000 [00:17<00:06, 61.14it/s] 64%|██████▎   | 636/1000 [00:17<00:06, 58.09it/s] 64%|██████▍   | 640/1000 [00:17<00:06, 57.67it/s] 64%|██████▍   | 642/1000 [00:18<00:06, 55.98it/s] 65%|██████▍   | 646/1000 [00:18<00:06, 57.21it/s] 65%|██████▌   | 650/1000 [00:18<00:05, 60.76it/s] 65%|██████▌   | 654/1000 [00:18<00:05, 62.56it/s] 66%|██████▌   | 658/1000 [00:18<00:05, 65.05it/s] 66%|██████▌   | 662/1000 [00:18<00:05, 65.18it/s] 67%|██████▋   | 666/1000 [00:18<00:05, 65.50it/s] 67%|██████▋   | 669/1000 [00:18<00:05, 56.99it/s] 67%|██████▋   | 673/1000 [00:18<00:06, 48.71it/s] 68%|██████▊   | 675/1000 [00:18<00:07, 43.90it/s] 68%|██████▊   | 679/1000 [00:18<00:07, 44.67it/s] 68%|██████▊   | 681/1000 [00:18<00:06, 46.91it/s] 68%|██████▊   | 685/1000 [00:18<00:06, 47.39it/s] 69%|██████▊   | 687/1000 [00:18<00:07, 42.48it/s] 69%|██████▉   | 691/1000 [00:19<00:07, 39.51it/s] 69%|██████▉   | 692/1000 [00:19<00:07, 40.94it/s] 70%|██████▉   | 696/1000 [00:19<00:08, 36.59it/s] 70%|██████▉   | 697/1000 [00:19<00:08, 36.64it/s]Step699:rank0, time: 2.043, per_step: 0.020227
Step699:rank1, time: 2.045, per_step: 0.020251
 70%|███████   | 701/1000 [00:19<00:07, 39.13it/s] 70%|███████   | 703/1000 [00:19<00:07, 39.68it/s] 71%|███████   | 706/1000 [00:19<00:07, 37.32it/s] 71%|███████   | 708/1000 [00:19<00:07, 39.89it/s] 71%|███████▏  | 713/1000 [00:19<00:06, 41.85it/s] 71%|███████▏  | 714/1000 [00:19<00:07, 40.65it/s] 72%|███████▏  | 718/1000 [00:19<00:06, 40.52it/s] 72%|███████▏  | 719/1000 [00:19<00:06, 41.48it/s] 72%|███████▏  | 724/1000 [00:19<00:06, 43.18it/s] 72%|███████▏  | 724/1000 [00:19<00:06, 43.24it/s] 73%|███████▎  | 729/1000 [00:20<00:06, 43.18it/s] 73%|███████▎  | 729/1000 [00:20<00:06, 41.76it/s] 74%|███████▎  | 735/1000 [00:20<00:05, 47.00it/s] 74%|███████▎  | 736/1000 [00:20<00:05, 48.78it/s] 74%|███████▍  | 741/1000 [00:20<00:05, 49.11it/s] 74%|███████▍  | 742/1000 [00:20<00:05, 50.06it/s] 75%|███████▍  | 747/1000 [00:20<00:05, 49.74it/s] 75%|███████▍  | 748/1000 [00:20<00:05, 49.00it/s] 75%|███████▌  | 753/1000 [00:20<00:05, 44.62it/s] 75%|███████▌  | 753/1000 [00:20<00:05, 44.13it/s] 76%|███████▌  | 758/1000 [00:20<00:05, 40.34it/s] 76%|███████▌  | 758/1000 [00:20<00:06, 40.11it/s] 76%|███████▋  | 763/1000 [00:20<00:06, 36.08it/s] 76%|███████▋  | 763/1000 [00:20<00:06, 35.87it/s] 77%|███████▋  | 768/1000 [00:20<00:05, 38.94it/s] 77%|███████▋  | 769/1000 [00:21<00:06, 37.58it/s] 77%|███████▋  | 773/1000 [00:21<00:05, 38.47it/s] 78%|███████▊  | 775/1000 [00:21<00:05, 42.25it/s] 78%|███████▊  | 780/1000 [00:21<00:04, 45.43it/s] 78%|███████▊  | 781/1000 [00:21<00:04, 45.40it/s] 78%|███████▊  | 785/1000 [00:21<00:04, 46.02it/s] 79%|███████▊  | 787/1000 [00:21<00:04, 46.55it/s] 79%|███████▉  | 790/1000 [00:21<00:04, 46.42it/s] 79%|███████▉  | 794/1000 [00:21<00:04, 51.41it/s] 80%|███████▉  | 799/1000 [00:21<00:03, 55.61it/s]Step799:rank1, time: 2.172, per_step: 0.021505
Step799:rank0, time: 2.180, per_step: 0.021585
 80%|████████  | 801/1000 [00:21<00:03, 55.96it/s] 80%|████████  | 805/1000 [00:21<00:03, 54.18it/s] 81%|████████  | 807/1000 [00:21<00:03, 52.57it/s] 81%|████████  | 811/1000 [00:21<00:03, 52.11it/s] 81%|████████▏ | 813/1000 [00:21<00:03, 48.87it/s] 82%|████████▏ | 817/1000 [00:21<00:04, 42.84it/s] 82%|████████▏ | 819/1000 [00:22<00:04, 37.55it/s] 82%|████████▏ | 822/1000 [00:22<00:04, 35.64it/s] 82%|████████▏ | 824/1000 [00:22<00:05, 34.58it/s] 83%|████████▎ | 826/1000 [00:22<00:05, 32.02it/s] 83%|████████▎ | 828/1000 [00:22<00:05, 29.63it/s] 83%|████████▎ | 830/1000 [00:22<00:06, 26.23it/s] 83%|████████▎ | 832/1000 [00:22<00:06, 24.44it/s] 83%|████████▎ | 833/1000 [00:22<00:06, 25.10it/s] 84%|████████▎ | 837/1000 [00:22<00:05, 28.06it/s] 84%|████████▎ | 837/1000 [00:22<00:05, 27.45it/s] 84%|████████▍ | 842/1000 [00:22<00:05, 31.32it/s] 84%|████████▍ | 842/1000 [00:22<00:05, 31.06it/s] 85%|████████▌ | 851/1000 [00:23<00:03, 44.82it/s] 85%|████████▌ | 852/1000 [00:23<00:03, 44.63it/s] 86%|████████▌ | 857/1000 [00:23<00:03, 42.06it/s] 86%|████████▌ | 858/1000 [00:23<00:03, 39.80it/s] 86%|████████▌ | 862/1000 [00:23<00:03, 39.46it/s] 86%|████████▋ | 863/1000 [00:23<00:03, 40.24it/s] 87%|████████▋ | 867/1000 [00:23<00:03, 39.45it/s] 87%|████████▋ | 868/1000 [00:23<00:03, 40.09it/s] 87%|████████▋ | 872/1000 [00:23<00:03, 37.59it/s] 87%|████████▋ | 873/1000 [00:23<00:03, 36.80it/s] 88%|████████▊ | 876/1000 [00:23<00:03, 35.19it/s] 88%|████████▊ | 877/1000 [00:23<00:03, 34.64it/s] 88%|████████▊ | 880/1000 [00:23<00:03, 34.39it/s] 88%|████████▊ | 881/1000 [00:23<00:03, 34.46it/s] 88%|████████▊ | 884/1000 [00:23<00:03, 34.98it/s] 88%|████████▊ | 885/1000 [00:24<00:03, 34.58it/s] 89%|████████▉ | 889/1000 [00:24<00:03, 35.84it/s] 89%|████████▉ | 890/1000 [00:24<00:03, 36.12it/s] 89%|████████▉ | 893/1000 [00:24<00:02, 35.69it/s] 89%|████████▉ | 894/1000 [00:24<00:03, 35.17it/s] 90%|████████▉ | 897/1000 [00:24<00:03, 32.75it/s] 90%|████████▉ | 898/1000 [00:24<00:03, 33.94it/s]Step899:rank0, time: 2.940, per_step: 0.029109
Step899:rank1, time: 2.951, per_step: 0.029216
 90%|█████████ | 901/1000 [00:24<00:03, 32.11it/s] 90%|█████████ | 902/1000 [00:24<00:03, 29.91it/s] 90%|█████████ | 905/1000 [00:24<00:03, 30.38it/s] 91%|█████████ | 906/1000 [00:24<00:03, 28.91it/s] 91%|█████████ | 909/1000 [00:24<00:03, 28.62it/s] 91%|█████████ | 909/1000 [00:24<00:03, 28.69it/s] 91%|█████████▏| 913/1000 [00:24<00:02, 30.93it/s] 91%|█████████▏| 913/1000 [00:24<00:02, 30.79it/s] 92%|█████████▏| 922/1000 [00:25<00:01, 43.30it/s] 92%|█████████▏| 922/1000 [00:25<00:01, 40.42it/s] 93%|█████████▎| 927/1000 [00:25<00:02, 34.28it/s] 93%|█████████▎| 927/1000 [00:25<00:02, 34.31it/s] 93%|█████████▎| 933/1000 [00:25<00:01, 39.13it/s] 93%|█████████▎| 933/1000 [00:25<00:01, 39.22it/s] 94%|█████████▍| 938/1000 [00:25<00:01, 41.64it/s] 94%|█████████▍| 939/1000 [00:25<00:01, 41.96it/s] 94%|█████████▍| 944/1000 [00:25<00:01, 44.39it/s] 94%|█████████▍| 945/1000 [00:25<00:01, 45.21it/s] 95%|█████████▍| 949/1000 [00:25<00:01, 43.38it/s] 95%|█████████▌| 950/1000 [00:25<00:01, 42.63it/s] 95%|█████████▌| 954/1000 [00:25<00:01, 39.43it/s] 96%|█████████▌| 955/1000 [00:25<00:01, 37.82it/s] 96%|█████████▌| 959/1000 [00:26<00:01, 35.03it/s] 96%|█████████▌| 959/1000 [00:26<00:01, 34.43it/s] 96%|█████████▋| 963/1000 [00:26<00:01, 34.58it/s] 96%|█████████▋| 963/1000 [00:26<00:01, 34.62it/s] 97%|█████████▋| 967/1000 [00:26<00:00, 34.40it/s] 97%|█████████▋| 967/1000 [00:26<00:00, 33.40it/s] 97%|█████████▋| 972/1000 [00:26<00:00, 35.25it/s] 97%|█████████▋| 972/1000 [00:26<00:00, 35.34it/s] 98%|█████████▊| 976/1000 [00:26<00:00, 32.69it/s] 98%|█████████▊| 976/1000 [00:26<00:00, 32.88it/s] 98%|█████████▊| 981/1000 [00:26<00:00, 35.88it/s] 98%|█████████▊| 981/1000 [00:26<00:00, 35.66it/s] 98%|█████████▊| 985/1000 [00:26<00:00, 36.16it/s] 98%|█████████▊| 985/1000 [00:26<00:00, 35.86it/s] 99%|█████████▉| 990/1000 [00:26<00:00, 38.75it/s] 99%|█████████▉| 990/1000 [00:26<00:00, 38.64it/s]100%|█████████▉| 995/1000 [00:27<00:00, 41.67it/s]100%|█████████▉| 996/1000 [00:27<00:00, 42.11it/s]Step999:rank0, time: 2.683, per_step: 0.026567
100%|██████████| 1000/1000 [00:27<00:00, 39.98it/s]100%|██████████| 1000/1000 [00:27<00:00, 36.80it/s]
Step999:rank1, time: 2.685, per_step: 0.026581
100%|██████████| 1000/1000 [00:27<00:00, 36.83it/s]
Worker 1 pid=29994
Successfully xmh
