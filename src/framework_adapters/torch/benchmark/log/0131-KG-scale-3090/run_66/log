WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240203 10:35:36.998700 59569 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_60', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsyncV2', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [59569 sampler.py:454] Start PreSampling
WARNING [59569 sampler.py:532] Before construct renumbering_dict
WARNING [59569 sampler.py:555] PreSampling done
W20240203 10:53:00.133668 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240203 10:53:00.133862 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240203 10:53:00.133905 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240203 10:53:00.133944 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240203 10:53:00.133975 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240203 10:53:00.134013 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240203 10:53:00.134053 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240203 10:53:00.134104 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240203 10:53:00.134143 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240203 10:53:00.134182 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240203 10:53:00.134222 59569 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240203 10:53:00.134258 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240203 10:53:00.134284 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240203 10:53:00.134438 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240203 10:53:00.134486 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240203 10:53:00.134528 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240203 10:53:00.134572 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240203 10:53:00.134606 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240203 10:53:00.134644 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240203 10:53:00.134676 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240203 10:53:00.134723 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240203 10:53:00.134760 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240203 10:53:00.134791 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240203 10:53:00.134820 59569 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240203 10:53:00.134846 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240203 10:53:00.134872 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240203 10:53:00.134932 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240203 10:53:00.134963 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240203 10:53:00.135001 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240203 10:53:00.135042 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240203 10:53:00.135074 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240203 10:53:00.135105 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240203 10:53:00.135140 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240203 10:53:00.135177 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240203 10:53:00.135214 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240203 10:53:00.135247 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240203 10:53:00.135285 59569 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240203 10:53:00.135309 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240203 10:53:00.135335 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240203 10:53:00.135397 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240203 10:53:00.135439 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240203 10:53:00.135470 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240203 10:53:00.135500 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240203 10:53:00.135533 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240203 10:53:00.135569 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240203 10:53:00.135603 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240203 10:53:00.135639 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240203 10:53:00.135679 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240203 10:53:00.135725 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240203 10:53:00.135761 59569 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240203 10:53:00.135787 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240203 10:53:00.135816 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240203 10:53:00.135879 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240203 10:53:00.135913 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240203 10:53:00.135951 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240203 10:53:00.135982 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240203 10:53:00.136013 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240203 10:53:00.136042 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240203 10:53:00.136106 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240203 10:53:00.136142 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240203 10:53:00.136178 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240203 10:53:00.136214 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240203 10:53:00.136250 59569 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240203 10:53:00.136276 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240203 10:53:00.136303 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240203 10:53:00.136373 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240203 10:53:00.136407 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240203 10:53:00.136440 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240203 10:53:00.136471 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240203 10:53:00.136502 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240203 10:53:00.136534 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240203 10:53:00.136570 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240203 10:53:00.136605 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240203 10:53:00.136636 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240203 10:53:00.136670 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240203 10:53:00.136703 59569 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240203 10:53:00.136730 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240203 10:53:00.136763 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240203 10:53:00.136821 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240203 10:53:00.136864 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240203 10:53:00.136896 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240203 10:53:00.136931 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240203 10:53:00.136969 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240203 10:53:00.137017 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240203 10:53:00.137056 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240203 10:53:00.137096 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240203 10:53:00.137138 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240203 10:53:00.137187 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240203 10:53:00.137220 59569 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240203 10:53:00.137245 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240203 10:53:00.137270 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240203 10:53:00.137326 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240203 10:53:00.137362 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240203 10:53:00.137392 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240203 10:53:00.137428 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240203 10:53:00.137465 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240203 10:53:00.137509 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240203 10:53:00.137545 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240203 10:53:00.137578 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240203 10:53:00.137620 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240203 10:53:00.137651 59569 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240203 10:53:00.137681 59569 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240203 10:53:00.137707 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240203 10:53:00.137737 59569 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240203 10:53:00.613070 59569 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240203 11:01:44.899185 59569 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605408,  8605409,    61809,  ..., 57316539, 62089728,  9190760]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2082.630 seconds
[Rank1] pid = 26573
[Rank2] pid = 26667
[Rank3] pid = 26734
[Rank4] pid = 26803
[Rank5] pid = 26966
[Rank6] pid = 27144
INFO [59569 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [26573 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [26667 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [26966 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [26734 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [27144 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [26803 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [27144 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27328 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [26803 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26667 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [27328 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26966 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26734 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [59569 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26573 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240203 11:10:30.703629 27167 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [8605415, 400]; dev=6; size=12.82 GB
W20240203 11:10:30.706442 27329 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
W20240203 11:10:30.707007 27409 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [8605415, 400]; dev=7; size=12.82 GB
W20240203 11:10:30.707269 26988 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [8605415, 400]; dev=5; size=12.82 GB
W20240203 11:10:30.707304 26804 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [8605415, 400]; dev=4; size=12.82 GB
W20240203 11:10:30.707319 26735 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
W20240203 11:10:30.707365 26574 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240203 11:10:30.707383 26668 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240203 11:10:30.855571 26735 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102049f54000 7.629 MB
W20240203 11:10:30.855562 26668 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1020497b1000 7.629 MB
W20240203 11:10:30.855576 26804 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204a6f7000 7.629 MB
W20240203 11:10:30.855579 27409 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204ae9a000 7.629 MB
W20240203 11:10:30.855585 26574 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204b63d000 7.629 MB
W20240203 11:10:30.855590 26988 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204bde0000 7.629 MB
W20240203 11:10:30.855594 27329 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204c583000 7.629 MB
W20240203 11:10:30.855650 27167 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204cd26000 7.629 MB
W20240203 11:10:30.856155 26574 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10204d4c9000 7.629 MB
W20240203 11:10:30.856179 27167 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204dc6c000 7.629 MB
W20240203 11:10:30.856184 27409 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204e40f000 7.629 MB
W20240203 11:10:30.856189 26988 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10204ebb2000 7.629 MB
W20240203 11:10:30.856194 27329 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10204f355000 7.629 MB
W20240203 11:10:30.856205 26804 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204faf8000 7.629 MB
W20240203 11:10:30.856210 26735 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10205029b000 7.629 MB
W20240203 11:10:30.856228 26668 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102050a3e000 7.629 MB
W20240203 11:10:30.856289 26804 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1020511e1000 1.49 GB
W20240203 11:10:30.856317 26735 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1020b07c4000 1.49 GB
W20240203 11:10:30.856343 26804 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10210fda7000 1.49 GB
W20240203 11:10:30.856361 27329 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10216f38a000 1.49 GB
W20240203 11:10:30.856377 26735 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1021ce96d000 1.49 GB
W20240203 11:10:30.856396 26668 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10222df50000 1.49 GB
W20240203 11:10:30.856402 27409 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10228d533000 1.49 GB
W20240203 11:10:30.856420 26988 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1022ecb16000 1.49 GB
W20240203 11:10:30.856428 27329 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10234c0f9000 1.49 GB
W20240203 11:10:30.856436 26574 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1023ab6dc000 1.49 GB
W20240203 11:10:30.856467 27167 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10240acbf000 1.49 GB
W20240203 11:10:30.856482 26668 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10246a2a2000 1.49 GB
W20240203 11:10:30.856490 26804 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 11:10:30.856495 27409 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1024c9885000 1.49 GB
W20240203 11:10:30.856498 27329 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 11:10:30.856503 26988 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x102528e68000 1.49 GB
W20240203 11:10:30.856509 26574 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10258844b000 1.49 GB
W20240203 11:10:30.856523 26735 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 11:10:30.856559 27167 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240203 11:10:30.856563 27409 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240203 11:10:30.856575 26668 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 11:10:30.856588 26988 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 11:10:30.856595 26574 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 11:10:30.856622 27167 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240203 11:10:30.871771 27329 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 11:10:30.871783 26804 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 11:10:30.871806 26735 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 11:10:30.871853 26574 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 11:10:30.871865 27167 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240203 11:10:30.871930 27409 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240203 11:10:30.871932 26988 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 11:10:30.871932 26668 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [26667 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [26573 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 27328
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [59569 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [26803 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [26966 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [27328 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [26734 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [27144 DistTensor.py:59] The tensor name already exists in the kvstore
I20240203 11:11:23.780747 27167 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240203 11:11:23.780849 27409 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 11:11:23.780905 27329 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 11:11:23.781005 26735 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 11:11:23.781374 26988 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 11:11:23.781433 26574 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 11:11:23.781498 26804 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 11:11:23.781555 26668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240203 11:11:23.783746 27329 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240203 11:11:23.784344 27329 grad_base.h:184] Init GradProcessingBase done
I20240203 11:11:36.525615 27329 grad_async_v2.h:42] Use main thread to update emb.
W20240203 11:11:36.525895 27329 kg_controller.h:78] after init GradAsyncProcessingV2
I20240203 11:11:36.525907 27329 kg_controller.h:84] Construct KGCacheController done
E20240203 11:11:38.312968 26988 recstore.cc:66] init folly done
E20240203 11:11:38.313099 26574 recstore.cc:66] init folly done
E20240203 11:11:38.313114 26735 recstore.cc:66] init folly done
E20240203 11:11:38.313122 27409 recstore.cc:66] init folly done
E20240203 11:11:38.313146 27329 recstore.cc:66] init folly done
E20240203 11:11:38.313141 26804 recstore.cc:66] init folly done
E20240203 11:11:38.313138 27167 recstore.cc:66] init folly done
E20240203 11:11:38.313156 26668 recstore.cc:66] init folly done
I20240203 11:11:38.314431 27329 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240203 11:11:57.337133 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240203 11:11:57.337544 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.007 us                | 254.968 us                |
+---------------------------+---------------------------+---------------------------+
W20240203 11:11:58.359591 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240203 11:11:58.359730 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240203 11:11:59.397971 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240203 11:11:59.398084 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240203 11:12:00.224439 26988 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
E20240203 11:12:00.398016 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240203 11:12:00.796968 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240203 11:12:00.873770 27409 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 11:12:00.979367 26804 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240203 11:12:01.398018 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:12:02.161388 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240203 11:12:02.279798 26668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 11:12:02.317046 26574 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240203 11:12:02.398016 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 132.856 us                | 262.261 us                |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:03.894891 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240203 11:12:03.913077 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240203 11:12:03.958312 26735 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240203 11:12:04.905709 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240203 11:12:04.917227 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240203 11:12:04.949579 27329 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 11:12:05.058396 27167 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240203 11:12:07.702724 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240203 11:12:07.874933 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240203 11:12:08.085004 27329 grad_async_v2.h:257] pq is empty
W20240203 11:12:08.305514 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=3, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 155.004 us                | 1.647 ms                  |
| ProcessBack:Shuffle       | 9.765 ms                  | 368.711 ms                |
| ProcessBack:UpdateCache   | 14.494 ms                 | 701.266 ms                |
| ProcessBack:UpsertPq      | 90.180 ms                 | 161.013 ms                |
| ProcessOneStep            | 160.269 ms                | 1.507 s                   |
| BlockToStepN              | 98.361 us                 | 234.201 us                |
+---------------------------+---------------------------+---------------------------+
E20240203 11:12:08.702013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 38.981 ms                 | 82.277 ms                 |
| Forward                   | 5.571 ms                  | 862.490 ms                |
| Backward                  | 5.017 ms                  | 224.721 ms                |
| Optimize                  | 1.820 ms                  | 4.996 ms                  |
| BarrierTimeBeforeRank0    | 29.222 us                 | 163.206 ms                |
| AfterBackward             | 115.600 ms                | 1.508 s                   |
| BlockToStepN              | 149.724 us                | 995.886 us                |
| OneStep                   | 202.689 ms                | 2.809 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:08.901768 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240203 11:12:09.686961 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240203 11:12:09.702006 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1285
W20240203 11:12:09.950387 32118 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240203 11:12:10.702011 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=90
W20240203 11:12:10.758461 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240203 11:12:11.157796 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240203 11:12:11.220721 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=19, sample_step_cpp_seen_[rank]=18
E20240203 11:12:11.702013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240203 11:12:12.197603 32118 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240203 11:12:12.278447 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=20, pq.top=20
E20240203 11:12:12.702025 32475 parallel_pq_v2.h:79] insert failed, size(hashtable)=4404
W20240203 11:12:13.219470 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 433.684 us                | 4.616 ms                  |
| ProcessBack:Shuffle       | 9.223 ms                  | 368.711 ms                |
| ProcessBack:UpdateCache   | 14.060 ms                 | 701.266 ms                |
| ProcessBack:UpsertPq      | 42.833 ms                 | 161.013 ms                |
| ProcessOneStep            | 102.462 ms                | 1.507 s                   |
| BlockToStepN              | 417.860 us                | 18.009 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:13.373423 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=25, pq.top=25
E20240203 11:12:13.702013 29669 parallel_pq_v2.h:79] insert failed, size(hashtable)=1896
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.385 ms                 | 817.898 ms                |
| Forward                   | 5.126 ms                  | 862.490 ms                |
| Backward                  | 5.017 ms                  | 224.721 ms                |
| Optimize                  | 1.964 ms                  | 4.996 ms                  |
| BarrierTimeBeforeRank0    | 642.199 us                | 163.206 ms                |
| AfterBackward             | 102.505 ms                | 1.508 s                   |
| BlockToStepN              | 652.135 us                | 18.121 ms                 |
| OneStep                   | 152.355 ms                | 2.809 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:14.309784 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
W20240203 11:12:14.424830 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=34, pq.top=34
E20240203 11:12:14.702009 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=145
W20240203 11:12:14.972239 27329 grad_async_v2.h:257] pq is empty
W20240203 11:12:15.373826 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240203 11:12:15.702010 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=91
W20240203 11:12:16.377908 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240203 11:12:16.397959 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=41, pq.top=41
E20240203 11:12:16.714980 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:12:17.504278 32118 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
W20240203 11:12:17.523037 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=49, pq.top=49
E20240203 11:12:17.714011 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=191
E20240203 11:12:18.187062 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=54, sample_step_cpp_seen_[rank]=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 478.975 us                | 11.074 ms                 |
| ProcessBack:Shuffle       | 9.149 ms                  | 334.660 ms                |
| ProcessBack:UpdateCache   | 13.840 ms                 | 696.579 ms                |
| ProcessBack:UpsertPq      | 48.004 ms                 | 138.722 ms                |
| ProcessOneStep            | 108.860 ms                | 1.081 s                   |
| BlockToStepN              | 535.947 us                | 17.595 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:12:18.714012 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240203 11:12:18.718175 32118 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.416 ms                  | 99.303 ms                 |
| Forward                   | 5.094 ms                  | 10.674 ms                 |
| Backward                  | 5.095 ms                  | 6.696 ms                  |
| Optimize                  | 2.247 ms                  | 5.959 ms                  |
| BarrierTimeBeforeRank0    | 2.349 ms                  | 38.689 ms                 |
| AfterBackward             | 109.478 ms                | 1.081 s                   |
| BlockToStepN              | 731.158 us                | 17.687 ms                 |
| OneStep                   | 143.117 ms                | 1.103 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:19.600538 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=57, pq.top=57
E20240203 11:12:19.714008 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=934
W20240203 11:12:19.720235 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240203 11:12:20.714008 29669 parallel_pq_v2.h:79] insert failed, size(hashtable)=14737
W20240203 11:12:20.752920 32118 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
W20240203 11:12:20.767012 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=65, pq.top=65
E20240203 11:12:21.714010 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=451
W20240203 11:12:21.975862 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240203 11:12:22.714013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=149
W20240203 11:12:23.053097 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240203 11:12:23.314774 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 322.618 us                | 3.101 ms                  |
| ProcessBack:Shuffle       | 9.177 ms                  | 334.660 ms                |
| ProcessBack:UpdateCache   | 13.735 ms                 | 696.579 ms                |
| ProcessBack:UpsertPq      | 49.766 ms                 | 141.089 ms                |
| ProcessOneStep            | 112.346 ms                | 1.306 s                   |
| BlockToStepN              | 727.960 us                | 17.595 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:12:23.714010 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=561
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.119 ms                  | 103.961 ms                |
| Forward                   | 5.151 ms                  | 10.674 ms                 |
| Backward                  | 5.178 ms                  | 8.256 ms                  |
| Optimize                  | 2.458 ms                  | 6.444 ms                  |
| BarrierTimeBeforeRank0    | 2.087 ms                  | 111.928 ms                |
| AfterBackward             | 109.530 ms                | 1.306 s                   |
| BlockToStepN              | 831.550 us                | 17.687 ms                 |
| OneStep                   | 143.258 ms                | 1.463 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:24.060925 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
W20240203 11:12:24.445374 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=81, pq.top=81
E20240203 11:12:24.714018 32469 parallel_pq_v2.h:79] insert failed, size(hashtable)=31549
E20240203 11:12:24.908310 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=84, sample_step_cpp_seen_[rank]=83
W20240203 11:12:25.318392 32118 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
E20240203 11:12:25.714013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=3009
W20240203 11:12:25.963268 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240203 11:12:26.350920 32118 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240203 11:12:26.714017 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=131
W20240203 11:12:27.279757 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240203 11:12:27.446545 32118 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240203 11:12:27.714011 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=3407
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 469.353 us                | 3.155 ms                  |
| ProcessBack:Shuffle       | 9.190 ms                  | 24.324 ms                 |
| ProcessBack:UpdateCache   | 13.672 ms                 | 15.510 ms                 |
| ProcessBack:UpsertPq      | 56.707 ms                 | 161.013 ms                |
| ProcessOneStep            | 109.474 ms                | 1.306 s                   |
| BlockToStepN              | 743.588 us                | 17.595 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:28.417289 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240203 11:12:28.570811 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
E20240203 11:12:28.714012 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=38936
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.670 ms                  | 107.209 ms                |
| Forward                   | 5.409 ms                  | 10.674 ms                 |
| Backward                  | 5.212 ms                  | 8.256 ms                  |
| Optimize                  | 2.702 ms                  | 6.815 ms                  |
| BarrierTimeBeforeRank0    | 2.849 ms                  | 111.928 ms                |
| AfterBackward             | 112.389 ms                | 1.306 s                   |
| BlockToStepN              | 995.886 us                | 17.687 ms                 |
| OneStep                   | 144.616 ms                | 1.463 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 27.838, sample: 1.774, forward: 1.429, backward: 0.901, update: 0.292
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 27.944, sample: 1.270, forward: 1.355, backward: 0.872, update: 0.279
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 24.859, sample: 1.522, forward: 1.352, backward: 0.780, update: 0.239
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 23.759, sample: 1.343, forward: 1.392, backward: 0.872, update: 0.269
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 26.538, sample: 1.408, forward: 1.375, backward: 0.835, update: 0.244
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 26.501, sample: 1.296, forward: 1.323, backward: 0.803, update: 0.224
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 28.593, sample: 1.112, forward: 1.568, backward: 1.006, update: 0.236
train_sampler.Prefill()
-------Step 0-------
tensor([  166030,   166048,   166078,   166104, 10205196,  1038186, 62881554,
        22359240, 26103120,   166132]) tensor([ 9536991, 20284660, 56712693, 69179927, 22142309, 37825852, 42607925,
        80808427, 76972232, 34195701])
-------Step 1-------
tensor([  166030,   166048,   166078,   166104, 10205196,  1038186, 62881554,
        22359240, 26103120,   166132]) tensor([ 3770367, 28961224, 14054133, 83069311, 84265741, 45084690, 67886016,
        55041022, 36934069, 17832006])
-------Step 2-------
tensor([  227412,   227442,   227469,   279218,   227498,   227525, 85958084,
        29874216,   227550,   227571]) tensor([67465284, 25471346, 83354666, 47176261, 47594981, 33540203, 75499539,
        39857558, 18947938, 44333015])
-------Step 3-------
tensor([  227412,   227442,   227469,   279218,   227498,   227525, 85958084,
        29874216,   227550,   227571]) tensor([46939403, 78643960, 34678209, 44905634, 69882820, 59294215, 41694027,
        21201435, 31225801,  1767892])
-------Step 4-------
tensor([  290126, 43523887,   290151,  1051300,   290176,  1051317,   290202,
        46648689,   290232,   290258]) tensor([75289970, 14480915, 85764428, 20236103, 65044237, 41576697, 62095932,
        44131513, 77526414, 48632188])
-------Step 5-------
tensor([  290126, 43523887,   290151,  1051300,   290176,  1051317,   290202,
        46648689,   290232,   290258]) tensor([39859003,  1341702,   665092, 85882420, 54606043, 60976440, 19627868,
        14152965, 66333546, 46072588])
-------Step 6-------
tensor([  352958,   308856, 38634096,   352989, 31403228, 69773151,   353009,
          353036, 49283690, 43037467]) tensor([16078220, 37428662, 35621958, 74157380, 38048084, 42656537, 29081258,
        11101044, 64132970, 75658737])
-------Step 7-------
tensor([  352958,   308856, 38634096,   352989, 31403228, 69773151,   353009,
          353036, 49283690, 43037467]) tensor([26239621, 49763806, 66186225, 65226592, 83914714, 55796634, 50569540,
        53010923, 35344432,   996250])
-------Step 8-------
tensor([  412741, 30492551,   412770,  1063519,   412797,   323337,   412823,
          412853,   412881,   412908]) tensor([49569134, 26334291, 34160242,  3518531, 47427688,   187914, 20109313,
          800873,  2911008, 58894930])
-------Step 9-------
tensor([  412741, 30492551,   412770,  1063519,   412797,   323337,   412823,
          412853,   412881,   412908]) tensor([51034856,  1859669, 18658558, 61271725, 12527407, 40207724,   565576,
        43284300, 77058883, 73594622])
before start barrier
start train
[proc 0] 100 steps, total: 23.868, sample: 2.426, forward: 1.437, backward: 0.760, update: 0.301
W20240203 11:12:29.485983 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=103, pq.top=103
E20240203 11:12:29.716933 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:12:29.772468 32118 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240203 11:12:30.080379 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=107, sample_step_cpp_seen_[rank]=106
E20240203 11:12:30.716017 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=5552
W20240203 11:12:30.891989 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
W20240203 11:12:31.664376 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=111, pq.top=111
E20240203 11:12:31.718838 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:12:31.990008 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240203 11:12:32.718019 29669 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:12:33.224571 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 357.647 us                | 5.056 ms                  |
| ProcessBack:Shuffle       | 9.223 ms                  | 24.324 ms                 |
| ProcessBack:UpdateCache   | 13.655 ms                 | 15.510 ms                 |
| ProcessBack:UpsertPq      | 58.560 ms                 | 164.374 ms                |
| ProcessOneStep            | 112.346 ms                | 1.306 s                   |
| BlockToStepN              | 727.960 us                | 17.595 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:12:33.718011 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=35861
W20240203 11:12:33.727591 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.274 ms                  | 558.644 ms                |
| Forward                   | 5.502 ms                  | 19.629 ms                 |
| Backward                  | 5.317 ms                  | 10.271 ms                 |
| Optimize                  | 2.701 ms                  | 8.901 ms                  |
| BarrierTimeBeforeRank0    | 3.600 ms                  | 111.928 ms                |
| AfterBackward             | 112.986 ms                | 1.306 s                   |
| BlockToStepN              | 953.182 us                | 17.687 ms                 |
| OneStep                   | 152.186 ms                | 1.463 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:34.276072 32118 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
E20240203 11:12:34.718012 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240203 11:12:34.850560 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240203 11:12:35.338351 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240203 11:12:35.678647 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=131, sample_step_cpp_seen_[rank]=130
E20240203 11:12:35.718009 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=6555
W20240203 11:12:36.430639 32118 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240203 11:12:36.718016 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
W20240203 11:12:36.997634 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240203 11:12:37.459810 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240203 11:12:37.718019 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=2099
W20240203 11:12:38.204738 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 298.852 us                | 4.281 ms                  |
| ProcessBack:Shuffle       | 9.289 ms                  | 24.324 ms                 |
| ProcessBack:UpdateCache   | 13.591 ms                 | 15.349 ms                 |
| ProcessBack:UpsertPq      | 51.228 ms                 | 161.999 ms                |
| ProcessOneStep            | 109.427 ms                | 1.306 s                   |
| BlockToStepN              | 844.640 us                | 17.595 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:38.543860 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
E20240203 11:12:38.718029 32466 parallel_pq_v2.h:79] insert failed, size(hashtable)=50329
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.644 ms                  | 558.644 ms                |
| Forward                   | 5.571 ms                  | 19.629 ms                 |
| Backward                  | 5.408 ms                  | 10.271 ms                 |
| Optimize                  | 2.586 ms                  | 8.901 ms                  |
| BarrierTimeBeforeRank0    | 2.911 ms                  | 111.928 ms                |
| AfterBackward             | 109.530 ms                | 1.306 s                   |
| BlockToStepN              | 1.044 ms                  | 17.687 ms                 |
| OneStep                   | 152.355 ms                | 1.463 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:39.299489 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=148, pq.top=147
W20240203 11:12:39.620587 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240203 11:12:39.718011 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=6006
W20240203 11:12:40.632349 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240203 11:12:40.718011 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=9704
W20240203 11:12:40.927580 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240203 11:12:41.659302 32118 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240203 11:12:41.718011 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=67
W20240203 11:12:42.128149 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240203 11:12:42.581193 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=164, sample_step_cpp_seen_[rank]=163
E20240203 11:12:42.718012 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=7049
W20240203 11:12:42.740028 32118 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 295.091 us                | 3.508 ms                  |
| ProcessBack:Shuffle       | 9.289 ms                  | 24.324 ms                 |
| ProcessBack:UpdateCache   | 13.295 ms                 | 15.349 ms                 |
| ProcessBack:UpsertPq      | 46.505 ms                 | 161.999 ms                |
| ProcessOneStep            | 106.135 ms                | 1.191 s                   |
| BlockToStepN              | 1.034 ms                  | 18.009 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:43.612818 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=165, pq.top=165
E20240203 11:12:43.718015 29669 parallel_pq_v2.h:79] insert failed, size(hashtable)=394
W20240203 11:12:43.757329 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.542 ms                  | 367.865 ms                |
| Forward                   | 5.516 ms                  | 10.674 ms                 |
| Backward                  | 5.427 ms                  | 9.864 ms                  |
| Optimize                  | 2.579 ms                  | 8.877 ms                  |
| BarrierTimeBeforeRank0    | 2.087 ms                  | 79.402 ms                 |
| AfterBackward             | 106.177 ms                | 1.191 s                   |
| BlockToStepN              | 1.194 ms                  | 18.121 ms                 |
| OneStep                   | 150.080 ms                | 1.218 s                   |
+---------------------------+---------------------------+---------------------------+
E20240203 11:12:44.718030 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=19
W20240203 11:12:44.793058 32118 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240203 11:12:45.019810 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=174, pq.top=174
E20240203 11:12:45.718012 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=7201
W20240203 11:12:45.937320 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240203 11:12:46.718026 32454 parallel_pq_v2.h:79] insert failed, size(hashtable)=7835
W20240203 11:12:46.940210 32118 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240203 11:12:47.049871 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=183, pq.top=183
E20240203 11:12:47.718015 32453 parallel_pq_v2.h:79] insert failed, size(hashtable)=29527
W20240203 11:12:47.950197 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
W20240203 11:12:48.208578 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 381.564 us                | 14.754 ms                 |
| ProcessBack:Shuffle       | 9.233 ms                  | 23.261 ms                 |
| ProcessBack:UpdateCache   | 13.010 ms                 | 15.346 ms                 |
| ProcessBack:UpsertPq      | 42.900 ms                 | 161.632 ms                |
| ProcessOneStep            | 102.976 ms                | 1.191 s                   |
| BlockToStepN              | 1.034 ms                  | 46.153 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:12:48.718009 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1961
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.644 ms                  | 367.865 ms                |
| Forward                   | 5.502 ms                  | 10.674 ms                 |
| Backward                  | 5.408 ms                  | 9.864 ms                  |
| Optimize                  | 2.570 ms                  | 8.877 ms                  |
| BarrierTimeBeforeRank0    | 2.211 ms                  | 121.921 ms                |
| AfterBackward             | 101.249 ms                | 1.191 s                   |
| BlockToStepN              | 1.203 ms                  | 46.286 ms                 |
| OneStep                   | 144.797 ms                | 1.218 s                   |
+---------------------------+---------------------------+---------------------------+
E20240203 11:12:48.912279 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=197, sample_step_cpp_seen_[rank]=196
W20240203 11:12:49.078866 32118 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240203 11:12:49.718014 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=2361
W20240203 11:12:50.127789 32118 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
[proc 1] 200 steps, total: 21.768, sample: 1.427, forward: 0.617, backward: 0.614, update: 0.269
[proc 5] 200 steps, total: 21.768, sample: 1.352, forward: 0.616, backward: 0.684, update: 0.269
[proc 2] 200 steps, total: 21.768, sample: 1.752, forward: 0.582, backward: 0.613, update: 0.269
[proc 3] 200 steps, total: 21.768, sample: 2.198, forward: 0.596, backward: 0.587, update: 0.251
[proc 4] 200 steps, total: 21.768, sample: 1.604, forward: 0.595, backward: 0.553, update: 0.247
[proc 7] 200 steps, total: 21.768, sample: 1.552, forward: 0.539, backward: 0.585, update: 0.238
[proc 6] 200 steps, total: 21.768, sample: 1.855, forward: 0.606, backward: 0.627, update: 0.272
[proc 0] 200 steps, total: 21.768, sample: 3.417, forward: 0.581, backward: 0.601, update: 0.313
E20240203 11:12:50.718008 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=471
W20240203 11:12:50.984905 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240203 11:12:51.214641 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
E20240203 11:12:51.718011 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=2073
W20240203 11:12:52.218012 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240203 11:12:52.718015 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=6949
W20240203 11:12:53.313774 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 255.953 us                | 2.521 ms                  |
| ProcessBack:Shuffle       | 9.233 ms                  | 23.261 ms                 |
| ProcessBack:UpdateCache   | 13.053 ms                 | 15.510 ms                 |
| ProcessBack:UpsertPq      | 41.606 ms                 | 161.632 ms                |
| ProcessOneStep            | 101.206 ms                | 1.191 s                   |
| BlockToStepN              | 1.034 ms                  | 46.153 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:12:53.718010 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=18418
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.644 ms                  | 367.865 ms                |
| Forward                   | 5.439 ms                  | 10.674 ms                 |
| Backward                  | 5.366 ms                  | 9.864 ms                  |
| Optimize                  | 2.567 ms                  | 8.877 ms                  |
| BarrierTimeBeforeRank0    | 2.692 ms                  | 121.921 ms                |
| AfterBackward             | 101.249 ms                | 1.306 s                   |
| BlockToStepN              | 1.194 ms                  | 46.286 ms                 |
| OneStep                   | 145.609 ms                | 1.463 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:53.806617 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240203 11:12:54.351483 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240203 11:12:54.718039 32454 parallel_pq_v2.h:79] insert failed, size(hashtable)=41418
W20240203 11:12:54.918584 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=221, pq.top=221
E20240203 11:12:55.464196 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=225, sample_step_cpp_seen_[rank]=224
W20240203 11:12:55.537817 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240203 11:12:55.718014 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=5799
W20240203 11:12:56.553109 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240203 11:12:56.718241 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=39258
W20240203 11:12:57.432610 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240203 11:12:57.682552 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240203 11:12:57.718009 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=202
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 415.745 us                | 10.631 ms                 |
| ProcessBack:Shuffle       | 9.179 ms                  | 21.975 ms                 |
| ProcessBack:UpdateCache   | 12.559 ms                 | 15.393 ms                 |
| ProcessBack:UpsertPq      | 37.504 ms                 | 161.013 ms                |
| ProcessOneStep            | 99.832 ms                 | 1.306 s                   |
| BlockToStepN              | 1.016 ms                  | 46.153 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:12:58.718012 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=2857
W20240203 11:12:58.738970 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.854 ms                  | 367.865 ms                |
| Forward                   | 5.429 ms                  | 10.674 ms                 |
| Backward                  | 5.345 ms                  | 9.864 ms                  |
| Optimize                  | 2.557 ms                  | 8.877 ms                  |
| BarrierTimeBeforeRank0    | 3.585 ms                  | 121.921 ms                |
| AfterBackward             | 99.893 ms                 | 1.306 s                   |
| BlockToStepN              | 1.107 ms                  | 46.286 ms                 |
| OneStep                   | 143.483 ms                | 1.463 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:12:59.364365 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=243, pq.top=243
E20240203 11:12:59.718048 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=32
W20240203 11:12:59.765998 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
E20240203 11:13:00.718014 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=135173
W20240203 11:13:00.813521 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
W20240203 11:13:00.982838 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=255, pq.top=255
E20240203 11:13:01.718014 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=8781
E20240203 11:13:01.910159 27329 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=261, sample_step_cpp_seen_[rank]=260
W20240203 11:13:01.945757 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
W20240203 11:13:02.609217 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=262, pq.top=262
E20240203 11:13:02.718014 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=7870
W20240203 11:13:02.948333 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 335.843 us                | 4.229 ms                  |
| ProcessBack:Shuffle       | 9.172 ms                  | 21.975 ms                 |
| ProcessBack:UpdateCache   | 12.283 ms                 | 15.813 ms                 |
| ProcessBack:UpsertPq      | 36.908 ms                 | 161.013 ms                |
| ProcessOneStep            | 98.796 ms                 | 1.191 s                   |
| BlockToStepN              | 1.016 ms                  | 46.153 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:03.658758 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=270, pq.top=270
E20240203 11:13:03.718009 29669 parallel_pq_v2.h:79] insert failed, size(hashtable)=5987
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.092 ms                  | 299.948 ms                |
| Forward                   | 5.395 ms                  | 10.355 ms                 |
| Backward                  | 5.344 ms                  | 9.864 ms                  |
| Optimize                  | 2.554 ms                  | 7.993 ms                  |
| BarrierTimeBeforeRank0    | 3.496 ms                  | 111.928 ms                |
| AfterBackward             | 98.314 ms                 | 1.191 s                   |
| BlockToStepN              | 1.163 ms                  | 46.286 ms                 |
| OneStep                   | 143.258 ms                | 1.218 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:03.954445 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240203 11:13:04.723845 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:13:05.022750 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
W20240203 11:13:05.575090 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=277, pq.top=277
E20240203 11:13:05.723016 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=316
W20240203 11:13:06.022037 32118 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240203 11:13:06.598856 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=285, pq.top=285
E20240203 11:13:06.723022 32482 parallel_pq_v2.h:79] insert failed, size(hashtable)=10658
W20240203 11:13:07.073549 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240203 11:13:07.252445 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=291, sample_step_cpp_seen_[rank]=290
E20240203 11:13:07.723016 32474 parallel_pq_v2.h:79] insert failed, size(hashtable)=2954
W20240203 11:13:08.187244 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 356.401 us                | 5.259 ms                  |
| ProcessBack:Shuffle       | 9.128 ms                  | 21.887 ms                 |
| ProcessBack:UpdateCache   | 11.788 ms                 | 15.714 ms                 |
| ProcessBack:UpsertPq      | 35.878 ms                 | 153.490 ms                |
| ProcessOneStep            | 97.887 ms                 | 1.191 s                   |
| BlockToStepN              | 1.129 ms                  | 48.376 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:08.424221 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=293, pq.top=293
E20240203 11:13:08.723012 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=44959
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.119 ms                  | 299.948 ms                |
| Forward                   | 5.376 ms                  | 10.355 ms                 |
| Backward                  | 5.346 ms                  | 9.864 ms                  |
| Optimize                  | 2.544 ms                  | 7.993 ms                  |
| BarrierTimeBeforeRank0    | 3.460 ms                  | 111.928 ms                |
| AfterBackward             | 97.933 ms                 | 1.191 s                   |
| BlockToStepN              | 1.273 ms                  | 48.507 ms                 |
| OneStep                   | 142.857 ms                | 1.218 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:09.256028 32118 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
[proc 6] 300 steps, total: 18.755, sample: 1.608, forward: 0.566, backward: 0.666, update: 0.270
[proc 1] 300 steps, total: 18.755, sample: 1.208, forward: 0.545, backward: 0.733, update: 0.249
[proc 3] 300 steps, total: 18.755, sample: 1.424, forward: 0.573, backward: 0.675, update: 0.240
[proc 0] 300 steps, total: 18.755, sample: 1.792, forward: 0.518, backward: 0.537, update: 0.285
[proc 5] 300 steps, total: 18.755, sample: 1.118, forward: 0.588, backward: 0.689, update: 0.277
[proc 2] 300 steps, total: 18.755, sample: 1.221, forward: 0.533, backward: 0.560, update: 0.258
[proc 4] 300 steps, total: 18.755, sample: 1.193, forward: 0.525, backward: 0.601, update: 0.250
[proc 7] 300 steps, total: 18.755, sample: 1.669, forward: 0.587, backward: 0.594, update: 0.249
W20240203 11:13:09.456338 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240203 11:13:09.723012 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=95352
W20240203 11:13:10.320222 32118 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240203 11:13:10.724597 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:13:11.331380 32118 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240203 11:13:11.384198 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=309, pq.top=309
E20240203 11:13:11.724013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=48305
W20240203 11:13:12.384748 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240203 11:13:12.390972 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
E20240203 11:13:12.724017 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=49399
E20240203 11:13:12.911238 27329 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=321, sample_step_cpp_seen_[rank]=320
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 435.153 us                | 21.299 ms                 |
| ProcessBack:Shuffle       | 9.086 ms                  | 21.968 ms                 |
| ProcessBack:UpdateCache   | 11.401 ms                 | 15.714 ms                 |
| ProcessBack:UpsertPq      | 31.785 ms                 | 153.490 ms                |
| ProcessOneStep            | 96.070 ms                 | 1.191 s                   |
| BlockToStepN              | 1.211 ms                  | 51.415 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:13.468000 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240203 11:13:13.724015 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=5344
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.315 ms                  | 299.948 ms                |
| Forward                   | 5.364 ms                  | 10.355 ms                 |
| Backward                  | 5.351 ms                  | 9.864 ms                  |
| Optimize                  | 2.532 ms                  | 7.993 ms                  |
| BarrierTimeBeforeRank0    | 3.440 ms                  | 111.928 ms                |
| AfterBackward             | 96.134 ms                 | 1.191 s                   |
| BlockToStepN              | 1.312 ms                  | 51.554 ms                 |
| OneStep                   | 142.756 ms                | 1.218 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:13.984001 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=322, pq.top=322
W20240203 11:13:14.484063 32118 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
E20240203 11:13:14.729070 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:13:15.105988 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240203 11:13:15.601258 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240203 11:13:15.729013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=2161
W20240203 11:13:16.653939 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240203 11:13:16.657497 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240203 11:13:16.729008 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=2164
E20240203 11:13:17.729019 32480 parallel_pq_v2.h:79] insert failed, size(hashtable)=37529
W20240203 11:13:17.734614 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240203 11:13:17.790642 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 452.027 us                | 9.439 ms                  |
| ProcessBack:Shuffle       | 9.055 ms                  | 21.887 ms                 |
| ProcessBack:UpdateCache   | 11.377 ms                 | 15.510 ms                 |
| ProcessBack:UpsertPq      | 31.103 ms                 | 149.908 ms                |
| ProcessOneStep            | 95.677 ms                 | 1.191 s                   |
| BlockToStepN              | 1.315 ms                  | 51.415 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:13:18.728653 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=353, sample_step_cpp_seen_[rank]=352
E20240203 11:13:18.734280 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.854 ms                  | 249.336 ms                |
| Forward                   | 5.328 ms                  | 9.894 ms                  |
| Backward                  | 5.377 ms                  | 9.679 ms                  |
| Optimize                  | 2.526 ms                  | 7.638 ms                  |
| BarrierTimeBeforeRank0    | 3.508 ms                  | 87.410 ms                 |
| AfterBackward             | 95.484 ms                 | 1.169 s                   |
| BlockToStepN              | 1.448 ms                  | 51.554 ms                 |
| OneStep                   | 140.246 ms                | 1.193 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:18.871647 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240203 11:13:19.734016 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=14
W20240203 11:13:19.898491 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
W20240203 11:13:20.034883 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240203 11:13:20.749033 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=12
W20240203 11:13:20.919071 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
W20240203 11:13:21.103175 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=365, pq.top=365
E20240203 11:13:21.749008 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=3182
W20240203 11:13:22.076387 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
W20240203 11:13:22.693428 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=371, pq.top=371
E20240203 11:13:22.749011 29669 parallel_pq_v2.h:79] insert failed, size(hashtable)=4831
W20240203 11:13:23.146118 32118 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 381.737 us                | 8.640 ms                  |
| ProcessBack:Shuffle       | 9.061 ms                  | 21.887 ms                 |
| ProcessBack:UpdateCache   | 11.349 ms                 | 15.510 ms                 |
| ProcessBack:UpsertPq      | 30.848 ms                 | 149.908 ms                |
| ProcessOneStep            | 95.236 ms                 | 1.169 s                   |
| BlockToStepN              | 1.348 ms                  | 51.415 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:23.705883 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240203 11:13:23.749014 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.542 ms                  | 249.336 ms                |
| Forward                   | 5.328 ms                  | 9.927 ms                  |
| Backward                  | 5.379 ms                  | 9.679 ms                  |
| Optimize                  | 2.532 ms                  | 7.993 ms                  |
| BarrierTimeBeforeRank0    | 3.505 ms                  | 87.410 ms                 |
| AfterBackward             | 94.725 ms                 | 1.169 s                   |
| BlockToStepN              | 1.448 ms                  | 51.554 ms                 |
| OneStep                   | 138.504 ms                | 1.193 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:24.239795 32118 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240203 11:13:24.369551 27329 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=385, sample_step_cpp_seen_[rank]=384
E20240203 11:13:24.749017 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=5181
W20240203 11:13:25.278584 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240203 11:13:25.703150 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=389, pq.top=388
E20240203 11:13:25.749015 32465 parallel_pq_v2.h:79] insert failed, size(hashtable)=42507
W20240203 11:13:26.390798 32118 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
E20240203 11:13:26.749019 32459 parallel_pq_v2.h:79] insert failed, size(hashtable)=30897
W20240203 11:13:26.762907 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=397, pq.top=397
[proc 0] 400 steps, total: 17.716, sample: 1.287, forward: 0.525, backward: 0.549, update: 0.282
[proc 3] 400 steps, total: 17.716, sample: 1.603, forward: 0.626, backward: 0.601, update: 0.267
[proc 1] 400 steps, total: 17.716, sample: 1.112, forward: 0.542, backward: 0.690, update: 0.252
[proc 2] 400 steps, total: 17.716, sample: 0.942, forward: 0.479, backward: 0.633, update: 0.243
[proc 4] 400 steps, total: 17.716, sample: 1.163, forward: 0.570, backward: 0.597, update: 0.262
[proc 5] 400 steps, total: 17.716, sample: 0.877, forward: 0.545, backward: 0.573, update: 0.268
[proc 7] 400 steps, total: 17.716, sample: 1.157, forward: 0.566, backward: 0.607, update: 0.247
[proc 6] 400 steps, total: 17.716, sample: 1.233, forward: 0.532, backward: 0.611, update: 0.240
W20240203 11:13:27.604157 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240203 11:13:27.749012 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1486
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 386.861 us                | 22.108 ms                 |
| ProcessBack:Shuffle       | 9.101 ms                  | 21.887 ms                 |
| ProcessBack:UpdateCache   | 11.272 ms                 | 15.393 ms                 |
| ProcessBack:UpsertPq      | 30.419 ms                 | 149.707 ms                |
| ProcessOneStep            | 94.281 ms                 | 1.169 s                   |
| BlockToStepN              | 1.315 ms                  | 51.415 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:13:28.749042 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=45081
W20240203 11:13:28.757884 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.244 ms                  | 249.336 ms                |
| Forward                   | 5.328 ms                  | 9.927 ms                  |
| Backward                  | 5.384 ms                  | 9.864 ms                  |
| Optimize                  | 2.532 ms                  | 7.993 ms                  |
| BarrierTimeBeforeRank0    | 3.605 ms                  | 87.410 ms                 |
| AfterBackward             | 94.725 ms                 | 1.169 s                   |
| BlockToStepN              | 1.433 ms                  | 51.554 ms                 |
| OneStep                   | 137.821 ms                | 1.193 s                   |
+---------------------------+---------------------------+---------------------------+
E20240203 11:13:29.749017 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=14630
W20240203 11:13:29.820020 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240203 11:13:29.826929 32118 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240203 11:13:30.749019 32117 parallel_pq_v2.h:79] insert failed, size(hashtable)=121258
W20240203 11:13:31.011309 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=420, pq.top=420
W20240203 11:13:31.068974 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240203 11:13:31.212414 29669 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=420, sample_step_cpp_seen_[rank]=419
E20240203 11:13:31.749018 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=11597
W20240203 11:13:32.103808 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240203 11:13:32.113499 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240203 11:13:32.750182 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:13:33.160404 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240203 11:13:33.167133 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=427, pq.top=427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 448.117 us                | 10.902 ms                 |
| ProcessBack:Shuffle       | 9.112 ms                  | 21.082 ms                 |
| ProcessBack:UpdateCache   | 11.283 ms                 | 15.349 ms                 |
| ProcessBack:UpsertPq      | 30.495 ms                 | 149.707 ms                |
| ProcessOneStep            | 94.677 ms                 | 1.169 s                   |
| BlockToStepN              | 1.460 ms                  | 54.078 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:13:33.750008 32453 parallel_pq_v2.h:79] insert failed, size(hashtable)=48826
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.166 ms                  | 249.336 ms                |
| Forward                   | 5.343 ms                  | 9.927 ms                  |
| Backward                  | 5.384 ms                  | 9.864 ms                  |
| Optimize                  | 2.544 ms                  | 7.993 ms                  |
| BarrierTimeBeforeRank0    | 3.691 ms                  | 87.410 ms                 |
| AfterBackward             | 94.725 ms                 | 1.169 s                   |
| BlockToStepN              | 1.582 ms                  | 54.231 ms                 |
| OneStep                   | 138.213 ms                | 1.193 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:34.287340 32118 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
W20240203 11:13:34.347357 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=437, pq.top=437
E20240203 11:13:34.750015 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=5534
W20240203 11:13:35.290412 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240203 11:13:35.591728 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240203 11:13:35.751209 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:13:36.343559 32118 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
W20240203 11:13:36.591909 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=447, pq.top=446
E20240203 11:13:36.751010 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=1191
E20240203 11:13:37.428531 27329 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=453, sample_step_cpp_seen_[rank]=452
W20240203 11:13:37.587858 32118 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240203 11:13:37.751010 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=2060
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 493.283 us                | 17.151 ms                 |
| ProcessBack:Shuffle       | 9.128 ms                  | 21.082 ms                 |
| ProcessBack:UpdateCache   | 11.284 ms                 | 15.349 ms                 |
| ProcessBack:UpsertPq      | 29.909 ms                 | 149.707 ms                |
| ProcessOneStep            | 94.677 ms                 | 1.142 s                   |
| BlockToStepN              | 1.556 ms                  | 54.078 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:38.593739 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240203 11:13:38.611228 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240203 11:13:38.751869 32463 parallel_pq_v2.h:79] insert failed, size(hashtable)=9639
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.039 ms                  | 216.006 ms                |
| Forward                   | 5.358 ms                  | 9.894 ms                  |
| Backward                  | 5.408 ms                  | 9.679 ms                  |
| Optimize                  | 2.561 ms                  | 7.971 ms                  |
| BarrierTimeBeforeRank0    | 3.676 ms                  | 87.180 ms                 |
| AfterBackward             | 94.725 ms                 | 1.142 s                   |
| BlockToStepN              | 1.696 ms                  | 54.231 ms                 |
| OneStep                   | 138.322 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:39.644996 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
W20240203 11:13:39.697865 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=463, pq.top=463
E20240203 11:13:39.751017 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=25
E20240203 11:13:40.751628 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240203 11:13:40.808183 32118 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
W20240203 11:13:41.704313 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=471, pq.top=471
E20240203 11:13:41.751013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=379
W20240203 11:13:41.828270 32118 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240203 11:13:42.719671 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=479, pq.top=479
E20240203 11:13:42.751013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=39085
W20240203 11:13:42.863087 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 474.422 us                | 21.119 ms                 |
| ProcessBack:Shuffle       | 9.128 ms                  | 20.872 ms                 |
| ProcessBack:UpdateCache   | 11.309 ms                 | 15.714 ms                 |
| ProcessBack:UpsertPq      | 29.845 ms                 | 149.371 ms                |
| ProcessOneStep            | 94.277 ms                 | 1.142 s                   |
| BlockToStepN              | 1.625 ms                  | 65.844 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240203 11:13:43.484956 27329 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=485, sample_step_cpp_seen_[rank]=484
E20240203 11:13:43.751034 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=6076
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.994 ms                  | 216.006 ms                |
| Forward                   | 5.369 ms                  | 9.894 ms                  |
| Backward                  | 5.417 ms                  | 9.990 ms                  |
| Optimize                  | 2.566 ms                  | 7.993 ms                  |
| BarrierTimeBeforeRank0    | 3.508 ms                  | 87.180 ms                 |
| AfterBackward             | 94.331 ms                 | 1.142 s                   |
| BlockToStepN              | 1.762 ms                  | 65.981 ms                 |
| OneStep                   | 138.322 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 11:13:43.967689 32118 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240203 11:13:44.751013 27329 parallel_pq_v2.h:79] insert failed, size(hashtable)=478
W20240203 11:13:44.993947 32118 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
W20240203 11:13:45.705962 27329 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=494, pq.top=494
E20240203 11:13:45.751013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=11662
W20240203 11:13:46.101871 32118 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240203 11:13:46.751013 32118 parallel_pq_v2.h:79] insert failed, size(hashtable)=75033
W20240203 11:13:47.275558 32118 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
[proc 1] 500 steps, total: 20.692, sample: 1.015, forward: 0.544, backward: 0.602, update: 0.254
[proc 4] 500 steps, total: 20.692, sample: 0.979, forward: 0.541, backward: 0.613, update: 0.252
[proc 6] 500 steps, total: 20.692, sample: 1.102, forward: 0.536, backward: 0.581, update: 0.253
[proc 0] 500 steps, total: 20.692, sample: 1.809, forward: 0.585, backward: 0.622, update: 0.301
[proc 7] 500 steps, total: 20.692, sample: 1.111, forward: 0.555, backward: 0.651, update: 0.254
[proc 5] 500 steps, total: 20.692, sample: 0.946, forward: 0.537, backward: 0.598, update: 0.234
[proc 3] 500 steps, total: 20.692, sample: 1.329, forward: 0.611, backward: 0.591, update: 0.262
[proc 2] 500 steps, total: 20.692, sample: 0.997, forward: 0.562, backward: 0.616, update: 0.265
Successfully xmh. training takes 102.79998755455017 seconds
before call kg_cache_controller.StopThreads()
W20240203 11:13:47.749549 27329 grad_async_v2.h:84] call StopThreads. PID = 59569
W20240203 11:13:47.749598 27329 grad_base.h:212] before processOneStepNegThread_.join();
W20240203 11:13:47.749960 27329 grad_base.h:214] after processOneStepNegThread_.join();
W20240203 11:13:47.749976 27329 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240203 11:13:47.752413 27329 grad_async_v2.h:105] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 584.625 us                | 8.906 ms                  |
| ProcessBack:Shuffle       | 9.151 ms                  | 21.082 ms                 |
| ProcessBack:UpdateCache   | 11.309 ms                 | 15.813 ms                 |
| ProcessBack:UpsertPq      | 30.237 ms                 | 149.707 ms                |
| ProcessOneStep            | 94.281 ms                 | 1.142 s                   |
| BlockToStepN              | 1.639 ms                  | 69.322 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.115 ms                  | 249.336 ms                |
| Forward                   | 5.381 ms                  | 9.927 ms                  |
| Backward                  | 5.430 ms                  | 9.990 ms                  |
| Optimize                  | 2.566 ms                  | 8.541 ms                  |
| BarrierTimeBeforeRank0    | 3.425 ms                  | 87.180 ms                 |
| AfterBackward             | 94.331 ms                 | 1.142 s                   |
| BlockToStepN              | 1.762 ms                  | 69.448 ms                 |
| OneStep                   | 138.721 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
