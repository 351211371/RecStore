WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240213 04:27:21.740487 41278 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_71', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=1, update_pq_use_omp=2, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [41278 sampler.py:454] Start PreSampling
WARNING [41278 sampler.py:532] Before construct renumbering_dict
WARNING [41278 sampler.py:555] PreSampling done
W20240213 04:46:34.243315 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240213 04:46:34.243512 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240213 04:46:34.243561 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240213 04:46:34.243599 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240213 04:46:34.243636 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240213 04:46:34.243674 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240213 04:46:34.243702 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240213 04:46:34.243749 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240213 04:46:34.243788 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240213 04:46:34.243827 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240213 04:46:34.243870 41278 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240213 04:46:34.243906 41278 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240213 04:46:34.243937 41278 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240213 04:46:34.244117 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240213 04:46:34.244168 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240213 04:46:34.244201 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240213 04:46:34.244249 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240213 04:46:34.244289 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240213 04:46:34.244329 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240213 04:46:34.244365 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240213 04:46:34.244398 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240213 04:46:34.244443 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240213 04:46:34.244488 41278 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240213 04:46:34.244518 41278 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240213 04:46:34.244545 41278 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240213 04:46:34.244572 41278 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240213 04:46:34.778494 41278 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000098ca000 128.2 GB
W20240213 04:55:15.699534 41278 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102018502000 328.3 MB
{0: Graph(num_nodes=43196088, num_edges=182879791,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=47371617, num_edges=163853044,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 43196088 N 182879791 E
MertisPartition: part 1 has 47371617 N 163853044 E
Rank0: cached key size 2151353
Rank1: cached key size 2151353
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 24862891, 27748820, 20932263]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([ 4302723,  4302750,   722150,  ..., 29969542, 25715572, 58655753]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2094.450 seconds
INFO [42457 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [41278 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [41278 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [42457 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
WARNING [41278 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [42457 DistTensor.py:59] The tensor name already exists in the kvstore
I20240213 05:02:28.241436 42458 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240213 05:02:28.241779 42471 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
E20240213 05:02:29.512354 42458 recstore.cc:66] init folly done
E20240213 05:02:29.512480 42471 recstore.cc:66] init folly done
I20240213 05:02:55.129478 42458 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240213 05:02:55.524739 42471 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.279 ms                  | 9.279 ms                  |
| bucket keys               | 149.534 ms                | 149.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.279 ms                  | 9.279 ms                  |
| bucket keys               | 149.534 ms                | 149.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.279 ms                  | 9.279 ms                  |
| bucket keys               | 149.534 ms                | 149.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.279 ms                  | 9.279 ms                  |
| bucket keys               | 149.534 ms                | 149.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.279 ms                  | 9.279 ms                  |
| bucket keys               | 149.534 ms                | 149.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.279 ms                  | 9.279 ms                  |
| bucket keys               | 149.534 ms                | 149.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.279 ms                  | 9.279 ms                  |
| bucket keys               | 149.534 ms                | 149.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.279 ms                  | 9.279 ms                  |
| bucket keys               | 149.534 ms                | 149.534 ms                |
| forward: a2a keys         | 37.362 s                  | 37.362 s                  |
| forward: search cache     | 20.697 ms                 | 20.697 ms                 |
| forward: a2a values       | 4.153 ms                  | 4.153 ms                  |
| forward: software         | 697.851 us                | 697.851 us                |
| forward: join             | 1.590 ms                  | 1.590 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.939 ms                 | 268.772 ms                |
| bucket keys               | 1.926 ms                  | 32.546 ms                 |
| forward: a2a keys         | 895.262 us                | 59.554 ms                 |
| forward: search cache     | 148.535 us                | 353.336 us                |
| forward: a2a values       | 909.805 us                | 3.399 ms                  |
| forward: software         | 832.081 us                | 913.620 us                |
| forward: join             | 2.885 ms                  | 3.856 ms                  |
| Forward                   | 20.255 ms                 | 37.889 s                  |
| back: aggr dram keys      | 28.483 ms                 | 71.595 ms                 |
| back: set dram grad       | 2.827 ms                  | 4.047 ms                  |
| back: a2a grad            | 2.168 ms                  | 4.285 ms                  |
| back: grad sum & grad cache  | 1.445 ms                  | 16.696 ms                 |
| Backward                  | 79.934 ms                 | 335.441 ms                |
| Optimize                  | 14.457 ms                 | 48.442 ms                 |
| BarrierTimeBeforeRank0    | 47.909 us                 | 170.890 us                |
| BlockToStepN              | 17.564 us                 | 53.254 us                 |
| OneStep                   | 137.762 ms                | 38.283 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.023 ms                 | 257.906 ms                |
| bucket keys               | 2.004 ms                  | 32.546 ms                 |
| forward: a2a keys         | 838.041 us                | 59.554 ms                 |
| forward: search cache     | 149.250 us                | 433.683 us                |
| forward: a2a values       | 933.409 us                | 4.153 ms                  |
| forward: software         | 826.836 us                | 922.441 us                |
| forward: join             | 2.875 ms                  | 3.856 ms                  |
| Forward                   | 19.271 ms                 | 77.212 ms                 |
| back: aggr dram keys      | 25.757 ms                 | 71.595 ms                 |
| back: set dram grad       | 2.814 ms                  | 6.205 ms                  |
| back: a2a grad            | 3.765 ms                  | 8.285 ms                  |
| back: grad sum & grad cache  | 1.551 ms                  | 16.696 ms                 |
| Backward                  | 78.346 ms                 | 121.630 ms                |
| Optimize                  | 14.314 ms                 | 20.382 ms                 |
| BarrierTimeBeforeRank0    | 45.710 us                 | 90.101 us                 |
| BlockToStepN              | 17.956 us                 | 53.254 us                 |
| OneStep                   | 125.098 ms                | 444.015 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 52.464, sample: 2.104, forward: 41.196, backward: 6.402, update: 0.367
[Rank1] pid = 42457
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414)]
train_sampler.Prefill()
-------Step 0-------
tensor([1674203, 1674246, 1674276, 1148262, 1674305, 1674345, 1674384,   20431,
        1674424, 1674458]) tensor([  152518,  4701993, 15249305, 58094988, 30102525, 18094418, 79248492,
         7656837, 37713903, 54612318])
-------Step 1-------
tensor([1674203, 1674246, 1674276, 1148262, 1674305, 1674345, 1674384,   20431,
        1674424, 1674458]) tensor([59292574, 54679119, 75157981, 34076178, 36476578,   216401, 25613739,
        46527351, 65918079, 83713604])
-------Step 2-------
tensor([1786328, 1786371, 1786407, 1786437, 1786473, 1786507, 1786541, 1786583,
        1154697, 1786628]) tensor([21212549, 13977173, 43327520, 79935092, 38340214,  1517245, 44492309,
        41462425, 54961112, 11317944])
-------Step 3-------
tensor([1786328, 1786371, 1786407, 1786437, 1786473, 1786507, 1786541, 1786583,
        1154697, 1786628]) tensor([55815333, 85375542,  2337617, 33891999, 61999630, 47500900, 27813868,
        40682767, 61974052, 19755638])
-------Step 4-------
tensor([ 1878417,  1878442,   287977,  1878475,   288019, 60460493,  1064232,
         1878507,  1878532,  1878560]) tensor([  974584, 68387945, 22397312, 42535974, 71200950, 65634532, 48576843,
        34286004, 23011938, 32992221])
-------Step 5-------
tensor([ 1878417,  1878442,   287977,  1878475,   288019, 60460493,  1064232,
         1878507,  1878532,  1878560]) tensor([47934025, 46437289, 63341195, 14919070, 20127701, 77867780, 61926509,
        12339517, 67847022, 84005186])
-------Step 6-------
tensor([ 1948180,  1948206,  1948225,   476407,  1948246,  1948260,  1948273,
        13223978,  1948298,  4335658]) tensor([13338681, 27203198,  5821666,  1725428, 20599034, 14248846,  2904219,
         1407143, 78115317, 19485046])
-------Step 7-------
tensor([ 1948180,  1948206,  1948225,   476407,  1948246,  1948260,  1948273,
        13223978,  1948298,  4335658]) tensor([77954637, 59353223, 55024656,  1618579,  8439080, 32706663, 78477112,
        84060735, 74730769,  8662300])
-------Step 8-------
tensor([2002620, 2002635, 2002655,  480087, 2002674, 2002692, 2002708,  290209,
        2002729, 2002744]) tensor([75868265, 68534534,   358187,  4351373, 37058721, 25080545, 77472073,
        65592720, 41696156, 29997288])
-------Step 9-------
tensor([2002620, 2002635, 2002655,  480087, 2002674, 2002692, 2002708,  290209,
        2002729, 2002744]) tensor([  707915, 32650354, 22018787, 66492825, 38435502,  1941542, 17147205,
        32634274, 34717673, 60751828])
before start barrier
start train
[proc 0] 100 steps, total: 52.068, sample: 2.533, forward: 39.939, backward: 8.157, update: 1.356
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.384 ms                 | 257.906 ms                |
| bucket keys               | 2.392 ms                  | 5.090 ms                  |
| forward: a2a keys         | 822.067 us                | 9.856 ms                  |
| forward: search cache     | 152.588 us                | 431.061 us                |
| forward: a2a values       | 950.813 us                | 3.533 ms                  |
| forward: software         | 826.836 us                | 981.808 us                |
| forward: join             | 2.875 ms                  | 3.856 ms                  |
| Forward                   | 19.271 ms                 | 77.212 ms                 |
| back: aggr dram keys      | 26.670 ms                 | 50.465 ms                 |
| back: set dram grad       | 2.803 ms                  | 4.440 ms                  |
| back: a2a grad            | 3.753 ms                  | 8.285 ms                  |
| back: grad sum & grad cache  | 1.551 ms                  | 16.633 ms                 |
| Backward                  | 77.439 ms                 | 121.630 ms                |
| Optimize                  | 12.941 ms                 | 20.382 ms                 |
| BarrierTimeBeforeRank0    | 45.664 us                 | 90.101 us                 |
| BlockToStepN              | 18.368 us                 | 53.254 us                 |
| OneStep                   | 120.388 ms                | 444.015 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.766 ms                  | 257.906 ms                |
| bucket keys               | 2.392 ms                  | 5.090 ms                  |
| forward: a2a keys         | 797.749 us                | 6.208 ms                  |
| forward: search cache     | 154.257 us                | 433.683 us                |
| forward: a2a values       | 975.847 us                | 3.590 ms                  |
| forward: software         | 826.836 us                | 948.668 us                |
| forward: join             | 2.875 ms                  | 3.747 ms                  |
| Forward                   | 19.218 ms                 | 77.212 ms                 |
| back: aggr dram keys      | 25.757 ms                 | 50.412 ms                 |
| back: set dram grad       | 2.801 ms                  | 4.806 ms                  |
| back: a2a grad            | 3.752 ms                  | 7.638 ms                  |
| back: grad sum & grad cache  | 1.551 ms                  | 16.633 ms                 |
| Backward                  | 76.626 ms                 | 121.630 ms                |
| Optimize                  | 12.737 ms                 | 20.382 ms                 |
| BarrierTimeBeforeRank0    | 43.617 us                 | 90.842 us                 |
| BlockToStepN              | 17.956 us                 | 78.806 us                 |
| OneStep                   | 118.416 ms                | 444.015 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.979 ms                  | 255.880 ms                |
| bucket keys               | 2.392 ms                  | 5.073 ms                  |
| forward: a2a keys         | 799.417 us                | 6.208 ms                  |
| forward: search cache     | 156.164 us                | 433.683 us                |
| forward: a2a values       | 1.331 ms                  | 3.701 ms                  |
| forward: software         | 826.836 us                | 981.808 us                |
| forward: join             | 2.875 ms                  | 3.856 ms                  |
| Forward                   | 19.330 ms                 | 62.083 ms                 |
| back: aggr dram keys      | 25.954 ms                 | 50.465 ms                 |
| back: set dram grad       | 2.817 ms                  | 4.806 ms                  |
| back: a2a grad            | 3.753 ms                  | 7.628 ms                  |
| back: grad sum & grad cache  | 1.734 ms                  | 16.696 ms                 |
| Backward                  | 76.541 ms                 | 117.034 ms                |
| Optimize                  | 12.623 ms                 | 20.382 ms                 |
| BarrierTimeBeforeRank0    | 42.845 us                 | 90.842 us                 |
| BlockToStepN              | 17.677 us                 | 78.806 us                 |
| OneStep                   | 118.285 ms                | 372.935 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 13.280, sample: 2.185, forward: 2.075, backward: 7.677, update: 1.258
[proc 1] 200 steps, total: 13.280, sample: 1.678, forward: 3.255, backward: 6.059, update: 0.300
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.321 ms                  | 255.880 ms                |
| bucket keys               | 2.392 ms                  | 5.090 ms                  |
| forward: a2a keys         | 795.364 us                | 23.818 ms                 |
| forward: search cache     | 154.734 us                | 433.683 us                |
| forward: a2a values       | 1.331 ms                  | 3.701 ms                  |
| forward: software         | 826.836 us                | 981.808 us                |
| forward: join             | 2.875 ms                  | 3.856 ms                  |
| Forward                   | 19.218 ms                 | 77.212 ms                 |
| back: aggr dram keys      | 26.428 ms                 | 54.565 ms                 |
| back: set dram grad       | 2.821 ms                  | 4.806 ms                  |
| back: a2a grad            | 3.753 ms                  | 7.638 ms                  |
| back: grad sum & grad cache  | 1.734 ms                  | 16.696 ms                 |
| Backward                  | 76.016 ms                 | 117.034 ms                |
| Optimize                  | 12.542 ms                 | 20.567 ms                 |
| BarrierTimeBeforeRank0    | 42.118 us                 | 91.021 us                 |
| BlockToStepN              | 17.661 us                 | 78.806 us                 |
| OneStep                   | 118.285 ms                | 372.935 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.543 ms                  | 230.412 ms                |
| bucket keys               | 2.380 ms                  | 5.076 ms                  |
| forward: a2a keys         | 795.126 us                | 23.717 ms                 |
| forward: search cache     | 154.495 us                | 432.014 us                |
| forward: a2a values       | 1.331 ms                  | 3.590 ms                  |
| forward: software         | 826.836 us                | 1.092 ms                  |
| forward: join             | 2.875 ms                  | 4.256 ms                  |
| Forward                   | 19.222 ms                 | 62.083 ms                 |
| back: aggr dram keys      | 25.980 ms                 | 50.465 ms                 |
| back: set dram grad       | 2.816 ms                  | 4.440 ms                  |
| back: a2a grad            | 3.753 ms                  | 7.628 ms                  |
| back: grad sum & grad cache  | 1.734 ms                  | 16.696 ms                 |
| Backward                  | 75.823 ms                 | 109.270 ms                |
| Optimize                  | 12.542 ms                 | 20.382 ms                 |
| BarrierTimeBeforeRank0    | 42.376 us                 | 91.021 us                 |
| BlockToStepN              | 17.767 us                 | 78.806 us                 |
| OneStep                   | 117.797 ms                | 368.001 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.667 ms                  | 230.412 ms                |
| bucket keys               | 2.380 ms                  | 5.076 ms                  |
| forward: a2a keys         | 787.735 us                | 9.856 ms                  |
| forward: search cache     | 154.972 us                | 433.683 us                |
| forward: a2a values       | 1.350 ms                  | 3.590 ms                  |
| forward: software         | 826.836 us                | 1.092 ms                  |
| forward: join             | 2.875 ms                  | 4.256 ms                  |
| Forward                   | 19.140 ms                 | 62.083 ms                 |
| back: aggr dram keys      | 25.980 ms                 | 50.412 ms                 |
| back: set dram grad       | 2.811 ms                  | 4.047 ms                  |
| back: a2a grad            | 3.753 ms                  | 6.041 ms                  |
| back: grad sum & grad cache  | 1.734 ms                  | 16.696 ms                 |
| Backward                  | 75.911 ms                 | 109.270 ms                |
| Optimize                  | 12.501 ms                 | 20.567 ms                 |
| BarrierTimeBeforeRank0    | 42.556 us                 | 91.021 us                 |
| BlockToStepN              | 17.677 us                 | 78.806 us                 |
| OneStep                   | 117.493 ms                | 368.001 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 12.801, sample: 1.858, forward: 2.001, backward: 7.584, update: 1.268
[proc 1] 300 steps, total: 12.801, sample: 1.271, forward: 3.245, backward: 6.022, update: 0.298
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.543 ms                  | 230.412 ms                |
| bucket keys               | 2.392 ms                  | 5.088 ms                  |
| forward: a2a keys         | 779.629 us                | 9.856 ms                  |
| forward: search cache     | 155.210 us                | 433.683 us                |
| forward: a2a values       | 1.350 ms                  | 3.590 ms                  |
| forward: software         | 826.836 us                | 1.092 ms                  |
| forward: join             | 2.862 ms                  | 4.256 ms                  |
| Forward                   | 19.099 ms                 | 62.083 ms                 |
| back: aggr dram keys      | 25.980 ms                 | 50.412 ms                 |
| back: set dram grad       | 2.814 ms                  | 4.047 ms                  |
| back: a2a grad            | 3.753 ms                  | 5.242 ms                  |
| back: grad sum & grad cache  | 1.734 ms                  | 16.696 ms                 |
| Backward                  | 75.730 ms                 | 109.270 ms                |
| Optimize                  | 12.450 ms                 | 22.734 ms                 |
| BarrierTimeBeforeRank0    | 42.346 us                 | 91.021 us                 |
| BlockToStepN              | 17.673 us                 | 78.806 us                 |
| OneStep                   | 117.310 ms                | 368.001 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.667 ms                  | 217.465 ms                |
| bucket keys               | 2.392 ms                  | 5.088 ms                  |
| forward: a2a keys         | 771.999 us                | 9.856 ms                  |
| forward: search cache     | 154.257 us                | 433.683 us                |
| forward: a2a values       | 1.350 ms                  | 3.675 ms                  |
| forward: software         | 826.836 us                | 1.113 ms                  |
| forward: join             | 2.862 ms                  | 4.758 ms                  |
| Forward                   | 18.950 ms                 | 61.971 ms                 |
| back: aggr dram keys      | 25.757 ms                 | 50.412 ms                 |
| back: set dram grad       | 2.815 ms                  | 4.047 ms                  |
| back: a2a grad            | 3.753 ms                  | 5.242 ms                  |
| back: grad sum & grad cache  | 5.276 ms                  | 16.696 ms                 |
| Backward                  | 75.380 ms                 | 109.270 ms                |
| Optimize                  | 12.389 ms                 | 20.567 ms                 |
| BarrierTimeBeforeRank0    | 42.078 us                 | 90.842 us                 |
| BlockToStepN              | 17.572 us                 | 175.275 us                |
| OneStep                   | 117.166 ms                | 350.840 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 12.807, sample: 1.380, forward: 3.006, backward: 6.122, update: 0.311
[proc 0] 400 steps, total: 12.807, sample: 1.865, forward: 1.972, backward: 7.622, update: 1.234
Successfully xmh. training takes 90.95744919776917 seconds
before call kg_cache_controller.StopThreads()
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
INFO [41278 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.766 ms                  | 217.465 ms                |
| bucket keys               | 2.392 ms                  | 5.076 ms                  |
| forward: a2a keys         | 767.946 us                | 9.856 ms                  |
| forward: search cache     | 153.780 us                | 433.683 us                |
| forward: a2a values       | 1.350 ms                  | 3.590 ms                  |
| forward: software         | 826.836 us                | 1.092 ms                  |
| forward: join             | 2.862 ms                  | 4.359 ms                  |
| Forward                   | 18.936 ms                 | 61.971 ms                 |
| back: aggr dram keys      | 25.757 ms                 | 49.347 ms                 |
| back: set dram grad       | 2.815 ms                  | 4.011 ms                  |
| back: a2a grad            | 3.757 ms                  | 5.242 ms                  |
| back: grad sum & grad cache  | 5.276 ms                  | 16.633 ms                 |
| Backward                  | 75.543 ms                 | 109.729 ms                |
| Optimize                  | 12.379 ms                 | 20.567 ms                 |
| BarrierTimeBeforeRank0    | 42.202 us                 | 90.842 us                 |
| BlockToStepN              | 17.572 us                 | 175.275 us                |
| OneStep                   | 117.300 ms                | 350.840 ms                |
+---------------------------+---------------------------+---------------------------+
