WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 21:32:41.899413 11109 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_38', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [11109 sampler.py:454] Start PreSampling
WARNING [11109 sampler.py:532] Before construct renumbering_dict
WARNING [11109 sampler.py:555] PreSampling done
W20240205 21:32:46.347697 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 21:32:46.348011 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 21:32:46.348070 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 21:32:46.348107 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 21:32:46.348151 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 21:32:46.348222 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 21:32:46.348268 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 21:32:46.348315 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 21:32:46.348366 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 21:32:46.348405 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 21:32:46.348446 11109 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 21:32:46.348484 11109 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 21:32:46.348521 11109 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 21:32:46.348763 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 21:32:46.348800 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 21:32:46.348837 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 21:32:46.348883 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 21:32:46.348919 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 21:32:46.348953 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 21:32:46.348990 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 21:32:46.349040 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 21:32:46.349074 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 21:32:46.349107 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 21:32:46.349154 11109 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 21:32:46.349182 11109 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 21:32:46.349217 11109 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 21:32:46.349287 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 21:32:46.349325 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 21:32:46.349356 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 21:32:46.349390 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 21:32:46.349428 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 21:32:46.349458 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 21:32:46.349494 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 21:32:46.349536 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 21:32:46.349576 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 21:32:46.349618 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 21:32:46.349654 11109 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 21:32:46.349684 11109 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 21:32:46.349720 11109 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 21:32:46.349803 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 21:32:46.349850 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 21:32:46.349885 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 21:32:46.349936 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 21:32:46.349970 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 21:32:46.350014 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 21:32:46.350059 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 21:32:46.350109 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 21:32:46.350147 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 21:32:46.350201 11109 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 21:32:46.350232 11109 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 21:32:46.350260 11109 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 21:32:46.350296 11109 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 21:32:46.609656 11109 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240205 21:32:46.703708 11109 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=9703, num_edges=161860,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11374, num_edges=168961,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10715, num_edges=190828,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=11184, num_edges=240046,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9703 N 161860 E
MertisPartition: part 1 has 11374 N 168961 E
MertisPartition: part 2 has 10715 N 190828 E
MertisPartition: part 3 has 11184 N 240046 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Before renumbering graph:  {'_ID': tensor([   6,   10,   11,  ..., 5824, 6189, 2559]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 905, 1064, 1089,  ..., 3729, 5798, 4650]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 4.906 seconds
[Rank1] pid = 11312
[Rank2] pid = 11343
INFO [11109 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [11312 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [11440 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [11343 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [11343 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [11440 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [11109 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [11312 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240205 21:32:48.709399 11441 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240205 21:32:48.709794 11377 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240205 21:32:48.709810 11442 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240205 21:32:48.710352 11313 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240205 21:32:48.741345 11377 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100014878000 7.629 MB
W20240205 21:32:48.741369 11441 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10001501b000 7.629 MB
W20240205 21:32:48.741544 11441 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000157be000 7.629 MB
W20240205 21:32:48.741580 11377 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100015f61000 7.629 MB
W20240205 21:32:48.741600 11441 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100016704000 1.49 GB
W20240205 21:32:48.741648 11441 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x100075ce7000 1.49 GB
W20240205 21:32:48.741683 11377 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1000d52ca000 1.49 GB
W20240205 21:32:48.741701 11441 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 21:32:48.741779 11377 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1001348ad000 1.49 GB
W20240205 21:32:48.741837 11377 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 21:32:48.744971 11441 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 21:32:48.745031 11377 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 21:32:48.750694 11442 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100193e9a000 7.629 MB
W20240205 21:32:48.750927 11442 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10019463f000 7.629 MB
W20240205 21:32:48.751001 11442 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100194de2000 1.49 GB
W20240205 21:32:48.751060 11442 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1001f43c5000 1.49 GB
W20240205 21:32:48.751117 11442 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 21:32:48.751107 11313 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1002539a8000 7.629 MB
W20240205 21:32:48.751242 11313 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10025414b000 7.629 MB
W20240205 21:32:48.751314 11313 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1002548ee000 1.49 GB
W20240205 21:32:48.751415 11313 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1002b3ed1000 1.49 GB
W20240205 21:32:48.751464 11313 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 21:32:48.755056 11313 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 21:32:48.755075 11442 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [11440 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank3] pid = 11440
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [11109 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [11312 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [11343 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 21:32:50.490953 11377 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240205 21:32:50.491029 11441 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240205 21:32:50.491101 11442 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240205 21:32:50.491169 11313 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240205 21:32:50.493748 11441 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 21:32:50.493902 11441 grad_base.h:184] Init GradProcessingBase done
I20240205 21:32:50.497510 11441 grad_async_v1.h:203] Use main thread to update emb.
W20240205 21:32:50.497562 11441 kg_controller.h:75] after init GradAsyncProcessing
I20240205 21:32:50.497577 11441 kg_controller.h:84] Construct KGCacheController done
E20240205 21:32:51.977411 11377 recstore.cc:66] init folly done
E20240205 21:32:51.979072 11442 recstore.cc:66] init folly done
E20240205 21:32:51.979460 11313 recstore.cc:66] init folly done
E20240205 21:32:51.979557 11441 recstore.cc:66] init folly done
I20240205 21:32:51.981202 11441 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 21:32:52.381502 11313 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240205 21:32:52.391124 11441 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240205 21:32:52.399992 11377 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240205 21:32:52.400769 11442 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240205 21:32:53.633877 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=0
E20240205 21:32:53.680619 11441 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
W20240205 21:32:54.633020 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=16, pq.top=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.165 ms                  | 25.174 ms                 |
| Forward                   | 5.388 ms                  | 404.817 ms                |
| Backward                  | 10.083 ms                 | 209.680 ms                |
| Optimize                  | 4.122 ms                  | 51.212 ms                 |
| BarrierTimeBeforeRank0    | 76.245 us                 | 5.226 ms                  |
| AfterBackward             | 12.327 ms                 | 565.657 ms                |
| BlockToStepN              | 52.658 us                 | 506.286 ms                |
| OneStep                   | 35.775 ms                 | 1.239 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 21:32:55.633018 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=18, pq.top=18
W20240205 21:32:56.633016 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=20, pq.top=20
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.437 ms                  | 168.346 ms                |
| ProcessBack:UpdateCache   | 2.607 ms                  | 311.162 ms                |
| ProcessBack:UpsertPq      | 6.678 ms                  | 26.021 ms                 |
| ProcessOneStep            | 13.068 ms                 | 565.263 ms                |
| BlockToStepN              | 663.000 ns                | 578.931 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:32:57.641068 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=24, pq.top=24
W20240205 21:32:58.647838 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=28, pq.top=28
W20240205 21:32:59.647009 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=32, pq.top=32
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.527 ms                  | 29.379 ms                 |
| Forward                   | 5.850 ms                  | 404.817 ms                |
| Backward                  | 10.190 ms                 | 209.680 ms                |
| Optimize                  | 2.690 ms                  | 51.212 ms                 |
| BarrierTimeBeforeRank0    | 42.574 us                 | 19.462 ms                 |
| AfterBackward             | 13.342 ms                 | 565.657 ms                |
| BlockToStepN              | 195.749 ms                | 579.132 ms                |
| OneStep                   | 231.257 ms                | 1.239 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:00.647018 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=36, pq.top=36
W20240205 21:33:01.647006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=40, pq.top=40
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.462 ms                  | 134.926 ms                |
| ProcessBack:UpdateCache   | 2.572 ms                  | 310.410 ms                |
| ProcessBack:UpsertPq      | 7.266 ms                  | 24.870 ms                 |
| ProcessOneStep            | 13.393 ms                 | 565.263 ms                |
| BlockToStepN              | 200.398 ms                | 578.931 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:02.647012 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=44, pq.top=44
W20240205 21:33:03.647006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=48, pq.top=48
W20240205 21:33:04.647013 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=52, pq.top=52
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.649 ms                  | 29.379 ms                 |
| Forward                   | 5.591 ms                  | 12.549 ms                 |
| Backward                  | 10.149 ms                 | 18.613 ms                 |
| Optimize                  | 2.485 ms                  | 8.460 ms                  |
| BarrierTimeBeforeRank0    | 38.321 us                 | 12.458 ms                 |
| AfterBackward             | 13.435 ms                 | 55.780 ms                 |
| BlockToStepN              | 203.436 ms                | 506.286 ms                |
| OneStep                   | 240.333 ms                | 646.525 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:05.647006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240205 21:33:06.647006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=60, pq.top=60
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.457 ms                  | 134.926 ms                |
| ProcessBack:UpdateCache   | 2.596 ms                  | 310.410 ms                |
| ProcessBack:UpsertPq      | 7.409 ms                  | 24.870 ms                 |
| ProcessOneStep            | 13.574 ms                 | 55.741 ms                 |
| BlockToStepN              | 205.077 ms                | 505.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:07.650506 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=64, pq.top=64
W20240205 21:33:08.650007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240205 21:33:09.650019 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.558 ms                  | 29.379 ms                 |
| Forward                   | 5.565 ms                  | 12.549 ms                 |
| Backward                  | 10.162 ms                 | 18.613 ms                 |
| Optimize                  | 2.481 ms                  | 8.460 ms                  |
| BarrierTimeBeforeRank0    | 34.370 us                 | 12.458 ms                 |
| AfterBackward             | 13.719 ms                 | 55.780 ms                 |
| BlockToStepN              | 212.869 ms                | 506.286 ms                |
| OneStep                   | 248.671 ms                | 646.525 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:10.650005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240205 21:33:11.650013 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=78, pq.top=78
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.458 ms                  | 5.469 ms                  |
| ProcessBack:UpdateCache   | 2.572 ms                  | 3.864 ms                  |
| ProcessBack:UpsertPq      | 7.596 ms                  | 18.895 ms                 |
| ProcessOneStep            | 13.698 ms                 | 55.741 ms                 |
| BlockToStepN              | 213.369 ms                | 505.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:12.650012 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240205 21:33:13.650007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240205 21:33:14.650017 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.558 ms                  | 29.379 ms                 |
| Forward                   | 5.591 ms                  | 12.549 ms                 |
| Backward                  | 10.175 ms                 | 18.613 ms                 |
| Optimize                  | 2.505 ms                  | 8.460 ms                  |
| BarrierTimeBeforeRank0    | 31.810 us                 | 12.458 ms                 |
| AfterBackward             | 13.756 ms                 | 55.780 ms                 |
| BlockToStepN              | 215.796 ms                | 506.286 ms                |
| OneStep                   | 257.391 ms                | 646.525 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:15.650004 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=92, pq.top=92
W20240205 21:33:16.650039 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=96, pq.top=96
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.462 ms                  | 5.469 ms                  |
| ProcessBack:UpdateCache   | 2.596 ms                  | 3.864 ms                  |
| ProcessBack:UpsertPq      | 7.647 ms                  | 18.895 ms                 |
| ProcessOneStep            | 13.723 ms                 | 55.741 ms                 |
| BlockToStepN              | 217.869 ms                | 505.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:17.650007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 25.617, sample: 0.425, forward: 0.933, backward: 1.210, update: 0.282
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.637, sample: 0.426, forward: 0.899, backward: 1.187, update: 0.294
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 25.618, sample: 0.421, forward: 0.937, backward: 1.197, update: 0.287
train_sampler.Prefill()
-------Step 0-------
tensor([ 7745,  9422,  6216,  2693,    33,  6862, 10535,    43,  5972, 11351]) tensor([ 1089, 10523,  2916, 14056,  3497,  9323,  1973,  8004,  5620, 13985])
-------Step 1-------
tensor([ 7745,  9422,  6216,  2693,    33,  6862, 10535,    43,  5972, 11351]) tensor([ 2387, 13540,  7295,  7023,  6403,  9168,   841, 11414,   782,  9420])
-------Step 2-------
tensor([10581,    75,  1966,    40,  9451,  3661, 14597,   917, 13506,  4021]) tensor([ 7705,  6536,  2804,  3954,  9349,  6560, 13337, 13878,  9962, 10973])
-------Step 3-------
tensor([10581,    75,  1966,    40,  9451,  3661, 14597,   917, 13506,  4021]) tensor([11423, 10545, 11056,  8681,   733,  4074, 11650,  6899,  3828, 13298])
-------Step 4-------
tensor([   42,  7122, 12532, 11789, 10334,  4930,  8630,  1945, 12994,  3290]) tensor([9676, 1211, 1969, 1462, 7983, 6100,  856, 1800, 3032, 8036])
-------Step 5-------
tensor([   42,  7122, 12532, 11789, 10334,  4930,  8630,  1945, 12994,  3290]) tensor([ 1061, 13103,  1207,  4169,  7316,   136, 14744,  4123,  1964, 11285])
-------Step 6-------
tensor([10648, 13267, 10407,   116,  1146,  6248,   132, 10925,  4369,   168]) tensor([ 8982, 14922,   758,  2884,  2873,  3384,  1174,  2203,  4390, 13945])
-------Step 7-------
tensor([10648, 13267, 10407,   116,  1146,  6248,   132, 10925,  4369,   168]) tensor([11487,  8219, 14340, 10055,  9473,  1656, 11799,  8008,  2009,  9332])
-------Step 8-------
tensor([ 7848,  9419,  5599, 12638,  2584,  5464, 11609, 14568,   117, 10092]) tensor([ 2882,  8928,  8668,   513,  7904,  6217,  7415,  9149,  9003, 13099])
-------Step 9-------
tensor([ 7848,  9419,  5599, 12638,  2584,  5464, 11609, 14568,   117, 10092]) tensor([ 3204,   496,  8161,  9224,  2679,  2507, 13127,  7392,   468, 13403])
before start barrier
start train
[proc 0] 100 steps, total: 25.627, sample: 0.473, forward: 0.977, backward: 1.216, update: 0.324
W20240205 21:33:18.650005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240205 21:33:19.650018 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.525 ms                  | 29.379 ms                 |
| Forward                   | 5.600 ms                  | 12.549 ms                 |
| Backward                  | 10.185 ms                 | 18.613 ms                 |
| Optimize                  | 2.505 ms                  | 8.460 ms                  |
| BarrierTimeBeforeRank0    | 28.574 us                 | 12.458 ms                 |
| AfterBackward             | 13.782 ms                 | 55.780 ms                 |
| BlockToStepN              | 223.172 ms                | 506.286 ms                |
| OneStep                   | 261.314 ms                | 646.525 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:20.650005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=110, pq.top=110
W20240205 21:33:21.683506 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=114, pq.top=114
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.461 ms                  | 5.469 ms                  |
| ProcessBack:UpdateCache   | 2.596 ms                  | 3.864 ms                  |
| ProcessBack:UpsertPq      | 7.696 ms                  | 18.895 ms                 |
| ProcessOneStep            | 13.797 ms                 | 55.741 ms                 |
| BlockToStepN              | 224.358 ms                | 505.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:22.683007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240205 21:33:23.683020 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=120, pq.top=120
W20240205 21:33:24.683007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=124, pq.top=124
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.527 ms                  | 29.379 ms                 |
| Forward                   | 5.591 ms                  | 12.549 ms                 |
| Backward                  | 10.185 ms                 | 18.613 ms                 |
| Optimize                  | 2.486 ms                  | 8.460 ms                  |
| BarrierTimeBeforeRank0    | 28.574 us                 | 12.458 ms                 |
| AfterBackward             | 13.823 ms                 | 55.780 ms                 |
| BlockToStepN              | 227.953 ms                | 506.286 ms                |
| OneStep                   | 269.307 ms                | 646.525 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:25.683013 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240205 21:33:26.705929 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.462 ms                  | 4.101 ms                  |
| ProcessBack:UpdateCache   | 2.600 ms                  | 3.627 ms                  |
| ProcessBack:UpsertPq      | 7.714 ms                  | 18.502 ms                 |
| ProcessOneStep            | 13.797 ms                 | 55.741 ms                 |
| BlockToStepN              | 229.593 ms                | 505.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:27.705006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=134, pq.top=134
W20240205 21:33:28.705022 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240205 21:33:29.705006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.529 ms                  | 29.379 ms                 |
| Forward                   | 5.585 ms                  | 12.549 ms                 |
| Backward                  | 10.175 ms                 | 18.613 ms                 |
| Optimize                  | 2.486 ms                  | 8.460 ms                  |
| BarrierTimeBeforeRank0    | 27.811 us                 | 12.458 ms                 |
| AfterBackward             | 13.899 ms                 | 55.780 ms                 |
| BlockToStepN              | 234.254 ms                | 506.286 ms                |
| OneStep                   | 272.790 ms                | 646.525 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:30.705005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=144, pq.top=144
W20240205 21:33:31.705019 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.469 ms                  | 4.101 ms                  |
| ProcessBack:UpdateCache   | 2.607 ms                  | 3.627 ms                  |
| ProcessBack:UpsertPq      | 7.735 ms                  | 18.502 ms                 |
| ProcessOneStep            | 13.907 ms                 | 55.741 ms                 |
| BlockToStepN              | 236.718 ms                | 505.848 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:32.705005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=150, pq.top=150
W20240205 21:33:33.705014 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240205 21:33:34.734536 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.618 ms                  | 30.387 ms                 |
| Forward                   | 5.584 ms                  | 11.962 ms                 |
| Backward                  | 10.170 ms                 | 13.795 ms                 |
| Optimize                  | 2.485 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 27.095 us                 | 12.458 ms                 |
| AfterBackward             | 13.973 ms                 | 32.496 ms                 |
| BlockToStepN              | 238.092 ms                | 490.848 ms                |
| OneStep                   | 276.202 ms                | 566.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:35.734012 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240205 21:33:36.734012 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.469 ms                  | 4.101 ms                  |
| ProcessBack:UpdateCache   | 2.596 ms                  | 3.627 ms                  |
| ProcessBack:UpsertPq      | 7.735 ms                  | 18.502 ms                 |
| ProcessOneStep            | 13.874 ms                 | 32.440 ms                 |
| BlockToStepN              | 238.873 ms                | 490.399 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:37.734006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240205 21:33:38.734014 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240205 21:33:39.734012 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=172, pq.top=172
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.627 ms                  | 30.387 ms                 |
| Forward                   | 5.565 ms                  | 11.962 ms                 |
| Backward                  | 10.162 ms                 | 13.795 ms                 |
| Optimize                  | 2.485 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 27.861 us                 | 21.456 ms                 |
| AfterBackward             | 13.973 ms                 | 32.496 ms                 |
| BlockToStepN              | 241.160 ms                | 490.848 ms                |
| OneStep                   | 280.038 ms                | 566.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:40.772119 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
W20240205 21:33:41.772013 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.472 ms                  | 3.871 ms                  |
| ProcessBack:UpdateCache   | 2.596 ms                  | 3.510 ms                  |
| ProcessBack:UpsertPq      | 7.777 ms                  | 17.271 ms                 |
| ProcessOneStep            | 13.946 ms                 | 32.440 ms                 |
| BlockToStepN              | 242.070 ms                | 490.399 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:42.772011 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=182, pq.top=182
W20240205 21:33:43.772006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240205 21:33:44.772006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.672 ms                  | 30.387 ms                 |
| Forward                   | 5.554 ms                  | 11.962 ms                 |
| Backward                  | 10.158 ms                 | 13.795 ms                 |
| Optimize                  | 2.481 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 27.861 us                 | 24.304 ms                 |
| AfterBackward             | 13.973 ms                 | 32.496 ms                 |
| BlockToStepN              | 245.083 ms                | 490.848 ms                |
| OneStep                   | 283.476 ms                | 566.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:45.772014 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240205 21:33:46.772006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.472 ms                  | 3.871 ms                  |
| ProcessBack:UpdateCache   | 2.574 ms                  | 3.510 ms                  |
| ProcessBack:UpsertPq      | 7.784 ms                  | 17.271 ms                 |
| ProcessOneStep            | 13.946 ms                 | 32.440 ms                 |
| BlockToStepN              | 245.635 ms                | 490.399 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:47.772006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
[proc 3] 200 steps, total: 30.672, sample: 0.425, forward: 0.503, backward: 1.036, update: 0.239
[proc 2] 200 steps, total: 30.672, sample: 0.434, forward: 0.496, backward: 1.017, update: 0.239
[proc 1] 200 steps, total: 30.672, sample: 0.409, forward: 0.497, backward: 0.996, update: 0.236
[proc 0] 200 steps, total: 30.671, sample: 0.536, forward: 0.535, backward: 0.989, update: 0.248
W20240205 21:33:48.772017 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240205 21:33:49.772006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=204, pq.top=204
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.672 ms                  | 30.387 ms                 |
| Forward                   | 5.531 ms                  | 11.962 ms                 |
| Backward                  | 10.150 ms                 | 13.795 ms                 |
| Optimize                  | 2.467 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 28.282 us                 | 25.105 ms                 |
| AfterBackward             | 13.932 ms                 | 32.496 ms                 |
| BlockToStepN              | 247.772 ms                | 490.848 ms                |
| OneStep                   | 286.634 ms                | 566.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:50.772006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240205 21:33:51.772024 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.472 ms                  | 3.871 ms                  |
| ProcessBack:UpdateCache   | 2.560 ms                  | 3.510 ms                  |
| ProcessBack:UpsertPq      | 7.815 ms                  | 17.271 ms                 |
| ProcessOneStep            | 13.907 ms                 | 32.440 ms                 |
| BlockToStepN              | 247.752 ms                | 490.399 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:52.819744 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240205 21:33:53.819005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240205 21:33:54.819018 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.677 ms                  | 30.387 ms                 |
| Forward                   | 5.502 ms                  | 11.962 ms                 |
| Backward                  | 10.150 ms                 | 13.795 ms                 |
| Optimize                  | 2.460 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 28.620 us                 | 25.105 ms                 |
| AfterBackward             | 13.899 ms                 | 32.496 ms                 |
| BlockToStepN              | 251.351 ms                | 490.848 ms                |
| OneStep                   | 290.687 ms                | 566.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:55.819005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240205 21:33:56.819006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=226, pq.top=226
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.473 ms                  | 3.307 ms                  |
| ProcessBack:UpdateCache   | 2.545 ms                  | 3.434 ms                  |
| ProcessBack:UpsertPq      | 7.822 ms                  | 17.271 ms                 |
| ProcessOneStep            | 13.874 ms                 | 32.440 ms                 |
| BlockToStepN              | 251.617 ms                | 490.399 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:33:57.819020 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240205 21:33:58.819006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240205 21:33:59.819006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.672 ms                  | 30.387 ms                 |
| Forward                   | 5.475 ms                  | 11.962 ms                 |
| Backward                  | 10.150 ms                 | 13.795 ms                 |
| Optimize                  | 2.460 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 28.777 us                 | 25.105 ms                 |
| AfterBackward             | 13.930 ms                 | 32.496 ms                 |
| BlockToStepN              | 253.085 ms                | 490.848 ms                |
| OneStep                   | 293.438 ms                | 566.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:00.819015 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240205 21:34:01.819005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.473 ms                  | 3.307 ms                  |
| ProcessBack:UpdateCache   | 2.527 ms                  | 3.434 ms                  |
| ProcessBack:UpsertPq      | 7.842 ms                  | 17.271 ms                 |
| ProcessOneStep            | 13.874 ms                 | 32.440 ms                 |
| BlockToStepN              | 253.858 ms                | 490.399 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:02.819006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=244, pq.top=244
W20240205 21:34:03.819018 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240205 21:34:04.828809 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.688 ms                  | 30.098 ms                 |
| Forward                   | 5.459 ms                  | 11.744 ms                 |
| Backward                  | 10.150 ms                 | 13.337 ms                 |
| Optimize                  | 2.450 ms                  | 5.305 ms                  |
| BarrierTimeBeforeRank0    | 28.701 us                 | 24.304 ms                 |
| AfterBackward             | 13.973 ms                 | 25.229 ms                 |
| BlockToStepN              | 255.876 ms                | 335.418 ms                |
| OneStep                   | 296.241 ms                | 521.658 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:05.828006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=254, pq.top=254
W20240205 21:34:06.840123 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.472 ms                  | 3.307 ms                  |
| ProcessBack:UpdateCache   | 2.514 ms                  | 3.510 ms                  |
| ProcessBack:UpsertPq      | 7.848 ms                  | 17.271 ms                 |
| ProcessOneStep            | 13.955 ms                 | 25.171 ms                 |
| BlockToStepN              | 256.753 ms                | 335.330 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:07.840009 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240205 21:34:08.840005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240205 21:34:09.840005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=266, pq.top=266
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.691 ms                  | 30.098 ms                 |
| Forward                   | 5.443 ms                  | 11.744 ms                 |
| Backward                  | 10.150 ms                 | 13.337 ms                 |
| Optimize                  | 2.450 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 28.701 us                 | 24.304 ms                 |
| AfterBackward             | 14.033 ms                 | 25.229 ms                 |
| BlockToStepN              | 258.542 ms                | 335.418 ms                |
| OneStep                   | 298.649 ms                | 521.658 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:10.840014 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240205 21:34:11.840009 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.469 ms                  | 3.307 ms                  |
| ProcessBack:UpdateCache   | 2.501 ms                  | 3.510 ms                  |
| ProcessBack:UpsertPq      | 7.890 ms                  | 17.271 ms                 |
| ProcessOneStep            | 14.006 ms                 | 25.171 ms                 |
| BlockToStepN              | 258.619 ms                | 340.209 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:12.840006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240205 21:34:13.840013 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=278, pq.top=278
W20240205 21:34:14.840011 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.698 ms                  | 30.098 ms                 |
| Forward                   | 5.408 ms                  | 11.744 ms                 |
| Backward                  | 10.149 ms                 | 13.337 ms                 |
| Optimize                  | 2.450 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 28.801 us                 | 24.304 ms                 |
| AfterBackward             | 14.047 ms                 | 25.229 ms                 |
| BlockToStepN              | 259.601 ms                | 340.337 ms                |
| OneStep                   | 300.054 ms                | 521.658 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:15.840006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240205 21:34:16.840013 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.469 ms                  | 3.298 ms                  |
| ProcessBack:UpdateCache   | 2.485 ms                  | 3.434 ms                  |
| ProcessBack:UpsertPq      | 7.900 ms                  | 14.759 ms                 |
| ProcessOneStep            | 14.020 ms                 | 25.171 ms                 |
| BlockToStepN              | 260.933 ms                | 386.874 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:17.840008 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=290, pq.top=290
W20240205 21:34:18.841588 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240205 21:34:19.842409 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.696 ms                  | 30.098 ms                 |
| Forward                   | 5.394 ms                  | 11.744 ms                 |
| Backward                  | 10.150 ms                 | 13.337 ms                 |
| Optimize                  | 2.450 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 28.777 us                 | 24.304 ms                 |
| AfterBackward             | 14.052 ms                 | 25.229 ms                 |
| BlockToStepN              | 263.026 ms                | 387.011 ms                |
| OneStep                   | 301.903 ms                | 521.658 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:20.842015 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 3] 300 steps, total: 32.655, sample: 0.389, forward: 0.487, backward: 1.027, update: 0.231
[proc 0] 300 steps, total: 32.655, sample: 0.474, forward: 0.521, backward: 1.003, update: 0.246
[proc 2] 300 steps, total: 32.655, sample: 0.378, forward: 0.488, backward: 0.996, update: 0.227
[proc 1] 300 steps, total: 32.655, sample: 0.370, forward: 0.487, backward: 0.982, update: 0.227
W20240205 21:34:21.842015 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.468 ms                  | 3.307 ms                  |
| ProcessBack:UpdateCache   | 2.476 ms                  | 3.434 ms                  |
| ProcessBack:UpsertPq      | 7.902 ms                  | 14.759 ms                 |
| ProcessOneStep            | 14.020 ms                 | 25.171 ms                 |
| BlockToStepN              | 262.966 ms                | 386.874 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:22.842006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240205 21:34:23.842012 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240205 21:34:24.842011 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.711 ms                  | 32.130 ms                 |
| Forward                   | 5.388 ms                  | 11.744 ms                 |
| Backward                  | 10.150 ms                 | 13.337 ms                 |
| Optimize                  | 2.448 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 28.777 us                 | 24.304 ms                 |
| AfterBackward             | 14.052 ms                 | 25.229 ms                 |
| BlockToStepN              | 264.593 ms                | 387.011 ms                |
| OneStep                   | 303.210 ms                | 521.658 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:25.842005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=314, pq.top=314
W20240205 21:34:26.842005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.465 ms                  | 3.307 ms                  |
| ProcessBack:UpdateCache   | 2.475 ms                  | 3.434 ms                  |
| ProcessBack:UpsertPq      | 7.910 ms                  | 14.759 ms                 |
| ProcessOneStep            | 14.020 ms                 | 25.171 ms                 |
| BlockToStepN              | 264.520 ms                | 386.874 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:27.842013 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240205 21:34:28.842011 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240205 21:34:29.842005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=326, pq.top=326
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.723 ms                  | 32.130 ms                 |
| Forward                   | 5.367 ms                  | 11.744 ms                 |
| Backward                  | 10.149 ms                 | 13.337 ms                 |
| Optimize                  | 2.447 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 28.701 us                 | 24.304 ms                 |
| AfterBackward             | 14.047 ms                 | 25.229 ms                 |
| BlockToStepN              | 265.233 ms                | 387.011 ms                |
| OneStep                   | 306.182 ms                | 521.658 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:30.842005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240205 21:34:31.842017 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=332, pq.top=332
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.466 ms                  | 3.307 ms                  |
| ProcessBack:UpdateCache   | 2.475 ms                  | 3.434 ms                  |
| ProcessBack:UpsertPq      | 7.933 ms                  | 14.731 ms                 |
| ProcessOneStep            | 13.998 ms                 | 25.171 ms                 |
| BlockToStepN              | 265.329 ms                | 386.874 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:32.842008 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240205 21:34:33.842007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=338, pq.top=338
W20240205 21:34:34.842016 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=341, pq.top=341
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.723 ms                  | 32.130 ms                 |
| Forward                   | 5.359 ms                  | 11.744 ms                 |
| Backward                  | 10.150 ms                 | 13.337 ms                 |
| Optimize                  | 2.448 ms                  | 5.380 ms                  |
| BarrierTimeBeforeRank0    | 28.620 us                 | 24.304 ms                 |
| AfterBackward             | 14.059 ms                 | 25.229 ms                 |
| BlockToStepN              | 266.105 ms                | 387.011 ms                |
| OneStep                   | 306.886 ms                | 521.658 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:35.842005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=344, pq.top=344
W20240205 21:34:36.842006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.465 ms                  | 3.307 ms                  |
| ProcessBack:UpdateCache   | 2.471 ms                  | 3.434 ms                  |
| ProcessBack:UpsertPq      | 7.947 ms                  | 14.731 ms                 |
| ProcessOneStep            | 14.020 ms                 | 25.171 ms                 |
| BlockToStepN              | 266.298 ms                | 386.874 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:37.842005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=350, pq.top=350
W20240205 21:34:38.842015 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=354, pq.top=354
W20240205 21:34:39.869347 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=357, pq.top=357
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.723 ms                  | 30.387 ms                 |
| Forward                   | 5.335 ms                  | 9.734 ms                  |
| Backward                  | 10.150 ms                 | 12.005 ms                 |
| Optimize                  | 2.448 ms                  | 5.305 ms                  |
| BarrierTimeBeforeRank0    | 28.282 us                 | 22.769 ms                 |
| AfterBackward             | 14.059 ms                 | 23.602 ms                 |
| BlockToStepN              | 267.883 ms                | 340.337 ms                |
| OneStep                   | 308.140 ms                | 421.894 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:40.869006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240205 21:34:41.869007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=362, pq.top=362
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.465 ms                  | 3.307 ms                  |
| ProcessBack:UpdateCache   | 2.470 ms                  | 3.434 ms                  |
| ProcessBack:UpsertPq      | 7.969 ms                  | 14.759 ms                 |
| ProcessOneStep            | 14.038 ms                 | 23.573 ms                 |
| BlockToStepN              | 267.965 ms                | 340.209 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:42.869014 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240205 21:34:43.869010 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=368, pq.top=368
W20240205 21:34:44.869007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.724 ms                  | 30.387 ms                 |
| Forward                   | 5.335 ms                  | 9.734 ms                  |
| Backward                  | 10.150 ms                 | 12.005 ms                 |
| Optimize                  | 2.448 ms                  | 5.305 ms                  |
| BarrierTimeBeforeRank0    | 28.128 us                 | 24.304 ms                 |
| AfterBackward             | 14.063 ms                 | 23.602 ms                 |
| BlockToStepN              | 268.823 ms                | 343.253 ms                |
| OneStep                   | 309.070 ms                | 421.894 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:45.869006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=374, pq.top=374
W20240205 21:34:46.869006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=377, pq.top=377
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.466 ms                  | 3.298 ms                  |
| ProcessBack:UpdateCache   | 2.464 ms                  | 3.410 ms                  |
| ProcessBack:UpsertPq      | 7.972 ms                  | 14.759 ms                 |
| ProcessOneStep            | 14.040 ms                 | 23.573 ms                 |
| BlockToStepN              | 268.829 ms                | 343.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:47.869014 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=380, pq.top=380
W20240205 21:34:48.869012 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=383, pq.top=383
W20240205 21:34:49.869005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=386, pq.top=386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.723 ms                  | 30.387 ms                 |
| Forward                   | 5.323 ms                  | 9.734 ms                  |
| Backward                  | 10.150 ms                 | 12.005 ms                 |
| Optimize                  | 2.450 ms                  | 5.305 ms                  |
| BarrierTimeBeforeRank0    | 27.870 us                 | 24.304 ms                 |
| AfterBackward             | 14.062 ms                 | 23.602 ms                 |
| BlockToStepN              | 269.324 ms                | 348.695 ms                |
| OneStep                   | 309.673 ms                | 421.894 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:50.869006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=389, pq.top=389
W20240205 21:34:51.869017 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=392, pq.top=392
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.466 ms                  | 3.298 ms                  |
| ProcessBack:UpdateCache   | 2.464 ms                  | 3.410 ms                  |
| ProcessBack:UpsertPq      | 7.974 ms                  | 14.759 ms                 |
| ProcessOneStep            | 14.038 ms                 | 23.573 ms                 |
| BlockToStepN              | 270.344 ms                | 348.632 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:52.869006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=395, pq.top=395
W20240205 21:34:53.872717 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=398, pq.top=398
[proc 1] 400 steps, total: 33.513, sample: 0.392, forward: 0.488, backward: 0.983, update: 0.223
[proc 3] 400 steps, total: 33.514, sample: 0.365, forward: 0.484, backward: 1.025, update: 0.230
[proc 0] 400 steps, total: 33.514, sample: 0.493, forward: 0.509, backward: 1.008, update: 0.251
[proc 2] 400 steps, total: 33.514, sample: 0.344, forward: 0.476, backward: 0.993, update: 0.214
W20240205 21:34:54.896919 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=401, pq.top=401
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.730 ms                  | 30.387 ms                 |
| Forward                   | 5.322 ms                  | 9.734 ms                  |
| Backward                  | 10.150 ms                 | 12.005 ms                 |
| Optimize                  | 2.450 ms                  | 5.305 ms                  |
| BarrierTimeBeforeRank0    | 27.544 us                 | 24.304 ms                 |
| AfterBackward             | 14.062 ms                 | 23.602 ms                 |
| BlockToStepN              | 271.248 ms                | 348.695 ms                |
| OneStep                   | 311.671 ms                | 421.894 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:55.896006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240205 21:34:56.896006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=406, pq.top=406
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.466 ms                  | 3.298 ms                  |
| ProcessBack:UpdateCache   | 2.463 ms                  | 3.410 ms                  |
| ProcessBack:UpsertPq      | 7.988 ms                  | 14.759 ms                 |
| ProcessOneStep            | 14.038 ms                 | 23.573 ms                 |
| BlockToStepN              | 271.429 ms                | 378.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:34:57.896006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240205 21:34:58.896018 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=412, pq.top=412
W20240205 21:34:59.896005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=415, pq.top=415
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.731 ms                  | 30.387 ms                 |
| Forward                   | 5.323 ms                  | 10.249 ms                 |
| Backward                  | 10.149 ms                 | 12.005 ms                 |
| Optimize                  | 2.450 ms                  | 5.305 ms                  |
| BarrierTimeBeforeRank0    | 27.095 us                 | 24.304 ms                 |
| AfterBackward             | 14.063 ms                 | 23.602 ms                 |
| BlockToStepN              | 271.841 ms                | 378.205 ms                |
| OneStep                   | 312.836 ms                | 421.894 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:00.896006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240205 21:35:01.896021 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=420, pq.top=420
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.465 ms                  | 3.298 ms                  |
| ProcessBack:UpdateCache   | 2.461 ms                  | 3.410 ms                  |
| ProcessBack:UpsertPq      | 8.017 ms                  | 14.759 ms                 |
| ProcessOneStep            | 14.040 ms                 | 23.573 ms                 |
| BlockToStepN              | 271.879 ms                | 378.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:02.896006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240205 21:35:03.896005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=426, pq.top=426
W20240205 21:35:04.896019 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=429, pq.top=429
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.735 ms                  | 30.387 ms                 |
| Forward                   | 5.323 ms                  | 10.249 ms                 |
| Backward                  | 10.150 ms                 | 12.005 ms                 |
| Optimize                  | 2.452 ms                  | 5.305 ms                  |
| BarrierTimeBeforeRank0    | 27.095 us                 | 24.304 ms                 |
| AfterBackward             | 14.063 ms                 | 23.602 ms                 |
| BlockToStepN              | 272.590 ms                | 378.205 ms                |
| OneStep                   | 313.563 ms                | 421.894 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:05.896005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=432, pq.top=432
W20240205 21:35:06.896008 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=435, pq.top=435
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.462 ms                  | 3.267 ms                  |
| ProcessBack:UpdateCache   | 2.463 ms                  | 3.384 ms                  |
| ProcessBack:UpsertPq      | 8.025 ms                  | 15.156 ms                 |
| ProcessOneStep            | 14.040 ms                 | 23.573 ms                 |
| BlockToStepN              | 273.400 ms                | 378.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:07.896015 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240205 21:35:08.896010 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240205 21:35:09.896005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=444, pq.top=444
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.733 ms                  | 30.387 ms                 |
| Forward                   | 5.317 ms                  | 10.249 ms                 |
| Backward                  | 10.150 ms                 | 12.255 ms                 |
| Optimize                  | 2.460 ms                  | 5.305 ms                  |
| BarrierTimeBeforeRank0    | 26.968 us                 | 24.304 ms                 |
| AfterBackward             | 14.070 ms                 | 23.602 ms                 |
| BlockToStepN              | 274.147 ms                | 378.205 ms                |
| OneStep                   | 315.056 ms                | 421.894 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:10.921499 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
W20240205 21:35:11.921016 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=450, pq.top=450
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.461 ms                  | 3.267 ms                  |
| ProcessBack:UpdateCache   | 2.464 ms                  | 3.384 ms                  |
| ProcessBack:UpsertPq      | 8.044 ms                  | 15.156 ms                 |
| ProcessOneStep            | 14.049 ms                 | 23.573 ms                 |
| BlockToStepN              | 274.926 ms                | 378.146 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:12.921010 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240205 21:35:13.921006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=456, pq.top=456
W20240205 21:35:14.921018 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=459, pq.top=459
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.736 ms                  | 30.098 ms                 |
| Forward                   | 5.317 ms                  | 9.734 ms                  |
| Backward                  | 10.150 ms                 | 12.005 ms                 |
| Optimize                  | 2.460 ms                  | 5.124 ms                  |
| BarrierTimeBeforeRank0    | 27.095 us                 | 25.105 ms                 |
| AfterBackward             | 14.070 ms                 | 23.164 ms                 |
| BlockToStepN              | 274.975 ms                | 368.711 ms                |
| OneStep                   | 315.113 ms                | 411.744 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:15.921006 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=462, pq.top=462
W20240205 21:35:16.921005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=465, pq.top=465
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.461 ms                  | 3.267 ms                  |
| ProcessBack:UpdateCache   | 2.459 ms                  | 3.384 ms                  |
| ProcessBack:UpsertPq      | 8.047 ms                  | 15.156 ms                 |
| ProcessOneStep            | 14.049 ms                 | 23.109 ms                 |
| BlockToStepN              | 275.021 ms                | 368.629 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:17.921013 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=468, pq.top=468
W20240205 21:35:18.959121 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240205 21:35:19.959005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=474, pq.top=474
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.735 ms                  | 32.130 ms                 |
| Forward                   | 5.309 ms                  | 9.734 ms                  |
| Backward                  | 10.151 ms                 | 12.005 ms                 |
| Optimize                  | 2.467 ms                  | 5.124 ms                  |
| BarrierTimeBeforeRank0    | 27.095 us                 | 25.105 ms                 |
| AfterBackward             | 14.070 ms                 | 23.164 ms                 |
| BlockToStepN              | 275.585 ms                | 368.711 ms                |
| OneStep                   | 316.770 ms                | 411.744 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:20.959005 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240205 21:35:21.959019 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=480, pq.top=480
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.460 ms                  | 3.226 ms                  |
| ProcessBack:UpdateCache   | 2.459 ms                  | 3.373 ms                  |
| ProcessBack:UpsertPq      | 8.055 ms                  | 15.398 ms                 |
| ProcessOneStep            | 14.060 ms                 | 25.171 ms                 |
| BlockToStepN              | 275.564 ms                | 368.629 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:35:22.959007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240205 21:35:23.959007 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240205 21:35:24.959021 11441 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=488, pq.top=488
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.741 ms                  | 32.130 ms                 |
| Forward                   | 5.310 ms                  | 9.734 ms                  |
| Backward                  | 10.152 ms                 | 12.005 ms                 |
| Optimize                  | 2.469 ms                  | 5.124 ms                  |
| BarrierTimeBeforeRank0    | 27.095 us                 | 25.105 ms                 |
| AfterBackward             | 14.078 ms                 | 25.229 ms                 |
| BlockToStepN              | 276.004 ms                | 368.711 ms                |
| OneStep                   | 317.650 ms                | 411.744 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 153.3772099018097 seconds
before call kg_cache_controller.StopThreads()
W20240205 21:35:25.768479 11441 grad_async_v1.h:243] call StopThreads. PID = 11109
W20240205 21:35:25.768501 11441 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 21:35:25.772948 11441 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 21:35:25.772958 11441 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 21:35:25.804948 11441 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.462 ms                  | 3.226 ms                  |
| ProcessBack:UpdateCache   | 2.459 ms                  | 3.373 ms                  |
| ProcessBack:UpsertPq      | 8.057 ms                  | 15.398 ms                 |
| ProcessOneStep            | 14.057 ms                 | 25.171 ms                 |
| BlockToStepN              | 275.863 ms                | 368.629 ms                |
+---------------------------+---------------------------+---------------------------+
