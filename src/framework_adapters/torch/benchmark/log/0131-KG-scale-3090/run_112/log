WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 20:22:22.557883 60020 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_154', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [60020 sampler.py:454] Start PreSampling
WARNING [60020 sampler.py:532] Before construct renumbering_dict
WARNING [60020 sampler.py:555] PreSampling done
W20240205 20:22:27.247303 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 20:22:27.247529 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 20:22:27.247586 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 20:22:27.247625 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 20:22:27.247663 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 20:22:27.247704 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 20:22:27.247753 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 20:22:27.247795 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 20:22:27.247833 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 20:22:27.247875 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 20:22:27.247921 60020 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 20:22:27.247959 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 20:22:27.247994 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 20:22:27.248140 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 20:22:27.248183 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 20:22:27.248224 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 20:22:27.248282 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 20:22:27.248317 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 20:22:27.248370 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 20:22:27.248409 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 20:22:27.248461 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 20:22:27.248505 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 20:22:27.248553 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 20:22:27.248597 60020 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 20:22:27.248628 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 20:22:27.248659 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 20:22:27.248728 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 20:22:27.248785 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 20:22:27.248828 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 20:22:27.248872 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 20:22:27.248907 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 20:22:27.248942 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 20:22:27.248984 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 20:22:27.249025 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 20:22:27.249073 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 20:22:27.249117 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 20:22:27.249152 60020 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 20:22:27.249183 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 20:22:27.249213 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 20:22:27.249279 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 20:22:27.249322 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 20:22:27.249365 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 20:22:27.249401 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 20:22:27.249447 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 20:22:27.249490 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 20:22:27.249526 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 20:22:27.249560 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 20:22:27.249596 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 20:22:27.249632 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 20:22:27.249667 60020 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 20:22:27.249697 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 20:22:27.249727 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 20:22:27.249806 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 20:22:27.249845 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 20:22:27.249881 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 20:22:27.249925 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 20:22:27.249961 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 20:22:27.249996 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 20:22:27.250036 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 20:22:27.250083 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 20:22:27.250128 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 20:22:27.250170 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 20:22:27.250205 60020 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 20:22:27.250236 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 20:22:27.250267 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 20:22:27.250334 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 20:22:27.250380 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 20:22:27.250416 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 20:22:27.250452 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 20:22:27.250490 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 20:22:27.250540 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 20:22:27.250576 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 20:22:27.250615 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 20:22:27.250659 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 20:22:27.250705 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 20:22:27.250741 60020 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 20:22:27.250771 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 20:22:27.250802 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 20:22:27.250866 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 20:22:27.250905 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 20:22:27.250942 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 20:22:27.250978 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 20:22:27.251019 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 20:22:27.251060 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 20:22:27.251106 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 20:22:27.251150 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 20:22:27.251204 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 20:22:27.251250 60020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 20:22:27.251302 60020 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 20:22:27.251333 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 20:22:27.251368 60020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 20:22:27.492682 60020 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x1000216be000 22.81 MB
W20240205 20:22:27.523759 60020 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100022d90000 58.4 kB
{0: Graph(num_nodes=8708, num_edges=114062,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=8851, num_edges=101101,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=6696, num_edges=94778,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10148, num_edges=151271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8972, num_edges=107004,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8551, num_edges=124920,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=9450, num_edges=118501,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8708 N 114062 E
MertisPartition: part 1 has 8851 N 101101 E
MertisPartition: part 2 has 6696 N 94778 E
MertisPartition: part 3 has 10148 N 151271 E
MertisPartition: part 4 has 8972 N 107004 E
MertisPartition: part 5 has 8551 N 124920 E
MertisPartition: part 6 has 9450 N 118501 E
Rank0: cached key size 106
Rank1: cached key size 106
Rank2: cached key size 106
Rank3: cached key size 106
Rank4: cached key size 106
Rank5: cached key size 106
Rank6: cached key size 106
Before renumbering graph:  {'_ID': tensor([    7,    16,    18,  ..., 13890,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 5, 1])}
After renumbering graph:  {'_ID': tensor([  963,  1200,  1255,  ..., 10152,  2280, 10509]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 5, 1])}
part_g: DGLGraph(num_nodes=8708, num_edges=114062,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8708, num_edges=114062,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.000 seconds
[Rank1] pid = 60225
[Rank2] pid = 60256
[Rank3] pid = 60353
[Rank4] pid = 60354
[Rank5] pid = 60434
INFO [60020 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [60225 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [60256 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [60354 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [60353 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [60434 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [60482 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [60482 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60353 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60434 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60225 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
WARNING [60353 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60482 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60434 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60225 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [60354 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60256 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60020 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
WARNING [60354 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60256 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60020 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 20:22:30.030340 60483 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240205 20:22:30.030467 60485 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:22:30.030606 60290 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:22:30.030743 60418 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:22:30.030870 60355 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:22:30.030989 60226 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:22:30.031131 60484 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
E20240205 20:22:30.733762 60290 recstore.cc:66] init folly done
E20240205 20:22:30.734045 60485 recstore.cc:66] init folly done
E20240205 20:22:30.734123 60355 recstore.cc:66] init folly done
E20240205 20:22:30.734469 60418 recstore.cc:66] init folly done
E20240205 20:22:30.734536 60484 recstore.cc:66] init folly done
E20240205 20:22:30.734534 60483 recstore.cc:66] init folly done
E20240205 20:22:30.734544 60226 recstore.cc:66] init folly done
I20240205 20:22:30.817076 60290 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240205 20:22:30.820784 60418 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:22:30.823434 60485 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:22:30.823835 60484 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:22:30.824065 60483 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:22:30.826323 60226 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:22:30.830663 60355 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.197 ms                  | 29.231 ms                 |
| Forward                   | 10.925 ms                 | 660.078 ms                |
| Backward                  | 161.697 ms                | 346.010 ms                |
| Optimize                  | 6.630 ms                  | 9.606 ms                  |
| BarrierTimeBeforeRank0    | 25.668 ms                 | 54.411 ms                 |
| BlockToStepN              | 33.365 us                 | 105.815 us                |
| OneStep                   | 209.680 ms                | 1.071 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.828 ms                  | 29.231 ms                 |
| Forward                   | 10.213 ms                 | 660.078 ms                |
| Backward                  | 159.149 ms                | 346.010 ms                |
| Optimize                  | 5.125 ms                  | 13.036 ms                 |
| BarrierTimeBeforeRank0    | 27.811 ms                 | 54.411 ms                 |
| BlockToStepN              | 33.365 us                 | 353.150 us                |
| OneStep                   | 207.578 ms                | 1.071 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.401 ms                  | 29.033 ms                 |
| Forward                   | 10.084 ms                 | 17.191 ms                 |
| Backward                  | 156.349 ms                | 175.899 ms                |
| Optimize                  | 5.141 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 27.339 ms                 | 49.577 ms                 |
| BlockToStepN              | 32.897 us                 | 323.413 us                |
| OneStep                   | 202.090 ms                | 240.259 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.210 ms                  | 29.033 ms                 |
| Forward                   | 9.949 ms                  | 17.191 ms                 |
| Backward                  | 154.639 ms                | 175.899 ms                |
| Optimize                  | 5.141 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 28.042 ms                 | 49.577 ms                 |
| BlockToStepN              | 31.832 us                 | 323.413 us                |
| OneStep                   | 201.537 ms                | 240.259 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 22.024, sample: 0.668, forward: 1.663, backward: 17.898, update: 0.454
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 22.037, sample: 0.467, forward: 1.445, backward: 16.122, update: 0.456
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 22.028, sample: 0.507, forward: 1.459, backward: 18.321, update: 0.281
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 22.034, sample: 0.599, forward: 1.457, backward: 17.781, update: 0.428
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 22.031, sample: 0.460, forward: 1.516, backward: 17.486, update: 0.302
[Rank6] pid = 60482
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 2885,  4632,  9562, 10227,  5778, 12673,  4246,     1,    47, 11066]) tensor([ 1255,  8017,  1773, 12097,    33, 12342,   316,  4914,  9291, 10296])
-------Step 1-------
tensor([ 2885,  4632,  9562, 10227,  5778, 12673,  4246,     1,    47, 11066]) tensor([12001,  8083,  4684, 13616,  8380,  9378,  1704,  1382,   552, 10077])
-------Step 2-------
tensor([ 3912,  7901,  4721, 14863, 13682,  9554,  4672, 13558,  7842,    33]) tensor([ 3902,  8303, 10766,  5450,  7793, 13873, 13184, 11507, 13403, 12544])
-------Step 3-------
tensor([ 3912,  7901,  4721, 14863, 13682,  9554,  4672, 13558,  7842,    33]) tensor([ 4591, 13660,   566,  5854,  2290,   954,  7031, 11248,  4090, 14426])
-------Step 4-------
tensor([11829,  9337, 11083,  7348,  3624,   983, 13659,  6709, 10713,  2084]) tensor([ 9353,  9584,  2418,  1228, 14127,  8220, 10609,  9207,  2885,  5125])
-------Step 5-------
tensor([11829,  9337, 11083,  7348,  3624,   983, 13659,  6709, 10713,  2084]) tensor([ 4318,  6260,  9224,  6996,  2809, 12621,  8449,  9092,  2007,  3230])
-------Step 6-------
tensor([   41,   913,  9184,  1429,  4437,  3742,  9006, 11171, 11199,    59]) tensor([ 5587,  1296, 10606, 14039,   198,  2422,  6451, 11019,  4918,  4772])
-------Step 7-------
tensor([   41,   913,  9184,  1429,  4437,  3742,  9006, 11171, 11199,    59]) tensor([ 4305, 10894,  5097,  1748, 10805,  3705,  2650,  5240, 11412,    58])
-------Step 8-------
tensor([ 4749, 13482, 14133,   963,  1644,  3157,  2909,  9931,  7409,  2755]) tensor([ 1388,  1005, 12233, 12016,  6549,  8766,  8521, 10773,  7027,  1355])
-------Step 9-------
tensor([ 4749, 13482, 14133,   963,  1644,  3157,  2909,  9931,  7409,  2755]) tensor([4355, 5147, 8822, 8570, 1484, 6775, 9732, 3680, 9566, 6104])
before start barrier
start train
[proc 0] 100 steps, total: 22.030, sample: 0.523, forward: 1.666, backward: 15.427, update: 0.557
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 22.031, sample: 0.495, forward: 1.564, backward: 16.110, update: 0.413
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.108 ms                  | 29.355 ms                 |
| Forward                   | 9.918 ms                  | 17.191 ms                 |
| Backward                  | 154.578 ms                | 175.899 ms                |
| Optimize                  | 5.151 ms                  | 11.940 ms                 |
| BarrierTimeBeforeRank0    | 28.227 ms                 | 289.282 ms                |
| BlockToStepN              | 31.540 us                 | 323.413 us                |
| OneStep                   | 201.537 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.071 ms                  | 35.604 ms                 |
| Forward                   | 9.989 ms                  | 17.191 ms                 |
| Backward                  | 151.120 ms                | 175.899 ms                |
| Optimize                  | 5.125 ms                  | 11.940 ms                 |
| BarrierTimeBeforeRank0    | 30.095 ms                 | 289.282 ms                |
| BlockToStepN              | 31.540 us                 | 323.413 us                |
| OneStep                   | 202.430 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.021 ms                  | 29.355 ms                 |
| Forward                   | 9.949 ms                  | 16.651 ms                 |
| Backward                  | 147.752 ms                | 172.355 ms                |
| Optimize                  | 5.175 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 32.892 ms                 | 289.282 ms                |
| BlockToStepN              | 31.540 us                 | 272.867 us                |
| OneStep                   | 203.434 ms                | 602.942 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.015 ms                  | 33.979 ms                 |
| Forward                   | 9.918 ms                  | 16.651 ms                 |
| Backward                  | 148.808 ms                | 175.899 ms                |
| Optimize                  | 5.175 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 32.892 ms                 | 289.282 ms                |
| BlockToStepN              | 31.396 us                 | 272.867 us                |
| OneStep                   | 203.434 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 200 steps, total: 22.165, sample: 0.458, forward: 0.786, backward: 16.388, update: 0.302
[proc 5] 200 steps, total: 22.165, sample: 0.594, forward: 0.910, backward: 17.247, update: 0.414
[proc 6] 200 steps, total: 22.165, sample: 0.500, forward: 0.893, backward: 17.321, update: 0.314
[proc 1] 200 steps, total: 22.165, sample: 0.499, forward: 0.755, backward: 16.192, update: 0.408
[proc 2] 200 steps, total: 22.165, sample: 0.494, forward: 0.823, backward: 15.751, update: 0.424
[proc 0] 200 steps, total: 22.165, sample: 0.534, forward: 1.021, backward: 15.476, update: 0.573
[proc 3] 200 steps, total: 22.165, sample: 0.611, forward: 0.916, backward: 17.075, update: 0.413
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.016 ms                  | 35.604 ms                 |
| Forward                   | 9.949 ms                  | 16.819 ms                 |
| Backward                  | 149.533 ms                | 175.899 ms                |
| Optimize                  | 5.228 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 31.171 ms                 | 289.282 ms                |
| BlockToStepN              | 30.673 us                 | 272.867 us                |
| OneStep                   | 203.434 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.021 ms                  | 37.615 ms                 |
| Forward                   | 9.949 ms                  | 16.819 ms                 |
| Backward                  | 151.120 ms                | 175.899 ms                |
| Optimize                  | 5.293 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 32.251 ms                 | 289.282 ms                |
| BlockToStepN              | 31.396 us                 | 272.867 us                |
| OneStep                   | 205.528 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.015 ms                  | 37.615 ms                 |
| Forward                   | 9.989 ms                  | 16.819 ms                 |
| Backward                  | 152.282 ms                | 175.899 ms                |
| Optimize                  | 5.357 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 31.720 ms                 | 289.282 ms                |
| BlockToStepN              | 30.673 us                 | 272.867 us                |
| OneStep                   | 205.312 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.015 ms                  | 36.265 ms                 |
| Forward                   | 9.994 ms                  | 16.651 ms                 |
| Backward                  | 152.544 ms                | 175.899 ms                |
| Optimize                  | 5.372 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 31.185 ms                 | 240.248 ms                |
| BlockToStepN              | 30.786 us                 | 254.190 us                |
| OneStep                   | 205.528 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.998 ms                  | 36.265 ms                 |
| Forward                   | 9.995 ms                  | 16.667 ms                 |
| Backward                  | 153.709 ms                | 175.899 ms                |
| Optimize                  | 5.379 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 31.841 ms                 | 240.248 ms                |
| BlockToStepN              | 31.271 us                 | 272.867 us                |
| OneStep                   | 206.039 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 22.621, sample: 0.443, forward: 0.729, backward: 15.889, update: 0.395
[proc 5] 300 steps, total: 22.621, sample: 0.475, forward: 0.838, backward: 16.521, update: 0.356
[proc 2] 300 steps, total: 22.621, sample: 0.351, forward: 0.774, backward: 14.940, update: 0.311
[proc 0] 300 steps, total: 22.621, sample: 0.596, forward: 1.003, backward: 16.568, update: 0.581
[proc 3] 300 steps, total: 22.621, sample: 0.617, forward: 0.981, backward: 17.620, update: 0.415
[proc 6] 300 steps, total: 22.621, sample: 0.600, forward: 0.960, backward: 17.589, update: 0.452
[proc 4] 300 steps, total: 22.621, sample: 0.531, forward: 0.761, backward: 17.031, update: 0.343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.982 ms                  | 36.265 ms                 |
| Forward                   | 9.994 ms                  | 16.667 ms                 |
| Backward                  | 153.709 ms                | 175.899 ms                |
| Optimize                  | 5.293 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 30.562 ms                 | 240.248 ms                |
| BlockToStepN              | 30.865 us                 | 272.867 us                |
| OneStep                   | 205.749 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.987 ms                  | 37.615 ms                 |
| Forward                   | 9.994 ms                  | 16.667 ms                 |
| Backward                  | 153.355 ms                | 175.899 ms                |
| Optimize                  | 5.191 ms                  | 9.768 ms                  |
| BarrierTimeBeforeRank0    | 29.715 ms                 | 240.248 ms                |
| BlockToStepN              | 30.864 us                 | 272.867 us                |
| OneStep                   | 205.528 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.963 ms                  | 36.265 ms                 |
| Forward                   | 10.056 ms                 | 16.651 ms                 |
| Backward                  | 154.092 ms                | 175.503 ms                |
| Optimize                  | 5.125 ms                  | 9.745 ms                  |
| BarrierTimeBeforeRank0    | 30.172 ms                 | 209.396 ms                |
| BlockToStepN              | 30.864 us                 | 268.997 us                |
| OneStep                   | 205.609 ms                | 602.942 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.959 ms                  | 36.265 ms                 |
| Forward                   | 10.063 ms                 | 16.651 ms                 |
| Backward                  | 154.678 ms                | 175.503 ms                |
| Optimize                  | 5.100 ms                  | 9.745 ms                  |
| BarrierTimeBeforeRank0    | 30.172 ms                 | 209.396 ms                |
| BlockToStepN              | 30.788 us                 | 268.997 us                |
| OneStep                   | 205.787 ms                | 602.942 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 400 steps, total: 21.059, sample: 0.564, forward: 0.875, backward: 16.129, update: 0.386
[proc 6] 400 steps, total: 21.059, sample: 0.602, forward: 0.906, backward: 17.192, update: 0.400
[proc 3] 400 steps, total: 21.059, sample: 0.591, forward: 0.931, backward: 17.173, update: 0.428
[proc 4] 400 steps, total: 21.059, sample: 0.557, forward: 0.893, backward: 17.395, update: 0.428
[proc 1] 400 steps, total: 21.059, sample: 0.413, forward: 0.712, backward: 15.315, update: 0.322
[proc 0] 400 steps, total: 21.059, sample: 0.518, forward: 1.016, backward: 15.645, update: 0.449
[proc 2] 400 steps, total: 21.059, sample: 0.451, forward: 0.786, backward: 14.419, update: 0.358
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.950 ms                  | 36.265 ms                 |
| Forward                   | 10.083 ms                 | 16.651 ms                 |
| Backward                  | 154.818 ms                | 175.503 ms                |
| Optimize                  | 5.014 ms                  | 9.745 ms                  |
| BarrierTimeBeforeRank0    | 30.095 ms                 | 209.396 ms                |
| BlockToStepN              | 30.865 us                 | 268.997 us                |
| OneStep                   | 205.609 ms                | 602.942 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.935 ms                  | 37.615 ms                 |
| Forward                   | 10.068 ms                 | 16.651 ms                 |
| Backward                  | 154.590 ms                | 175.899 ms                |
| Optimize                  | 4.995 ms                  | 9.745 ms                  |
| BarrierTimeBeforeRank0    | 30.095 ms                 | 240.248 ms                |
| BlockToStepN              | 31.271 us                 | 268.997 us                |
| OneStep                   | 205.609 ms                | 602.942 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.935 ms                  | 37.615 ms                 |
| Forward                   | 10.063 ms                 | 16.651 ms                 |
| Backward                  | 154.578 ms                | 176.308 ms                |
| Optimize                  | 4.944 ms                  | 9.745 ms                  |
| BarrierTimeBeforeRank0    | 29.403 ms                 | 289.282 ms                |
| BlockToStepN              | 30.975 us                 | 268.997 us                |
| OneStep                   | 205.749 ms                | 602.942 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.923 ms                  | 36.265 ms                 |
| Forward                   | 10.056 ms                 | 16.626 ms                 |
| Backward                  | 154.590 ms                | 175.899 ms                |
| Optimize                  | 4.929 ms                  | 9.732 ms                  |
| BarrierTimeBeforeRank0    | 28.507 ms                 | 240.248 ms                |
| BlockToStepN              | 30.922 us                 | 254.190 us                |
| OneStep                   | 205.528 ms                | 560.229 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.915 ms                  | 36.265 ms                 |
| Forward                   | 10.031 ms                 | 16.626 ms                 |
| Backward                  | 154.678 ms                | 175.899 ms                |
| Optimize                  | 4.901 ms                  | 9.732 ms                  |
| BarrierTimeBeforeRank0    | 28.042 ms                 | 240.248 ms                |
| BlockToStepN              | 30.975 us                 | 254.190 us                |
| OneStep                   | 205.077 ms                | 560.229 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 21.701, sample: 0.388, forward: 0.801, backward: 14.397, update: 0.343
[proc 5] 500 steps, total: 21.701, sample: 0.488, forward: 0.867, backward: 15.963, update: 0.391
[proc 6] 500 steps, total: 21.701, sample: 0.549, forward: 0.910, backward: 16.920, update: 0.361
[proc 0] 500 steps, total: 21.701, sample: 0.502, forward: 0.974, backward: 15.959, update: 0.448
[proc 1] 500 steps, total: 21.701, sample: 0.429, forward: 0.726, backward: 15.598, update: 0.343
Successfully xmh. training takes 109.57751560211182 seconds
before call kg_cache_controller.StopThreads()
[proc 3] 500 steps, total: 21.701, sample: 0.643, forward: 0.941, backward: 17.205, update: 0.418
[proc 4] 500 steps, total: 21.701, sample: 0.652, forward: 0.918, backward: 17.344, update: 0.428
INFO [60020 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
INFO [60020 controller_process.py:421] call rank0 to StopThreads
