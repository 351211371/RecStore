WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 07:47:27.225138 25323 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_138', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [25323 sampler.py:454] Start PreSampling
WARNING [25323 sampler.py:532] Before construct renumbering_dict
WARNING [25323 sampler.py:555] PreSampling done
W20240206 08:07:37.720408 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 08:07:37.720605 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 08:07:37.720646 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 08:07:37.720672 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 08:07:37.720710 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 08:07:37.720744 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 08:07:37.720784 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 08:07:37.720831 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 08:07:37.720865 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 08:07:37.720899 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 08:07:37.720937 25323 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 08:07:37.720961 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 08:07:37.720986 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 08:07:37.721151 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 08:07:37.721184 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 08:07:37.721216 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 08:07:37.721261 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 08:07:37.721294 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 08:07:37.721326 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 08:07:37.721361 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 08:07:37.721395 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 08:07:37.721431 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 08:07:37.721467 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 08:07:37.721500 25323 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 08:07:37.721524 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 08:07:37.721552 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 08:07:37.721613 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 08:07:37.721649 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 08:07:37.721678 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 08:07:37.721709 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 08:07:37.721737 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 08:07:37.721777 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 08:07:37.721810 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 08:07:37.721856 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 08:07:37.721884 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 08:07:37.721915 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 08:07:37.721946 25323 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 08:07:37.721967 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 08:07:37.721990 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 08:07:37.722048 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 08:07:37.722079 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 08:07:37.722110 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 08:07:37.722139 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 08:07:37.722167 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 08:07:37.722199 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 08:07:37.722229 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 08:07:37.722265 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 08:07:37.722304 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 08:07:37.722330 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 08:07:37.722360 25323 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 08:07:37.722384 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 08:07:37.722411 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 08:07:37.722472 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 08:07:37.722501 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 08:07:37.722527 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 08:07:37.722558 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 08:07:37.722589 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 08:07:37.722622 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 08:07:37.722656 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 08:07:37.722693 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 08:07:37.722726 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 08:07:37.722754 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 08:07:37.722781 25323 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 08:07:37.722805 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 08:07:37.722838 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 08:07:37.722905 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 08:07:37.722946 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 08:07:37.722975 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 08:07:37.723007 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 08:07:37.723038 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 08:07:37.723067 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 08:07:37.723098 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 08:07:37.723127 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 08:07:37.723160 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 08:07:37.723189 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 08:07:37.723222 25323 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 08:07:37.723245 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 08:07:37.723269 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 08:07:37.723317 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 08:07:37.723352 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 08:07:37.723382 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 08:07:37.723413 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 08:07:37.723440 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 08:07:37.723471 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 08:07:37.723501 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 08:07:37.723537 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 08:07:37.723565 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 08:07:37.723600 25323 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 08:07:37.723631 25323 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 08:07:37.723656 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 08:07:37.723680 25323 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 08:07:38.132897 25323 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000216be000 128.2 GB
W20240206 08:16:08.883064 25323 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020302f6000 328.3 MB
{0: Graph(num_nodes=15380073, num_edges=42467395,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=16359015, num_edges=65830196,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16649310, num_edges=43584356,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=13918614, num_edges=50952482,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14713191, num_edges=52450022,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14150782, num_edges=58077216,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=21311359, num_edges=64967677,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 15380073 N 42467395 E
MertisPartition: part 1 has 16359015 N 65830196 E
MertisPartition: part 2 has 16649310 N 43584356 E
MertisPartition: part 3 has 13918614 N 50952482 E
MertisPartition: part 4 has 14713191 N 52450022 E
MertisPartition: part 5 has 14150782 N 58077216 E
MertisPartition: part 6 has 21311359 N 64967677 E
Rank0: cached key size 614672
Rank1: cached key size 614672
Rank2: cached key size 614672
Rank3: cached key size 614672
Rank4: cached key size 614672
Rank5: cached key size 614672
Rank6: cached key size 614672
Before renumbering graph:  {'_ID': tensor([     239,      240,      329,  ..., 86019793, 84488282, 82976992]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4308736,  4308765,  4311048,  ..., 85888409, 42649924, 83051799]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2222.800 seconds
[Rank1] pid = 26451
[Rank2] pid = 26545
[Rank3] pid = 26613
[Rank4] pid = 26682
[Rank5] pid = 26749
INFO [25323 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [26451 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [26545 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [26613 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [26749 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [26816 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [26682 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [25323 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [26545 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [26749 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [26816 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [26451 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [26682 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [26613 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
W20240206 08:24:40.267774 26817 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240206 08:24:40.269227 26750 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240206 08:24:40.269306 26884 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240206 08:24:40.269312 26614 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240206 08:24:40.269318 26546 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240206 08:24:40.269325 26452 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240206 08:24:40.269323 26683 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240206 08:24:40.343241 26683 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1020452ee000 7.629 MB
W20240206 08:24:40.343247 26750 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102046234000 7.629 MB
W20240206 08:24:40.343243 26884 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x102045a91000 7.629 MB
W20240206 08:24:40.343230 26546 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102044b4b000 7.629 MB
W20240206 08:24:40.343362 26817 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1020469d7000 7.629 MB
W20240206 08:24:40.343381 26614 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204717a000 7.629 MB
W20240206 08:24:40.343390 26452 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204791d000 7.629 MB
W20240206 08:24:40.343458 26683 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1020480c0000 7.629 MB
W20240206 08:24:40.343462 26884 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x102048863000 7.629 MB
W20240206 08:24:40.343466 26750 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102049006000 7.629 MB
W20240206 08:24:40.343480 26546 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1020497a9000 7.629 MB
W20240206 08:24:40.343498 26817 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102049f4c000 7.629 MB
W20240206 08:24:40.343549 26614 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10204a6ef000 7.629 MB
W20240206 08:24:40.343554 26452 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10204ae92000 7.629 MB
W20240206 08:24:40.343571 26750 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10204b635000 1.49 GB
W20240206 08:24:40.343578 26546 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1020aac18000 1.49 GB
W20240206 08:24:40.343587 26884 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10210a1fb000 1.49 GB
W20240206 08:24:40.343590 26817 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1021697de000 1.49 GB
W20240206 08:24:40.343597 26683 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1021c8dc1000 1.49 GB
W20240206 08:24:40.343632 26817 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1022283a4000 1.49 GB
W20240206 08:24:40.343657 26452 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102287987000 1.49 GB
W20240206 08:24:40.343664 26546 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022e6f6a000 1.49 GB
W20240206 08:24:40.343670 26750 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10234654d000 1.49 GB
W20240206 08:24:40.343684 26884 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1023a5b30000 1.49 GB
W20240206 08:24:40.343688 26817 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 08:24:40.343698 26614 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102405113000 1.49 GB
W20240206 08:24:40.343715 26683 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1024646f6000 1.49 GB
W20240206 08:24:40.343739 26452 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1024c3cd9000 1.49 GB
W20240206 08:24:40.343750 26546 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 08:24:40.343750 26884 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240206 08:24:40.343760 26614 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1025232bc000 1.49 GB
W20240206 08:24:40.343768 26750 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240206 08:24:40.343776 26683 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 08:24:40.343789 26452 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 08:24:40.343806 26614 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 08:24:40.355202 26817 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 08:24:40.355206 26546 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 08:24:40.355324 26884 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240206 08:24:40.355330 26683 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 08:24:40.355347 26614 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 08:24:40.355350 26452 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 08:24:40.355365 26750 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x1000216be000
6: KnownLocalCachedEmbedding init done
WARNING [26816 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
5: KnownLocalCachedEmbedding init done
WARNING [26749 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
4: KnownLocalCachedEmbedding init done
WARNING [26682 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
3: KnownLocalCachedEmbedding init done
WARNING [26613 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
1: KnownLocalCachedEmbedding init done
WARNING [26451 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
2: KnownLocalCachedEmbedding init done
WARNING [26545 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank6] pid = 26816
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949)]
cudaHostRegister 0x1000216be000
0: KnownLocalCachedEmbedding init done
WARNING [25323 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 08:25:25.464895 26817 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240206 08:25:25.465304 26884 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 08:25:25.465415 26546 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 08:25:25.465503 26683 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 08:25:25.465685 26614 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 08:25:25.465804 26452 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 08:25:25.465922 26750 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
W20240206 08:25:25.468205 26817 grad_base.h:55] KGCacheController, config={
        "num_gpus": 7,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240206 08:25:25.468396 26817 grad_base.h:184] Init GradProcessingBase done
I20240206 08:25:37.774047 26817 grad_async_v1.h:203] Use main thread to update emb.
W20240206 08:25:37.774227 26817 kg_controller.h:75] after init GradAsyncProcessing
I20240206 08:25:37.774236 26817 kg_controller.h:84] Construct KGCacheController done
E20240206 08:25:39.432777 26817 recstore.cc:66] init folly done
E20240206 08:25:39.432781 26452 recstore.cc:66] init folly done
E20240206 08:25:39.432814 26683 recstore.cc:66] init folly done
E20240206 08:25:39.432827 26884 recstore.cc:66] init folly done
E20240206 08:25:39.432878 26546 recstore.cc:66] init folly done
E20240206 08:25:39.432960 26750 recstore.cc:66] init folly done
E20240206 08:25:39.433004 26614 recstore.cc:66] init folly done
I20240206 08:25:39.434015 26817 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240206 08:25:59.248112 26817 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240206 08:25:59.297374 26546 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 08:26:00.394858 26614 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 08:26:00.417340 26683 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 08:26:01.265417 26750 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 08:26:02.346033 26884 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 08:26:02.655822 26452 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 252.123 ms                | 285.654 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:04.787344 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.202 ms                 | 22.202 ms                 |
| Forward                   | 753.816 ms                | 753.816 ms                |
| Backward                  | 214.425 ms                | 214.425 ms                |
| Optimize                  | 4.820 ms                  | 4.820 ms                  |
| BarrierTimeBeforeRank0    | 4.182 ms                  | 4.182 ms                  |
| AfterBackward             | 1.131 s                   | 1.131 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:05.787009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240206 08:26:06.787016 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240206 08:26:07.787009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240206 08:26:08.787006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.820 ms                  | 285.654 ms                |
| ProcessBack:UpdateCache   | 8.522 ms                  | 569.027 ms                |
| ProcessBack:UpsertPq      | 32.891 ms                 | 77.677 ms                 |
| ProcessOneStep            | 50.144 ms                 | 1.131 s                   |
| BlockToStepN              | 3.740 ms                  | 721.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:09.787006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.635 ms                  | 100.282 ms                |
| Forward                   | 5.019 ms                  | 753.816 ms                |
| Backward                  | 10.294 ms                 | 214.425 ms                |
| Optimize                  | 4.732 ms                  | 5.810 ms                  |
| BarrierTimeBeforeRank0    | 52.732 us                 | 79.844 ms                 |
| AfterBackward             | 50.194 ms                 | 1.131 s                   |
| BlockToStepN              | 3.815 ms                  | 723.656 ms                |
| OneStep                   | 136.122 ms                | 2.856 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:10.787007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240206 08:26:11.787006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240206 08:26:12.787006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240206 08:26:13.787007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.405 ms                  | 285.654 ms                |
| ProcessBack:UpdateCache   | 7.831 ms                  | 569.027 ms                |
| ProcessBack:UpsertPq      | 30.475 ms                 | 77.677 ms                 |
| ProcessOneStep            | 47.690 ms                 | 1.131 s                   |
| BlockToStepN              | 3.740 ms                  | 721.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:14.787005 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.967 ms                  | 100.282 ms                |
| Forward                   | 5.087 ms                  | 753.816 ms                |
| Backward                  | 10.233 ms                 | 214.425 ms                |
| Optimize                  | 4.732 ms                  | 5.810 ms                  |
| BarrierTimeBeforeRank0    | 745.286 us                | 93.862 ms                 |
| AfterBackward             | 47.719 ms                 | 1.131 s                   |
| BlockToStepN              | 3.815 ms                  | 723.656 ms                |
| OneStep                   | 220.795 ms                | 2.856 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:15.787007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240206 08:26:16.787009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240206 08:26:17.787019 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240206 08:26:18.787007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.322 ms                  | 252.123 ms                |
| ProcessBack:UpdateCache   | 8.123 ms                  | 568.119 ms                |
| ProcessBack:UpsertPq      | 28.557 ms                 | 58.606 ms                 |
| ProcessOneStep            | 47.087 ms                 | 1.131 s                   |
| BlockToStepN              | 3.740 ms                  | 721.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:19.787005 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.757 ms                  | 100.282 ms                |
| Forward                   | 5.115 ms                  | 753.816 ms                |
| Backward                  | 10.222 ms                 | 214.425 ms                |
| Optimize                  | 4.221 ms                  | 5.810 ms                  |
| BarrierTimeBeforeRank0    | 2.526 ms                  | 93.862 ms                 |
| AfterBackward             | 47.123 ms                 | 1.131 s                   |
| BlockToStepN              | 3.815 ms                  | 723.656 ms                |
| OneStep                   | 220.795 ms                | 2.856 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:20.787009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240206 08:26:21.787009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240206 08:26:22.787009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240206 08:26:23.869976 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.367 ms                  | 252.123 ms                |
| ProcessBack:UpdateCache   | 8.108 ms                  | 568.119 ms                |
| ProcessBack:UpsertPq      | 30.792 ms                 | 90.434 ms                 |
| ProcessOneStep            | 48.353 ms                 | 1.131 s                   |
| BlockToStepN              | 3.740 ms                  | 721.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:24.869007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.481 ms                  | 100.282 ms                |
| Forward                   | 5.087 ms                  | 753.816 ms                |
| Backward                  | 10.246 ms                 | 214.425 ms                |
| Optimize                  | 3.856 ms                  | 5.810 ms                  |
| BarrierTimeBeforeRank0    | 2.526 ms                  | 121.561 ms                |
| AfterBackward             | 48.695 ms                 | 1.131 s                   |
| BlockToStepN              | 582.053 ms                | 723.656 ms                |
| OneStep                   | 679.223 ms                | 2.856 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:25.869035 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240206 08:26:26.869007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240206 08:26:27.869009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240206 08:26:28.869007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.448 ms                  | 252.123 ms                |
| ProcessBack:UpdateCache   | 7.831 ms                  | 568.119 ms                |
| ProcessBack:UpsertPq      | 31.618 ms                 | 90.434 ms                 |
| ProcessOneStep            | 48.663 ms                 | 131.606 ms                |
| BlockToStepN              | 3.740 ms                  | 710.107 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:29.869007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.166 ms                  | 100.282 ms                |
| Forward                   | 5.145 ms                  | 20.939 ms                 |
| Backward                  | 10.326 ms                 | 13.611 ms                 |
| Optimize                  | 2.810 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 1.269 ms                  | 93.862 ms                 |
| AfterBackward             | 48.695 ms                 | 131.653 ms                |
| BlockToStepN              | 3.815 ms                  | 710.197 ms                |
| OneStep                   | 241.069 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:30.955072 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240206 08:26:31.955008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240206 08:26:32.955008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240206 08:26:33.955008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.448 ms                  | 252.123 ms                |
| ProcessBack:UpdateCache   | 7.737 ms                  | 568.119 ms                |
| ProcessBack:UpsertPq      | 30.475 ms                 | 90.434 ms                 |
| ProcessOneStep            | 47.884 ms                 | 131.606 ms                |
| BlockToStepN              | 3.740 ms                  | 710.107 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:35.197150 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.272 ms                  | 245.120 ms                |
| Forward                   | 5.115 ms                  | 20.939 ms                 |
| Backward                  | 10.422 ms                 | 13.611 ms                 |
| Optimize                  | 2.776 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 745.286 us                | 93.862 ms                 |
| AfterBackward             | 47.869 ms                 | 131.653 ms                |
| BlockToStepN              | 3.815 ms                  | 710.197 ms                |
| OneStep                   | 241.069 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:36.197005 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240206 08:26:37.197007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240206 08:26:38.197008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240206 08:26:39.197007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.422 ms                  | 30.367 ms                 |
| ProcessBack:UpdateCache   | 7.711 ms                  | 12.216 ms                 |
| ProcessBack:UpsertPq      | 30.075 ms                 | 77.677 ms                 |
| ProcessOneStep            | 47.802 ms                 | 131.606 ms                |
| BlockToStepN              | 3.740 ms                  | 710.107 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:40.197007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.492 ms                  | 245.120 ms                |
| Forward                   | 5.087 ms                  | 20.939 ms                 |
| Backward                  | 10.468 ms                 | 13.611 ms                 |
| Optimize                  | 2.776 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 745.286 us                | 93.862 ms                 |
| AfterBackward             | 47.836 ms                 | 131.653 ms                |
| BlockToStepN              | 3.815 ms                  | 710.197 ms                |
| OneStep                   | 241.069 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:41.197006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240206 08:26:42.197006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240206 08:26:43.197010 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240206 08:26:44.197006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.420 ms                  | 30.367 ms                 |
| ProcessBack:UpdateCache   | 7.694 ms                  | 12.216 ms                 |
| ProcessBack:UpsertPq      | 30.740 ms                 | 81.175 ms                 |
| ProcessOneStep            | 48.072 ms                 | 131.606 ms                |
| BlockToStepN              | 3.740 ms                  | 710.107 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:45.197007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.567 ms                  | 245.120 ms                |
| Forward                   | 5.125 ms                  | 32.030 ms                 |
| Backward                  | 10.524 ms                 | 15.515 ms                 |
| Optimize                  | 2.758 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 1.269 ms                  | 120.192 ms                |
| AfterBackward             | 48.383 ms                 | 131.653 ms                |
| BlockToStepN              | 3.815 ms                  | 710.197 ms                |
| OneStep                   | 241.069 ms                | 1.057 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:46.197007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240206 08:26:47.344985 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 45.751, sample: 1.935, forward: 1.128, backward: 0.709, update: 0.230
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 48.800, sample: 1.807, forward: 1.276, backward: 1.191, update: 0.289
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 46.832, sample: 1.357, forward: 1.191, backward: 0.748, update: 0.238
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 45.442, sample: 1.812, forward: 1.227, backward: 1.208, update: 0.253
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 47.703, sample: 1.318, forward: 1.254, backward: 1.109, update: 0.262
train_sampler.Prefill()
-------Step 0-------
tensor([ 4311073,   299803,   299838,   299867,   328399,   432796, 26028008,
          328432,   328447,    30777]) tensor([ 9939520, 28916747, 72156174, 62141837, 76290156, 43941351, 38254911,
        37611351, 74691645, 47563085])
-------Step 1-------
tensor([ 4311073,   299803,   299838,   299867,   328399,   432796, 26028008,
          328432,   328447,    30777]) tensor([39903320, 16896281, 20113682, 13693909, 53926056, 33945751, 77047650,
        18886407, 18153884, 34438383])
-------Step 2-------
tensor([  391794,   310921,   391821,   391846,   391878, 26028477,   446192,
          391908,   446219,   391938]) tensor([34621141,  7298518, 80033043,  1449880, 61183788, 21161874, 72154996,
           25095, 35544521, 82098083])
-------Step 3-------
tensor([  391794,   310921,   391821,   391846,   391878, 26028477,   446192,
          391908,   446219,   391938]) tensor([49623599, 10054494, 29482336,     6071, 48264177, 52589677, 55518902,
        66986397, 58358818, 79953086])
-------Step 4-------
tensor([  459565,   321982,   455037,   459592, 26028008,   237717,   322023,
        39762726,   455054,  4638850]) tensor([85153789, 52449583, 48560836, 10818477, 43863600, 35900251, 14189898,
        53042676, 78935653, 28804286])
-------Step 5-------
tensor([  459565,   321982,   455037,   459592, 26028008,   237717,   322023,
        39762726,   455054,  4638850]) tensor([35630732, 26726683, 10311649, 63777543, 55147812, 59438301,  8628821,
        75964408, 74707348, 64564818])
-------Step 6-------
tensor([ 505163, 4311073,    2630,    2661,   89062,  331394,    2688,    2715,
           2739,    2767]) tensor([46014667, 25750444, 70110655, 39198730, 73170624, 40201178, 36125329,
        46787473, 12815546, 54807470])
-------Step 7-------
tensor([ 505163, 4311073,    2630,    2661,   89062,  331394,    2688,    2715,
           2739,    2767]) tensor([40115527,  5451328, 80280707, 40182641, 76959312, 44698273,  6111355,
        18084898, 28362424,  4746938])
-------Step 8-------
tensor([  506718,    66712,    66736,    66765, 74489926,  4311073,    66798,
         4625019,   487925,    66842]) tensor([73946543,  9676527, 58800560, 70020930, 34034440, 47846606,  4867495,
        29852203, 26621319,   167650])
-------Step 9-------
tensor([  506718,    66712,    66736,    66765, 74489926,  4311073,    66798,
         4625019,   487925,    66842]) tensor([19455413, 18109977, 70752182, 49599523, 38173570, 16270036, 46469574,
        15240841, 71365156, 72790910])
before start barrier
start train
[proc 0] 100 steps, total: 48.849, sample: 2.347, forward: 1.319, backward: 1.270, update: 0.334
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 47.680, sample: 2.223, forward: 1.226, backward: 1.182, update: 0.244
W20240206 08:26:48.344007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240206 08:26:49.344007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.443 ms                  | 30.367 ms                 |
| ProcessBack:UpdateCache   | 7.694 ms                  | 12.216 ms                 |
| ProcessBack:UpsertPq      | 31.498 ms                 | 90.434 ms                 |
| ProcessOneStep            | 48.663 ms                 | 131.606 ms                |
| BlockToStepN              | 3.740 ms                  | 710.107 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:50.344008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.181 ms                  | 251.193 ms                |
| Forward                   | 5.128 ms                  | 32.030 ms                 |
| Backward                  | 10.524 ms                 | 15.515 ms                 |
| Optimize                  | 2.713 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 71.605 us                 | 120.192 ms                |
| AfterBackward             | 48.695 ms                 | 131.653 ms                |
| BlockToStepN              | 3.815 ms                  | 710.197 ms                |
| OneStep                   | 241.069 ms                | 1.059 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:51.344009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240206 08:26:52.344008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240206 08:26:53.391953 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240206 08:26:54.391006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.448 ms                  | 30.367 ms                 |
| ProcessBack:UpdateCache   | 7.613 ms                  | 12.216 ms                 |
| ProcessBack:UpsertPq      | 31.214 ms                 | 90.434 ms                 |
| ProcessOneStep            | 48.456 ms                 | 131.606 ms                |
| BlockToStepN              | 3.740 ms                  | 710.107 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:55.391006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.181 ms                  | 251.193 ms                |
| Forward                   | 5.115 ms                  | 32.030 ms                 |
| Backward                  | 10.432 ms                 | 15.515 ms                 |
| Optimize                  | 2.705 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 59.536 us                 | 120.192 ms                |
| AfterBackward             | 48.446 ms                 | 131.653 ms                |
| BlockToStepN              | 3.815 ms                  | 710.197 ms                |
| OneStep                   | 241.069 ms                | 1.059 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:26:56.391006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240206 08:26:57.391008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240206 08:26:58.391007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240206 08:26:59.410482 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.428 ms                  | 27.037 ms                 |
| ProcessBack:UpdateCache   | 7.688 ms                  | 12.154 ms                 |
| ProcessBack:UpsertPq      | 30.210 ms                 | 85.548 ms                 |
| ProcessOneStep            | 47.884 ms                 | 131.606 ms                |
| BlockToStepN              | 3.740 ms                  | 710.107 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:00.431377 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.354 ms                  | 251.193 ms                |
| Forward                   | 5.064 ms                  | 32.030 ms                 |
| Backward                  | 10.398 ms                 | 15.515 ms                 |
| Optimize                  | 2.705 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 112.479 us                | 121.561 ms                |
| AfterBackward             | 48.106 ms                 | 131.653 ms                |
| BlockToStepN              | 3.815 ms                  | 710.197 ms                |
| OneStep                   | 241.069 ms                | 1.059 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:01.431007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240206 08:27:02.431007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240206 08:27:03.431008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240206 08:27:04.431008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.434 ms                  | 27.037 ms                 |
| ProcessBack:UpdateCache   | 7.711 ms                  | 12.154 ms                 |
| ProcessBack:UpsertPq      | 29.847 ms                 | 85.548 ms                 |
| ProcessOneStep            | 48.004 ms                 | 131.606 ms                |
| BlockToStepN              | 10.490 ms                 | 710.107 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:05.448411 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.813 ms                  | 251.193 ms                |
| Forward                   | 5.064 ms                  | 32.030 ms                 |
| Backward                  | 10.326 ms                 | 15.515 ms                 |
| Optimize                  | 2.700 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 851.846 us                | 121.959 ms                |
| AfterBackward             | 47.928 ms                 | 131.653 ms                |
| BlockToStepN              | 10.547 ms                 | 710.197 ms                |
| OneStep                   | 241.069 ms                | 1.059 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:06.448009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240206 08:27:07.448014 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240206 08:27:08.448009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.435 ms                  | 27.037 ms                 |
| ProcessBack:UpdateCache   | 7.687 ms                  | 12.154 ms                 |
| ProcessBack:UpsertPq      | 29.746 ms                 | 85.548 ms                 |
| ProcessOneStep            | 48.004 ms                 | 131.606 ms                |
| BlockToStepN              | 581.966 ms                | 710.107 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:09.842597 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.635 ms                  | 245.120 ms                |
| Forward                   | 5.063 ms                  | 20.939 ms                 |
| Backward                  | 10.282 ms                 | 14.221 ms                 |
| Optimize                  | 2.696 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 851.846 us                | 121.561 ms                |
| AfterBackward             | 48.054 ms                 | 108.407 ms                |
| BlockToStepN              | 10.547 ms                 | 710.197 ms                |
| OneStep                   | 241.069 ms                | 1.059 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:10.842008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240206 08:27:11.842007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240206 08:27:12.842007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240206 08:27:13.868605 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.435 ms                  | 27.037 ms                 |
| ProcessBack:UpdateCache   | 7.674 ms                  | 12.154 ms                 |
| ProcessBack:UpsertPq      | 30.740 ms                 | 85.548 ms                 |
| ProcessOneStep            | 48.409 ms                 | 108.366 ms                |
| BlockToStepN              | 10.490 ms                 | 707.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:14.868008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.405 ms                  | 245.120 ms                |
| Forward                   | 5.056 ms                  | 20.939 ms                 |
| Backward                  | 10.235 ms                 | 14.221 ms                 |
| Optimize                  | 2.696 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 934.852 us                | 121.561 ms                |
| AfterBackward             | 48.467 ms                 | 108.407 ms                |
| BlockToStepN              | 582.053 ms                | 708.043 ms                |
| OneStep                   | 679.223 ms                | 1.057 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:15.868007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240206 08:27:16.868043 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240206 08:27:17.868008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240206 08:27:18.868008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.443 ms                  | 27.037 ms                 |
| ProcessBack:UpdateCache   | 7.671 ms                  | 12.154 ms                 |
| ProcessBack:UpsertPq      | 30.740 ms                 | 85.548 ms                 |
| ProcessOneStep            | 48.409 ms                 | 108.366 ms                |
| BlockToStepN              | 10.490 ms                 | 707.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:19.876724 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=174, pq.top=174
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.786 ms                  | 245.120 ms                |
| Forward                   | 5.056 ms                  | 20.939 ms                 |
| Backward                  | 10.233 ms                 | 14.221 ms                 |
| Optimize                  | 2.696 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 1.269 ms                  | 121.561 ms                |
| AfterBackward             | 48.446 ms                 | 108.407 ms                |
| BlockToStepN              | 10.547 ms                 | 708.043 ms                |
| OneStep                   | 241.069 ms                | 1.057 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:20.876008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240206 08:27:21.876008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240206 08:27:22.876008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240206 08:27:23.876008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.448 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.641 ms                  | 11.767 ms                 |
| ProcessBack:UpsertPq      | 30.475 ms                 | 81.175 ms                 |
| ProcessOneStep            | 48.248 ms                 | 108.366 ms                |
| BlockToStepN              | 69.353 ms                 | 707.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:24.876006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.663 ms                  | 245.120 ms                |
| Forward                   | 5.052 ms                  | 20.939 ms                 |
| Backward                  | 10.216 ms                 | 14.221 ms                 |
| Optimize                  | 2.696 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 1.565 ms                  | 121.561 ms                |
| AfterBackward             | 48.281 ms                 | 108.407 ms                |
| BlockToStepN              | 69.410 ms                 | 708.043 ms                |
| OneStep                   | 241.069 ms                | 1.057 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:25.893844 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240206 08:27:26.893007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240206 08:27:27.893008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240206 08:27:28.893007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.448 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.590 ms                  | 11.767 ms                 |
| ProcessBack:UpsertPq      | 30.035 ms                 | 81.175 ms                 |
| ProcessOneStep            | 48.004 ms                 | 108.366 ms                |
| BlockToStepN              | 88.591 ms                 | 707.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:29.893005 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.353 ms                  | 245.120 ms                |
| Forward                   | 5.055 ms                  | 20.939 ms                 |
| Backward                  | 10.191 ms                 | 14.221 ms                 |
| Optimize                  | 2.694 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 1.802 ms                  | 121.561 ms                |
| AfterBackward             | 47.928 ms                 | 108.407 ms                |
| BlockToStepN              | 88.637 ms                 | 708.043 ms                |
| OneStep                   | 241.069 ms                | 1.057 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:30.893008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 6] 200 steps, total: 42.993, sample: 1.499, forward: 0.459, backward: 0.518, update: 0.226
[proc 5] 200 steps, total: 42.993, sample: 1.391, forward: 0.496, backward: 0.528, update: 0.229
[proc 2] 200 steps, total: 42.993, sample: 2.463, forward: 0.515, backward: 1.014, update: 0.258
[proc 4] 200 steps, total: 42.993, sample: 2.943, forward: 0.532, backward: 0.885, update: 0.238
[proc 1] 200 steps, total: 42.993, sample: 2.754, forward: 0.522, backward: 0.921, update: 0.252
[proc 3] 200 steps, total: 42.993, sample: 1.686, forward: 0.489, backward: 1.014, update: 0.291
[proc 0] 200 steps, total: 42.993, sample: 2.334, forward: 0.511, backward: 0.927, update: 0.307
W20240206 08:27:31.900293 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
W20240206 08:27:32.900007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240206 08:27:33.900007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.450 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.528 ms                  | 11.767 ms                 |
| ProcessBack:UpsertPq      | 29.746 ms                 | 81.175 ms                 |
| ProcessOneStep            | 47.862 ms                 | 108.366 ms                |
| BlockToStepN              | 581.966 ms                | 707.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:34.900007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.178 ms                  | 245.120 ms                |
| Forward                   | 5.073 ms                  | 20.939 ms                 |
| Backward                  | 10.151 ms                 | 14.221 ms                 |
| Optimize                  | 2.672 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 1.802 ms                  | 121.561 ms                |
| AfterBackward             | 47.836 ms                 | 108.407 ms                |
| BlockToStepN              | 93.949 ms                 | 708.043 ms                |
| OneStep                   | 241.069 ms                | 1.057 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:35.900007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240206 08:27:36.900007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240206 08:27:37.900007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240206 08:27:38.900007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.451 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.590 ms                  | 11.767 ms                 |
| ProcessBack:UpsertPq      | 29.505 ms                 | 81.175 ms                 |
| ProcessOneStep            | 47.633 ms                 | 108.366 ms                |
| BlockToStepN              | 95.023 ms                 | 707.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:39.973383 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.056 ms                  | 245.120 ms                |
| Forward                   | 5.108 ms                  | 20.939 ms                 |
| Backward                  | 10.139 ms                 | 14.221 ms                 |
| Optimize                  | 2.651 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 2.195 ms                  | 121.561 ms                |
| AfterBackward             | 47.662 ms                 | 108.407 ms                |
| BlockToStepN              | 95.069 ms                 | 708.043 ms                |
| OneStep                   | 241.069 ms                | 1.057 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:40.973006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240206 08:27:41.973007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240206 08:27:42.973006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240206 08:27:43.973007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.451 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.590 ms                  | 11.753 ms                 |
| ProcessBack:UpsertPq      | 29.581 ms                 | 80.288 ms                 |
| ProcessOneStep            | 47.802 ms                 | 108.366 ms                |
| BlockToStepN              | 581.966 ms                | 707.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:44.973006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.885 ms                  | 245.120 ms                |
| Forward                   | 5.092 ms                  | 20.939 ms                 |
| Backward                  | 10.098 ms                 | 14.221 ms                 |
| Optimize                  | 2.654 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 2.514 ms                  | 121.561 ms                |
| AfterBackward             | 47.869 ms                 | 108.407 ms                |
| BlockToStepN              | 109.841 ms                | 708.043 ms                |
| OneStep                   | 241.069 ms                | 1.057 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:45.973008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240206 08:27:47.035231 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240206 08:27:48.106420 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240206 08:27:49.106007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.451 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.551 ms                  | 11.753 ms                 |
| ProcessBack:UpsertPq      | 29.637 ms                 | 80.288 ms                 |
| ProcessOneStep            | 47.862 ms                 | 108.366 ms                |
| BlockToStepN              | 116.888 ms                | 707.721 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:50.106009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.862 ms                  | 245.120 ms                |
| Forward                   | 5.066 ms                  | 20.939 ms                 |
| Backward                  | 10.084 ms                 | 14.221 ms                 |
| Optimize                  | 2.673 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 2.470 ms                  | 121.561 ms                |
| AfterBackward             | 47.891 ms                 | 108.407 ms                |
| BlockToStepN              | 116.968 ms                | 708.043 ms                |
| OneStep                   | 241.069 ms                | 1.057 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:51.106016 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240206 08:27:52.106007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240206 08:27:53.106007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240206 08:27:54.106007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.451 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.542 ms                  | 11.753 ms                 |
| ProcessBack:UpsertPq      | 29.637 ms                 | 80.288 ms                 |
| ProcessOneStep            | 48.004 ms                 | 105.707 ms                |
| BlockToStepN              | 121.711 ms                | 696.985 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:55.106009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.031 ms                  | 215.811 ms                |
| Forward                   | 5.087 ms                  | 11.338 ms                 |
| Backward                  | 10.069 ms                 | 13.733 ms                 |
| Optimize                  | 2.652 ms                  | 5.607 ms                  |
| BarrierTimeBeforeRank0    | 2.220 ms                  | 120.192 ms                |
| AfterBackward             | 48.054 ms                 | 105.741 ms                |
| BlockToStepN              | 127.698 ms                | 697.063 ms                |
| OneStep                   | 241.069 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:27:56.137010 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=256, pq.top=256
W20240206 08:27:57.204349 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240206 08:27:58.204006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240206 08:27:59.204007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.464 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.507 ms                  | 11.753 ms                 |
| ProcessBack:UpsertPq      | 29.775 ms                 | 80.288 ms                 |
| ProcessOneStep            | 47.884 ms                 | 105.707 ms                |
| BlockToStepN              | 131.087 ms                | 696.985 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:00.204007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.885 ms                  | 215.811 ms                |
| Forward                   | 5.073 ms                  | 11.338 ms                 |
| Backward                  | 10.044 ms                 | 13.733 ms                 |
| Optimize                  | 2.673 ms                  | 5.607 ms                  |
| BarrierTimeBeforeRank0    | 2.195 ms                  | 120.192 ms                |
| AfterBackward             | 47.891 ms                 | 105.741 ms                |
| BlockToStepN              | 131.189 ms                | 697.063 ms                |
| OneStep                   | 241.069 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:01.204007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240206 08:28:02.204008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240206 08:28:03.267524 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240206 08:28:04.267009 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.469 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.482 ms                  | 11.753 ms                 |
| ProcessBack:UpsertPq      | 29.637 ms                 | 80.288 ms                 |
| ProcessOneStep            | 47.690 ms                 | 105.707 ms                |
| BlockToStepN              | 138.641 ms                | 696.985 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:05.312732 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.701 ms                  | 215.811 ms                |
| Forward                   | 5.073 ms                  | 11.338 ms                 |
| Backward                  | 10.023 ms                 | 13.733 ms                 |
| Optimize                  | 2.673 ms                  | 5.607 ms                  |
| BarrierTimeBeforeRank0    | 2.295 ms                  | 120.192 ms                |
| AfterBackward             | 47.674 ms                 | 105.741 ms                |
| BlockToStepN              | 138.697 ms                | 697.063 ms                |
| OneStep                   | 241.069 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:06.368042 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240206 08:28:07.368006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240206 08:28:08.368008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240206 08:28:09.368008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.471 ms                  | 15.569 ms                 |
| ProcessBack:UpdateCache   | 7.472 ms                  | 11.753 ms                 |
| ProcessBack:UpsertPq      | 29.578 ms                 | 77.677 ms                 |
| ProcessOneStep            | 47.633 ms                 | 105.707 ms                |
| BlockToStepN              | 138.641 ms                | 696.985 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:10.368007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.682 ms                  | 215.811 ms                |
| Forward                   | 5.073 ms                  | 11.338 ms                 |
| Backward                  | 10.002 ms                 | 14.221 ms                 |
| Optimize                  | 2.673 ms                  | 5.607 ms                  |
| BarrierTimeBeforeRank0    | 2.247 ms                  | 120.192 ms                |
| AfterBackward             | 47.662 ms                 | 105.741 ms                |
| BlockToStepN              | 138.697 ms                | 697.063 ms                |
| OneStep                   | 241.069 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:11.368008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240206 08:28:12.368007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240206 08:28:13.378386 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=294, pq.top=294
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.480 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.472 ms                  | 11.753 ms                 |
| ProcessBack:UpsertPq      | 29.578 ms                 | 77.677 ms                 |
| ProcessOneStep            | 47.676 ms                 | 105.707 ms                |
| BlockToStepN              | 581.966 ms                | 696.985 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:14.602731 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.555 ms                  | 215.811 ms                |
| Forward                   | 5.073 ms                  | 11.338 ms                 |
| Backward                  | 9.992 ms                  | 14.221 ms                 |
| Optimize                  | 2.673 ms                  | 5.607 ms                  |
| BarrierTimeBeforeRank0    | 2.195 ms                  | 120.192 ms                |
| AfterBackward             | 47.698 ms                 | 105.741 ms                |
| BlockToStepN              | 153.498 ms                | 697.063 ms                |
| OneStep                   | 241.069 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:15.602005 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 5] 300 steps, total: 45.194, sample: 1.220, forward: 0.453, backward: 0.550, update: 0.252
[proc 4] 300 steps, total: 45.194, sample: 1.811, forward: 0.490, backward: 0.936, update: 0.233
[proc 3] 300 steps, total: 45.194, sample: 1.404, forward: 0.453, backward: 0.987, update: 0.254
[proc 2] 300 steps, total: 45.194, sample: 1.564, forward: 0.500, backward: 1.067, update: 0.264
[proc 1] 300 steps, total: 45.194, sample: 1.893, forward: 0.534, backward: 0.884, update: 0.241
[proc 6] 300 steps, total: 45.194, sample: 1.446, forward: 0.446, backward: 0.545, update: 0.235
[proc 0] 300 steps, total: 45.194, sample: 1.441, forward: 0.516, backward: 0.988, update: 0.299
W20240206 08:28:16.602007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240206 08:28:17.602007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240206 08:28:18.602008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.488 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.482 ms                  | 11.753 ms                 |
| ProcessBack:UpsertPq      | 29.578 ms                 | 77.677 ms                 |
| ProcessOneStep            | 47.690 ms                 | 105.707 ms                |
| BlockToStepN              | 156.347 ms                | 696.985 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:19.602005 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=307, pq.top=307
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.523 ms                  | 215.811 ms                |
| Forward                   | 5.085 ms                  | 12.817 ms                 |
| Backward                  | 9.983 ms                  | 15.515 ms                 |
| Optimize                  | 2.673 ms                  | 5.750 ms                  |
| BarrierTimeBeforeRank0    | 2.277 ms                  | 120.192 ms                |
| AfterBackward             | 47.719 ms                 | 105.741 ms                |
| BlockToStepN              | 156.416 ms                | 697.063 ms                |
| OneStep                   | 260.307 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:20.602005 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240206 08:28:21.602008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240206 08:28:22.602007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240206 08:28:23.602010 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.504 ms                  | 15.730 ms                 |
| ProcessBack:UpdateCache   | 7.481 ms                  | 11.753 ms                 |
| ProcessBack:UpsertPq      | 29.729 ms                 | 77.677 ms                 |
| ProcessOneStep            | 47.862 ms                 | 105.707 ms                |
| BlockToStepN              | 156.347 ms                | 696.985 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:24.602005 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.456 ms                  | 215.811 ms                |
| Forward                   | 5.073 ms                  | 12.817 ms                 |
| Backward                  | 9.992 ms                  | 17.916 ms                 |
| Optimize                  | 2.677 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 2.277 ms                  | 120.192 ms                |
| AfterBackward             | 47.928 ms                 | 105.741 ms                |
| BlockToStepN              | 165.766 ms                | 697.063 ms                |
| OneStep                   | 260.307 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:25.602005 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240206 08:28:26.602010 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240206 08:28:27.602010 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240206 08:28:28.602007 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.504 ms                  | 15.569 ms                 |
| ProcessBack:UpdateCache   | 7.468 ms                  | 11.557 ms                 |
| ProcessBack:UpsertPq      | 29.757 ms                 | 75.327 ms                 |
| ProcessOneStep            | 48.004 ms                 | 105.707 ms                |
| BlockToStepN              | 175.315 ms                | 696.985 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:29.602011 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.492 ms                  | 215.811 ms                |
| Forward                   | 5.064 ms                  | 12.817 ms                 |
| Backward                  | 9.971 ms                  | 17.916 ms                 |
| Optimize                  | 2.677 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 2.220 ms                  | 120.192 ms                |
| AfterBackward             | 48.047 ms                 | 105.741 ms                |
| BlockToStepN              | 175.361 ms                | 697.063 ms                |
| OneStep                   | 260.307 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:30.700956 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240206 08:28:31.700008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=332, pq.top=332
W20240206 08:28:32.700008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=334, pq.top=334
W20240206 08:28:33.700006 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=336, pq.top=336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.511 ms                  | 15.569 ms                 |
| ProcessBack:UpdateCache   | 7.461 ms                  | 11.557 ms                 |
| ProcessBack:UpsertPq      | 29.757 ms                 | 75.327 ms                 |
| ProcessOneStep            | 48.154 ms                 | 105.707 ms                |
| BlockToStepN              | 175.315 ms                | 696.985 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 08:28:34.700008 26817 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=338, pq.top=338
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.593 ms                  | 215.811 ms                |
| Forward                   | 5.063 ms                  | 12.817 ms                 |
| Backward                  | 9.961 ms                  | 17.916 ms                 |
| Optimize                  | 2.673 ms                  | 5.763 ms                  |
| BarrierTimeBeforeRank0    | 1.784 ms                  | 120.192 ms                |
| AfterBackward             | 48.252 ms                 | 105.741 ms                |
| BlockToStepN              | 582.053 ms                | 697.063 ms                |
| OneStep                   | 679.080 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 156.40952134132385 seconds
before call kg_cache_controller.StopThreads()
W20240206 08:28:35.657776 26817 grad_async_v1.h:243] call StopThreads. PID = 25323
W20240206 08:28:35.657800 26817 grad_base.h:212] before processOneStepNegThread_.join();
W20240206 08:28:35.663331 26817 grad_base.h:214] after processOneStepNegThread_.join();
W20240206 08:28:35.663352 26817 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240206 08:28:35.824883 26817 grad_async_v1.h:264] StopThreads done.
