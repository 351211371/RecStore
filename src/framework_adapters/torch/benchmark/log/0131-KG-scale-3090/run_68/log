WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240203 11:57:47.089815 38397 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_62', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [38397 sampler.py:454] Start PreSampling
WARNING [38397 sampler.py:532] Before construct renumbering_dict
WARNING [38397 sampler.py:555] PreSampling done
W20240203 12:18:04.213553 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240203 12:18:04.213753 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240203 12:18:04.213790 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240203 12:18:04.213831 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240203 12:18:04.213865 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240203 12:18:04.213904 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240203 12:18:04.213934 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240203 12:18:04.213974 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240203 12:18:04.214000 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240203 12:18:04.214033 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240203 12:18:04.214066 38397 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240203 12:18:04.214100 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240203 12:18:04.214126 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240203 12:18:04.214285 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240203 12:18:04.214330 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240203 12:18:04.214361 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240203 12:18:04.214416 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240203 12:18:04.214452 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240203 12:18:04.214494 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240203 12:18:04.214526 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240203 12:18:04.214560 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240203 12:18:04.214596 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240203 12:18:04.214629 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240203 12:18:04.214658 38397 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240203 12:18:04.214679 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240203 12:18:04.214706 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240203 12:18:04.214762 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240203 12:18:04.214804 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240203 12:18:04.214833 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240203 12:18:04.214864 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240203 12:18:04.214895 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240203 12:18:04.214919 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240203 12:18:04.214953 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240203 12:18:04.214987 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240203 12:18:04.215024 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240203 12:18:04.215052 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240203 12:18:04.215080 38397 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240203 12:18:04.215102 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240203 12:18:04.215126 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240203 12:18:04.215190 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240203 12:18:04.215219 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240203 12:18:04.215248 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240203 12:18:04.215276 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240203 12:18:04.215308 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240203 12:18:04.215343 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240203 12:18:04.215369 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240203 12:18:04.215409 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240203 12:18:04.215440 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240203 12:18:04.215471 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240203 12:18:04.215502 38397 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240203 12:18:04.215526 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240203 12:18:04.215548 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240203 12:18:04.215612 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240203 12:18:04.215655 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240203 12:18:04.215685 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240203 12:18:04.215711 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240203 12:18:04.215746 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240203 12:18:04.215780 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240203 12:18:04.215817 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240203 12:18:04.215853 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240203 12:18:04.215883 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240203 12:18:04.215914 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240203 12:18:04.215950 38397 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240203 12:18:04.215973 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240203 12:18:04.215996 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240203 12:18:04.216043 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240203 12:18:04.216085 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240203 12:18:04.216112 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240203 12:18:04.216141 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240203 12:18:04.216167 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240203 12:18:04.216197 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240203 12:18:04.216231 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240203 12:18:04.216259 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240203 12:18:04.216285 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240203 12:18:04.216316 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240203 12:18:04.216349 38397 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240203 12:18:04.216372 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240203 12:18:04.216394 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240203 12:18:04.216444 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240203 12:18:04.216482 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240203 12:18:04.216509 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240203 12:18:04.216558 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240203 12:18:04.216593 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240203 12:18:04.216629 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240203 12:18:04.216661 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240203 12:18:04.216688 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240203 12:18:04.216717 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240203 12:18:04.216745 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240203 12:18:04.216779 38397 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240203 12:18:04.216802 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240203 12:18:04.216825 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240203 12:18:04.216876 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240203 12:18:04.216914 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240203 12:18:04.216948 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240203 12:18:04.216981 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240203 12:18:04.217012 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240203 12:18:04.217043 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240203 12:18:04.217074 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240203 12:18:04.217108 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240203 12:18:04.217136 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240203 12:18:04.217168 38397 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240203 12:18:04.217200 38397 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240203 12:18:04.217223 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240203 12:18:04.217247 38397 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240203 12:18:04.696317 38397 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240203 12:26:40.628508 38397 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605421,  8605443,    61839,  ..., 64153601, 59903196,  9171938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1972.206 seconds
[Rank1] pid = 63961
[Rank2] pid = 64056
[Rank3] pid = 64123
[Rank4] pid = 64192
[Rank5] pid = 64322
[Rank6] pid = 64485
INFO [38397 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [63961 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [64056 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [64123 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [64192 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [64322 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [64485 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [64646 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [64322 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64646 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64485 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64056 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64123 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64192 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [63961 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [38397 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240203 12:30:51.598832 64323 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [8605415, 400]; dev=5; size=12.82 GB
W20240203 12:30:51.598944 64486 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [8605415, 400]; dev=6; size=12.82 GB
W20240203 12:30:51.598944 64710 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [8605415, 400]; dev=7; size=12.82 GB
W20240203 12:30:51.599131 64057 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240203 12:30:51.599170 64124 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
W20240203 12:30:51.599936 64193 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [8605415, 400]; dev=4; size=12.82 GB
W20240203 12:30:51.616811 64647 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
W20240203 12:30:51.617611 63962 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240203 12:30:51.652043 64710 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1020497a5000 7.629 MB
W20240203 12:30:51.652078 64486 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x102049f48000 7.629 MB
W20240203 12:30:51.652253 64710 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204a6eb000 7.629 MB
W20240203 12:30:51.652267 64486 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204ae8e000 7.629 MB
W20240203 12:30:51.652313 64710 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10204b631000 1.49 GB
W20240203 12:30:51.652330 64486 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1020aac14000 1.49 GB
W20240203 12:30:51.652356 64710 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10210a1f7000 1.49 GB
W20240203 12:30:51.652381 64486 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1021697da000 1.49 GB
W20240203 12:30:51.652420 64486 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240203 12:30:51.652422 64710 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240203 12:30:51.705993 64486 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240203 12:30:51.706007 64710 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240203 12:30:51.706211 64193 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1021c8dc7000 7.629 MB
W20240203 12:30:51.706248 64124 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1021c956a000 7.629 MB
W20240203 12:30:51.706252 64323 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1021c9d0d000 7.629 MB
W20240203 12:30:51.706373 64193 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1021ca4b0000 7.629 MB
W20240203 12:30:51.706403 64323 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1021cac53000 7.629 MB
W20240203 12:30:51.706406 64124 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1021cb3f6000 7.629 MB
W20240203 12:30:51.706440 64193 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1021cbb99000 1.49 GB
W20240203 12:30:51.706470 64323 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10222b17c000 1.49 GB
W20240203 12:30:51.706476 64124 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10228a75f000 1.49 GB
W20240203 12:30:51.706493 64193 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1022e9d42000 1.49 GB
W20240203 12:30:51.706524 64323 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x102349325000 1.49 GB
W20240203 12:30:51.706530 64124 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1023a8908000 1.49 GB
W20240203 12:30:51.706547 64193 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 12:30:51.706573 64323 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 12:30:51.706576 64124 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 12:30:51.739660 64193 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 12:30:51.739682 64124 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 12:30:51.739686 64323 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 12:30:51.744366 64057 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102407ef7000 7.629 MB
W20240203 12:30:51.744539 64057 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10240869e000 7.629 MB
W20240203 12:30:51.744614 64057 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102408e43000 1.49 GB
W20240203 12:30:51.744668 64057 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102468426000 1.49 GB
W20240203 12:30:51.744721 64057 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 12:30:51.746538 64057 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 12:30:51.801820 64647 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1024c7a0f000 7.629 MB
W20240203 12:30:51.801944 64647 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1024c81b2000 7.629 MB
W20240203 12:30:51.802011 64647 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1024c8955000 1.49 GB
W20240203 12:30:51.802052 64647 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102527f38000 1.49 GB
W20240203 12:30:51.802119 64647 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 12:30:51.803889 64647 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 12:30:51.829006 63962 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102587521000 7.629 MB
W20240203 12:30:51.829284 63962 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102587cc4000 7.629 MB
W20240203 12:30:51.829370 63962 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102588467000 1.49 GB
W20240203 12:30:51.829423 63962 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025e7a4a000 1.49 GB
W20240203 12:30:51.829550 63962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 12:30:51.832842 63962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [64485 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [64322 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [64646 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [63961 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [64192 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 64646
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [38397 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [64123 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [64056 DistTensor.py:59] The tensor name already exists in the kvstore
I20240203 12:31:44.903911 64057 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240203 12:31:44.904165 64124 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 12:31:44.904197 64193 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 12:31:44.904230 64647 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 12:31:44.904268 64323 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 12:31:44.904759 64710 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 12:31:44.904917 63962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 12:31:44.904980 64486 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240203 12:31:44.907321 64647 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240203 12:31:44.907867 64647 grad_base.h:184] Init GradProcessingBase done
I20240203 12:31:57.972419 64647 grad_async_v1.h:203] Use main thread to update emb.
W20240203 12:31:57.972805 64647 kg_controller.h:75] after init GradAsyncProcessing
I20240203 12:31:57.972815 64647 kg_controller.h:84] Construct KGCacheController done
E20240203 12:31:59.744855 64710 recstore.cc:66] init folly done
E20240203 12:31:59.744889 64193 recstore.cc:66] init folly done
E20240203 12:31:59.744900 64323 recstore.cc:66] init folly done
E20240203 12:31:59.744956 64124 recstore.cc:66] init folly done
E20240203 12:31:59.745327 63962 recstore.cc:66] init folly done
E20240203 12:31:59.745342 64057 recstore.cc:66] init folly done
E20240203 12:31:59.745638 64486 recstore.cc:66] init folly done
E20240203 12:31:59.745906 64647 recstore.cc:66] init folly done
I20240203 12:31:59.747023 64647 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240203 12:32:21.850143 64710 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240203 12:32:22.131634 64323 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 12:32:22.414040 64193 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 12:32:22.879778 64057 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 12:32:24.538722 64124 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 12:32:24.750782 63962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 12:32:25.001073 64647 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 12:32:25.236060 64486 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240203 12:32:27.760671 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240203 12:32:28.558123 64647 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
W20240203 12:32:29.086704 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 13.756 ms                 | 316.267 ms                |
| ProcessBack:UpdateCache   | 11.460 ms                 | 817.908 ms                |
| ProcessBack:UpsertPq      | 38.455 ms                 | 62.170 ms                 |
| ProcessOneStep            | 428.962 ms                | 1.476 s                   |
| BlockToStepN              | 887.000 ns                | 724.143 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.790 ms                 | 28.435 ms                 |
| Forward                   | 5.475 ms                  | 762.335 ms                |
| Backward                  | 11.975 ms                 | 250.077 ms                |
| Optimize                  | 2.635 ms                  | 6.254 ms                  |
| BarrierTimeBeforeRank0    | 33.851 us                 | 81.617 us                 |
| AfterBackward             | 429.024 ms                | 1.477 s                   |
| BlockToStepN              | 725.693 ms                | 747.037 ms                |
| OneStep                   | 885.282 ms                | 3.251 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:32:30.086009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240203 12:32:31.434418 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240203 12:32:32.701745 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240203 12:32:33.701009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240203 12:32:34.701009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.874 ms                  | 316.267 ms                |
| ProcessBack:UpdateCache   | 11.349 ms                 | 817.908 ms                |
| ProcessBack:UpsertPq      | 55.396 ms                 | 106.099 ms                |
| ProcessOneStep            | 93.384 ms                 | 1.476 s                   |
| BlockToStepN              | 2.997 ms                  | 791.280 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.052 ms                 | 198.418 ms                |
| Forward                   | 5.522 ms                  | 762.335 ms                |
| Backward                  | 11.975 ms                 | 250.077 ms                |
| Optimize                  | 2.919 ms                  | 6.254 ms                  |
| BarrierTimeBeforeRank0    | 35.063 us                 | 184.022 ms                |
| AfterBackward             | 93.424 ms                 | 1.477 s                   |
| BlockToStepN              | 3.066 ms                  | 791.465 ms                |
| OneStep                   | 463.880 ms                | 3.251 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:32:35.701015 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240203 12:32:36.701009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240203 12:32:37.744064 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240203 12:32:38.797279 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.501 ms                  | 316.267 ms                |
| ProcessBack:UpdateCache   | 11.327 ms                 | 817.908 ms                |
| ProcessBack:UpsertPq      | 47.424 ms                 | 106.099 ms                |
| ProcessOneStep            | 77.352 ms                 | 1.476 s                   |
| BlockToStepN              | 2.997 ms                  | 846.827 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.709 ms                 | 198.418 ms                |
| Forward                   | 5.689 ms                  | 762.335 ms                |
| Backward                  | 11.320 ms                 | 250.077 ms                |
| Optimize                  | 2.774 ms                  | 6.254 ms                  |
| BarrierTimeBeforeRank0    | 81.617 us                 | 184.022 ms                |
| AfterBackward             | 77.405 ms                 | 1.477 s                   |
| BlockToStepN              | 3.066 ms                  | 846.932 ms                |
| OneStep                   | 463.880 ms                | 3.251 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:32:40.111704 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240203 12:32:41.144915 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240203 12:32:42.157030 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240203 12:32:43.157011 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240203 12:32:44.157007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.429 ms                  | 279.600 ms                |
| ProcessBack:UpdateCache   | 11.460 ms                 | 815.600 ms                |
| ProcessBack:UpsertPq      | 42.279 ms                 | 105.007 ms                |
| ProcessOneStep            | 67.887 ms                 | 1.476 s                   |
| BlockToStepN              | 8.230 ms                  | 846.827 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.944 ms                 | 198.418 ms                |
| Forward                   | 5.475 ms                  | 762.335 ms                |
| Backward                  | 10.703 ms                 | 250.077 ms                |
| Optimize                  | 2.635 ms                  | 6.254 ms                  |
| BarrierTimeBeforeRank0    | 1.178 ms                  | 184.076 ms                |
| AfterBackward             | 67.927 ms                 | 1.477 s                   |
| BlockToStepN              | 677.848 ms                | 846.932 ms                |
| OneStep                   | 836.404 ms                | 3.251 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:32:45.157011 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240203 12:32:46.157008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240203 12:32:47.157007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240203 12:32:48.444991 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240203 12:32:49.457026 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.216 ms                  | 279.600 ms                |
| ProcessBack:UpdateCache   | 11.690 ms                 | 815.600 ms                |
| ProcessBack:UpsertPq      | 37.807 ms                 | 105.007 ms                |
| ProcessOneStep            | 63.686 ms                 | 1.476 s                   |
| BlockToStepN              | 8.230 ms                  | 846.827 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.790 ms                 | 198.418 ms                |
| Forward                   | 5.475 ms                  | 762.335 ms                |
| Backward                  | 5.233 ms                  | 250.077 ms                |
| Optimize                  | 2.586 ms                  | 6.254 ms                  |
| BarrierTimeBeforeRank0    | 2.398 ms                  | 184.076 ms                |
| AfterBackward             | 63.751 ms                 | 1.477 s                   |
| BlockToStepN              | 8.302 ms                  | 846.932 ms                |
| OneStep                   | 463.880 ms                | 3.251 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:32:50.457010 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240203 12:32:51.457010 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240203 12:32:52.534993 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240203 12:32:53.543362 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240203 12:32:54.543581 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.206 ms                  | 279.600 ms                |
| ProcessBack:UpdateCache   | 11.690 ms                 | 815.600 ms                |
| ProcessBack:UpsertPq      | 38.906 ms                 | 105.007 ms                |
| ProcessOneStep            | 64.250 ms                 | 428.962 ms                |
| BlockToStepN              | 8.230 ms                  | 846.827 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.483 ms                  | 168.040 ms                |
| Forward                   | 5.475 ms                  | 15.307 ms                 |
| Backward                  | 5.073 ms                  | 13.130 ms                 |
| Optimize                  | 2.580 ms                  | 5.568 ms                  |
| BarrierTimeBeforeRank0    | 3.822 ms                  | 184.022 ms                |
| AfterBackward             | 64.285 ms                 | 429.024 ms                |
| BlockToStepN              | 8.302 ms                  | 846.932 ms                |
| OneStep                   | 463.880 ms                | 3.251 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:32:55.543009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240203 12:32:56.826488 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240203 12:32:57.927224 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240203 12:32:58.927009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.173 ms                  | 279.600 ms                |
| ProcessBack:UpdateCache   | 11.850 ms                 | 815.600 ms                |
| ProcessBack:UpsertPq      | 39.500 ms                 | 105.007 ms                |
| ProcessOneStep            | 64.450 ms                 | 428.962 ms                |
| BlockToStepN              | 677.706 ms                | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.483 ms                  | 168.040 ms                |
| Forward                   | 5.522 ms                  | 15.307 ms                 |
| Backward                  | 5.037 ms                  | 13.130 ms                 |
| Optimize                  | 2.586 ms                  | 5.856 ms                  |
| BarrierTimeBeforeRank0    | 5.289 ms                  | 184.022 ms                |
| AfterBackward             | 64.285 ms                 | 429.024 ms                |
| BlockToStepN              | 8.302 ms                  | 838.620 ms                |
| OneStep                   | 463.880 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:32:59.927006 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240203 12:33:00.927009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240203 12:33:01.927009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240203 12:33:02.927011 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240203 12:33:03.927009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.094 ms                  | 279.600 ms                |
| ProcessBack:UpdateCache   | 11.664 ms                 | 815.600 ms                |
| ProcessBack:UpsertPq      | 38.562 ms                 | 105.007 ms                |
| ProcessOneStep            | 63.130 ms                 | 428.962 ms                |
| BlockToStepN              | 8.230 ms                  | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.814 ms                  | 168.040 ms                |
| Forward                   | 5.344 ms                  | 15.307 ms                 |
| Backward                  | 5.051 ms                  | 13.130 ms                 |
| Optimize                  | 2.586 ms                  | 5.856 ms                  |
| BarrierTimeBeforeRank0    | 5.515 ms                  | 184.022 ms                |
| AfterBackward             | 63.165 ms                 | 429.024 ms                |
| BlockToStepN              | 8.302 ms                  | 838.620 ms                |
| OneStep                   | 463.880 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:04.927004 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240203 12:33:05.927011 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240203 12:33:06.927008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240203 12:33:07.927009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240203 12:33:08.927009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.087 ms                  | 38.488 ms                 |
| ProcessBack:UpdateCache   | 11.521 ms                 | 28.919 ms                 |
| ProcessBack:UpsertPq      | 37.374 ms                 | 88.341 ms                 |
| ProcessOneStep            | 61.710 ms                 | 428.962 ms                |
| BlockToStepN              | 8.230 ms                  | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.032 ms                  | 168.040 ms                |
| Forward                   | 5.309 ms                  | 15.307 ms                 |
| Backward                  | 5.171 ms                  | 13.130 ms                 |
| Optimize                  | 2.631 ms                  | 6.254 ms                  |
| BarrierTimeBeforeRank0    | 5.289 ms                  | 184.022 ms                |
| AfterBackward             | 61.756 ms                 | 429.024 ms                |
| BlockToStepN              | 8.302 ms                  | 838.620 ms                |
| OneStep                   | 463.880 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:09.927004 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240203 12:33:10.927011 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240203 12:33:11.927011 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240203 12:33:12.927007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240203 12:33:13.940752 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.084 ms                  | 38.488 ms                 |
| ProcessBack:UpdateCache   | 11.484 ms                 | 28.919 ms                 |
| ProcessBack:UpsertPq      | 36.709 ms                 | 88.341 ms                 |
| ProcessOneStep            | 61.420 ms                 | 428.962 ms                |
| BlockToStepN              | 677.706 ms                | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.181 ms                  | 168.040 ms                |
| Forward                   | 5.215 ms                  | 15.307 ms                 |
| Backward                  | 5.221 ms                  | 13.130 ms                 |
| Optimize                  | 2.635 ms                  | 6.254 ms                  |
| BarrierTimeBeforeRank0    | 5.399 ms                  | 184.022 ms                |
| AfterBackward             | 61.473 ms                 | 429.024 ms                |
| BlockToStepN              | 8.302 ms                  | 838.620 ms                |
| OneStep                   | 463.880 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:14.940006 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240203 12:33:15.940011 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240203 12:33:17.008147 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240203 12:33:18.008009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240203 12:33:19.008010 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.087 ms                  | 38.488 ms                 |
| ProcessBack:UpdateCache   | 11.484 ms                 | 28.919 ms                 |
| ProcessBack:UpsertPq      | 37.374 ms                 | 88.341 ms                 |
| ProcessOneStep            | 62.272 ms                 | 428.962 ms                |
| BlockToStepN              | 677.706 ms                | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 55.054, sample: 1.515, forward: 1.249, backward: 1.298, update: 0.282
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 57.673, sample: 2.006, forward: 1.304, backward: 0.950, update: 0.253
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 54.568, sample: 1.736, forward: 1.175, backward: 1.342, update: 0.276
train_sampler.Prefill()
-------Step 0-------
tensor([  156879,   156904,   156927,   156956, 10253255,  1035793, 58749226,
        20963805, 25672874,   156976]) tensor([ 9577558, 19881500, 59061435, 79889753, 21691119, 33917258, 37286785,
        74230796, 76017021, 31532168])
-------Step 1-------
tensor([  156879,   156904,   156927,   156956, 10253255,  1035793, 58749226,
        20963805, 25672874,   156976]) tensor([ 3795458, 30072289, 13856131, 82915908, 85581550, 44852335, 81783848,
        57345550, 38895546, 16047008])
-------Step 2-------
tensor([  216231,   216257,   216284,   317970,   216316,   216336, 84534217,
        27405779,   216355,   216381]) tensor([78749364, 26488984, 76859145, 49678849, 49753858, 32744909, 66723486,
        40609789, 17107664, 43924687])
-------Step 3-------
tensor([  216231,   216257,   216284,   317970,   216316,   216336, 84534217,
        27405779,   216355,   216381]) tensor([51346499, 79058544, 37523071, 40946475, 69039345, 57548647, 38722795,
        19498706, 28847917,  1581455])
-------Step 4-------
tensor([  275994, 43545770,   276014,  1048941,   276045,  1048955,   276065,
        42673316,   276090,   276124]) tensor([76119192, 13084732, 77991644, 19863255, 74181471, 50739984, 62176844,
        40191256, 76834072, 54826146])
-------Step 5-------
tensor([  275994, 43545770,   276014,  1048941,   276045,  1048955,   276065,
        42673316,   276090,   276124]) tensor([38079387,  1451338,   628708, 84212836, 58367987, 54159308, 17817489,
        14709427, 68365078, 42143266])
-------Step 6-------
tensor([  335563,   352943, 36316839,   335588, 28584927, 69657623,   335618,
          335639, 55692129, 39044376]) tensor([15827550, 40363409, 34186297, 72070798, 36636042, 37320708, 26758552,
        11368634, 76143400, 75169438])
-------Step 7-------
tensor([  335563,   352943, 36316839,   335588, 28584927, 69657623,   335618,
          335639, 55692129, 39044376]) tensor([27223789, 47714018, 65430911, 68265645, 82279887, 50861844, 49010838,
        58764413, 38221149,   794168])
-------Step 8-------
tensor([  393074, 27592078,   393095,  1061538,   393116,   369944,   393143,
          393168,   393188,   393213]) tensor([45414997, 25180041, 35408723,  3475720, 45436518,   202570, 17371652,
          562235,  2860058, 56602754])
-------Step 9-------
tensor([  393074, 27592078,   393095,  1061538,   393116,   369944,   393143,
          393168,   393188,   393213]) tensor([51578649,  1881663, 18148579, 54314678, 13297933, 38616677,   820910,
        40512720, 74983738, 66045327])
before start barrier
start train
[proc 0] 100 steps, total: 54.804, sample: 2.067, forward: 1.324, backward: 1.048, update: 0.339
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 57.391, sample: 2.248, forward: 1.296, backward: 1.221, update: 0.270
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 57.955, sample: 1.514, forward: 1.231, backward: 1.172, update: 0.275
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 56.925, sample: 1.440, forward: 1.205, backward: 1.136, update: 0.285
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 55.266, sample: 2.895, forward: 1.283, backward: 1.036, update: 0.261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.181 ms                  | 168.040 ms                |
| Forward                   | 5.212 ms                  | 15.307 ms                 |
| Backward                  | 5.521 ms                  | 23.055 ms                 |
| Optimize                  | 2.646 ms                  | 6.254 ms                  |
| BarrierTimeBeforeRank0    | 5.515 ms                  | 184.022 ms                |
| AfterBackward             | 62.366 ms                 | 429.024 ms                |
| BlockToStepN              | 8.302 ms                  | 838.620 ms                |
| OneStep                   | 463.880 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:20.008006 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240203 12:33:21.062754 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240203 12:33:22.097287 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240203 12:33:23.097007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240203 12:33:24.097009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.094 ms                  | 38.488 ms                 |
| ProcessBack:UpdateCache   | 11.460 ms                 | 28.919 ms                 |
| ProcessBack:UpsertPq      | 37.289 ms                 | 88.341 ms                 |
| ProcessOneStep            | 62.272 ms                 | 428.962 ms                |
| BlockToStepN              | 8.230 ms                  | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.330 ms                  | 168.040 ms                |
| Forward                   | 5.215 ms                  | 15.307 ms                 |
| Backward                  | 10.148 ms                 | 23.055 ms                 |
| Optimize                  | 2.644 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.689 ms                  | 184.022 ms                |
| AfterBackward             | 62.366 ms                 | 429.024 ms                |
| BlockToStepN              | 8.302 ms                  | 838.620 ms                |
| OneStep                   | 463.880 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:25.097007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240203 12:33:26.097009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240203 12:33:27.097013 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240203 12:33:28.097010 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240203 12:33:29.097007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.094 ms                  | 38.488 ms                 |
| ProcessBack:UpdateCache   | 11.348 ms                 | 28.919 ms                 |
| ProcessBack:UpsertPq      | 37.374 ms                 | 88.341 ms                 |
| ProcessOneStep            | 62.133 ms                 | 428.962 ms                |
| BlockToStepN              | 8.230 ms                  | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.120 ms                  | 168.040 ms                |
| Forward                   | 5.204 ms                  | 15.307 ms                 |
| Backward                  | 10.334 ms                 | 23.055 ms                 |
| Optimize                  | 2.678 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.689 ms                  | 184.022 ms                |
| AfterBackward             | 62.167 ms                 | 429.024 ms                |
| BlockToStepN              | 677.848 ms                | 838.620 ms                |
| OneStep                   | 836.404 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:30.097009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240203 12:33:31.097008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240203 12:33:32.097009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240203 12:33:33.097008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240203 12:33:34.097011 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.086 ms                  | 31.962 ms                 |
| ProcessBack:UpdateCache   | 11.392 ms                 | 25.545 ms                 |
| ProcessBack:UpsertPq      | 36.720 ms                 | 81.399 ms                 |
| ProcessOneStep            | 61.345 ms                 | 428.962 ms                |
| BlockToStepN              | 8.230 ms                  | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.947 ms                  | 168.040 ms                |
| Forward                   | 5.161 ms                  | 15.307 ms                 |
| Backward                  | 10.334 ms                 | 23.055 ms                 |
| Optimize                  | 2.731 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 5.169 ms                  | 184.022 ms                |
| AfterBackward             | 60.906 ms                 | 429.024 ms                |
| BlockToStepN              | 8.302 ms                  | 838.620 ms                |
| OneStep                   | 463.880 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:35.097007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240203 12:33:36.097009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240203 12:33:37.180663 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240203 12:33:38.198155 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240203 12:33:39.198009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.084 ms                  | 31.962 ms                 |
| ProcessBack:UpdateCache   | 11.348 ms                 | 25.545 ms                 |
| ProcessBack:UpsertPq      | 36.259 ms                 | 81.399 ms                 |
| ProcessOneStep            | 60.846 ms                 | 428.962 ms                |
| BlockToStepN              | 69.198 ms                 | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.649 ms                  | 168.040 ms                |
| Forward                   | 5.145 ms                  | 15.307 ms                 |
| Backward                  | 10.346 ms                 | 23.055 ms                 |
| Optimize                  | 2.774 ms                  | 22.276 ms                 |
| BarrierTimeBeforeRank0    | 5.537 ms                  | 184.022 ms                |
| AfterBackward             | 60.890 ms                 | 429.024 ms                |
| BlockToStepN              | 69.263 ms                 | 838.620 ms                |
| OneStep                   | 463.880 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:40.198007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240203 12:33:41.198007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240203 12:33:42.198007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240203 12:33:43.236779 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240203 12:33:44.239602 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.084 ms                  | 32.432 ms                 |
| ProcessBack:UpdateCache   | 11.315 ms                 | 25.545 ms                 |
| ProcessBack:UpsertPq      | 36.001 ms                 | 81.399 ms                 |
| ProcessOneStep            | 60.706 ms                 | 428.962 ms                |
| BlockToStepN              | 87.071 ms                 | 838.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.394 ms                  | 168.040 ms                |
| Forward                   | 5.161 ms                  | 15.307 ms                 |
| Backward                  | 10.364 ms                 | 23.055 ms                 |
| Optimize                  | 2.816 ms                  | 22.276 ms                 |
| BarrierTimeBeforeRank0    | 5.289 ms                  | 184.022 ms                |
| AfterBackward             | 60.739 ms                 | 429.024 ms                |
| BlockToStepN              | 87.127 ms                 | 838.620 ms                |
| OneStep                   | 463.880 ms                | 1.278 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:45.507661 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240203 12:33:46.507009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240203 12:33:47.507007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240203 12:33:48.535467 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240203 12:33:49.602921 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.084 ms                  | 32.432 ms                 |
| ProcessBack:UpdateCache   | 11.193 ms                 | 25.545 ms                 |
| ProcessBack:UpsertPq      | 36.045 ms                 | 81.399 ms                 |
| ProcessOneStep            | 60.846 ms                 | 159.615 ms                |
| BlockToStepN              | 105.871 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.133 ms                  | 153.781 ms                |
| Forward                   | 5.161 ms                  | 10.800 ms                 |
| Backward                  | 10.422 ms                 | 18.504 ms                 |
| Optimize                  | 2.774 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.791 ms                  | 168.798 ms                |
| AfterBackward             | 60.890 ms                 | 159.663 ms                |
| BlockToStepN              | 105.946 ms                | 837.564 ms                |
| OneStep                   | 463.880 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:50.670857 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240203 12:33:51.784122 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240203 12:33:52.798900 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240203 12:33:54.033736 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.079 ms                  | 32.432 ms                 |
| ProcessBack:UpdateCache   | 11.154 ms                 | 25.545 ms                 |
| ProcessBack:UpsertPq      | 36.137 ms                 | 81.399 ms                 |
| ProcessOneStep            | 61.262 ms                 | 159.615 ms                |
| BlockToStepN              | 112.106 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.394 ms                  | 153.781 ms                |
| Forward                   | 5.155 ms                  | 10.800 ms                 |
| Backward                  | 10.465 ms                 | 18.504 ms                 |
| Optimize                  | 2.749 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.791 ms                  | 168.798 ms                |
| AfterBackward             | 61.305 ms                 | 159.663 ms                |
| BlockToStepN              | 677.848 ms                | 837.564 ms                |
| OneStep                   | 836.404 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:33:55.070752 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240203 12:33:56.115278 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240203 12:33:57.155484 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240203 12:33:58.229837 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240203 12:33:59.292104 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.086 ms                  | 31.962 ms                 |
| ProcessBack:UpdateCache   | 11.076 ms                 | 15.721 ms                 |
| ProcessBack:UpsertPq      | 36.137 ms                 | 80.001 ms                 |
| ProcessOneStep            | 61.262 ms                 | 159.615 ms                |
| BlockToStepN              | 124.074 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.850 ms                  | 153.781 ms                |
| Forward                   | 5.161 ms                  | 10.800 ms                 |
| Backward                  | 10.465 ms                 | 18.504 ms                 |
| Optimize                  | 2.742 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.791 ms                  | 168.798 ms                |
| AfterBackward             | 61.305 ms                 | 159.663 ms                |
| BlockToStepN              | 124.124 ms                | 837.564 ms                |
| OneStep                   | 463.880 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:00.339756 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240203 12:34:01.409106 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240203 12:34:02.618191 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240203 12:34:03.622256 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240203 12:34:04.648370 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.084 ms                  | 31.962 ms                 |
| ProcessBack:UpdateCache   | 10.923 ms                 | 15.721 ms                 |
| ProcessBack:UpsertPq      | 36.052 ms                 | 80.001 ms                 |
| ProcessOneStep            | 60.846 ms                 | 159.615 ms                |
| BlockToStepN              | 127.041 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.919 ms                  | 153.781 ms                |
| Forward                   | 5.145 ms                  | 10.800 ms                 |
| Backward                  | 10.460 ms                 | 18.504 ms                 |
| Optimize                  | 2.742 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.791 ms                  | 168.798 ms                |
| AfterBackward             | 60.890 ms                 | 159.663 ms                |
| BlockToStepN              | 127.098 ms                | 837.564 ms                |
| OneStep                   | 463.880 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:05.736218 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240203 12:34:06.770021 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240203 12:34:07.876991 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240203 12:34:08.910781 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.079 ms                  | 31.962 ms                 |
| ProcessBack:UpdateCache   | 10.872 ms                 | 15.721 ms                 |
| ProcessBack:UpsertPq      | 36.013 ms                 | 80.001 ms                 |
| ProcessOneStep            | 60.582 ms                 | 159.615 ms                |
| BlockToStepN              | 677.706 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.748 ms                  | 153.781 ms                |
| Forward                   | 5.135 ms                  | 10.800 ms                 |
| Backward                  | 10.460 ms                 | 18.504 ms                 |
| Optimize                  | 2.742 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.689 ms                  | 168.798 ms                |
| AfterBackward             | 60.612 ms                 | 159.663 ms                |
| BlockToStepN              | 141.242 ms                | 837.564 ms                |
| OneStep                   | 463.880 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:09.990705 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240203 12:34:11.253453 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 6] 200 steps, total: 52.387, sample: 1.424, forward: 0.564, backward: 1.102, update: 0.288
[proc 4] 200 steps, total: 52.387, sample: 2.134, forward: 0.556, backward: 0.977, update: 0.244
[proc 7] 200 steps, total: 52.387, sample: 1.375, forward: 0.581, backward: 0.961, update: 0.275
[proc 3] 200 steps, total: 52.387, sample: 2.324, forward: 0.542, backward: 0.976, update: 0.267
[proc 2] 200 steps, total: 52.387, sample: 1.462, forward: 0.533, backward: 1.087, update: 0.289
[proc 5] 200 steps, total: 52.387, sample: 2.311, forward: 0.559, backward: 0.612, update: 0.246
[proc 1] 200 steps, total: 52.387, sample: 1.448, forward: 0.520, backward: 1.067, update: 0.267
[proc 0] 200 steps, total: 52.387, sample: 1.675, forward: 0.538, backward: 1.032, update: 0.365
W20240203 12:34:12.279879 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240203 12:34:13.279007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240203 12:34:14.331619 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.067 ms                  | 31.962 ms                 |
| ProcessBack:UpdateCache   | 10.872 ms                 | 15.721 ms                 |
| ProcessBack:UpsertPq      | 35.949 ms                 | 80.001 ms                 |
| ProcessOneStep            | 60.319 ms                 | 159.615 ms                |
| BlockToStepN              | 141.181 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.748 ms                  | 153.781 ms                |
| Forward                   | 5.128 ms                  | 10.800 ms                 |
| Backward                  | 10.465 ms                 | 18.504 ms                 |
| Optimize                  | 2.749 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.791 ms                  | 168.798 ms                |
| AfterBackward             | 60.352 ms                 | 159.663 ms                |
| BlockToStepN              | 141.242 ms                | 837.564 ms                |
| OneStep                   | 463.880 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:15.419251 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240203 12:34:16.498272 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240203 12:34:17.579418 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240203 12:34:18.653378 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240203 12:34:19.653008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.059 ms                  | 31.962 ms                 |
| ProcessBack:UpdateCache   | 10.744 ms                 | 15.721 ms                 |
| ProcessBack:UpsertPq      | 35.775 ms                 | 80.001 ms                 |
| ProcessOneStep            | 59.734 ms                 | 159.615 ms                |
| BlockToStepN              | 151.492 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.748 ms                  | 153.781 ms                |
| Forward                   | 5.135 ms                  | 10.800 ms                 |
| Backward                  | 10.498 ms                 | 18.504 ms                 |
| Optimize                  | 2.753 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.689 ms                  | 168.798 ms                |
| AfterBackward             | 59.784 ms                 | 159.663 ms                |
| BlockToStepN              | 151.551 ms                | 837.564 ms                |
| OneStep                   | 463.880 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:20.753604 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=216, pq.top=216
W20240203 12:34:21.753008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240203 12:34:22.761889 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240203 12:34:23.761010 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.046 ms                  | 31.962 ms                 |
| ProcessBack:UpdateCache   | 10.730 ms                 | 15.721 ms                 |
| ProcessBack:UpsertPq      | 35.620 ms                 | 80.001 ms                 |
| ProcessOneStep            | 59.498 ms                 | 159.615 ms                |
| BlockToStepN              | 180.173 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:24.761008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.739 ms                  | 153.781 ms                |
| Forward                   | 5.131 ms                  | 10.800 ms                 |
| Backward                  | 10.490 ms                 | 18.504 ms                 |
| Optimize                  | 2.749 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.628 ms                  | 168.798 ms                |
| AfterBackward             | 59.543 ms                 | 159.663 ms                |
| BlockToStepN              | 677.848 ms                | 837.564 ms                |
| OneStep                   | 836.404 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:25.761009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240203 12:34:26.761009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240203 12:34:27.761009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240203 12:34:28.761008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.038 ms                  | 19.638 ms                 |
| ProcessBack:UpdateCache   | 10.730 ms                 | 14.499 ms                 |
| ProcessBack:UpsertPq      | 35.488 ms                 | 77.300 ms                 |
| ProcessOneStep            | 59.428 ms                 | 159.615 ms                |
| BlockToStepN              | 180.173 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:29.761006 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.739 ms                  | 153.781 ms                |
| Forward                   | 5.125 ms                  | 10.800 ms                 |
| Backward                  | 10.499 ms                 | 18.504 ms                 |
| Optimize                  | 2.753 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.643 ms                  | 168.798 ms                |
| AfterBackward             | 59.462 ms                 | 159.663 ms                |
| BlockToStepN              | 180.250 ms                | 837.564 ms                |
| OneStep                   | 463.880 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:30.761010 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240203 12:34:31.839668 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240203 12:34:32.839007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240203 12:34:33.839008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.038 ms                  | 19.638 ms                 |
| ProcessBack:UpdateCache   | 10.702 ms                 | 14.499 ms                 |
| ProcessBack:UpsertPq      | 35.516 ms                 | 77.300 ms                 |
| ProcessOneStep            | 59.464 ms                 | 159.615 ms                |
| BlockToStepN              | 180.173 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.722 ms                  | 153.781 ms                |
| Forward                   | 5.114 ms                  | 10.800 ms                 |
| Backward                  | 10.499 ms                 | 18.504 ms                 |
| Optimize                  | 2.754 ms                  | 10.449 ms                 |
| BarrierTimeBeforeRank0    | 4.689 ms                  | 168.798 ms                |
| AfterBackward             | 59.497 ms                 | 159.663 ms                |
| BlockToStepN              | 677.848 ms                | 837.564 ms                |
| OneStep                   | 836.404 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:34.924516 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240203 12:34:35.924010 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240203 12:34:36.924010 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240203 12:34:37.924008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240203 12:34:38.924007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.038 ms                  | 19.638 ms                 |
| ProcessBack:UpdateCache   | 10.675 ms                 | 14.499 ms                 |
| ProcessBack:UpsertPq      | 35.791 ms                 | 77.300 ms                 |
| ProcessOneStep            | 59.829 ms                 | 128.121 ms                |
| BlockToStepN              | 180.173 ms                | 837.449 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.762 ms                  | 138.420 ms                |
| Forward                   | 5.125 ms                  | 10.661 ms                 |
| Backward                  | 10.541 ms                 | 18.090 ms                 |
| Optimize                  | 2.749 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 4.791 ms                  | 150.958 ms                |
| AfterBackward             | 59.864 ms                 | 128.176 ms                |
| BlockToStepN              | 180.250 ms                | 837.564 ms                |
| OneStep                   | 463.880 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:39.924005 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240203 12:34:40.924006 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240203 12:34:41.924006 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240203 12:34:43.011379 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240203 12:34:44.011008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.015 ms                  | 19.638 ms                 |
| ProcessBack:UpdateCache   | 10.702 ms                 | 15.076 ms                 |
| ProcessBack:UpsertPq      | 35.727 ms                 | 77.300 ms                 |
| ProcessOneStep            | 59.829 ms                 | 128.121 ms                |
| BlockToStepN              | 180.173 ms                | 833.228 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.947 ms                  | 138.420 ms                |
| Forward                   | 5.123 ms                  | 10.661 ms                 |
| Backward                  | 10.499 ms                 | 18.090 ms                 |
| Optimize                  | 2.745 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 4.791 ms                  | 150.958 ms                |
| AfterBackward             | 59.864 ms                 | 128.176 ms                |
| BlockToStepN              | 677.848 ms                | 833.342 ms                |
| OneStep                   | 836.404 ms                | 1.203 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:45.011015 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240203 12:34:46.011014 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240203 12:34:47.011009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240203 12:34:48.011008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240203 12:34:49.011010 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.005 ms                  | 19.638 ms                 |
| ProcessBack:UpdateCache   | 10.744 ms                 | 15.076 ms                 |
| ProcessBack:UpsertPq      | 35.775 ms                 | 77.300 ms                 |
| ProcessOneStep            | 59.990 ms                 | 128.121 ms                |
| BlockToStepN              | 188.070 ms                | 833.228 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.020 ms                  | 138.420 ms                |
| Forward                   | 5.116 ms                  | 10.661 ms                 |
| Backward                  | 10.480 ms                 | 18.090 ms                 |
| Optimize                  | 2.738 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 4.988 ms                  | 150.958 ms                |
| AfterBackward             | 60.249 ms                 | 128.176 ms                |
| BlockToStepN              | 188.135 ms                | 833.342 ms                |
| OneStep                   | 463.880 ms                | 1.203 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:50.011005 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240203 12:34:51.011008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240203 12:34:52.011009 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240203 12:34:53.011006 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240203 12:34:54.056066 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=276, pq.top=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.980 ms                  | 19.623 ms                 |
| ProcessBack:UpdateCache   | 10.902 ms                 | 14.640 ms                 |
| ProcessBack:UpsertPq      | 35.949 ms                 | 75.729 ms                 |
| ProcessOneStep            | 60.285 ms                 | 128.121 ms                |
| BlockToStepN              | 188.087 ms                | 833.228 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.098 ms                  | 138.420 ms                |
| Forward                   | 5.115 ms                  | 10.800 ms                 |
| Backward                  | 10.459 ms                 | 18.090 ms                 |
| Optimize                  | 2.713 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 5.088 ms                  | 150.958 ms                |
| AfterBackward             | 60.320 ms                 | 128.176 ms                |
| BlockToStepN              | 188.153 ms                | 833.342 ms                |
| OneStep                   | 463.880 ms                | 1.203 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 12:34:55.056008 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240203 12:34:56.056007 64647 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
Successfully xmh. training takes 151.4980309009552 seconds
before call kg_cache_controller.StopThreads()
W20240203 12:34:56.499066 64647 grad_async_v1.h:243] call StopThreads. PID = 38397
W20240203 12:34:56.499096 64647 grad_base.h:212] before processOneStepNegThread_.join();
W20240203 12:34:56.503468 64647 grad_base.h:214] after processOneStepNegThread_.join();
W20240203 12:34:56.503479 64647 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240203 12:34:56.852994 64647 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.978 ms                  | 19.623 ms                 |
| ProcessBack:UpdateCache   | 10.923 ms                 | 14.640 ms                 |
| ProcessBack:UpsertPq      | 35.952 ms                 | 75.729 ms                 |
| ProcessOneStep            | 60.246 ms                 | 128.121 ms                |
| BlockToStepN              | 188.087 ms                | 833.228 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.103 ms                  | 138.420 ms                |
| Forward                   | 5.115 ms                  | 10.800 ms                 |
| Backward                  | 10.434 ms                 | 18.090 ms                 |
| Optimize                  | 2.706 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 5.169 ms                  | 150.958 ms                |
| AfterBackward             | 60.285 ms                 | 128.176 ms                |
| BlockToStepN              | 188.153 ms                | 833.342 ms                |
| OneStep                   | 463.880 ms                | 1.203 s                   |
+---------------------------+---------------------------+---------------------------+
