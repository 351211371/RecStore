WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 18:22:50.614457 18456 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_10', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [18456 sampler.py:454] Start PreSampling
WARNING [18456 sampler.py:532] Before construct renumbering_dict
WARNING [18456 sampler.py:555] PreSampling done
W20240206 18:42:15.038651 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 18:42:15.038839 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 18:42:15.038883 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 18:42:15.038920 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 18:42:15.038954 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 18:42:15.038986 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 18:42:15.039018 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 18:42:15.039054 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 18:42:15.039088 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 18:42:15.039124 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 18:42:15.039166 18456 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 18:42:15.039192 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 18:42:15.039219 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 18:42:15.039376 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 18:42:15.039413 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 18:42:15.039443 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 18:42:15.039487 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 18:42:15.039518 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 18:42:15.039548 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 18:42:15.039575 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 18:42:15.039615 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 18:42:15.039640 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 18:42:15.039670 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 18:42:15.039695 18456 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 18:42:15.039719 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 18:42:15.039755 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 18:42:15.039814 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 18:42:15.039850 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 18:42:15.039882 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 18:42:15.039919 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 18:42:15.039948 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 18:42:15.039978 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 18:42:15.040006 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 18:42:15.040035 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 18:42:15.040076 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 18:42:15.040117 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 18:42:15.040145 18456 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 18:42:15.040167 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 18:42:15.040196 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 18:42:15.040259 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 18:42:15.040297 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 18:42:15.040325 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 18:42:15.040354 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 18:42:15.040383 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 18:42:15.040410 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 18:42:15.040445 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 18:42:15.040478 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 18:42:15.040516 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 18:42:15.040550 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 18:42:15.040580 18456 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 18:42:15.040602 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 18:42:15.040623 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 18:42:15.040678 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 18:42:15.040712 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 18:42:15.040740 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 18:42:15.040773 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 18:42:15.040807 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 18:42:15.040838 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 18:42:15.040874 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 18:42:15.040900 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 18:42:15.040937 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 18:42:15.040969 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 18:42:15.040997 18456 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 18:42:15.041019 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 18:42:15.041049 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 18:42:15.041095 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 18:42:15.041123 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 18:42:15.041153 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 18:42:15.041180 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 18:42:15.041206 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 18:42:15.041234 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 18:42:15.041268 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 18:42:15.041301 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 18:42:15.041334 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 18:42:15.041368 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 18:42:15.041394 18456 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 18:42:15.041417 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 18:42:15.041440 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 18:42:15.041489 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 18:42:15.041522 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 18:42:15.041549 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 18:42:15.041581 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 18:42:15.041610 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 18:42:15.041643 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 18:42:15.041671 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 18:42:15.041704 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 18:42:15.041736 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 18:42:15.041774 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 18:42:15.041806 18456 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 18:42:15.041829 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 18:42:15.041857 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 18:42:15.041909 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240206 18:42:15.041941 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240206 18:42:15.041975 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240206 18:42:15.042002 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240206 18:42:15.042033 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240206 18:42:15.042069 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240206 18:42:15.042101 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240206 18:42:15.042133 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240206 18:42:15.042169 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240206 18:42:15.042205 18456 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240206 18:42:15.042234 18456 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240206 18:42:15.042258 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240206 18:42:15.042285 18456 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240206 18:42:15.487210 18456 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240206 18:52:48.044477 18456 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302736,  4302768,   108181,  ..., 59434562, 62604567,  4873869]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2313.481 seconds
[Rank1] pid = 19595
[Rank2] pid = 19690
[Rank3] pid = 19760
[Rank4] pid = 19827
[Rank5] pid = 19894
[Rank6] pid = 19964
INFO [18456 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [19595 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [19690 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [19760 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [19894 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [18456 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19964 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [19827 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [20031 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
WARNING [18456 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [20031 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19827 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19964 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [20031 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [19595 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19760 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19690 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19894 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [19760 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [19964 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [19894 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [19690 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [19827 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [19595 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 19:01:37.114809 20032 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240206 19:01:37.115034 19965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:01:37.115278 19691 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:01:37.115456 19761 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:01:37.115720 19895 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:01:37.115891 19596 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:01:37.116034 19828 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:01:37.116140 20040 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240206 19:01:38.881500 19895 recstore.cc:66] init folly done
E20240206 19:01:38.881753 19761 recstore.cc:66] init folly done
E20240206 19:01:38.881829 19691 recstore.cc:66] init folly done
E20240206 19:01:38.881831 19828 recstore.cc:66] init folly done
E20240206 19:01:38.881837 19596 recstore.cc:66] init folly done
E20240206 19:01:38.881845 20032 recstore.cc:66] init folly done
E20240206 19:01:38.882084 19965 recstore.cc:66] init folly done
E20240206 19:01:38.882091 20040 recstore.cc:66] init folly done
I20240206 19:01:44.765228 19828 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240206 19:01:44.816876 19895 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:01:44.825788 20032 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:01:46.160601 19691 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:01:46.810493 19596 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:01:46.818626 20040 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:01:47.062088 19761 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:01:48.298844 19965 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.188 ms                  | 91.819 ms                 |
| Forward                   | 9.086 ms                  | 547.622 ms                |
| Backward                  | 233.675 ms                | 445.290 ms                |
| Optimize                  | 4.184 ms                  | 43.322 ms                 |
| BarrierTimeBeforeRank0    | 40.001 ms                 | 252.605 ms                |
| BlockToStepN              | 32.244 us                 | 24.900 ms                 |
| OneStep                   | 304.554 ms                | 1.110 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.471 ms                  | 91.819 ms                 |
| Forward                   | 9.409 ms                  | 547.622 ms                |
| Backward                  | 236.235 ms                | 445.290 ms                |
| Optimize                  | 4.250 ms                  | 43.322 ms                 |
| BarrierTimeBeforeRank0    | 33.670 ms                 | 252.605 ms                |
| BlockToStepN              | 37.379 us                 | 24.900 ms                 |
| OneStep                   | 296.371 ms                | 1.110 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.133 ms                  | 91.819 ms                 |
| Forward                   | 9.463 ms                  | 547.622 ms                |
| Backward                  | 232.343 ms                | 445.290 ms                |
| Optimize                  | 4.234 ms                  | 43.322 ms                 |
| BarrierTimeBeforeRank0    | 31.835 ms                 | 252.605 ms                |
| BlockToStepN              | 34.757 us                 | 24.900 ms                 |
| OneStep                   | 288.181 ms                | 1.110 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.360 ms                  | 91.348 ms                 |
| Forward                   | 9.556 ms                  | 13.597 ms                 |
| Backward                  | 232.343 ms                | 445.290 ms                |
| Optimize                  | 4.196 ms                  | 4.741 ms                  |
| BarrierTimeBeforeRank0    | 30.793 ms                 | 226.229 ms                |
| BlockToStepN              | 35.753 us                 | 12.858 ms                 |
| OneStep                   | 289.915 ms                | 551.371 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.164 ms                  | 91.348 ms                 |
| Forward                   | 9.669 ms                  | 37.909 ms                 |
| Backward                  | 233.609 ms                | 445.290 ms                |
| Optimize                  | 4.280 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 28.382 ms                 | 252.605 ms                |
| BlockToStepN              | 34.986 us                 | 24.900 ms                 |
| OneStep                   | 289.915 ms                | 551.371 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.360 ms                  | 91.819 ms                 |
| Forward                   | 9.605 ms                  | 37.909 ms                 |
| Backward                  | 235.627 ms                | 445.290 ms                |
| Optimize                  | 4.322 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 30.793 ms                 | 252.605 ms                |
| BlockToStepN              | 37.684 us                 | 24.900 ms                 |
| OneStep                   | 290.073 ms                | 551.371 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 33.096, sample: 1.437, forward: 2.749, backward: 23.787, update: 0.469
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 35.081, sample: 1.880, forward: 2.455, backward: 20.414, update: 0.267
[Rank7] pid = 20031
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([   65406,    65446,    65475,    65523,  6253790,   146139, 51590861,
        17759793, 20434452,    65566]) tensor([ 5371444, 13921404, 58506400, 69065216, 19060976, 31693069, 38208261,
        75597190, 76912661, 28751158])
-------Step 1-------
tensor([   65406,    65446,    65475,    65523,  6253790,   146139, 51590861,
        17759793, 20434452,    65566]) tensor([64419911, 24416856, 11450772, 83840368, 80514583, 36653997, 79635029,
        52828143, 37067341, 14013330])
-------Step 2-------
tensor([  169165,   169216,   169251,    17997,   169296,   169332,   169386,
        25589180,   169429,   169469]) tensor([76678066, 24215786, 81843999, 48048318, 44808425, 28575260, 64714265,
        33612286, 14158626, 35978861])
-------Step 3-------
tensor([  169165,   169216,   169251,    17997,   169296,   169332,   169386,
        25589180,   169429,   169469]) tensor([48064327, 81201745, 34644401, 37911567, 60793270, 62574314, 39164283,
        16675480, 26179612,   677643])
-------Step 4-------
tensor([  274443, 48090242,   274483,   185019,   274530,   185057,   274583,
        39454262,   274627,   274675]) tensor([78281776, 10970861, 85268772, 17159826, 67814360, 45295820, 72017338,
        37263810, 66979404, 49841852])
-------Step 5-------
tensor([  274443, 48090242,   274483,   185019,   274530,   185057,   274583,
        39454262,   274627,   274675]) tensor([35653526, 71478950,   343270, 77811120, 54796454, 45672943, 14878804,
         8595369, 68672200, 34928740])
-------Step 6-------
tensor([  375470,    38860,   375502,   375535,    38879, 80673562,   375565,
          375597,   204408, 36236259]) tensor([13427344, 37713400, 37298074, 78009428, 33997503, 38252845, 24640562,
         6133500, 72795680, 65190435])
-------Step 7-------
tensor([  375470,    38860,   375502,   375535,    38879, 80673562,   375565,
          375597,   204408, 36236259]) tensor([25260253, 52362647, 77285414, 64058637, 84810305, 50264820, 50725949,
        54692919, 35381679, 33655940])
-------Step 8-------
tensor([  427883, 25424027,   427904,   222592,   427927,    48956,   427947,
          427966,   427988,   428009]) tensor([40569872, 26375244, 34065282,  2026042, 49964753, 72701000, 13782484,
        68698792,  1433478, 68851606])
-------Step 9-------
tensor([  427883, 25424027,   427904,   222592,   427927,    48956,   427947,
          427966,   427988,   428009]) tensor([57784639, 35008878, 12156830, 56590801,  8830979, 43610112, 27520000,
        40167369, 75544026, 73647999])
before start barrier
start train
[proc 0] 100 steps, total: 33.088, sample: 1.233, forward: 1.544, backward: 24.130, update: 0.438
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 35.142, sample: 1.252, forward: 2.706, backward: 24.504, update: 0.351
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 35.090, sample: 1.679, forward: 2.657, backward: 23.441, update: 0.461
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 31.608, sample: 1.246, forward: 2.555, backward: 23.226, update: 0.432
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 33.747, sample: 1.748, forward: 2.681, backward: 22.598, update: 0.485
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 32.845, sample: 1.291, forward: 2.676, backward: 25.018, update: 0.367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.164 ms                  | 91.819 ms                 |
| Forward                   | 9.568 ms                  | 37.909 ms                 |
| Backward                  | 235.580 ms                | 445.290 ms                |
| Optimize                  | 4.325 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 29.327 ms                 | 252.605 ms                |
| BlockToStepN              | 37.379 us                 | 24.900 ms                 |
| OneStep                   | 289.967 ms                | 551.371 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.886 ms                  | 91.819 ms                 |
| Forward                   | 9.605 ms                  | 37.909 ms                 |
| Backward                  | 234.369 ms                | 445.290 ms                |
| Optimize                  | 4.337 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 27.117 ms                 | 252.605 ms                |
| BlockToStepN              | 37.063 us                 | 24.900 ms                 |
| OneStep                   | 288.516 ms                | 551.371 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.322 ms                  | 91.819 ms                 |
| Forward                   | 9.661 ms                  | 37.909 ms                 |
| Backward                  | 235.286 ms                | 445.290 ms                |
| Optimize                  | 4.342 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 28.382 ms                 | 252.605 ms                |
| BlockToStepN              | 37.095 us                 | 24.900 ms                 |
| OneStep                   | 289.533 ms                | 551.371 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.644 ms                  | 91.819 ms                 |
| Forward                   | 9.647 ms                  | 14.437 ms                 |
| Backward                  | 235.580 ms                | 396.168 ms                |
| Optimize                  | 4.345 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 30.194 ms                 | 239.422 ms                |
| BlockToStepN              | 37.379 us                 | 24.366 ms                 |
| OneStep                   | 289.967 ms                | 524.142 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.628 ms                  | 91.819 ms                 |
| Forward                   | 9.594 ms                  | 14.437 ms                 |
| Backward                  | 235.771 ms                | 396.168 ms                |
| Optimize                  | 4.343 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 31.450 ms                 | 239.422 ms                |
| BlockToStepN              | 38.157 us                 | 24.366 ms                 |
| OneStep                   | 290.463 ms                | 524.142 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.322 ms                  | 91.819 ms                 |
| Forward                   | 9.540 ms                  | 14.437 ms                 |
| Backward                  | 235.286 ms                | 396.168 ms                |
| Optimize                  | 4.342 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 31.450 ms                 | 252.605 ms                |
| BlockToStepN              | 38.157 us                 | 24.366 ms                 |
| OneStep                   | 290.463 ms                | 524.142 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 30.708, sample: 1.305, forward: 2.017, backward: 24.110, update: 0.359
[proc 7] 200 steps, total: 30.708, sample: 2.013, forward: 1.752, backward: 22.336, update: 0.377
[proc 0] 200 steps, total: 30.707, sample: 1.132, forward: 0.975, backward: 23.948, update: 0.403
[proc 3] 200 steps, total: 30.707, sample: 1.177, forward: 2.125, backward: 23.915, update: 0.358
[proc 4] 200 steps, total: 30.708, sample: 1.100, forward: 1.908, backward: 24.434, update: 0.260
[proc 6] 200 steps, total: 30.707, sample: 1.099, forward: 1.867, backward: 23.362, update: 0.368
[proc 2] 200 steps, total: 30.707, sample: 1.619, forward: 1.972, backward: 21.190, update: 0.364
[proc 5] 200 steps, total: 30.708, sample: 1.504, forward: 1.766, backward: 22.970, update: 0.311
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.224 ms                  | 91.819 ms                 |
| Forward                   | 9.517 ms                  | 14.437 ms                 |
| Backward                  | 234.872 ms                | 396.168 ms                |
| Optimize                  | 4.347 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 32.198 ms                 | 252.605 ms                |
| BlockToStepN              | 37.765 us                 | 24.366 ms                 |
| OneStep                   | 291.136 ms                | 524.142 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.224 ms                  | 98.119 ms                 |
| Forward                   | 9.509 ms                  | 14.437 ms                 |
| Backward                  | 234.070 ms                | 396.168 ms                |
| Optimize                  | 4.356 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 32.825 ms                 | 252.605 ms                |
| BlockToStepN              | 37.565 us                 | 24.366 ms                 |
| OneStep                   | 291.163 ms                | 524.142 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.224 ms                  | 98.119 ms                 |
| Forward                   | 9.498 ms                  | 14.437 ms                 |
| Backward                  | 233.609 ms                | 396.168 ms                |
| Optimize                  | 4.361 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 33.058 ms                 | 252.605 ms                |
| BlockToStepN              | 37.562 us                 | 24.900 ms                 |
| OneStep                   | 290.751 ms                | 524.142 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.129 ms                  | 91.819 ms                 |
| Forward                   | 9.498 ms                  | 13.944 ms                 |
| Backward                  | 233.609 ms                | 376.406 ms                |
| Optimize                  | 4.370 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 32.825 ms                 | 248.271 ms                |
| BlockToStepN              | 37.379 us                 | 24.366 ms                 |
| OneStep                   | 290.577 ms                | 509.347 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.993 ms                  | 91.819 ms                 |
| Forward                   | 9.516 ms                  | 13.944 ms                 |
| Backward                  | 234.011 ms                | 376.406 ms                |
| Optimize                  | 4.378 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 32.336 ms                 | 248.271 ms                |
| BlockToStepN              | 37.534 us                 | 24.366 ms                 |
| OneStep                   | 290.751 ms                | 509.347 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.165 ms                  | 94.485 ms                 |
| Forward                   | 9.516 ms                  | 14.437 ms                 |
| Backward                  | 234.070 ms                | 376.406 ms                |
| Optimize                  | 4.375 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 32.014 ms                 | 248.271 ms                |
| BlockToStepN              | 37.565 us                 | 24.366 ms                 |
| OneStep                   | 290.603 ms                | 509.347 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 30.170, sample: 1.103, forward: 1.990, backward: 24.133, update: 0.257
[proc 7] 300 steps, total: 30.170, sample: 1.495, forward: 1.800, backward: 23.836, update: 0.360
[proc 5] 300 steps, total: 30.170, sample: 1.085, forward: 1.883, backward: 23.827, update: 0.394
[proc 4] 300 steps, total: 30.170, sample: 0.898, forward: 1.953, backward: 23.135, update: 0.232
[proc 1] 300 steps, total: 30.170, sample: 1.145, forward: 2.134, backward: 24.453, update: 0.387
[proc 6] 300 steps, total: 30.170, sample: 0.954, forward: 1.948, backward: 22.920, update: 0.307
[proc 3] 300 steps, total: 30.170, sample: 1.213, forward: 2.267, backward: 24.793, update: 0.411
[proc 0] 300 steps, total: 30.170, sample: 1.122, forward: 0.973, backward: 23.552, update: 0.411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.182 ms                  | 94.485 ms                 |
| Forward                   | 9.538 ms                  | 14.437 ms                 |
| Backward                  | 234.369 ms                | 376.406 ms                |
| Optimize                  | 4.356 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 31.850 ms                 | 248.271 ms                |
| BlockToStepN              | 37.359 us                 | 24.366 ms                 |
| OneStep                   | 290.466 ms                | 509.347 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.148 ms                  | 94.485 ms                 |
| Forward                   | 9.541 ms                  | 14.437 ms                 |
| Backward                  | 235.238 ms                | 376.406 ms                |
| Optimize                  | 4.350 ms                  | 8.839 ms                  |
| BarrierTimeBeforeRank0    | 31.037 ms                 | 248.271 ms                |
| BlockToStepN              | 37.276 us                 | 24.366 ms                 |
| OneStep                   | 290.073 ms                | 509.347 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.097 ms                  | 94.485 ms                 |
| Forward                   | 9.556 ms                  | 14.437 ms                 |
| Backward                  | 235.238 ms                | 376.406 ms                |
| Optimize                  | 4.358 ms                  | 8.839 ms                  |
| BarrierTimeBeforeRank0    | 30.953 ms                 | 248.271 ms                |
| BlockToStepN              | 37.276 us                 | 24.366 ms                 |
| OneStep                   | 289.967 ms                | 509.347 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.165 ms                  | 94.485 ms                 |
| Forward                   | 9.568 ms                  | 13.944 ms                 |
| Backward                  | 235.274 ms                | 376.406 ms                |
| Optimize                  | 4.363 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 30.606 ms                 | 239.422 ms                |
| BlockToStepN              | 37.095 us                 | 24.306 ms                 |
| OneStep                   | 289.915 ms                | 506.882 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.165 ms                  | 94.485 ms                 |
| Forward                   | 9.594 ms                  | 13.944 ms                 |
| Backward                  | 235.274 ms                | 376.406 ms                |
| Optimize                  | 4.374 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 30.239 ms                 | 239.422 ms                |
| BlockToStepN              | 36.659 us                 | 24.306 ms                 |
| OneStep                   | 289.148 ms                | 506.882 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.097 ms                  | 94.485 ms                 |
| Forward                   | 9.594 ms                  | 13.944 ms                 |
| Backward                  | 235.580 ms                | 376.406 ms                |
| Optimize                  | 4.373 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 30.448 ms                 | 239.422 ms                |
| BlockToStepN              | 36.519 us                 | 24.306 ms                 |
| OneStep                   | 289.842 ms                | 506.882 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 30.568, sample: 1.079, forward: 1.029, backward: 24.450, update: 0.432
[proc 7] 400 steps, total: 30.568, sample: 1.070, forward: 1.855, backward: 22.052, update: 0.330
[proc 4] 400 steps, total: 30.568, sample: 0.879, forward: 1.948, backward: 24.000, update: 0.282
[proc 1] 400 steps, total: 30.568, sample: 1.055, forward: 2.003, backward: 23.433, update: 0.372
[proc 5] 400 steps, total: 30.568, sample: 0.987, forward: 1.958, backward: 23.867, update: 0.388
[proc 6] 400 steps, total: 30.568, sample: 0.942, forward: 1.888, backward: 23.159, update: 0.409
[proc 3] 400 steps, total: 30.568, sample: 1.277, forward: 2.207, backward: 25.715, update: 0.408
[proc 2] 400 steps, total: 30.569, sample: 1.044, forward: 1.930, backward: 23.748, update: 0.256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.993 ms                  | 94.485 ms                 |
| Forward                   | 9.598 ms                  | 14.437 ms                 |
| Backward                  | 235.274 ms                | 376.406 ms                |
| Optimize                  | 4.382 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 30.866 ms                 | 239.422 ms                |
| BlockToStepN              | 36.403 us                 | 24.306 ms                 |
| OneStep                   | 290.466 ms                | 506.882 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.083 ms                  | 95.704 ms                 |
| Forward                   | 9.567 ms                  | 14.437 ms                 |
| Backward                  | 235.133 ms                | 376.406 ms                |
| Optimize                  | 4.382 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 31.522 ms                 | 239.422 ms                |
| BlockToStepN              | 36.505 us                 | 24.306 ms                 |
| OneStep                   | 291.121 ms                | 506.882 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.097 ms                  | 95.704 ms                 |
| Forward                   | 9.566 ms                  | 14.437 ms                 |
| Backward                  | 234.369 ms                | 376.406 ms                |
| Optimize                  | 4.378 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 32.159 ms                 | 239.422 ms                |
| BlockToStepN              | 36.519 us                 | 24.306 ms                 |
| OneStep                   | 291.768 ms                | 506.882 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.993 ms                  | 94.485 ms                 |
| Forward                   | 9.566 ms                  | 13.944 ms                 |
| Backward                  | 234.088 ms                | 376.406 ms                |
| Optimize                  | 4.374 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 32.821 ms                 | 239.422 ms                |
| BlockToStepN              | 36.403 us                 | 24.306 ms                 |
| OneStep                   | 292.215 ms                | 506.882 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.957 ms                  | 94.485 ms                 |
| Forward                   | 9.558 ms                  | 13.944 ms                 |
| Backward                  | 234.015 ms                | 376.000 ms                |
| Optimize                  | 4.374 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 33.412 ms                 | 226.229 ms                |
| BlockToStepN              | 36.392 us                 | 21.815 ms                 |
| OneStep                   | 292.579 ms                | 504.526 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.993 ms                  | 95.704 ms                 |
| Forward                   | 9.567 ms                  | 14.437 ms                 |
| Backward                  | 233.609 ms                | 376.000 ms                |
| Optimize                  | 4.374 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 33.715 ms                 | 226.229 ms                |
| BlockToStepN              | 36.401 us                 | 24.306 ms                 |
| OneStep                   | 292.392 ms                | 504.526 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 152.68331789970398 seconds
before call kg_cache_controller.StopThreads()
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
INFO [18456 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.993 ms                  | 95.704 ms                 |
| Forward                   | 9.564 ms                  | 14.437 ms                 |
| Backward                  | 233.432 ms                | 376.000 ms                |
| Optimize                  | 4.374 ms                  | 7.895 ms                  |
| BarrierTimeBeforeRank0    | 33.973 ms                 | 226.229 ms                |
| BlockToStepN              | 36.390 us                 | 24.306 ms                 |
| OneStep                   | 292.579 ms                | 504.526 ms                |
+---------------------------+---------------------------+---------------------------+
