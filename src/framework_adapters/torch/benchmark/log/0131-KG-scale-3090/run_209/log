WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 19:04:56.122557 23087 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_11', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [23087 sampler.py:454] Start PreSampling
WARNING [23087 sampler.py:532] Before construct renumbering_dict
WARNING [23087 sampler.py:555] PreSampling done
W20240206 19:25:28.243940 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 19:25:28.244153 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 19:25:28.244197 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 19:25:28.244231 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 19:25:28.244261 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 19:25:28.244300 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 19:25:28.244330 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 19:25:28.244369 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 19:25:28.244407 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 19:25:28.244436 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 19:25:28.244475 23087 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 19:25:28.244503 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 19:25:28.244529 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 19:25:28.244688 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 19:25:28.244736 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 19:25:28.244768 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 19:25:28.244815 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 19:25:28.244845 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 19:25:28.244884 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 19:25:28.244926 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 19:25:28.244961 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 19:25:28.245000 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 19:25:28.245041 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 19:25:28.245076 23087 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 19:25:28.245101 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 19:25:28.245131 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 19:25:28.245193 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 19:25:28.245231 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 19:25:28.245260 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 19:25:28.245290 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 19:25:28.245321 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 19:25:28.245357 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 19:25:28.245386 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 19:25:28.245421 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 19:25:28.245452 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 19:25:28.245487 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 19:25:28.245518 23087 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 19:25:28.245543 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 19:25:28.245568 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 19:25:28.245635 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 19:25:28.245672 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 19:25:28.245708 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 19:25:28.245738 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 19:25:28.245769 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 19:25:28.245797 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 19:25:28.245831 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 19:25:28.245872 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 19:25:28.245910 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 19:25:28.245951 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 19:25:28.245980 23087 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 19:25:28.246006 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 19:25:28.246030 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 19:25:28.246096 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 19:25:28.246133 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 19:25:28.246165 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 19:25:28.246198 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 19:25:28.246232 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 19:25:28.246261 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 19:25:28.246291 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 19:25:28.246325 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 19:25:28.246363 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 19:25:28.246395 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 19:25:28.246430 23087 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 19:25:28.246456 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 19:25:28.246481 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 19:25:28.246536 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 19:25:28.246568 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 19:25:28.246598 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 19:25:28.246629 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 19:25:28.246659 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 19:25:28.246690 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 19:25:28.246727 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 19:25:28.246766 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 19:25:28.246809 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 19:25:28.246841 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 19:25:28.246873 23087 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 19:25:28.246898 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 19:25:28.246923 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 19:25:28.246980 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 19:25:28.247012 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 19:25:28.247049 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 19:25:28.247087 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 19:25:28.247128 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 19:25:28.247164 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 19:25:28.247202 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 19:25:28.247238 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 19:25:28.247269 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 19:25:28.247303 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 19:25:28.247334 23087 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 19:25:28.247360 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 19:25:28.247385 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 19:25:28.247444 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240206 19:25:28.247476 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240206 19:25:28.247514 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240206 19:25:28.247545 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240206 19:25:28.247576 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240206 19:25:28.247615 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240206 19:25:28.247651 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240206 19:25:28.247691 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240206 19:25:28.247727 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240206 19:25:28.247762 23087 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240206 19:25:28.247792 23087 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240206 19:25:28.247817 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240206 19:25:28.247846 23087 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240206 19:25:28.727524 23087 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240206 19:34:09.036710 23087 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302707,  4302733,   100886,  ..., 66838012, 52408925,  5182230]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2260.155 seconds
[Rank1] pid = 24204
[Rank2] pid = 24299
[Rank3] pid = 24368
[Rank4] pid = 24435
[Rank5] pid = 24502
[Rank6] pid = 24571
INFO [23087 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [24204 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [24299 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [24368 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [24435 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [24571 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [24502 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [24638 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [24368 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24571 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24638 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24435 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24502 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [23087 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24204 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24299 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [23087 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24368 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24638 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24204 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24502 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24571 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24435 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24299 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 19:42:56.973682 24300 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240206 19:42:56.974109 24572 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:42:56.974282 24704 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:42:56.974472 24436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:42:56.974668 24503 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:42:56.974851 24205 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:42:56.974997 24639 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 19:42:56.975163 24369 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240206 19:42:58.720726 24639 recstore.cc:66] init folly done
E20240206 19:42:58.720732 24436 recstore.cc:66] init folly done
E20240206 19:42:58.720732 24300 recstore.cc:66] init folly done
E20240206 19:42:58.720737 24704 recstore.cc:66] init folly done
E20240206 19:42:58.720758 24369 recstore.cc:66] init folly done
E20240206 19:42:58.720775 24572 recstore.cc:66] init folly done
E20240206 19:42:58.721482 24205 recstore.cc:66] init folly done
E20240206 19:42:58.721824 24503 recstore.cc:66] init folly done
I20240206 19:43:04.720793 24503 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240206 19:43:04.821276 24704 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:43:04.865492 24436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:43:06.537349 24300 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:43:06.877020 24205 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:43:07.076823 24369 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:43:07.270860 24639 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 19:43:08.146844 24572 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.548 ms                 | 24.558 ms                 |
| bucket keys               | 3.012 ms                  | 132.602 ms                |
| forward: a2a keys         | 20.253 ms                 | 1.463 s                   |
| forward: search cache     | 434.583 us                | 23.165 ms                 |
| forward: a2a values       | 9.952 ms                  | 46.445 ms                 |
| forward: join             | 3.023 ms                  | 4.189 ms                  |
| Forward                   | 94.156 ms                 | 2.000 s                   |
| back: aggr dram keys      | 21.098 ms                 | 1.058 s                   |
| back: set dram grad       | 2.087 ms                  | 13.321 ms                 |
| back: a2a grad            | 12.318 ms                 | 52.537 ms                 |
| back: grad sum & grad cache  | 5.461 ms                  | 125.354 ms                |
| Backward                  | 1.458 s                   | 1.458 s                   |
| Optimize                  | 57.993 ms                 | 57.993 ms                 |
| BarrierTimeBeforeRank0    | 178.024 us                | 178.024 us                |
| BlockToStepN              | 81.110 us                 | 81.110 us                 |
| OneStep                   | 3.543 s                   | 3.543 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.994 ms                  | 197.342 ms                |
| bucket keys               | 3.012 ms                  | 132.602 ms                |
| forward: a2a keys         | 6.859 ms                  | 1.463 s                   |
| forward: search cache     | 428.138 us                | 23.165 ms                 |
| forward: a2a values       | 9.952 ms                  | 46.445 ms                 |
| forward: join             | 2.706 ms                  | 4.189 ms                  |
| Forward                   | 60.496 ms                 | 2.000 s                   |
| back: aggr dram keys      | 59.032 ms                 | 1.058 s                   |
| back: set dram grad       | 4.253 ms                  | 13.321 ms                 |
| back: a2a grad            | 12.318 ms                 | 52.537 ms                 |
| back: grad sum & grad cache  | 5.461 ms                  | 125.354 ms                |
| Backward                  | 253.252 ms                | 1.458 s                   |
| Optimize                  | 27.445 ms                 | 57.993 ms                 |
| BarrierTimeBeforeRank0    | 61.561 us                 | 178.024 us                |
| BlockToStepN              | 62.002 us                 | 81.110 us                 |
| OneStep                   | 349.953 ms                | 3.543 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.530 ms                  | 225.290 ms                |
| bucket keys               | 3.550 ms                  | 4.372 ms                  |
| forward: a2a keys         | 7.471 ms                  | 61.854 ms                 |
| forward: search cache     | 428.979 us                | 870.569 us                |
| forward: a2a values       | 9.952 ms                  | 28.886 ms                 |
| forward: join             | 2.704 ms                  | 3.974 ms                  |
| Forward                   | 60.872 ms                 | 2.000 s                   |
| back: aggr dram keys      | 46.437 ms                 | 111.035 ms                |
| back: set dram grad       | 2.087 ms                  | 4.899 ms                  |
| back: a2a grad            | 25.834 ms                 | 50.604 ms                 |
| back: grad sum & grad cache  | 6.749 ms                  | 136.610 ms                |
| Backward                  | 253.471 ms                | 1.458 s                   |
| Optimize                  | 27.309 ms                 | 57.993 ms                 |
| BarrierTimeBeforeRank0    | 53.384 us                 | 178.024 us                |
| BlockToStepN              | 61.352 us                 | 8.253 ms                  |
| OneStep                   | 359.086 ms                | 3.543 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.783 ms                  | 225.290 ms                |
| bucket keys               | 3.550 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.408 ms                  | 130.753 ms                |
| forward: search cache     | 428.979 us                | 870.569 us                |
| forward: a2a values       | 9.952 ms                  | 28.886 ms                 |
| forward: join             | 2.683 ms                  | 3.974 ms                  |
| Forward                   | 61.634 ms                 | 2.000 s                   |
| back: aggr dram keys      | 46.437 ms                 | 111.035 ms                |
| back: set dram grad       | 2.303 ms                  | 6.266 ms                  |
| back: a2a grad            | 26.034 ms                 | 50.604 ms                 |
| back: grad sum & grad cache  | 7.476 ms                  | 148.899 ms                |
| Backward                  | 255.701 ms                | 1.458 s                   |
| Optimize                  | 27.309 ms                 | 57.993 ms                 |
| BarrierTimeBeforeRank0    | 51.052 us                 | 178.024 us                |
| BlockToStepN              | 61.939 us                 | 8.253 ms                  |
| OneStep                   | 361.885 ms                | 3.543 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.269 ms                  | 197.342 ms                |
| bucket keys               | 3.550 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.471 ms                  | 130.753 ms                |
| forward: search cache     | 429.418 us                | 1.241 ms                  |
| forward: a2a values       | 9.952 ms                  | 28.886 ms                 |
| forward: join             | 2.683 ms                  | 3.974 ms                  |
| Forward                   | 61.872 ms                 | 185.658 ms                |
| back: aggr dram keys      | 46.437 ms                 | 111.035 ms                |
| back: set dram grad       | 2.303 ms                  | 6.266 ms                  |
| back: a2a grad            | 25.441 ms                 | 50.604 ms                 |
| back: grad sum & grad cache  | 7.476 ms                  | 148.899 ms                |
| Backward                  | 256.229 ms                | 356.932 ms                |
| Optimize                  | 27.286 ms                 | 53.110 ms                 |
| BarrierTimeBeforeRank0    | 49.082 us                 | 178.024 us                |
| BlockToStepN              | 61.939 us                 | 2.402 ms                  |
| OneStep                   | 361.885 ms                | 664.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.522 ms                  | 197.342 ms                |
| bucket keys               | 3.380 ms                  | 4.594 ms                  |
| forward: a2a keys         | 7.721 ms                  | 215.520 ms                |
| forward: search cache     | 428.422 us                | 2.545 ms                  |
| forward: a2a values       | 9.952 ms                  | 28.886 ms                 |
| forward: join             | 2.636 ms                  | 3.974 ms                  |
| Forward                   | 62.685 ms                 | 280.859 ms                |
| back: aggr dram keys      | 46.437 ms                 | 111.035 ms                |
| back: set dram grad       | 2.801 ms                  | 6.266 ms                  |
| back: a2a grad            | 24.770 ms                 | 50.604 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 148.899 ms                |
| Backward                  | 252.418 ms                | 356.932 ms                |
| Optimize                  | 27.019 ms                 | 53.110 ms                 |
| BarrierTimeBeforeRank0    | 46.310 us                 | 178.024 us                |
| BlockToStepN              | 61.470 us                 | 2.402 ms                  |
| OneStep                   | 357.256 ms                | 708.164 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.269 ms                  | 197.342 ms                |
| bucket keys               | 3.365 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.950 ms                  | 133.511 ms                |
| forward: search cache     | 428.288 us                | 1.274 ms                  |
| forward: a2a values       | 9.952 ms                  | 40.247 ms                 |
| forward: join             | 2.636 ms                  | 3.974 ms                  |
| Forward                   | 62.910 ms                 | 280.859 ms                |
| back: aggr dram keys      | 46.437 ms                 | 102.651 ms                |
| back: set dram grad       | 2.801 ms                  | 5.711 ms                  |
| back: a2a grad            | 24.656 ms                 | 49.328 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 141.032 ms                |
| Backward                  | 247.859 ms                | 356.932 ms                |
| Optimize                  | 26.671 ms                 | 53.110 ms                 |
| BarrierTimeBeforeRank0    | 46.039 us                 | 178.024 us                |
| BlockToStepN              | 60.954 us                 | 8.253 ms                  |
| OneStep                   | 352.523 ms                | 708.164 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.031 ms                  | 197.342 ms                |
| bucket keys               | 3.365 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.837 ms                  | 203.379 ms                |
| forward: search cache     | 430.426 us                | 1.274 ms                  |
| forward: a2a values       | 11.012 ms                 | 40.247 ms                 |
| forward: join             | 2.636 ms                  | 3.974 ms                  |
| Forward                   | 63.103 ms                 | 286.580 ms                |
| back: aggr dram keys      | 46.437 ms                 | 102.651 ms                |
| back: set dram grad       | 2.801 ms                  | 5.711 ms                  |
| back: a2a grad            | 24.852 ms                 | 49.328 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 141.032 ms                |
| Backward                  | 243.760 ms                | 356.932 ms                |
| Optimize                  | 26.671 ms                 | 53.586 ms                 |
| BarrierTimeBeforeRank0    | 44.755 us                 | 178.024 us                |
| BlockToStepN              | 60.112 us                 | 14.130 ms                 |
| OneStep                   | 351.543 ms                | 708.164 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 43.250, sample: 2.173, forward: 9.320, backward: 15.159, update: 0.447
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 43.206, sample: 2.044, forward: 9.475, backward: 14.856, update: 0.426
[Rank7] pid = 24638
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([   40119,    40143,    40167,    40188,  5917603,   137649, 58921434,
        17718524, 20962681,    40210]) tensor([ 5336106, 15757175, 65966620, 68409141, 19729966, 31631270, 35565195,
        79854405, 72372319, 28902866])
-------Step 1-------
tensor([   40119,    40143,    40167,    40188,  5917603,   137649, 58921434,
        17718524, 20962681,    40210]) tensor([64382175, 27458623, 10801033, 81312129, 84152742, 44695504, 66580322,
        46140741, 38053045, 12921115])
-------Step 2-------
tensor([   99419,    99442,    99464,    20362,    99493,    99519,    99541,
        25580955,    99562,    99586]) tensor([65694914, 23285862, 75222353, 52586875, 40853873, 27690267, 64658210,
        41316963, 14047231, 43695083])
-------Step 3-------
tensor([   99419,    99442,    99464,    20362,    99493,    99519,    99541,
        25580955,    99562,    99586]) tensor([51909500, 84941990, 35488546, 39460070, 70630285, 59041808, 35535970,
        16289271, 26152032,   773172])
-------Step 4-------
tensor([  159219, 46764056,   159245,   174423,   159265,   174475,   159297,
        41413576,   159314,   159340]) tensor([83242338,  9571828, 76497736, 17719077, 78010165, 40582474, 59995070,
        38616692, 83881605, 48253616])
-------Step 5-------
tensor([  159219, 46764056,   159245,   174423,   159265,   174475,   159297,
        41413576,   159314,   159340]) tensor([34067352, 82107137,   198382, 84939502, 61128733, 50957042, 14725619,
         9470029, 78879548, 38748748])
-------Step 6-------
tensor([  219482,    42798,   219512,   219538,    42826, 67397576,   219564,
          219599,   192412, 37324253]) tensor([13178481, 39468138, 36708414, 74015873, 32607031, 35604215, 24748903,
         6730836, 62489562, 82964987])
-------Step 7-------
tensor([  219482,    42798,   219512,   219538,    42826, 67397576,   219564,
          219599,   192412, 37324253]) tensor([24140863, 48900834, 76873317, 58552522, 73873828, 47224668, 57841676,
        60652972, 36482878, 32148035])
-------Step 8-------
tensor([  278032, 24256276,   278062,   209156,   278086,    52956,   278108,
          278134,   278156,   278181]) tensor([42594142, 25456690, 34125658,  1881850, 46593103, 60634673, 15177390,
        78916115,  1485088, 68444728])
-------Step 9-------
tensor([  278032, 24256276,   278062,   209156,   278086,    52956,   278108,
          278134,   278156,   278181]) tensor([49251389, 36064671, 14038567, 51445134,  9050527, 42877975, 27638320,
        38066814, 84759184, 73132377])
before start barrier
start train
[proc 0] 100 steps, total: 40.801, sample: 1.722, forward: 9.244, backward: 25.917, update: 2.865
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 41.534, sample: 2.315, forward: 9.170, backward: 15.255, update: 0.448
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 43.351, sample: 1.946, forward: 9.558, backward: 14.948, update: 0.512
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 40.995, sample: 2.082, forward: 9.429, backward: 15.195, update: 0.482
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 39.925, sample: 2.129, forward: 9.393, backward: 14.928, update: 0.482
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 41.195, sample: 2.430, forward: 9.104, backward: 15.656, update: 0.449
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.972 ms                  | 197.342 ms                |
| bucket keys               | 3.370 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.858 ms                  | 203.379 ms                |
| forward: search cache     | 433.710 us                | 1.274 ms                  |
| forward: a2a values       | 17.859 ms                 | 43.010 ms                 |
| forward: join             | 2.636 ms                  | 4.876 ms                  |
| Forward                   | 63.309 ms                 | 286.580 ms                |
| back: aggr dram keys      | 53.370 ms                 | 102.651 ms                |
| back: set dram grad       | 2.801 ms                  | 5.711 ms                  |
| back: a2a grad            | 25.119 ms                 | 49.328 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 141.032 ms                |
| Backward                  | 243.167 ms                | 356.932 ms                |
| Optimize                  | 26.603 ms                 | 53.586 ms                 |
| BarrierTimeBeforeRank0    | 44.755 us                 | 178.024 us                |
| BlockToStepN              | 59.544 us                 | 16.140 ms                 |
| OneStep                   | 352.523 ms                | 708.164 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.504 ms                  | 197.342 ms                |
| bucket keys               | 3.380 ms                  | 4.594 ms                  |
| forward: a2a keys         | 7.881 ms                  | 203.379 ms                |
| forward: search cache     | 439.871 us                | 1.274 ms                  |
| forward: a2a values       | 17.859 ms                 | 43.010 ms                 |
| forward: join             | 2.636 ms                  | 4.876 ms                  |
| Forward                   | 63.560 ms                 | 286.580 ms                |
| back: aggr dram keys      | 53.370 ms                 | 102.651 ms                |
| back: set dram grad       | 2.801 ms                  | 6.266 ms                  |
| back: a2a grad            | 24.778 ms                 | 49.328 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 141.032 ms                |
| Backward                  | 241.146 ms                | 356.932 ms                |
| Optimize                  | 26.491 ms                 | 53.586 ms                 |
| BarrierTimeBeforeRank0    | 44.570 us                 | 178.024 us                |
| BlockToStepN              | 58.658 us                 | 16.140 ms                 |
| OneStep                   | 351.261 ms                | 708.164 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.522 ms                  | 197.342 ms                |
| bucket keys               | 3.370 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.768 ms                  | 143.496 ms                |
| forward: search cache     | 442.823 us                | 1.252 ms                  |
| forward: a2a values       | 17.861 ms                 | 41.859 ms                 |
| forward: join             | 2.636 ms                  | 4.189 ms                  |
| Forward                   | 63.403 ms                 | 286.580 ms                |
| back: aggr dram keys      | 53.370 ms                 | 93.847 ms                 |
| back: set dram grad       | 2.801 ms                  | 5.711 ms                  |
| back: a2a grad            | 24.770 ms                 | 48.654 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 136.610 ms                |
| Backward                  | 237.425 ms                | 356.932 ms                |
| Optimize                  | 26.411 ms                 | 53.586 ms                 |
| BarrierTimeBeforeRank0    | 44.086 us                 | 178.024 us                |
| BlockToStepN              | 58.401 us                 | 16.140 ms                 |
| OneStep                   | 348.566 ms                | 708.164 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.504 ms                  | 174.989 ms                |
| bucket keys               | 3.362 ms                  | 4.523 ms                  |
| forward: a2a keys         | 7.703 ms                  | 143.496 ms                |
| forward: search cache     | 458.294 us                | 1.252 ms                  |
| forward: a2a values       | 17.859 ms                 | 41.859 ms                 |
| forward: join             | 2.636 ms                  | 4.189 ms                  |
| Forward                   | 63.103 ms                 | 280.859 ms                |
| back: aggr dram keys      | 53.370 ms                 | 93.847 ms                 |
| back: set dram grad       | 2.801 ms                  | 5.711 ms                  |
| back: a2a grad            | 24.770 ms                 | 49.328 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 136.610 ms                |
| Backward                  | 235.791 ms                | 335.852 ms                |
| Optimize                  | 26.314 ms                 | 53.110 ms                 |
| BarrierTimeBeforeRank0    | 43.021 us                 | 126.986 us                |
| BlockToStepN              | 57.262 us                 | 14.130 ms                 |
| OneStep                   | 345.946 ms                | 665.166 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.087 ms                  | 174.989 ms                |
| bucket keys               | 3.362 ms                  | 4.523 ms                  |
| forward: a2a keys         | 7.591 ms                  | 143.496 ms                |
| forward: search cache     | 458.294 us                | 1.252 ms                  |
| forward: a2a values       | 17.861 ms                 | 41.859 ms                 |
| forward: join             | 2.636 ms                  | 4.876 ms                  |
| Forward                   | 62.778 ms                 | 280.859 ms                |
| back: aggr dram keys      | 53.370 ms                 | 93.847 ms                 |
| back: set dram grad       | 4.156 ms                  | 5.814 ms                  |
| back: a2a grad            | 24.778 ms                 | 49.328 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 136.610 ms                |
| Backward                  | 235.791 ms                | 335.852 ms                |
| Optimize                  | 26.369 ms                 | 56.232 ms                 |
| BarrierTimeBeforeRank0    | 42.501 us                 | 126.986 us                |
| BlockToStepN              | 56.426 us                 | 14.130 ms                 |
| OneStep                   | 344.588 ms                | 665.166 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.430 ms                  | 174.989 ms                |
| bucket keys               | 3.365 ms                  | 4.523 ms                  |
| forward: a2a keys         | 7.634 ms                  | 139.286 ms                |
| forward: search cache     | 452.094 us                | 1.241 ms                  |
| forward: a2a values       | 17.861 ms                 | 40.926 ms                 |
| forward: join             | 2.636 ms                  | 4.189 ms                  |
| Forward                   | 62.685 ms                 | 280.859 ms                |
| back: aggr dram keys      | 49.014 ms                 | 88.826 ms                 |
| back: set dram grad       | 4.156 ms                  | 5.711 ms                  |
| back: a2a grad            | 24.852 ms                 | 48.654 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 128.975 ms                |
| Backward                  | 233.128 ms                | 335.852 ms                |
| Optimize                  | 26.416 ms                 | 56.232 ms                 |
| BarrierTimeBeforeRank0    | 42.393 us                 | 126.986 us                |
| BlockToStepN              | 55.318 us                 | 14.130 ms                 |
| OneStep                   | 342.242 ms                | 665.166 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.430 ms                  | 174.989 ms                |
| bucket keys               | 3.356 ms                  | 4.523 ms                  |
| forward: a2a keys         | 7.651 ms                  | 139.286 ms                |
| forward: search cache     | 450.482 us                | 1.245 ms                  |
| forward: a2a values       | 17.102 ms                 | 40.926 ms                 |
| forward: join             | 2.636 ms                  | 4.876 ms                  |
| Forward                   | 62.528 ms                 | 280.859 ms                |
| back: aggr dram keys      | 54.702 ms                 | 88.826 ms                 |
| back: set dram grad       | 4.156 ms                  | 5.711 ms                  |
| back: a2a grad            | 23.798 ms                 | 48.654 ms                 |
| back: grad sum & grad cache  | 8.361 ms                  | 128.975 ms                |
| Backward                  | 231.084 ms                | 335.852 ms                |
| Optimize                  | 26.593 ms                 | 56.232 ms                 |
| BarrierTimeBeforeRank0    | 42.122 us                 | 126.986 us                |
| BlockToStepN              | 55.318 us                 | 16.140 ms                 |
| OneStep                   | 340.430 ms                | 665.166 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 200 steps, total: 34.928, sample: 2.937, forward: 6.695, backward: 14.034, update: 0.480
[proc 4] 200 steps, total: 34.929, sample: 2.066, forward: 7.539, backward: 13.943, update: 0.469
[proc 0] 200 steps, total: 34.929, sample: 1.937, forward: 7.254, backward: 22.818, update: 2.766
[proc 7] 200 steps, total: 34.929, sample: 1.813, forward: 7.838, backward: 14.233, update: 0.451
[proc 2] 200 steps, total: 34.929, sample: 2.037, forward: 7.578, backward: 14.308, update: 0.409
[proc 1] 200 steps, total: 34.929, sample: 2.027, forward: 7.595, backward: 14.709, update: 0.356
[proc 5] 200 steps, total: 34.929, sample: 1.511, forward: 8.143, backward: 14.057, update: 0.473
[proc 3] 200 steps, total: 34.929, sample: 2.457, forward: 7.147, backward: 14.264, update: 0.404
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.239 ms                  | 174.989 ms                |
| bucket keys               | 3.356 ms                  | 4.523 ms                  |
| forward: a2a keys         | 7.782 ms                  | 139.286 ms                |
| forward: search cache     | 465.228 us                | 1.245 ms                  |
| forward: a2a values       | 17.006 ms                 | 40.926 ms                 |
| forward: join             | 2.636 ms                  | 5.000 ms                  |
| Forward                   | 62.778 ms                 | 280.859 ms                |
| back: aggr dram keys      | 55.299 ms                 | 88.826 ms                 |
| back: set dram grad       | 4.231 ms                  | 5.814 ms                  |
| back: a2a grad            | 21.936 ms                 | 49.328 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 128.975 ms                |
| Backward                  | 229.720 ms                | 335.852 ms                |
| Optimize                  | 26.702 ms                 | 56.232 ms                 |
| BarrierTimeBeforeRank0    | 41.654 us                 | 126.986 us                |
| BlockToStepN              | 54.713 us                 | 16.140 ms                 |
| OneStep                   | 339.109 ms                | 665.166 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.003 ms                  | 174.989 ms                |
| bucket keys               | 3.356 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.858 ms                  | 133.511 ms                |
| forward: search cache     | 468.563 us                | 1.241 ms                  |
| forward: a2a values       | 15.950 ms                 | 40.926 ms                 |
| forward: join             | 2.667 ms                  | 4.876 ms                  |
| Forward                   | 62.528 ms                 | 280.859 ms                |
| back: aggr dram keys      | 55.299 ms                 | 87.986 ms                 |
| back: set dram grad       | 4.156 ms                  | 6.266 ms                  |
| back: a2a grad            | 21.360 ms                 | 48.654 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 126.413 ms                |
| Backward                  | 227.313 ms                | 335.852 ms                |
| Optimize                  | 27.000 ms                 | 56.232 ms                 |
| BarrierTimeBeforeRank0    | 41.192 us                 | 126.986 us                |
| BlockToStepN              | 53.982 us                 | 16.140 ms                 |
| OneStep                   | 337.133 ms                | 665.166 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.972 ms                  | 174.989 ms                |
| bucket keys               | 3.356 ms                  | 4.523 ms                  |
| forward: a2a keys         | 7.837 ms                  | 133.511 ms                |
| forward: search cache     | 472.815 us                | 1.241 ms                  |
| forward: a2a values       | 13.886 ms                 | 40.926 ms                 |
| forward: join             | 2.700 ms                  | 4.876 ms                  |
| Forward                   | 62.074 ms                 | 280.859 ms                |
| back: aggr dram keys      | 55.975 ms                 | 88.826 ms                 |
| back: set dram grad       | 4.253 ms                  | 7.723 ms                  |
| back: a2a grad            | 21.143 ms                 | 49.328 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 126.413 ms                |
| Backward                  | 226.604 ms                | 335.852 ms                |
| Optimize                  | 27.137 ms                 | 56.232 ms                 |
| BarrierTimeBeforeRank0    | 40.892 us                 | 126.986 us                |
| BlockToStepN              | 53.537 us                 | 16.140 ms                 |
| OneStep                   | 334.738 ms                | 665.166 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.972 ms                  | 168.455 ms                |
| bucket keys               | 3.360 ms                  | 4.523 ms                  |
| forward: a2a keys         | 7.660 ms                  | 133.511 ms                |
| forward: search cache     | 468.972 us                | 1.241 ms                  |
| forward: a2a values       | 12.361 ms                 | 40.926 ms                 |
| forward: join             | 2.708 ms                  | 4.876 ms                  |
| Forward                   | 61.754 ms                 | 203.038 ms                |
| back: aggr dram keys      | 57.924 ms                 | 88.826 ms                 |
| back: set dram grad       | 4.331 ms                  | 7.723 ms                  |
| back: a2a grad            | 20.487 ms                 | 49.328 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 126.413 ms                |
| Backward                  | 225.748 ms                | 331.435 ms                |
| Optimize                  | 27.309 ms                 | 56.232 ms                 |
| BarrierTimeBeforeRank0    | 40.892 us                 | 126.986 us                |
| BlockToStepN              | 53.498 us                 | 14.130 ms                 |
| OneStep                   | 332.905 ms                | 664.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.858 ms                  | 168.455 ms                |
| bucket keys               | 3.360 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.660 ms                  | 130.753 ms                |
| forward: search cache     | 468.108 us                | 870.569 us                |
| forward: a2a values       | 10.579 ms                 | 40.247 ms                 |
| forward: join             | 2.716 ms                  | 4.876 ms                  |
| Forward                   | 61.587 ms                 | 203.038 ms                |
| back: aggr dram keys      | 58.134 ms                 | 87.986 ms                 |
| back: set dram grad       | 4.402 ms                  | 6.718 ms                  |
| back: a2a grad            | 18.018 ms                 | 48.654 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 126.092 ms                |
| Backward                  | 224.558 ms                | 331.435 ms                |
| Optimize                  | 27.603 ms                 | 56.232 ms                 |
| BarrierTimeBeforeRank0    | 40.700 us                 | 126.986 us                |
| BlockToStepN              | 53.337 us                 | 16.140 ms                 |
| OneStep                   | 330.625 ms                | 664.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.663 ms                  | 168.455 ms                |
| bucket keys               | 3.360 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.651 ms                  | 130.753 ms                |
| forward: search cache     | 472.977 us                | 870.569 us                |
| forward: a2a values       | 10.370 ms                 | 40.247 ms                 |
| forward: join             | 2.729 ms                  | 4.876 ms                  |
| Forward                   | 61.043 ms                 | 203.038 ms                |
| back: aggr dram keys      | 58.182 ms                 | 88.826 ms                 |
| back: set dram grad       | 4.481 ms                  | 8.574 ms                  |
| back: a2a grad            | 15.989 ms                 | 48.654 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 126.092 ms                |
| Backward                  | 223.556 ms                | 331.435 ms                |
| Optimize                  | 27.951 ms                 | 57.993 ms                 |
| BarrierTimeBeforeRank0    | 40.405 us                 | 126.986 us                |
| BlockToStepN              | 53.291 us                 | 16.140 ms                 |
| OneStep                   | 328.977 ms                | 664.832 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 31.373, sample: 1.144, forward: 6.112, backward: 20.140, update: 3.833
[proc 2] 300 steps, total: 31.373, sample: 1.355, forward: 6.246, backward: 16.089, update: 0.464
[proc 5] 300 steps, total: 31.373, sample: 1.051, forward: 6.548, backward: 15.903, update: 0.496
[proc 7] 300 steps, total: 31.373, sample: 1.205, forward: 6.402, backward: 15.985, update: 0.480
[proc 6] 300 steps, total: 31.374, sample: 1.797, forward: 5.819, backward: 15.875, update: 0.451
[proc 4] 300 steps, total: 31.374, sample: 1.272, forward: 6.325, backward: 15.875, update: 0.523
[proc 1] 300 steps, total: 31.373, sample: 1.409, forward: 6.176, backward: 16.404, update: 0.360
[proc 3] 300 steps, total: 31.373, sample: 1.542, forward: 6.104, backward: 15.971, update: 0.389
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.593 ms                  | 168.455 ms                |
| bucket keys               | 3.360 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.644 ms                  | 130.753 ms                |
| forward: search cache     | 473.821 us                | 870.569 us                |
| forward: a2a values       | 10.331 ms                 | 40.247 ms                 |
| forward: join             | 2.745 ms                  | 5.000 ms                  |
| Forward                   | 60.872 ms                 | 203.038 ms                |
| back: aggr dram keys      | 58.202 ms                 | 89.890 ms                 |
| back: set dram grad       | 4.507 ms                  | 9.595 ms                  |
| back: a2a grad            | 14.727 ms                 | 48.654 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 126.092 ms                |
| Backward                  | 223.215 ms                | 331.435 ms                |
| Optimize                  | 28.692 ms                 | 57.993 ms                 |
| BarrierTimeBeforeRank0    | 40.306 us                 | 126.986 us                |
| BlockToStepN              | 53.234 us                 | 16.140 ms                 |
| OneStep                   | 327.255 ms                | 664.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.593 ms                  | 168.455 ms                |
| bucket keys               | 3.360 ms                  | 4.479 ms                  |
| forward: a2a keys         | 7.540 ms                  | 118.574 ms                |
| forward: search cache     | 475.193 us                | 846.150 us                |
| forward: a2a values       | 10.306 ms                 | 39.554 ms                 |
| forward: join             | 2.764 ms                  | 4.876 ms                  |
| Forward                   | 60.610 ms                 | 203.038 ms                |
| back: aggr dram keys      | 58.202 ms                 | 89.452 ms                 |
| back: set dram grad       | 4.549 ms                  | 9.098 ms                  |
| back: a2a grad            | 14.466 ms                 | 48.606 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 125.943 ms                |
| Backward                  | 220.781 ms                | 331.435 ms                |
| Optimize                  | 29.484 ms                 | 57.993 ms                 |
| BarrierTimeBeforeRank0    | 40.306 us                 | 126.986 us                |
| BlockToStepN              | 52.614 us                 | 16.140 ms                 |
| OneStep                   | 324.731 ms                | 664.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.563 ms                  | 168.455 ms                |
| bucket keys               | 3.360 ms                  | 4.479 ms                  |
| forward: a2a keys         | 7.491 ms                  | 118.574 ms                |
| forward: search cache     | 475.850 us                | 846.150 us                |
| forward: a2a values       | 10.208 ms                 | 39.554 ms                 |
| forward: join             | 2.791 ms                  | 4.876 ms                  |
| Forward                   | 60.057 ms                 | 203.038 ms                |
| back: aggr dram keys      | 58.182 ms                 | 89.452 ms                 |
| back: set dram grad       | 4.578 ms                  | 9.098 ms                  |
| back: a2a grad            | 14.063 ms                 | 48.606 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 125.943 ms                |
| Backward                  | 218.829 ms                | 331.435 ms                |
| Optimize                  | 30.073 ms                 | 58.794 ms                 |
| BarrierTimeBeforeRank0    | 40.135 us                 | 126.986 us                |
| BlockToStepN              | 52.370 us                 | 16.140 ms                 |
| OneStep                   | 321.244 ms                | 664.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.463 ms                  | 150.430 ms                |
| bucket keys               | 3.360 ms                  | 4.516 ms                  |
| forward: a2a keys         | 7.406 ms                  | 118.574 ms                |
| forward: search cache     | 476.220 us                | 846.150 us                |
| forward: a2a values       | 10.241 ms                 | 39.554 ms                 |
| forward: join             | 2.804 ms                  | 4.876 ms                  |
| Forward                   | 60.028 ms                 | 199.580 ms                |
| back: aggr dram keys      | 58.134 ms                 | 89.890 ms                 |
| back: set dram grad       | 4.603 ms                  | 9.098 ms                  |
| back: a2a grad            | 13.952 ms                 | 48.606 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 125.943 ms                |
| Backward                  | 216.788 ms                | 296.547 ms                |
| Optimize                  | 30.587 ms                 | 58.794 ms                 |
| BarrierTimeBeforeRank0    | 40.081 us                 | 111.872 us                |
| BlockToStepN              | 51.935 us                 | 14.130 ms                 |
| OneStep                   | 320.112 ms                | 606.753 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.358 ms                  | 150.430 ms                |
| bucket keys               | 3.359 ms                  | 4.479 ms                  |
| forward: a2a keys         | 7.376 ms                  | 111.570 ms                |
| forward: search cache     | 475.803 us                | 842.714 us                |
| forward: a2a values       | 10.241 ms                 | 34.656 ms                 |
| forward: join             | 2.815 ms                  | 4.785 ms                  |
| Forward                   | 59.774 ms                 | 199.580 ms                |
| back: aggr dram keys      | 58.134 ms                 | 89.890 ms                 |
| back: set dram grad       | 4.617 ms                  | 9.703 ms                  |
| back: a2a grad            | 14.014 ms                 | 48.606 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 125.943 ms                |
| Backward                  | 214.545 ms                | 296.547 ms                |
| Optimize                  | 31.418 ms                 | 58.794 ms                 |
| BarrierTimeBeforeRank0    | 39.970 us                 | 111.872 us                |
| BlockToStepN              | 51.935 us                 | 14.130 ms                 |
| OneStep                   | 319.464 ms                | 606.753 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.385 ms                  | 150.430 ms                |
| bucket keys               | 3.355 ms                  | 4.479 ms                  |
| forward: a2a keys         | 7.323 ms                  | 111.570 ms                |
| forward: search cache     | 475.435 us                | 842.714 us                |
| forward: a2a values       | 10.165 ms                 | 34.656 ms                 |
| forward: join             | 2.820 ms                  | 4.785 ms                  |
| Forward                   | 59.519 ms                 | 199.580 ms                |
| back: aggr dram keys      | 58.213 ms                 | 89.452 ms                 |
| back: set dram grad       | 4.640 ms                  | 9.595 ms                  |
| back: a2a grad            | 13.964 ms                 | 48.576 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 125.640 ms                |
| Backward                  | 213.200 ms                | 296.547 ms                |
| Optimize                  | 31.695 ms                 | 58.794 ms                 |
| BarrierTimeBeforeRank0    | 39.970 us                 | 111.872 us                |
| BlockToStepN              | 51.526 us                 | 14.130 ms                 |
| OneStep                   | 316.910 ms                | 606.753 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 400 steps, total: 29.973, sample: 0.916, forward: 5.914, backward: 16.270, update: 0.495
[proc 7] 400 steps, total: 29.973, sample: 0.966, forward: 5.866, backward: 16.351, update: 0.486
[proc 4] 400 steps, total: 29.973, sample: 1.078, forward: 5.701, backward: 16.313, update: 0.489
[proc 1] 400 steps, total: 29.972, sample: 1.184, forward: 5.630, backward: 16.755, update: 0.396
[proc 6] 400 steps, total: 29.973, sample: 1.426, forward: 5.409, backward: 16.256, update: 0.448
[proc 0] 400 steps, total: 29.973, sample: 1.142, forward: 5.382, backward: 19.031, update: 4.219
[proc 2] 400 steps, total: 29.973, sample: 1.085, forward: 5.720, backward: 16.468, update: 0.421
[proc 3] 400 steps, total: 29.972, sample: 1.208, forward: 5.606, backward: 16.365, update: 0.429
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.385 ms                  | 150.430 ms                |
| bucket keys               | 3.354 ms                  | 4.479 ms                  |
| forward: a2a keys         | 7.274 ms                  | 111.570 ms                |
| forward: search cache     | 474.899 us                | 842.714 us                |
| forward: a2a values       | 10.135 ms                 | 38.456 ms                 |
| forward: join             | 2.822 ms                  | 4.785 ms                  |
| Forward                   | 59.135 ms                 | 199.580 ms                |
| back: aggr dram keys      | 58.232 ms                 | 89.452 ms                 |
| back: set dram grad       | 4.674 ms                  | 9.595 ms                  |
| back: a2a grad            | 13.950 ms                 | 48.576 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 125.640 ms                |
| Backward                  | 212.269 ms                | 296.547 ms                |
| Optimize                  | 32.867 ms                 | 58.794 ms                 |
| BarrierTimeBeforeRank0    | 39.885 us                 | 111.872 us                |
| BlockToStepN              | 51.085 us                 | 16.140 ms                 |
| OneStep                   | 315.690 ms                | 606.753 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.254 ms                  | 150.430 ms                |
| bucket keys               | 3.354 ms                  | 4.453 ms                  |
| forward: a2a keys         | 7.252 ms                  | 104.624 ms                |
| forward: search cache     | 474.861 us                | 842.714 us                |
| forward: a2a values       | 10.106 ms                 | 34.656 ms                 |
| forward: join             | 2.825 ms                  | 4.785 ms                  |
| Forward                   | 58.319 ms                 | 199.580 ms                |
| back: aggr dram keys      | 58.311 ms                 | 89.452 ms                 |
| back: set dram grad       | 4.699 ms                  | 9.595 ms                  |
| back: a2a grad            | 13.920 ms                 | 48.576 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 125.640 ms                |
| Backward                  | 210.939 ms                | 296.547 ms                |
| Optimize                  | 34.478 ms                 | 64.289 ms                 |
| BarrierTimeBeforeRank0    | 39.782 us                 | 111.872 us                |
| BlockToStepN              | 50.773 us                 | 16.140 ms                 |
| OneStep                   | 315.071 ms                | 606.753 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.146 ms                  | 150.430 ms                |
| bucket keys               | 3.354 ms                  | 4.479 ms                  |
| forward: a2a keys         | 7.193 ms                  | 104.624 ms                |
| forward: search cache     | 474.646 us                | 842.714 us                |
| forward: a2a values       | 10.049 ms                 | 34.656 ms                 |
| forward: join             | 2.830 ms                  | 4.785 ms                  |
| Forward                   | 57.730 ms                 | 199.580 ms                |
| back: aggr dram keys      | 58.360 ms                 | 89.452 ms                 |
| back: set dram grad       | 4.721 ms                  | 9.703 ms                  |
| back: a2a grad            | 13.920 ms                 | 48.239 ms                 |
| back: grad sum & grad cache  | 9.545 ms                  | 125.433 ms                |
| Backward                  | 210.164 ms                | 296.547 ms                |
| Optimize                  | 36.157 ms                 | 64.701 ms                 |
| BarrierTimeBeforeRank0    | 39.733 us                 | 111.872 us                |
| BlockToStepN              | 50.073 us                 | 16.140 ms                 |
| OneStep                   | 313.799 ms                | 606.753 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 151.9767210483551 seconds
before call kg_cache_controller.StopThreads()
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
INFO [23087 controller_process.py:421] call rank0 to StopThreads
