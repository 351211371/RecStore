WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240207 07:43:49.417279 17285 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_32', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=3, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=3, gpu=[0, 1, 2], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [17285 sampler.py:454] Start PreSampling
WARNING [17285 sampler.py:532] Before construct renumbering_dict
WARNING [17285 sampler.py:555] PreSampling done
W20240207 08:02:37.800729 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240207 08:02:37.800917 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240207 08:02:37.800958 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240207 08:02:37.800988 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240207 08:02:37.801025 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240207 08:02:37.801057 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240207 08:02:37.801091 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240207 08:02:37.801127 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240207 08:02:37.801155 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240207 08:02:37.801187 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240207 08:02:37.801226 17285 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240207 08:02:37.801256 17285 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240207 08:02:37.801283 17285 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240207 08:02:37.801452 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240207 08:02:37.801489 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240207 08:02:37.801518 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240207 08:02:37.801560 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240207 08:02:37.801589 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240207 08:02:37.801620 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240207 08:02:37.801647 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240207 08:02:37.801676 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240207 08:02:37.801717 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240207 08:02:37.801750 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240207 08:02:37.801782 17285 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240207 08:02:37.801805 17285 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240207 08:02:37.801833 17285 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240207 08:02:37.801890 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240207 08:02:37.801925 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240207 08:02:37.801956 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240207 08:02:37.801985 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240207 08:02:37.802011 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240207 08:02:37.802042 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240207 08:02:37.802070 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240207 08:02:37.802109 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240207 08:02:37.802141 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240207 08:02:37.802170 17285 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240207 08:02:37.802197 17285 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240207 08:02:37.802220 17285 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240207 08:02:37.802245 17285 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240207 08:02:38.186969 17285 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x10000e52e000 128.2 GB
W20240207 08:11:12.162569 17285 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10201d166000 328.3 MB
{0: Graph(num_nodes=32806815, num_edges=98289586,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=31756927, num_edges=120802495,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=32681333, num_edges=137186093,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 32806815 N 98289586 E
MertisPartition: part 1 has 31756927 N 120802495 E
MertisPartition: part 2 has 32681333 N 137186093 E
Rank0: cached key size 1434235
Rank1: cached key size 1434235
Rank2: cached key size 1434235
Before renumbering graph:  {'_ID': tensor([     196,      197,      239,  ..., 85907466, 77843586,   627118]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([ 4309510,  4309553,  4310969,  ..., 84444033, 72513488, 27197174]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=32806815, num_edges=98289586,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=32806815, num_edges=98289586,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2148.816 seconds
[Rank1] pid = 18422
INFO [17285 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [17285 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
INFO [18517 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [18422 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [18422 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
INFO [18517 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
W20240207 08:19:42.781642 18518 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240207 08:19:42.785658 18423 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240207 08:19:42.785652 18581 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240207 08:19:42.832669 18423 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1020319b3000 7.629 MB
W20240207 08:19:42.832684 18518 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102032156000 7.629 MB
W20240207 08:19:42.832706 18581 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1020328f9000 7.629 MB
W20240207 08:19:42.832947 18581 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10203309c000 7.629 MB
W20240207 08:19:42.833000 18518 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10203383f000 7.629 MB
W20240207 08:19:42.833020 18423 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102033fe2000 7.629 MB
W20240207 08:19:42.833045 18581 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102034785000 1.49 GB
W20240207 08:19:42.833096 18581 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102093d68000 1.49 GB
W20240207 08:19:42.833144 18518 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1020f334b000 1.49 GB
W20240207 08:19:42.833184 18581 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 08:19:42.833187 18423 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10215292e000 1.49 GB
W20240207 08:19:42.833215 18518 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1021b1f11000 1.49 GB
W20240207 08:19:42.833246 18423 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1022114f4000 1.49 GB
W20240207 08:19:42.834688 18518 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 08:19:42.834689 18423 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 08:19:42.837891 18581 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 08:19:42.837953 18518 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 08:19:42.838016 18423 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x10000e52e000
1: KnownLocalCachedEmbedding init done
WARNING [18422 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000e52e000
2: KnownLocalCachedEmbedding init done
WARNING [18517 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank2] pid = 18517
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121)]
cudaHostRegister 0x10000e52e000
0: KnownLocalCachedEmbedding init done
WARNING [17285 DistTensor.py:59] The tensor name already exists in the kvstore
I20240207 08:20:10.514056 18518 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 3
I20240207 08:20:10.514258 18423 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
I20240207 08:20:10.514333 18581 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
W20240207 08:20:10.515528 18518 grad_base.h:55] KGCacheController, config={
        "num_gpus": 3,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240207 08:20:10.515640 18518 grad_base.h:184] Init GradProcessingBase done
I20240207 08:20:23.041445 18518 grad_async_v1.h:203] Use main thread to update emb.
W20240207 08:20:23.041615 18518 kg_controller.h:75] after init GradAsyncProcessing
I20240207 08:20:23.041625 18518 kg_controller.h:84] Construct KGCacheController done
E20240207 08:20:23.386862 18581 recstore.cc:66] init folly done
E20240207 08:20:23.386879 18423 recstore.cc:66] init folly done
E20240207 08:20:23.386911 18518 recstore.cc:66] init folly done
I20240207 08:20:23.387727 18518 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240207 08:20:42.098598 18518 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 3
I20240207 08:20:45.584987 18423 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
I20240207 08:20:47.721138 18581 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
W20240207 08:20:48.866413 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240207 08:20:49.866004 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.413 ms                  | 107.247 ms                |
| Forward                   | 4.878 ms                  | 436.140 ms                |
| Backward                  | 10.930 ms                 | 245.255 ms                |
| Optimize                  | 2.612 ms                  | 44.160 ms                 |
| BarrierTimeBeforeRank0    | 3.997 ms                  | 12.735 ms                 |
| AfterBackward             | 17.186 ms                 | 368.043 ms                |
| BlockToStepN              | 291.020 ms                | 325.706 ms                |
| OneStep                   | 363.415 ms                | 1.456 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 08:20:50.866006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240207 08:20:51.891741 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240207 08:20:52.891005 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.425 ms                  | 117.622 ms                |
| ProcessBack:UpdateCache   | 1.374 ms                  | 191.041 ms                |
| ProcessBack:UpsertPq      | 12.899 ms                 | 28.059 ms                 |
| ProcessOneStep            | 17.010 ms                 | 367.801 ms                |
| BlockToStepN              | 5.851 ms                  | 324.858 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:20:53.969765 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240207 08:20:54.969007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.341 ms                  | 107.247 ms                |
| Forward                   | 4.830 ms                  | 436.140 ms                |
| Backward                  | 10.997 ms                 | 245.255 ms                |
| Optimize                  | 2.248 ms                  | 44.160 ms                 |
| BarrierTimeBeforeRank0    | 3.934 ms                  | 63.797 ms                 |
| AfterBackward             | 16.931 ms                 | 368.043 ms                |
| BlockToStepN              | 5.887 ms                  | 325.706 ms                |
| OneStep                   | 140.185 ms                | 1.456 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 08:20:55.969007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240207 08:20:57.123008 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240207 08:20:58.123006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.373 ms                  | 80.905 ms                 |
| ProcessBack:UpdateCache   | 1.392 ms                  | 190.149 ms                |
| ProcessBack:UpsertPq      | 11.253 ms                 | 28.059 ms                 |
| ProcessOneStep            | 16.886 ms                 | 367.801 ms                |
| BlockToStepN              | 5.851 ms                  | 324.858 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:20:59.123008 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240207 08:21:00.205427 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.818 ms                  | 104.549 ms                |
| Forward                   | 4.878 ms                  | 7.348 ms                  |
| Backward                  | 11.007 ms                 | 11.311 ms                 |
| Optimize                  | 2.274 ms                  | 4.840 ms                  |
| BarrierTimeBeforeRank0    | 2.254 ms                  | 49.013 ms                 |
| AfterBackward             | 16.931 ms                 | 37.179 ms                 |
| BlockToStepN              | 5.887 ms                  | 311.784 ms                |
| OneStep                   | 140.185 ms                | 475.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:01.205008 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240207 08:21:02.205008 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240207 08:21:03.205008 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.413 ms                  | 80.905 ms                 |
| ProcessBack:UpdateCache   | 1.397 ms                  | 190.149 ms                |
| ProcessBack:UpsertPq      | 12.377 ms                 | 28.697 ms                 |
| ProcessOneStep            | 17.273 ms                 | 37.152 ms                 |
| BlockToStepN              | 265.844 ms                | 311.749 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:04.310918 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240207 08:21:05.310006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.449 ms                  | 107.247 ms                |
| Forward                   | 4.844 ms                  | 10.485 ms                 |
| Backward                  | 11.026 ms                 | 12.344 ms                 |
| Optimize                  | 2.345 ms                  | 6.683 ms                  |
| BarrierTimeBeforeRank0    | 2.254 ms                  | 49.013 ms                 |
| AfterBackward             | 17.831 ms                 | 37.179 ms                 |
| BlockToStepN              | 5.887 ms                  | 311.784 ms                |
| OneStep                   | 140.185 ms                | 518.550 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:06.503588 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240207 08:21:07.503005 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.458 ms                  | 14.285 ms                 |
| ProcessBack:UpdateCache   | 1.401 ms                  | 2.728 ms                  |
| ProcessBack:UpsertPq      | 13.176 ms                 | 28.697 ms                 |
| ProcessOneStep            | 17.735 ms                 | 39.147 ms                 |
| BlockToStepN              | 5.851 ms                  | 311.749 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:08.503005 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 21.344, sample: 1.707, forward: 0.879, backward: 1.283, update: 0.258
train_sampler.Prefill()
-------Step 0-------
tensor([  563548,    55293,   563584, 20943428,   563626,   563662,     2766,
         1153439,   716082,   563692]) tensor([ 8350671, 38050249, 21508384, 53482039, 36463866,   338346, 52106747,
        15226393, 45547284, 57308620])
-------Step 1-------
tensor([  563548,    55293,   563584, 20943428,   563626,   563662,     2766,
         1153439,   716082,   563692]) tensor([49351540, 28571084,  4563607, 58126237, 61596605, 54809054, 17168013,
        28810912,  1804918, 40004059])
-------Step 2-------
tensor([662376, 662401,   2998, 721737, 662448, 662480, 662534, 430172, 662590,
        662623]) tensor([33807036, 52923670, 67799942, 65090792, 18611511, 32211277, 30259497,
        31706198, 68635953, 78691746])
-------Step 3-------
tensor([662376, 662401,   2998, 721737, 662448, 662480, 662534, 430172, 662590,
        662623]) tensor([72052906,  1164536, 67030806, 11667274, 61847493, 12076406, 15745557,
        76183055, 77839933, 68964116])
-------Step 4-------
tensor([  760173,   760196,   324668,   760234,  1167210,   760275, 24068585,
          760311,   760345,   760385]) tensor([49560586, 61984478, 11812541, 77929306, 48154656, 73836101, 15162383,
        34504681,  7761846, 30515117])
-------Step 5-------
tensor([  760173,   760196,   324668,   760234,  1167210,   760275, 24068585,
          760311,   760345,   760385]) tensor([42968145, 53914750, 37927553, 58835975, 11230837, 81389995, 33274965,
        33439861,   752747, 50625548])
-------Step 6-------
tensor([  853802,   853840,   853874,  1174429, 24068585,   853916,   853946,
          853978,   854030,       70]) tensor([59230978, 11276477, 55942478, 30577474,   954008, 42522601, 15077145,
         7960906,   243112, 36489589])
-------Step 7-------
tensor([  853802,   853840,   853874,  1174429, 24068585,   853916,   853946,
          853978,   854030,       70]) tensor([45320159, 45938046, 51711793,   210443, 29393013, 43018291, 68681821,
        81055048, 50297827, 37003522])
-------Step 8-------
tensor([  941093,   941128,   941155,   941189,   737417,   941226, 16876987,
          941261,   941305, 17312713]) tensor([84347398, 30698707, 30075254, 16417052, 70447790, 10233448, 54270143,
         1378934, 53026874, 41137074])
-------Step 9-------
tensor([  941093,   941128,   941155,   941189,   737417,   941226, 16876987,
          941261,   941305, 17312713]) tensor([26730954, 51639772, 46490643, 72606924, 41200719, 58571011, 65163602,
        24964870, 82531488, 30242138])
before start barrier
start train
[proc 0] 100 steps, total: 26.966, sample: 1.686, forward: 0.925, backward: 1.338, update: 0.298
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 23.480, sample: 1.544, forward: 0.857, backward: 1.267, update: 0.290
W20240207 08:21:09.615908 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.157 ms                  | 179.338 ms                |
| Forward                   | 4.817 ms                  | 10.485 ms                 |
| Backward                  | 11.055 ms                 | 14.216 ms                 |
| Optimize                  | 2.335 ms                  | 6.683 ms                  |
| BarrierTimeBeforeRank0    | 791.515 us                | 49.013 ms                 |
| AfterBackward             | 17.549 ms                 | 39.176 ms                 |
| BlockToStepN              | 5.887 ms                  | 311.784 ms                |
| OneStep                   | 140.185 ms                | 518.550 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:10.615005 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240207 08:21:11.615005 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240207 08:21:12.615006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.427 ms                  | 14.285 ms                 |
| ProcessBack:UpdateCache   | 1.407 ms                  | 2.728 ms                  |
| ProcessBack:UpsertPq      | 12.612 ms                 | 28.697 ms                 |
| ProcessOneStep            | 17.316 ms                 | 39.147 ms                 |
| BlockToStepN              | 5.851 ms                  | 311.749 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:13.615006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240207 08:21:14.689853 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.298 ms                  | 179.338 ms                |
| Forward                   | 4.703 ms                  | 10.485 ms                 |
| Backward                  | 11.070 ms                 | 14.216 ms                 |
| Optimize                  | 2.335 ms                  | 6.683 ms                  |
| BarrierTimeBeforeRank0    | 69.321 us                 | 49.013 ms                 |
| AfterBackward             | 17.238 ms                 | 39.176 ms                 |
| BlockToStepN              | 5.887 ms                  | 311.784 ms                |
| OneStep                   | 140.185 ms                | 518.550 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:15.689007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240207 08:21:16.689005 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240207 08:21:17.689006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.413 ms                  | 14.285 ms                 |
| ProcessBack:UpdateCache   | 1.401 ms                  | 2.184 ms                  |
| ProcessBack:UpsertPq      | 12.163 ms                 | 28.059 ms                 |
| ProcessOneStep            | 17.069 ms                 | 37.152 ms                 |
| BlockToStepN              | 5.851 ms                  | 311.749 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:18.726840 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240207 08:21:19.770550 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.981 ms                  | 151.649 ms                |
| Forward                   | 4.674 ms                  | 7.436 ms                  |
| Backward                  | 11.035 ms                 | 12.344 ms                 |
| Optimize                  | 2.330 ms                  | 4.998 ms                  |
| BarrierTimeBeforeRank0    | 541.430 us                | 44.269 ms                 |
| AfterBackward             | 17.098 ms                 | 37.179 ms                 |
| BlockToStepN              | 5.887 ms                  | 309.308 ms                |
| OneStep                   | 140.185 ms                | 516.921 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:20.801074 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240207 08:21:21.801007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240207 08:21:22.805817 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.403 ms                  | 14.285 ms                 |
| ProcessBack:UpdateCache   | 1.390 ms                  | 2.243 ms                  |
| ProcessBack:UpsertPq      | 12.011 ms                 | 25.414 ms                 |
| ProcessOneStep            | 17.082 ms                 | 37.152 ms                 |
| BlockToStepN              | 5.851 ms                  | 309.254 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:23.805006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240207 08:21:24.805006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.692 ms                  | 151.649 ms                |
| Forward                   | 4.640 ms                  | 7.436 ms                  |
| Backward                  | 11.035 ms                 | 12.344 ms                 |
| Optimize                  | 2.345 ms                  | 6.683 ms                  |
| BarrierTimeBeforeRank0    | 881.649 us                | 44.269 ms                 |
| AfterBackward             | 17.300 ms                 | 37.179 ms                 |
| BlockToStepN              | 5.887 ms                  | 309.308 ms                |
| OneStep                   | 140.185 ms                | 516.921 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:25.805006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
[proc 0] 200 steps, total: 17.558, sample: 1.603, forward: 0.451, backward: 1.023, update: 0.256
[proc 2] 200 steps, total: 17.558, sample: 1.388, forward: 0.434, backward: 0.937, update: 0.219
[proc 1] 200 steps, total: 17.558, sample: 1.351, forward: 0.454, backward: 1.099, update: 0.235
W20240207 08:21:26.865824 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240207 08:21:27.922108 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.413 ms                  | 14.896 ms                 |
| ProcessBack:UpdateCache   | 1.387 ms                  | 2.243 ms                  |
| ProcessBack:UpsertPq      | 12.324 ms                 | 28.059 ms                 |
| ProcessOneStep            | 17.316 ms                 | 39.147 ms                 |
| BlockToStepN              | 5.851 ms                  | 309.254 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:28.984575 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240207 08:21:29.984019 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.618 ms                  | 171.584 ms                |
| Forward                   | 4.624 ms                  | 10.485 ms                 |
| Backward                  | 11.012 ms                 | 13.515 ms                 |
| Optimize                  | 2.355 ms                  | 6.683 ms                  |
| BarrierTimeBeforeRank0    | 881.649 us                | 44.269 ms                 |
| AfterBackward             | 17.361 ms                 | 39.176 ms                 |
| BlockToStepN              | 5.887 ms                  | 309.308 ms                |
| OneStep                   | 140.185 ms                | 516.921 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:30.984010 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240207 08:21:31.984007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240207 08:21:33.105319 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.428 ms                  | 14.285 ms                 |
| ProcessBack:UpdateCache   | 1.383 ms                  | 2.977 ms                  |
| ProcessBack:UpsertPq      | 12.588 ms                 | 28.059 ms                 |
| ProcessOneStep            | 17.443 ms                 | 37.152 ms                 |
| BlockToStepN              | 5.851 ms                  | 309.254 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:34.105007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240207 08:21:35.105006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.818 ms                  | 151.649 ms                |
| Forward                   | 4.607 ms                  | 7.436 ms                  |
| Backward                  | 10.982 ms                 | 14.216 ms                 |
| Optimize                  | 2.346 ms                  | 6.064 ms                  |
| BarrierTimeBeforeRank0    | 1.181 ms                  | 40.462 ms                 |
| AfterBackward             | 17.364 ms                 | 37.179 ms                 |
| BlockToStepN              | 5.887 ms                  | 306.564 ms                |
| OneStep                   | 140.185 ms                | 481.649 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:36.105006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240207 08:21:37.175545 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240207 08:21:38.175007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.404 ms                  | 11.167 ms                 |
| ProcessBack:UpdateCache   | 1.364 ms                  | 2.728 ms                  |
| ProcessBack:UpsertPq      | 12.324 ms                 | 26.853 ms                 |
| ProcessOneStep            | 17.421 ms                 | 37.152 ms                 |
| BlockToStepN              | 5.851 ms                  | 306.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:39.199208 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
[proc 1] 300 steps, total: 13.270, sample: 0.979, forward: 0.445, backward: 1.126, update: 0.218
[proc 2] 300 steps, total: 13.270, sample: 1.099, forward: 0.466, backward: 1.122, update: 0.216
[proc 0] 300 steps, total: 13.270, sample: 1.648, forward: 0.477, backward: 0.960, update: 0.293
W20240207 08:21:40.199007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.690 ms                  | 151.649 ms                |
| Forward                   | 4.639 ms                  | 10.485 ms                 |
| Backward                  | 11.013 ms                 | 14.399 ms                 |
| Optimize                  | 2.379 ms                  | 10.228 ms                 |
| BarrierTimeBeforeRank0    | 745.748 us                | 40.462 ms                 |
| AfterBackward             | 17.472 ms                 | 37.179 ms                 |
| BlockToStepN              | 5.887 ms                  | 306.564 ms                |
| OneStep                   | 140.185 ms                | 481.649 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:41.199009 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240207 08:21:42.199007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240207 08:21:43.199009 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.429 ms                  | 7.310 ms                  |
| ProcessBack:UpdateCache   | 1.372 ms                  | 2.986 ms                  |
| ProcessBack:UpsertPq      | 12.367 ms                 | 25.850 ms                 |
| ProcessOneStep            | 17.517 ms                 | 39.147 ms                 |
| BlockToStepN              | 5.851 ms                  | 306.508 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:44.199007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240207 08:21:45.327106 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.459 ms                  | 151.649 ms                |
| Forward                   | 4.662 ms                  | 11.019 ms                 |
| Backward                  | 11.030 ms                 | 14.518 ms                 |
| Optimize                  | 2.418 ms                  | 10.745 ms                 |
| BarrierTimeBeforeRank0    | 386.849 us                | 40.462 ms                 |
| AfterBackward             | 17.542 ms                 | 39.176 ms                 |
| BlockToStepN              | 111.526 ms                | 306.564 ms                |
| OneStep                   | 154.520 ms                | 481.649 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:46.327008 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=351, pq.top=351
W20240207 08:21:47.352777 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.463 ms                  | 7.310 ms                  |
| ProcessBack:UpdateCache   | 1.384 ms                  | 2.986 ms                  |
| ProcessBack:UpsertPq      | 12.473 ms                 | 28.059 ms                 |
| ProcessOneStep            | 17.627 ms                 | 39.147 ms                 |
| BlockToStepN              | 5.851 ms                  | 303.186 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:48.424216 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240207 08:21:49.424008 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240207 08:21:50.424008 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=379, pq.top=379
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.288 ms                  | 150.839 ms                |
| Forward                   | 4.674 ms                  | 10.485 ms                 |
| Backward                  | 11.072 ms                 | 14.819 ms                 |
| Optimize                  | 2.457 ms                  | 10.228 ms                 |
| BarrierTimeBeforeRank0    | 57.186 us                 | 32.905 ms                 |
| AfterBackward             | 17.711 ms                 | 39.176 ms                 |
| BlockToStepN              | 106.160 ms                | 303.243 ms                |
| OneStep                   | 154.520 ms                | 475.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:51.522658 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240207 08:21:52.522009 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
[proc 0] 400 steps, total: 13.501, sample: 1.219, forward: 0.501, backward: 1.188, update: 0.294
[proc 2] 400 steps, total: 13.501, sample: 0.937, forward: 0.458, backward: 1.114, update: 0.244
[proc 1] 400 steps, total: 13.502, sample: 1.036, forward: 0.448, backward: 0.984, update: 0.233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.487 ms                  | 7.031 ms                  |
| ProcessBack:UpdateCache   | 1.389 ms                  | 2.986 ms                  |
| ProcessBack:UpsertPq      | 12.714 ms                 | 28.059 ms                 |
| ProcessOneStep            | 17.721 ms                 | 39.147 ms                 |
| BlockToStepN              | 18.216 ms                 | 303.186 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:53.522007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=401, pq.top=401
W20240207 08:21:54.522007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240207 08:21:55.522006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.241 ms                  | 150.839 ms                |
| Forward                   | 4.674 ms                  | 10.485 ms                 |
| Backward                  | 11.040 ms                 | 14.819 ms                 |
| Optimize                  | 2.446 ms                  | 10.228 ms                 |
| BarrierTimeBeforeRank0    | 66.654 us                 | 32.905 ms                 |
| AfterBackward             | 17.761 ms                 | 40.383 ms                 |
| BlockToStepN              | 18.256 ms                 | 303.243 ms                |
| OneStep                   | 140.185 ms                | 475.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:56.522020 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=425, pq.top=425
W20240207 08:21:57.522008 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=435, pq.top=435
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.502 ms                  | 6.034 ms                  |
| ProcessBack:UpdateCache   | 1.408 ms                  | 2.986 ms                  |
| ProcessBack:UpsertPq      | 12.706 ms                 | 28.059 ms                 |
| ProcessOneStep            | 17.806 ms                 | 40.352 ms                 |
| BlockToStepN              | 18.216 ms                 | 303.186 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:21:58.522006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
W20240207 08:21:59.522007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240207 08:22:00.522007 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=461, pq.top=461
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.320 ms                  | 141.898 ms                |
| Forward                   | 4.679 ms                  | 9.584 ms                  |
| Backward                  | 11.002 ms                 | 14.521 ms                 |
| Optimize                  | 2.435 ms                  | 9.182 ms                  |
| BarrierTimeBeforeRank0    | 240.762 us                | 32.806 ms                 |
| AfterBackward             | 17.750 ms                 | 39.176 ms                 |
| BlockToStepN              | 18.256 ms                 | 302.036 ms                |
| OneStep                   | 140.185 ms                | 474.150 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:22:01.539299 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240207 08:22:02.574616 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=481, pq.top=481
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.512 ms                  | 5.900 ms                  |
| ProcessBack:UpdateCache   | 1.422 ms                  | 2.977 ms                  |
| ProcessBack:UpsertPq      | 12.533 ms                 | 26.853 ms                 |
| ProcessOneStep            | 17.682 ms                 | 39.147 ms                 |
| BlockToStepN              | 18.216 ms                 | 301.936 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 08:22:03.672279 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240207 08:22:04.672006 18518 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=497, pq.top=497
[proc 0] 500 steps, total: 11.607, sample: 1.390, forward: 0.474, backward: 0.534, update: 0.248
[proc 2] 500 steps, total: 11.607, sample: 1.065, forward: 0.455, backward: 1.107, update: 0.217
[proc 1] 500 steps, total: 11.607, sample: 1.004, forward: 0.462, backward: 1.109, update: 0.218
Successfully xmh. training takes 82.90254783630371 seconds
before call kg_cache_controller.StopThreads()
W20240207 08:22:05.001092 18518 grad_async_v1.h:243] call StopThreads. PID = 17285
W20240207 08:22:05.001119 18518 grad_base.h:212] before processOneStepNegThread_.join();
W20240207 08:22:05.009114 18518 grad_base.h:214] after processOneStepNegThread_.join();
W20240207 08:22:05.009130 18518 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240207 08:22:05.141868 18518 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.276 ms                  | 141.898 ms                |
| Forward                   | 4.678 ms                  | 9.584 ms                  |
| Backward                  | 10.953 ms                 | 14.521 ms                 |
| Optimize                  | 2.425 ms                  | 9.182 ms                  |
| BarrierTimeBeforeRank0    | 745.748 us                | 32.806 ms                 |
| AfterBackward             | 17.655 ms                 | 39.176 ms                 |
| BlockToStepN              | 18.256 ms                 | 302.036 ms                |
| OneStep                   | 140.185 ms                | 474.150 ms                |
+---------------------------+---------------------------+---------------------------+
