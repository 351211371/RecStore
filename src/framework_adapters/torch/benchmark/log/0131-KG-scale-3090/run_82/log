WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240203 20:45:03.286566 58433 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_76', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [58433 sampler.py:454] Start PreSampling
WARNING [58433 sampler.py:532] Before construct renumbering_dict
WARNING [58433 sampler.py:555] PreSampling done
W20240203 21:03:57.653714 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240203 21:03:57.653899 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240203 21:03:57.653934 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240203 21:03:57.653970 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240203 21:03:57.654012 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240203 21:03:57.654047 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240203 21:03:57.654079 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240203 21:03:57.654124 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240203 21:03:57.654166 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240203 21:03:57.654196 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240203 21:03:57.654232 58433 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240203 21:03:57.654261 58433 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240203 21:03:57.654291 58433 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240203 21:03:57.654459 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240203 21:03:57.654495 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240203 21:03:57.654525 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240203 21:03:57.654565 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240203 21:03:57.654594 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240203 21:03:57.654624 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240203 21:03:57.654659 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240203 21:03:57.654690 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240203 21:03:57.654721 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240203 21:03:57.654757 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240203 21:03:57.654794 58433 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240203 21:03:57.654816 58433 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240203 21:03:57.654840 58433 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240203 21:03:57.654894 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240203 21:03:57.654923 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240203 21:03:57.654950 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240203 21:03:57.654979 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240203 21:03:57.655007 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240203 21:03:57.655035 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240203 21:03:57.655072 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240203 21:03:57.655107 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240203 21:03:57.655143 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240203 21:03:57.655182 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240203 21:03:57.655215 58433 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240203 21:03:57.655237 58433 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240203 21:03:57.655267 58433 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240203 21:03:57.655319 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240203 21:03:57.655355 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240203 21:03:57.655381 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240203 21:03:57.655411 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240203 21:03:57.655436 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240203 21:03:57.655474 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240203 21:03:57.655515 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240203 21:03:57.655550 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240203 21:03:57.655584 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240203 21:03:57.655612 58433 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240203 21:03:57.655643 58433 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240203 21:03:57.655668 58433 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240203 21:03:57.655690 58433 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240203 21:03:58.044600 58433 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240203 21:14:30.671528 58433 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4302704,  4302715,   126893,  ..., 69491454, 15903596,  2620914]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2275.093 seconds
[Rank1] pid = 27323
[Rank2] pid = 27419
INFO [58433 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [27323 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [27551 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [27419 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [27419 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [27551 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [58433 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [27323 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [27419 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [27551 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [58433 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [27323 DistTensor.py:59] The tensor name already exists in the kvstore
I20240203 21:23:04.116582 27324 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240203 21:23:04.116804 27552 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240203 21:23:04.117000 27624 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240203 21:23:04.117161 27420 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240203 21:23:04.621449 27552 recstore.cc:66] init folly done
E20240203 21:23:04.621501 27624 recstore.cc:66] init folly done
E20240203 21:23:04.621506 27324 recstore.cc:66] init folly done
E20240203 21:23:04.621519 27420 recstore.cc:66] init folly done
I20240203 21:23:15.649075 27624 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240203 21:23:18.632380 27420 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240203 21:23:18.732462 27324 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240203 21:23:19.526551 27552 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 18.890 ms                 | 106.096 ms                |
| Forward                   | 10.537 ms                 | 618.636 ms                |
| Backward                  | 213.950 ms                | 424.159 ms                |
| Optimize                  | 4.170 ms                  | 6.448 ms                  |
| BarrierTimeBeforeRank0    | 39.632 ms                 | 60.823 ms                 |
| BlockToStepN              | 22.711 us                 | 55.443 us                 |
| OneStep                   | 276.871 ms                | 1.132 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.111 ms                 | 106.096 ms                |
| Forward                   | 9.989 ms                  | 618.636 ms                |
| Backward                  | 205.807 ms                | 424.159 ms                |
| Optimize                  | 4.155 ms                  | 6.448 ms                  |
| BarrierTimeBeforeRank0    | 38.815 ms                 | 76.881 ms                 |
| BlockToStepN              | 29.435 us                 | 55.443 us                 |
| OneStep                   | 276.871 ms                | 1.132 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.019 ms                  | 106.096 ms                |
| Forward                   | 10.009 ms                 | 618.636 ms                |
| Backward                  | 205.554 ms                | 424.159 ms                |
| Optimize                  | 4.189 ms                  | 6.448 ms                  |
| BarrierTimeBeforeRank0    | 38.815 ms                 | 76.881 ms                 |
| BlockToStepN              | 29.827 us                 | 243.971 us                |
| OneStep                   | 271.560 ms                | 1.132 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.279 ms                  | 100.208 ms                |
| Forward                   | 10.000 ms                 | 26.781 ms                 |
| Backward                  | 205.807 ms                | 424.159 ms                |
| Optimize                  | 4.189 ms                  | 5.133 ms                  |
| BarrierTimeBeforeRank0    | 37.887 ms                 | 83.212 ms                 |
| BlockToStepN              | 23.938 us                 | 113.223 us                |
| OneStep                   | 269.347 ms                | 465.606 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.279 ms                  | 100.208 ms                |
| Forward                   | 10.006 ms                 | 26.781 ms                 |
| Backward                  | 205.892 ms                | 424.159 ms                |
| Optimize                  | 4.197 ms                  | 6.448 ms                  |
| BarrierTimeBeforeRank0    | 33.681 ms                 | 182.772 ms                |
| BlockToStepN              | 27.139 us                 | 243.971 us                |
| OneStep                   | 263.439 ms                | 465.606 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 32.144, sample: 1.722, forward: 2.576, backward: 21.189, update: 0.379
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 29.161, sample: 1.477, forward: 2.625, backward: 22.100, update: 0.258
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 29.060, sample: 1.714, forward: 2.519, backward: 19.972, update: 0.373
[Rank3] pid = 27551
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
train_sampler.Prefill()
-------Step 0-------
tensor([   67397,   407975, 39683917,   931386,   548063,   408001,   408015,
          259486,    67436,    67484]) tensor([ 5018889, 24367773, 19677484, 43336996, 62263992, 32186586, 85168988,
        62427536, 62407602, 84124713])
-------Step 1-------
tensor([   67397,   407975, 39683917,   931386,   548063,   408001,   408015,
          259486,    67436,    67484]) tensor([25011446, 64409291, 82274652,  9413657, 61670014,  9297840, 72109888,
        67140966, 15135290, 37308546])
-------Step 2-------
tensor([  464269,    82140, 79142126,    82187,   464284,   464307,   464329,
        47654600,   464345,   464370]) tensor([40117657,  5012832, 65594511, 11260020, 17125158, 13728698, 50387696,
         8690058, 65159857, 37659393])
-------Step 3-------
tensor([  464269,    82140, 79142126,    82187,   464284,   464307,   464329,
        47654600,   464345,   464370]) tensor([16635403, 50607160, 64285111, 33697006, 16153146, 57559876, 76669596,
        52622900, 20441036, 64807507])
-------Step 4-------
tensor([519500,  98393, 519520, 519537,  98437, 519564,  98477, 519576,  98524,
        519598]) tensor([75251727, 34692462, 18794431, 12359203, 48166445, 49865516, 68072473,
        41065649, 48410233, 10048367])
-------Step 5-------
tensor([519500,  98393, 519520, 519537,  98437, 519564,  98477, 519576,  98524,
        519598]) tensor([39030520, 50455984, 70240678,  8592477, 41450528, 26822205, 41594059,
        76943446, 85481039,   661656])
-------Step 6-------
tensor([63113655,   573638,   573657,   573677,  4309414,   573698,   573717,
          573735,   573754,   266011]) tensor([29650660, 49785143, 21843323, 23048413, 80911954, 48389912, 47222283,
        16531793, 75007203,  7991797])
-------Step 7-------
tensor([63113655,   573638,   573657,   573677,  4309414,   573698,   573717,
          573735,   573754,   266011]) tensor([32650838, 75038594, 55936668, 60495765, 76528181,  1796278, 19085852,
        54774870, 22300894, 13613579])
-------Step 8-------
tensor([  628743,   131528,   628768, 30154191,   961383,   628785,   628799,
          628821,   267951,   961408]) tensor([28169336, 47374072, 40769973, 85863011, 84367104, 53473830, 51360168,
        82874453,  9580174,  3239928])
-------Step 9-------
tensor([  628743,   131528,   628768, 30154191,   961383,   628785,   628799,
          628821,   267951,   961408]) tensor([63076669, 54980595, 27595704, 36922403, 10732139,  1069485, 18037409,
        12480830, 68210864, 52040981])
before start barrier
start train
[proc 0] 100 steps, total: 28.266, sample: 1.667, forward: 1.690, backward: 21.455, update: 0.373
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.010 ms                  | 105.127 ms                |
| Forward                   | 10.045 ms                 | 33.493 ms                 |
| Backward                  | 205.637 ms                | 424.159 ms                |
| Optimize                  | 4.193 ms                  | 6.448 ms                  |
| BarrierTimeBeforeRank0    | 25.548 ms                 | 182.772 ms                |
| BlockToStepN              | 27.395 us                 | 243.971 us                |
| OneStep                   | 262.056 ms                | 465.606 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.300 ms                  | 105.127 ms                |
| Forward                   | 10.126 ms                 | 33.493 ms                 |
| Backward                  | 208.174 ms                | 424.159 ms                |
| Optimize                  | 4.193 ms                  | 6.448 ms                  |
| BarrierTimeBeforeRank0    | 21.062 ms                 | 182.772 ms                |
| BlockToStepN              | 28.822 us                 | 243.971 us                |
| OneStep                   | 259.808 ms                | 465.606 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.300 ms                  | 105.127 ms                |
| Forward                   | 10.331 ms                 | 38.999 ms                 |
| Backward                  | 208.643 ms                | 424.159 ms                |
| Optimize                  | 4.189 ms                  | 6.448 ms                  |
| BarrierTimeBeforeRank0    | 14.402 ms                 | 182.772 ms                |
| BlockToStepN              | 29.146 us                 | 20.175 ms                 |
| OneStep                   | 259.525 ms                | 465.606 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.313 ms                  | 100.208 ms                |
| Forward                   | 10.515 ms                 | 33.493 ms                 |
| Backward                  | 209.089 ms                | 379.287 ms                |
| Optimize                  | 4.195 ms                  | 6.448 ms                  |
| BarrierTimeBeforeRank0    | 8.102 ms                  | 129.109 ms                |
| BlockToStepN              | 28.822 us                 | 243.971 us                |
| OneStep                   | 256.662 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.628 ms                  | 100.208 ms                |
| Forward                   | 10.537 ms                 | 33.493 ms                 |
| Backward                  | 209.137 ms                | 379.287 ms                |
| Optimize                  | 4.206 ms                  | 7.354 ms                  |
| BarrierTimeBeforeRank0    | 7.765 ms                  | 165.601 ms                |
| BlockToStepN              | 29.214 us                 | 20.175 ms                 |
| OneStep                   | 251.093 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 25.800, sample: 1.652, forward: 1.824, backward: 20.075, update: 0.382
[proc 0] 200 steps, total: 25.800, sample: 1.742, forward: 1.134, backward: 21.581, update: 0.382
[proc 2] 200 steps, total: 25.800, sample: 1.175, forward: 1.661, backward: 20.727, update: 0.227
[proc 3] 200 steps, total: 25.800, sample: 1.408, forward: 1.743, backward: 19.727, update: 0.366
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.628 ms                  | 100.208 ms                |
| Forward                   | 10.684 ms                 | 33.493 ms                 |
| Backward                  | 208.695 ms                | 424.159 ms                |
| Optimize                  | 4.240 ms                  | 7.354 ms                  |
| BarrierTimeBeforeRank0    | 6.414 ms                  | 165.601 ms                |
| BlockToStepN              | 29.341 us                 | 20.175 ms                 |
| OneStep                   | 249.386 ms                | 464.268 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.284 ms                  | 105.127 ms                |
| Forward                   | 10.794 ms                 | 33.493 ms                 |
| Backward                  | 208.849 ms                | 424.159 ms                |
| Optimize                  | 4.268 ms                  | 7.354 ms                  |
| BarrierTimeBeforeRank0    | 5.755 ms                  | 165.601 ms                |
| BlockToStepN              | 29.646 us                 | 20.175 ms                 |
| OneStep                   | 247.041 ms                | 464.268 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.313 ms                  | 105.127 ms                |
| Forward                   | 10.877 ms                 | 33.493 ms                 |
| Backward                  | 209.137 ms                | 424.159 ms                |
| Optimize                  | 4.269 ms                  | 7.354 ms                  |
| BarrierTimeBeforeRank0    | 5.025 ms                  | 165.601 ms                |
| BlockToStepN              | 29.646 us                 | 20.175 ms                 |
| OneStep                   | 246.987 ms                | 464.268 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.396 ms                  | 105.127 ms                |
| Forward                   | 10.826 ms                 | 26.781 ms                 |
| Backward                  | 208.633 ms                | 379.287 ms                |
| Optimize                  | 4.273 ms                  | 6.845 ms                  |
| BarrierTimeBeforeRank0    | 6.103 ms                  | 144.600 ms                |
| BlockToStepN              | 29.646 us                 | 243.971 us                |
| OneStep                   | 245.867 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.284 ms                  | 105.127 ms                |
| Forward                   | 10.768 ms                 | 28.310 ms                 |
| Backward                  | 208.411 ms                | 379.287 ms                |
| Optimize                  | 4.276 ms                  | 6.845 ms                  |
| BarrierTimeBeforeRank0    | 7.765 ms                  | 144.600 ms                |
| BlockToStepN              | 29.714 us                 | 243.971 us                |
| OneStep                   | 245.029 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 25.288, sample: 1.322, forward: 1.616, backward: 19.893, update: 0.354
[proc 1] 300 steps, total: 25.288, sample: 1.529, forward: 1.782, backward: 19.855, update: 0.383
[proc 0] 300 steps, total: 25.288, sample: 1.374, forward: 1.129, backward: 20.831, update: 0.389
[proc 2] 300 steps, total: 25.288, sample: 1.136, forward: 1.653, backward: 20.402, update: 0.305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.740 ms                  | 105.127 ms                |
| Forward                   | 10.767 ms                 | 28.310 ms                 |
| Backward                  | 208.179 ms                | 379.287 ms                |
| Optimize                  | 4.276 ms                  | 6.845 ms                  |
| BarrierTimeBeforeRank0    | 8.018 ms                  | 144.600 ms                |
| BlockToStepN              | 29.827 us                 | 243.971 us                |
| OneStep                   | 244.721 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.888 ms                  | 105.127 ms                |
| Forward                   | 10.720 ms                 | 28.310 ms                 |
| Backward                  | 207.440 ms                | 379.287 ms                |
| Optimize                  | 4.277 ms                  | 7.307 ms                  |
| BarrierTimeBeforeRank0    | 8.654 ms                  | 165.601 ms                |
| BlockToStepN              | 29.827 us                 | 17.013 ms                 |
| OneStep                   | 244.721 ms                | 455.674 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.888 ms                  | 105.127 ms                |
| Forward                   | 10.652 ms                 | 28.310 ms                 |
| Backward                  | 206.629 ms                | 379.287 ms                |
| Optimize                  | 4.281 ms                  | 7.307 ms                  |
| BarrierTimeBeforeRank0    | 9.129 ms                  | 165.601 ms                |
| BlockToStepN              | 29.873 us                 | 17.013 ms                 |
| OneStep                   | 244.782 ms                | 455.674 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.888 ms                  | 100.208 ms                |
| Forward                   | 10.680 ms                 | 28.310 ms                 |
| Backward                  | 206.295 ms                | 353.344 ms                |
| Optimize                  | 4.281 ms                  | 6.845 ms                  |
| BarrierTimeBeforeRank0    | 9.726 ms                  | 144.600 ms                |
| BlockToStepN              | 29.873 us                 | 243.971 us                |
| OneStep                   | 244.721 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.744 ms                  | 100.208 ms                |
| Forward                   | 10.765 ms                 | 28.310 ms                 |
| Backward                  | 206.305 ms                | 353.344 ms                |
| Optimize                  | 4.276 ms                  | 6.845 ms                  |
| BarrierTimeBeforeRank0    | 9.743 ms                  | 150.505 ms                |
| BlockToStepN              | 29.910 us                 | 2.737 ms                  |
| OneStep                   | 244.721 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.849 ms                  | 100.208 ms                |
| Forward                   | 10.767 ms                 | 28.310 ms                 |
| Backward                  | 206.629 ms                | 353.344 ms                |
| Optimize                  | 4.275 ms                  | 6.969 ms                  |
| BarrierTimeBeforeRank0    | 9.530 ms                  | 150.505 ms                |
| BlockToStepN              | 29.910 us                 | 2.737 ms                  |
| OneStep                   | 244.782 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 25.839, sample: 1.248, forward: 1.632, backward: 20.513, update: 0.397
[proc 3] 400 steps, total: 25.839, sample: 1.220, forward: 1.528, backward: 19.917, update: 0.364
[proc 1] 400 steps, total: 25.839, sample: 1.401, forward: 1.694, backward: 21.243, update: 0.365
[proc 0] 400 steps, total: 25.839, sample: 1.357, forward: 1.124, backward: 20.928, update: 0.383
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.888 ms                  | 100.208 ms                |
| Forward                   | 10.784 ms                 | 28.310 ms                 |
| Backward                  | 206.877 ms                | 353.344 ms                |
| Optimize                  | 4.275 ms                  | 6.969 ms                  |
| BarrierTimeBeforeRank0    | 9.132 ms                  | 150.505 ms                |
| BlockToStepN              | 29.951 us                 | 7.416 ms                  |
| OneStep                   | 244.103 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.867 ms                  | 100.208 ms                |
| Forward                   | 10.797 ms                 | 29.993 ms                 |
| Backward                  | 207.148 ms                | 353.344 ms                |
| Optimize                  | 4.276 ms                  | 6.969 ms                  |
| BarrierTimeBeforeRank0    | 9.132 ms                  | 150.505 ms                |
| BlockToStepN              | 29.910 us                 | 7.416 ms                  |
| OneStep                   | 244.245 ms                | 450.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.888 ms                  | 100.202 ms                |
| Forward                   | 10.827 ms                 | 28.310 ms                 |
| Backward                  | 207.799 ms                | 350.127 ms                |
| Optimize                  | 4.273 ms                  | 6.845 ms                  |
| BarrierTimeBeforeRank0    | 8.759 ms                  | 144.600 ms                |
| BlockToStepN              | 29.873 us                 | 2.737 ms                  |
| OneStep                   | 244.245 ms                | 419.706 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.010 ms                  | 100.202 ms                |
| Forward                   | 10.857 ms                 | 28.310 ms                 |
| Backward                  | 207.769 ms                | 350.127 ms                |
| Optimize                  | 4.275 ms                  | 6.969 ms                  |
| BarrierTimeBeforeRank0    | 8.654 ms                  | 144.600 ms                |
| BlockToStepN              | 29.873 us                 | 2.737 ms                  |
| OneStep                   | 244.015 ms                | 419.706 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.949 ms                  | 100.202 ms                |
| Forward                   | 10.855 ms                 | 28.310 ms                 |
| Backward                  | 207.903 ms                | 353.078 ms                |
| Optimize                  | 4.275 ms                  | 6.969 ms                  |
| BarrierTimeBeforeRank0    | 8.531 ms                  | 144.600 ms                |
| BlockToStepN              | 29.747 us                 | 2.737 ms                  |
| OneStep                   | 243.893 ms                | 419.706 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 25.357, sample: 1.209, forward: 1.577, backward: 20.297, update: 0.381
[proc 1] 500 steps, total: 25.357, sample: 1.397, forward: 1.610, backward: 20.755, update: 0.378
[proc 0] 500 steps, total: 25.357, sample: 1.490, forward: 1.175, backward: 21.299, update: 0.387
[proc 3] 500 steps, total: 25.357, sample: 1.143, forward: 1.513, backward: 19.996, update: 0.379
Successfully xmh. training takes 130.55076384544373 seconds
before call kg_cache_controller.StopThreads()
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
INFO [58433 controller_process.py:421] call rank0 to StopThreads
