WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240203 13:09:26.653996 64268 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_64', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [64268 sampler.py:454] Start PreSampling
WARNING [64268 sampler.py:532] Before construct renumbering_dict
WARNING [64268 sampler.py:555] PreSampling done
W20240203 13:30:01.133430 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240203 13:30:01.133618 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240203 13:30:01.133651 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240203 13:30:01.133693 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240203 13:30:01.133723 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240203 13:30:01.133752 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240203 13:30:01.133790 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240203 13:30:01.133831 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240203 13:30:01.133865 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240203 13:30:01.133906 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240203 13:30:01.133944 64268 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240203 13:30:01.133972 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240203 13:30:01.134006 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240203 13:30:01.134152 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240203 13:30:01.134184 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240203 13:30:01.134218 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240203 13:30:01.134259 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240203 13:30:01.134289 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240203 13:30:01.134325 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240203 13:30:01.134356 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240203 13:30:01.134383 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240203 13:30:01.134413 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240203 13:30:01.134447 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240203 13:30:01.134482 64268 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240203 13:30:01.134505 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240203 13:30:01.134534 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240203 13:30:01.134588 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240203 13:30:01.134618 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240203 13:30:01.134645 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240203 13:30:01.134672 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240203 13:30:01.134708 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240203 13:30:01.134739 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240203 13:30:01.134770 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240203 13:30:01.134797 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240203 13:30:01.134824 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240203 13:30:01.134861 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240203 13:30:01.134891 64268 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240203 13:30:01.134913 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240203 13:30:01.134936 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240203 13:30:01.134991 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240203 13:30:01.135021 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240203 13:30:01.135056 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240203 13:30:01.135084 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240203 13:30:01.135111 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240203 13:30:01.135141 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240203 13:30:01.135169 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240203 13:30:01.135196 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240203 13:30:01.135224 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240203 13:30:01.135258 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240203 13:30:01.135293 64268 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240203 13:30:01.135316 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240203 13:30:01.135339 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240203 13:30:01.135393 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240203 13:30:01.135432 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240203 13:30:01.135459 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240203 13:30:01.135490 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240203 13:30:01.135519 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240203 13:30:01.135546 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240203 13:30:01.135581 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240203 13:30:01.135614 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240203 13:30:01.135650 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240203 13:30:01.135689 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240203 13:30:01.135716 64268 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240203 13:30:01.135740 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240203 13:30:01.135763 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240203 13:30:01.135812 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240203 13:30:01.135851 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240203 13:30:01.135879 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240203 13:30:01.135910 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240203 13:30:01.135944 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240203 13:30:01.135977 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240203 13:30:01.136011 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240203 13:30:01.136046 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240203 13:30:01.136088 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240203 13:30:01.136124 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240203 13:30:01.136160 64268 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240203 13:30:01.136184 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240203 13:30:01.136207 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240203 13:30:01.136260 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240203 13:30:01.136291 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240203 13:30:01.136318 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240203 13:30:01.136346 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240203 13:30:01.136384 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240203 13:30:01.136412 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240203 13:30:01.136448 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240203 13:30:01.136484 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240203 13:30:01.136518 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240203 13:30:01.136551 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240203 13:30:01.136585 64268 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240203 13:30:01.136610 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240203 13:30:01.136633 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240203 13:30:01.136684 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240203 13:30:01.136716 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240203 13:30:01.136749 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240203 13:30:01.136780 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240203 13:30:01.136808 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240203 13:30:01.136838 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240203 13:30:01.136869 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240203 13:30:01.136904 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240203 13:30:01.136941 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240203 13:30:01.136979 64268 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240203 13:30:01.137013 64268 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240203 13:30:01.137037 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240203 13:30:01.137061 64268 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240203 13:30:01.641773 64268 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240203 13:38:45.233860 64268 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605419,  8605446,    57780,  ..., 70317836, 65100173,  9237593]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2274.075 seconds
[Rank1] pid = 25731
[Rank2] pid = 25826
[Rank3] pid = 25895
[Rank4] pid = 25962
[Rank5] pid = 26124
[Rank6] pid = 26290
INFO [64268 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [25731 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [25826 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [25895 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [25962 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [26124 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [26290 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [26460 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [26290 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26124 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26460 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25895 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [26290 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [25962 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [25962 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [26460 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [26124 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [25895 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [64268 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25826 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25731 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [64268 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [25731 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [25826 DistTensor.py:59] The tensor name already exists in the kvstore
I20240203 13:47:32.894248 25827 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240203 13:47:32.894433 26153 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 13:47:32.895700 26310 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 13:47:32.895901 26549 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 13:47:32.896039 25896 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 13:47:32.896194 26470 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 13:47:32.896368 25732 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 13:47:32.896534 25963 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240203 13:47:34.697394 26153 recstore.cc:66] init folly done
E20240203 13:47:34.697423 25963 recstore.cc:66] init folly done
E20240203 13:47:34.697911 25827 recstore.cc:66] init folly done
E20240203 13:47:34.697918 26470 recstore.cc:66] init folly done
E20240203 13:47:34.699023 25896 recstore.cc:66] init folly done
E20240203 13:47:34.699297 26549 recstore.cc:66] init folly done
E20240203 13:47:34.699301 26310 recstore.cc:66] init folly done
E20240203 13:47:34.699307 25732 recstore.cc:66] init folly done
I20240203 13:47:40.342294 26153 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240203 13:47:40.979836 25963 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 13:47:40.992405 26549 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 13:47:42.352411 25827 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 13:47:43.039224 25896 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 13:47:43.085119 25732 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 13:47:43.212492 26470 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 13:47:43.798280 26310 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.615 ms                 | 364.609 ms                |
| Forward                   | 9.493 ms                  | 674.176 ms                |
| Backward                  | 237.158 ms                | 456.065 ms                |
| Optimize                  | 4.377 ms                  | 5.178 ms                  |
| BarrierTimeBeforeRank0    | 47.234 ms                 | 137.060 ms                |
| BlockToStepN              | 37.355 us                 | 59.420 us                 |
| OneStep                   | 299.331 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.385 ms                  | 364.609 ms                |
| Forward                   | 9.764 ms                  | 674.176 ms                |
| Backward                  | 239.748 ms                | 456.065 ms                |
| Optimize                  | 4.366 ms                  | 5.178 ms                  |
| BarrierTimeBeforeRank0    | 27.407 ms                 | 137.060 ms                |
| BlockToStepN              | 36.091 us                 | 13.643 ms                 |
| OneStep                   | 299.277 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.965 ms                  | 364.609 ms                |
| Forward                   | 10.120 ms                 | 674.176 ms                |
| Backward                  | 239.748 ms                | 456.065 ms                |
| Optimize                  | 4.422 ms                  | 7.764 ms                  |
| BarrierTimeBeforeRank0    | 24.325 ms                 | 137.060 ms                |
| BlockToStepN              | 34.886 us                 | 13.643 ms                 |
| OneStep                   | 295.276 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.965 ms                  | 319.466 ms                |
| Forward                   | 9.967 ms                  | 40.360 ms                 |
| Backward                  | 240.080 ms                | 456.065 ms                |
| Optimize                  | 4.439 ms                  | 7.489 ms                  |
| BarrierTimeBeforeRank0    | 24.325 ms                 | 173.059 ms                |
| BlockToStepN              | 35.970 us                 | 14.331 ms                 |
| OneStep                   | 295.276 ms                | 636.861 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.965 ms                  | 319.466 ms                |
| Forward                   | 9.764 ms                  | 40.360 ms                 |
| Backward                  | 239.748 ms                | 456.065 ms                |
| Optimize                  | 4.439 ms                  | 7.489 ms                  |
| BarrierTimeBeforeRank0    | 24.243 ms                 | 173.059 ms                |
| BlockToStepN              | 34.980 us                 | 14.331 ms                 |
| OneStep                   | 292.358 ms                | 636.861 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.385 ms                  | 319.466 ms                |
| Forward                   | 9.683 ms                  | 40.360 ms                 |
| Backward                  | 239.190 ms                | 456.065 ms                |
| Optimize                  | 4.439 ms                  | 7.764 ms                  |
| BarrierTimeBeforeRank0    | 26.256 ms                 | 222.129 ms                |
| BlockToStepN              | 34.980 us                 | 14.331 ms                 |
| OneStep                   | 291.679 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.273 ms                  | 319.466 ms                |
| Forward                   | 9.630 ms                  | 40.360 ms                 |
| Backward                  | 237.491 ms                | 456.065 ms                |
| Optimize                  | 4.438 ms                  | 8.247 ms                  |
| BarrierTimeBeforeRank0    | 27.698 ms                 | 222.129 ms                |
| BlockToStepN              | 34.980 us                 | 14.331 ms                 |
| OneStep                   | 291.679 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
[Rank7] pid = 26460
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
train_sampler.Prefill()
-------Step 0-------
tensor([  228699,   228730,   228774,   228805,  9954369,   874115, 48426633,
        22769384, 26411582,   228846]) tensor([ 9477822, 17688242, 54034739, 79710084, 26038492, 30213024, 44333660,
        68583669, 63866185, 28249716])
-------Step 1-------
tensor([  228699,   228730,   228774,   228805,  9954369,   874115, 48426633,
        22769384, 26411582,   228846]) tensor([ 3677404, 32504016, 15644742, 72692863, 74141297, 38978196, 63838677,
        57430838, 43951954, 17711333])
-------Step 2-------
tensor([  314303,   314353,   314393,   283623,   314429,   314458, 71468130,
        31021362,   314487,   314523]) tensor([79525652, 24487051, 84545472, 44799804, 40168480, 34166020, 76591312,
        45533075, 19256530, 38316911])
-------Step 3-------
tensor([  314303,   314353,   314393,   283623,   314429,   314458, 71468130,
        31021362,   314487,   314523]) tensor([56712240, 74497144, 33002377, 35380969, 56668366, 73969743, 43774833,
        21283274, 25992659,  1740449])
-------Step 4-------
tensor([  400105, 41354812,   400143,   896208,   400169,   896234,   400211,
        36668391,   400240,   400268]) tensor([71436710, 14133960, 85826871, 23630180, 77519499, 39412639, 75296778,
        34822335, 81174773, 60949377])
-------Step 5-------
tensor([  400105, 41354812,   400143,   896208,   400169,   896234,   400211,
        36668391,   400240,   400268]) tensor([33844180,  1350590,   683054, 70816448, 51105507, 63823639, 19972009,
        14142068, 63323300, 48088936])
-------Step 6-------
tensor([  485351,   314127, 40141081,   485390, 32641276, 80741889,   485439,
          485480, 60988740, 33979549]) tensor([18256315, 35665937, 42458290, 82746381, 32448721, 44384860, 30130344,
        10774627, 77269402, 80287474])
-------Step 7-------
tensor([  485351,   314127, 40141081,   485390, 32641276, 80741889,   485439,
          485480, 60988740, 33979549]) tensor([25179690, 61185727, 62447520, 53741576, 82253973, 46053671, 62476130,
        64546406, 33644202,   805014])
-------Step 8-------
tensor([  566914, 24814492,   566954,   917696,   566986,   328973,   567022,
          567059,   567103,   567139]) tensor([51765500, 31523371, 40388961,  3559057, 58143039,   186233, 20330190,
          596411,  3122062, 72212032])
-------Step 9-------
tensor([  566914, 24814492,   566954,   917696,   566986,   328973,   567022,
          567059,   567103,   567139]) tensor([61511021,  1861673, 18593595, 64500922, 12721141, 48225366,   787567,
        36327178, 85323727, 76273304])
before start barrier
start train
[proc 0] 100 steps, total: 34.708, sample: 2.351, forward: 1.684, backward: 24.024, update: 0.432
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 34.122, sample: 1.585, forward: 2.703, backward: 24.686, update: 0.408
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 35.568, sample: 1.452, forward: 2.971, backward: 24.542, update: 0.383
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 36.928, sample: 1.115, forward: 2.570, backward: 22.050, update: 0.420
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 37.578, sample: 1.329, forward: 2.662, backward: 24.167, update: 0.380
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 36.941, sample: 2.385, forward: 2.836, backward: 24.716, update: 0.410
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 34.882, sample: 2.878, forward: 2.978, backward: 24.633, update: 0.420
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 34.836, sample: 2.273, forward: 2.972, backward: 24.462, update: 0.344
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.385 ms                  | 319.466 ms                |
| Forward                   | 9.641 ms                  | 40.360 ms                 |
| Backward                  | 237.576 ms                | 456.065 ms                |
| Optimize                  | 4.438 ms                  | 8.247 ms                  |
| BarrierTimeBeforeRank0    | 27.489 ms                 | 222.129 ms                |
| BlockToStepN              | 34.980 us                 | 14.331 ms                 |
| OneStep                   | 290.849 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.638 ms                  | 319.466 ms                |
| Forward                   | 9.604 ms                  | 40.360 ms                 |
| Backward                  | 237.491 ms                | 456.065 ms                |
| Optimize                  | 4.427 ms                  | 8.247 ms                  |
| BarrierTimeBeforeRank0    | 27.489 ms                 | 222.129 ms                |
| BlockToStepN              | 35.101 us                 | 14.331 ms                 |
| OneStep                   | 291.525 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.036 ms                 | 319.466 ms                |
| Forward                   | 9.576 ms                  | 40.360 ms                 |
| Backward                  | 237.327 ms                | 456.065 ms                |
| Optimize                  | 4.427 ms                  | 8.247 ms                  |
| BarrierTimeBeforeRank0    | 27.698 ms                 | 222.129 ms                |
| BlockToStepN              | 35.347 us                 | 14.331 ms                 |
| OneStep                   | 290.849 ms                | 1.242 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.036 ms                 | 286.141 ms                |
| Forward                   | 9.602 ms                  | 18.028 ms                 |
| Backward                  | 237.975 ms                | 456.065 ms                |
| Optimize                  | 4.429 ms                  | 7.949 ms                  |
| BarrierTimeBeforeRank0    | 26.311 ms                 | 189.939 ms                |
| BlockToStepN              | 35.380 us                 | 14.181 ms                 |
| OneStep                   | 291.258 ms                | 786.190 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.638 ms                  | 286.141 ms                |
| Forward                   | 9.599 ms                  | 18.028 ms                 |
| Backward                  | 238.149 ms                | 456.065 ms                |
| Optimize                  | 4.429 ms                  | 7.949 ms                  |
| BarrierTimeBeforeRank0    | 26.850 ms                 | 189.939 ms                |
| BlockToStepN              | 35.759 us                 | 16.802 ms                 |
| OneStep                   | 291.525 ms                | 786.190 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.691 ms                  | 286.141 ms                |
| Forward                   | 9.599 ms                  | 18.028 ms                 |
| Backward                  | 237.316 ms                | 456.065 ms                |
| Optimize                  | 4.429 ms                  | 7.949 ms                  |
| BarrierTimeBeforeRank0    | 28.210 ms                 | 222.129 ms                |
| BlockToStepN              | 36.091 us                 | 22.147 ms                 |
| OneStep                   | 292.358 ms                | 786.190 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 31.814, sample: 2.261, forward: 0.976, backward: 24.231, update: 0.406
[proc 6] 200 steps, total: 31.814, sample: 1.321, forward: 1.757, backward: 22.066, update: 0.395
[proc 7] 200 steps, total: 31.814, sample: 1.203, forward: 1.672, backward: 21.517, update: 0.436
[proc 5] 200 steps, total: 31.814, sample: 1.016, forward: 1.782, backward: 22.147, update: 0.389
[proc 3] 200 steps, total: 31.814, sample: 2.026, forward: 1.984, backward: 24.522, update: 0.373
[proc 2] 200 steps, total: 31.814, sample: 1.374, forward: 1.857, backward: 23.426, update: 0.412
[proc 1] 200 steps, total: 31.814, sample: 2.539, forward: 2.033, backward: 25.371, update: 0.386
[proc 4] 200 steps, total: 31.814, sample: 1.553, forward: 1.783, backward: 22.358, update: 0.347
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.036 ms                 | 286.141 ms                |
| Forward                   | 9.567 ms                  | 18.028 ms                 |
| Backward                  | 237.046 ms                | 456.065 ms                |
| Optimize                  | 4.425 ms                  | 7.949 ms                  |
| BarrierTimeBeforeRank0    | 29.284 ms                 | 231.263 ms                |
| BlockToStepN              | 36.091 us                 | 22.147 ms                 |
| OneStep                   | 292.985 ms                | 786.190 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.691 ms                  | 286.141 ms                |
| Forward                   | 9.567 ms                  | 18.980 ms                 |
| Backward                  | 237.158 ms                | 456.065 ms                |
| Optimize                  | 4.425 ms                  | 7.949 ms                  |
| BarrierTimeBeforeRank0    | 29.172 ms                 | 231.263 ms                |
| BlockToStepN              | 36.349 us                 | 22.147 ms                 |
| OneStep                   | 292.244 ms                | 786.190 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.602 ms                  | 286.141 ms                |
| Forward                   | 9.570 ms                  | 36.059 ms                 |
| Backward                  | 237.175 ms                | 456.065 ms                |
| Optimize                  | 4.422 ms                  | 7.949 ms                  |
| BarrierTimeBeforeRank0    | 28.825 ms                 | 231.263 ms                |
| BlockToStepN              | 36.160 us                 | 22.147 ms                 |
| OneStep                   | 291.841 ms                | 786.190 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.638 ms                  | 204.595 ms                |
| Forward                   | 9.570 ms                  | 18.980 ms                 |
| Backward                  | 237.316 ms                | 416.997 ms                |
| Optimize                  | 4.425 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 28.055 ms                 | 222.129 ms                |
| BlockToStepN              | 35.970 us                 | 20.220 ms                 |
| OneStep                   | 291.525 ms                | 636.861 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.611 ms                  | 204.595 ms                |
| Forward                   | 9.576 ms                  | 18.980 ms                 |
| Backward                  | 237.490 ms                | 416.997 ms                |
| Optimize                  | 4.420 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 27.489 ms                 | 231.263 ms                |
| BlockToStepN              | 35.679 us                 | 20.220 ms                 |
| OneStep                   | 290.936 ms                | 702.160 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.372 ms                  | 204.595 ms                |
| Forward                   | 9.599 ms                  | 35.545 ms                 |
| Backward                  | 237.975 ms                | 416.997 ms                |
| Optimize                  | 4.417 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 26.850 ms                 | 231.263 ms                |
| BlockToStepN              | 35.347 us                 | 20.220 ms                 |
| OneStep                   | 290.849 ms                | 702.160 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 300 steps, total: 30.769, sample: 1.209, forward: 1.647, backward: 22.959, update: 0.389
[proc 5] 300 steps, total: 30.769, sample: 0.902, forward: 1.691, backward: 22.584, update: 0.386
[proc 7] 300 steps, total: 30.769, sample: 0.949, forward: 1.607, backward: 21.793, update: 0.418
[proc 2] 300 steps, total: 30.769, sample: 1.144, forward: 1.775, backward: 23.717, update: 0.415
[proc 0] 300 steps, total: 30.769, sample: 1.892, forward: 1.032, backward: 24.165, update: 0.420
[proc 4] 300 steps, total: 30.769, sample: 1.149, forward: 1.688, backward: 22.674, update: 0.385
[proc 3] 300 steps, total: 30.769, sample: 1.612, forward: 1.902, backward: 24.780, update: 0.395
[proc 1] 300 steps, total: 30.769, sample: 2.140, forward: 1.903, backward: 24.878, update: 0.429
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.262 ms                  | 204.595 ms                |
| Forward                   | 9.599 ms                  | 35.545 ms                 |
| Backward                  | 237.970 ms                | 416.997 ms                |
| Optimize                  | 4.417 ms                  | 7.782 ms                  |
| BarrierTimeBeforeRank0    | 26.256 ms                 | 231.263 ms                |
| BlockToStepN              | 35.380 us                 | 20.220 ms                 |
| OneStep                   | 290.488 ms                | 702.160 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.159 ms                  | 204.595 ms                |
| Forward                   | 9.599 ms                  | 35.545 ms                 |
| Backward                  | 237.741 ms                | 416.997 ms                |
| Optimize                  | 4.413 ms                  | 7.782 ms                  |
| BarrierTimeBeforeRank0    | 26.125 ms                 | 231.263 ms                |
| BlockToStepN              | 35.347 us                 | 20.220 ms                 |
| OneStep                   | 290.397 ms                | 702.160 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.262 ms                  | 204.595 ms                |
| Forward                   | 9.602 ms                  | 35.545 ms                 |
| Backward                  | 237.975 ms                | 416.997 ms                |
| Optimize                  | 4.414 ms                  | 7.782 ms                  |
| BarrierTimeBeforeRank0    | 25.835 ms                 | 244.158 ms                |
| BlockToStepN              | 35.347 us                 | 20.220 ms                 |
| OneStep                   | 290.176 ms                | 702.160 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.740 ms                  | 199.074 ms                |
| Forward                   | 9.613 ms                  | 18.980 ms                 |
| Backward                  | 238.021 ms                | 416.997 ms                |
| Optimize                  | 4.413 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 25.338 ms                 | 231.263 ms                |
| BlockToStepN              | 35.679 us                 | 20.220 ms                 |
| OneStep                   | 289.748 ms                | 636.861 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.775 ms                  | 199.074 ms                |
| Forward                   | 9.641 ms                  | 29.875 ms                 |
| Backward                  | 238.149 ms                | 416.997 ms                |
| Optimize                  | 4.413 ms                  | 7.782 ms                  |
| BarrierTimeBeforeRank0    | 23.640 ms                 | 231.263 ms                |
| BlockToStepN              | 35.389 us                 | 20.220 ms                 |
| OneStep                   | 288.885 ms                | 636.861 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.679 ms                  | 199.074 ms                |
| Forward                   | 9.643 ms                  | 29.875 ms                 |
| Backward                  | 238.021 ms                | 416.997 ms                |
| Optimize                  | 4.413 ms                  | 7.782 ms                  |
| BarrierTimeBeforeRank0    | 23.394 ms                 | 231.263 ms                |
| BlockToStepN              | 35.559 us                 | 20.220 ms                 |
| OneStep                   | 288.579 ms                | 636.861 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 400 steps, total: 30.461, sample: 0.859, forward: 1.602, backward: 22.175, update: 0.399
[proc 7] 400 steps, total: 30.461, sample: 0.908, forward: 1.492, backward: 21.593, update: 0.422
[proc 2] 400 steps, total: 30.461, sample: 1.157, forward: 1.700, backward: 23.529, update: 0.428
[proc 3] 400 steps, total: 30.461, sample: 1.434, forward: 1.799, backward: 24.953, update: 0.374
[proc 1] 400 steps, total: 30.461, sample: 1.688, forward: 1.754, backward: 24.583, update: 0.414
[proc 6] 400 steps, total: 30.461, sample: 1.204, forward: 1.588, backward: 22.451, update: 0.382
[proc 4] 400 steps, total: 30.461, sample: 1.035, forward: 1.607, backward: 22.839, update: 0.415
[proc 0] 400 steps, total: 30.461, sample: 1.798, forward: 1.043, backward: 24.390, update: 0.406
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.679 ms                  | 199.074 ms                |
| Forward                   | 9.646 ms                  | 29.875 ms                 |
| Backward                  | 237.975 ms                | 416.997 ms                |
| Optimize                  | 4.417 ms                  | 7.782 ms                  |
| BarrierTimeBeforeRank0    | 23.153 ms                 | 244.158 ms                |
| BlockToStepN              | 35.389 us                 | 20.220 ms                 |
| OneStep                   | 288.446 ms                | 702.160 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.595 ms                  | 199.074 ms                |
| Forward                   | 9.666 ms                  | 29.875 ms                 |
| Backward                  | 238.021 ms                | 416.997 ms                |
| Optimize                  | 4.417 ms                  | 7.782 ms                  |
| BarrierTimeBeforeRank0    | 23.233 ms                 | 244.158 ms                |
| BlockToStepN              | 35.389 us                 | 20.220 ms                 |
| OneStep                   | 288.885 ms                | 702.160 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.339 ms                  | 199.074 ms                |
| Forward                   | 9.674 ms                  | 29.875 ms                 |
| Backward                  | 238.139 ms                | 416.997 ms                |
| Optimize                  | 4.419 ms                  | 7.782 ms                  |
| BarrierTimeBeforeRank0    | 23.640 ms                 | 244.158 ms                |
| BlockToStepN              | 35.343 us                 | 20.220 ms                 |
| OneStep                   | 289.278 ms                | 702.160 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.153 ms                  | 193.863 ms                |
| Forward                   | 9.696 ms                  | 28.453 ms                 |
| Backward                  | 237.970 ms                | 377.289 ms                |
| Optimize                  | 4.422 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 24.167 ms                 | 231.263 ms                |
| BlockToStepN              | 35.389 us                 | 16.802 ms                 |
| OneStep                   | 289.748 ms                | 636.861 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.153 ms                  | 193.863 ms                |
| Forward                   | 9.683 ms                  | 28.453 ms                 |
| Backward                  | 237.775 ms                | 377.289 ms                |
| Optimize                  | 4.418 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 24.659 ms                 | 244.158 ms                |
| BlockToStepN              | 35.745 us                 | 16.943 ms                 |
| OneStep                   | 289.748 ms                | 636.861 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 152.14996647834778 seconds
before call kg_cache_controller.StopThreads()
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
INFO [64268 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.065 ms                  | 193.863 ms                |
| Forward                   | 9.695 ms                  | 29.875 ms                 |
| Backward                  | 237.970 ms                | 377.289 ms                |
| Optimize                  | 4.418 ms                  | 7.775 ms                  |
| BarrierTimeBeforeRank0    | 24.887 ms                 | 244.158 ms                |
| BlockToStepN              | 35.745 us                 | 16.943 ms                 |
| OneStep                   | 289.748 ms                | 636.861 ms                |
+---------------------------+---------------------------+---------------------------+
