WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240203 08:21:25.939396 41188 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_56', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [41188 sampler.py:454] Start PreSampling
WARNING [41188 sampler.py:532] Before construct renumbering_dict
WARNING [41188 sampler.py:555] PreSampling done
W20240203 08:36:04.021809 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240203 08:36:04.022007 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240203 08:36:04.022042 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240203 08:36:04.022083 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240203 08:36:04.022125 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240203 08:36:04.022159 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240203 08:36:04.022188 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240203 08:36:04.022235 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240203 08:36:04.022264 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240203 08:36:04.022300 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240203 08:36:04.022346 41188 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240203 08:36:04.022374 41188 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240203 08:36:04.022403 41188 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240203 08:36:04.022568 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240203 08:36:04.022603 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240203 08:36:04.022636 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240203 08:36:04.022677 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240203 08:36:04.022703 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240203 08:36:04.022740 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240203 08:36:04.022770 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240203 08:36:04.022804 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240203 08:36:04.022840 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240203 08:36:04.022876 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240203 08:36:04.022903 41188 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240203 08:36:04.022925 41188 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240203 08:36:04.022953 41188 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240203 08:36:04.023015 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240203 08:36:04.023048 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240203 08:36:04.023077 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240203 08:36:04.023106 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240203 08:36:04.023140 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240203 08:36:04.023173 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240203 08:36:04.023207 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240203 08:36:04.023234 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240203 08:36:04.023263 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240203 08:36:04.023290 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240203 08:36:04.023319 41188 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240203 08:36:04.023341 41188 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240203 08:36:04.023365 41188 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240203 08:36:04.023422 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240203 08:36:04.023451 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240203 08:36:04.023481 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240203 08:36:04.023514 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240203 08:36:04.023545 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240203 08:36:04.023571 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240203 08:36:04.023598 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240203 08:36:04.023631 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240203 08:36:04.023658 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240203 08:36:04.023684 41188 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240203 08:36:04.023711 41188 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240203 08:36:04.023733 41188 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240203 08:36:04.023763 41188 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240203 08:36:04.421972 41188 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240203 08:44:42.782398 41188 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 2151353
Rank1: cached key size 2151353
Rank2: cached key size 2151353
Rank3: cached key size 2151353
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 8605452,  8605485,   127545,  ..., 60513884, 17595462,  4767537]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1901.502 seconds
[Rank1] pid = 747
[Rank2] pid = 846
INFO [41188 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [747 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [41188 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [915 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [747 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [915 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [846 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
W20240203 08:53:12.699301   916 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
INFO [846 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240203 08:53:12.700392   748 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240203 08:53:12.700906   983 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
W20240203 08:53:12.703797   847 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240203 08:53:12.779076   916 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102036619000 7.629 MB
W20240203 08:53:12.779093   748 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102036dbc000 7.629 MB
W20240203 08:53:12.779099   847 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10203755f000 7.629 MB
W20240203 08:53:12.779227   983 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102037d02000 7.629 MB
W20240203 08:53:12.779301   847 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1020384a5000 7.629 MB
W20240203 08:53:12.779323   916 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102038c48000 7.629 MB
W20240203 08:53:12.779373   748 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1020393eb000 7.629 MB
W20240203 08:53:12.779397   847 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102039b8e000 1.49 GB
W20240203 08:53:12.779398   916 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102099171000 1.49 GB
W20240203 08:53:12.779467   847 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1020f8754000 1.49 GB
W20240203 08:53:12.779491   748 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102157d37000 1.49 GB
W20240203 08:53:12.779544   847 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 08:53:12.779548   748 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1021b731a000 1.49 GB
W20240203 08:53:12.779565   916 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1022168fd000 1.49 GB
W20240203 08:53:12.779619   748 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 08:53:12.779636   916 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 08:53:12.779646   983 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x102275ee0000 7.629 MB
W20240203 08:53:12.781139   983 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102276683000 1.49 GB
W20240203 08:53:12.781226   983 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1022d5c66000 1.49 GB
W20240203 08:53:12.781273   983 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 08:53:12.786273   847 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 08:53:12.786345   748 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 08:53:12.786352   916 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 08:53:12.787775   983 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [915 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [747 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank3] pid = 915
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [41188 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [846 DistTensor.py:59] The tensor name already exists in the kvstore
I20240203 08:53:47.395902   847 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240203 08:53:47.396453   983 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240203 08:53:47.396581   916 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240203 08:53:47.397022   748 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240203 08:53:47.400344   916 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240203 08:53:47.400653   916 grad_base.h:184] Init GradProcessingBase done
I20240203 08:54:00.143935   916 grad_async_v1.h:203] Use main thread to update emb.
W20240203 08:54:00.144086   916 kg_controller.h:75] after init GradAsyncProcessing
I20240203 08:54:00.144096   916 kg_controller.h:84] Construct KGCacheController done
E20240203 08:54:01.601048   847 recstore.cc:66] init folly done
E20240203 08:54:01.601058   916 recstore.cc:66] init folly done
E20240203 08:54:01.601060   983 recstore.cc:66] init folly done
E20240203 08:54:01.601080   748 recstore.cc:66] init folly done
I20240203 08:54:01.602085   916 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240203 08:54:19.020577   983 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240203 08:54:22.251503   847 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240203 08:54:22.544719   748 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240203 08:54:23.105036   916 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240203 08:54:24.640383   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240203 08:54:24.983008  3110 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
W20240203 08:54:25.781316   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.871 ms                  | 171.756 ms                |
| ProcessBack:UpdateCache   | 2.912 ms                  | 284.946 ms                |
| ProcessBack:UpsertPq      | 36.585 ms                 | 57.120 ms                 |
| ProcessOneStep            | 50.767 ms                 | 572.476 ms                |
| BlockToStepN              | 268.529 ms                | 305.615 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:26.799670   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.993 ms                 | 110.889 ms                |
| Forward                   | 5.358 ms                  | 746.657 ms                |
| Backward                  | 10.859 ms                 | 186.584 ms                |
| Optimize                  | 2.468 ms                  | 5.139 ms                  |
| BarrierTimeBeforeRank0    | 44.486 us                 | 5.543 ms                  |
| AfterBackward             | 47.056 ms                 | 572.837 ms                |
| BlockToStepN              | 89.092 us                 | 306.279 ms                |
| OneStep                   | 252.325 ms                | 1.842 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:27.799010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240203 08:54:28.799010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240203 08:54:29.799010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240203 08:54:30.799010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.550 ms                  | 138.828 ms                |
| ProcessBack:UpdateCache   | 2.571 ms                  | 284.137 ms                |
| ProcessBack:UpsertPq      | 21.483 ms                 | 46.127 ms                 |
| ProcessOneStep            | 28.790 ms                 | 572.476 ms                |
| BlockToStepN              | 2.041 ms                  | 412.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:31.799006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.528 ms                  | 110.889 ms                |
| Forward                   | 4.596 ms                  | 746.657 ms                |
| Backward                  | 10.251 ms                 | 186.584 ms                |
| Optimize                  | 2.265 ms                  | 5.139 ms                  |
| BarrierTimeBeforeRank0    | 36.673 us                 | 21.394 ms                 |
| AfterBackward             | 26.796 ms                 | 572.837 ms                |
| BlockToStepN              | 2.094 ms                  | 412.269 ms                |
| OneStep                   | 252.325 ms                | 1.842 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:32.799006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240203 08:54:33.799010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240203 08:54:34.819923   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=40, pq.top=40
W20240203 08:54:35.875232   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.465 ms                  | 138.828 ms                |
| ProcessBack:UpdateCache   | 2.570 ms                  | 284.137 ms                |
| ProcessBack:UpsertPq      | 20.353 ms                 | 46.127 ms                 |
| ProcessOneStep            | 26.767 ms                 | 572.476 ms                |
| BlockToStepN              | 2.041 ms                  | 412.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:36.875010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.549 ms                  | 93.941 ms                 |
| Forward                   | 4.642 ms                  | 10.597 ms                 |
| Backward                  | 10.219 ms                 | 14.229 ms                 |
| Optimize                  | 2.324 ms                  | 17.643 ms                 |
| BarrierTimeBeforeRank0    | 39.739 us                 | 30.357 ms                 |
| AfterBackward             | 26.840 ms                 | 221.356 ms                |
| BlockToStepN              | 2.094 ms                  | 412.269 ms                |
| OneStep                   | 252.325 ms                | 1.842 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:37.875006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240203 08:54:38.903991   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240203 08:54:39.903008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240203 08:54:40.903008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.493 ms                  | 138.828 ms                |
| ProcessBack:UpdateCache   | 2.565 ms                  | 284.137 ms                |
| ProcessBack:UpsertPq      | 20.783 ms                 | 59.992 ms                 |
| ProcessOneStep            | 27.653 ms                 | 221.295 ms                |
| BlockToStepN              | 2.041 ms                  | 408.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:42.009042   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.309 ms                  | 93.941 ms                 |
| Forward                   | 4.714 ms                  | 10.597 ms                 |
| Backward                  | 10.289 ms                 | 15.804 ms                 |
| Optimize                  | 2.447 ms                  | 21.866 ms                 |
| BarrierTimeBeforeRank0    | 44.486 us                 | 47.363 ms                 |
| AfterBackward             | 28.645 ms                 | 221.356 ms                |
| BlockToStepN              | 268.724 ms                | 408.886 ms                |
| OneStep                   | 349.593 ms                | 523.589 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:43.218439   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240203 08:54:44.218031   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240203 08:54:45.278545   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240203 08:54:46.278008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.545 ms                  | 20.742 ms                 |
| ProcessBack:UpdateCache   | 2.571 ms                  | 4.931 ms                  |
| ProcessBack:UpsertPq      | 21.165 ms                 | 57.120 ms                 |
| ProcessOneStep            | 29.893 ms                 | 221.295 ms                |
| BlockToStepN              | 268.529 ms                | 412.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:47.278007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.479 ms                  | 97.657 ms                 |
| Forward                   | 4.816 ms                  | 10.597 ms                 |
| Backward                  | 10.316 ms                 | 15.804 ms                 |
| Optimize                  | 2.506 ms                  | 21.866 ms                 |
| BarrierTimeBeforeRank0    | 39.739 us                 | 47.363 ms                 |
| AfterBackward             | 29.924 ms                 | 221.356 ms                |
| BlockToStepN              | 6.176 ms                  | 412.269 ms                |
| OneStep                   | 252.325 ms                | 527.516 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:48.278007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240203 08:54:49.278007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 30.967, sample: 1.371, forward: 1.096, backward: 1.110, update: 0.266
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 27.442, sample: 1.515, forward: 1.056, backward: 0.999, update: 0.231
train_sampler.Prefill()
-------Step 0-------
tensor([ 1163257,   836054, 39817261,  2034144,   567777,   836103,   836146,
          264563,  1163284,  1163308]) tensor([ 9185547, 30914606,  1659492, 51596728, 66918862,  1355976, 85386743,
        71267639, 47511555, 82443163])
-------Step 1-------
tensor([ 1163257,   836054, 39817261,  2034144,   567777,   836103,   836146,
          264563,  1163284,  1163308]) tensor([35096532, 80087390, 78046510, 13192166, 72510305, 13446950, 72322050,
        79176113, 18569899, 41606223])
-------Step 2-------
tensor([  944838,  1172252, 82183733,  1172278,   944871,   944918,   944959,
        52547538,   945000,   945046]) tensor([35921785,  9346625, 63275349, 15615903, 17566192, 18067108, 53069923,
        12547702, 60008335, 30731462])
-------Step 3-------
tensor([  944838,  1172252, 82183733,  1172278,   944871,   944918,   944959,
        52547538,   945000,   945046]) tensor([  644393, 46344965,   984174, 42421768, 20941069, 59362391, 65442917,
        62071444, 22724654, 62301485])
-------Step 4-------
tensor([1052354, 1181389, 1052394, 1052433, 1181417, 1052474, 1181438, 1052497,
        1181467, 1052536]) tensor([ 4271797, 49902644, 23595642,  1202315, 53961771, 56016454, 65130980,
        41666302, 48023031, 14343848])
-------Step 5-------
tensor([1052354, 1181389, 1052394, 1052433, 1181417, 1052474, 1181438, 1052497,
        1181467, 1052536]) tensor([43401619, 56840568, 70733507, 12439198, 36811657,   344253, 34588206,
        75759126, 82625205,  1018656])
-------Step 6-------
tensor([76851092,  1158704,  1158738,  1158780,  8611765,  1158820,  1158865,
         1158914,  1158957,   271355]) tensor([29589736, 43521998, 24718620, 23297288, 83456701, 48002735, 42819507,
        21321764, 62441252, 11612598])
-------Step 7-------
tensor([76851092,  1158704,  1158738,  1158780,  8611765,  1158820,  1158865,
         1158914,  1158957,   271355]) tensor([34577694, 77153154, 65262018, 78248681, 72511921,  2553404, 23887903,
        60723025, 23795483, 17063261])
-------Step 8-------
tensor([ 1266524,  1199899,  1266565, 37415345,  2059716,  1266613,  1266666,
         1266691,   273329,  2059736]) tensor([32312993, 52821211, 47366198, 81108660, 80844984, 65134804, 56112926,
        78551288, 13340301,  8018044])
-------Step 9-------
tensor([ 1266524,  1199899,  1266565, 37415345,  2059716,  1266613,  1266666,
         1266691,   273329,  2059736]) tensor([79525374, 54233435, 29111789, 45979383, 14386338,  1433332, 24398459,
        16033090, 65252923, 40226634])
before start barrier
start train
[proc 0] 100 steps, total: 26.882, sample: 1.496, forward: 1.233, backward: 1.215, update: 0.330
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 27.736, sample: 1.379, forward: 1.088, backward: 1.166, update: 0.239
W20240203 08:54:50.278008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240203 08:54:51.278009   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.589 ms                  | 20.742 ms                 |
| ProcessBack:UpdateCache   | 2.625 ms                  | 6.504 ms                  |
| ProcessBack:UpsertPq      | 20.812 ms                 | 57.120 ms                 |
| ProcessOneStep            | 28.618 ms                 | 221.295 ms                |
| BlockToStepN              | 6.117 ms                  | 412.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:52.278008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.801 ms                  | 97.657 ms                 |
| Forward                   | 4.816 ms                  | 10.597 ms                 |
| Backward                  | 10.349 ms                 | 15.804 ms                 |
| Optimize                  | 2.511 ms                  | 21.866 ms                 |
| BarrierTimeBeforeRank0    | 38.268 us                 | 47.363 ms                 |
| AfterBackward             | 28.645 ms                 | 221.356 ms                |
| BlockToStepN              | 6.176 ms                  | 412.269 ms                |
| OneStep                   | 252.325 ms                | 534.414 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:53.278008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240203 08:54:54.278008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240203 08:54:55.278008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240203 08:54:56.278007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.592 ms                  | 28.135 ms                 |
| ProcessBack:UpdateCache   | 2.627 ms                  | 5.478 ms                  |
| ProcessBack:UpsertPq      | 20.353 ms                 | 57.024 ms                 |
| ProcessOneStep            | 27.904 ms                 | 221.295 ms                |
| BlockToStepN              | 10.827 ms                 | 418.334 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:57.278008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.374 ms                  | 97.657 ms                 |
| Forward                   | 4.848 ms                  | 35.167 ms                 |
| Backward                  | 10.356 ms                 | 15.804 ms                 |
| Optimize                  | 2.568 ms                  | 21.866 ms                 |
| BarrierTimeBeforeRank0    | 38.268 us                 | 47.363 ms                 |
| AfterBackward             | 27.934 ms                 | 221.356 ms                |
| BlockToStepN              | 10.865 ms                 | 418.416 ms                |
| OneStep                   | 252.325 ms                | 534.414 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:54:58.278008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240203 08:54:59.295647   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240203 08:55:00.295006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240203 08:55:01.295009   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.584 ms                  | 28.135 ms                 |
| ProcessBack:UpdateCache   | 2.626 ms                  | 5.478 ms                  |
| ProcessBack:UpsertPq      | 20.017 ms                 | 57.024 ms                 |
| ProcessOneStep            | 27.530 ms                 | 221.295 ms                |
| BlockToStepN              | 10.827 ms                 | 418.334 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:02.308842   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.033 ms                  | 97.657 ms                 |
| Forward                   | 4.828 ms                  | 35.167 ms                 |
| Backward                  | 10.356 ms                 | 15.804 ms                 |
| Optimize                  | 2.568 ms                  | 21.866 ms                 |
| BarrierTimeBeforeRank0    | 39.345 us                 | 47.363 ms                 |
| AfterBackward             | 27.558 ms                 | 221.356 ms                |
| BlockToStepN              | 10.865 ms                 | 418.416 ms                |
| OneStep                   | 252.325 ms                | 534.414 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:03.308012   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240203 08:55:04.341025   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240203 08:55:05.341010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240203 08:55:06.351205   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.592 ms                  | 28.135 ms                 |
| ProcessBack:UpdateCache   | 2.632 ms                  | 5.478 ms                  |
| ProcessBack:UpsertPq      | 19.918 ms                 | 57.024 ms                 |
| ProcessOneStep            | 27.530 ms                 | 71.221 ms                 |
| BlockToStepN              | 10.827 ms                 | 412.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.033 ms                  | 95.483 ms                 |
| Forward                   | 4.853 ms                  | 19.803 ms                 |
| Backward                  | 10.408 ms                 | 14.229 ms                 |
| Optimize                  | 2.595 ms                  | 17.643 ms                 |
| BarrierTimeBeforeRank0    | 36.657 us                 | 37.159 ms                 |
| AfterBackward             | 27.670 ms                 | 71.256 ms                 |
| BlockToStepN              | 10.865 ms                 | 412.269 ms                |
| OneStep                   | 252.325 ms                | 529.865 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:07.456051   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240203 08:55:08.471313   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240203 08:55:09.471009   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240203 08:55:10.481299   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240203 08:55:11.481006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.618 ms                  | 21.730 ms                 |
| ProcessBack:UpdateCache   | 2.672 ms                  | 5.442 ms                  |
| ProcessBack:UpsertPq      | 20.033 ms                 | 56.483 ms                 |
| ProcessOneStep            | 27.728 ms                 | 71.221 ms                 |
| BlockToStepN              | 10.827 ms                 | 412.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.009 ms                  | 95.483 ms                 |
| Forward                   | 4.841 ms                  | 19.803 ms                 |
| Backward                  | 10.427 ms                 | 14.229 ms                 |
| Optimize                  | 2.570 ms                  | 17.643 ms                 |
| BarrierTimeBeforeRank0    | 35.893 us                 | 37.159 ms                 |
| AfterBackward             | 27.757 ms                 | 71.256 ms                 |
| BlockToStepN              | 10.865 ms                 | 412.269 ms                |
| OneStep                   | 252.325 ms                | 530.419 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:12.481005   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240203 08:55:13.481019   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240203 08:55:14.481009   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 3] 200 steps, total: 24.843, sample: 1.591, forward: 0.490, backward: 0.958, update: 0.228
[proc 1] 200 steps, total: 24.843, sample: 1.361, forward: 0.482, backward: 0.524, update: 0.218
[proc 0] 200 steps, total: 24.843, sample: 1.286, forward: 0.534, backward: 1.103, update: 0.294
[proc 2] 200 steps, total: 24.843, sample: 1.323, forward: 0.487, backward: 0.970, update: 0.226
W20240203 08:55:15.481010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240203 08:55:16.481010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.641 ms                  | 21.730 ms                 |
| ProcessBack:UpdateCache   | 2.672 ms                  | 5.442 ms                  |
| ProcessBack:UpsertPq      | 19.918 ms                 | 56.483 ms                 |
| ProcessOneStep            | 27.777 ms                 | 71.221 ms                 |
| BlockToStepN              | 10.827 ms                 | 412.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.009 ms                  | 95.483 ms                 |
| Forward                   | 4.848 ms                  | 19.803 ms                 |
| Backward                  | 10.507 ms                 | 14.229 ms                 |
| Optimize                  | 2.595 ms                  | 17.643 ms                 |
| BarrierTimeBeforeRank0    | 38.268 us                 | 37.159 ms                 |
| AfterBackward             | 27.757 ms                 | 71.256 ms                 |
| BlockToStepN              | 10.865 ms                 | 412.269 ms                |
| OneStep                   | 210.387 ms                | 530.419 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:17.481009   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240203 08:55:18.481009   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240203 08:55:19.481009   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240203 08:55:20.564168   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240203 08:55:21.564008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.653 ms                  | 20.742 ms                 |
| ProcessBack:UpdateCache   | 2.657 ms                  | 4.931 ms                  |
| ProcessBack:UpsertPq      | 19.740 ms                 | 54.801 ms                 |
| ProcessOneStep            | 27.611 ms                 | 71.221 ms                 |
| BlockToStepN              | 10.827 ms                 | 412.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.780 ms                  | 95.483 ms                 |
| Forward                   | 4.858 ms                  | 19.803 ms                 |
| Backward                  | 10.581 ms                 | 14.582 ms                 |
| Optimize                  | 2.590 ms                  | 17.643 ms                 |
| BarrierTimeBeforeRank0    | 36.197 us                 | 37.159 ms                 |
| AfterBackward             | 27.539 ms                 | 71.256 ms                 |
| BlockToStepN              | 10.865 ms                 | 412.269 ms                |
| OneStep                   | 202.175 ms                | 530.419 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:22.637508   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240203 08:55:23.637006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240203 08:55:24.637007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240203 08:55:25.637008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.655 ms                  | 20.742 ms                 |
| ProcessBack:UpdateCache   | 2.632 ms                  | 4.931 ms                  |
| ProcessBack:UpsertPq      | 19.502 ms                 | 54.801 ms                 |
| ProcessOneStep            | 27.367 ms                 | 64.390 ms                 |
| BlockToStepN              | 10.827 ms                 | 410.196 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:26.637003   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.647 ms                  | 93.941 ms                 |
| Forward                   | 4.874 ms                  | 10.597 ms                 |
| Backward                  | 10.581 ms                 | 14.229 ms                 |
| Optimize                  | 2.595 ms                  | 7.409 ms                  |
| BarrierTimeBeforeRank0    | 34.887 us                 | 35.603 ms                 |
| AfterBackward             | 27.399 ms                 | 64.422 ms                 |
| BlockToStepN              | 10.865 ms                 | 410.268 ms                |
| OneStep                   | 202.175 ms                | 529.865 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:27.637008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240203 08:55:28.637022   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240203 08:55:29.637006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240203 08:55:30.637006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.655 ms                  | 8.462 ms                  |
| ProcessBack:UpdateCache   | 2.632 ms                  | 4.670 ms                  |
| ProcessBack:UpsertPq      | 19.349 ms                 | 53.541 ms                 |
| ProcessOneStep            | 27.238 ms                 | 64.390 ms                 |
| BlockToStepN              | 153.704 ms                | 410.196 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:31.669030   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=280, pq.top=280
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.626 ms                  | 93.941 ms                 |
| Forward                   | 4.874 ms                  | 10.597 ms                 |
| Backward                  | 10.675 ms                 | 14.229 ms                 |
| Optimize                  | 2.595 ms                  | 8.998 ms                  |
| BarrierTimeBeforeRank0    | 34.099 us                 | 37.159 ms                 |
| AfterBackward             | 27.195 ms                 | 64.422 ms                 |
| BlockToStepN              | 10.865 ms                 | 410.268 ms                |
| OneStep                   | 202.175 ms                | 529.865 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:32.669008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240203 08:55:33.669008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240203 08:55:34.669008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240203 08:55:35.669006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
[proc 0] 300 steps, total: 21.542, sample: 1.035, forward: 0.493, backward: 1.128, update: 0.281
[proc 1] 300 steps, total: 21.542, sample: 1.103, forward: 0.496, backward: 0.973, update: 0.224
[proc 2] 300 steps, total: 21.542, sample: 1.091, forward: 0.485, backward: 0.892, update: 0.238
[proc 3] 300 steps, total: 21.542, sample: 1.295, forward: 0.478, backward: 0.974, update: 0.235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.652 ms                  | 8.462 ms                  |
| ProcessBack:UpdateCache   | 2.623 ms                  | 4.670 ms                  |
| ProcessBack:UpsertPq      | 19.205 ms                 | 53.541 ms                 |
| ProcessOneStep            | 27.058 ms                 | 64.390 ms                 |
| BlockToStepN              | 10.827 ms                 | 410.196 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:36.669004   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.427 ms                  | 93.941 ms                 |
| Forward                   | 4.877 ms                  | 10.597 ms                 |
| Backward                  | 10.634 ms                 | 14.229 ms                 |
| Optimize                  | 2.595 ms                  | 8.998 ms                  |
| BarrierTimeBeforeRank0    | 36.673 us                 | 37.159 ms                 |
| AfterBackward             | 26.938 ms                 | 64.422 ms                 |
| BlockToStepN              | 10.865 ms                 | 410.268 ms                |
| OneStep                   | 202.175 ms                | 529.865 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:37.678532   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=306, pq.top=306
W20240203 08:55:38.678006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240203 08:55:39.678006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240203 08:55:40.678007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.652 ms                  | 8.462 ms                  |
| ProcessBack:UpdateCache   | 2.617 ms                  | 4.670 ms                  |
| ProcessBack:UpsertPq      | 19.192 ms                 | 56.483 ms                 |
| ProcessOneStep            | 27.109 ms                 | 71.221 ms                 |
| BlockToStepN              | 10.827 ms                 | 410.196 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:41.678005   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.451 ms                  | 93.941 ms                 |
| Forward                   | 4.872 ms                  | 10.597 ms                 |
| Backward                  | 10.750 ms                 | 14.582 ms                 |
| Optimize                  | 2.598 ms                  | 8.998 ms                  |
| BarrierTimeBeforeRank0    | 36.002 us                 | 37.159 ms                 |
| AfterBackward             | 27.145 ms                 | 71.256 ms                 |
| BlockToStepN              | 10.865 ms                 | 410.268 ms                |
| OneStep                   | 202.175 ms                | 529.865 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:42.785008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=328, pq.top=328
W20240203 08:55:43.784011   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240203 08:55:44.784008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240203 08:55:45.784008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=341, pq.top=341
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.653 ms                  | 8.067 ms                  |
| ProcessBack:UpdateCache   | 2.617 ms                  | 4.594 ms                  |
| ProcessBack:UpsertPq      | 19.205 ms                 | 56.230 ms                 |
| ProcessOneStep            | 27.144 ms                 | 71.221 ms                 |
| BlockToStepN              | 11.987 ms                 | 410.196 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:46.784018   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=345, pq.top=345
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.635 ms                  | 95.483 ms                 |
| Forward                   | 4.860 ms                  | 10.597 ms                 |
| Backward                  | 10.774 ms                 | 14.582 ms                 |
| Optimize                  | 2.590 ms                  | 8.998 ms                  |
| BarrierTimeBeforeRank0    | 34.099 us                 | 37.159 ms                 |
| AfterBackward             | 27.145 ms                 | 71.256 ms                 |
| BlockToStepN              | 12.024 ms                 | 410.268 ms                |
| OneStep                   | 202.175 ms                | 529.865 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:47.784009   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=349, pq.top=349
W20240203 08:55:48.784011   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240203 08:55:49.784008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240203 08:55:50.864660   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=367, pq.top=367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.655 ms                  | 8.067 ms                  |
| ProcessBack:UpdateCache   | 2.611 ms                  | 4.594 ms                  |
| ProcessBack:UpsertPq      | 19.138 ms                 | 56.230 ms                 |
| ProcessOneStep            | 27.109 ms                 | 64.390 ms                 |
| BlockToStepN              | 11.987 ms                 | 408.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:51.864008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=373, pq.top=373
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.613 ms                  | 93.941 ms                 |
| Forward                   | 4.864 ms                  | 10.206 ms                 |
| Backward                  | 10.768 ms                 | 14.582 ms                 |
| Optimize                  | 2.573 ms                  | 7.409 ms                  |
| BarrierTimeBeforeRank0    | 33.570 us                 | 35.603 ms                 |
| AfterBackward             | 27.140 ms                 | 64.422 ms                 |
| BlockToStepN              | 12.024 ms                 | 408.886 ms                |
| OneStep                   | 196.940 ms                | 527.516 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:52.864006   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240203 08:55:53.864007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240203 08:55:54.864010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240203 08:55:55.878028   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=390, pq.top=390
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.623 ms                  | 7.909 ms                  |
| ProcessBack:UpdateCache   | 2.607 ms                  | 4.512 ms                  |
| ProcessBack:UpsertPq      | 18.858 ms                 | 54.801 ms                 |
| ProcessOneStep            | 26.788 ms                 | 64.390 ms                 |
| BlockToStepN              | 11.987 ms                 | 408.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:56.898129   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=395, pq.top=395
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.451 ms                  | 93.941 ms                 |
| Forward                   | 4.860 ms                  | 10.206 ms                 |
| Backward                  | 10.647 ms                 | 14.582 ms                 |
| Optimize                  | 2.565 ms                  | 7.409 ms                  |
| BarrierTimeBeforeRank0    | 36.673 us                 | 35.603 ms                 |
| AfterBackward             | 26.765 ms                 | 64.422 ms                 |
| BlockToStepN              | 12.024 ms                 | 408.886 ms                |
| OneStep                   | 196.940 ms                | 527.516 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:55:57.898007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 1] 400 steps, total: 21.859, sample: 1.057, forward: 0.480, backward: 1.076, update: 0.229
[proc 0] 400 steps, total: 21.859, sample: 1.169, forward: 0.475, backward: 0.920, update: 0.264
[proc 3] 400 steps, total: 21.859, sample: 1.143, forward: 0.461, backward: 0.941, update: 0.232
[proc 2] 400 steps, total: 21.859, sample: 1.051, forward: 0.486, backward: 0.959, update: 0.234
W20240203 08:55:58.898010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240203 08:55:59.898007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240203 08:56:00.898008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.597 ms                  | 7.909 ms                  |
| ProcessBack:UpdateCache   | 2.614 ms                  | 4.512 ms                  |
| ProcessBack:UpsertPq      | 18.633 ms                 | 54.801 ms                 |
| ProcessOneStep            | 26.564 ms                 | 64.390 ms                 |
| BlockToStepN              | 138.703 ms                | 408.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:56:01.898010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=415, pq.top=415
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.387 ms                  | 93.941 ms                 |
| Forward                   | 4.865 ms                  | 10.206 ms                 |
| Backward                  | 10.560 ms                 | 14.582 ms                 |
| Optimize                  | 2.546 ms                  | 7.409 ms                  |
| BarrierTimeBeforeRank0    | 40.392 us                 | 35.603 ms                 |
| AfterBackward             | 26.593 ms                 | 64.422 ms                 |
| BlockToStepN              | 54.447 ms                 | 408.886 ms                |
| OneStep                   | 196.940 ms                | 527.516 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:56:02.898008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240203 08:56:03.898010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240203 08:56:04.898010   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240203 08:56:05.898007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=431, pq.top=431
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.586 ms                  | 7.817 ms                  |
| ProcessBack:UpdateCache   | 2.618 ms                  | 4.396 ms                  |
| ProcessBack:UpsertPq      | 18.455 ms                 | 53.541 ms                 |
| ProcessOneStep            | 26.379 ms                 | 64.390 ms                 |
| BlockToStepN              | 75.259 ms                 | 408.779 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:56:06.960814   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=436, pq.top=436
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.288 ms                  | 93.941 ms                 |
| Forward                   | 4.865 ms                  | 10.206 ms                 |
| Backward                  | 10.486 ms                 | 14.582 ms                 |
| Optimize                  | 2.535 ms                  | 7.409 ms                  |
| BarrierTimeBeforeRank0    | 45.525 us                 | 35.603 ms                 |
| AfterBackward             | 26.378 ms                 | 64.422 ms                 |
| BlockToStepN              | 138.751 ms                | 408.886 ms                |
| OneStep                   | 202.175 ms                | 527.516 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:56:08.012351   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=440, pq.top=440
W20240203 08:56:09.028322   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240203 08:56:10.028007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240203 08:56:11.032408   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=453, pq.top=453
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.575 ms                  | 7.909 ms                  |
| ProcessBack:UpdateCache   | 2.618 ms                  | 4.396 ms                  |
| ProcessBack:UpsertPq      | 18.376 ms                 | 53.541 ms                 |
| ProcessOneStep            | 26.223 ms                 | 62.240 ms                 |
| BlockToStepN              | 84.946 ms                 | 407.256 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:56:12.086601   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=456, pq.top=456
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.198 ms                  | 93.045 ms                 |
| Forward                   | 4.872 ms                  | 7.659 ms                  |
| Backward                  | 10.429 ms                 | 14.229 ms                 |
| Optimize                  | 2.521 ms                  | 6.232 ms                  |
| BarrierTimeBeforeRank0    | 54.707 us                 | 35.359 ms                 |
| AfterBackward             | 26.248 ms                 | 62.284 ms                 |
| BlockToStepN              | 84.986 ms                 | 407.323 ms                |
| OneStep                   | 196.940 ms                | 525.348 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:56:13.086005   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240203 08:56:14.086005   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=465, pq.top=465
W20240203 08:56:15.086007   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240203 08:56:16.108592   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=473, pq.top=473
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.562 ms                  | 7.909 ms                  |
| ProcessBack:UpdateCache   | 2.617 ms                  | 4.396 ms                  |
| ProcessBack:UpsertPq      | 18.240 ms                 | 53.541 ms                 |
| ProcessOneStep            | 26.062 ms                 | 62.240 ms                 |
| BlockToStepN              | 84.946 ms                 | 407.256 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:56:17.210759   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=479, pq.top=479
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.164 ms                  | 93.045 ms                 |
| Forward                   | 4.865 ms                  | 10.206 ms                 |
| Backward                  | 10.396 ms                 | 14.582 ms                 |
| Optimize                  | 2.515 ms                  | 6.232 ms                  |
| BarrierTimeBeforeRank0    | 265.588 us                | 35.603 ms                 |
| AfterBackward             | 26.031 ms                 | 62.284 ms                 |
| BlockToStepN              | 84.986 ms                 | 407.323 ms                |
| OneStep                   | 196.940 ms                | 525.348 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 08:56:18.309685   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240203 08:56:19.309008   916 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=493, pq.top=493
[proc 0] 500 steps, total: 21.908, sample: 0.996, forward: 0.494, backward: 0.660, update: 0.257
[proc 2] 500 steps, total: 21.908, sample: 1.017, forward: 0.501, backward: 0.961, update: 0.237
[proc 1] 500 steps, total: 21.908, sample: 1.009, forward: 0.506, backward: 1.051, update: 0.223
[proc 3] 500 steps, total: 21.908, sample: 1.030, forward: 0.514, backward: 0.950, update: 0.236
Successfully xmh. training takes 117.03333187103271 seconds
before call kg_cache_controller.StopThreads()
W20240203 08:56:20.138345   916 grad_async_v1.h:243] call StopThreads. PID = 41188
W20240203 08:56:20.138370   916 grad_base.h:212] before processOneStepNegThread_.join();
W20240203 08:56:20.146054   916 grad_base.h:214] after processOneStepNegThread_.join();
W20240203 08:56:20.146086   916 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240203 08:56:20.477711   916 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.566 ms                  | 7.817 ms                  |
| ProcessBack:UpdateCache   | 2.615 ms                  | 4.396 ms                  |
| ProcessBack:UpsertPq      | 18.241 ms                 | 52.684 ms                 |
| ProcessOneStep            | 26.127 ms                 | 62.240 ms                 |
| BlockToStepN              | 84.946 ms                 | 407.256 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.188 ms                  | 93.045 ms                 |
| Forward                   | 4.858 ms                  | 10.206 ms                 |
| Backward                  | 10.408 ms                 | 14.582 ms                 |
| Optimize                  | 2.516 ms                  | 6.232 ms                  |
| BarrierTimeBeforeRank0    | 52.951 us                 | 35.603 ms                 |
| AfterBackward             | 26.155 ms                 | 62.284 ms                 |
| BlockToStepN              | 84.986 ms                 | 407.323 ms                |
| OneStep                   | 196.940 ms                | 525.348 ms                |
+---------------------------+---------------------------+---------------------------+
