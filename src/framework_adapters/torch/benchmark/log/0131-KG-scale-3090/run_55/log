WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240203 00:22:03.103139 57631 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_49', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [57631 sampler.py:454] Start PreSampling
WARNING [57631 sampler.py:532] Before construct renumbering_dict
WARNING [57631 sampler.py:555] PreSampling done
W20240203 00:41:57.958992 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240203 00:41:57.959168 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240203 00:41:57.959205 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240203 00:41:57.959244 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240203 00:41:57.959272 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240203 00:41:57.959308 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240203 00:41:57.959336 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240203 00:41:57.959383 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240203 00:41:57.959420 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240203 00:41:57.959448 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240203 00:41:57.959483 57631 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240203 00:41:57.959512 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240203 00:41:57.959539 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240203 00:41:57.959686 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240203 00:41:57.959723 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240203 00:41:57.959753 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240203 00:41:57.959791 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240203 00:41:57.959820 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240203 00:41:57.959851 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240203 00:41:57.959885 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240203 00:41:57.959910 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240203 00:41:57.959939 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240203 00:41:57.959968 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240203 00:41:57.959997 57631 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240203 00:41:57.960019 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240203 00:41:57.960042 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240203 00:41:57.960121 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240203 00:41:57.960150 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240203 00:41:57.960177 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240203 00:41:57.960213 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240203 00:41:57.960247 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240203 00:41:57.960273 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240203 00:41:57.960304 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240203 00:41:57.960336 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240203 00:41:57.960373 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240203 00:41:57.960410 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240203 00:41:57.960445 57631 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240203 00:41:57.960467 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240203 00:41:57.960495 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240203 00:41:57.960563 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240203 00:41:57.960593 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240203 00:41:57.960623 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240203 00:41:57.960650 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240203 00:41:57.960676 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240203 00:41:57.960703 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240203 00:41:57.960733 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240203 00:41:57.960760 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240203 00:41:57.960788 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240203 00:41:57.960817 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240203 00:41:57.960845 57631 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240203 00:41:57.960867 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240203 00:41:57.960891 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240203 00:41:57.960951 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240203 00:41:57.960988 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240203 00:41:57.961014 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240203 00:41:57.961041 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240203 00:41:57.961072 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240203 00:41:57.961104 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240203 00:41:57.961136 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240203 00:41:57.961162 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240203 00:41:57.961194 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240203 00:41:57.961225 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240203 00:41:57.961251 57631 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240203 00:41:57.961274 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240203 00:41:57.961297 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240203 00:41:57.961344 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240203 00:41:57.961376 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240203 00:41:57.961405 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240203 00:41:57.961438 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240203 00:41:57.961468 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240203 00:41:57.961495 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240203 00:41:57.961524 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240203 00:41:57.961556 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240203 00:41:57.961588 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240203 00:41:57.961627 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240203 00:41:57.961660 57631 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240203 00:41:57.961683 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240203 00:41:57.961705 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240203 00:41:57.961755 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240203 00:41:57.961792 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240203 00:41:57.961822 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240203 00:41:57.961854 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240203 00:41:57.961881 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240203 00:41:57.961917 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240203 00:41:57.961951 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240203 00:41:57.961990 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240203 00:41:57.962028 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240203 00:41:57.962060 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240203 00:41:57.962100 57631 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240203 00:41:57.962124 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240203 00:41:57.962146 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240203 00:41:57.962195 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240203 00:41:57.962230 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240203 00:41:57.962263 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240203 00:41:57.962298 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240203 00:41:57.962327 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240203 00:41:57.962353 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240203 00:41:57.962386 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240203 00:41:57.962419 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240203 00:41:57.962457 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240203 00:41:57.962492 57631 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240203 00:41:57.962525 57631 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240203 00:41:57.962549 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240203 00:41:57.962571 57631 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240203 00:41:58.413172 57631 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240203 00:50:39.431735 57631 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302708,  4302727,    98524,  ..., 57941466, 50880461,  5084727]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2228.253 seconds
[Rank1] pid = 18819
[Rank2] pid = 18913
[Rank3] pid = 18981
[Rank4] pid = 19113
[Rank5] pid = 19226
[Rank6] pid = 19293
INFO [57631 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [18819 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [18913 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [18981 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [19113 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [19226 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [19293 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [19426 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [18981 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19113 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19226 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19293 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [18913 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19426 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57631 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [18819 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240203 00:59:23.251370 18982 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240203 00:59:23.254431 19427 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240203 00:59:23.255067 18914 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240203 00:59:23.255167 19499 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240203 00:59:23.255273 19294 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240203 00:59:23.255290 19135 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240203 00:59:23.255357 19227 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240203 00:59:23.255380 18820 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240203 00:59:23.346356 19294 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1020497b1000 7.629 MB
W20240203 00:59:23.346576 19499 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204a6f7000 7.629 MB
W20240203 00:59:23.346573 18914 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102049f54000 7.629 MB
W20240203 00:59:23.346621 19294 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204b63d000 7.629 MB
W20240203 00:59:23.346614 18820 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204ae9a000 7.629 MB
W20240203 00:59:23.346637 19135 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204bde0000 7.629 MB
W20240203 00:59:23.346690 19294 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10204c583000 1.49 GB
W20240203 00:59:23.346743 19294 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1020acaac000 1.49 GB
W20240203 00:59:23.346742 18982 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1020ac309000 7.629 MB
W20240203 00:59:23.346741 19427 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1020abb66000 7.629 MB
W20240203 00:59:23.346758 19227 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10210c08f000 7.629 MB
W20240203 00:59:23.346801 19294 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240203 00:59:23.348548 19427 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210c834000 7.629 MB
W20240203 00:59:23.348620 19294 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240203 00:59:23.348645 19227 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10210cfd7000 7.629 MB
W20240203 00:59:23.348666 19427 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210d77a000 1.49 GB
W20240203 00:59:23.348690 19135 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10216cd5d000 7.629 MB
W20240203 00:59:23.348697 18982 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10216d500000 7.629 MB
W20240203 00:59:23.348737 19499 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10216dca3000 7.629 MB
W20240203 00:59:23.348739 19427 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10216e446000 1.49 GB
W20240203 00:59:23.348798 18820 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1021cda29000 7.629 MB
W20240203 00:59:23.348805 18914 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1021ce1cc000 7.629 MB
W20240203 00:59:23.348821 19427 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 00:59:23.348878 18820 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021ce96f000 1.49 GB
W20240203 00:59:23.348925 18820 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10222df52000 1.49 GB
W20240203 00:59:23.348971 18820 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 00:59:23.350241 19499 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10228d535000 1.49 GB
W20240203 00:59:23.350247 19135 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1022ecb18000 1.49 GB
W20240203 00:59:23.350296 19499 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10234c0fb000 1.49 GB
W20240203 00:59:23.350312 19135 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1023ab6de000 1.49 GB
W20240203 00:59:23.352304 19135 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 00:59:23.352314 19499 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240203 00:59:23.353901 18914 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10240acc1000 1.49 GB
W20240203 00:59:23.353921 18982 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10246a2a4000 1.49 GB
W20240203 00:59:23.353940 19227 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1024c9887000 1.49 GB
W20240203 00:59:23.353965 18914 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102528e6a000 1.49 GB
W20240203 00:59:23.353981 18982 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10258844d000 1.49 GB
W20240203 00:59:23.353997 19227 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1025e7a30000 1.49 GB
W20240203 00:59:23.354013 18914 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 00:59:23.354025 18982 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 00:59:23.354040 19227 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 00:59:23.364231 18820 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 00:59:23.364432 19499 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240203 00:59:23.367445 18982 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 00:59:23.367488 19135 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 00:59:23.367496 19227 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 00:59:23.367496 18914 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 00:59:23.376425 19427 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [18981 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [19226 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 19426
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [57631 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [18913 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [19293 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [19426 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [19113 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [18819 DistTensor.py:59] The tensor name already exists in the kvstore
I20240203 01:00:14.522418 18820 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240203 01:00:14.522683 18982 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 01:00:14.522850 19294 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 01:00:14.523015 19499 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 01:00:14.523118 19227 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 01:00:14.523258 19427 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 01:00:14.524202 19135 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 01:00:14.524266 18914 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240203 01:00:16.320729 18982 recstore.cc:66] init folly done
E20240203 01:00:16.320771 19294 recstore.cc:66] init folly done
E20240203 01:00:16.321149 19427 recstore.cc:66] init folly done
E20240203 01:00:16.321168 19135 recstore.cc:66] init folly done
E20240203 01:00:16.321552 19227 recstore.cc:66] init folly done
E20240203 01:00:16.321560 19499 recstore.cc:66] init folly done
E20240203 01:00:16.322340 18914 recstore.cc:66] init folly done
E20240203 01:00:16.322474 18820 recstore.cc:66] init folly done
I20240203 01:00:22.130939 19227 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240203 01:00:22.160318 19499 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 01:00:22.364899 19135 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 01:00:23.414251 18914 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 01:00:24.231634 18982 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 01:00:24.326365 18820 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 01:00:24.790105 19427 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 01:00:25.446117 19294 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.325 ms                  | 11.850 ms                 |
| Forward                   | 5.054 ms                  | 615.165 ms                |
| Backward                  | 3.163 s                   | 3.163 s                   |
| Optimize                  | 142.243 ms                | 142.243 ms                |
| BarrierTimeBeforeRank0    | 45.251 us                 | 45.251 us                 |
| BlockToStepN              | 57.246 us                 | 57.246 us                 |
| OneStep                   | 3.934 s                   | 3.934 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.161 ms                  | 107.134 ms                |
| Forward                   | 5.054 ms                  | 615.165 ms                |
| Backward                  | 445.993 ms                | 3.163 s                   |
| Optimize                  | 121.227 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 46.913 us                 | 66.681 us                 |
| BlockToStepN              | 61.067 us                 | 25.391 ms                 |
| OneStep                   | 590.111 ms                | 3.934 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.543 ms                  | 107.134 ms                |
| Forward                   | 4.959 ms                  | 615.165 ms                |
| Backward                  | 445.993 ms                | 3.163 s                   |
| Optimize                  | 120.775 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 47.113 us                 | 66.681 us                 |
| BlockToStepN              | 60.785 us                 | 25.391 ms                 |
| OneStep                   | 584.702 ms                | 3.934 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.543 ms                  | 109.327 ms                |
| Forward                   | 5.054 ms                  | 615.165 ms                |
| Backward                  | 429.998 ms                | 3.163 s                   |
| Optimize                  | 120.607 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 47.610 us                 | 76.787 us                 |
| BlockToStepN              | 55.096 us                 | 25.391 ms                 |
| OneStep                   | 578.032 ms                | 3.934 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.765 ms                  | 109.327 ms                |
| Forward                   | 5.054 ms                  | 615.165 ms                |
| Backward                  | 413.024 ms                | 3.163 s                   |
| Optimize                  | 120.185 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 47.113 us                 | 76.787 us                 |
| BlockToStepN              | 54.945 us                 | 25.391 ms                 |
| OneStep                   | 557.694 ms                | 3.934 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.751 ms                  | 109.327 ms                |
| Forward                   | 5.054 ms                  | 615.165 ms                |
| Backward                  | 421.438 ms                | 3.163 s                   |
| Optimize                  | 120.278 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 46.900 us                 | 76.787 us                 |
| BlockToStepN              | 55.044 us                 | 25.391 ms                 |
| OneStep                   | 557.761 ms                | 3.934 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.143 ms                  | 107.134 ms                |
| Forward                   | 5.118 ms                  | 6.137 ms                  |
| Backward                  | 415.089 ms                | 535.818 ms                |
| Optimize                  | 120.033 ms                | 143.224 ms                |
| BarrierTimeBeforeRank0    | 45.523 us                 | 66.822 us                 |
| BlockToStepN              | 55.096 us                 | 22.169 ms                 |
| OneStep                   | 557.694 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.751 ms                  | 107.134 ms                |
| Forward                   | 5.130 ms                  | 10.424 ms                 |
| Backward                  | 428.282 ms                | 535.818 ms                |
| Optimize                  | 120.033 ms                | 143.224 ms                |
| BarrierTimeBeforeRank0    | 46.539 us                 | 76.039 us                 |
| BlockToStepN              | 55.876 us                 | 22.169 ms                 |
| OneStep                   | 562.165 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.627 ms                  | 107.134 ms                |
| Forward                   | 5.134 ms                  | 10.424 ms                 |
| Backward                  | 429.937 ms                | 535.818 ms                |
| Optimize                  | 120.033 ms                | 149.659 ms                |
| BarrierTimeBeforeRank0    | 46.517 us                 | 76.787 us                 |
| BlockToStepN              | 55.624 us                 | 22.169 ms                 |
| OneStep                   | 562.165 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.275 ms                  | 107.134 ms                |
| Forward                   | 5.169 ms                  | 10.424 ms                 |
| Backward                  | 433.515 ms                | 535.818 ms                |
| Optimize                  | 120.157 ms                | 149.659 ms                |
| BarrierTimeBeforeRank0    | 45.523 us                 | 76.787 us                 |
| BlockToStepN              | 55.876 us                 | 22.169 ms                 |
| OneStep                   | 570.892 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.840 ms                  | 107.134 ms                |
| Forward                   | 5.171 ms                  | 10.424 ms                 |
| Backward                  | 440.956 ms                | 581.473 ms                |
| Optimize                  | 120.157 ms                | 149.659 ms                |
| BarrierTimeBeforeRank0    | 45.270 us                 | 76.787 us                 |
| BlockToStepN              | 56.924 us                 | 22.169 ms                 |
| OneStep                   | 578.032 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.840 ms                  | 107.134 ms                |
| Forward                   | 5.151 ms                  | 10.424 ms                 |
| Backward                  | 434.368 ms                | 581.473 ms                |
| Optimize                  | 120.033 ms                | 149.659 ms                |
| BarrierTimeBeforeRank0    | 45.523 us                 | 76.787 us                 |
| BlockToStepN              | 56.094 us                 | 22.169 ms                 |
| OneStep                   | 575.543 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 63.340, sample: 1.302, forward: 1.139, backward: 19.583, update: 0.305
train_sampler.Prefill()
-------Step 0-------
tensor([   68363,    68401,    68436,    68469,  6197208,   137696, 53443935,
        15243291, 22873907,    68538]) tensor([ 5407016, 17824472, 56842265, 81529757, 17026200, 32643641, 36608705,
        80022267, 62761457, 26573233])
-------Step 1-------
tensor([   68363,    68401,    68436,    68469,  6197208,   137696, 53443935,
        15243291, 22873907,    68538]) tensor([77688093, 26528863,  9402497, 71270283, 85155813, 41618600, 65754846,
        55419179, 37041797, 11488666])
-------Step 2-------
tensor([  173229,   173271,   173315,    34320,   173355,   173397,   173431,
        26581610,   173460,   173510]) tensor([76577645, 26145716, 71694033, 47797856, 40952347, 29907512, 77954649,
        41800755, 13055000, 40857972])
-------Step 3-------
tensor([  173229,   173271,   173315,    34320,   173355,   173397,   173431,
        26581610,   173460,   173510]) tensor([47250783, 74907433, 35041151, 38703260, 57194912, 59850934, 36032035,
        14137869, 23402812,   774929])
-------Step 4-------
tensor([  276529, 43746597,   276567,   177363,   276596,   177416,   276650,
        40277549,   276693,   276729]) tensor([71722691,  8862523, 85797352, 15236496, 64545195, 40539444, 60500218,
        38013958, 83555044, 48772533])
-------Step 5-------
tensor([  276529, 43746597,   276567,   177363,   276596,   177416,   276650,
        40277549,   276693,   276729]) tensor([34327201, 82689246,   206057, 77027461, 62214915, 59577036, 13574975,
        11171736, 66024772, 41224502])
-------Step 6-------
tensor([  379514,    72704,   379544,   379593,    72744, 67588567,   379642,
          379691,   196728, 37064161]) tensor([11297980, 37901910, 33949523, 74035166, 32345482, 36665717, 25884690,
         7411022, 73523201, 82760448])
-------Step 7-------
tensor([  379514,    72704,   379544,   379593,    72744, 67588567,   379642,
          379691,   196728, 37064161]) tensor([26982130, 50199989, 64812171, 56967174, 70360785, 52855449, 58020886,
        53143455, 35716670, 34987065])
-------Step 8-------
tensor([  448830, 26779239,   448850,   214719,   448868,    91367,   448884,
          448903,   448921,   448942]) tensor([46039966, 26726482, 34279452,  2048409, 47923628, 60193782, 12786854,
        65295981,  1583920, 62736870])
-------Step 9-------
tensor([  448830, 26779239,   448850,   214719,   448868,    91367,   448884,
          448903,   448921,   448942]) tensor([50443071, 36557721, 16822871, 49895203, 10297157, 38578638, 28012126,
        37307703, 85574897, 77553694])
before start barrier
start train
[proc 0] 100 steps, total: 61.964, sample: 1.509, forward: 1.125, backward: 46.613, update: 11.842
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 64.623, sample: 1.278, forward: 1.151, backward: 19.350, update: 0.306
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 64.594, sample: 1.277, forward: 1.171, backward: 19.665, update: 0.310
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 62.428, sample: 1.329, forward: 1.178, backward: 19.974, update: 0.302
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 62.522, sample: 1.427, forward: 1.109, backward: 19.422, update: 0.314
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 64.389, sample: 1.298, forward: 1.158, backward: 19.228, update: 0.342
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 61.308, sample: 1.363, forward: 1.191, backward: 19.138, update: 0.321
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.143 ms                  | 107.134 ms                |
| Forward                   | 5.169 ms                  | 10.424 ms                 |
| Backward                  | 440.563 ms                | 581.473 ms                |
| Optimize                  | 119.812 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 45.523 us                 | 78.091 us                 |
| BlockToStepN              | 55.876 us                 | 22.169 ms                 |
| OneStep                   | 575.543 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.825 ms                  | 107.134 ms                |
| Forward                   | 5.169 ms                  | 10.424 ms                 |
| Backward                  | 442.600 ms                | 581.473 ms                |
| Optimize                  | 119.424 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 45.270 us                 | 78.091 us                 |
| BlockToStepN              | 55.876 us                 | 22.169 ms                 |
| OneStep                   | 578.032 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.782 ms                  | 107.134 ms                |
| Forward                   | 5.134 ms                  | 10.424 ms                 |
| Backward                  | 443.064 ms                | 581.473 ms                |
| Optimize                  | 119.696 ms                | 168.875 ms                |
| BarrierTimeBeforeRank0    | 45.071 us                 | 78.091 us                 |
| BlockToStepN              | 56.445 us                 | 22.169 ms                 |
| OneStep                   | 580.552 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.789 ms                  | 107.134 ms                |
| Forward                   | 5.171 ms                  | 10.424 ms                 |
| Backward                  | 437.557 ms                | 581.473 ms                |
| Optimize                  | 119.812 ms                | 168.875 ms                |
| BarrierTimeBeforeRank0    | 44.733 us                 | 78.091 us                 |
| BlockToStepN              | 56.420 us                 | 22.169 ms                 |
| OneStep                   | 572.233 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.789 ms                  | 107.134 ms                |
| Forward                   | 5.171 ms                  | 10.424 ms                 |
| Backward                  | 433.377 ms                | 581.473 ms                |
| Optimize                  | 119.812 ms                | 168.875 ms                |
| BarrierTimeBeforeRank0    | 44.006 us                 | 121.528 us                |
| BlockToStepN              | 55.929 us                 | 22.169 ms                 |
| OneStep                   | 570.892 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.768 ms                  | 107.134 ms                |
| Forward                   | 5.187 ms                  | 10.424 ms                 |
| Backward                  | 433.515 ms                | 581.473 ms                |
| Optimize                  | 119.812 ms                | 168.875 ms                |
| BarrierTimeBeforeRank0    | 43.808 us                 | 121.528 us                |
| BlockToStepN              | 55.876 us                 | 22.169 ms                 |
| OneStep                   | 572.233 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.728 ms                  | 99.900 ms                 |
| Forward                   | 5.171 ms                  | 9.057 ms                  |
| Backward                  | 440.563 ms                | 581.473 ms                |
| Optimize                  | 120.157 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 43.591 us                 | 78.091 us                 |
| BlockToStepN              | 56.420 us                 | 17.870 ms                 |
| OneStep                   | 576.099 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.782 ms                  | 99.900 ms                 |
| Forward                   | 5.171 ms                  | 9.057 ms                  |
| Backward                  | 440.563 ms                | 581.473 ms                |
| Optimize                  | 120.157 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 41.483 us                 | 78.091 us                 |
| BlockToStepN              | 56.027 us                 | 17.870 ms                 |
| OneStep                   | 576.099 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.782 ms                  | 100.230 ms                |
| Forward                   | 5.171 ms                  | 9.057 ms                  |
| Backward                  | 434.368 ms                | 581.473 ms                |
| Optimize                  | 120.278 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 42.693 us                 | 78.091 us                 |
| BlockToStepN              | 55.876 us                 | 17.870 ms                 |
| OneStep                   | 575.543 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.768 ms                  | 100.230 ms                |
| Forward                   | 5.191 ms                  | 9.057 ms                  |
| Backward                  | 433.135 ms                | 581.473 ms                |
| Optimize                  | 120.157 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 41.435 us                 | 78.091 us                 |
| BlockToStepN              | 55.177 us                 | 17.870 ms                 |
| OneStep                   | 571.665 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.728 ms                  | 100.230 ms                |
| Forward                   | 5.191 ms                  | 9.057 ms                  |
| Backward                  | 429.552 ms                | 581.473 ms                |
| Optimize                  | 120.185 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 41.369 us                 | 121.528 us                |
| BlockToStepN              | 55.177 us                 | 17.870 ms                 |
| OneStep                   | 569.366 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 56.454, sample: 1.265, forward: 0.537, backward: 16.277, update: 0.322
[proc 4] 200 steps, total: 56.454, sample: 1.305, forward: 0.548, backward: 16.206, update: 0.299
[proc 0] 200 steps, total: 56.454, sample: 1.377, forward: 0.524, backward: 42.267, update: 12.082
[proc 1] 200 steps, total: 56.454, sample: 1.324, forward: 0.539, backward: 16.891, update: 0.297
[proc 3] 200 steps, total: 56.454, sample: 1.486, forward: 0.578, backward: 16.354, update: 0.297
[proc 7] 200 steps, total: 56.454, sample: 1.293, forward: 0.532, backward: 16.677, update: 0.295
[proc 6] 200 steps, total: 56.454, sample: 1.314, forward: 0.538, backward: 16.133, update: 0.307
[proc 2] 200 steps, total: 56.454, sample: 1.296, forward: 0.520, backward: 16.518, update: 0.320
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.768 ms                  | 104.751 ms                |
| Forward                   | 5.179 ms                  | 9.057 ms                  |
| Backward                  | 426.743 ms                | 581.473 ms                |
| Optimize                  | 120.185 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 42.693 us                 | 121.528 us                |
| BlockToStepN              | 55.624 us                 | 17.870 ms                 |
| OneStep                   | 566.381 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.768 ms                  | 104.751 ms                |
| Forward                   | 5.191 ms                  | 9.057 ms                  |
| Backward                  | 421.717 ms                | 581.473 ms                |
| Optimize                  | 120.185 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 43.588 us                 | 121.528 us                |
| BlockToStepN              | 55.096 us                 | 17.870 ms                 |
| OneStep                   | 561.153 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.728 ms                  | 104.751 ms                |
| Forward                   | 5.211 ms                  | 9.604 ms                  |
| Backward                  | 419.363 ms                | 581.473 ms                |
| Optimize                  | 120.278 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 43.055 us                 | 121.528 us                |
| BlockToStepN              | 55.597 us                 | 17.870 ms                 |
| OneStep                   | 557.761 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.653 ms                  | 104.751 ms                |
| Forward                   | 5.210 ms                  | 9.604 ms                  |
| Backward                  | 417.095 ms                | 581.473 ms                |
| Optimize                  | 120.235 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 41.483 us                 | 121.528 us                |
| BlockToStepN              | 56.027 us                 | 17.870 ms                 |
| OneStep                   | 557.116 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.700 ms                  | 104.751 ms                |
| Forward                   | 5.210 ms                  | 9.604 ms                  |
| Backward                  | 411.362 ms                | 581.473 ms                |
| Optimize                  | 120.294 ms                | 158.200 ms                |
| BarrierTimeBeforeRank0    | 41.369 us                 | 121.528 us                |
| BlockToStepN              | 55.734 us                 | 17.870 ms                 |
| OneStep                   | 553.283 ms                | 738.369 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.716 ms                  | 100.230 ms                |
| Forward                   | 5.210 ms                  | 9.057 ms                  |
| Backward                  | 409.757 ms                | 541.460 ms                |
| Optimize                  | 120.317 ms                | 152.009 ms                |
| BarrierTimeBeforeRank0    | 40.709 us                 | 78.091 us                 |
| BlockToStepN              | 55.245 us                 | 17.288 ms                 |
| OneStep                   | 549.670 ms                | 713.220 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.618 ms                  | 100.230 ms                |
| Forward                   | 5.210 ms                  | 9.057 ms                  |
| Backward                  | 408.559 ms                | 541.460 ms                |
| Optimize                  | 120.317 ms                | 152.009 ms                |
| BarrierTimeBeforeRank0    | 40.709 us                 | 78.091 us                 |
| BlockToStepN              | 55.597 us                 | 17.288 ms                 |
| OneStep                   | 547.853 ms                | 713.220 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 153.21485257148743 seconds
before call kg_cache_controller.StopThreads()
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
INFO [57631 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.593 ms                  | 100.230 ms                |
| Forward                   | 5.191 ms                  | 9.057 ms                  |
| Backward                  | 405.784 ms                | 541.460 ms                |
| Optimize                  | 120.354 ms                | 155.337 ms                |
| BarrierTimeBeforeRank0    | 40.257 us                 | 78.091 us                 |
| BlockToStepN              | 55.929 us                 | 17.288 ms                 |
| OneStep                   | 544.647 ms                | 713.220 ms                |
+---------------------------+---------------------------+---------------------------+
