WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240207 03:34:32.812989 50037 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_25', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [50037 sampler.py:454] Start PreSampling
WARNING [50037 sampler.py:532] Before construct renumbering_dict
WARNING [50037 sampler.py:555] PreSampling done
W20240207 03:53:16.003036 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240207 03:53:16.003252 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240207 03:53:16.003304 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240207 03:53:16.003335 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240207 03:53:16.003368 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240207 03:53:16.003399 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240207 03:53:16.003427 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240207 03:53:16.003463 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240207 03:53:16.003497 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240207 03:53:16.003525 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240207 03:53:16.003556 50037 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240207 03:53:16.003582 50037 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240207 03:53:16.003616 50037 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240207 03:53:16.003787 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240207 03:53:16.003816 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240207 03:53:16.003844 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240207 03:53:16.003881 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240207 03:53:16.003906 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240207 03:53:16.003929 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240207 03:53:16.003952 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240207 03:53:16.003989 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240207 03:53:16.004019 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240207 03:53:16.004062 50037 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240207 03:53:16.004091 50037 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240207 03:53:16.004112 50037 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240207 03:53:16.004132 50037 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240207 03:53:16.443672 50037 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000098ca000 128.2 GB
W20240207 04:01:27.457124 50037 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102018502000 328.3 MB
{0: Graph(num_nodes=43196088, num_edges=182879791,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=47371617, num_edges=163853044,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 43196088 N 182879791 E
MertisPartition: part 1 has 47371617 N 163853044 E
Rank0: cached key size 2151353
Rank1: cached key size 2151353
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 24862891, 27748820, 20932263]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([ 4302706,  4302716,   754023,  ..., 28606336, 33868469, 78507246]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=43196088, num_edges=182879791,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2118.690 seconds
INFO [51093 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [50037 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [50037 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [51093 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
W20240207 04:09:54.546241 51094 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240207 04:09:54.546890 51158 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240207 04:09:54.586690 51094 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10202cd4b000 7.629 MB
W20240207 04:09:54.586828 51094 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10202d4f0000 7.629 MB
W20240207 04:09:54.586872 51158 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10202dc93000 7.629 MB
W20240207 04:09:54.586894 51094 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10202e436000 1.49 GB
W20240207 04:09:54.586956 51094 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10208da19000 1.49 GB
W20240207 04:09:54.587013 51158 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1020ecffc000 7.629 MB
W20240207 04:09:54.587028 51094 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 04:09:54.587070 51158 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1020ed79f000 1.49 GB
W20240207 04:09:54.587116 51158 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10214cd82000 1.49 GB
W20240207 04:09:54.587152 51158 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 04:09:54.591737 51094 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 04:09:54.591748 51158 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
[Rank1] pid = 51093
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414)]
cudaHostRegister 0x1000098ca000
0: KnownLocalCachedEmbedding init done
WARNING [50037 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000098ca000
1: KnownLocalCachedEmbedding init done
WARNING [51093 DistTensor.py:59] The tensor name already exists in the kvstore
I20240207 04:10:17.098150 51094 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240207 04:10:17.098193 51158 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
E20240207 04:10:17.323273 51094 recstore.cc:66] init folly done
E20240207 04:10:17.323319 51158 recstore.cc:66] init folly done
I20240207 04:10:40.941392 51158 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240207 04:10:43.433365 51094 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.636 ms                  | 274.531 ms                |
| Forward                   | 4.904 ms                  | 428.297 ms                |
| back: bucket keys         | 202.506 us                | 11.485 ms                 |
| back: a2a                 | 8.262 ms                  | 672.172 ms                |
| back: cache               | 4.809 ms                  | 41.529 ms                 |
| back: aggr dram keys      | 27.923 ms                 | 173.955 ms                |
| back: set dram grad       | 2.255 ms                  | 17.554 ms                 |
| Backward                  | 92.229 ms                 | 1.142 s                   |
| Optimize                  | 24.762 ms                 | 64.290 ms                 |
| BarrierTimeBeforeRank0    | 48.045 us                 | 69.657 us                 |
| BlockToStepN              | 12.391 us                 | 23.070 us                 |
| OneStep                   | 134.257 ms                | 1.646 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.254 ms                  | 258.410 ms                |
| Forward                   | 4.766 ms                  | 6.627 ms                  |
| back: bucket keys         | 248.363 us                | 483.385 us                |
| back: a2a                 | 4.670 ms                  | 39.784 ms                 |
| back: cache               | 7.714 ms                  | 17.094 ms                 |
| back: aggr dram keys      | 22.118 ms                 | 49.419 ms                 |
| back: set dram grad       | 4.106 ms                  | 14.207 ms                 |
| Backward                  | 83.396 ms                 | 1.142 s                   |
| Optimize                  | 22.694 ms                 | 64.290 ms                 |
| BarrierTimeBeforeRank0    | 44.460 us                 | 72.930 us                 |
| BlockToStepN              | 12.315 us                 | 50.963 us                 |
| OneStep                   | 121.871 ms                | 1.646 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.169 ms                  | 258.410 ms                |
| Forward                   | 4.791 ms                  | 6.627 ms                  |
| back: bucket keys         | 220.340 us                | 483.385 us                |
| back: a2a                 | 4.648 ms                  | 32.488 ms                 |
| back: cache               | 7.714 ms                  | 16.920 ms                 |
| back: aggr dram keys      | 18.634 ms                 | 49.419 ms                 |
| back: set dram grad       | 2.312 ms                  | 11.630 ms                 |
| Backward                  | 82.359 ms                 | 134.316 ms                |
| Optimize                  | 23.224 ms                 | 48.831 ms                 |
| BarrierTimeBeforeRank0    | 39.095 us                 | 92.825 us                 |
| BlockToStepN              | 12.141 us                 | 94.760 us                 |
| OneStep                   | 118.884 ms                | 401.796 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 17.558, sample: 2.006, forward: 0.814, backward: 8.005, update: 0.399
train_sampler.Prefill()
-------Step 0-------
tensor([1152069, 1152090, 1152111, 1206670, 1152142, 1152164, 1152189,   18713,
        1152212, 1152249]) tensor([  229626,  4606472, 20751637, 42003585, 40946194, 19089744, 62134687,
         8950912, 51408056, 54193610])
-------Step 1-------
tensor([1152069, 1152090, 1152111, 1206670, 1152142, 1152164, 1152189,   18713,
        1152212, 1152249]) tensor([59692123, 74615546, 56695327, 47952920, 51428288,   146380, 34651491,
        63273188, 81599459, 68476951])
-------Step 2-------
tensor([1240218, 1240243, 1240269, 1240299, 1240321, 1240343, 1240363, 1240386,
        1213011, 1240410]) tensor([14700426, 14104152, 35046564, 68458533, 29326849,  1548081, 31090745,
        56837199, 55354945, 14032726])
-------Step 3-------
tensor([1240218, 1240243, 1240269, 1240299, 1240321, 1240343, 1240363, 1240386,
        1213011, 1240410]) tensor([54672550, 71892080,  2330199, 31915038, 60976738, 48501430, 38787822,
        41376547, 57023630, 27916774])
-------Step 4-------
tensor([ 1315636,  1315662,   300425,  1315684,   300467, 60933068,  1264630,
         1315709,  1315736,  1315759]) tensor([  737246, 82829519, 31800629, 30610064, 71875566, 47589164, 45083604,
        26346311, 23122642, 33055140])
-------Step 5-------
tensor([ 1315636,  1315662,   300425,  1315684,   300467, 60933068,  1264630,
         1315709,  1315736,  1315759]) tensor([44561339, 30694898, 63608236, 20450452, 20578520, 78106392, 60781183,
        13012192, 61606603, 70011719])
-------Step 6-------
tensor([ 1392197,  1392223,  1392253,   526442,  1392272,  1392305,  1392333,
        17337344,  1392352,  4335496]) tensor([18242254, 37891477,  6625049,  1159510, 20374102, 19650865,  2744261,
         1926125, 69555534, 18814650])
-------Step 7-------
tensor([ 1392197,  1392223,  1392253,   526442,  1392272,  1392305,  1392333,
        17337344,  1392352,  4335496]) tensor([56668378, 76504064, 56866431,  2016777,  8531401, 45884344, 59003945,
        83597749, 75107327,  9545589])
-------Step 8-------
tensor([1467126, 1467151, 1467171,  529723, 1467198, 1467220, 1467244,  303233,
        1467270, 1467299]) tensor([68902956, 69657532,   358219,  4362833, 52177788, 33848983, 61053831,
        80017821, 36595895, 28632661])
-------Step 9-------
tensor([1467126, 1467151, 1467171,  529723, 1467198, 1467220, 1467244,  303233,
        1467270, 1467299]) tensor([  473221, 45798956, 21354825, 55539590, 29296981,  1523993, 23462666,
        44113565, 33211000, 78596141])
before start barrier
start train
[proc 0] 100 steps, total: 15.066, sample: 2.247, forward: 0.896, backward: 9.404, update: 2.453
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.145 ms                  | 258.410 ms                |
| Forward                   | 4.764 ms                  | 6.627 ms                  |
| back: bucket keys         | 249.968 us                | 481.369 us                |
| back: a2a                 | 4.630 ms                  | 32.488 ms                 |
| back: cache               | 7.714 ms                  | 16.920 ms                 |
| back: aggr dram keys      | 18.806 ms                 | 49.135 ms                 |
| back: set dram grad       | 4.051 ms                  | 10.874 ms                 |
| Backward                  | 82.870 ms                 | 134.316 ms                |
| Optimize                  | 23.222 ms                 | 49.871 ms                 |
| BarrierTimeBeforeRank0    | 38.285 us                 | 92.825 us                 |
| BlockToStepN              | 11.614 us                 | 94.760 us                 |
| OneStep                   | 116.987 ms                | 401.796 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.470 ms                  | 246.519 ms                |
| Forward                   | 4.759 ms                  | 6.118 ms                  |
| back: bucket keys         | 248.363 us                | 583.387 us                |
| back: a2a                 | 4.602 ms                  | 33.545 ms                 |
| back: cache               | 7.714 ms                  | 17.094 ms                 |
| back: aggr dram keys      | 19.287 ms                 | 49.135 ms                 |
| back: set dram grad       | 4.053 ms                  | 10.874 ms                 |
| Backward                  | 82.532 ms                 | 122.539 ms                |
| Optimize                  | 23.329 ms                 | 49.871 ms                 |
| BarrierTimeBeforeRank0    | 38.457 us                 | 78.900 us                 |
| BlockToStepN              | 11.573 us                 | 50.963 us                 |
| OneStep                   | 117.266 ms                | 362.494 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 13.161, sample: 1.378, forward: 0.381, backward: 7.167, update: 0.408
[proc 0] 200 steps, total: 13.161, sample: 1.967, forward: 0.468, backward: 8.249, update: 2.412
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.319 ms                  | 246.519 ms                |
| Forward                   | 4.742 ms                  | 6.118 ms                  |
| back: bucket keys         | 249.968 us                | 483.385 us                |
| back: a2a                 | 4.583 ms                  | 32.488 ms                 |
| back: cache               | 7.714 ms                  | 17.094 ms                 |
| back: aggr dram keys      | 18.948 ms                 | 49.125 ms                 |
| back: set dram grad       | 2.445 ms                  | 9.381 ms                  |
| Backward                  | 81.236 ms                 | 122.539 ms                |
| Optimize                  | 23.184 ms                 | 49.871 ms                 |
| BarrierTimeBeforeRank0    | 37.814 us                 | 92.825 us                 |
| BlockToStepN              | 11.614 us                 | 50.963 us                 |
| OneStep                   | 116.465 ms                | 362.494 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.413 ms                  | 246.519 ms                |
| Forward                   | 4.722 ms                  | 6.118 ms                  |
| back: bucket keys         | 249.968 us                | 481.369 us                |
| back: a2a                 | 4.574 ms                  | 31.022 ms                 |
| back: cache               | 7.714 ms                  | 16.920 ms                 |
| back: aggr dram keys      | 18.806 ms                 | 46.901 ms                 |
| back: set dram grad       | 4.012 ms                  | 9.198 ms                  |
| Backward                  | 81.236 ms                 | 122.539 ms                |
| Optimize                  | 22.938 ms                 | 49.871 ms                 |
| BarrierTimeBeforeRank0    | 37.623 us                 | 96.051 us                 |
| BlockToStepN              | 11.378 us                 | 50.963 us                 |
| OneStep                   | 116.481 ms                | 362.494 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.470 ms                  | 232.833 ms                |
| Forward                   | 4.712 ms                  | 6.118 ms                  |
| back: bucket keys         | 248.363 us                | 481.369 us                |
| back: a2a                 | 4.565 ms                  | 28.678 ms                 |
| back: cache               | 7.714 ms                  | 16.813 ms                 |
| back: aggr dram keys      | 18.634 ms                 | 46.565 ms                 |
| back: set dram grad       | 3.634 ms                  | 7.954 ms                  |
| Backward                  | 80.111 ms                 | 117.663 ms                |
| Optimize                  | 22.582 ms                 | 48.831 ms                 |
| BarrierTimeBeforeRank0    | 37.600 us                 | 92.825 us                 |
| BlockToStepN              | 11.457 us                 | 30.597 us                 |
| OneStep                   | 115.463 ms                | 355.940 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 12.166, sample: 1.166, forward: 0.384, backward: 6.853, update: 0.369
[proc 0] 300 steps, total: 12.166, sample: 1.726, forward: 0.459, backward: 7.670, update: 2.249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.633 ms                  | 232.833 ms                |
| Forward                   | 4.707 ms                  | 6.118 ms                  |
| back: bucket keys         | 255.701 us                | 478.993 us                |
| back: a2a                 | 4.558 ms                  | 28.678 ms                 |
| back: cache               | 7.714 ms                  | 17.094 ms                 |
| back: aggr dram keys      | 18.576 ms                 | 46.565 ms                 |
| back: set dram grad       | 2.414 ms                  | 7.839 ms                  |
| Backward                  | 79.946 ms                 | 117.663 ms                |
| Optimize                  | 22.525 ms                 | 48.831 ms                 |
| BarrierTimeBeforeRank0    | 37.599 us                 | 92.825 us                 |
| BlockToStepN              | 11.457 us                 | 30.597 us                 |
| OneStep                   | 114.490 ms                | 355.940 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.848 ms                  | 215.359 ms                |
| Forward                   | 4.703 ms                  | 6.118 ms                  |
| back: bucket keys         | 255.701 us                | 478.993 us                |
| back: a2a                 | 4.556 ms                  | 31.456 ms                 |
| back: cache               | 7.714 ms                  | 17.712 ms                 |
| back: aggr dram keys      | 18.634 ms                 | 46.901 ms                 |
| back: set dram grad       | 3.922 ms                  | 7.839 ms                  |
| Backward                  | 79.946 ms                 | 116.196 ms                |
| Optimize                  | 22.546 ms                 | 48.831 ms                 |
| BarrierTimeBeforeRank0    | 37.592 us                 | 78.900 us                 |
| BlockToStepN              | 11.573 us                 | 33.891 us                 |
| OneStep                   | 114.686 ms                | 323.732 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 12.460, sample: 1.112, forward: 0.384, backward: 7.047, update: 0.392
[proc 0] 400 steps, total: 12.460, sample: 1.613, forward: 0.470, backward: 7.984, update: 2.320
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.042 ms                  | 215.359 ms                |
| Forward                   | 4.697 ms                  | 6.627 ms                  |
| back: bucket keys         | 253.846 us                | 481.369 us                |
| back: a2a                 | 4.550 ms                  | 31.022 ms                 |
| back: cache               | 7.714 ms                  | 17.712 ms                 |
| back: aggr dram keys      | 18.554 ms                 | 46.901 ms                 |
| back: set dram grad       | 2.609 ms                  | 7.814 ms                  |
| Backward                  | 79.581 ms                 | 116.196 ms                |
| Optimize                  | 22.466 ms                 | 48.831 ms                 |
| BarrierTimeBeforeRank0    | 37.458 us                 | 92.825 us                 |
| BlockToStepN              | 11.678 us                 | 50.963 us                 |
| OneStep                   | 114.469 ms                | 323.732 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.145 ms                  | 215.359 ms                |
| Forward                   | 4.676 ms                  | 6.627 ms                  |
| back: bucket keys         | 235.291 us                | 481.369 us                |
| back: a2a                 | 4.548 ms                  | 28.678 ms                 |
| back: cache               | 7.714 ms                  | 17.094 ms                 |
| back: aggr dram keys      | 18.554 ms                 | 46.565 ms                 |
| back: set dram grad       | 2.520 ms                  | 7.798 ms                  |
| Backward                  | 79.040 ms                 | 116.196 ms                |
| Optimize                  | 22.278 ms                 | 48.831 ms                 |
| BarrierTimeBeforeRank0    | 37.273 us                 | 92.825 us                 |
| BlockToStepN              | 11.708 us                 | 94.760 us                 |
| OneStep                   | 114.095 ms                | 323.732 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.241 ms                  | 214.700 ms                |
| Forward                   | 4.673 ms                  | 6.627 ms                  |
| back: bucket keys         | 253.846 us                | 481.369 us                |
| back: a2a                 | 4.545 ms                  | 27.919 ms                 |
| back: cache               | 7.714 ms                  | 18.349 ms                 |
| back: aggr dram keys      | 18.363 ms                 | 45.891 ms                 |
| back: set dram grad       | 3.870 ms                  | 7.839 ms                  |
| Backward                  | 79.149 ms                 | 115.194 ms                |
| Optimize                  | 22.209 ms                 | 48.831 ms                 |
| BarrierTimeBeforeRank0    | 37.197 us                 | 91.511 us                 |
| BlockToStepN              | 11.678 us                 | 94.760 us                 |
| OneStep                   | 114.123 ms                | 316.222 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 12.196, sample: 1.430, forward: 0.488, backward: 7.871, update: 2.309
[proc 1] 500 steps, total: 12.196, sample: 0.952, forward: 0.383, backward: 6.792, update: 0.350
Successfully xmh. training takes 65.04967904090881 seconds
before call kg_cache_controller.StopThreads()
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
INFO [50037 controller_process.py:421] call rank0 to StopThreads
