WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240213 07:34:04.609943 24638 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_76', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=1, update_pq_use_omp=2, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [24638 sampler.py:454] Start PreSampling
WARNING [24638 sampler.py:532] Before construct renumbering_dict
WARNING [24638 sampler.py:555] PreSampling done
W20240213 07:54:07.918548 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240213 07:54:07.918773 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240213 07:54:07.918815 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240213 07:54:07.918855 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240213 07:54:07.918884 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240213 07:54:07.918910 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240213 07:54:07.918956 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240213 07:54:07.918995 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240213 07:54:07.919025 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240213 07:54:07.919051 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240213 07:54:07.919086 24638 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240213 07:54:07.919113 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240213 07:54:07.919142 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240213 07:54:07.919306 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240213 07:54:07.919337 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240213 07:54:07.919363 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240213 07:54:07.919399 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240213 07:54:07.919435 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240213 07:54:07.919466 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240213 07:54:07.919495 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240213 07:54:07.919524 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240213 07:54:07.919556 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240213 07:54:07.919590 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240213 07:54:07.919617 24638 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240213 07:54:07.919641 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240213 07:54:07.919662 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240213 07:54:07.919725 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240213 07:54:07.919764 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240213 07:54:07.919791 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240213 07:54:07.919826 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240213 07:54:07.919853 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240213 07:54:07.919885 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240213 07:54:07.919916 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240213 07:54:07.919945 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240213 07:54:07.919975 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240213 07:54:07.920017 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240213 07:54:07.920058 24638 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240213 07:54:07.920081 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240213 07:54:07.920104 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240213 07:54:07.920158 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240213 07:54:07.920190 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240213 07:54:07.920218 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240213 07:54:07.920244 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240213 07:54:07.920279 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240213 07:54:07.920312 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240213 07:54:07.920341 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240213 07:54:07.920387 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240213 07:54:07.920413 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240213 07:54:07.920442 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240213 07:54:07.920472 24638 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240213 07:54:07.920495 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240213 07:54:07.920528 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240213 07:54:07.920590 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240213 07:54:07.920625 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240213 07:54:07.920652 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240213 07:54:07.920679 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240213 07:54:07.920712 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240213 07:54:07.920747 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240213 07:54:07.920779 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240213 07:54:07.920819 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240213 07:54:07.920847 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240213 07:54:07.920879 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240213 07:54:07.920915 24638 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240213 07:54:07.920938 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240213 07:54:07.920960 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240213 07:54:07.921011 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240213 07:54:07.921041 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240213 07:54:07.921067 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240213 07:54:07.921093 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240213 07:54:07.921128 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240213 07:54:07.921155 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240213 07:54:07.921182 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240213 07:54:07.921216 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240213 07:54:07.921247 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240213 07:54:07.921280 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240213 07:54:07.921306 24638 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240213 07:54:07.921329 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240213 07:54:07.921358 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240213 07:54:07.921406 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240213 07:54:07.921440 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240213 07:54:07.921468 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240213 07:54:07.921495 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240213 07:54:07.921528 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240213 07:54:07.921562 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240213 07:54:07.921590 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240213 07:54:07.921620 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240213 07:54:07.921651 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240213 07:54:07.921687 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240213 07:54:07.921715 24638 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240213 07:54:07.921737 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240213 07:54:07.921765 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240213 07:54:07.921823 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240213 07:54:07.921859 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240213 07:54:07.921890 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240213 07:54:07.921921 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240213 07:54:07.921957 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240213 07:54:07.921989 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240213 07:54:07.922049 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240213 07:54:07.922080 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240213 07:54:07.922114 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240213 07:54:07.922148 24638 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240213 07:54:07.922178 24638 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240213 07:54:07.922201 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240213 07:54:07.922230 24638 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240213 07:54:08.395576 24638 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240213 08:02:46.940346 24638 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302728,  4302753,    81387,  ..., 62529989, 57224404,  5021207]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2226.610 seconds
[Rank1] pid = 25755
[Rank2] pid = 25849
[Rank3] pid = 25916
[Rank4] pid = 25985
[Rank5] pid = 26053
[Rank6] pid = 26126
INFO [24638 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [25755 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [25849 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [25916 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [25985 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [26053 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [26126 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [26196 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [26126 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26196 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25985 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24638 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [26053 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25849 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25916 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [25755 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240213 08:11:23.668463 26127 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240213 08:11:23.670987 26197 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240213 08:11:23.671723 26054 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240213 08:11:23.671949 25850 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240213 08:11:23.671962 25756 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240213 08:11:23.671974 25986 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240213 08:11:23.672124 26260 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240213 08:11:23.672232 25917 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240213 08:11:23.749902 25986 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1020497a9000 7.629 MB
W20240213 08:11:23.750092 26054 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102049f50000 7.629 MB
W20240213 08:11:23.750106 26127 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204a6f3000 7.629 MB
W20240213 08:11:23.750120 26197 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204ae96000 7.629 MB
W20240213 08:11:23.750133 25850 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204b639000 7.629 MB
W20240213 08:11:23.750157 25986 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204bddc000 7.629 MB
W20240213 08:11:23.750267 25986 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10204c57f000 1.49 GB
W20240213 08:11:23.750294 25756 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1020abb62000 7.629 MB
W20240213 08:11:23.750324 25986 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1020ac305000 1.49 GB
W20240213 08:11:23.750380 25986 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240213 08:11:23.750597 26260 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10210b8ea000 7.629 MB
W20240213 08:11:23.752066 26127 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10210c08f000 7.629 MB
W20240213 08:11:23.752095 26260 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10210c832000 7.629 MB
W20240213 08:11:23.752138 25756 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210cfd5000 7.629 MB
W20240213 08:11:23.752223 26197 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210d778000 7.629 MB
W20240213 08:11:23.752242 25917 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10210df1b000 7.629 MB
W20240213 08:11:23.752274 25756 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10210e6c0000 1.49 GB
W20240213 08:11:23.752282 26054 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10216dca3000 7.629 MB
W20240213 08:11:23.752321 25850 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10216e446000 7.629 MB
W20240213 08:11:23.752342 26197 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10216ebe9000 1.49 GB
W20240213 08:11:23.752372 25986 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240213 08:11:23.752394 26197 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1021ce1cc000 1.49 GB
W20240213 08:11:23.752415 25917 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10222d7af000 7.629 MB
W20240213 08:11:23.752425 25756 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10222df52000 1.49 GB
W20240213 08:11:23.752465 25850 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10228d535000 1.49 GB
W20240213 08:11:23.752478 26197 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240213 08:11:23.752514 26260 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1022ecb18000 1.49 GB
W20240213 08:11:23.752532 25756 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240213 08:11:23.752552 25850 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10234c0fb000 1.49 GB
W20240213 08:11:23.752562 25917 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1023ab6de000 1.49 GB
W20240213 08:11:23.752569 26054 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10240acc1000 1.49 GB
W20240213 08:11:23.752606 26127 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10246a2a4000 1.49 GB
W20240213 08:11:23.752636 26260 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1024c9887000 1.49 GB
W20240213 08:11:23.752642 26054 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x102528e6a000 1.49 GB
W20240213 08:11:23.752652 25850 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240213 08:11:23.752673 25917 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10258844d000 1.49 GB
W20240213 08:11:23.752708 26127 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1025e7a30000 1.49 GB
W20240213 08:11:23.752732 26260 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240213 08:11:23.752755 26127 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240213 08:11:23.755582 26054 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240213 08:11:23.755597 25917 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240213 08:11:23.766505 26197 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240213 08:11:23.766664 25850 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240213 08:11:23.766674 26260 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240213 08:11:23.766674 25756 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240213 08:11:23.766676 26054 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240213 08:11:23.766685 26127 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240213 08:11:23.768206 25917 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [26053 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [25916 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [25849 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 26196
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [24638 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [25755 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [25985 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [26126 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [26196 DistTensor.py:59] The tensor name already exists in the kvstore
I20240213 08:12:13.999320 26260 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240213 08:12:13.999392 26127 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 08:12:13.999420 25756 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 08:12:13.999466 25917 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 08:12:13.999557 25986 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 08:12:13.999595 26054 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 08:12:13.999699 25850 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 08:12:13.999764 26197 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240213 08:12:15.861869 26127 recstore.cc:66] init folly done
E20240213 08:12:15.861912 25756 recstore.cc:66] init folly done
E20240213 08:12:15.861922 26197 recstore.cc:66] init folly done
E20240213 08:12:15.861922 26054 recstore.cc:66] init folly done
E20240213 08:12:15.861918 25917 recstore.cc:66] init folly done
E20240213 08:12:15.862140 26260 recstore.cc:66] init folly done
E20240213 08:12:15.862145 25850 recstore.cc:66] init folly done
E20240213 08:12:15.862144 25986 recstore.cc:66] init folly done
I20240213 08:12:21.483330 26260 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240213 08:12:21.707999 26054 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 08:12:21.815654 25986 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 08:12:23.465260 25850 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 08:12:24.517773 25917 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 08:12:24.695873 26127 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 08:12:24.732203 25756 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 08:12:24.824231 26197 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 19.562 ms                 |
| Forward                   | 405.448 ms                | 405.448 ms                |
| back: bucket keys         | 21.770 ms                 | 21.770 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.562 ms                 | 41.915 ms                 |
| Forward                   | 6.987 ms                  | 405.448 ms                |
| back: bucket keys         | 678.062 us                | 21.770 ms                 |
| back: a2a                 | 29.012 ms                 | 51.578 s                  |
| back: cache               | 16.249 ms                 | 156.542 ms                |
| back: aggr dram keys      | 158.257 ms                | 1.103 s                   |
| back: set dram grad       | 17.163 ms                 | 30.326 ms                 |
| Backward                  | 53.391 s                  | 53.391 s                  |
| Optimize                  | 170.916 ms                | 170.916 ms                |
| BarrierTimeBeforeRank0    | 69.718 us                 | 69.718 us                 |
| BlockToStepN              | 3.847 ms                  | 3.847 ms                  |
| OneStep                   | 53.993 s                  | 53.993 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 20.736 ms                 | 429.097 ms                |
| Forward                   | 5.126 ms                  | 405.448 ms                |
| back: bucket keys         | 678.062 us                | 21.770 ms                 |
| back: a2a                 | 23.072 ms                 | 51.578 s                  |
| back: cache               | 16.249 ms                 | 201.924 ms                |
| back: aggr dram keys      | 101.184 ms                | 1.103 s                   |
| back: set dram grad       | 28.191 ms                 | 75.847 ms                 |
| Backward                  | 437.196 ms                | 53.391 s                  |
| Optimize                  | 109.465 ms                | 170.916 ms                |
| BarrierTimeBeforeRank0    | 59.971 us                 | 96.635 us                 |
| BlockToStepN              | 58.505 us                 | 19.554 ms                 |
| OneStep                   | 692.664 ms                | 53.993 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 16.326 ms                 | 429.097 ms                |
| Forward                   | 4.789 ms                  | 405.448 ms                |
| back: bucket keys         | 678.062 us                | 21.770 ms                 |
| back: a2a                 | 23.067 ms                 | 51.578 s                  |
| back: cache               | 16.249 ms                 | 201.924 ms                |
| back: aggr dram keys      | 93.549 ms                 | 1.103 s                   |
| back: set dram grad       | 28.191 ms                 | 75.847 ms                 |
| Backward                  | 388.882 ms                | 53.391 s                  |
| Optimize                  | 110.090 ms                | 170.916 ms                |
| BarrierTimeBeforeRank0    | 50.201 us                 | 96.635 us                 |
| BlockToStepN              | 57.624 us                 | 19.554 ms                 |
| OneStep                   | 539.571 ms                | 53.993 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.211 ms                 | 429.097 ms                |
| Forward                   | 4.833 ms                  | 405.448 ms                |
| back: bucket keys         | 678.062 us                | 1.672 ms                  |
| back: a2a                 | 21.630 ms                 | 245.901 ms                |
| back: cache               | 16.249 ms                 | 157.074 ms                |
| back: aggr dram keys      | 93.269 ms                 | 158.257 ms                |
| back: set dram grad       | 28.191 ms                 | 30.568 ms                 |
| Backward                  | 360.818 ms                | 53.391 s                  |
| Optimize                  | 108.691 ms                | 170.916 ms                |
| BarrierTimeBeforeRank0    | 46.285 us                 | 96.635 us                 |
| BlockToStepN              | 55.945 us                 | 19.554 ms                 |
| OneStep                   | 499.182 ms                | 53.993 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.735 ms                 | 429.097 ms                |
| Forward                   | 4.921 ms                  | 405.448 ms                |
| back: bucket keys         | 678.062 us                | 1.691 ms                  |
| back: a2a                 | 21.402 ms                 | 245.901 ms                |
| back: cache               | 16.249 ms                 | 157.074 ms                |
| back: aggr dram keys      | 93.269 ms                 | 158.257 ms                |
| back: set dram grad       | 28.191 ms                 | 30.749 ms                 |
| Backward                  | 360.818 ms                | 53.391 s                  |
| Optimize                  | 108.691 ms                | 170.916 ms                |
| BarrierTimeBeforeRank0    | 44.874 us                 | 96.635 us                 |
| BlockToStepN              | 54.450 us                 | 19.554 ms                 |
| OneStep                   | 491.820 ms                | 53.993 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.199 ms                  | 429.097 ms                |
| Forward                   | 4.944 ms                  | 405.448 ms                |
| back: bucket keys         | 689.983 us                | 1.703 ms                  |
| back: a2a                 | 20.953 ms                 | 245.901 ms                |
| back: cache               | 16.249 ms                 | 157.074 ms                |
| back: aggr dram keys      | 93.269 ms                 | 158.257 ms                |
| back: set dram grad       | 28.191 ms                 | 47.841 ms                 |
| Backward                  | 360.762 ms                | 53.391 s                  |
| Optimize                  | 108.215 ms                | 170.916 ms                |
| BarrierTimeBeforeRank0    | 43.315 us                 | 96.635 us                 |
| BlockToStepN              | 54.674 us                 | 19.554 ms                 |
| OneStep                   | 486.774 ms                | 53.993 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.810 ms                  | 328.997 ms                |
| Forward                   | 5.038 ms                  | 6.987 ms                  |
| back: bucket keys         | 689.983 us                | 1.703 ms                  |
| back: a2a                 | 20.813 ms                 | 245.901 ms                |
| back: cache               | 16.249 ms                 | 157.074 ms                |
| back: aggr dram keys      | 93.269 ms                 | 158.257 ms                |
| back: set dram grad       | 28.191 ms                 | 47.841 ms                 |
| Backward                  | 362.201 ms                | 575.911 ms                |
| Optimize                  | 108.987 ms                | 151.042 ms                |
| BarrierTimeBeforeRank0    | 39.617 us                 | 96.635 us                 |
| BlockToStepN              | 54.916 us                 | 19.554 ms                 |
| OneStep                   | 499.182 ms                | 913.209 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.829 ms                  | 328.997 ms                |
| Forward                   | 5.063 ms                  | 6.987 ms                  |
| back: bucket keys         | 678.062 us                | 1.703 ms                  |
| back: a2a                 | 20.457 ms                 | 245.901 ms                |
| back: cache               | 16.249 ms                 | 157.074 ms                |
| back: aggr dram keys      | 93.269 ms                 | 158.257 ms                |
| back: set dram grad       | 28.191 ms                 | 47.841 ms                 |
| Backward                  | 363.291 ms                | 575.911 ms                |
| Optimize                  | 110.232 ms                | 151.042 ms                |
| BarrierTimeBeforeRank0    | 43.075 us                 | 96.635 us                 |
| BlockToStepN              | 54.674 us                 | 19.554 ms                 |
| OneStep                   | 496.733 ms                | 913.209 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
-------Step 0-------
tensor([   54124,    54151,    54184,    54220,  5934042,   130666, 55042015,
        19447981, 18483430,    54256]) tensor([ 5253796, 17072322, 58576885, 71000746, 23023660, 34366820, 39054781,
        74362072, 66046797, 26904969])
-------Step 1-------
tensor([   54124,    54151,    54184,    54220,  5934042,   130666, 55042015,
        19447981, 18483430,    54256]) tensor([65081154, 25674828, 12317009, 75502644, 83902431, 42179098, 75162249,
        48267144, 35540599, 14235746])
-------Step 2-------
tensor([  139172,   139204,   139237,    23845,   139278,   139311,   139348,
        22328212,   139391,   139422]) tensor([66879370, 26143007, 84531955, 48861737, 43582349, 25671074, 65369795,
        37897948, 12688884, 41432577])
-------Step 3-------
tensor([  139172,   139204,   139237,    23845,   139278,   139311,   139348,
        22328212,   139391,   139422]) tensor([48643163, 80415487, 36222565, 40245516, 65659589, 62444024, 34885440,
        17926673, 23848666,   697827])
-------Step 4-------
tensor([  242039, 43318529,   242067,   165208,   242102,   165242,   242135,
        41688358,   242167,   242198]) tensor([77290551, 10557400, 85876020, 20962355, 73033031, 41287172, 67348319,
        39612610, 78424912, 50854372])
-------Step 5-------
tensor([  242039, 43318529,   242067,   165208,   242102,   165242,   242135,
        41688358,   242167,   242198]) tensor([31936992, 74680010,   291489, 80270314, 57790231, 55120022, 13239285,
         8699047, 68404587, 39080227])
-------Step 6-------
tensor([  326537,    49875,   326581,   326624,    49898, 77430054,   326661,
          326698,   182214, 38656036]) tensor([15208137, 39138179, 34256664, 77901954, 30278092, 39109315, 21475311,
         6312209, 63565123, 76682055])
-------Step 7-------
tensor([  326537,    49875,   326581,   326624,    49898, 77430054,   326661,
          326698,   182214, 38656036]) tensor([26875380, 51092848, 66416113, 62460355, 83311184, 45520534, 52916948,
        56644728, 36934750, 29994965])
-------Step 8-------
tensor([  409285, 27362866,   409321,   198339,   409357,    62426,   409391,
          409440,   409472,   409517]) tensor([43272600, 26853902, 31876401,  1977271, 48714478, 67426435, 16488052,
        74123451,  1492295, 64744147])
-------Step 9-------
tensor([  409285, 27362866,   409321,   198339,   409357,    62426,   409391,
          409440,   409472,   409517]) tensor([53014631, 38292916, 12320745, 59336082,  8217892, 40212162, 27585214,
        36999193, 79716510, 68926296])
before start barrier
start train
Successfully xmh. training takes 90.09802770614624 seconds
before call kg_cache_controller.StopThreads()
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
INFO [24638 controller_process.py:421] call rank0 to StopThreads
