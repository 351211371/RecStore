WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240207 13:12:32.365835  1986 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_41', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [1986 sampler.py:454] Start PreSampling
WARNING [1986 sampler.py:532] Before construct renumbering_dict
WARNING [1986 sampler.py:555] PreSampling done
W20240207 13:31:25.826951  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240207 13:31:25.827134  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240207 13:31:25.827178  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240207 13:31:25.827220  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240207 13:31:25.827258  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240207 13:31:25.827294  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240207 13:31:25.827334  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240207 13:31:25.827365  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240207 13:31:25.827401  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240207 13:31:25.827431  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240207 13:31:25.827469  1986 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240207 13:31:25.827498  1986 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240207 13:31:25.827524  1986 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240207 13:31:25.827682  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240207 13:31:25.827721  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240207 13:31:25.827759  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240207 13:31:25.827806  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240207 13:31:25.827837  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240207 13:31:25.827876  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240207 13:31:25.827908  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240207 13:31:25.827939  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240207 13:31:25.827976  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240207 13:31:25.828008  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240207 13:31:25.828038  1986 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240207 13:31:25.828069  1986 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240207 13:31:25.828102  1986 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240207 13:31:25.828166  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240207 13:31:25.828200  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240207 13:31:25.828236  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240207 13:31:25.828265  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240207 13:31:25.828297  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240207 13:31:25.828332  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240207 13:31:25.828366  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240207 13:31:25.828397  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240207 13:31:25.828431  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240207 13:31:25.828464  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240207 13:31:25.828500  1986 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240207 13:31:25.828523  1986 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240207 13:31:25.828548  1986 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240207 13:31:25.828606  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240207 13:31:25.828641  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240207 13:31:25.828675  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240207 13:31:25.828709  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240207 13:31:25.828749  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240207 13:31:25.828786  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240207 13:31:25.828825  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240207 13:31:25.828855  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240207 13:31:25.828883  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240207 13:31:25.828917  1986 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240207 13:31:25.828948  1986 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240207 13:31:25.828971  1986 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240207 13:31:25.829001  1986 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240207 13:31:26.245434  1986 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240207 13:39:59.088012  1986 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4302721,  4302764,    97778,  ..., 67953586, 14939523,  2504534]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2152.373 seconds
[Rank1] pid = 3136
[Rank2] pid = 3231
INFO [1986 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3136 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3298 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [3231 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1986 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [3231 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [3298 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [3136 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [1986 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [3298 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [3136 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [3231 DistTensor.py:59] The tensor name already exists in the kvstore
I20240207 13:48:40.160638  3232 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240207 13:48:40.160823  3137 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240207 13:48:40.160972  3299 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240207 13:48:40.161156  3362 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240207 13:48:40.605369  3232 recstore.cc:66] init folly done
E20240207 13:48:40.606122  3362 recstore.cc:66] init folly done
E20240207 13:48:40.606472  3137 recstore.cc:66] init folly done
E20240207 13:48:40.606475  3299 recstore.cc:66] init folly done
I20240207 13:48:51.290632  3362 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240207 13:48:54.665062  3137 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240207 13:48:55.244814  3232 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240207 13:48:55.901275  3299 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.017 ms                 | 293.144 ms                |
| bucket keys               | 2.078 ms                  | 159.379 ms                |
| forward: a2a keys         | 2.193 ms                  | 854.470 ms                |
| forward: search cache     | 223.791 us                | 21.523 ms                 |
| forward: a2a values       | 2.992 ms                  | 21.965 ms                 |
| forward: join             | 1.885 ms                  | 2.924 ms                  |
| Forward                   | 32.946 ms                 | 1.368 s                   |
| back: aggr dram keys      | 28.471 ms                 | 414.120 ms                |
| back: set dram grad       | 3.508 ms                  | 9.931 ms                  |
| back: a2a grad            | 5.403 ms                  | 23.366 ms                 |
| back: grad sum & grad cache  | 2.437 ms                  | 48.936 ms                 |
| Backward                  | 120.251 ms                | 637.756 ms                |
| Optimize                  | 21.571 ms                 | 57.210 ms                 |
| BarrierTimeBeforeRank0    | 51.167 us                 | 86.170 us                 |
| BlockToStepN              | 14.659 us                 | 39.457 us                 |
| OneStep                   | 206.589 ms                | 2.085 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.037 ms                  | 295.592 ms                |
| bucket keys               | 2.681 ms                  | 3.797 ms                  |
| forward: a2a keys         | 2.047 ms                  | 88.788 ms                 |
| forward: search cache     | 223.534 us                | 383.601 us                |
| forward: a2a values       | 9.343 ms                  | 30.084 ms                 |
| forward: join             | 1.885 ms                  | 3.011 ms                  |
| Forward                   | 33.212 ms                 | 1.368 s                   |
| back: aggr dram keys      | 31.173 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.509 ms                  | 8.820 ms                  |
| back: a2a grad            | 11.030 ms                 | 23.366 ms                 |
| back: grad sum & grad cache  | 2.437 ms                  | 48.350 ms                 |
| Backward                  | 120.836 ms                | 637.756 ms                |
| Optimize                  | 21.571 ms                 | 57.210 ms                 |
| BarrierTimeBeforeRank0    | 43.514 us                 | 112.254 us                |
| BlockToStepN              | 16.453 us                 | 39.457 us                 |
| OneStep                   | 189.687 ms                | 2.085 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.233 ms                  | 293.144 ms                |
| bucket keys               | 2.682 ms                  | 5.202 ms                  |
| forward: a2a keys         | 2.193 ms                  | 115.038 ms                |
| forward: search cache     | 224.302 us                | 405.266 us                |
| forward: a2a values       | 2.992 ms                  | 30.084 ms                 |
| forward: join             | 1.885 ms                  | 3.011 ms                  |
| Forward                   | 33.941 ms                 | 147.231 ms                |
| back: aggr dram keys      | 39.883 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.512 ms                  | 8.820 ms                  |
| back: a2a grad            | 11.231 ms                 | 24.377 ms                 |
| back: grad sum & grad cache  | 2.437 ms                  | 48.350 ms                 |
| Backward                  | 121.208 ms                | 150.400 ms                |
| Optimize                  | 21.170 ms                 | 47.048 ms                 |
| BarrierTimeBeforeRank0    | 41.893 us                 | 100.518 us                |
| BlockToStepN              | 17.166 us                 | 22.339 ms                 |
| OneStep                   | 191.784 ms                | 562.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.947 ms                  | 293.144 ms                |
| bucket keys               | 2.681 ms                  | 3.932 ms                  |
| forward: a2a keys         | 2.226 ms                  | 115.038 ms                |
| forward: search cache     | 223.390 us                | 383.601 us                |
| forward: a2a values       | 2.992 ms                  | 21.965 ms                 |
| forward: join             | 1.885 ms                  | 3.299 ms                  |
| Forward                   | 34.039 ms                 | 195.925 ms                |
| back: aggr dram keys      | 41.533 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.509 ms                  | 8.141 ms                  |
| back: a2a grad            | 11.077 ms                 | 24.377 ms                 |
| back: grad sum & grad cache  | 2.478 ms                  | 42.511 ms                 |
| Backward                  | 121.660 ms                | 155.584 ms                |
| Optimize                  | 21.170 ms                 | 47.048 ms                 |
| BarrierTimeBeforeRank0    | 41.723 us                 | 100.518 us                |
| BlockToStepN              | 17.171 us                 | 22.339 ms                 |
| OneStep                   | 191.818 ms                | 562.093 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 23.942, sample: 1.279, forward: 7.416, backward: 9.532, update: 0.440
[Rank3] pid = 3298
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
train_sampler.Prefill()
-------Step 0-------
tensor([   43975,   698892, 40613711,   979365,   412849,   698921,   698946,
          197768,    44001,    44026]) tensor([ 4926714, 24107663, 25837934, 51493679, 53189476, 30390113, 82305763,
        82904647, 53292651, 79543347])
-------Step 1-------
tensor([   43975,   698892, 40613711,   979365,   412849,   698921,   698946,
          197768,    44001,    44026]) tensor([32466674, 71907403, 77587710,  9500188, 56024393,  8841956, 81965193,
        81772616, 19551297, 35203021])
-------Step 2-------
tensor([  802771,    53916, 69956198,    53935,   802807,   802844,   802874,
        45797750,   802899,   802944]) tensor([39292993,  4829344, 58761285, 10166580, 13554383, 10922014, 58711478,
         8671104, 57343651, 28727245])
-------Step 3-------
tensor([  802771,    53916, 69956198,    53935,   802807,   802844,   802874,
        45797750,   802899,   802944]) tensor([16214753, 47161316, 72228882, 33162160, 15053002, 66030745, 69504550,
        70713809, 19699362, 72589118])
-------Step 4-------
tensor([905701,  63683, 905741, 905788,  63707, 905816,  63744, 905852,  63768,
        905890]) tensor([64280174, 42408090, 15972722, 15494356, 53422523, 39407736, 75605164,
        49345020, 54635059,  8293927])
-------Step 5-------
tensor([905701,  63683, 905741, 905788,  63707, 905816,  63744, 905852,  63768,
        905890]) tensor([30929838, 40118951, 80418196,  8669750, 40282396, 34317299, 37764944,
        67848172, 80837660,   415633])
-------Step 6-------
tensor([77072512,   962309,   962325,   962343,  4308948,   962360,   962378,
          962398,   962415,   202710]) tensor([31047433, 44780925, 29010671, 22829181, 72376232, 54611929, 44618303,
        15413364, 64851999,  9016262])
-------Step 7-------
tensor([77072512,   962309,   962325,   962343,  4308948,   962360,   962378,
          962398,   962415,   202710]) tensor([41159079, 85733255, 50669965, 68118574, 66069708,  1676109, 16186623,
        53591284, 17781068, 17464803])
-------Step 8-------
tensor([ 1011453,    85221,  1011469, 29212277,  1005848,  1011486,  1011501,
         1011516,   204166,  1005865]) tensor([26647124, 55581660, 43587123, 85331513, 81863481, 64148768, 59321877,
        78838406,  9672287,  3239662])
-------Step 9-------
tensor([ 1011453,    85221,  1011469, 29212277,  1005848,  1011486,  1011501,
         1011516,   204166,  1005865]) tensor([70623022, 62784157, 21595201, 35604119, 13136303,  1070036, 23085471,
        12697231, 75734476, 42450339])
before start barrier
start train
[proc 0] 100 steps, total: 23.286, sample: 2.299, forward: 5.595, backward: 13.057, update: 2.176
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 24.522, sample: 2.722, forward: 5.874, backward: 9.986, update: 0.391
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.896, sample: 1.489, forward: 7.179, backward: 9.580, update: 0.332
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.233 ms                  | 293.144 ms                |
| bucket keys               | 2.682 ms                  | 3.932 ms                  |
| forward: a2a keys         | 2.431 ms                  | 121.678 ms                |
| forward: search cache     | 223.616 us                | 393.958 us                |
| forward: a2a values       | 2.992 ms                  | 21.965 ms                 |
| forward: join             | 1.885 ms                  | 3.299 ms                  |
| Forward                   | 34.039 ms                 | 195.925 ms                |
| back: aggr dram keys      | 41.533 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.528 ms                  | 8.430 ms                  |
| back: a2a grad            | 11.077 ms                 | 24.377 ms                 |
| back: grad sum & grad cache  | 2.589 ms                  | 42.660 ms                 |
| Backward                  | 121.716 ms                | 155.584 ms                |
| Optimize                  | 20.913 ms                 | 47.048 ms                 |
| BarrierTimeBeforeRank0    | 41.893 us                 | 100.518 us                |
| BlockToStepN              | 17.185 us                 | 22.339 ms                 |
| OneStep                   | 191.784 ms                | 562.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.650 ms                  | 293.144 ms                |
| bucket keys               | 2.682 ms                  | 4.371 ms                  |
| forward: a2a keys         | 2.314 ms                  | 115.038 ms                |
| forward: search cache     | 223.791 us                | 383.601 us                |
| forward: a2a values       | 9.333 ms                  | 16.686 ms                 |
| forward: join             | 1.885 ms                  | 3.146 ms                  |
| Forward                   | 33.982 ms                 | 195.925 ms                |
| back: aggr dram keys      | 41.533 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.527 ms                  | 8.266 ms                  |
| back: a2a grad            | 11.030 ms                 | 23.366 ms                 |
| back: grad sum & grad cache  | 2.589 ms                  | 42.511 ms                 |
| Backward                  | 121.087 ms                | 155.584 ms                |
| Optimize                  | 20.716 ms                 | 47.048 ms                 |
| BarrierTimeBeforeRank0    | 42.150 us                 | 100.518 us                |
| BlockToStepN              | 17.289 us                 | 22.339 ms                 |
| OneStep                   | 188.226 ms                | 562.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.003 ms                  | 258.800 ms                |
| bucket keys               | 2.686 ms                  | 4.371 ms                  |
| forward: a2a keys         | 2.257 ms                  | 115.038 ms                |
| forward: search cache     | 223.534 us                | 383.601 us                |
| forward: a2a values       | 2.992 ms                  | 21.965 ms                 |
| forward: join             | 1.885 ms                  | 3.146 ms                  |
| Forward                   | 33.780 ms                 | 154.682 ms                |
| back: aggr dram keys      | 41.533 ms                 | 72.557 ms                 |
| back: set dram grad       | 3.524 ms                  | 8.430 ms                  |
| back: a2a grad            | 11.030 ms                 | 23.763 ms                 |
| back: grad sum & grad cache  | 2.589 ms                  | 45.051 ms                 |
| Backward                  | 121.456 ms                | 163.572 ms                |
| Optimize                  | 20.595 ms                 | 36.207 ms                 |
| BarrierTimeBeforeRank0    | 41.524 us                 | 86.170 us                 |
| BlockToStepN              | 17.364 us                 | 12.698 ms                 |
| OneStep                   | 188.883 ms                | 540.108 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.003 ms                  | 258.800 ms                |
| bucket keys               | 2.682 ms                  | 4.371 ms                  |
| forward: a2a keys         | 2.264 ms                  | 103.005 ms                |
| forward: search cache     | 223.385 us                | 393.958 us                |
| forward: a2a values       | 7.564 ms                  | 16.686 ms                 |
| forward: join             | 1.885 ms                  | 3.146 ms                  |
| Forward                   | 33.640 ms                 | 154.682 ms                |
| back: aggr dram keys      | 41.543 ms                 | 69.969 ms                 |
| back: set dram grad       | 3.527 ms                  | 8.266 ms                  |
| back: a2a grad            | 11.030 ms                 | 23.763 ms                 |
| back: grad sum & grad cache  | 2.589 ms                  | 45.051 ms                 |
| Backward                  | 121.178 ms                | 163.572 ms                |
| Optimize                  | 20.588 ms                 | 36.207 ms                 |
| BarrierTimeBeforeRank0    | 41.723 us                 | 86.170 us                 |
| BlockToStepN              | 17.289 us                 | 19.320 ms                 |
| OneStep                   | 188.226 ms                | 540.108 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 20.205, sample: 1.862, forward: 4.383, backward: 9.447, update: 0.346
[proc 2] 200 steps, total: 20.205, sample: 1.178, forward: 5.135, backward: 9.022, update: 0.432
[proc 3] 200 steps, total: 20.205, sample: 1.257, forward: 5.016, backward: 9.092, update: 0.420
[proc 0] 200 steps, total: 20.205, sample: 1.819, forward: 3.844, backward: 12.414, update: 2.009
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.356 ms                  | 258.800 ms                |
| bucket keys               | 2.682 ms                  | 4.371 ms                  |
| forward: a2a keys         | 2.232 ms                  | 103.005 ms                |
| forward: search cache     | 223.616 us                | 393.958 us                |
| forward: a2a values       | 7.564 ms                  | 16.686 ms                 |
| forward: join             | 1.885 ms                  | 3.165 ms                  |
| Forward                   | 33.606 ms                 | 154.682 ms                |
| back: aggr dram keys      | 41.533 ms                 | 69.969 ms                 |
| back: set dram grad       | 3.531 ms                  | 8.329 ms                  |
| back: a2a grad            | 11.019 ms                 | 23.763 ms                 |
| back: grad sum & grad cache  | 2.589 ms                  | 45.403 ms                 |
| Backward                  | 121.049 ms                | 163.572 ms                |
| Optimize                  | 20.574 ms                 | 36.207 ms                 |
| BarrierTimeBeforeRank0    | 41.222 us                 | 99.442 us                 |
| BlockToStepN              | 17.185 us                 | 19.320 ms                 |
| OneStep                   | 187.168 ms                | 540.108 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.374 ms                  | 258.800 ms                |
| bucket keys               | 2.682 ms                  | 4.211 ms                  |
| forward: a2a keys         | 2.149 ms                  | 88.788 ms                 |
| forward: search cache     | 223.464 us                | 383.601 us                |
| forward: a2a values       | 7.564 ms                  | 14.112 ms                 |
| forward: join             | 1.885 ms                  | 3.165 ms                  |
| Forward                   | 33.529 ms                 | 154.682 ms                |
| back: aggr dram keys      | 39.991 ms                 | 67.925 ms                 |
| back: set dram grad       | 3.532 ms                  | 8.266 ms                  |
| back: a2a grad            | 11.019 ms                 | 23.366 ms                 |
| back: grad sum & grad cache  | 2.589 ms                  | 45.403 ms                 |
| Backward                  | 120.827 ms                | 163.572 ms                |
| Optimize                  | 20.574 ms                 | 36.207 ms                 |
| BarrierTimeBeforeRank0    | 41.585 us                 | 99.442 us                 |
| BlockToStepN              | 17.171 us                 | 19.320 ms                 |
| OneStep                   | 186.326 ms                | 540.108 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.409 ms                  | 164.779 ms                |
| bucket keys               | 2.681 ms                  | 4.211 ms                  |
| forward: a2a keys         | 2.136 ms                  | 88.788 ms                 |
| forward: search cache     | 223.300 us                | 383.601 us                |
| forward: a2a values       | 7.564 ms                  | 14.112 ms                 |
| forward: join             | 1.885 ms                  | 3.165 ms                  |
| Forward                   | 33.421 ms                 | 147.231 ms                |
| back: aggr dram keys      | 39.883 ms                 | 67.925 ms                 |
| back: set dram grad       | 3.536 ms                  | 8.329 ms                  |
| back: a2a grad            | 11.019 ms                 | 24.377 ms                 |
| back: grad sum & grad cache  | 2.589 ms                  | 45.403 ms                 |
| Backward                  | 120.849 ms                | 161.358 ms                |
| Optimize                  | 20.577 ms                 | 39.203 ms                 |
| BarrierTimeBeforeRank0    | 41.222 us                 | 86.170 us                 |
| BlockToStepN              | 16.937 us                 | 19.320 ms                 |
| OneStep                   | 186.648 ms                | 534.942 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.722 ms                  | 164.779 ms                |
| bucket keys               | 2.682 ms                  | 4.211 ms                  |
| forward: a2a keys         | 2.092 ms                  | 73.636 ms                 |
| forward: search cache     | 223.360 us                | 336.388 us                |
| forward: a2a values       | 7.564 ms                  | 14.112 ms                 |
| forward: join             | 1.885 ms                  | 3.165 ms                  |
| Forward                   | 33.321 ms                 | 147.231 ms                |
| back: aggr dram keys      | 39.883 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.536 ms                  | 8.329 ms                  |
| back: a2a grad            | 11.037 ms                 | 25.312 ms                 |
| back: grad sum & grad cache  | 2.743 ms                  | 45.403 ms                 |
| Backward                  | 121.013 ms                | 161.358 ms                |
| Optimize                  | 20.415 ms                 | 39.203 ms                 |
| BarrierTimeBeforeRank0    | 41.093 us                 | 86.170 us                 |
| BlockToStepN              | 16.780 us                 | 21.333 ms                 |
| OneStep                   | 186.744 ms                | 534.942 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 19.746, sample: 1.771, forward: 3.452, backward: 12.358, update: 2.031
[proc 3] 300 steps, total: 19.746, sample: 0.979, forward: 4.836, backward: 9.075, update: 0.363
[proc 1] 300 steps, total: 19.746, sample: 1.467, forward: 4.274, backward: 9.457, update: 0.374
[proc 2] 300 steps, total: 19.746, sample: 1.034, forward: 4.738, backward: 9.091, update: 0.429
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.726 ms                  | 164.779 ms                |
| bucket keys               | 2.686 ms                  | 4.211 ms                  |
| forward: a2a keys         | 2.055 ms                  | 73.636 ms                 |
| forward: search cache     | 223.245 us                | 383.601 us                |
| forward: a2a values       | 7.564 ms                  | 14.112 ms                 |
| forward: join             | 1.885 ms                  | 3.204 ms                  |
| Forward                   | 33.212 ms                 | 147.231 ms                |
| back: aggr dram keys      | 39.883 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.537 ms                  | 8.430 ms                  |
| back: a2a grad            | 11.077 ms                 | 25.312 ms                 |
| back: grad sum & grad cache  | 3.708 ms                  | 47.226 ms                 |
| Backward                  | 120.951 ms                | 161.358 ms                |
| Optimize                  | 20.415 ms                 | 39.203 ms                 |
| BarrierTimeBeforeRank0    | 41.093 us                 | 86.170 us                 |
| BlockToStepN              | 16.780 us                 | 21.333 ms                 |
| OneStep                   | 186.744 ms                | 534.942 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.843 ms                  | 164.779 ms                |
| bucket keys               | 2.686 ms                  | 4.192 ms                  |
| forward: a2a keys         | 2.055 ms                  | 72.917 ms                 |
| forward: search cache     | 223.371 us                | 336.388 us                |
| forward: a2a values       | 7.564 ms                  | 12.957 ms                 |
| forward: join             | 1.885 ms                  | 3.165 ms                  |
| Forward                   | 33.218 ms                 | 147.231 ms                |
| back: aggr dram keys      | 39.883 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.536 ms                  | 8.329 ms                  |
| back: a2a grad            | 11.077 ms                 | 24.377 ms                 |
| back: grad sum & grad cache  | 3.708 ms                  | 45.403 ms                 |
| Backward                  | 120.836 ms                | 161.358 ms                |
| Optimize                  | 20.595 ms                 | 39.203 ms                 |
| BarrierTimeBeforeRank0    | 41.186 us                 | 86.170 us                 |
| BlockToStepN              | 16.808 us                 | 21.333 ms                 |
| OneStep                   | 186.584 ms                | 534.942 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.792 ms                  | 158.981 ms                |
| bucket keys               | 2.686 ms                  | 4.192 ms                  |
| forward: a2a keys         | 2.051 ms                  | 72.917 ms                 |
| forward: search cache     | 223.275 us                | 336.388 us                |
| forward: a2a values       | 7.564 ms                  | 12.957 ms                 |
| forward: join             | 1.885 ms                  | 3.165 ms                  |
| Forward                   | 33.128 ms                 | 134.141 ms                |
| back: aggr dram keys      | 39.883 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.536 ms                  | 8.329 ms                  |
| back: a2a grad            | 11.070 ms                 | 29.123 ms                 |
| back: grad sum & grad cache  | 3.708 ms                  | 45.403 ms                 |
| Backward                  | 120.697 ms                | 157.144 ms                |
| Optimize                  | 20.618 ms                 | 39.148 ms                 |
| BarrierTimeBeforeRank0    | 41.585 us                 | 85.002 us                 |
| BlockToStepN              | 16.925 us                 | 21.333 ms                 |
| OneStep                   | 186.326 ms                | 451.353 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.792 ms                  | 161.288 ms                |
| bucket keys               | 2.686 ms                  | 4.141 ms                  |
| forward: a2a keys         | 2.047 ms                  | 49.272 ms                 |
| forward: search cache     | 223.267 us                | 307.162 us                |
| forward: a2a values       | 7.564 ms                  | 12.887 ms                 |
| forward: join             | 1.885 ms                  | 3.165 ms                  |
| Forward                   | 33.119 ms                 | 134.141 ms                |
| back: aggr dram keys      | 39.365 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.536 ms                  | 8.329 ms                  |
| back: a2a grad            | 11.077 ms                 | 29.897 ms                 |
| back: grad sum & grad cache  | 3.708 ms                  | 45.051 ms                 |
| Backward                  | 120.685 ms                | 157.144 ms                |
| Optimize                  | 20.618 ms                 | 39.148 ms                 |
| BarrierTimeBeforeRank0    | 41.529 us                 | 85.002 us                 |
| BlockToStepN              | 16.808 us                 | 21.333 ms                 |
| OneStep                   | 186.326 ms                | 451.353 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 19.644, sample: 0.940, forward: 4.694, backward: 8.997, update: 0.397
[proc 3] 400 steps, total: 19.644, sample: 0.827, forward: 4.827, backward: 9.022, update: 0.398
[proc 0] 400 steps, total: 19.644, sample: 1.740, forward: 3.416, backward: 12.245, update: 2.103
[proc 1] 400 steps, total: 19.644, sample: 1.329, forward: 4.306, backward: 9.378, update: 0.370
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.728 ms                  | 161.288 ms                |
| bucket keys               | 2.681 ms                  | 4.192 ms                  |
| forward: a2a keys         | 2.039 ms                  | 49.272 ms                 |
| forward: search cache     | 223.275 us                | 307.162 us                |
| forward: a2a values       | 7.564 ms                  | 12.887 ms                 |
| forward: join             | 1.885 ms                  | 3.299 ms                  |
| Forward                   | 33.077 ms                 | 134.141 ms                |
| back: aggr dram keys      | 38.971 ms                 | 64.575 ms                 |
| back: set dram grad       | 3.536 ms                  | 9.931 ms                  |
| back: a2a grad            | 11.025 ms                 | 29.897 ms                 |
| back: grad sum & grad cache  | 3.708 ms                  | 45.403 ms                 |
| Backward                  | 120.685 ms                | 161.358 ms                |
| Optimize                  | 20.722 ms                 | 39.148 ms                 |
| BarrierTimeBeforeRank0    | 41.169 us                 | 85.002 us                 |
| BlockToStepN              | 16.797 us                 | 21.333 ms                 |
| OneStep                   | 186.265 ms                | 451.353 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.792 ms                  | 161.288 ms                |
| bucket keys               | 2.682 ms                  | 4.141 ms                  |
| forward: a2a keys         | 2.039 ms                  | 47.227 ms                 |
| forward: search cache     | 223.269 us                | 321.475 us                |
| forward: a2a values       | 7.564 ms                  | 12.887 ms                 |
| forward: join             | 1.885 ms                  | 3.204 ms                  |
| Forward                   | 33.077 ms                 | 134.141 ms                |
| back: aggr dram keys      | 39.365 ms                 | 64.962 ms                 |
| back: set dram grad       | 3.536 ms                  | 9.614 ms                  |
| back: a2a grad            | 11.030 ms                 | 29.897 ms                 |
| back: grad sum & grad cache  | 3.708 ms                  | 45.051 ms                 |
| Backward                  | 120.652 ms                | 163.572 ms                |
| Optimize                  | 20.726 ms                 | 39.148 ms                 |
| BarrierTimeBeforeRank0    | 41.529 us                 | 85.002 us                 |
| BlockToStepN              | 16.808 us                 | 22.339 ms                 |
| OneStep                   | 185.961 ms                | 451.353 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.856 ms                  | 158.981 ms                |
| bucket keys               | 2.681 ms                  | 4.141 ms                  |
| forward: a2a keys         | 2.029 ms                  | 47.227 ms                 |
| forward: search cache     | 223.348 us                | 321.475 us                |
| forward: a2a values       | 9.221 ms                  | 12.957 ms                 |
| forward: join             | 1.885 ms                  | 3.299 ms                  |
| Forward                   | 33.087 ms                 | 120.903 ms                |
| back: aggr dram keys      | 39.365 ms                 | 64.962 ms                 |
| back: set dram grad       | 3.536 ms                  | 9.614 ms                  |
| back: a2a grad            | 11.058 ms                 | 30.123 ms                 |
| back: grad sum & grad cache  | 3.708 ms                  | 45.051 ms                 |
| Backward                  | 120.474 ms                | 163.503 ms                |
| Optimize                  | 20.779 ms                 | 38.350 ms                 |
| BarrierTimeBeforeRank0    | 41.524 us                 | 78.103 us                 |
| BlockToStepN              | 16.866 us                 | 21.333 ms                 |
| OneStep                   | 185.738 ms                | 440.385 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.728 ms                  | 158.981 ms                |
| bucket keys               | 2.682 ms                  | 4.102 ms                  |
| forward: a2a keys         | 2.011 ms                  | 37.810 ms                 |
| forward: search cache     | 223.350 us                | 331.316 us                |
| forward: a2a values       | 9.199 ms                  | 14.112 ms                 |
| forward: join             | 1.885 ms                  | 3.291 ms                  |
| Forward                   | 33.041 ms                 | 120.903 ms                |
| back: aggr dram keys      | 38.791 ms                 | 64.962 ms                 |
| back: set dram grad       | 3.536 ms                  | 8.820 ms                  |
| back: a2a grad            | 11.070 ms                 | 29.897 ms                 |
| back: grad sum & grad cache  | 3.708 ms                  | 45.051 ms                 |
| Backward                  | 120.458 ms                | 163.503 ms                |
| Optimize                  | 20.779 ms                 | 38.350 ms                 |
| BarrierTimeBeforeRank0    | 41.169 us                 | 78.103 us                 |
| BlockToStepN              | 16.866 us                 | 21.333 ms                 |
| OneStep                   | 185.703 ms                | 440.385 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 19.738, sample: 0.884, forward: 4.717, backward: 9.332, update: 0.437
[proc 0] 500 steps, total: 19.737, sample: 1.592, forward: 3.521, backward: 12.370, update: 2.086
[proc 3] 500 steps, total: 19.738, sample: 0.935, forward: 4.676, backward: 9.313, update: 0.399
[proc 1] 500 steps, total: 19.737, sample: 1.217, forward: 4.337, backward: 9.710, update: 0.367
Successfully xmh. training takes 102.61781740188599 seconds
before call kg_cache_controller.StopThreads()
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
INFO [1986 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.726 ms                  | 158.981 ms                |
| bucket keys               | 2.682 ms                  | 4.102 ms                  |
| forward: a2a keys         | 2.007 ms                  | 37.810 ms                 |
| forward: search cache     | 223.350 us                | 331.316 us                |
| forward: a2a values       | 9.221 ms                  | 14.112 ms                 |
| forward: join             | 1.885 ms                  | 3.299 ms                  |
| Forward                   | 33.034 ms                 | 120.903 ms                |
| back: aggr dram keys      | 38.791 ms                 | 64.962 ms                 |
| back: set dram grad       | 3.536 ms                  | 8.820 ms                  |
| back: a2a grad            | 11.061 ms                 | 29.897 ms                 |
| back: grad sum & grad cache  | 3.708 ms                  | 45.051 ms                 |
| Backward                  | 120.336 ms                | 163.503 ms                |
| Optimize                  | 20.779 ms                 | 38.350 ms                 |
| BarrierTimeBeforeRank0    | 41.032 us                 | 78.103 us                 |
| BlockToStepN              | 16.780 us                 | 21.333 ms                 |
| OneStep                   | 185.606 ms                | 440.385 ms                |
+---------------------------+---------------------------+---------------------------+
