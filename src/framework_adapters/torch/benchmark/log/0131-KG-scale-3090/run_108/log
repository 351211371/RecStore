WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 20:14:12.363518 51831 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_150', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Partitoning with metis
[20:14:13] /home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 14951 nodes and 771659 edges into 7 parts and get 141856 edge cuts
WARNING [51831 sampler.py:454] Start PreSampling
WARNING [51831 sampler.py:532] Before construct renumbering_dict
WARNING [51831 sampler.py:555] PreSampling done
W20240205 20:14:17.353615 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 20:14:17.353834 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 20:14:17.353897 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 20:14:17.353940 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 20:14:17.353986 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 20:14:17.354027 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 20:14:17.354068 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 20:14:17.354125 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 20:14:17.354169 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 20:14:17.354225 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 20:14:17.354272 51831 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 20:14:17.354310 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 20:14:17.354355 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 20:14:17.354552 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 20:14:17.354609 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 20:14:17.354650 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 20:14:17.354696 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 20:14:17.354748 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 20:14:17.354802 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 20:14:17.354852 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 20:14:17.354903 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 20:14:17.354956 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 20:14:17.354997 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 20:14:17.355037 51831 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 20:14:17.355072 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 20:14:17.355108 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 20:14:17.355190 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 20:14:17.355232 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 20:14:17.355270 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 20:14:17.355319 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 20:14:17.355360 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 20:14:17.355403 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 20:14:17.355444 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 20:14:17.355482 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 20:14:17.355535 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 20:14:17.355582 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 20:14:17.355620 51831 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 20:14:17.355654 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 20:14:17.355690 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 20:14:17.355764 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 20:14:17.355809 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 20:14:17.355860 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 20:14:17.355912 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 20:14:17.355965 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 20:14:17.356014 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 20:14:17.356066 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 20:14:17.356106 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 20:14:17.356153 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 20:14:17.356194 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 20:14:17.356241 51831 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 20:14:17.356281 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 20:14:17.356318 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 20:14:17.356397 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 20:14:17.356444 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 20:14:17.356487 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 20:14:17.356528 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 20:14:17.356570 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 20:14:17.356621 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 20:14:17.356675 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 20:14:17.356725 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 20:14:17.356778 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 20:14:17.356837 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 20:14:17.356876 51831 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 20:14:17.356913 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 20:14:17.356949 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 20:14:17.357024 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 20:14:17.357072 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 20:14:17.357123 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 20:14:17.357163 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 20:14:17.357205 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 20:14:17.357247 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 20:14:17.357296 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 20:14:17.357339 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 20:14:17.357383 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 20:14:17.357429 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 20:14:17.357471 51831 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 20:14:17.357506 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 20:14:17.357542 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 20:14:17.357616 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 20:14:17.357661 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 20:14:17.357702 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 20:14:17.357741 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 20:14:17.357789 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 20:14:17.357829 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 20:14:17.357884 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 20:14:17.357931 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 20:14:17.357990 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 20:14:17.358032 51831 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 20:14:17.358083 51831 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 20:14:17.358117 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 20:14:17.358153 51831 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 20:14:17.584512 51831 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x1000216be000 22.81 MB
W20240205 20:14:17.678092 51831 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100022d90000 58.4 kB
Convert a graph into a bidirected graph: 0.035 seconds, peak memory: 210.599 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 210.599 GB
Metis partitioning: 0.122 seconds, peak memory: 210.599 GB
Split the graph: 0.047 seconds
Construct subgraphs: 0.022 seconds
MertisPartition: part 0 has 8708 N 114062 E
MertisPartition: part 1 has 8851 N 101101 E
MertisPartition: part 2 has 6696 N 94778 E
MertisPartition: part 3 has 10148 N 151271 E
MertisPartition: part 4 has 8972 N 107004 E
MertisPartition: part 5 has 8551 N 124920 E
MertisPartition: part 6 has 9450 N 118501 E
Rank0: cached key size 106
Rank1: cached key size 106
Rank2: cached key size 106
Rank3: cached key size 106
Rank4: cached key size 106
Rank5: cached key size 106
Rank6: cached key size 106
Before renumbering graph:  {'_ID': tensor([    7,    16,    18,  ..., 13890,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 5, 1])}
After renumbering graph:  {'_ID': tensor([  944,  1193,  1237,  ..., 11556,  2193, 10410]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 5, 1])}
part_g: DGLGraph(num_nodes=8708, num_edges=114062,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8708, num_edges=114062,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.416 seconds
[Rank1] pid = 52062
[Rank2] pid = 52126
[Rank3] pid = 52190
[Rank4] pid = 52255
[Rank5] pid = 52319
INFO [51831 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [52062 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [52126 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [52190 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [52319 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [52190 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [52255 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [52126 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [51831 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [52319 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [52062 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [52255 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [52384 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [52384 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
W20240205 20:14:20.154210 52385 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240205 20:14:20.155421 52387 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240205 20:14:20.155514 52320 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240205 20:14:20.155506 52127 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240205 20:14:20.155519 52191 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240205 20:14:20.155516 52256 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240205 20:14:20.155517 52063 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240205 20:14:20.182746 52320 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100022da8000 7.629 MB
W20240205 20:14:20.182762 52387 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100023cee000 7.629 MB
W20240205 20:14:20.182758 52191 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10002354b000 7.629 MB
W20240205 20:14:20.182780 52256 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100024491000 7.629 MB
W20240205 20:14:20.182960 52320 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100024c34000 7.629 MB
W20240205 20:14:20.182977 52387 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000253d7000 7.629 MB
W20240205 20:14:20.182983 52191 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100025b7a000 7.629 MB
W20240205 20:14:20.183015 52256 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10002631d000 7.629 MB
W20240205 20:14:20.183036 52320 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x100026ac0000 1.49 GB
W20240205 20:14:20.183061 52387 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1000860a3000 1.49 GB
W20240205 20:14:20.183069 52191 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1000e5686000 1.49 GB
W20240205 20:14:20.183099 52256 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x100144c69000 1.49 GB
W20240205 20:14:20.183120 52320 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1001a424c000 1.49 GB
W20240205 20:14:20.183147 52387 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10020382f000 1.49 GB
W20240205 20:14:20.183156 52191 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100262e12000 1.49 GB
W20240205 20:14:20.183180 52256 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1002c23f5000 1.49 GB
W20240205 20:14:20.183225 52387 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 20:14:20.183226 52320 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 20:14:20.183234 52191 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 20:14:20.183240 52256 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 20:14:20.190933 52320 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 20:14:20.190936 52387 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 20:14:20.190948 52256 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 20:14:20.190966 52191 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 20:14:20.191023 52385 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1003219e6000 7.629 MB
W20240205 20:14:20.191135 52127 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100322189000 7.629 MB
W20240205 20:14:20.191192 52385 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10032292c000 7.629 MB
W20240205 20:14:20.191220 52063 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1003230cf000 7.629 MB
W20240205 20:14:20.191267 52385 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100323872000 1.49 GB
W20240205 20:14:20.191294 52127 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100382e55000 7.629 MB
W20240205 20:14:20.191329 52385 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1003835f8000 1.49 GB
W20240205 20:14:20.191360 52127 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1003e2bdb000 1.49 GB
W20240205 20:14:20.191375 52385 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 20:14:20.191393 52063 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1004421be000 7.629 MB
W20240205 20:14:20.191416 52127 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x100442961000 1.49 GB
W20240205 20:14:20.191457 52063 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1004a1f44000 1.49 GB
W20240205 20:14:20.191481 52127 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 20:14:20.191511 52063 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100501527000 1.49 GB
W20240205 20:14:20.191556 52063 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 20:14:20.202445 52127 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 20:14:20.202446 52385 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 20:14:20.202463 52063 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x1000216be000
1: KnownLocalCachedEmbedding init done
WARNING [52062 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
5: KnownLocalCachedEmbedding init done
WARNING [52319 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
2: KnownLocalCachedEmbedding init done
WARNING [52126 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
6: KnownLocalCachedEmbedding init done
WARNING [52384 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
4: KnownLocalCachedEmbedding init done
WARNING [52255 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank6] pid = 52384
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229)]
cudaHostRegister 0x1000216be000
0: KnownLocalCachedEmbedding init done
WARNING [51831 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
3: KnownLocalCachedEmbedding init done
WARNING [52190 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 20:14:22.004089 52191 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240205 20:14:22.004171 52387 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:14:22.004247 52320 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:14:22.004500 52063 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:14:22.004711 52127 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:14:22.006250 52385 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:14:22.006372 52256 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
W20240205 20:14:22.010529 52385 grad_base.h:55] KGCacheController, config={
        "num_gpus": 7,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 20:14:22.010880 52385 grad_base.h:184] Init GradProcessingBase done
I20240205 20:14:22.022117 52385 grad_async_v2.h:42] Use main thread to update emb.
W20240205 20:14:22.022222 52385 kg_controller.h:78] after init GradAsyncProcessingV2
I20240205 20:14:22.022243 52385 kg_controller.h:84] Construct KGCacheController done
E20240205 20:14:23.694833 52387 recstore.cc:66] init folly done
E20240205 20:14:23.694870 52191 recstore.cc:66] init folly done
E20240205 20:14:23.694880 52320 recstore.cc:66] init folly done
E20240205 20:14:23.694941 52256 recstore.cc:66] init folly done
E20240205 20:14:23.695215 52127 recstore.cc:66] init folly done
E20240205 20:14:23.695297 52063 recstore.cc:66] init folly done
E20240205 20:14:23.695423 52385 recstore.cc:66] init folly done
I20240205 20:14:23.696584 52385 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240205 20:14:24.386034 52921 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 20:14:24.386446 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 20:14:24.421188 52256 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240205 20:14:24.421895 52127 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:14:24.423252 52320 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:14:24.425732 52385 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:14:24.426771 52191 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:14:24.430142 52063 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:14:24.431759 52387 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
E20240205 20:14:26.388293 52385 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 20:14:26.441226 52921 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 20:14:26.479077 52385 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
W20240205 20:14:26.579212 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=2, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.147 ms                  | 49.849 ms                 |
| Forward                   | 9.611 ms                  | 639.729 ms                |
| Backward                  | 5.085 ms                  | 189.471 ms                |
| Optimize                  | 3.877 ms                  | 5.381 ms                  |
| BarrierTimeBeforeRank0    | 51.977 us                 | 28.177 ms                 |
| AfterBackward             | 61.560 ms                 | 1.142 s                   |
| BlockToStepN              | 160.890 us                | 634.802 us                |
| OneStep                   | 85.362 ms                 | 2.008 s                   |
+---------------------------+---------------------------+---------------------------+
E20240205 20:14:27.388037 52929 parallel_pq_v2.h:79] insert failed, size(hashtable)=10460
W20240205 20:14:27.511188 52921 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
W20240205 20:14:27.595641 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=15, pq.top=15
E20240205 20:14:28.388031 52948 parallel_pq_v2.h:79] insert failed, size(hashtable)=4691
W20240205 20:14:28.521864 52921 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 333.062 us                | 14.006 ms                 |
| ProcessBack:Shuffle       | 8.080 ms                  | 277.765 ms                |
| ProcessBack:UpdateCache   | 8.004 ms                  | 604.322 ms                |
| ProcessBack:UpsertPq      | 26.385 ms                 | 47.013 ms                 |
| ProcessOneStep            | 42.507 ms                 | 1.141 s                   |
| BlockToStepN              | 89.007 us                 | 2.368 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:28.703218 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=25, pq.top=25
E20240205 20:14:29.388077 52932 parallel_pq_v2.h:79] insert failed, size(hashtable)=8361
W20240205 20:14:29.622572 52921 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
W20240205 20:14:29.770435 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=40, pq.top=40
E20240205 20:14:30.528470 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 20:14:30.624217 52921 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240205 20:14:30.805184 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=48, pq.top=48
E20240205 20:14:31.528126 52945 parallel_pq_v2.h:79] insert failed, size(hashtable)=11162
W20240205 20:14:31.655115 52921 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
W20240205 20:14:31.823875 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=63, pq.top=63
E20240205 20:14:31.982806 52596 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=65, sample_step_cpp_seen_[rank]=64
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.596 ms                  | 47.785 ms                 |
| Forward                   | 6.159 ms                  | 12.143 ms                 |
| Backward                  | 6.309 ms                  | 10.552 ms                 |
| Optimize                  | 2.898 ms                  | 5.381 ms                  |
| BarrierTimeBeforeRank0    | 81.318 us                 | 11.086 ms                 |
| AfterBackward             | 46.683 ms                 | 553.811 ms                |
| BlockToStepN              | 439.793 us                | 2.135 ms                  |
| OneStep                   | 65.953 ms                 | 574.979 ms                |
+---------------------------+---------------------------+---------------------------+
E20240205 20:14:32.545964 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 20:14:32.658449 52921 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
W20240205 20:14:32.846031 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=70, pq.top=70
E20240205 20:14:33.545017 52596 parallel_pq_v2.h:79] insert failed, size(hashtable)=339
W20240205 20:14:33.690482 52921 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 293.047 us                | 9.725 ms                  |
| ProcessBack:Shuffle       | 7.569 ms                  | 12.072 ms                 |
| ProcessBack:UpdateCache   | 8.319 ms                  | 10.821 ms                 |
| ProcessBack:UpsertPq      | 29.323 ms                 | 44.003 ms                 |
| ProcessOneStep            | 46.666 ms                 | 613.544 ms                |
| BlockToStepN              | 413.493 us                | 1.985 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:33.846128 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=84, pq.top=84
E20240205 20:14:34.591970 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 20:14:34.693207 52921 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
W20240205 20:14:35.204910 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=94, pq.top=94
E20240205 20:14:35.591007 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=194
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 11.228, sample: 0.399, forward: 1.183, backward: 0.689, update: 0.244
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 11.230, sample: 0.456, forward: 1.151, backward: 0.779, update: 0.251
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 11.219, sample: 0.515, forward: 1.226, backward: 0.736, update: 0.275
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 11.229, sample: 0.417, forward: 1.201, backward: 0.706, update: 0.258
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 11.224, sample: 0.435, forward: 1.211, backward: 0.737, update: 0.258
train_sampler.Prefill()
-------Step 0-------
tensor([ 2900,  4848, 10838,  9857,  6126, 13360,  4312,     0,    38,  9714]) tensor([ 1237,  8140,  1981, 12482,    55, 10181,   317,  5206, 11890, 12846])
-------Step 1-------
tensor([ 2900,  4848, 10838,  9857,  6126, 13360,  4312,     0,    38,  9714]) tensor([11535,  7989,  5723, 12959,  9839,  9852,  1834,  1424,   555,  8228])
-------Step 2-------
tensor([ 4711,  8022,  4105, 14855, 12004,  9783,  4437, 14747,  8812,    55]) tensor([ 3594,  7736,  7805,  6021,  8422, 14033, 13205, 11809, 13308, 10991])
-------Step 3-------
tensor([ 4711,  8022,  4105, 14855, 12004,  9783,  4437, 14747,  8812,    55]) tensor([ 4330, 13184,   596,  7340,  2133,   874,  7028,  8160,  3817, 14513])
-------Step 4-------
tensor([11376,  9570, 11371,  7063,  3626,  1027, 11977,  6334,  8338,  2467]) tensor([ 9287, 12205,  2309,  1219, 13723,  7768, 10356,  6781,  2900,  5888])
-------Step 5-------
tensor([11376,  9570, 11371,  7063,  3626,  1027, 11977,  6334,  8338,  2467]) tensor([ 4447,  7074, 11671,  5954,  2662, 12299,  8225,  8887,  2138,  3494])
-------Step 6-------
tensor([  102,   932,  9391,  1540,  4871,  3251,  7986, 11087, 11568,    15]) tensor([ 4204,  1268, 10903, 10334,   178,  2409,  5077, 13505,  4595,  4761])
-------Step 7-------
tensor([  102,   932,  9391,  1540,  4871,  3251,  7986, 11087, 11568,    15]) tensor([ 3959,  8944,  3871,  1867, 10364,  3930,  2430,  6841, 11705,    16])
-------Step 8-------
tensor([ 4872, 13911, 13706,   944,  1847,  4099,  2914,  9811,  8440,  2610]) tensor([ 1373,  1030, 11804, 12759,  6458,  9929,  7070, 13459,  8815,  1393])
-------Step 9-------
tensor([ 4872, 13911, 13706,   944,  1847,  4099,  2914,  9811,  8440,  2610]) tensor([ 4345,  6257,  8751, 10768,  1442,  6810, 10038,  4420, 11988,  6425])
before start barrier
start train
[proc 0] 100 steps, total: 11.226, sample: 0.527, forward: 1.257, backward: 0.784, update: 0.303
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 11.221, sample: 0.438, forward: 1.200, backward: 0.717, update: 0.260
W20240205 20:14:35.703687 52921 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
W20240205 20:14:36.568235 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=111, pq.top=111
E20240205 20:14:36.591029 52941 parallel_pq_v2.h:79] insert failed, size(hashtable)=11121
W20240205 20:14:36.795365 52921 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 20:14:36.982007 52596 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=114, sample_step_cpp_seen_[rank]=113
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.695 ms                  | 47.785 ms                 |
| Forward                   | 5.910 ms                  | 12.143 ms                 |
| Backward                  | 6.405 ms                  | 10.552 ms                 |
| Optimize                  | 2.932 ms                  | 6.051 ms                  |
| BarrierTimeBeforeRank0    | 772.718 us                | 28.088 ms                 |
| AfterBackward             | 46.969 ms                 | 613.598 ms                |
| BlockToStepN              | 548.802 us                | 2.135 ms                  |
| OneStep                   | 68.317 ms                 | 630.814 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:37.572271 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=118, pq.top=118
E20240205 20:14:37.591033 52920 parallel_pq_v2.h:79] insert failed, size(hashtable)=8505
W20240205 20:14:37.818217 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240205 20:14:38.591017 52944 parallel_pq_v2.h:79] insert failed, size(hashtable)=13907
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 373.417 us                | 8.683 ms                  |
| ProcessBack:Shuffle       | 7.232 ms                  | 11.037 ms                 |
| ProcessBack:UpdateCache   | 7.921 ms                  | 10.636 ms                 |
| ProcessBack:UpsertPq      | 29.740 ms                 | 43.939 ms                 |
| ProcessOneStep            | 46.680 ms                 | 613.544 ms                |
| BlockToStepN              | 501.109 us                | 2.520 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:38.785497 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240205 20:14:38.832345 52921 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240205 20:14:39.591130 52930 parallel_pq_v2.h:79] insert failed, size(hashtable)=10265
W20240205 20:14:39.853313 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240205 20:14:40.369987 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=148, pq.top=148
E20240205 20:14:40.591027 52939 parallel_pq_v2.h:79] insert failed, size(hashtable)=8811
W20240205 20:14:40.944299 52921 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
W20240205 20:14:41.393754 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=157, pq.top=157
E20240205 20:14:41.591008 52930 parallel_pq_v2.h:79] insert failed, size(hashtable)=10535
W20240205 20:14:41.956324 52921 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.777 ms                  | 32.014 ms                 |
| Forward                   | 5.674 ms                  | 11.788 ms                 |
| Backward                  | 6.305 ms                  | 12.976 ms                 |
| Optimize                  | 2.935 ms                  | 5.773 ms                  |
| BarrierTimeBeforeRank0    | 1.510 ms                  | 27.287 ms                 |
| AfterBackward             | 47.051 ms                 | 553.811 ms                |
| BlockToStepN              | 625.715 us                | 2.601 ms                  |
| OneStep                   | 75.067 ms                 | 574.979 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:42.496031 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=169, pq.top=169
E20240205 20:14:42.591007 52596 parallel_pq_v2.h:79] insert failed, size(hashtable)=646
W20240205 20:14:42.969389 52921 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 20:14:43.591007 52596 parallel_pq_v2.h:79] insert failed, size(hashtable)=1554
W20240205 20:14:43.609155 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=181, pq.top=181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 350.763 us                | 9.012 ms                  |
| ProcessBack:Shuffle       | 7.387 ms                  | 12.072 ms                 |
| ProcessBack:UpdateCache   | 8.037 ms                  | 10.942 ms                 |
| ProcessBack:UpsertPq      | 30.413 ms                 | 47.038 ms                 |
| ProcessOneStep            | 47.338 ms                 | 553.757 ms                |
| BlockToStepN              | 583.803 us                | 2.520 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:43.991029 52921 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240205 20:14:44.591013 52939 parallel_pq_v2.h:79] insert failed, size(hashtable)=12718
W20240205 20:14:44.923236 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=198, pq.top=198
E20240205 20:14:45.010238 52385 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=199, sample_step_cpp_seen_[rank]=198
W20240205 20:14:45.035691 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
[proc 1] 200 steps, total: 9.428, sample: 0.424, forward: 0.505, backward: 0.499, update: 0.237
[proc 5] 200 steps, total: 9.428, sample: 0.458, forward: 0.538, backward: 0.441, update: 0.226
[proc 2] 200 steps, total: 9.428, sample: 0.442, forward: 0.542, backward: 0.490, update: 0.239
[proc 6] 200 steps, total: 9.428, sample: 0.459, forward: 0.535, backward: 0.483, update: 0.233
[proc 0] 200 steps, total: 9.428, sample: 0.537, forward: 0.533, backward: 0.519, update: 0.278
[proc 4] 200 steps, total: 9.428, sample: 0.401, forward: 0.545, backward: 0.513, update: 0.240
[proc 3] 200 steps, total: 9.428, sample: 0.444, forward: 0.534, backward: 0.591, update: 0.227
E20240205 20:14:45.661202 52596 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 20:14:46.036728 52921 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240205 20:14:46.039764 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=205, pq.top=205
E20240205 20:14:46.661039 52923 parallel_pq_v2.h:79] insert failed, size(hashtable)=4755
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.844 ms                  | 32.903 ms                 |
| Forward                   | 5.630 ms                  | 11.788 ms                 |
| Backward                  | 5.332 ms                  | 12.976 ms                 |
| Optimize                  | 2.932 ms                  | 5.773 ms                  |
| BarrierTimeBeforeRank0    | 2.105 ms                  | 27.287 ms                 |
| AfterBackward             | 46.883 ms                 | 576.979 ms                |
| BlockToStepN              | 697.332 us                | 3.560 ms                  |
| OneStep                   | 78.741 ms                 | 614.861 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:47.045054 52921 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
W20240205 20:14:47.072577 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=219, pq.top=219
E20240205 20:14:47.661036 52947 parallel_pq_v2.h:79] insert failed, size(hashtable)=7321
W20240205 20:14:48.080133 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240205 20:14:48.226258 52921 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 407.242 us                | 12.760 ms                 |
| ProcessBack:Shuffle       | 7.350 ms                  | 11.037 ms                 |
| ProcessBack:UpdateCache   | 7.948 ms                  | 10.906 ms                 |
| ProcessBack:UpsertPq      | 30.229 ms                 | 47.013 ms                 |
| ProcessOneStep            | 46.850 ms                 | 576.770 ms                |
| BlockToStepN              | 670.243 us                | 3.488 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 20:14:48.835079 52596 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 20:14:49.126067 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240205 20:14:49.247663 52921 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240205 20:14:49.835014 52940 parallel_pq_v2.h:79] insert failed, size(hashtable)=13142
W20240205 20:14:50.169685 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240205 20:14:50.302847 52921 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240205 20:14:50.835021 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=2720
E20240205 20:14:50.860481 52596 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=256, sample_step_cpp_seen_[rank]=255
W20240205 20:14:51.324383 52921 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
W20240205 20:14:51.763173 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=260, pq.top=260
E20240205 20:14:51.835085 52949 parallel_pq_v2.h:79] insert failed, size(hashtable)=4010
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.922 ms                  | 32.903 ms                 |
| Forward                   | 5.579 ms                  | 11.009 ms                 |
| Backward                  | 5.051 ms                  | 10.552 ms                 |
| Optimize                  | 2.928 ms                  | 5.457 ms                  |
| BarrierTimeBeforeRank0    | 2.519 ms                  | 28.088 ms                 |
| AfterBackward             | 46.969 ms                 | 613.598 ms                |
| BlockToStepN              | 820.965 us                | 3.769 ms                  |
| OneStep                   | 80.362 ms                 | 630.814 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:52.367448 52921 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240205 20:14:52.835018 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=159
W20240205 20:14:53.431242 52921 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240205 20:14:53.518092 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=274, pq.top=274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 269.719 us                | 7.829 ms                  |
| ProcessBack:Shuffle       | 7.387 ms                  | 10.850 ms                 |
| ProcessBack:UpdateCache   | 7.903 ms                  | 10.906 ms                 |
| ProcessBack:UpsertPq      | 30.229 ms                 | 47.013 ms                 |
| ProcessOneStep            | 46.844 ms                 | 661.516 ms                |
| BlockToStepN              | 769.734 us                | 3.986 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 20:14:53.835072 52931 parallel_pq_v2.h:79] insert failed, size(hashtable)=7573
W20240205 20:14:54.545228 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240205 20:14:54.839877 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 20:14:55.563032 52921 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
E20240205 20:14:55.839049 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=346
W20240205 20:14:55.926767 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 0] 300 steps, total: 10.848, sample: 0.611, forward: 0.530, backward: 0.501, update: 0.270
[proc 6] 300 steps, total: 10.848, sample: 0.436, forward: 0.535, backward: 0.494, update: 0.227
[proc 1] 300 steps, total: 10.849, sample: 0.435, forward: 0.527, backward: 0.499, update: 0.241
[proc 3] 300 steps, total: 10.848, sample: 0.597, forward: 0.627, backward: 0.621, update: 0.280
[proc 4] 300 steps, total: 10.848, sample: 0.475, forward: 0.527, backward: 0.508, update: 0.241
[proc 2] 300 steps, total: 10.849, sample: 0.427, forward: 0.546, backward: 0.496, update: 0.247
[proc 5] 300 steps, total: 10.849, sample: 0.408, forward: 0.535, backward: 0.427, update: 0.220
W20240205 20:14:56.596503 52921 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
E20240205 20:14:56.839010 52596 parallel_pq_v2.h:79] insert failed, size(hashtable)=2155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.999 ms                  | 32.903 ms                 |
| Forward                   | 5.519 ms                  | 11.009 ms                 |
| Backward                  | 5.051 ms                  | 10.552 ms                 |
| Optimize                  | 2.898 ms                  | 5.773 ms                  |
| BarrierTimeBeforeRank0    | 2.808 ms                  | 40.197 ms                 |
| AfterBackward             | 46.683 ms                 | 661.606 ms                |
| BlockToStepN              | 931.858 us                | 4.760 ms                  |
| OneStep                   | 80.562 ms                 | 683.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:57.028121 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=314, pq.top=314
E20240205 20:14:57.371409 52385 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=318, sample_step_cpp_seen_[rank]=317
W20240205 20:14:57.636364 52921 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
E20240205 20:14:57.839008 52596 parallel_pq_v2.h:79] insert failed, size(hashtable)=1657
W20240205 20:14:58.285964 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 382.676 us                | 12.043 ms                 |
| ProcessBack:Shuffle       | 7.350 ms                  | 10.821 ms                 |
| ProcessBack:UpdateCache   | 7.763 ms                  | 10.821 ms                 |
| ProcessBack:UpsertPq      | 29.861 ms                 | 46.813 ms                 |
| ProcessOneStep            | 46.565 ms                 | 661.516 ms                |
| BlockToStepN              | 890.373 us                | 4.694 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 20:14:58.737414 52921 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240205 20:14:58.839008 52596 parallel_pq_v2.h:79] insert failed, size(hashtable)=391
W20240205 20:14:59.404471 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240205 20:14:59.839085 52926 parallel_pq_v2.h:79] insert failed, size(hashtable)=14151
W20240205 20:14:59.928005 52921 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
W20240205 20:15:00.735641 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=348, pq.top=348
E20240205 20:15:00.839036 52930 parallel_pq_v2.h:79] insert failed, size(hashtable)=8392
W20240205 20:15:00.927245 52921 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240205 20:15:01.839056 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=215
W20240205 20:15:01.907253 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=361, pq.top=361
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.039 ms                  | 32.903 ms                 |
| Forward                   | 5.481 ms                  | 10.968 ms                 |
| Backward                  | 4.982 ms                  | 10.486 ms                 |
| Optimize                  | 2.908 ms                  | 5.606 ms                  |
| BarrierTimeBeforeRank0    | 2.986 ms                  | 40.085 ms                 |
| AfterBackward             | 46.771 ms                 | 661.606 ms                |
| BlockToStepN              | 1.026 ms                  | 4.082 ms                  |
| OneStep                   | 81.962 ms                 | 683.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:15:02.083561 52921 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240205 20:15:02.476154 52385 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=367, sample_step_cpp_seen_[rank]=366
E20240205 20:15:02.839213 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240205 20:15:03.098410 52921 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 352.498 us                | 9.688 ms                  |
| ProcessBack:Shuffle       | 7.387 ms                  | 12.072 ms                 |
| ProcessBack:UpdateCache   | 7.603 ms                  | 10.799 ms                 |
| ProcessBack:UpsertPq      | 30.134 ms                 | 48.114 ms                 |
| ProcessOneStep            | 46.771 ms                 | 661.516 ms                |
| BlockToStepN              | 989.236 us                | 3.986 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 20:15:03.798079 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=379, pq.top=379
E20240205 20:15:03.839010 52945 parallel_pq_v2.h:79] insert failed, size(hashtable)=11534
W20240205 20:15:04.118983 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
E20240205 20:15:04.839017 52929 parallel_pq_v2.h:79] insert failed, size(hashtable)=12313
W20240205 20:15:04.965870 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240205 20:15:05.217154 52921 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240205 20:15:05.932124 52385 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 20:15:06.041205 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=400, pq.top=400
[proc 5] 400 steps, total: 10.115, sample: 0.438, forward: 0.518, backward: 0.432, update: 0.219
[proc 3] 400 steps, total: 10.115, sample: 0.429, forward: 0.562, backward: 0.646, update: 0.229
[proc 0] 400 steps, total: 10.115, sample: 0.555, forward: 0.521, backward: 0.489, update: 0.290
[proc 1] 400 steps, total: 10.115, sample: 0.414, forward: 0.529, backward: 0.480, update: 0.240
[proc 4] 400 steps, total: 10.115, sample: 0.420, forward: 0.516, backward: 0.510, update: 0.233
[proc 2] 400 steps, total: 10.115, sample: 0.419, forward: 0.541, backward: 0.467, update: 0.235
[proc 6] 400 steps, total: 10.115, sample: 0.465, forward: 0.561, backward: 0.427, update: 0.235
W20240205 20:15:06.230818 52921 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240205 20:15:06.932029 52939 parallel_pq_v2.h:79] insert failed, size(hashtable)=6386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.043 ms                  | 32.903 ms                 |
| Forward                   | 5.449 ms                  | 10.968 ms                 |
| Backward                  | 4.963 ms                  | 10.552 ms                 |
| Optimize                  | 2.898 ms                  | 5.606 ms                  |
| BarrierTimeBeforeRank0    | 4.000 ms                  | 40.085 ms                 |
| AfterBackward             | 46.813 ms                 | 661.606 ms                |
| BlockToStepN              | 1.155 ms                  | 4.082 ms                  |
| OneStep                   | 82.760 ms                 | 683.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:15:07.113828 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=413, pq.top=413
W20240205 20:15:07.250620 52921 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 20:15:07.516805 52385 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=417, sample_step_cpp_seen_[rank]=416
E20240205 20:15:08.007509 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 20:15:08.256381 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=418, pq.top=418
W20240205 20:15:08.259297 52921 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 367.252 us                | 15.338 ms                 |
| ProcessBack:Shuffle       | 7.412 ms                  | 12.072 ms                 |
| ProcessBack:UpdateCache   | 7.574 ms                  | 10.799 ms                 |
| ProcessBack:UpsertPq      | 30.263 ms                 | 49.030 ms                 |
| ProcessOneStep            | 46.826 ms                 | 673.828 ms                |
| BlockToStepN              | 1.138 ms                  | 3.986 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 20:15:09.007014 52940 parallel_pq_v2.h:79] insert failed, size(hashtable)=8379
W20240205 20:15:09.262373 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240205 20:15:09.405876 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=431, pq.top=431
E20240205 20:15:10.007014 52947 parallel_pq_v2.h:79] insert failed, size(hashtable)=4157
W20240205 20:15:10.273702 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240205 20:15:10.446307 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=444, pq.top=444
E20240205 20:15:11.007014 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=26
W20240205 20:15:11.375420 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
W20240205 20:15:11.523166 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=458, pq.top=458
E20240205 20:15:12.007582 52945 parallel_pq_v2.h:79] insert failed, size(hashtable)=9797
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.052 ms                  | 33.339 ms                 |
| Forward                   | 5.430 ms                  | 9.611 ms                  |
| Backward                  | 5.005 ms                  | 10.486 ms                 |
| Optimize                  | 2.854 ms                  | 5.457 ms                  |
| BarrierTimeBeforeRank0    | 4.095 ms                  | 39.688 ms                 |
| AfterBackward             | 46.859 ms                 | 661.606 ms                |
| BlockToStepN              | 1.344 ms                  | 4.239 ms                  |
| OneStep                   | 82.874 ms                 | 683.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:15:12.473878 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
E20240205 20:15:12.516001 52596 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=463, sample_step_cpp_seen_[rank]=462
W20240205 20:15:12.662815 52385 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=464, pq.top=464
E20240205 20:15:13.007058 52934 parallel_pq_v2.h:79] insert failed, size(hashtable)=4223
W20240205 20:15:13.512674 52921 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 373.443 us                | 24.395 ms                 |
| ProcessBack:Shuffle       | 7.421 ms                  | 11.037 ms                 |
| ProcessBack:UpdateCache   | 7.568 ms                  | 10.784 ms                 |
| ProcessBack:UpsertPq      | 30.263 ms                 | 48.511 ms                 |
| ProcessOneStep            | 46.813 ms                 | 661.516 ms                |
| BlockToStepN              | 1.370 ms                  | 4.153 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 20:15:14.007009 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=598
W20240205 20:15:14.518658 52921 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
E20240205 20:15:15.007006 52596 parallel_pq_v2.h:79] insert failed, size(hashtable)=375
W20240205 20:15:15.584807 52921 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
[proc 3] 500 steps, total: 9.958, sample: 0.465, forward: 0.538, backward: 0.565, update: 0.237
[proc 5] 500 steps, total: 9.958, sample: 0.422, forward: 0.526, backward: 0.464, update: 0.228
[proc 1] 500 steps, total: 9.958, sample: 0.437, forward: 0.509, backward: 0.512, update: 0.238
[proc 6] 500 steps, total: 9.958, sample: 0.423, forward: 0.524, backward: 0.462, update: 0.240
[proc 0] 500 steps, total: 9.958, sample: 0.563, forward: 0.521, backward: 0.502, update: 0.260
[proc 4] 500 steps, total: 9.958, sample: 0.435, forward: 0.510, backward: 0.519, update: 0.232
[proc 2] 500 steps, total: 9.958, sample: 0.432, forward: 0.544, backward: 0.488, update: 0.243
Successfully xmh. training takes 51.57600474357605 seconds
before call kg_cache_controller.StopThreads()
W20240205 20:15:16.001706 52385 grad_async_v2.h:84] call StopThreads. PID = 51831
W20240205 20:15:16.001735 52385 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 20:15:16.002067 52385 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 20:15:16.002089 52385 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
E20240205 20:15:16.007366 52921 parallel_pq_v2.h:79] insert failed, size(hashtable)=1154
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
W20240205 20:15:16.231155 52385 grad_async_v2.h:105] StopThreads done.
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7fd78376ead0>
