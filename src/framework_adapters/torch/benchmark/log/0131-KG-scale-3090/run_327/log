WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240213 00:49:04.128937 38549 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_130', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=1, update_pq_use_omp=2, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [38549 sampler.py:454] Start PreSampling
WARNING [38549 sampler.py:532] Before construct renumbering_dict
WARNING [38549 sampler.py:555] PreSampling done
W20240213 00:49:09.546991 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240213 00:49:09.547187 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240213 00:49:09.547235 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240213 00:49:09.547276 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240213 00:49:09.547319 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240213 00:49:09.547366 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240213 00:49:09.547405 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240213 00:49:09.547456 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240213 00:49:09.547495 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240213 00:49:09.547541 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240213 00:49:09.547598 38549 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240213 00:49:09.547636 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240213 00:49:09.547675 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240213 00:49:09.547806 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240213 00:49:09.547852 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240213 00:49:09.547899 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240213 00:49:09.547956 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240213 00:49:09.548003 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240213 00:49:09.548066 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240213 00:49:09.548113 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240213 00:49:09.548163 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240213 00:49:09.548216 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240213 00:49:09.548255 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240213 00:49:09.548295 38549 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240213 00:49:09.548329 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240213 00:49:09.548362 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240213 00:49:09.548437 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240213 00:49:09.548496 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240213 00:49:09.548538 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240213 00:49:09.548584 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240213 00:49:09.548622 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240213 00:49:09.548661 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240213 00:49:09.548707 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240213 00:49:09.548746 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240213 00:49:09.548785 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240213 00:49:09.548831 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240213 00:49:09.548869 38549 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240213 00:49:09.548903 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240213 00:49:09.548936 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240213 00:49:09.549013 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240213 00:49:09.549060 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240213 00:49:09.549099 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240213 00:49:09.549155 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240213 00:49:09.549211 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240213 00:49:09.549257 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240213 00:49:09.549307 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240213 00:49:09.549355 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240213 00:49:09.549398 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240213 00:49:09.549445 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240213 00:49:09.549484 38549 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240213 00:49:09.549517 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240213 00:49:09.549551 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240213 00:49:09.549636 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240213 00:49:09.549679 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240213 00:49:09.549719 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240213 00:49:09.549763 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240213 00:49:09.549813 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240213 00:49:09.549862 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240213 00:49:09.549912 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240213 00:49:09.549955 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240213 00:49:09.549995 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240213 00:49:09.550038 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240213 00:49:09.550086 38549 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240213 00:49:09.550122 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240213 00:49:09.550156 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240213 00:49:09.550230 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240213 00:49:09.550280 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240213 00:49:09.550328 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240213 00:49:09.550367 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240213 00:49:09.550410 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240213 00:49:09.550452 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240213 00:49:09.550500 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240213 00:49:09.550545 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240213 00:49:09.550593 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240213 00:49:09.550642 38549 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240213 00:49:09.550681 38549 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240213 00:49:09.550719 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240213 00:49:09.550755 38549 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240213 00:49:09.799432 38549 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10001ca5a000 22.81 MB
W20240213 00:49:09.891753 38549 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10001e12c000 58.4 kB
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  835,   958,  1050,  ...,  2890,  2323, 10592]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.859 seconds
[Rank1] pid = 38755
[Rank2] pid = 38789
[Rank3] pid = 38883
[Rank4] pid = 38885
INFO [38549 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [38755 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [38789 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [38885 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [39011 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [38885 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [38883 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [39011 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [38883 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [38549 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240213 00:49:12.187044 39012 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240213 00:49:12.187991 39013 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240213 00:49:12.188023 38948 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240213 00:49:12.188021 38884 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
INFO [38755 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [38789 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240213 00:49:12.195510 38820 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240213 00:49:12.195510 38756 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240213 00:49:12.216876 39013 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10001e142000 7.629 MB
W20240213 00:49:12.216882 38948 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10001e8e5000 7.629 MB
W20240213 00:49:12.216890 38884 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10001f088000 7.629 MB
W20240213 00:49:12.217070 39013 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10001f82b000 7.629 MB
W20240213 00:49:12.217075 38948 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10001ffce000 7.629 MB
W20240213 00:49:12.217094 38884 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100020771000 7.629 MB
W20240213 00:49:12.217151 39013 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x100020f14000 1.49 GB
W20240213 00:49:12.217178 38948 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1000804f7000 1.49 GB
W20240213 00:49:12.217187 38884 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1000dfada000 1.49 GB
W20240213 00:49:12.217227 39013 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10013f0bd000 1.49 GB
W20240213 00:49:12.217236 38948 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10019e6a0000 1.49 GB
W20240213 00:49:12.217273 39013 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240213 00:49:12.217276 38884 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1001fdc83000 1.49 GB
W20240213 00:49:12.217290 38948 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240213 00:49:12.217319 38884 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240213 00:49:12.222432 38948 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240213 00:49:12.222434 39013 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240213 00:49:12.222496 38884 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240213 00:49:12.222638 39012 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10025d26e000 7.629 MB
W20240213 00:49:12.222795 39012 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10025da11000 7.629 MB
W20240213 00:49:12.222885 39012 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10025e1b4000 1.49 GB
W20240213 00:49:12.222939 39012 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1002bd797000 1.49 GB
W20240213 00:49:12.222985 39012 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240213 00:49:12.228986 39012 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240213 00:49:12.245280 38756 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10031cd86000 7.629 MB
W20240213 00:49:12.245491 38756 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10031d52b000 7.629 MB
W20240213 00:49:12.245565 38756 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10031dcce000 1.49 GB
W20240213 00:49:12.245621 38756 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10037da54000 1.49 GB
W20240213 00:49:12.245606 38820 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10037d2b1000 7.629 MB
W20240213 00:49:12.245674 38756 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240213 00:49:12.245767 38820 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1003dd037000 7.629 MB
W20240213 00:49:12.245836 38820 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1003dd7da000 1.49 GB
W20240213 00:49:12.245913 38820 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10043cdbd000 1.49 GB
W20240213 00:49:12.245962 38820 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240213 00:49:12.249259 38756 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240213 00:49:12.249301 38820 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x10001ca5a000
5: KnownLocalCachedEmbedding init done
WARNING [39011 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
1: KnownLocalCachedEmbedding init done
WARNING [38755 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
2: KnownLocalCachedEmbedding init done
WARNING [38789 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
4: KnownLocalCachedEmbedding init done
WARNING [38885 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
3: KnownLocalCachedEmbedding init done
WARNING [38883 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank5] pid = 39011
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
cudaHostRegister 0x10001ca5a000
0: KnownLocalCachedEmbedding init done
WARNING [38549 DistTensor.py:59] The tensor name already exists in the kvstore
I20240213 00:49:14.067680 39012 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240213 00:49:14.068367 38948 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240213 00:49:14.068454 38884 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240213 00:49:14.068521 38756 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240213 00:49:14.068612 39013 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240213 00:49:14.068699 38820 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
E20240213 00:49:14.692212 38948 recstore.cc:66] init folly done
E20240213 00:49:14.692744 39013 recstore.cc:66] init folly done
E20240213 00:49:14.692788 38756 recstore.cc:66] init folly done
E20240213 00:49:14.692793 39012 recstore.cc:66] init folly done
E20240213 00:49:14.692860 38820 recstore.cc:66] init folly done
E20240213 00:49:14.692963 38884 recstore.cc:66] init folly done
I20240213 00:49:14.776968 38820 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240213 00:49:14.783293 38756 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 00:49:14.784950 38884 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 00:49:14.786137 39013 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 00:49:14.787549 38948 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 00:49:14.793759 39012 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 721.526 us                | 721.526 us                |
| Forward                   | 446.816 ms                | 446.816 ms                |
| back: bucket keys         | 21.241 ms                 | 21.241 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 721.526 us                | 721.526 us                |
| Forward                   | 446.816 ms                | 446.816 ms                |
| back: bucket keys         | 21.241 ms                 | 21.241 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 721.526 us                | 721.526 us                |
| Forward                   | 446.816 ms                | 446.816 ms                |
| back: bucket keys         | 21.241 ms                 | 21.241 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 721.526 us                | 721.526 us                |
| Forward                   | 446.816 ms                | 446.816 ms                |
| back: bucket keys         | 21.241 ms                 | 21.241 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 721.526 us                | 721.526 us                |
| Forward                   | 446.816 ms                | 446.816 ms                |
| back: bucket keys         | 21.241 ms                 | 21.241 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 721.526 us                | 721.526 us                |
| Forward                   | 446.816 ms                | 446.816 ms                |
| back: bucket keys         | 21.241 ms                 | 21.241 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 721.526 us                | 721.526 us                |
| Forward                   | 446.816 ms                | 446.816 ms                |
| back: bucket keys         | 21.241 ms                 | 21.241 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 721.526 us                | 721.526 us                |
| Forward                   | 446.816 ms                | 446.816 ms                |
| back: bucket keys         | 21.241 ms                 | 21.241 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 721.526 us                | 721.526 us                |
| Forward                   | 446.816 ms                | 446.816 ms                |
| back: bucket keys         | 21.241 ms                 | 21.241 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.655 ms                  | 22.754 ms                 |
| Forward                   | 4.856 ms                  | 446.816 ms                |
| back: bucket keys         | 584.602 us                | 21.241 ms                 |
| back: a2a                 | 6.980 ms                  | 45.417 s                  |
| back: cache               | 3.817 ms                  | 8.846 ms                  |
| back: aggr dram keys      | 33.802 ms                 | 748.977 ms                |
| back: set dram grad       | 2.038 ms                  | 7.147 ms                  |
| Backward                  | 105.229 ms                | 46.516 s                  |
| Optimize                  | 24.409 ms                 | 63.863 ms                 |
| BarrierTimeBeforeRank0    | 79.535 us                 | 103.352 us                |
| BlockToStepN              | 53.890 us                 | 843.386 us                |
| OneStep                   | 139.041 ms                | 47.030 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.885 ms                  | 19.764 ms                 |
| Forward                   | 5.031 ms                  | 12.843 ms                 |
| back: bucket keys         | 510.693 us                | 1.485 ms                  |
| back: a2a                 | 6.980 ms                  | 20.888 ms                 |
| back: cache               | 3.594 ms                  | 7.457 ms                  |
| back: aggr dram keys      | 33.819 ms                 | 47.363 ms                 |
| back: set dram grad       | 2.074 ms                  | 7.147 ms                  |
| Backward                  | 104.360 ms                | 142.322 ms                |
| Optimize                  | 24.695 ms                 | 34.021 ms                 |
| BarrierTimeBeforeRank0    | 60.341 us                 | 192.807 us                |
| BlockToStepN              | 35.928 us                 | 843.386 us                |
| OneStep                   | 139.041 ms                | 180.161 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.885 ms                  | 21.218 ms                 |
| Forward                   | 4.967 ms                  | 12.843 ms                 |
| back: bucket keys         | 530.958 us                | 1.449 ms                  |
| back: a2a                 | 8.138 ms                  | 20.241 ms                 |
| back: cache               | 3.699 ms                  | 6.042 ms                  |
| back: aggr dram keys      | 33.903 ms                 | 47.148 ms                 |
| back: set dram grad       | 2.074 ms                  | 7.098 ms                  |
| Backward                  | 104.719 ms                | 142.322 ms                |
| Optimize                  | 24.578 ms                 | 34.021 ms                 |
| BarrierTimeBeforeRank0    | 55.940 us                 | 192.807 us                |
| BlockToStepN              | 35.928 us                 | 982.667 us                |
| OneStep                   | 138.459 ms                | 185.608 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 61.219, sample: 0.369, forward: 0.884, backward: 54.971, update: 0.392
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 61.218, sample: 0.368, forward: 0.861, backward: 54.987, update: 0.333
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 61.221, sample: 0.370, forward: 0.914, backward: 54.928, update: 0.232
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 61.216, sample: 0.368, forward: 0.875, backward: 54.969, update: 0.379
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 61.227, sample: 0.377, forward: 0.886, backward: 54.944, update: 0.245
train_sampler.Prefill()
-------Step 0-------
tensor([    4,  7491,  8366,   919, 12664,  4849,    65,  7783,  5017,  1790]) tensor([ 1050,   115,  5557,  7239,    19,  5363, 11239, 13905,  1633, 10179])
-------Step 1-------
tensor([    4,  7491,  8366,   919, 12664,  4849,    65,  7783,  5017,  1790]) tensor([ 5924,  1698,  6190,  2391,  2991,  7894, 13689,  8269, 13316, 14611])
-------Step 2-------
tensor([ 6734,    73,    56,    13,  9195,  3665, 10132,  9109,  5256,  2964]) tensor([ 7520,  2643,  1311,  6273,  4683,  9597, 12387,  6569,  7619,  8079])
-------Step 3-------
tensor([ 6734,    73,    56,    13,  9195,  3665, 10132,  9109,  5256,  2964]) tensor([10516, 11921,  6282,  6408, 10425,  9258, 14697,  7319, 10212, 13483])
-------Step 4-------
tensor([14554, 11087,  8989, 13871, 11569,  9219,   113, 10686, 12664,  8590]) tensor([11785,  2277,  8226,  1419,  2186,  2251, 14192, 11875,  7041,  4109])
-------Step 5-------
tensor([14554, 11087,  8989, 13871, 11569,  9219,   113, 10686, 12664,  8590]) tensor([ 3471, 14600,  9559,  8785, 14537,  4853,  3274, 11792, 14814,  7970])
-------Step 6-------
tensor([14204,  2774, 13615,   757, 11986, 11399,  8933, 13538,   110,  8758]) tensor([ 1396,  2293,  7093, 11889,  5747,  4477,  7364, 10816,  9548,  8445])
-------Step 7-------
tensor([14204,  2774, 13615,   757, 11986, 11399,  8933, 13538,   110,  8758]) tensor([10440,  1679,  5594, 13833,  5522,  9968,  6555,  9367,  2504, 12063])
-------Step 8-------
tensor([ 4033, 10937, 14386,  7961,  8365,  7901, 12211, 13152,  2209, 10671]) tensor([ 4965,  2952,  6451,  3305,  8353,  4939,  5919,  5608, 10845,  1951])
-------Step 9-------
tensor([ 4033, 10937, 14386,  7961,  8365,  7901, 12211, 13152,  2209, 10671]) tensor([ 1835,  7548,  8908,  8428,  5883, 12037,  1526,  1394, 13316,  5931])
before start barrier
start train
[proc 0] 100 steps, total: 61.210, sample: 0.436, forward: 0.956, backward: 57.161, update: 2.535
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.029 ms                  | 21.218 ms                 |
| Forward                   | 4.856 ms                  | 12.843 ms                 |
| back: bucket keys         | 540.257 us                | 1.485 ms                  |
| back: a2a                 | 8.521 ms                  | 20.241 ms                 |
| back: cache               | 3.802 ms                  | 6.042 ms                  |
| back: aggr dram keys      | 33.903 ms                 | 47.363 ms                 |
| back: set dram grad       | 2.087 ms                  | 7.098 ms                  |
| Backward                  | 105.244 ms                | 142.322 ms                |
| Optimize                  | 24.578 ms                 | 34.021 ms                 |
| BarrierTimeBeforeRank0    | 53.601 us                 | 192.807 us                |
| BlockToStepN              | 32.709 us                 | 2.735 ms                  |
| OneStep                   | 138.980 ms                | 185.608 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.905 ms                  | 20.404 ms                 |
| Forward                   | 4.743 ms                  | 11.883 ms                 |
| back: bucket keys         | 547.171 us                | 1.558 ms                  |
| back: a2a                 | 8.502 ms                  | 20.241 ms                 |
| back: cache               | 3.802 ms                  | 6.283 ms                  |
| back: aggr dram keys      | 34.111 ms                 | 47.148 ms                 |
| back: set dram grad       | 2.063 ms                  | 7.009 ms                  |
| Backward                  | 105.415 ms                | 127.105 ms                |
| Optimize                  | 24.177 ms                 | 33.781 ms                 |
| BarrierTimeBeforeRank0    | 52.188 us                 | 189.144 us                |
| BlockToStepN              | 29.376 us                 | 982.667 us                |
| OneStep                   | 138.147 ms                | 180.161 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.905 ms                  | 20.404 ms                 |
| Forward                   | 4.729 ms                  | 11.883 ms                 |
| back: bucket keys         | 547.886 us                | 1.558 ms                  |
| back: a2a                 | 8.502 ms                  | 23.272 ms                 |
| back: cache               | 3.792 ms                  | 6.042 ms                  |
| back: aggr dram keys      | 34.180 ms                 | 47.148 ms                 |
| back: set dram grad       | 2.054 ms                  | 6.960 ms                  |
| Backward                  | 105.816 ms                | 132.877 ms                |
| Optimize                  | 24.177 ms                 | 35.666 ms                 |
| BarrierTimeBeforeRank0    | 51.626 us                 | 189.144 us                |
| BlockToStepN              | 27.000 us                 | 1.328 ms                  |
| OneStep                   | 138.920 ms                | 185.608 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 14.237, sample: 0.373, forward: 0.403, backward: 8.706, update: 0.333
[proc 4] 200 steps, total: 14.237, sample: 0.383, forward: 0.394, backward: 8.678, update: 0.331
[proc 1] 200 steps, total: 14.237, sample: 0.378, forward: 0.434, backward: 8.645, update: 0.205
[proc 0] 200 steps, total: 14.237, sample: 0.440, forward: 0.462, backward: 10.834, update: 2.391
[proc 2] 200 steps, total: 14.237, sample: 0.393, forward: 0.422, backward: 8.617, update: 0.220
[proc 5] 200 steps, total: 14.237, sample: 0.373, forward: 0.382, backward: 8.689, update: 0.299
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.897 ms                  | 22.119 ms                 |
| Forward                   | 4.712 ms                  | 11.883 ms                 |
| back: bucket keys         | 547.886 us                | 1.510 ms                  |
| back: a2a                 | 8.502 ms                  | 30.545 ms                 |
| back: cache               | 3.747 ms                  | 5.929 ms                  |
| back: aggr dram keys      | 34.144 ms                 | 45.916 ms                 |
| back: set dram grad       | 2.058 ms                  | 6.960 ms                  |
| Backward                  | 106.065 ms                | 137.912 ms                |
| Optimize                  | 23.964 ms                 | 35.666 ms                 |
| BarrierTimeBeforeRank0    | 50.315 us                 | 189.144 us                |
| BlockToStepN              | 27.130 us                 | 1.328 ms                  |
| OneStep                   | 139.361 ms                | 185.608 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.924 ms                  | 22.119 ms                 |
| Forward                   | 4.731 ms                  | 11.883 ms                 |
| back: bucket keys         | 555.515 us                | 1.806 ms                  |
| back: a2a                 | 8.537 ms                  | 30.545 ms                 |
| back: cache               | 3.773 ms                  | 5.929 ms                  |
| back: aggr dram keys      | 34.183 ms                 | 45.916 ms                 |
| back: set dram grad       | 2.063 ms                  | 7.009 ms                  |
| Backward                  | 106.603 ms                | 134.043 ms                |
| Optimize                  | 24.242 ms                 | 34.021 ms                 |
| BarrierTimeBeforeRank0    | 49.766 us                 | 189.144 us                |
| BlockToStepN              | 28.114 us                 | 982.667 us                |
| OneStep                   | 140.861 ms                | 180.161 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.932 ms                  | 22.119 ms                 |
| Forward                   | 4.748 ms                  | 11.883 ms                 |
| back: bucket keys         | 555.515 us                | 1.656 ms                  |
| back: a2a                 | 8.502 ms                  | 30.993 ms                 |
| back: cache               | 3.775 ms                  | 5.929 ms                  |
| back: aggr dram keys      | 34.140 ms                 | 45.916 ms                 |
| back: set dram grad       | 2.058 ms                  | 6.972 ms                  |
| Backward                  | 107.016 ms                | 135.126 ms                |
| Optimize                  | 24.445 ms                 | 35.666 ms                 |
| BarrierTimeBeforeRank0    | 49.766 us                 | 189.144 us                |
| BlockToStepN              | 27.496 us                 | 982.667 us                |
| OneStep                   | 141.780 ms                | 180.161 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 300 steps, total: 14.886, sample: 0.358, forward: 0.403, backward: 9.126, update: 0.320
[proc 3] 300 steps, total: 14.886, sample: 0.357, forward: 0.397, backward: 9.153, update: 0.352
[proc 0] 300 steps, total: 14.886, sample: 0.423, forward: 0.493, backward: 11.287, update: 2.567
[proc 4] 300 steps, total: 14.886, sample: 0.338, forward: 0.411, backward: 9.137, update: 0.306
Successfully xmh. training takes 90.33391857147217 seconds
before call kg_cache_controller.StopThreads()
[proc 2] 300 steps, total: 14.886, sample: 0.358, forward: 0.417, backward: 9.135, update: 0.330
[proc 1] 300 steps, total: 14.886, sample: 0.400, forward: 0.420, backward: 9.056, update: 0.204
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
INFO [38549 controller_process.py:421] call rank0 to StopThreads
