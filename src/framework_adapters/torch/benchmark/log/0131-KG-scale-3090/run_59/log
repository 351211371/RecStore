WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240203 04:41:33.600330 45679 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_53', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [45679 sampler.py:454] Start PreSampling
WARNING [45679 sampler.py:532] Before construct renumbering_dict
WARNING [45679 sampler.py:555] PreSampling done
W20240203 04:57:53.874673 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240203 04:57:53.874881 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240203 04:57:53.874918 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240203 04:57:53.874953 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240203 04:57:53.874984 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240203 04:57:53.875015 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240203 04:57:53.875051 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240203 04:57:53.875098 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240203 04:57:53.875136 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240203 04:57:53.875165 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240203 04:57:53.875200 45679 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240203 04:57:53.875226 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240203 04:57:53.875254 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240203 04:57:53.875417 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240203 04:57:53.875459 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240203 04:57:53.875491 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240203 04:57:53.875538 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240203 04:57:53.875568 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240203 04:57:53.875608 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240203 04:57:53.875640 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240203 04:57:53.875674 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240203 04:57:53.875702 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240203 04:57:53.875730 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240203 04:57:53.875754 45679 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240203 04:57:53.875777 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240203 04:57:53.875806 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240203 04:57:53.875862 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240203 04:57:53.875893 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240203 04:57:53.875921 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240203 04:57:53.875946 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240203 04:57:53.875977 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240203 04:57:53.876003 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240203 04:57:53.876036 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240203 04:57:53.876075 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240203 04:57:53.876107 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240203 04:57:53.876137 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240203 04:57:53.876161 45679 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240203 04:57:53.876183 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240203 04:57:53.876209 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240203 04:57:53.876271 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240203 04:57:53.876305 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240203 04:57:53.876335 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240203 04:57:53.876367 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240203 04:57:53.876399 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240203 04:57:53.876427 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240203 04:57:53.876462 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240203 04:57:53.876497 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240203 04:57:53.876529 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240203 04:57:53.876559 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240203 04:57:53.876593 45679 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240203 04:57:53.876616 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240203 04:57:53.876637 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240203 04:57:53.876693 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240203 04:57:53.876724 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240203 04:57:53.876760 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240203 04:57:53.876786 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240203 04:57:53.876814 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240203 04:57:53.876842 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240203 04:57:53.876869 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240203 04:57:53.876896 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240203 04:57:53.876932 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240203 04:57:53.876960 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240203 04:57:53.876989 45679 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240203 04:57:53.877012 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240203 04:57:53.877033 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240203 04:57:53.877082 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240203 04:57:53.877126 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240203 04:57:53.877153 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240203 04:57:53.877180 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240203 04:57:53.877207 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240203 04:57:53.877236 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240203 04:57:53.877266 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240203 04:57:53.877295 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240203 04:57:53.877324 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240203 04:57:53.877357 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240203 04:57:53.877388 45679 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240203 04:57:53.877409 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240203 04:57:53.877436 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240203 04:57:53.877486 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240203 04:57:53.877521 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240203 04:57:53.877552 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240203 04:57:53.877588 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240203 04:57:53.877621 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240203 04:57:53.877650 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240203 04:57:53.877682 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240203 04:57:53.877712 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240203 04:57:53.877744 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240203 04:57:53.877775 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240203 04:57:53.877808 45679 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240203 04:57:53.877831 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240203 04:57:53.877853 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240203 04:57:53.877908 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240203 04:57:53.877943 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240203 04:57:53.877975 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240203 04:57:53.878003 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240203 04:57:53.878031 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240203 04:57:53.878069 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240203 04:57:53.878096 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240203 04:57:53.878130 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240203 04:57:53.878165 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240203 04:57:53.878204 45679 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240203 04:57:53.878233 45679 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240203 04:57:53.878257 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240203 04:57:53.878278 45679 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240203 04:57:54.322903 45679 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240203 05:06:37.403515 45679 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302734,  4302772,    92200,  ..., 54907168, 51599658,  4915963]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2014.127 seconds
[Rank1] pid = 4419
[Rank2] pid = 4513
[Rank3] pid = 4582
[Rank4] pid = 4738
[Rank5] pid = 4943
[Rank6] pid = 5082
INFO [45679 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [4419 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [4513 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [4582 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [4738 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [4943 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [5270 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [5082 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [4738 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [4582 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [4943 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [4513 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [5270 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [5082 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [45679 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [4419 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [45679 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [4419 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [4582 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [4738 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [4943 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [5270 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [4513 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [5082 DistTensor.py:59] The tensor name already exists in the kvstore
I20240203 05:15:29.666899  5083 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240203 05:15:29.667151  4739 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 05:15:29.667276  4962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 05:15:29.667418  4420 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 05:15:29.667541  4514 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 05:15:29.667677  4583 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 05:15:29.669291  5274 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 05:15:29.669497  5310 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240203 05:15:30.489315  5083 recstore.cc:66] init folly done
E20240203 05:15:30.489717  4420 recstore.cc:66] init folly done
E20240203 05:15:30.489995  4583 recstore.cc:66] init folly done
E20240203 05:15:30.490132  4739 recstore.cc:66] init folly done
E20240203 05:15:30.490170  4514 recstore.cc:66] init folly done
E20240203 05:15:30.490208  5310 recstore.cc:66] init folly done
E20240203 05:15:30.490214  5274 recstore.cc:66] init folly done
E20240203 05:15:30.490218  4962 recstore.cc:66] init folly done
I20240203 05:15:36.405318  4739 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240203 05:15:37.085297  5310 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 05:15:37.321380  4962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 05:15:37.337438  4514 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 05:15:38.235523  4420 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 05:15:38.472939  4583 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 05:15:39.192255  5274 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 05:15:40.402038  5083 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.478 ms                 | 36.990 ms                 |
| bucket keys               | 3.716 ms                  | 142.554 ms                |
| forward: a2a keys         | 6.856 ms                  | 1.356 s                   |
| forward: search cache     | 465.585 us                | 28.372 ms                 |
| forward: a2a values       | 7.928 ms                  | 49.368 ms                 |
| forward: join             | 2.242 ms                  | 4.117 ms                  |
| Forward                   | 67.502 ms                 | 2.116 s                   |
| back: aggr dram keys      | 36.466 ms                 | 967.986 ms                |
| back: set dram grad       | 2.199 ms                  | 29.737 ms                 |
| back: a2a grad            | 14.260 ms                 | 57.074 ms                 |
| back: grad sum & grad cache  | 5.294 ms                  | 150.484 ms                |
| Backward                  | 320.988 ms                | 1.416 s                   |
| Optimize                  | 27.703 ms                 | 36.891 ms                 |
| BarrierTimeBeforeRank0    | 55.530 us                 | 165.101 us                |
| BlockToStepN              | 64.020 us                 | 85.754 us                 |
| OneStep                   | 424.904 ms                | 3.608 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.568 ms                  | 104.281 ms                |
| bucket keys               | 3.643 ms                  | 142.554 ms                |
| forward: a2a keys         | 6.659 ms                  | 1.356 s                   |
| forward: search cache     | 467.532 us                | 28.372 ms                 |
| forward: a2a values       | 7.928 ms                  | 49.368 ms                 |
| forward: join             | 2.242 ms                  | 4.117 ms                  |
| Forward                   | 57.876 ms                 | 2.116 s                   |
| back: aggr dram keys      | 58.661 ms                 | 967.986 ms                |
| back: set dram grad       | 4.420 ms                  | 29.737 ms                 |
| back: a2a grad            | 23.399 ms                 | 57.074 ms                 |
| back: grad sum & grad cache  | 5.631 ms                  | 150.484 ms                |
| Backward                  | 257.426 ms                | 1.416 s                   |
| Optimize                  | 27.062 ms                 | 37.170 ms                 |
| BarrierTimeBeforeRank0    | 51.920 us                 | 165.101 us                |
| BlockToStepN              | 64.112 us                 | 85.754 us                 |
| OneStep                   | 354.944 ms                | 3.608 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.157 ms                  | 104.281 ms                |
| bucket keys               | 3.585 ms                  | 4.352 ms                  |
| forward: a2a keys         | 7.184 ms                  | 35.714 ms                 |
| forward: search cache     | 469.224 us                | 729.900 us                |
| forward: a2a values       | 12.823 ms                 | 39.180 ms                 |
| forward: join             | 2.242 ms                  | 3.675 ms                  |
| Forward                   | 59.296 ms                 | 2.116 s                   |
| back: aggr dram keys      | 46.613 ms                 | 87.395 ms                 |
| back: set dram grad       | 2.199 ms                  | 12.384 ms                 |
| back: a2a grad            | 22.814 ms                 | 28.553 ms                 |
| back: grad sum & grad cache  | 5.631 ms                  | 147.245 ms                |
| Backward                  | 262.384 ms                | 1.416 s                   |
| Optimize                  | 27.682 ms                 | 37.170 ms                 |
| BarrierTimeBeforeRank0    | 48.824 us                 | 165.101 us                |
| BlockToStepN              | 64.350 us                 | 10.513 ms                 |
| OneStep                   | 367.794 ms                | 3.608 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.133 ms                  | 108.418 ms                |
| bucket keys               | 3.585 ms                  | 4.352 ms                  |
| forward: a2a keys         | 7.445 ms                  | 39.754 ms                 |
| forward: search cache     | 470.309 us                | 1.228 ms                  |
| forward: a2a values       | 16.921 ms                 | 39.180 ms                 |
| forward: join             | 2.242 ms                  | 4.117 ms                  |
| Forward                   | 63.039 ms                 | 2.116 s                   |
| back: aggr dram keys      | 46.613 ms                 | 110.745 ms                |
| back: set dram grad       | 2.404 ms                  | 13.665 ms                 |
| back: a2a grad            | 23.399 ms                 | 56.119 ms                 |
| back: grad sum & grad cache  | 6.572 ms                  | 147.245 ms                |
| Backward                  | 262.384 ms                | 1.416 s                   |
| Optimize                  | 27.410 ms                 | 40.642 ms                 |
| BarrierTimeBeforeRank0    | 48.622 us                 | 165.101 us                |
| BlockToStepN              | 64.112 us                 | 20.767 ms                 |
| OneStep                   | 368.157 ms                | 3.608 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.155 ms                  | 108.418 ms                |
| bucket keys               | 3.593 ms                  | 5.414 ms                  |
| forward: a2a keys         | 7.201 ms                  | 43.249 ms                 |
| forward: search cache     | 471.267 us                | 1.228 ms                  |
| forward: a2a values       | 16.921 ms                 | 39.180 ms                 |
| forward: join             | 2.707 ms                  | 4.117 ms                  |
| Forward                   | 63.039 ms                 | 114.974 ms                |
| back: aggr dram keys      | 58.661 ms                 | 110.745 ms                |
| back: set dram grad       | 4.033 ms                  | 13.665 ms                 |
| back: a2a grad            | 23.379 ms                 | 56.119 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 147.245 ms                |
| Backward                  | 259.696 ms                | 320.988 ms                |
| Optimize                  | 27.410 ms                 | 37.465 ms                 |
| BarrierTimeBeforeRank0    | 47.324 us                 | 78.540 us                 |
| BlockToStepN              | 64.143 us                 | 15.862 ms                 |
| OneStep                   | 367.794 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.538 ms                  | 108.418 ms                |
| bucket keys               | 3.585 ms                  | 6.500 ms                  |
| forward: a2a keys         | 6.446 ms                  | 43.249 ms                 |
| forward: search cache     | 470.309 us                | 1.235 ms                  |
| forward: a2a values       | 16.916 ms                 | 39.180 ms                 |
| forward: join             | 2.707 ms                  | 5.812 ms                  |
| Forward                   | 58.067 ms                 | 114.974 ms                |
| back: aggr dram keys      | 46.613 ms                 | 110.745 ms                |
| back: set dram grad       | 2.404 ms                  | 13.665 ms                 |
| back: a2a grad            | 23.379 ms                 | 56.119 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 147.245 ms                |
| Backward                  | 257.426 ms                | 320.988 ms                |
| Optimize                  | 27.289 ms                 | 37.465 ms                 |
| BarrierTimeBeforeRank0    | 45.920 us                 | 78.540 us                 |
| BlockToStepN              | 62.964 us                 | 15.862 ms                 |
| OneStep                   | 360.876 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.392 ms                  | 108.418 ms                |
| bucket keys               | 3.467 ms                  | 6.500 ms                  |
| forward: a2a keys         | 5.965 ms                  | 40.796 ms                 |
| forward: search cache     | 470.317 us                | 1.235 ms                  |
| forward: a2a values       | 16.916 ms                 | 36.022 ms                 |
| forward: join             | 2.838 ms                  | 4.117 ms                  |
| Forward                   | 58.067 ms                 | 114.974 ms                |
| back: aggr dram keys      | 48.132 ms                 | 90.733 ms                 |
| back: set dram grad       | 2.598 ms                  | 13.665 ms                 |
| back: a2a grad            | 23.399 ms                 | 50.973 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 147.245 ms                |
| Backward                  | 257.426 ms                | 320.988 ms                |
| Optimize                  | 26.985 ms                 | 37.465 ms                 |
| BarrierTimeBeforeRank0    | 44.771 us                 | 78.540 us                 |
| BlockToStepN              | 62.563 us                 | 15.862 ms                 |
| OneStep                   | 360.810 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.104 ms                  | 128.933 ms                |
| bucket keys               | 3.343 ms                  | 6.500 ms                  |
| forward: a2a keys         | 5.965 ms                  | 40.796 ms                 |
| forward: search cache     | 470.641 us                | 1.285 ms                  |
| forward: a2a values       | 16.921 ms                 | 36.022 ms                 |
| forward: join             | 2.242 ms                  | 5.384 ms                  |
| Forward                   | 58.741 ms                 | 114.974 ms                |
| back: aggr dram keys      | 48.132 ms                 | 91.744 ms                 |
| back: set dram grad       | 3.624 ms                  | 13.665 ms                 |
| back: a2a grad            | 23.399 ms                 | 51.220 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 147.245 ms                |
| Backward                  | 257.426 ms                | 326.019 ms                |
| Optimize                  | 27.062 ms                 | 44.894 ms                 |
| BarrierTimeBeforeRank0    | 43.911 us                 | 78.540 us                 |
| BlockToStepN              | 62.560 us                 | 15.862 ms                 |
| OneStep                   | 360.876 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 41.895, sample: 1.136, forward: 9.489, backward: 16.053, update: 0.402
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 43.045, sample: 1.343, forward: 9.277, backward: 15.542, update: 0.407
[Rank7] pid = 5270
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
train_sampler.Prefill()
-------Step 0-------
tensor([   42848,    42873,    42901,    42932,  5402231,    90884, 48544050,
        17282469, 22882518,    42968]) tensor([ 4899799, 15317914, 67936349, 81488420, 21391549, 28466454, 32836458,
        81364820, 62998545, 31665974])
-------Step 1-------
tensor([   42848,    42873,    42901,    42932,  5402231,    90884, 48544050,
        17282469, 22882518,    42968]) tensor([59670093, 31237444, 10139361, 72458073, 72956989, 41949623, 67870368,
        41720592, 34585573, 13470012])
-------Step 2-------
tensor([  105661,   105682,   105713,    32437,   105739,   105762,   105789,
        23993033,   105813,   105837]) tensor([79646200, 25622133, 72247163, 54173232, 37396402, 31540270, 59904182,
        46382464, 14300787, 40908113])
-------Step 3-------
tensor([  105661,   105682,   105713,    32437,   105739,   105762,   105789,
        23993033,   105813,   105837]) tensor([44423012, 84921440, 37293405, 34156437, 73833930, 74142647, 34142493,
        16306266, 28236134,   693564])
-------Step 4-------
tensor([  170729, 51375148,   170758,   114583,   170783,   114613,   170809,
        35571112,   170840,   170866]) tensor([83564974, 10538845, 74926802, 18700344, 62954186, 40717054, 67459483,
        33534038, 85443744, 59149248])
-------Step 5-------
tensor([  170729, 51375148,   170758,   114583,   170783,   114613,   170809,
        35571112,   170840,   170866]) tensor([31900268, 82721633,   209575, 72728291, 51934253, 49367959, 14863994,
        10228199, 78121458, 37016978])
-------Step 6-------
tensor([  234971,    67690,   234998,   235019,    67723, 75107409,   235044,
          235072,   126616, 32601991]) tensor([13037693, 41100474, 37680031, 83333997, 30402945, 32875957, 23253056,
         7125364, 77299962, 84938917])
-------Step 7-------
tensor([  234971,    67690,   234998,   235019,    67723, 75107409,   235044,
          235072,   126616, 32601991]) tensor([26624318, 59900843, 79872647, 50834252, 74319295, 45623679, 60844286,
        50427016, 38267009, 28101050])
-------Step 8-------
tensor([  297772, 22561458,   297799,   137800,   297824,    84289,   297848,
          297874,   297901,   297928]) tensor([39123199, 26562651, 31874629,  1882309, 56535434, 61740772, 14137059,
        63786080,  1474050, 69987765])
-------Step 9-------
tensor([  297772, 22561458,   297799,   137800,   297824,    84289,   297848,
          297874,   297901,   297928]) tensor([56373670, 33485099, 14014985, 49305131,  9750731, 43507400, 25206921,
        34637245, 85245815, 77453123])
before start barrier
start train
[proc 0] 100 steps, total: 40.938, sample: 1.599, forward: 8.449, backward: 26.754, update: 2.734
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 42.793, sample: 1.077, forward: 9.542, backward: 15.614, update: 0.428
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 41.657, sample: 1.202, forward: 9.429, backward: 15.558, update: 0.412
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 39.728, sample: 1.234, forward: 9.355, backward: 15.322, update: 0.464
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 42.809, sample: 1.258, forward: 9.395, backward: 15.265, update: 0.391
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 43.725, sample: 1.212, forward: 9.389, backward: 15.280, update: 0.463
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.133 ms                  | 128.933 ms                |
| bucket keys               | 3.546 ms                  | 6.660 ms                  |
| forward: a2a keys         | 6.218 ms                  | 42.485 ms                 |
| forward: search cache     | 470.640 us                | 2.561 ms                  |
| forward: a2a values       | 16.892 ms                 | 39.180 ms                 |
| forward: join             | 2.691 ms                  | 5.384 ms                  |
| Forward                   | 59.296 ms                 | 114.974 ms                |
| back: aggr dram keys      | 48.132 ms                 | 110.745 ms                |
| back: set dram grad       | 3.624 ms                  | 13.665 ms                 |
| back: a2a grad            | 23.320 ms                 | 51.220 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 147.245 ms                |
| Backward                  | 257.548 ms                | 326.019 ms                |
| Optimize                  | 27.186 ms                 | 44.894 ms                 |
| BarrierTimeBeforeRank0    | 43.386 us                 | 78.540 us                 |
| BlockToStepN              | 62.563 us                 | 15.862 ms                 |
| OneStep                   | 362.290 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.155 ms                  | 128.933 ms                |
| bucket keys               | 3.343 ms                  | 6.573 ms                  |
| forward: a2a keys         | 6.207 ms                  | 42.485 ms                 |
| forward: search cache     | 470.277 us                | 1.285 ms                  |
| forward: a2a values       | 16.891 ms                 | 36.022 ms                 |
| forward: join             | 2.242 ms                  | 4.117 ms                  |
| Forward                   | 57.876 ms                 | 114.974 ms                |
| back: aggr dram keys      | 50.512 ms                 | 91.744 ms                 |
| back: set dram grad       | 3.624 ms                  | 12.533 ms                 |
| back: a2a grad            | 23.320 ms                 | 50.973 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 143.897 ms                |
| Backward                  | 255.911 ms                | 326.019 ms                |
| Optimize                  | 27.186 ms                 | 44.894 ms                 |
| BarrierTimeBeforeRank0    | 43.621 us                 | 78.540 us                 |
| BlockToStepN              | 62.964 us                 | 15.862 ms                 |
| OneStep                   | 356.479 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.133 ms                  | 128.933 ms                |
| bucket keys               | 3.343 ms                  | 6.573 ms                  |
| forward: a2a keys         | 6.289 ms                  | 43.249 ms                 |
| forward: search cache     | 470.251 us                | 1.285 ms                  |
| forward: a2a values       | 16.891 ms                 | 36.022 ms                 |
| forward: join             | 2.242 ms                  | 5.812 ms                  |
| Forward                   | 58.067 ms                 | 115.867 ms                |
| back: aggr dram keys      | 51.032 ms                 | 107.287 ms                |
| back: set dram grad       | 3.624 ms                  | 12.533 ms                 |
| back: a2a grad            | 23.320 ms                 | 51.220 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 143.897 ms                |
| Backward                  | 255.911 ms                | 326.019 ms                |
| Optimize                  | 27.225 ms                 | 44.894 ms                 |
| BarrierTimeBeforeRank0    | 43.621 us                 | 78.540 us                 |
| BlockToStepN              | 62.563 us                 | 15.862 ms                 |
| OneStep                   | 356.255 ms                | 513.987 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.895 ms                  | 128.225 ms                |
| bucket keys               | 3.343 ms                  | 6.660 ms                  |
| forward: a2a keys         | 6.415 ms                  | 45.409 ms                 |
| forward: search cache     | 469.917 us                | 1.285 ms                  |
| forward: a2a values       | 16.779 ms                 | 36.022 ms                 |
| forward: join             | 2.242 ms                  | 5.812 ms                  |
| Forward                   | 57.872 ms                 | 114.974 ms                |
| back: aggr dram keys      | 53.735 ms                 | 107.287 ms                |
| back: set dram grad       | 3.624 ms                  | 12.533 ms                 |
| back: a2a grad            | 23.276 ms                 | 51.220 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 147.245 ms                |
| Backward                  | 254.934 ms                | 326.019 ms                |
| Optimize                  | 27.257 ms                 | 43.539 ms                 |
| BarrierTimeBeforeRank0    | 43.009 us                 | 70.092 us                 |
| BlockToStepN              | 62.453 us                 | 13.830 ms                 |
| OneStep                   | 355.870 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.765 ms                  | 128.225 ms                |
| bucket keys               | 3.464 ms                  | 6.660 ms                  |
| forward: a2a keys         | 6.289 ms                  | 45.409 ms                 |
| forward: search cache     | 469.737 us                | 1.285 ms                  |
| forward: a2a values       | 16.768 ms                 | 36.022 ms                 |
| forward: join             | 2.242 ms                  | 5.812 ms                  |
| Forward                   | 57.742 ms                 | 114.974 ms                |
| back: aggr dram keys      | 51.802 ms                 | 107.287 ms                |
| back: set dram grad       | 3.572 ms                  | 13.665 ms                 |
| back: a2a grad            | 23.276 ms                 | 51.220 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 147.245 ms                |
| Backward                  | 253.102 ms                | 326.019 ms                |
| Optimize                  | 27.327 ms                 | 43.539 ms                 |
| BarrierTimeBeforeRank0    | 42.507 us                 | 72.482 us                 |
| BlockToStepN              | 61.961 us                 | 13.830 ms                 |
| OneStep                   | 354.999 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.773 ms                  | 128.225 ms                |
| bucket keys               | 3.251 ms                  | 6.660 ms                  |
| forward: a2a keys         | 6.289 ms                  | 43.249 ms                 |
| forward: search cache     | 469.463 us                | 1.235 ms                  |
| forward: a2a values       | 15.989 ms                 | 32.794 ms                 |
| forward: join             | 2.242 ms                  | 5.384 ms                  |
| Forward                   | 57.702 ms                 | 114.974 ms                |
| back: aggr dram keys      | 53.735 ms                 | 91.744 ms                 |
| back: set dram grad       | 3.572 ms                  | 12.533 ms                 |
| back: a2a grad            | 23.026 ms                 | 50.973 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 143.897 ms                |
| Backward                  | 251.346 ms                | 326.019 ms                |
| Optimize                  | 27.389 ms                 | 44.150 ms                 |
| BarrierTimeBeforeRank0    | 42.543 us                 | 72.482 us                 |
| BlockToStepN              | 61.888 us                 | 13.830 ms                 |
| OneStep                   | 353.002 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.626 ms                  | 128.225 ms                |
| bucket keys               | 3.251 ms                  | 6.660 ms                  |
| forward: a2a keys         | 6.446 ms                  | 43.249 ms                 |
| forward: search cache     | 469.449 us                | 1.235 ms                  |
| forward: a2a values       | 14.426 ms                 | 32.794 ms                 |
| forward: join             | 2.242 ms                  | 5.384 ms                  |
| Forward                   | 57.440 ms                 | 114.974 ms                |
| back: aggr dram keys      | 53.165 ms                 | 91.744 ms                 |
| back: set dram grad       | 3.572 ms                  | 12.533 ms                 |
| back: a2a grad            | 21.435 ms                 | 50.973 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 143.897 ms                |
| Backward                  | 249.346 ms                | 326.019 ms                |
| Optimize                  | 27.517 ms                 | 44.894 ms                 |
| BarrierTimeBeforeRank0    | 41.546 us                 | 72.482 us                 |
| BlockToStepN              | 61.032 us                 | 15.862 ms                 |
| OneStep                   | 351.641 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 200 steps, total: 34.920, sample: 1.223, forward: 6.864, backward: 14.016, update: 0.441
[proc 6] 200 steps, total: 34.920, sample: 1.395, forward: 6.728, backward: 13.955, update: 0.417
[proc 1] 200 steps, total: 34.920, sample: 1.071, forward: 7.070, backward: 14.589, update: 0.389
[proc 3] 200 steps, total: 34.920, sample: 1.209, forward: 6.953, backward: 14.155, update: 0.428
[proc 0] 200 steps, total: 34.920, sample: 1.547, forward: 6.091, backward: 24.223, update: 2.889
[proc 2] 200 steps, total: 34.920, sample: 1.115, forward: 7.051, backward: 14.239, update: 0.412
[proc 5] 200 steps, total: 34.920, sample: 1.349, forward: 6.757, backward: 14.007, update: 0.418
[proc 7] 200 steps, total: 34.920, sample: 1.561, forward: 6.568, backward: 14.185, update: 0.410
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.283 ms                  | 128.225 ms                |
| bucket keys               | 3.472 ms                  | 6.660 ms                  |
| forward: a2a keys         | 6.563 ms                  | 43.249 ms                 |
| forward: search cache     | 469.167 us                | 1.241 ms                  |
| forward: a2a values       | 14.344 ms                 | 32.794 ms                 |
| forward: join             | 2.242 ms                  | 5.384 ms                  |
| Forward                   | 57.571 ms                 | 114.974 ms                |
| back: aggr dram keys      | 53.735 ms                 | 91.744 ms                 |
| back: set dram grad       | 3.572 ms                  | 12.533 ms                 |
| back: a2a grad            | 20.446 ms                 | 50.973 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 143.897 ms                |
| Backward                  | 246.403 ms                | 326.019 ms                |
| Optimize                  | 27.682 ms                 | 45.105 ms                 |
| BarrierTimeBeforeRank0    | 40.143 us                 | 74.375 us                 |
| BlockToStepN              | 60.282 us                 | 15.862 ms                 |
| OneStep                   | 348.893 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.871 ms                  | 128.225 ms                |
| bucket keys               | 3.464 ms                  | 6.660 ms                  |
| forward: a2a keys         | 6.572 ms                  | 43.249 ms                 |
| forward: search cache     | 469.003 us                | 1.237 ms                  |
| forward: a2a values       | 14.017 ms                 | 30.051 ms                 |
| forward: join             | 2.850 ms                  | 5.384 ms                  |
| Forward                   | 57.440 ms                 | 115.867 ms                |
| back: aggr dram keys      | 53.735 ms                 | 90.733 ms                 |
| back: set dram grad       | 3.817 ms                  | 12.384 ms                 |
| back: a2a grad            | 19.891 ms                 | 49.989 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 142.054 ms                |
| Backward                  | 242.999 ms                | 326.019 ms                |
| Optimize                  | 27.747 ms                 | 46.980 ms                 |
| BarrierTimeBeforeRank0    | 39.516 us                 | 74.375 us                 |
| BlockToStepN              | 59.856 us                 | 16.588 ms                 |
| OneStep                   | 345.431 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.184 ms                  | 128.225 ms                |
| bucket keys               | 3.464 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.613 ms                  | 43.249 ms                 |
| forward: search cache     | 468.928 us                | 1.237 ms                  |
| forward: a2a values       | 13.474 ms                 | 32.119 ms                 |
| forward: join             | 2.878 ms                  | 5.384 ms                  |
| Forward                   | 57.440 ms                 | 115.867 ms                |
| back: aggr dram keys      | 55.676 ms                 | 90.733 ms                 |
| back: set dram grad       | 4.051 ms                  | 12.384 ms                 |
| back: a2a grad            | 19.575 ms                 | 49.989 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 142.054 ms                |
| Backward                  | 240.670 ms                | 326.019 ms                |
| Optimize                  | 27.927 ms                 | 48.146 ms                 |
| BarrierTimeBeforeRank0    | 39.478 us                 | 74.375 us                 |
| BlockToStepN              | 58.660 us                 | 16.588 ms                 |
| OneStep                   | 342.668 ms                | 511.669 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.858 ms                  | 108.418 ms                |
| bucket keys               | 3.464 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.572 ms                  | 43.249 ms                 |
| forward: search cache     | 468.675 us                | 1.237 ms                  |
| forward: a2a values       | 11.335 ms                 | 32.794 ms                 |
| forward: join             | 2.894 ms                  | 5.812 ms                  |
| Forward                   | 57.181 ms                 | 114.974 ms                |
| back: aggr dram keys      | 56.689 ms                 | 90.733 ms                 |
| back: set dram grad       | 4.257 ms                  | 12.384 ms                 |
| back: a2a grad            | 17.062 ms                 | 49.989 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 142.054 ms                |
| Backward                  | 236.975 ms                | 320.988 ms                |
| Optimize                  | 28.076 ms                 | 49.823 ms                 |
| BarrierTimeBeforeRank0    | 39.326 us                 | 72.482 us                 |
| BlockToStepN              | 58.279 us                 | 15.862 ms                 |
| OneStep                   | 339.148 ms                | 507.437 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.738 ms                  | 108.418 ms                |
| bucket keys               | 3.464 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.563 ms                  | 42.485 ms                 |
| forward: search cache     | 468.619 us                | 1.237 ms                  |
| forward: a2a values       | 9.952 ms                  | 32.119 ms                 |
| forward: join             | 2.904 ms                  | 5.516 ms                  |
| Forward                   | 56.856 ms                 | 114.974 ms                |
| back: aggr dram keys      | 56.830 ms                 | 88.536 ms                 |
| back: set dram grad       | 4.352 ms                  | 11.843 ms                 |
| back: a2a grad            | 16.252 ms                 | 48.878 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 142.035 ms                |
| Backward                  | 234.089 ms                | 320.988 ms                |
| Optimize                  | 28.394 ms                 | 50.527 ms                 |
| BarrierTimeBeforeRank0    | 39.032 us                 | 72.482 us                 |
| BlockToStepN              | 57.810 us                 | 15.862 ms                 |
| OneStep                   | 337.707 ms                | 507.437 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.681 ms                  | 108.418 ms                |
| bucket keys               | 3.228 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.556 ms                  | 42.485 ms                 |
| forward: search cache     | 468.664 us                | 1.246 ms                  |
| forward: a2a values       | 9.045 ms                  | 32.119 ms                 |
| forward: join             | 2.909 ms                  | 5.516 ms                  |
| Forward                   | 56.479 ms                 | 114.974 ms                |
| back: aggr dram keys      | 56.877 ms                 | 90.733 ms                 |
| back: set dram grad       | 4.402 ms                  | 12.384 ms                 |
| back: a2a grad            | 14.525 ms                 | 48.878 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 142.035 ms                |
| Backward                  | 232.010 ms                | 320.988 ms                |
| Optimize                  | 29.038 ms                 | 50.588 ms                 |
| BarrierTimeBeforeRank0    | 39.001 us                 | 72.482 us                 |
| BlockToStepN              | 57.598 us                 | 15.862 ms                 |
| OneStep                   | 335.445 ms                | 507.437 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 30.923, sample: 0.972, forward: 6.460, backward: 15.865, update: 0.403
[proc 3] 300 steps, total: 30.923, sample: 0.963, forward: 6.493, backward: 15.626, update: 0.461
[proc 0] 300 steps, total: 30.923, sample: 1.139, forward: 5.874, backward: 19.915, update: 3.831
[proc 6] 300 steps, total: 30.923, sample: 1.025, forward: 6.411, backward: 15.492, update: 0.421
[proc 4] 300 steps, total: 30.923, sample: 0.927, forward: 6.471, backward: 15.518, update: 0.431
[proc 2] 300 steps, total: 30.923, sample: 0.911, forward: 6.520, backward: 15.717, update: 0.392
[proc 7] 300 steps, total: 30.923, sample: 1.118, forward: 6.354, backward: 15.558, update: 0.448
[proc 5] 300 steps, total: 30.923, sample: 1.005, forward: 6.427, backward: 15.572, update: 0.415
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.738 ms                  | 108.418 ms                |
| bucket keys               | 3.228 ms                  | 7.122 ms                  |
| forward: a2a keys         | 6.516 ms                  | 42.485 ms                 |
| forward: search cache     | 468.533 us                | 1.246 ms                  |
| forward: a2a values       | 8.820 ms                  | 32.794 ms                 |
| forward: join             | 2.916 ms                  | 5.812 ms                  |
| Forward                   | 56.461 ms                 | 114.974 ms                |
| back: aggr dram keys      | 57.332 ms                 | 90.733 ms                 |
| back: set dram grad       | 4.428 ms                  | 12.533 ms                 |
| back: a2a grad            | 13.872 ms                 | 48.878 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 142.035 ms                |
| Backward                  | 230.907 ms                | 320.988 ms                |
| Optimize                  | 29.748 ms                 | 54.046 ms                 |
| BarrierTimeBeforeRank0    | 39.001 us                 | 72.482 us                 |
| BlockToStepN              | 57.621 us                 | 15.862 ms                 |
| OneStep                   | 330.813 ms                | 507.437 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.738 ms                  | 109.250 ms                |
| bucket keys               | 3.181 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.446 ms                  | 40.796 ms                 |
| forward: search cache     | 468.296 us                | 1.241 ms                  |
| forward: a2a values       | 8.861 ms                  | 32.119 ms                 |
| forward: join             | 2.922 ms                  | 5.516 ms                  |
| Forward                   | 56.223 ms                 | 114.974 ms                |
| back: aggr dram keys      | 57.478 ms                 | 88.536 ms                 |
| back: set dram grad       | 4.494 ms                  | 12.384 ms                 |
| back: a2a grad            | 13.781 ms                 | 45.202 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 140.614 ms                |
| Backward                  | 228.721 ms                | 320.988 ms                |
| Optimize                  | 30.116 ms                 | 54.046 ms                 |
| BarrierTimeBeforeRank0    | 38.902 us                 | 72.482 us                 |
| BlockToStepN              | 57.486 us                 | 16.588 ms                 |
| OneStep                   | 329.066 ms                | 507.437 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.738 ms                  | 109.250 ms                |
| bucket keys               | 3.181 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.446 ms                  | 40.796 ms                 |
| forward: search cache     | 468.273 us                | 1.246 ms                  |
| forward: a2a values       | 8.802 ms                  | 32.119 ms                 |
| forward: join             | 2.927 ms                  | 5.812 ms                  |
| Forward                   | 56.167 ms                 | 114.974 ms                |
| back: aggr dram keys      | 57.340 ms                 | 88.536 ms                 |
| back: set dram grad       | 4.518 ms                  | 12.384 ms                 |
| back: a2a grad            | 13.544 ms                 | 48.878 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 140.614 ms                |
| Backward                  | 226.820 ms                | 320.988 ms                |
| Optimize                  | 30.433 ms                 | 56.891 ms                 |
| BarrierTimeBeforeRank0    | 38.769 us                 | 72.482 us                 |
| BlockToStepN              | 57.598 us                 | 18.002 ms                 |
| OneStep                   | 325.538 ms                | 507.437 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.710 ms                  | 108.418 ms                |
| bucket keys               | 3.177 ms                  | 7.122 ms                  |
| forward: a2a keys         | 6.336 ms                  | 40.796 ms                 |
| forward: search cache     | 468.291 us                | 1.246 ms                  |
| forward: a2a values       | 8.802 ms                  | 32.119 ms                 |
| forward: join             | 2.930 ms                  | 5.849 ms                  |
| Forward                   | 55.812 ms                 | 107.563 ms                |
| back: aggr dram keys      | 57.457 ms                 | 89.401 ms                 |
| back: set dram grad       | 4.536 ms                  | 12.384 ms                 |
| back: a2a grad            | 13.434 ms                 | 48.878 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 140.614 ms                |
| Backward                  | 224.446 ms                | 313.035 ms                |
| Optimize                  | 31.346 ms                 | 55.194 ms                 |
| BarrierTimeBeforeRank0    | 38.605 us                 | 70.092 us                 |
| BlockToStepN              | 56.975 us                 | 16.588 ms                 |
| OneStep                   | 322.804 ms                | 496.907 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.735 ms                  | 108.418 ms                |
| bucket keys               | 3.214 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.336 ms                  | 39.754 ms                 |
| forward: search cache     | 468.179 us                | 1.241 ms                  |
| forward: a2a values       | 8.671 ms                  | 30.051 ms                 |
| forward: join             | 2.933 ms                  | 5.812 ms                  |
| Forward                   | 55.342 ms                 | 107.563 ms                |
| back: aggr dram keys      | 57.512 ms                 | 88.536 ms                 |
| back: set dram grad       | 4.571 ms                  | 12.384 ms                 |
| back: a2a grad            | 13.418 ms                 | 45.202 ms                 |
| back: grad sum & grad cache  | 9.170 ms                  | 138.360 ms                |
| Backward                  | 222.784 ms                | 313.035 ms                |
| Optimize                  | 31.806 ms                 | 55.194 ms                 |
| BarrierTimeBeforeRank0    | 38.546 us                 | 70.092 us                 |
| BlockToStepN              | 56.421 us                 | 16.588 ms                 |
| OneStep                   | 320.866 ms                | 496.907 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.681 ms                  | 108.418 ms                |
| bucket keys               | 3.228 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.298 ms                  | 39.754 ms                 |
| forward: search cache     | 468.140 us                | 1.241 ms                  |
| forward: a2a values       | 8.671 ms                  | 30.998 ms                 |
| forward: join             | 2.939 ms                  | 5.849 ms                  |
| Forward                   | 55.104 ms                 | 107.563 ms                |
| back: aggr dram keys      | 57.512 ms                 | 89.389 ms                 |
| back: set dram grad       | 4.597 ms                  | 12.384 ms                 |
| back: a2a grad            | 13.300 ms                 | 45.202 ms                 |
| back: grad sum & grad cache  | 12.481 ms                 | 138.360 ms                |
| Backward                  | 219.882 ms                | 313.035 ms                |
| Optimize                  | 33.134 ms                 | 55.194 ms                 |
| BarrierTimeBeforeRank0    | 38.245 us                 | 70.092 us                 |
| BlockToStepN              | 56.209 us                 | 18.002 ms                 |
| OneStep                   | 320.350 ms                | 496.907 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 400 steps, total: 29.579, sample: 0.940, forward: 5.782, backward: 15.992, update: 0.450
[proc 5] 400 steps, total: 29.578, sample: 0.938, forward: 5.790, backward: 16.063, update: 0.390
[proc 7] 400 steps, total: 29.579, sample: 1.015, forward: 5.740, backward: 16.045, update: 0.411
[proc 2] 400 steps, total: 29.579, sample: 0.891, forward: 5.846, backward: 16.144, update: 0.416
[proc 3] 400 steps, total: 29.579, sample: 0.997, forward: 5.741, backward: 16.110, update: 0.443
[proc 0] 400 steps, total: 29.579, sample: 1.110, forward: 5.301, backward: 18.802, update: 4.192
[proc 1] 400 steps, total: 29.579, sample: 0.918, forward: 5.817, backward: 16.283, update: 0.390
[proc 4] 400 steps, total: 29.579, sample: 0.912, forward: 5.823, backward: 16.020, update: 0.439
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.618 ms                  | 108.418 ms                |
| bucket keys               | 3.185 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.298 ms                  | 39.754 ms                 |
| forward: search cache     | 468.137 us                | 1.241 ms                  |
| forward: a2a values       | 8.612 ms                  | 30.998 ms                 |
| forward: join             | 2.942 ms                  | 5.849 ms                  |
| Forward                   | 55.030 ms                 | 107.563 ms                |
| back: aggr dram keys      | 57.616 ms                 | 89.389 ms                 |
| back: set dram grad       | 4.611 ms                  | 12.533 ms                 |
| back: a2a grad            | 13.199 ms                 | 45.202 ms                 |
| back: grad sum & grad cache  | 12.481 ms                 | 138.360 ms                |
| Backward                  | 216.129 ms                | 313.035 ms                |
| Optimize                  | 34.209 ms                 | 56.891 ms                 |
| BarrierTimeBeforeRank0    | 38.133 us                 | 70.092 us                 |
| BlockToStepN              | 56.266 us                 | 18.298 ms                 |
| OneStep                   | 319.927 ms                | 496.907 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.596 ms                  | 108.418 ms                |
| bucket keys               | 3.214 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.298 ms                  | 39.187 ms                 |
| forward: search cache     | 468.148 us                | 1.237 ms                  |
| forward: a2a values       | 8.555 ms                  | 30.051 ms                 |
| forward: join             | 2.947 ms                  | 5.970 ms                  |
| Forward                   | 55.104 ms                 | 107.563 ms                |
| back: aggr dram keys      | 57.542 ms                 | 88.536 ms                 |
| back: set dram grad       | 4.620 ms                  | 12.533 ms                 |
| back: a2a grad            | 13.184 ms                 | 44.920 ms                 |
| back: grad sum & grad cache  | 12.481 ms                 | 136.430 ms                |
| Backward                  | 214.326 ms                | 313.035 ms                |
| Optimize                  | 34.903 ms                 | 56.920 ms                 |
| BarrierTimeBeforeRank0    | 37.961 us                 | 70.092 us                 |
| BlockToStepN              | 56.165 us                 | 20.767 ms                 |
| OneStep                   | 318.725 ms                | 496.907 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.596 ms                  | 108.418 ms                |
| bucket keys               | 3.265 ms                  | 7.036 ms                  |
| forward: a2a keys         | 6.189 ms                  | 39.187 ms                 |
| forward: search cache     | 468.331 us                | 1.237 ms                  |
| forward: a2a values       | 8.511 ms                  | 30.051 ms                 |
| forward: join             | 2.950 ms                  | 5.980 ms                  |
| Forward                   | 54.780 ms                 | 107.563 ms                |
| back: aggr dram keys      | 57.512 ms                 | 88.536 ms                 |
| back: set dram grad       | 4.635 ms                  | 13.264 ms                 |
| back: a2a grad            | 13.143 ms                 | 44.920 ms                 |
| back: grad sum & grad cache  | 12.481 ms                 | 136.430 ms                |
| Backward                  | 210.987 ms                | 313.035 ms                |
| Optimize                  | 35.310 ms                 | 56.920 ms                 |
| BarrierTimeBeforeRank0    | 38.090 us                 | 70.092 us                 |
| BlockToStepN              | 56.020 us                 | 20.767 ms                 |
| OneStep                   | 314.701 ms                | 496.907 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 151.3019561767578 seconds
before call kg_cache_controller.StopThreads()
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
INFO [45679 controller_process.py:421] call rank0 to StopThreads
