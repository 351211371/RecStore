WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 14:48:40.463197 46402 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_85', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [46402 sampler.py:454] Start PreSampling
WARNING [46402 sampler.py:532] Before construct renumbering_dict
WARNING [46402 sampler.py:555] PreSampling done
W20240202 14:48:45.611595 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 14:48:45.611788 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 14:48:45.611836 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 14:48:45.611876 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 14:48:45.611924 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 14:48:45.611969 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 14:48:45.612021 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 14:48:45.612079 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 14:48:45.612125 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 14:48:45.612167 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 14:48:45.612211 46402 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 14:48:45.612249 46402 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 14:48:45.612290 46402 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 14:48:45.612425 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 14:48:45.612469 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 14:48:45.612514 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 14:48:45.612568 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 14:48:45.612612 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 14:48:45.612653 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 14:48:45.612689 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 14:48:45.612725 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 14:48:45.612757 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 14:48:45.612795 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 14:48:45.612834 46402 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 14:48:45.612864 46402 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 14:48:45.612895 46402 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 14:48:45.612963 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 14:48:45.612999 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 14:48:45.613034 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 14:48:45.613072 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 14:48:45.613112 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 14:48:45.613149 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 14:48:45.613198 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 14:48:45.613233 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 14:48:45.613282 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 14:48:45.613333 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 14:48:45.613374 46402 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 14:48:45.613404 46402 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 14:48:45.613442 46402 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 14:48:45.613514 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 14:48:45.613556 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 14:48:45.613600 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 14:48:45.613642 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 14:48:45.613687 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 14:48:45.613729 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 14:48:45.613778 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 14:48:45.613821 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 14:48:45.613865 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 14:48:45.613904 46402 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 14:48:45.613940 46402 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 14:48:45.613970 46402 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 14:48:45.614001 46402 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 14:48:45.880494 46402 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240202 14:48:45.976511 46402 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=9703, num_edges=161860,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11374, num_edges=168961,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10715, num_edges=190828,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=11184, num_edges=240046,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9703 N 161860 E
MertisPartition: part 1 has 11374 N 168961 E
MertisPartition: part 2 has 10715 N 190828 E
MertisPartition: part 3 has 11184 N 240046 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Before renumbering graph:  {'_ID': tensor([   6,   10,   11,  ..., 5824, 6189, 2559]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 966, 1118, 1151,  ..., 6384, 3729, 6638]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.613 seconds
[Rank1] pid = 46940
[Rank2] pid = 46952
INFO [46402 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [46952 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [47068 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [46940 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [47068 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [46940 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [46952 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [46402 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240202 14:48:47.972005 47133 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240202 14:48:47.972178 46941 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240202 14:48:47.972178 47005 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240202 14:48:47.972894 47069 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240202 14:48:48.000089 46941 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100014878000 7.629 MB
W20240202 14:48:48.000095 47133 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10001501b000 7.629 MB
W20240202 14:48:48.000321 47133 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000157c0000 7.629 MB
W20240202 14:48:48.000332 46941 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100015f63000 7.629 MB
W20240202 14:48:48.000447 47133 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100016706000 1.49 GB
W20240202 14:48:48.000471 46941 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x100075ce9000 1.49 GB
W20240202 14:48:48.000502 47005 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000d52cc000 7.629 MB
W20240202 14:48:48.000527 47133 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1000d5a6f000 1.49 GB
W20240202 14:48:48.000558 46941 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100135052000 1.49 GB
W20240202 14:48:48.000604 47133 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:48:48.000628 46941 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 14:48:48.000699 47005 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100194635000 7.629 MB
W20240202 14:48:48.000816 47005 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x100194dd8000 1.49 GB
W20240202 14:48:48.000880 47005 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1001f43bb000 1.49 GB
W20240202 14:48:48.000941 47005 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 14:48:48.005734 47133 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:48:48.005738 47005 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 14:48:48.005771 46941 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 14:48:48.005812 47069 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1002539a6000 7.629 MB
W20240202 14:48:48.005940 47069 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100254149000 7.629 MB
W20240202 14:48:48.006011 47069 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1002548ec000 1.49 GB
W20240202 14:48:48.006063 47069 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1002b3ecf000 1.49 GB
W20240202 14:48:48.006121 47069 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 14:48:48.012212 47069 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [46940 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [46952 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [47068 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank3] pid = 47068
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [46402 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 14:48:49.627697 47069 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240202 14:48:49.628171 47005 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240202 14:48:49.628319 46941 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240202 14:48:49.628665 47133 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240202 14:48:49.631335 47069 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240202 14:48:49.631482 47069 grad_base.h:184] Init GradProcessingBase done
I20240202 14:48:49.634092 47069 grad_async_v1.h:203] Use main thread to update emb.
W20240202 14:48:49.634124 47069 kg_controller.h:75] after init GradAsyncProcessing
I20240202 14:48:49.634132 47069 kg_controller.h:84] Construct KGCacheController done
E20240202 14:48:50.117581 46941 recstore.cc:66] init folly done
E20240202 14:48:50.117746 47069 recstore.cc:66] init folly done
E20240202 14:48:50.117785 47005 recstore.cc:66] init folly done
E20240202 14:48:50.118077 47133 recstore.cc:66] init folly done
I20240202 14:48:50.118835 47069 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240202 14:48:50.482829 47133 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240202 14:48:50.488768 46941 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240202 14:48:50.490437 47005 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240202 14:48:50.493325 47069 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240202 14:48:51.997581 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=0
E20240202 14:48:52.038617 47546 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
W20240202 14:48:52.997016 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240202 14:48:53.997020 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.259 ms                  | 24.063 ms                 |
| Forward                   | 5.827 ms                  | 585.409 ms                |
| Backward                  | 9.823 ms                  | 206.442 ms                |
| Optimize                  | 2.603 ms                  | 9.073 ms                  |
| BarrierTimeBeforeRank0    | 46.260 us                 | 11.348 ms                 |
| AfterBackward             | 17.264 ms                 | 700.659 ms                |
| BlockToStepN              | 61.181 us                 | 357.101 ms                |
| OneStep                   | 45.006 ms                 | 1.510 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 14:48:55.050136 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.522 ms                  | 269.875 ms                |
| ProcessBack:UpdateCache   | 2.931 ms                  | 339.118 ms                |
| ProcessBack:UpsertPq      | 10.798 ms                 | 33.478 ms                 |
| ProcessOneStep            | 17.236 ms                 | 700.038 ms                |
| BlockToStepN              | 679.000 ns                | 356.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:48:56.050017 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240202 14:48:57.050019 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240202 14:48:58.050007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240202 14:48:59.050024 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.716 ms                  | 26.387 ms                 |
| Forward                   | 5.717 ms                  | 585.409 ms                |
| Backward                  | 9.516 ms                  | 206.442 ms                |
| Optimize                  | 2.483 ms                  | 9.073 ms                  |
| BarrierTimeBeforeRank0    | 46.260 us                 | 11.480 ms                 |
| AfterBackward             | 17.581 ms                 | 700.659 ms                |
| BlockToStepN              | 196.286 ms                | 357.101 ms                |
| OneStep                   | 238.607 ms                | 1.510 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:00.050007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.627 ms                  | 230.965 ms                |
| ProcessBack:UpdateCache   | 2.877 ms                  | 337.218 ms                |
| ProcessBack:UpsertPq      | 10.824 ms                 | 32.791 ms                 |
| ProcessOneStep            | 17.467 ms                 | 700.038 ms                |
| BlockToStepN              | 196.701 ms                | 356.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:01.050016 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240202 14:49:02.050007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240202 14:49:03.050014 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240202 14:49:04.050011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.716 ms                  | 25.964 ms                 |
| Forward                   | 5.494 ms                  | 8.605 ms                  |
| Backward                  | 9.417 ms                  | 12.754 ms                 |
| Optimize                  | 2.507 ms                  | 8.523 ms                  |
| BarrierTimeBeforeRank0    | 63.208 us                 | 11.480 ms                 |
| AfterBackward             | 16.350 ms                 | 60.127 ms                 |
| BlockToStepN              | 202.292 ms                | 332.789 ms                |
| OneStep                   | 244.925 ms                | 397.096 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:05.068464 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.574 ms                  | 230.965 ms                |
| ProcessBack:UpdateCache   | 2.751 ms                  | 337.218 ms                |
| ProcessBack:UpsertPq      | 10.047 ms                 | 32.791 ms                 |
| ProcessOneStep            | 16.323 ms                 | 60.094 ms                 |
| BlockToStepN              | 202.536 ms                | 332.406 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:06.068018 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=66, pq.top=66
W20240202 14:49:07.068007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
W20240202 14:49:08.082691 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=74, pq.top=74
W20240202 14:49:09.082011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.731 ms                  | 26.387 ms                 |
| Forward                   | 5.494 ms                  | 8.605 ms                  |
| Backward                  | 9.333 ms                  | 12.754 ms                 |
| Optimize                  | 2.462 ms                  | 8.523 ms                  |
| BarrierTimeBeforeRank0    | 138.512 us                | 11.480 ms                 |
| AfterBackward             | 16.110 ms                 | 60.127 ms                 |
| BlockToStepN              | 209.384 ms                | 332.789 ms                |
| OneStep                   | 254.393 ms                | 397.096 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:10.082012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.587 ms                  | 6.416 ms                  |
| ProcessBack:UpdateCache   | 2.696 ms                  | 6.310 ms                  |
| ProcessBack:UpsertPq      | 9.666 ms                  | 31.693 ms                 |
| ProcessOneStep            | 16.006 ms                 | 60.094 ms                 |
| BlockToStepN              | 212.365 ms                | 332.406 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:11.082011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240202 14:49:12.082013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=88, pq.top=88
W20240202 14:49:13.082012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=92, pq.top=92
W20240202 14:49:14.111846 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=96, pq.top=96
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.731 ms                  | 27.479 ms                 |
| Forward                   | 5.482 ms                  | 8.605 ms                  |
| Backward                  | 9.297 ms                  | 12.754 ms                 |
| Optimize                  | 2.462 ms                  | 8.523 ms                  |
| BarrierTimeBeforeRank0    | 47.129 us                 | 11.480 ms                 |
| AfterBackward             | 15.258 ms                 | 60.127 ms                 |
| BlockToStepN              | 217.018 ms                | 332.789 ms                |
| OneStep                   | 257.011 ms                | 397.096 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:15.111018 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.587 ms                  | 6.416 ms                  |
| ProcessBack:UpdateCache   | 2.690 ms                  | 6.310 ms                  |
| ProcessBack:UpsertPq      | 9.393 ms                  | 31.693 ms                 |
| ProcessOneStep            | 15.219 ms                 | 60.094 ms                 |
| BlockToStepN              | 216.929 ms                | 332.406 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 24.982, sample: 0.390, forward: 1.087, backward: 1.113, update: 0.250
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 24.990, sample: 0.425, forward: 1.108, backward: 1.098, update: 0.288
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 24.984, sample: 0.386, forward: 1.075, backward: 1.147, update: 0.264
train_sampler.Prefill()
-------Step 0-------
tensor([ 5219,  6756, 11282,  4448,   174,  4665, 10468,   165,  4482, 11948]) tensor([ 1151, 10793,  2927, 14282,  2850, 10794,  3873,  5604,  3702, 14261])
-------Step 1-------
tensor([ 5219,  6756, 11282,  4448,   174,  4665, 10468,   165,  4482, 11948]) tensor([ 2321, 11428,  5510,  4524, 11394,  6511,   930, 11232,   310,  8741])
-------Step 2-------
tensor([ 8108,    25,  2196,   164,  8598,  3100, 14813,   856, 13791,  4001]) tensor([ 5423,  4386,  5896,  5622,  6787,  5051, 13745, 11873,  9645,  8887])
-------Step 3-------
tensor([ 8108,    25,  2196,   164,  8598,  3100, 14813,   856, 13791,  4001]) tensor([ 9038,  7922,  8583,  6150,   699,  6970, 12021,  5574,  4373, 13633])
-------Step 4-------
tensor([   67,  5865, 10913, 10147,  9918,  8705, 11042,  1538, 14949,  3772]) tensor([ 8021,  1017,  1925,  1192,  7643, 11059,   823,  1363,  5062,  6773])
-------Step 5-------
tensor([   67,  5865, 10913, 10147,  9918,  8705, 11042,  1538, 14949,  3772]) tensor([ 1374, 13851,  1051,  3746,  5928,   107, 12988,  3946,  3083, 11162])
-------Step 6-------
tensor([11047, 13614,  8027,   101,  1030, 11647,    83, 13727,  7685,   132]) tensor([ 6504, 13211,   745,  2776,  2444,  2308,  1048,  2163,  3035, 12478])
-------Step 7-------
tensor([11047, 13614,  8027,   101,  1030, 11647,    83, 13727,  7685,   132]) tensor([11252,  9042, 12527,  9488,  6804,  1497,  9426,  5361,  3151,  9287])
-------Step 8-------
tensor([ 6476,  8682,    74, 10713,  1994,  7850, 12651, 12816,    12, 10226]) tensor([ 2020,  7209, 10384,  9210,  5262, 11595,  7827,  6817, 10860, 10779])
-------Step 9-------
tensor([ 6476,  8682,    74, 10713,  1994,  7850, 12651, 12816,    12, 10226]) tensor([ 2688,   549,  6460,  8639,  2288,  1944, 13512,  4771,   417, 11979])
before start barrier
start train
[proc 0] 100 steps, total: 24.979, sample: 0.463, forward: 1.127, backward: 1.127, update: 0.274
W20240202 14:49:16.111006 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240202 14:49:17.111014 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
W20240202 14:49:18.111011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=110, pq.top=110
W20240202 14:49:19.111009 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.716 ms                  | 27.479 ms                 |
| Forward                   | 5.439 ms                  | 8.605 ms                  |
| Backward                  | 9.293 ms                  | 12.754 ms                 |
| Optimize                  | 2.503 ms                  | 8.523 ms                  |
| BarrierTimeBeforeRank0    | 47.129 us                 | 11.480 ms                 |
| AfterBackward             | 15.113 ms                 | 60.127 ms                 |
| BlockToStepN              | 221.995 ms                | 332.789 ms                |
| OneStep                   | 261.157 ms                | 397.096 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:20.111018 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.577 ms                  | 6.416 ms                  |
| ProcessBack:UpdateCache   | 2.672 ms                  | 6.310 ms                  |
| ProcessBack:UpsertPq      | 9.024 ms                  | 31.693 ms                 |
| ProcessOneStep            | 15.062 ms                 | 60.094 ms                 |
| BlockToStepN              | 222.658 ms                | 332.406 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:21.111006 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=120, pq.top=120
W20240202 14:49:22.111014 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240202 14:49:23.111013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240202 14:49:24.111013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=130, pq.top=130
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.687 ms                  | 27.479 ms                 |
| Forward                   | 5.469 ms                  | 8.605 ms                  |
| Backward                  | 9.282 ms                  | 12.754 ms                 |
| Optimize                  | 2.492 ms                  | 8.523 ms                  |
| BarrierTimeBeforeRank0    | 82.807 us                 | 11.480 ms                 |
| AfterBackward             | 14.988 ms                 | 60.127 ms                 |
| BlockToStepN              | 229.247 ms                | 332.789 ms                |
| OneStep                   | 265.962 ms                | 397.096 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:25.111012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.573 ms                  | 5.857 ms                  |
| ProcessBack:UpdateCache   | 2.686 ms                  | 4.913 ms                  |
| ProcessBack:UpsertPq      | 8.809 ms                  | 31.531 ms                 |
| ProcessOneStep            | 14.961 ms                 | 60.094 ms                 |
| BlockToStepN              | 229.187 ms                | 332.406 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:26.130803 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240202 14:49:27.130016 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240202 14:49:28.130007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240202 14:49:29.130013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=146, pq.top=146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.716 ms                  | 27.479 ms                 |
| Forward                   | 5.445 ms                  | 8.605 ms                  |
| Backward                  | 9.270 ms                  | 12.754 ms                 |
| Optimize                  | 2.503 ms                  | 8.523 ms                  |
| BarrierTimeBeforeRank0    | 88.684 us                 | 11.480 ms                 |
| AfterBackward             | 14.853 ms                 | 60.127 ms                 |
| BlockToStepN              | 232.905 ms                | 332.789 ms                |
| OneStep                   | 272.687 ms                | 397.096 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.571 ms                  | 5.857 ms                  |
| ProcessBack:UpdateCache   | 2.672 ms                  | 4.913 ms                  |
| ProcessBack:UpsertPq      | 8.796 ms                  | 31.531 ms                 |
| ProcessOneStep            | 14.814 ms                 | 60.094 ms                 |
| BlockToStepN              | 232.933 ms                | 332.406 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:30.130004 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=150, pq.top=150
W20240202 14:49:31.130008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240202 14:49:32.130007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
W20240202 14:49:33.186496 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240202 14:49:34.186007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.698 ms                  | 27.806 ms                 |
| Forward                   | 5.436 ms                  | 8.392 ms                  |
| Backward                  | 9.270 ms                  | 11.776 ms                 |
| Optimize                  | 2.517 ms                  | 5.061 ms                  |
| BarrierTimeBeforeRank0    | 104.570 us                | 17.416 ms                 |
| AfterBackward             | 14.846 ms                 | 39.894 ms                 |
| BlockToStepN              | 237.731 ms                | 313.566 ms                |
| OneStep                   | 275.904 ms                | 395.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.569 ms                  | 5.857 ms                  |
| ProcessBack:UpdateCache   | 2.665 ms                  | 4.913 ms                  |
| ProcessBack:UpsertPq      | 8.779 ms                  | 31.531 ms                 |
| ProcessOneStep            | 14.819 ms                 | 39.851 ms                 |
| BlockToStepN              | 237.872 ms                | 313.501 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:35.186012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240202 14:49:36.186015 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240202 14:49:37.192356 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240202 14:49:38.192016 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
W20240202 14:49:39.192008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.716 ms                  | 28.237 ms                 |
| Forward                   | 5.376 ms                  | 8.392 ms                  |
| Backward                  | 9.267 ms                  | 11.776 ms                 |
| Optimize                  | 2.517 ms                  | 5.061 ms                  |
| BarrierTimeBeforeRank0    | 104.570 us                | 21.720 ms                 |
| AfterBackward             | 14.804 ms                 | 39.894 ms                 |
| BlockToStepN              | 240.897 ms                | 313.566 ms                |
| OneStep                   | 279.660 ms                | 395.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.565 ms                  | 4.220 ms                  |
| ProcessBack:UpdateCache   | 2.645 ms                  | 4.756 ms                  |
| ProcessBack:UpsertPq      | 8.745 ms                  | 19.549 ms                 |
| ProcessOneStep            | 14.747 ms                 | 39.851 ms                 |
| BlockToStepN              | 240.844 ms                | 313.501 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:40.192011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=182, pq.top=182
W20240202 14:49:41.192011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240202 14:49:42.192008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240202 14:49:43.209123 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
W20240202 14:49:44.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.731 ms                  | 28.237 ms                 |
| Forward                   | 5.373 ms                  | 8.392 ms                  |
| Backward                  | 9.263 ms                  | 11.776 ms                 |
| Optimize                  | 2.532 ms                  | 5.061 ms                  |
| BarrierTimeBeforeRank0    | 128.552 us                | 23.997 ms                 |
| AfterBackward             | 14.715 ms                 | 39.894 ms                 |
| BlockToStepN              | 243.766 ms                | 314.753 ms                |
| OneStep                   | 283.173 ms                | 395.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.559 ms                  | 4.220 ms                  |
| ProcessBack:UpdateCache   | 2.636 ms                  | 4.756 ms                  |
| ProcessBack:UpsertPq      | 8.676 ms                  | 19.549 ms                 |
| ProcessOneStep            | 14.668 ms                 | 39.851 ms                 |
| BlockToStepN              | 244.119 ms                | 314.602 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:45.209010 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
[proc 3] 200 steps, total: 30.556, sample: 0.422, forward: 0.495, backward: 0.967, update: 0.272
[proc 0] 200 steps, total: 30.556, sample: 0.526, forward: 0.522, backward: 0.918, update: 0.255
[proc 2] 200 steps, total: 30.556, sample: 0.455, forward: 0.504, backward: 0.950, update: 0.250
[proc 1] 200 steps, total: 30.556, sample: 0.424, forward: 0.502, backward: 0.958, update: 0.262
W20240202 14:49:46.209014 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240202 14:49:47.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=204, pq.top=204
W20240202 14:49:48.209019 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240202 14:49:49.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.752 ms                  | 28.237 ms                 |
| Forward                   | 5.348 ms                  | 8.392 ms                  |
| Backward                  | 9.255 ms                  | 11.776 ms                 |
| Optimize                  | 2.532 ms                  | 5.061 ms                  |
| BarrierTimeBeforeRank0    | 128.552 us                | 25.991 ms                 |
| AfterBackward             | 14.693 ms                 | 39.894 ms                 |
| BlockToStepN              | 247.990 ms                | 314.753 ms                |
| OneStep                   | 285.740 ms                | 395.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.559 ms                  | 4.220 ms                  |
| ProcessBack:UpdateCache   | 2.605 ms                  | 4.756 ms                  |
| ProcessBack:UpsertPq      | 8.624 ms                  | 19.549 ms                 |
| ProcessOneStep            | 14.663 ms                 | 39.851 ms                 |
| BlockToStepN              | 247.915 ms                | 314.602 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:50.209004 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240202 14:49:51.209019 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240202 14:49:52.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240202 14:49:53.209017 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=224, pq.top=224
W20240202 14:49:54.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.752 ms                  | 28.237 ms                 |
| Forward                   | 5.335 ms                  | 8.392 ms                  |
| Backward                  | 9.245 ms                  | 11.776 ms                 |
| Optimize                  | 2.503 ms                  | 5.061 ms                  |
| BarrierTimeBeforeRank0    | 138.512 us                | 25.991 ms                 |
| AfterBackward             | 14.671 ms                 | 39.894 ms                 |
| BlockToStepN              | 248.511 ms                | 314.753 ms                |
| OneStep                   | 287.437 ms                | 395.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.557 ms                  | 3.896 ms                  |
| ProcessBack:UpdateCache   | 2.595 ms                  | 4.034 ms                  |
| ProcessBack:UpsertPq      | 8.600 ms                  | 16.891 ms                 |
| ProcessOneStep            | 14.599 ms                 | 39.851 ms                 |
| BlockToStepN              | 248.477 ms                | 314.602 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:49:55.209009 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=230, pq.top=230
W20240202 14:49:56.209012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240202 14:49:57.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240202 14:49:58.209015 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240202 14:49:59.209010 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.752 ms                  | 28.237 ms                 |
| Forward                   | 5.307 ms                  | 8.392 ms                  |
| Backward                  | 9.245 ms                  | 11.776 ms                 |
| Optimize                  | 2.490 ms                  | 5.061 ms                  |
| BarrierTimeBeforeRank0    | 208.490 us                | 25.991 ms                 |
| AfterBackward             | 14.599 ms                 | 39.894 ms                 |
| BlockToStepN              | 250.402 ms                | 332.789 ms                |
| OneStep                   | 291.266 ms                | 395.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.552 ms                  | 3.896 ms                  |
| ProcessBack:UpdateCache   | 2.565 ms                  | 4.034 ms                  |
| ProcessBack:UpsertPq      | 8.594 ms                  | 16.891 ms                 |
| ProcessOneStep            | 14.599 ms                 | 39.851 ms                 |
| BlockToStepN              | 250.542 ms                | 332.559 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:00.209005 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240202 14:50:01.209012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=248, pq.top=248
W20240202 14:50:02.209012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240202 14:50:03.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=254, pq.top=254
W20240202 14:50:04.209012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.752 ms                  | 27.806 ms                 |
| Forward                   | 5.283 ms                  | 8.159 ms                  |
| Backward                  | 9.240 ms                  | 11.427 ms                 |
| Optimize                  | 2.489 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 128.636 us                | 24.184 ms                 |
| AfterBackward             | 14.571 ms                 | 39.040 ms                 |
| BlockToStepN              | 253.270 ms                | 332.626 ms                |
| OneStep                   | 294.982 ms                | 387.072 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.544 ms                  | 3.896 ms                  |
| ProcessBack:UpdateCache   | 2.551 ms                  | 4.034 ms                  |
| ProcessBack:UpsertPq      | 8.594 ms                  | 16.891 ms                 |
| ProcessOneStep            | 14.545 ms                 | 38.998 ms                 |
| BlockToStepN              | 253.115 ms                | 332.406 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:05.209004 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240202 14:50:06.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240202 14:50:07.209014 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240202 14:50:08.209017 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240202 14:50:09.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.779 ms                  | 27.806 ms                 |
| Forward                   | 5.279 ms                  | 8.159 ms                  |
| Backward                  | 9.241 ms                  | 11.427 ms                 |
| Optimize                  | 2.483 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 174.672 us                | 24.184 ms                 |
| AfterBackward             | 14.571 ms                 | 39.040 ms                 |
| BlockToStepN              | 255.645 ms                | 332.626 ms                |
| OneStep                   | 297.070 ms                | 387.072 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.536 ms                  | 3.896 ms                  |
| ProcessBack:UpdateCache   | 2.541 ms                  | 4.034 ms                  |
| ProcessBack:UpsertPq      | 8.585 ms                  | 16.891 ms                 |
| ProcessOneStep            | 14.545 ms                 | 38.998 ms                 |
| BlockToStepN              | 255.836 ms                | 332.406 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:10.209012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240202 14:50:11.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=278, pq.top=278
W20240202 14:50:12.209019 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240202 14:50:13.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240202 14:50:14.209013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.779 ms                  | 28.086 ms                 |
| Forward                   | 5.255 ms                  | 8.159 ms                  |
| Backward                  | 9.241 ms                  | 11.427 ms                 |
| Optimize                  | 2.467 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 128.636 us                | 24.184 ms                 |
| AfterBackward             | 14.599 ms                 | 39.040 ms                 |
| BlockToStepN              | 258.977 ms                | 332.789 ms                |
| OneStep                   | 298.933 ms                | 395.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.533 ms                  | 3.807 ms                  |
| ProcessBack:UpdateCache   | 2.531 ms                  | 3.704 ms                  |
| ProcessBack:UpsertPq      | 8.591 ms                  | 16.891 ms                 |
| ProcessOneStep            | 14.545 ms                 | 38.998 ms                 |
| BlockToStepN              | 259.012 ms                | 332.559 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:15.209005 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=290, pq.top=290
W20240202 14:50:16.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240202 14:50:17.209018 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240202 14:50:18.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 1] 300 steps, total: 32.657, sample: 0.372, forward: 0.470, backward: 0.943, update: 0.246
[proc 3] 300 steps, total: 32.657, sample: 0.374, forward: 0.454, backward: 0.954, update: 0.250
[proc 2] 300 steps, total: 32.657, sample: 0.404, forward: 0.494, backward: 0.943, update: 0.256
[proc 0] 300 steps, total: 32.657, sample: 0.478, forward: 0.496, backward: 0.918, update: 0.240
W20240202 14:50:19.209014 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.792 ms                  | 28.086 ms                 |
| Forward                   | 5.235 ms                  | 8.159 ms                  |
| Backward                  | 9.243 ms                  | 11.427 ms                 |
| Optimize                  | 2.482 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 138.512 us                | 24.184 ms                 |
| AfterBackward             | 14.626 ms                 | 39.040 ms                 |
| BlockToStepN              | 261.066 ms                | 343.861 ms                |
| OneStep                   | 299.911 ms                | 395.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.533 ms                  | 3.807 ms                  |
| ProcessBack:UpdateCache   | 2.508 ms                  | 3.704 ms                  |
| ProcessBack:UpsertPq      | 8.594 ms                  | 16.891 ms                 |
| ProcessOneStep            | 14.577 ms                 | 38.998 ms                 |
| BlockToStepN              | 261.027 ms                | 343.800 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:20.209005 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240202 14:50:21.209007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240202 14:50:22.258955 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240202 14:50:23.258008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240202 14:50:24.258008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=316, pq.top=316
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.786 ms                  | 34.290 ms                 |
| Forward                   | 5.231 ms                  | 8.159 ms                  |
| Backward                  | 9.244 ms                  | 11.427 ms                 |
| Optimize                  | 2.467 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 128.636 us                | 24.184 ms                 |
| AfterBackward             | 14.599 ms                 | 39.040 ms                 |
| BlockToStepN              | 262.859 ms                | 345.850 ms                |
| OneStep                   | 301.747 ms                | 397.096 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.532 ms                  | 3.807 ms                  |
| ProcessBack:UpdateCache   | 2.504 ms                  | 3.704 ms                  |
| ProcessBack:UpsertPq      | 8.601 ms                  | 16.891 ms                 |
| ProcessOneStep            | 14.577 ms                 | 38.998 ms                 |
| BlockToStepN              | 262.816 ms                | 345.690 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:25.258013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240202 14:50:26.258008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=322, pq.top=322
W20240202 14:50:27.258013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240202 14:50:28.258011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=328, pq.top=328
W20240202 14:50:29.258008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=331, pq.top=331
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.792 ms                  | 34.290 ms                 |
| Forward                   | 5.224 ms                  | 8.159 ms                  |
| Backward                  | 9.244 ms                  | 11.427 ms                 |
| Optimize                  | 2.465 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 185.553 us                | 24.184 ms                 |
| AfterBackward             | 14.614 ms                 | 39.040 ms                 |
| BlockToStepN              | 263.514 ms                | 359.292 ms                |
| OneStep                   | 304.526 ms                | 410.286 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.532 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.499 ms                  | 3.591 ms                  |
| ProcessBack:UpsertPq      | 8.602 ms                  | 16.334 ms                 |
| ProcessOneStep            | 14.596 ms                 | 38.998 ms                 |
| BlockToStepN              | 263.479 ms                | 359.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:30.258018 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=334, pq.top=334
W20240202 14:50:31.258008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240202 14:50:32.258006 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
W20240202 14:50:33.258018 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240202 14:50:34.269155 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=346, pq.top=346
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.794 ms                  | 34.290 ms                 |
| Forward                   | 5.224 ms                  | 8.159 ms                  |
| Backward                  | 9.246 ms                  | 11.427 ms                 |
| Optimize                  | 2.484 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 174.672 us                | 25.991 ms                 |
| AfterBackward             | 14.671 ms                 | 39.040 ms                 |
| BlockToStepN              | 264.625 ms                | 359.292 ms                |
| OneStep                   | 306.252 ms                | 410.286 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.532 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.495 ms                  | 3.591 ms                  |
| ProcessBack:UpsertPq      | 8.621 ms                  | 16.334 ms                 |
| ProcessOneStep            | 14.623 ms                 | 38.998 ms                 |
| BlockToStepN              | 264.903 ms                | 359.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:35.269017 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=349, pq.top=349
W20240202 14:50:36.269006 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=352, pq.top=352
W20240202 14:50:37.269013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240202 14:50:38.269011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=358, pq.top=358
W20240202 14:50:39.269006 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=360, pq.top=360
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.810 ms                  | 28.579 ms                 |
| Forward                   | 5.224 ms                  | 7.975 ms                  |
| Backward                  | 9.253 ms                  | 11.271 ms                 |
| Optimize                  | 2.482 ms                  | 4.717 ms                  |
| BarrierTimeBeforeRank0    | 141.088 us                | 24.184 ms                 |
| AfterBackward             | 14.653 ms                 | 26.600 ms                 |
| BlockToStepN              | 266.006 ms                | 357.101 ms                |
| OneStep                   | 307.911 ms                | 409.902 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.533 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.499 ms                  | 3.591 ms                  |
| ProcessBack:UpsertPq      | 8.622 ms                  | 16.334 ms                 |
| ProcessOneStep            | 14.613 ms                 | 26.549 ms                 |
| BlockToStepN              | 266.104 ms                | 356.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:40.269012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240202 14:50:41.269007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=366, pq.top=366
W20240202 14:50:42.269016 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240202 14:50:43.269011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240202 14:50:44.269008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.808 ms                  | 28.579 ms                 |
| Forward                   | 5.229 ms                  | 7.975 ms                  |
| Backward                  | 9.253 ms                  | 11.271 ms                 |
| Optimize                  | 2.467 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 128.552 us                | 26.701 ms                 |
| AfterBackward             | 14.626 ms                 | 26.600 ms                 |
| BlockToStepN              | 267.601 ms                | 357.101 ms                |
| OneStep                   | 308.827 ms                | 409.902 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.533 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.495 ms                  | 3.591 ms                  |
| ProcessBack:UpsertPq      | 8.622 ms                  | 16.310 ms                 |
| ProcessOneStep            | 14.599 ms                 | 26.549 ms                 |
| BlockToStepN              | 268.128 ms                | 356.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:45.269013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=378, pq.top=378
W20240202 14:50:46.269012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240202 14:50:47.269008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=384, pq.top=384
W20240202 14:50:48.269021 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240202 14:50:49.269007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=390, pq.top=390
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.810 ms                  | 28.579 ms                 |
| Forward                   | 5.231 ms                  | 7.975 ms                  |
| Backward                  | 9.255 ms                  | 11.271 ms                 |
| Optimize                  | 2.483 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 105.687 us                | 26.701 ms                 |
| AfterBackward             | 14.651 ms                 | 26.600 ms                 |
| BlockToStepN              | 269.509 ms                | 357.101 ms                |
| OneStep                   | 309.480 ms                | 409.902 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.533 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.488 ms                  | 3.591 ms                  |
| ProcessBack:UpsertPq      | 8.622 ms                  | 16.310 ms                 |
| ProcessOneStep            | 14.599 ms                 | 26.549 ms                 |
| BlockToStepN              | 269.461 ms                | 356.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:50.269016 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240202 14:50:51.269006 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=396, pq.top=396
W20240202 14:50:52.271235 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 3] 400 steps, total: 34.177, sample: 0.361, forward: 0.471, backward: 0.963, update: 0.260
[proc 1] 400 steps, total: 34.177, sample: 0.415, forward: 0.487, backward: 0.944, update: 0.255
[proc 0] 400 steps, total: 34.177, sample: 0.515, forward: 0.500, backward: 0.917, update: 0.254
[proc 2] 400 steps, total: 34.177, sample: 0.418, forward: 0.503, backward: 0.947, update: 0.253
W20240202 14:50:53.271011 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=402, pq.top=402
W20240202 14:50:54.271006 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=405, pq.top=405
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.808 ms                  | 28.579 ms                 |
| Forward                   | 5.224 ms                  | 7.975 ms                  |
| Backward                  | 9.255 ms                  | 11.271 ms                 |
| Optimize                  | 2.467 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 104.834 us                | 26.701 ms                 |
| AfterBackward             | 14.626 ms                 | 26.600 ms                 |
| BlockToStepN              | 270.897 ms                | 357.101 ms                |
| OneStep                   | 311.607 ms                | 409.902 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.533 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.484 ms                  | 3.591 ms                  |
| ProcessBack:UpsertPq      | 8.622 ms                  | 16.891 ms                 |
| ProcessOneStep            | 14.599 ms                 | 26.549 ms                 |
| BlockToStepN              | 270.743 ms                | 356.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:50:55.311300 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=408, pq.top=408
W20240202 14:50:56.311007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=410, pq.top=410
W20240202 14:50:57.344404 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240202 14:50:58.344017 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=416, pq.top=416
W20240202 14:50:59.344007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.810 ms                  | 28.579 ms                 |
| Forward                   | 5.224 ms                  | 7.975 ms                  |
| Backward                  | 9.253 ms                  | 11.271 ms                 |
| Optimize                  | 2.465 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 88.684 us                 | 26.701 ms                 |
| AfterBackward             | 14.653 ms                 | 26.600 ms                 |
| BlockToStepN              | 273.082 ms                | 357.101 ms                |
| OneStep                   | 313.276 ms                | 409.902 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.535 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.478 ms                  | 3.591 ms                  |
| ProcessBack:UpsertPq      | 8.627 ms                  | 17.658 ms                 |
| ProcessOneStep            | 14.623 ms                 | 26.549 ms                 |
| BlockToStepN              | 272.982 ms                | 356.901 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:51:00.344014 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=422, pq.top=422
W20240202 14:51:01.344012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=425, pq.top=425
W20240202 14:51:02.354452 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=428, pq.top=428
W20240202 14:51:03.354019 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=430, pq.top=430
W20240202 14:51:04.354008 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=433, pq.top=433
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.818 ms                  | 28.579 ms                 |
| Forward                   | 5.229 ms                  | 7.975 ms                  |
| Backward                  | 9.253 ms                  | 11.271 ms                 |
| Optimize                  | 2.464 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 84.700 us                 | 26.701 ms                 |
| AfterBackward             | 14.653 ms                 | 26.600 ms                 |
| BlockToStepN              | 274.055 ms                | 359.292 ms                |
| OneStep                   | 315.240 ms                | 410.286 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.536 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.483 ms                  | 3.795 ms                  |
| ProcessBack:UpsertPq      | 8.655 ms                  | 17.262 ms                 |
| ProcessOneStep            | 14.645 ms                 | 26.549 ms                 |
| BlockToStepN              | 273.986 ms                | 359.231 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:51:05.354013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=436, pq.top=436
W20240202 14:51:06.367625 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240202 14:51:07.367007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240202 14:51:08.367013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=444, pq.top=444
W20240202 14:51:09.367013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.818 ms                  | 28.579 ms                 |
| Forward                   | 5.229 ms                  | 7.975 ms                  |
| Backward                  | 9.253 ms                  | 11.271 ms                 |
| Optimize                  | 2.464 ms                  | 4.876 ms                  |
| BarrierTimeBeforeRank0    | 85.264 us                 | 26.701 ms                 |
| AfterBackward             | 14.651 ms                 | 26.600 ms                 |
| BlockToStepN              | 274.734 ms                | 364.689 ms                |
| OneStep                   | 316.768 ms                | 423.472 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.534 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.484 ms                  | 3.795 ms                  |
| ProcessBack:UpsertPq      | 8.641 ms                  | 17.658 ms                 |
| ProcessOneStep            | 14.623 ms                 | 29.089 ms                 |
| BlockToStepN              | 274.606 ms                | 364.637 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:51:10.367012 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=450, pq.top=450
W20240202 14:51:11.370508 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=454, pq.top=454
W20240202 14:51:12.370009 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=456, pq.top=456
W20240202 14:51:13.370013 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240202 14:51:14.370018 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=462, pq.top=462
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.826 ms                  | 28.237 ms                 |
| Forward                   | 5.229 ms                  | 7.742 ms                  |
| Backward                  | 9.249 ms                  | 11.193 ms                 |
| Optimize                  | 2.464 ms                  | 4.717 ms                  |
| BarrierTimeBeforeRank0    | 84.700 us                 | 25.991 ms                 |
| AfterBackward             | 14.666 ms                 | 26.600 ms                 |
| BlockToStepN              | 276.078 ms                | 360.362 ms                |
| OneStep                   | 317.332 ms                | 410.286 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.537 ms                  | 3.792 ms                  |
| ProcessBack:UpdateCache   | 2.484 ms                  | 3.795 ms                  |
| ProcessBack:UpsertPq      | 8.657 ms                  | 17.658 ms                 |
| ProcessOneStep            | 14.640 ms                 | 26.549 ms                 |
| BlockToStepN              | 276.032 ms                | 360.217 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:51:15.370007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=465, pq.top=465
W20240202 14:51:16.370019 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=468, pq.top=468
W20240202 14:51:17.380228 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240202 14:51:18.380007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=474, pq.top=474
W20240202 14:51:19.380016 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=477, pq.top=477
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.826 ms                  | 32.208 ms                 |
| Forward                   | 5.224 ms                  | 7.742 ms                  |
| Backward                  | 9.249 ms                  | 11.193 ms                 |
| Optimize                  | 2.465 ms                  | 4.717 ms                  |
| BarrierTimeBeforeRank0    | 84.700 us                 | 25.991 ms                 |
| AfterBackward             | 14.666 ms                 | 26.600 ms                 |
| BlockToStepN              | 276.973 ms                | 364.689 ms                |
| OneStep                   | 318.262 ms                | 417.270 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.536 ms                  | 3.755 ms                  |
| ProcessBack:UpdateCache   | 2.478 ms                  | 3.704 ms                  |
| ProcessBack:UpsertPq      | 8.638 ms                  | 17.262 ms                 |
| ProcessOneStep            | 14.623 ms                 | 26.549 ms                 |
| BlockToStepN              | 276.514 ms                | 364.637 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:51:20.380007 47069 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=480, pq.top=480
Successfully xmh. training takes 150.1378891468048 seconds
before call kg_cache_controller.StopThreads()
W20240202 14:51:20.631340 47069 grad_async_v1.h:243] call StopThreads. PID = 46402
W20240202 14:51:20.631356 47069 grad_base.h:212] before processOneStepNegThread_.join();
W20240202 14:51:20.637493 47069 grad_base.h:214] after processOneStepNegThread_.join();
W20240202 14:51:20.637504 47069 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240202 14:51:20.719841 47069 grad_async_v1.h:264] StopThreads done.
