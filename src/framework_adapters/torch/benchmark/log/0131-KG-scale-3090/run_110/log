WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 20:18:17.822898 56663 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_152', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [56663 sampler.py:454] Start PreSampling
WARNING [56663 sampler.py:532] Before construct renumbering_dict
WARNING [56663 sampler.py:555] PreSampling done
W20240205 20:18:22.409765 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 20:18:22.409974 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 20:18:22.410032 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 20:18:22.410080 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 20:18:22.410128 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 20:18:22.410187 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 20:18:22.410226 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 20:18:22.410290 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 20:18:22.410336 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 20:18:22.410377 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 20:18:22.410436 56663 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 20:18:22.410476 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 20:18:22.410518 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 20:18:22.410665 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 20:18:22.410725 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 20:18:22.410764 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 20:18:22.410830 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 20:18:22.410879 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 20:18:22.410933 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 20:18:22.410981 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 20:18:22.411027 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 20:18:22.411068 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 20:18:22.411113 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 20:18:22.411159 56663 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 20:18:22.411192 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 20:18:22.411232 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 20:18:22.411307 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 20:18:22.411350 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 20:18:22.411387 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 20:18:22.411427 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 20:18:22.411464 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 20:18:22.411509 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 20:18:22.411556 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 20:18:22.411603 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 20:18:22.411648 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 20:18:22.411687 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 20:18:22.411732 56663 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 20:18:22.411765 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 20:18:22.411804 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 20:18:22.411875 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 20:18:22.411921 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 20:18:22.411970 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 20:18:22.412009 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 20:18:22.412070 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 20:18:22.412125 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 20:18:22.412173 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 20:18:22.412211 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 20:18:22.412256 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 20:18:22.412304 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 20:18:22.412343 56663 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 20:18:22.412376 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 20:18:22.412410 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 20:18:22.412487 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 20:18:22.412545 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 20:18:22.412586 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 20:18:22.412627 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 20:18:22.412667 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 20:18:22.412707 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 20:18:22.412762 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 20:18:22.412811 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 20:18:22.412864 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 20:18:22.412904 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 20:18:22.412946 56663 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 20:18:22.412981 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 20:18:22.413019 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 20:18:22.413090 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 20:18:22.413146 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 20:18:22.413187 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 20:18:22.413230 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 20:18:22.413271 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 20:18:22.413321 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 20:18:22.413360 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 20:18:22.413409 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 20:18:22.413453 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 20:18:22.413494 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 20:18:22.413533 56663 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 20:18:22.413568 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 20:18:22.413604 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 20:18:22.413681 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 20:18:22.413725 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 20:18:22.413765 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 20:18:22.413806 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 20:18:22.413853 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 20:18:22.413894 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 20:18:22.413944 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 20:18:22.413985 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 20:18:22.414027 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 20:18:22.414072 56663 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 20:18:22.414117 56663 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 20:18:22.414152 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 20:18:22.414186 56663 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 20:18:22.647066 56663 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x1000216be000 22.81 MB
W20240205 20:18:22.736733 56663 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100022d90000 58.4 kB
{0: Graph(num_nodes=8708, num_edges=114062,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=8851, num_edges=101101,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=6696, num_edges=94778,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10148, num_edges=151271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8972, num_edges=107004,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8551, num_edges=124920,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=9450, num_edges=118501,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8708 N 114062 E
MertisPartition: part 1 has 8851 N 101101 E
MertisPartition: part 2 has 6696 N 94778 E
MertisPartition: part 3 has 10148 N 151271 E
MertisPartition: part 4 has 8972 N 107004 E
MertisPartition: part 5 has 8551 N 124920 E
MertisPartition: part 6 has 9450 N 118501 E
Rank0: cached key size 106
Rank1: cached key size 106
Rank2: cached key size 106
Rank3: cached key size 106
Rank4: cached key size 106
Rank5: cached key size 106
Rank6: cached key size 106
Before renumbering graph:  {'_ID': tensor([    7,    16,    18,  ..., 13890,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 5, 1])}
After renumbering graph:  {'_ID': tensor([  902,  1080,  1118,  ..., 12302,  2184, 11424]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 5, 1])}
part_g: DGLGraph(num_nodes=8708, num_edges=114062,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8708, num_edges=114062,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.015 seconds
[Rank1] pid = 56867
[Rank2] pid = 56878
[Rank3] pid = 56933
[Rank4] pid = 57005
[Rank5] pid = 57126
INFO [56663 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [56867 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [56878 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [56933 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [57005 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [56933 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [56878 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [57190 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [57126 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [57005 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [57190 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [57126 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [56867 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
W20240205 20:18:25.212658 56996 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240205 20:18:25.213271 57127 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240205 20:18:25.213291 56868 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240205 20:18:25.213281 57215 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240205 20:18:25.213429 56932 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240205 20:18:25.213428 57062 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
INFO [56663 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
W20240205 20:18:25.216276 57191 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240205 20:18:25.242812 57215 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100022da4000 7.629 MB
W20240205 20:18:25.242846 57127 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100023547000 7.629 MB
W20240205 20:18:25.243021 57215 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100023cea000 7.629 MB
W20240205 20:18:25.243038 57127 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10002448d000 7.629 MB
W20240205 20:18:25.243116 57215 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x100024c30000 1.49 GB
W20240205 20:18:25.243139 57127 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x100084213000 1.49 GB
W20240205 20:18:25.243189 57215 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1000e37f6000 1.49 GB
W20240205 20:18:25.243211 57127 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x100142dd9000 1.49 GB
W20240205 20:18:25.243260 57215 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 20:18:25.243263 57127 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 20:18:25.247028 57215 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 20:18:25.247067 57127 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 20:18:25.251322 56996 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1001a23c6000 7.629 MB
W20240205 20:18:25.251516 56996 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1001a2b69000 7.629 MB
W20240205 20:18:25.251590 56996 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1001a330c000 1.49 GB
W20240205 20:18:25.251641 56996 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1002028ef000 1.49 GB
W20240205 20:18:25.251691 56996 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 20:18:25.253612 56996 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 20:18:25.267436 57062 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100261eda000 7.629 MB
W20240205 20:18:25.267524 56932 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10026267d000 7.629 MB
W20240205 20:18:25.267652 57062 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x100262e20000 7.629 MB
W20240205 20:18:25.267701 56932 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1002635c3000 7.629 MB
W20240205 20:18:25.267771 57062 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x100263d66000 1.49 GB
W20240205 20:18:25.267786 56932 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1002c3349000 1.49 GB
W20240205 20:18:25.267855 56932 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10032292c000 1.49 GB
W20240205 20:18:25.267876 57062 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x100381f0f000 1.49 GB
W20240205 20:18:25.267921 56932 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 20:18:25.267925 57062 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 20:18:25.271165 56932 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 20:18:25.271216 57062 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 20:18:25.275043 57191 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1003e14fe000 7.629 MB
W20240205 20:18:25.275066 56868 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1003e1ca1000 7.629 MB
W20240205 20:18:25.275220 57191 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1003e2444000 7.629 MB
W20240205 20:18:25.275251 56868 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1003e2be7000 7.629 MB
W20240205 20:18:25.275336 57191 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1003e338a000 1.49 GB
W20240205 20:18:25.275359 56868 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10044296d000 1.49 GB
W20240205 20:18:25.275418 57191 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1004a1f50000 1.49 GB
W20240205 20:18:25.275460 56868 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100501533000 1.49 GB
W20240205 20:18:25.275511 57191 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 20:18:25.275535 56868 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 20:18:25.281735 56868 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 20:18:25.281740 57191 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x1000216be000
5: KnownLocalCachedEmbedding init done
WARNING [57126 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
6: KnownLocalCachedEmbedding init done
WARNING [57190 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
4: KnownLocalCachedEmbedding init done
WARNING [57005 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
2: KnownLocalCachedEmbedding init done
WARNING [56878 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
3: KnownLocalCachedEmbedding init done
WARNING [56933 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
1: KnownLocalCachedEmbedding init done
WARNING [56867 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank6] pid = 57190
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229)]
cudaHostRegister 0x1000216be000
0: KnownLocalCachedEmbedding init done
WARNING [56663 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 20:18:27.240221 57191 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240205 20:18:27.240475 57215 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:18:27.240554 57062 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:18:27.240629 57127 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:18:27.240700 56932 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:18:27.240814 56868 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 20:18:27.240871 56996 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
W20240205 20:18:27.242748 57191 grad_base.h:55] KGCacheController, config={
        "num_gpus": 7,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 20:18:27.242883 57191 grad_base.h:184] Init GradProcessingBase done
I20240205 20:18:27.245321 57191 grad_async_v1.h:203] Use main thread to update emb.
W20240205 20:18:27.245358 57191 kg_controller.h:75] after init GradAsyncProcessing
I20240205 20:18:27.245366 57191 kg_controller.h:84] Construct KGCacheController done
E20240205 20:18:27.956885 56868 recstore.cc:66] init folly done
E20240205 20:18:27.956926 57215 recstore.cc:66] init folly done
E20240205 20:18:27.957453 57127 recstore.cc:66] init folly done
E20240205 20:18:27.957440 57062 recstore.cc:66] init folly done
E20240205 20:18:27.958070 56996 recstore.cc:66] init folly done
E20240205 20:18:27.958412 56932 recstore.cc:66] init folly done
E20240205 20:18:27.958439 57191 recstore.cc:66] init folly done
I20240205 20:18:27.959626 57191 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 20:18:28.664327 56996 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240205 20:18:28.666188 57191 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:18:28.670364 56932 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:18:28.671941 56868 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:18:28.673123 57062 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:18:28.674041 57127 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 20:18:28.674119 57215 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
W20240205 20:18:30.774250 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240205 20:18:30.886708 57403 grad_async_v1.h:533] Stalled in ProcessBackward: rank=1, step_no=1, sample_step_cpp_seen_[rank]=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.280 ms                  | 26.527 ms                 |
| Forward                   | 5.745 ms                  | 641.438 ms                |
| Backward                  | 8.996 ms                  | 206.473 ms                |
| Optimize                  | 3.299 ms                  | 5.581 ms                  |
| BarrierTimeBeforeRank0    | 1.486 ms                  | 27.865 ms                 |
| AfterBackward             | 26.226 ms                 | 1.217 s                   |
| BlockToStepN              | 56.867 us                 | 38.442 ms                 |
| OneStep                   | 53.125 ms                 | 2.140 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:32.523798 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.695 ms                  | 322.289 ms                |
| ProcessBack:UpdateCache   | 7.167 ms                  | 634.615 ms                |
| ProcessBack:UpsertPq      | 12.001 ms                 | 72.909 ms                 |
| ProcessOneStep            | 26.541 ms                 | 1.216 s                   |
| BlockToStepN              | 233.606 us                | 93.334 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:33.544631 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=24, pq.top=24
W20240205 20:18:34.588940 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=34, pq.top=34
W20240205 20:18:35.588019 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240205 20:18:36.588009 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.322 ms                  | 26.527 ms                 |
| Forward                   | 5.489 ms                  | 641.438 ms                |
| Backward                  | 8.866 ms                  | 206.473 ms                |
| Optimize                  | 2.666 ms                  | 5.581 ms                  |
| BarrierTimeBeforeRank0    | 1.151 ms                  | 27.865 ms                 |
| AfterBackward             | 29.059 ms                 | 1.217 s                   |
| BlockToStepN              | 22.122 ms                 | 680.557 ms                |
| OneStep                   | 93.066 ms                 | 2.140 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:37.588008 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.653 ms                  | 285.485 ms                |
| ProcessBack:UpdateCache   | 7.465 ms                  | 634.425 ms                |
| ProcessBack:UpsertPq      | 14.126 ms                 | 68.930 ms                 |
| ProcessOneStep            | 29.040 ms                 | 837.176 ms                |
| BlockToStepN              | 25.558 ms                 | 680.415 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:38.625499 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=54, pq.top=54
W20240205 20:18:39.625020 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=58, pq.top=58
W20240205 20:18:40.625006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240205 20:18:41.661890 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=68, pq.top=68
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.715 ms                  | 26.527 ms                 |
| Forward                   | 5.476 ms                  | 15.645 ms                 |
| Backward                  | 8.914 ms                  | 16.273 ms                 |
| Optimize                  | 2.635 ms                  | 5.581 ms                  |
| BarrierTimeBeforeRank0    | 1.552 ms                  | 19.007 ms                 |
| AfterBackward             | 31.535 ms                 | 837.345 ms                |
| BlockToStepN              | 44.863 ms                 | 680.557 ms                |
| OneStep                   | 105.361 ms                | 857.880 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:42.661011 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.844 ms                  | 285.485 ms                |
| ProcessBack:UpdateCache   | 7.460 ms                  | 634.425 ms                |
| ProcessBack:UpsertPq      | 15.825 ms                 | 68.930 ms                 |
| ProcessOneStep            | 31.506 ms                 | 837.176 ms                |
| BlockToStepN              | 47.557 ms                 | 680.415 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:43.661007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240205 20:18:44.698891 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240205 20:18:45.698006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=80, pq.top=80
W20240205 20:18:46.698010 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.769 ms                  | 27.312 ms                 |
| Forward                   | 5.505 ms                  | 15.645 ms                 |
| Backward                  | 8.888 ms                  | 16.273 ms                 |
| Optimize                  | 2.635 ms                  | 5.581 ms                  |
| BarrierTimeBeforeRank0    | 880.067 us                | 19.007 ms                 |
| AfterBackward             | 31.967 ms                 | 837.345 ms                |
| BlockToStepN              | 57.107 ms                 | 680.557 ms                |
| OneStep                   | 131.873 ms                | 857.880 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:47.731058 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=86, pq.top=86
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.855 ms                  | 14.178 ms                 |
| ProcessBack:UpdateCache   | 7.431 ms                  | 12.520 ms                 |
| ProcessBack:UpsertPq      | 16.863 ms                 | 59.791 ms                 |
| ProcessOneStep            | 31.940 ms                 | 837.176 ms                |
| BlockToStepN              | 57.292 ms                 | 680.415 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:48.780128 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240205 20:18:49.780006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240205 20:18:50.780006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=94, pq.top=94
W20240205 20:18:51.780009 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.810 ms                  | 28.589 ms                 |
| Forward                   | 5.564 ms                  | 15.645 ms                 |
| Backward                  | 8.867 ms                  | 16.273 ms                 |
| Optimize                  | 2.640 ms                  | 6.219 ms                  |
| BarrierTimeBeforeRank0    | 1.151 ms                  | 25.322 ms                 |
| AfterBackward             | 31.971 ms                 | 837.345 ms                |
| BlockToStepN              | 123.006 ms                | 680.557 ms                |
| OneStep                   | 187.603 ms                | 857.880 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:52.780012 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=100, pq.top=100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.853 ms                  | 14.178 ms                 |
| ProcessBack:UpdateCache   | 7.402 ms                  | 12.520 ms                 |
| ProcessBack:UpsertPq      | 17.209 ms                 | 59.791 ms                 |
| ProcessOneStep            | 31.941 ms                 | 837.176 ms                |
| BlockToStepN              | 130.942 ms                | 680.415 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 24.320, sample: 0.414, forward: 1.129, backward: 1.211, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 24.321, sample: 0.486, forward: 1.099, backward: 1.176, update: 0.282
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 24.323, sample: 0.458, forward: 1.139, backward: 0.983, update: 0.281
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 24.320, sample: 0.416, forward: 1.103, backward: 1.137, update: 0.280
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 24.324, sample: 0.426, forward: 1.126, backward: 1.177, update: 0.284
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 24.330, sample: 0.437, forward: 1.147, backward: 1.163, update: 0.282
train_sampler.Prefill()
-------Step 0-------
tensor([ 3195,  3386, 11743, 12342,  5198, 11061,  4117,     0,    78, 12748]) tensor([ 1118,  9169,  1900,  8464,    55,  7868,   311,  3383, 11816, 10946])
-------Step 1-------
tensor([ 3195,  3386, 11743, 12342,  5198, 11061,  4117,     0,    78, 12748]) tensor([14312, 10293,  3854, 10000, 10694,  9565,  1960,  1499,   536,  6437])
-------Step 2-------
tensor([ 3224, 10029,  3330, 14284, 13384, 10899,  5073, 14752,  9928,    55]) tensor([ 4560, 10737, 11258,  6954,  7044,  9785,  9013, 11001,  9152, 14020])
-------Step 3-------
tensor([ 3224, 10029,  3330, 14284, 13384, 10899,  5073, 14752,  9928,    55]) tensor([ 5105, 12530,   591,  4762,  1951,   937,  8956,  7681,  3436, 13493])
-------Step 4-------
tensor([13528, 10697, 10625,  6024,  4068,  1023, 13360,  7315,  9887,  2485]) tensor([10442, 11547,  2618,  1104, 13029,  7802, 12718,  6234,  3195,  6575])
-------Step 5-------
tensor([13528, 10697, 10625,  6024,  4068,  1023, 13360,  7315,  9887,  2485]) tensor([ 5543,  8019,  7543,  4707,  2235, 14203, 10822, 11467,  1940,  3744])
-------Step 6-------
tensor([   24,   946, 11354,  1549,  5287,  2715, 10895, 13095,  7831,    57]) tensor([ 6088,  1145, 10199,  9719,   198,  2946,  5855, 13231,  4689,  5454])
-------Step 7-------
tensor([   24,   946, 11354,  1549,  5287,  2715, 10895, 13095,  7831,    57]) tensor([ 5031,  6965,  3544,  1712,  8766,  3443,  3333,  6908, 10922,    13])
-------Step 8-------
tensor([ 6085, 11519, 11378,   902,  1777,  4094,  2289, 12155,  9437,  2654]) tensor([ 1573,  1077,  9918, 10590,  8317, 11035,  5522,  8919,  7423,  1128])
-------Step 9-------
tensor([ 6085, 11519, 11378,   902,  1777,  4094,  2289, 12155,  9437,  2654]) tensor([ 4933,  5392,  9846,  9141,  1718,  8642, 11855,  4392, 10230,  4371])
before start barrier
start train
[proc 0] 100 steps, total: 24.328, sample: 0.509, forward: 1.220, backward: 1.112, update: 0.296
W20240205 20:18:53.811760 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240205 20:18:54.811005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
W20240205 20:18:55.811007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240205 20:18:56.811009 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=114, pq.top=114
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.810 ms                  | 29.017 ms                 |
| Forward                   | 5.525 ms                  | 15.645 ms                 |
| Backward                  | 8.888 ms                  | 16.273 ms                 |
| Optimize                  | 2.635 ms                  | 9.023 ms                  |
| BarrierTimeBeforeRank0    | 1.552 ms                  | 26.193 ms                 |
| AfterBackward             | 32.015 ms                 | 837.345 ms                |
| BlockToStepN              | 137.277 ms                | 680.557 ms                |
| OneStep                   | 206.526 ms                | 857.880 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:57.811015 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.758 ms                  | 14.178 ms                 |
| ProcessBack:UpdateCache   | 7.345 ms                  | 12.520 ms                 |
| ProcessBack:UpsertPq      | 17.224 ms                 | 59.791 ms                 |
| ProcessOneStep            | 31.941 ms                 | 837.176 ms                |
| BlockToStepN              | 138.688 ms                | 680.415 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:18:58.811007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=120, pq.top=120
W20240205 20:18:59.811005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240205 20:19:00.836174 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=126, pq.top=126
W20240205 20:19:01.857331 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.769 ms                  | 29.017 ms                 |
| Forward                   | 5.476 ms                  | 15.645 ms                 |
| Backward                  | 8.909 ms                  | 16.273 ms                 |
| Optimize                  | 2.634 ms                  | 9.023 ms                  |
| BarrierTimeBeforeRank0    | 1.796 ms                  | 27.574 ms                 |
| AfterBackward             | 31.798 ms                 | 837.345 ms                |
| BlockToStepN              | 174.048 ms                | 680.557 ms                |
| OneStep                   | 277.340 ms                | 857.880 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:02.857012 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.679 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 7.345 ms                  | 10.752 ms                 |
| ProcessBack:UpsertPq      | 16.925 ms                 | 59.053 ms                 |
| ProcessOneStep            | 31.681 ms                 | 837.176 ms                |
| BlockToStepN              | 191.629 ms                | 680.415 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:03.857015 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=134, pq.top=134
W20240205 20:19:04.857008 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240205 20:19:05.857007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240205 20:19:06.857005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.769 ms                  | 29.017 ms                 |
| Forward                   | 5.442 ms                  | 15.645 ms                 |
| Backward                  | 8.914 ms                  | 16.273 ms                 |
| Optimize                  | 2.640 ms                  | 9.023 ms                  |
| BarrierTimeBeforeRank0    | 1.892 ms                  | 27.574 ms                 |
| AfterBackward             | 31.712 ms                 | 837.345 ms                |
| BlockToStepN              | 240.708 ms                | 680.557 ms                |
| OneStep                   | 306.764 ms                | 857.880 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:07.857026 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=146, pq.top=146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.679 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 7.389 ms                  | 10.752 ms                 |
| ProcessBack:UpsertPq      | 16.848 ms                 | 59.053 ms                 |
| ProcessOneStep            | 31.681 ms                 | 837.176 ms                |
| BlockToStepN              | 241.522 ms                | 680.415 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:08.857017 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=148, pq.top=148
W20240205 20:19:09.857007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240205 20:19:10.857005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240205 20:19:11.857007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.799 ms                  | 29.017 ms                 |
| Forward                   | 5.476 ms                  | 10.439 ms                 |
| Backward                  | 8.867 ms                  | 16.228 ms                 |
| Optimize                  | 2.623 ms                  | 6.286 ms                  |
| BarrierTimeBeforeRank0    | 2.469 ms                  | 27.574 ms                 |
| AfterBackward             | 31.535 ms                 | 113.419 ms                |
| BlockToStepN              | 247.206 ms                | 359.438 ms                |
| OneStep                   | 316.663 ms                | 847.405 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:12.857007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.649 ms                  | 10.940 ms                 |
| ProcessBack:UpdateCache   | 7.371 ms                  | 10.752 ms                 |
| ProcessBack:UpsertPq      | 16.586 ms                 | 59.053 ms                 |
| ProcessOneStep            | 31.454 ms                 | 113.360 ms                |
| BlockToStepN              | 247.324 ms                | 359.285 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:13.857023 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240205 20:19:14.857007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=164, pq.top=164
W20240205 20:19:15.857005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240205 20:19:16.857009 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.799 ms                  | 29.668 ms                 |
| Forward                   | 5.489 ms                  | 11.741 ms                 |
| Backward                  | 8.838 ms                  | 16.228 ms                 |
| Optimize                  | 2.595 ms                  | 6.286 ms                  |
| BarrierTimeBeforeRank0    | 2.582 ms                  | 29.229 ms                 |
| AfterBackward             | 31.479 ms                 | 113.419 ms                |
| BlockToStepN              | 254.985 ms                | 369.618 ms                |
| OneStep                   | 321.907 ms                | 847.405 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:17.857005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=172, pq.top=172
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.638 ms                  | 10.940 ms                 |
| ProcessBack:UpdateCache   | 7.420 ms                  | 12.520 ms                 |
| ProcessBack:UpsertPq      | 16.567 ms                 | 59.053 ms                 |
| ProcessOneStep            | 31.451 ms                 | 113.360 ms                |
| BlockToStepN              | 256.675 ms                | 369.558 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:18.859077 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240205 20:19:19.859016 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240205 20:19:20.861255 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240205 20:19:21.861008 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=182, pq.top=182
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.799 ms                  | 29.668 ms                 |
| Forward                   | 5.513 ms                  | 11.741 ms                 |
| Backward                  | 8.838 ms                  | 16.228 ms                 |
| Optimize                  | 2.621 ms                  | 6.286 ms                  |
| BarrierTimeBeforeRank0    | 2.790 ms                  | 29.229 ms                 |
| AfterBackward             | 31.475 ms                 | 113.419 ms                |
| BlockToStepN              | 263.778 ms                | 408.660 ms                |
| OneStep                   | 326.843 ms                | 847.405 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:22.861007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.640 ms                  | 10.891 ms                 |
| ProcessBack:UpdateCache   | 7.420 ms                  | 10.752 ms                 |
| ProcessBack:UpsertPq      | 16.230 ms                 | 36.228 ms                 |
| ProcessOneStep            | 31.259 ms                 | 113.360 ms                |
| BlockToStepN              | 264.311 ms                | 408.599 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:23.878393 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240205 20:19:24.878022 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240205 20:19:25.878006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240205 20:19:26.878006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.792 ms                  | 29.950 ms                 |
| Forward                   | 5.533 ms                  | 15.645 ms                 |
| Backward                  | 8.832 ms                  | 16.228 ms                 |
| Optimize                  | 2.595 ms                  | 6.286 ms                  |
| BarrierTimeBeforeRank0    | 3.371 ms                  | 29.726 ms                 |
| AfterBackward             | 31.207 ms                 | 113.419 ms                |
| BlockToStepN              | 266.573 ms                | 408.660 ms                |
| OneStep                   | 330.425 ms                | 847.405 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:27.878008 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.613 ms                  | 10.891 ms                 |
| ProcessBack:UpdateCache   | 7.402 ms                  | 10.752 ms                 |
| ProcessBack:UpsertPq      | 16.135 ms                 | 36.228 ms                 |
| ProcessOneStep            | 31.125 ms                 | 113.360 ms                |
| BlockToStepN              | 267.448 ms                | 408.599 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 35.776, sample: 0.446, forward: 0.516, backward: 0.968, update: 0.269
[proc 5] 200 steps, total: 35.776, sample: 0.455, forward: 0.483, backward: 0.949, update: 0.272
[proc 1] 200 steps, total: 35.776, sample: 0.455, forward: 0.488, backward: 0.992, update: 0.273
[proc 6] 200 steps, total: 35.776, sample: 0.423, forward: 0.486, backward: 0.948, update: 0.266
[proc 3] 200 steps, total: 35.775, sample: 0.446, forward: 0.503, backward: 0.958, update: 0.279
[proc 0] 200 steps, total: 35.775, sample: 0.522, forward: 0.569, backward: 0.734, update: 0.270
[proc 4] 200 steps, total: 35.776, sample: 0.397, forward: 0.491, backward: 0.977, update: 0.267
W20240205 20:19:28.878005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240205 20:19:29.878023 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240205 20:19:30.878851 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240205 20:19:31.878006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.799 ms                  | 29.950 ms                 |
| Forward                   | 5.533 ms                  | 15.645 ms                 |
| Backward                  | 8.806 ms                  | 16.228 ms                 |
| Optimize                  | 2.552 ms                  | 6.286 ms                  |
| BarrierTimeBeforeRank0    | 3.522 ms                  | 29.726 ms                 |
| AfterBackward             | 30.968 ms                 | 113.419 ms                |
| BlockToStepN              | 271.100 ms                | 408.660 ms                |
| OneStep                   | 340.195 ms                | 847.405 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:32.904311 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.573 ms                  | 10.891 ms                 |
| ProcessBack:UpdateCache   | 7.397 ms                  | 10.752 ms                 |
| ProcessBack:UpsertPq      | 15.911 ms                 | 36.228 ms                 |
| ProcessOneStep            | 30.804 ms                 | 113.360 ms                |
| BlockToStepN              | 272.011 ms                | 408.599 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:33.904007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240205 20:19:34.904018 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=216, pq.top=216
W20240205 20:19:35.904006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240205 20:19:36.928017 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.808 ms                  | 32.824 ms                 |
| Forward                   | 5.564 ms                  | 15.645 ms                 |
| Backward                  | 8.779 ms                  | 16.228 ms                 |
| Optimize                  | 2.540 ms                  | 6.286 ms                  |
| BarrierTimeBeforeRank0    | 3.556 ms                  | 29.726 ms                 |
| AfterBackward             | 30.968 ms                 | 113.419 ms                |
| BlockToStepN              | 281.038 ms                | 408.660 ms                |
| OneStep                   | 346.553 ms                | 847.405 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:37.928006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.549 ms                  | 10.891 ms                 |
| ProcessBack:UpdateCache   | 7.402 ms                  | 10.752 ms                 |
| ProcessBack:UpsertPq      | 15.817 ms                 | 36.228 ms                 |
| ProcessOneStep            | 30.804 ms                 | 113.360 ms                |
| BlockToStepN              | 280.992 ms                | 408.599 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:38.928007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240205 20:19:39.928005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240205 20:19:40.947510 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240205 20:19:41.947005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.799 ms                  | 32.824 ms                 |
| Forward                   | 5.564 ms                  | 15.645 ms                 |
| Backward                  | 8.761 ms                  | 16.228 ms                 |
| Optimize                  | 2.531 ms                  | 6.286 ms                  |
| BarrierTimeBeforeRank0    | 4.929 ms                  | 29.826 ms                 |
| AfterBackward             | 30.497 ms                 | 113.419 ms                |
| BlockToStepN              | 285.670 ms                | 438.466 ms                |
| OneStep                   | 350.469 ms                | 847.405 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:42.947007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.491 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 7.406 ms                  | 10.224 ms                 |
| ProcessBack:UpsertPq      | 15.751 ms                 | 35.983 ms                 |
| ProcessOneStep            | 30.469 ms                 | 113.360 ms                |
| BlockToStepN              | 285.623 ms                | 438.400 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:43.947006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240205 20:19:44.947008 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
W20240205 20:19:45.947018 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240205 20:19:46.947008 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.799 ms                  | 32.824 ms                 |
| Forward                   | 5.564 ms                  | 15.645 ms                 |
| Backward                  | 8.710 ms                  | 16.228 ms                 |
| Optimize                  | 2.502 ms                  | 6.286 ms                  |
| BarrierTimeBeforeRank0    | 5.009 ms                  | 32.466 ms                 |
| AfterBackward             | 30.370 ms                 | 113.419 ms                |
| BlockToStepN              | 288.841 ms                | 438.466 ms                |
| OneStep                   | 355.532 ms                | 847.405 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:47.947008 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=248, pq.top=248
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.464 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 7.402 ms                  | 10.224 ms                 |
| ProcessBack:UpsertPq      | 15.524 ms                 | 35.983 ms                 |
| ProcessOneStep            | 30.337 ms                 | 113.360 ms                |
| BlockToStepN              | 289.541 ms                | 438.400 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:48.947007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
W20240205 20:19:50.014147 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240205 20:19:51.014016 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240205 20:19:52.014010 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.759 ms                  | 29.950 ms                 |
| Forward                   | 5.545 ms                  | 11.741 ms                 |
| Backward                  | 8.697 ms                  | 15.397 ms                 |
| Optimize                  | 2.496 ms                  | 6.219 ms                  |
| BarrierTimeBeforeRank0    | 5.295 ms                  | 30.231 ms                 |
| AfterBackward             | 29.998 ms                 | 77.058 ms                 |
| BlockToStepN              | 291.689 ms                | 435.530 ms                |
| OneStep                   | 360.995 ms                | 745.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.445 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 7.399 ms                  | 10.249 ms                 |
| ProcessBack:UpsertPq      | 15.402 ms                 | 35.983 ms                 |
| ProcessOneStep            | 29.970 ms                 | 77.006 ms                 |
| BlockToStepN              | 291.644 ms                | 438.400 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:53.014004 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240205 20:19:54.014006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
W20240205 20:19:55.014006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240205 20:19:56.014007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240205 20:19:57.014016 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.759 ms                  | 29.950 ms                 |
| Forward                   | 5.533 ms                  | 11.741 ms                 |
| Backward                  | 8.723 ms                  | 15.397 ms                 |
| Optimize                  | 2.482 ms                  | 6.219 ms                  |
| BarrierTimeBeforeRank0    | 5.295 ms                  | 30.596 ms                 |
| AfterBackward             | 29.764 ms                 | 77.058 ms                 |
| BlockToStepN              | 294.649 ms                | 438.466 ms                |
| OneStep                   | 362.704 ms                | 745.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.438 ms                  | 10.367 ms                 |
| ProcessBack:UpdateCache   | 7.363 ms                  | 10.249 ms                 |
| ProcessBack:UpsertPq      | 15.266 ms                 | 35.983 ms                 |
| ProcessOneStep            | 29.720 ms                 | 77.006 ms                 |
| BlockToStepN              | 294.924 ms                | 438.400 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:19:58.014004 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240205 20:19:59.014006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240205 20:20:00.014007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=276, pq.top=276
W20240205 20:20:01.014006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240205 20:20:02.014020 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.735 ms                  | 29.950 ms                 |
| Forward                   | 5.523 ms                  | 11.741 ms                 |
| Backward                  | 8.761 ms                  | 15.397 ms                 |
| Optimize                  | 2.479 ms                  | 6.219 ms                  |
| BarrierTimeBeforeRank0    | 5.295 ms                  | 30.596 ms                 |
| AfterBackward             | 29.639 ms                 | 77.058 ms                 |
| BlockToStepN              | 297.788 ms                | 438.466 ms                |
| OneStep                   | 364.758 ms                | 745.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.420 ms                  | 10.257 ms                 |
| ProcessBack:UpdateCache   | 7.333 ms                  | 10.224 ms                 |
| ProcessBack:UpsertPq      | 15.175 ms                 | 31.124 ms                 |
| ProcessOneStep            | 29.692 ms                 | 77.006 ms                 |
| BlockToStepN              | 297.746 ms                | 438.400 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:03.056978 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240205 20:20:04.056006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240205 20:20:05.056006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240205 20:20:06.056013 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240205 20:20:07.056010 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.715 ms                  | 29.950 ms                 |
| Forward                   | 5.501 ms                  | 11.741 ms                 |
| Backward                  | 8.726 ms                  | 15.397 ms                 |
| Optimize                  | 2.469 ms                  | 6.219 ms                  |
| BarrierTimeBeforeRank0    | 5.733 ms                  | 31.079 ms                 |
| AfterBackward             | 29.592 ms                 | 77.058 ms                 |
| BlockToStepN              | 300.517 ms                | 438.466 ms                |
| OneStep                   | 368.477 ms                | 745.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.405 ms                  | 10.257 ms                 |
| ProcessBack:UpdateCache   | 7.302 ms                  | 10.224 ms                 |
| ProcessBack:UpsertPq      | 15.020 ms                 | 31.124 ms                 |
| ProcessOneStep            | 29.561 ms                 | 77.006 ms                 |
| BlockToStepN              | 301.989 ms                | 438.400 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:08.056005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240205 20:20:09.056006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=298, pq.top=298
[proc 1] 300 steps, total: 41.234, sample: 0.464, forward: 0.514, backward: 0.885, update: 0.264
[proc 6] 300 steps, total: 41.234, sample: 0.429, forward: 0.490, backward: 0.930, update: 0.267
[proc 4] 300 steps, total: 41.234, sample: 0.427, forward: 0.460, backward: 0.959, update: 0.255
[proc 0] 300 steps, total: 41.234, sample: 0.510, forward: 0.534, backward: 0.577, update: 0.231
[proc 2] 300 steps, total: 41.234, sample: 0.386, forward: 0.490, backward: 0.885, update: 0.261
[proc 5] 300 steps, total: 41.234, sample: 0.407, forward: 0.493, backward: 0.947, update: 0.271
[proc 3] 300 steps, total: 41.234, sample: 0.446, forward: 0.505, backward: 0.940, update: 0.265
W20240205 20:20:10.056006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240205 20:20:11.056015 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240205 20:20:12.056015 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.704 ms                  | 29.950 ms                 |
| Forward                   | 5.485 ms                  | 11.741 ms                 |
| Backward                  | 8.761 ms                  | 15.397 ms                 |
| Optimize                  | 2.451 ms                  | 6.219 ms                  |
| BarrierTimeBeforeRank0    | 5.592 ms                  | 31.079 ms                 |
| AfterBackward             | 29.477 ms                 | 77.058 ms                 |
| BlockToStepN              | 303.808 ms                | 454.103 ms                |
| OneStep                   | 370.147 ms                | 745.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.384 ms                  | 10.257 ms                 |
| ProcessBack:UpdateCache   | 7.264 ms                  | 10.224 ms                 |
| ProcessBack:UpsertPq      | 15.009 ms                 | 31.124 ms                 |
| ProcessOneStep            | 29.466 ms                 | 77.006 ms                 |
| BlockToStepN              | 303.742 ms                | 453.959 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:13.110316 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240205 20:20:14.110008 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=310, pq.top=310
W20240205 20:20:15.110014 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240205 20:20:16.110010 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240205 20:20:17.110006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.704 ms                  | 29.950 ms                 |
| Forward                   | 5.472 ms                  | 11.741 ms                 |
| Backward                  | 8.774 ms                  | 15.397 ms                 |
| Optimize                  | 2.443 ms                  | 6.219 ms                  |
| BarrierTimeBeforeRank0    | 5.420 ms                  | 31.079 ms                 |
| AfterBackward             | 29.434 ms                 | 77.058 ms                 |
| BlockToStepN              | 306.737 ms                | 454.103 ms                |
| OneStep                   | 371.033 ms                | 745.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.374 ms                  | 10.257 ms                 |
| ProcessBack:UpdateCache   | 7.226 ms                  | 10.224 ms                 |
| ProcessBack:UpsertPq      | 14.919 ms                 | 31.124 ms                 |
| ProcessOneStep            | 29.322 ms                 | 77.006 ms                 |
| BlockToStepN              | 306.665 ms                | 453.959 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:18.140934 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240205 20:20:19.140007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=322, pq.top=322
W20240205 20:20:20.140017 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=324, pq.top=324
W20240205 20:20:21.140012 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=326, pq.top=326
W20240205 20:20:22.140007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=329, pq.top=329
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.674 ms                  | 29.950 ms                 |
| Forward                   | 5.446 ms                  | 11.741 ms                 |
| Backward                  | 8.782 ms                  | 15.397 ms                 |
| Optimize                  | 2.443 ms                  | 6.219 ms                  |
| BarrierTimeBeforeRank0    | 5.606 ms                  | 31.079 ms                 |
| AfterBackward             | 29.271 ms                 | 77.058 ms                 |
| BlockToStepN              | 308.360 ms                | 454.103 ms                |
| OneStep                   | 373.686 ms                | 745.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.370 ms                  | 10.204 ms                 |
| ProcessBack:UpdateCache   | 7.177 ms                  | 10.061 ms                 |
| ProcessBack:UpsertPq      | 14.755 ms                 | 30.495 ms                 |
| ProcessOneStep            | 29.245 ms                 | 77.006 ms                 |
| BlockToStepN              | 308.398 ms                | 453.959 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:23.140007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240205 20:20:24.140007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240205 20:20:25.140015 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240205 20:20:26.201445 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=338, pq.top=338
W20240205 20:20:27.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.685 ms                  | 29.950 ms                 |
| Forward                   | 5.429 ms                  | 11.741 ms                 |
| Backward                  | 8.783 ms                  | 15.397 ms                 |
| Optimize                  | 2.441 ms                  | 6.219 ms                  |
| BarrierTimeBeforeRank0    | 5.606 ms                  | 31.079 ms                 |
| AfterBackward             | 29.140 ms                 | 77.058 ms                 |
| BlockToStepN              | 310.626 ms                | 454.103 ms                |
| OneStep                   | 374.892 ms                | 745.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.363 ms                  | 10.204 ms                 |
| ProcessBack:UpdateCache   | 7.157 ms                  | 10.061 ms                 |
| ProcessBack:UpsertPq      | 14.683 ms                 | 30.495 ms                 |
| ProcessOneStep            | 29.115 ms                 | 77.006 ms                 |
| BlockToStepN              | 311.583 ms                | 453.959 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:28.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=342, pq.top=342
W20240205 20:20:29.201009 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=344, pq.top=344
W20240205 20:20:30.201012 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240205 20:20:31.201011 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=349, pq.top=349
W20240205 20:20:32.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=352, pq.top=352
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.685 ms                  | 29.757 ms                 |
| Forward                   | 5.410 ms                  | 10.439 ms                 |
| Backward                  | 8.795 ms                  | 14.944 ms                 |
| Optimize                  | 2.436 ms                  | 5.646 ms                  |
| BarrierTimeBeforeRank0    | 5.606 ms                  | 30.596 ms                 |
| AfterBackward             | 29.059 ms                 | 55.998 ms                 |
| BlockToStepN              | 312.715 ms                | 450.857 ms                |
| OneStep                   | 376.004 ms                | 533.028 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.354 ms                  | 10.204 ms                 |
| ProcessBack:UpdateCache   | 7.126 ms                  | 10.061 ms                 |
| ProcessBack:UpsertPq      | 14.585 ms                 | 30.495 ms                 |
| ProcessOneStep            | 29.034 ms                 | 55.723 ms                 |
| BlockToStepN              | 312.673 ms                | 450.794 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:33.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=354, pq.top=354
W20240205 20:20:34.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=356, pq.top=356
W20240205 20:20:35.201015 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=358, pq.top=358
W20240205 20:20:36.201010 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=361, pq.top=361
W20240205 20:20:37.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=363, pq.top=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.672 ms                  | 29.757 ms                 |
| Forward                   | 5.402 ms                  | 10.439 ms                 |
| Backward                  | 8.816 ms                  | 14.944 ms                 |
| Optimize                  | 2.436 ms                  | 5.646 ms                  |
| BarrierTimeBeforeRank0    | 5.846 ms                  | 30.596 ms                 |
| AfterBackward             | 28.997 ms                 | 55.998 ms                 |
| BlockToStepN              | 314.267 ms                | 450.857 ms                |
| OneStep                   | 378.098 ms                | 533.028 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.349 ms                  | 10.204 ms                 |
| ProcessBack:UpdateCache   | 7.088 ms                  | 10.061 ms                 |
| ProcessBack:UpsertPq      | 14.574 ms                 | 30.495 ms                 |
| ProcessOneStep            | 28.965 ms                 | 55.723 ms                 |
| BlockToStepN              | 314.195 ms                | 450.794 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:38.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=366, pq.top=366
W20240205 20:20:39.201007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=368, pq.top=368
W20240205 20:20:40.201016 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=370, pq.top=370
W20240205 20:20:41.201012 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240205 20:20:42.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.674 ms                  | 29.757 ms                 |
| Forward                   | 5.402 ms                  | 11.741 ms                 |
| Backward                  | 8.816 ms                  | 14.944 ms                 |
| Optimize                  | 2.436 ms                  | 5.646 ms                  |
| BarrierTimeBeforeRank0    | 5.849 ms                  | 30.596 ms                 |
| AfterBackward             | 28.998 ms                 | 55.998 ms                 |
| BlockToStepN              | 316.477 ms                | 454.103 ms                |
| OneStep                   | 380.260 ms                | 533.028 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.343 ms                  | 9.614 ms                  |
| ProcessBack:UpdateCache   | 7.120 ms                  | 9.975 ms                  |
| ProcessBack:UpsertPq      | 14.570 ms                 | 31.124 ms                 |
| ProcessOneStep            | 28.965 ms                 | 55.723 ms                 |
| BlockToStepN              | 316.454 ms                | 453.959 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:43.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240205 20:20:44.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240205 20:20:45.201018 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240205 20:20:46.201006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=384, pq.top=384
W20240205 20:20:47.201007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=386, pq.top=386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.660 ms                  | 29.757 ms                 |
| Forward                   | 5.410 ms                  | 11.741 ms                 |
| Backward                  | 8.816 ms                  | 14.944 ms                 |
| Optimize                  | 2.436 ms                  | 5.646 ms                  |
| BarrierTimeBeforeRank0    | 5.849 ms                  | 30.596 ms                 |
| AfterBackward             | 28.980 ms                 | 55.998 ms                 |
| BlockToStepN              | 317.232 ms                | 454.103 ms                |
| OneStep                   | 381.283 ms                | 533.028 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.343 ms                  | 10.204 ms                 |
| ProcessBack:UpdateCache   | 7.127 ms                  | 10.061 ms                 |
| ProcessBack:UpsertPq      | 14.546 ms                 | 31.124 ms                 |
| ProcessOneStep            | 28.947 ms                 | 55.723 ms                 |
| BlockToStepN              | 317.243 ms                | 453.959 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:48.201004 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=388, pq.top=388
W20240205 20:20:49.213521 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240205 20:20:50.213014 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240205 20:20:51.213007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=395, pq.top=395
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.672 ms                  | 29.757 ms                 |
| Forward                   | 5.410 ms                  | 11.741 ms                 |
| Backward                  | 8.815 ms                  | 14.944 ms                 |
| Optimize                  | 2.441 ms                  | 5.646 ms                  |
| BarrierTimeBeforeRank0    | 6.111 ms                  | 30.596 ms                 |
| AfterBackward             | 28.945 ms                 | 55.998 ms                 |
| BlockToStepN              | 321.159 ms                | 454.103 ms                |
| OneStep                   | 382.270 ms                | 533.028 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:52.278193 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=398, pq.top=398
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.336 ms                  | 10.204 ms                 |
| ProcessBack:UpdateCache   | 7.127 ms                  | 10.061 ms                 |
| ProcessBack:UpsertPq      | 14.480 ms                 | 31.124 ms                 |
| ProcessOneStep            | 28.915 ms                 | 55.723 ms                 |
| BlockToStepN              | 319.384 ms                | 453.959 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:53.278007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=400, pq.top=400
[proc 4] 400 steps, total: 43.392, sample: 0.408, forward: 0.469, backward: 0.970, update: 0.258
[proc 6] 400 steps, total: 43.392, sample: 0.420, forward: 0.472, backward: 0.938, update: 0.262
[proc 5] 400 steps, total: 43.392, sample: 0.406, forward: 0.475, backward: 0.471, update: 0.217
[proc 2] 400 steps, total: 43.392, sample: 0.419, forward: 0.492, backward: 0.935, update: 0.264
[proc 1] 400 steps, total: 43.392, sample: 0.413, forward: 0.486, backward: 0.931, update: 0.267
[proc 0] 400 steps, total: 43.392, sample: 0.427, forward: 0.521, backward: 0.860, update: 0.244
[proc 3] 400 steps, total: 43.392, sample: 0.396, forward: 0.503, backward: 0.939, update: 0.268
W20240205 20:20:54.278005 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240205 20:20:55.278015 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240205 20:20:56.278010 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=407, pq.top=407
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.664 ms                  | 29.757 ms                 |
| Forward                   | 5.431 ms                  | 11.741 ms                 |
| Backward                  | 8.816 ms                  | 14.944 ms                 |
| Optimize                  | 2.441 ms                  | 5.646 ms                  |
| BarrierTimeBeforeRank0    | 6.474 ms                  | 30.596 ms                 |
| AfterBackward             | 28.931 ms                 | 55.998 ms                 |
| BlockToStepN              | 321.586 ms                | 454.103 ms                |
| OneStep                   | 382.974 ms                | 533.028 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:57.278007 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=410, pq.top=410
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.332 ms                  | 10.204 ms                 |
| ProcessBack:UpdateCache   | 7.134 ms                  | 10.061 ms                 |
| ProcessBack:UpsertPq      | 14.480 ms                 | 31.124 ms                 |
| ProcessOneStep            | 28.915 ms                 | 55.723 ms                 |
| BlockToStepN              | 321.430 ms                | 458.642 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:20:58.293813 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=412, pq.top=412
W20240205 20:20:59.293006 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240205 20:21:00.324390 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240205 20:21:01.324012 57191 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=418, pq.top=418
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.670 ms                  | 29.757 ms                 |
| Forward                   | 5.431 ms                  | 11.741 ms                 |
| Backward                  | 8.815 ms                  | 14.944 ms                 |
| Optimize                  | 2.441 ms                  | 5.646 ms                  |
| BarrierTimeBeforeRank0    | 6.522 ms                  | 30.596 ms                 |
| AfterBackward             | 28.945 ms                 | 55.998 ms                 |
| BlockToStepN              | 322.871 ms                | 485.326 ms                |
| OneStep                   | 386.191 ms                | 595.328 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 153.64939713478088 seconds
before call kg_cache_controller.StopThreads()
W20240205 20:21:02.315686 57191 grad_async_v1.h:243] call StopThreads. PID = 56663
W20240205 20:21:02.315709 57191 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 20:21:02.324180 57191 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 20:21:02.324199 57191 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 20:21:02.441202 57191 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.332 ms                  | 10.204 ms                 |
| ProcessBack:UpdateCache   | 7.156 ms                  | 10.061 ms                 |
| ProcessBack:UpsertPq      | 14.480 ms                 | 31.124 ms                 |
| ProcessOneStep            | 28.915 ms                 | 55.723 ms                 |
| BlockToStepN              | 322.820 ms                | 485.269 ms                |
+---------------------------+---------------------------+---------------------------+
