WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240208 04:27:51.891871 23361 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_62', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [23361 sampler.py:454] Start PreSampling
WARNING [23361 sampler.py:532] Before construct renumbering_dict
WARNING [23361 sampler.py:555] PreSampling done
W20240208 04:46:55.190750 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240208 04:46:55.190953 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240208 04:46:55.190995 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240208 04:46:55.191035 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240208 04:46:55.191064 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240208 04:46:55.191097 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240208 04:46:55.191138 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240208 04:46:55.191177 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240208 04:46:55.191207 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240208 04:46:55.191242 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240208 04:46:55.191283 23361 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240208 04:46:55.191314 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240208 04:46:55.191340 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240208 04:46:55.191507 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240208 04:46:55.191555 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240208 04:46:55.191589 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240208 04:46:55.191634 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240208 04:46:55.191671 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240208 04:46:55.191704 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240208 04:46:55.191738 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240208 04:46:55.191769 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240208 04:46:55.191802 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240208 04:46:55.191835 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240208 04:46:55.191864 23361 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240208 04:46:55.191887 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240208 04:46:55.191918 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240208 04:46:55.191975 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240208 04:46:55.192008 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240208 04:46:55.192042 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240208 04:46:55.192086 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240208 04:46:55.192121 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240208 04:46:55.192157 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240208 04:46:55.192186 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240208 04:46:55.192219 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240208 04:46:55.192252 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240208 04:46:55.192286 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240208 04:46:55.192313 23361 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240208 04:46:55.192337 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240208 04:46:55.192360 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240208 04:46:55.192426 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240208 04:46:55.192457 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240208 04:46:55.192487 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240208 04:46:55.192513 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240208 04:46:55.192548 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240208 04:46:55.192590 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240208 04:46:55.192620 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240208 04:46:55.192647 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240208 04:46:55.192679 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240208 04:46:55.192708 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240208 04:46:55.192740 23361 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240208 04:46:55.192763 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240208 04:46:55.192788 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240208 04:46:55.192847 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240208 04:46:55.192876 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240208 04:46:55.192905 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240208 04:46:55.192938 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240208 04:46:55.192970 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240208 04:46:55.193006 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240208 04:46:55.193037 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240208 04:46:55.193066 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240208 04:46:55.193104 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240208 04:46:55.193145 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240208 04:46:55.193176 23361 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240208 04:46:55.193199 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240208 04:46:55.193225 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240208 04:46:55.193284 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240208 04:46:55.193315 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240208 04:46:55.193348 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240208 04:46:55.193377 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240208 04:46:55.193408 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240208 04:46:55.193435 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240208 04:46:55.193464 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240208 04:46:55.193492 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240208 04:46:55.193522 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240208 04:46:55.193557 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240208 04:46:55.193585 23361 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240208 04:46:55.193608 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240208 04:46:55.193631 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240208 04:46:55.193684 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240208 04:46:55.193718 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240208 04:46:55.193754 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240208 04:46:55.193784 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240208 04:46:55.193819 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240208 04:46:55.193850 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240208 04:46:55.193883 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240208 04:46:55.193917 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240208 04:46:55.193945 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240208 04:46:55.193979 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240208 04:46:55.194005 23361 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240208 04:46:55.194027 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240208 04:46:55.194056 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240208 04:46:55.194114 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240208 04:46:55.194147 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240208 04:46:55.194181 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240208 04:46:55.194211 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240208 04:46:55.194238 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240208 04:46:55.194267 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240208 04:46:55.194299 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240208 04:46:55.194334 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240208 04:46:55.194370 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240208 04:46:55.194408 23361 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240208 04:46:55.194444 23361 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240208 04:46:55.194468 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240208 04:46:55.194491 23361 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240208 04:46:55.665052 23361 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240208 04:55:31.100589 23361 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302706,  4302713,    84197,  ..., 52240728, 49023129,  5261302]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2163.206 seconds
[Rank1] pid = 24435
[Rank2] pid = 24529
[Rank3] pid = 24596
[Rank4] pid = 24667
[Rank5] pid = 24736
[Rank6] pid = 24807
INFO [23361 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [24435 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [24529 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [24596 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [24667 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [24736 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [24876 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [24807 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [24876 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24807 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24736 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24596 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24667 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240208 05:04:07.694342 24941 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
INFO [23361 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24529 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24435 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240208 05:04:07.695103 24808 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240208 05:04:07.695113 24737 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240208 05:04:07.695124 24597 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240208 05:04:07.696485 24877 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240208 05:04:07.696846 24668 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240208 05:04:07.700114 24436 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240208 05:04:07.700202 24530 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240208 05:04:07.782573 24530 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102049f54000 7.629 MB
W20240208 05:04:07.782572 24436 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1020497b1000 7.629 MB
W20240208 05:04:07.782585 24877 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204a6f7000 7.629 MB
W20240208 05:04:07.782662 24597 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204ae9a000 7.629 MB
W20240208 05:04:07.782757 24877 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10204b63d000 7.629 MB
W20240208 05:04:07.782783 24530 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10204bde0000 7.629 MB
W20240208 05:04:07.782807 24668 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204c583000 7.629 MB
W20240208 05:04:07.782821 24737 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204cd26000 7.629 MB
W20240208 05:04:07.782856 24530 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10204d4c9000 1.49 GB
W20240208 05:04:07.782892 24808 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1020acaac000 7.629 MB
W20240208 05:04:07.782943 24877 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1020ad24f000 1.49 GB
W20240208 05:04:07.782984 24597 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10210c832000 7.629 MB
W20240208 05:04:07.783017 24941 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10210cfd5000 7.629 MB
W20240208 05:04:07.783041 24436 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210d778000 7.629 MB
W20240208 05:04:07.783071 24597 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10210df1b000 1.49 GB
W20240208 05:04:07.783092 24877 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10216d4fe000 1.49 GB
W20240208 05:04:07.783124 24530 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1021ccae1000 1.49 GB
W20240208 05:04:07.783133 24597 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10222c0c4000 1.49 GB
W20240208 05:04:07.783140 24808 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10228b6a7000 7.629 MB
W20240208 05:04:07.783147 24737 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10228be4a000 7.629 MB
W20240208 05:04:07.783155 24877 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240208 05:04:07.783159 24436 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10228c5ed000 1.49 GB
W20240208 05:04:07.783177 24941 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1022ebbd0000 7.629 MB
W20240208 05:04:07.783202 24668 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1022ec373000 7.629 MB
W20240208 05:04:07.783214 24436 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1022ecb16000 1.49 GB
W20240208 05:04:07.783226 24597 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240208 05:04:07.783236 24808 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10234c0f9000 1.49 GB
W20240208 05:04:07.783244 24530 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240208 05:04:07.783269 24941 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1023ab6dc000 1.49 GB
W20240208 05:04:07.783277 24668 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10240acbf000 1.49 GB
W20240208 05:04:07.783284 24737 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10246a2a2000 1.49 GB
W20240208 05:04:07.783298 24808 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1024c9885000 1.49 GB
W20240208 05:04:07.783308 24436 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240208 05:04:07.783332 24941 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x102528e68000 1.49 GB
W20240208 05:04:07.783339 24668 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10258844b000 1.49 GB
W20240208 05:04:07.783360 24737 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240208 05:04:07.783375 24808 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240208 05:04:07.784664 24737 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240208 05:04:07.784675 24668 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240208 05:04:07.784682 24941 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240208 05:04:07.795814 24877 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240208 05:04:07.796036 24808 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240208 05:04:07.796038 24436 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240208 05:04:07.796067 24597 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240208 05:04:07.796073 24737 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240208 05:04:07.796097 24530 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240208 05:04:07.800496 24668 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240208 05:04:07.802152 24941 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [24667 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [24807 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [24529 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [24876 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [24736 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 24876
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [23361 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [24435 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [24596 DistTensor.py:59] The tensor name already exists in the kvstore
I20240208 05:04:56.271310 24597 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240208 05:04:56.271380 24737 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240208 05:04:56.271447 24530 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240208 05:04:56.271515 24941 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240208 05:04:56.271622 24668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240208 05:04:56.271728 24808 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240208 05:04:56.271934 24877 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240208 05:04:56.272027 24436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240208 05:04:56.273319 24877 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240208 05:04:56.273459 24877 grad_base.h:184] Init GradProcessingBase done
I20240208 05:05:09.108930 24877 grad_async_v1.h:203] Use main thread to update emb.
W20240208 05:05:09.109099 24877 kg_controller.h:75] after init GradAsyncProcessing
I20240208 05:05:09.109110 24877 kg_controller.h:84] Construct KGCacheController done
E20240208 05:05:09.885957 24737 recstore.cc:66] init folly done
E20240208 05:05:09.885993 24436 recstore.cc:66] init folly done
E20240208 05:05:09.886008 24808 recstore.cc:66] init folly done
E20240208 05:05:09.886014 24597 recstore.cc:66] init folly done
E20240208 05:05:09.886020 24668 recstore.cc:66] init folly done
E20240208 05:05:09.886266 24530 recstore.cc:66] init folly done
E20240208 05:05:09.886469 24941 recstore.cc:66] init folly done
E20240208 05:05:09.886662 24877 recstore.cc:66] init folly done
I20240208 05:05:09.887682 24877 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240208 05:05:31.218684 24941 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240208 05:05:31.446924 24737 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240208 05:05:31.972999 24668 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240208 05:05:33.045974 24530 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240208 05:05:33.781791 24877 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240208 05:05:33.839269 24597 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240208 05:05:33.862226 24436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240208 05:05:35.298619 24808 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.253 ms                 | 10.253 ms                 |
| Forward                   | 487.044 ms                | 487.044 ms                |
| Backward                  | 215.792 ms                | 215.792 ms                |
| Optimize                  | 44.231 ms                 | 44.231 ms                 |
| BarrierTimeBeforeRank0    | 55.583 ms                 | 55.583 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240208 05:05:37.396013 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240208 05:05:38.396008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240208 05:05:39.528952 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.934 ms                  | 325.281 ms                |
| ProcessBack:UpdateCache   | 10.181 ms                 | 655.051 ms                |
| ProcessBack:UpsertPq      | 40.610 ms                 | 55.087 ms                 |
| ProcessOneStep            | 69.466 ms                 | 1.283 s                   |
| BlockToStepN              | 140.283 us                | 571.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:05:40.528007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.922 ms                  | 220.457 ms                |
| Forward                   | 6.478 ms                  | 487.044 ms                |
| Backward                  | 11.562 ms                 | 215.792 ms                |
| Optimize                  | 2.530 ms                  | 44.231 ms                 |
| BarrierTimeBeforeRank0    | 601.436 us                | 55.583 ms                 |
| AfterBackward             | 69.399 ms                 | 1.283 s                   |
| BlockToStepN              | 221.867 us                | 572.951 ms                |
| OneStep                   | 184.474 ms                | 2.671 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:05:41.528008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240208 05:05:42.528007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240208 05:05:43.528007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240208 05:05:44.528008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.566 ms                  | 325.281 ms                |
| ProcessBack:UpdateCache   | 9.806 ms                  | 655.051 ms                |
| ProcessBack:UpsertPq      | 44.280 ms                 | 70.998 ms                 |
| ProcessOneStep            | 69.597 ms                 | 1.283 s                   |
| BlockToStepN              | 140.283 us                | 571.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:05:45.528010 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.733 ms                  | 220.457 ms                |
| Forward                   | 6.001 ms                  | 487.044 ms                |
| Backward                  | 11.462 ms                 | 215.792 ms                |
| Optimize                  | 2.740 ms                  | 44.231 ms                 |
| BarrierTimeBeforeRank0    | 934.161 us                | 264.439 ms                |
| AfterBackward             | 69.936 ms                 | 1.283 s                   |
| BlockToStepN              | 221.867 us                | 815.094 ms                |
| OneStep                   | 224.655 ms                | 2.671 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:05:46.528008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240208 05:05:47.528007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240208 05:05:48.566130 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240208 05:05:49.574100 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=32, pq.top=32
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.566 ms                  | 291.580 ms                |
| ProcessBack:UpdateCache   | 9.806 ms                  | 653.952 ms                |
| ProcessBack:UpsertPq      | 44.928 ms                 | 86.172 ms                 |
| ProcessOneStep            | 70.361 ms                 | 1.283 s                   |
| BlockToStepN              | 9.332 ms                  | 904.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:05:50.574008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.922 ms                  | 220.457 ms                |
| Forward                   | 5.714 ms                  | 487.044 ms                |
| Backward                  | 11.568 ms                 | 215.792 ms                |
| Optimize                  | 2.804 ms                  | 44.231 ms                 |
| BarrierTimeBeforeRank0    | 912.620 us                | 264.439 ms                |
| AfterBackward             | 70.045 ms                 | 1.283 s                   |
| BlockToStepN              | 9.419 ms                  | 913.183 ms                |
| OneStep                   | 224.655 ms                | 2.671 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:05:51.574007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240208 05:05:52.574007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240208 05:05:53.574007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240208 05:05:54.583885 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.335 ms                  | 291.580 ms                |
| ProcessBack:UpdateCache   | 9.777 ms                  | 653.952 ms                |
| ProcessBack:UpsertPq      | 40.610 ms                 | 86.172 ms                 |
| ProcessOneStep            | 64.570 ms                 | 1.283 s                   |
| BlockToStepN              | 9.332 ms                  | 913.089 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:05:55.643018 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.358 ms                  | 174.848 ms                |
| Forward                   | 5.491 ms                  | 11.711 ms                 |
| Backward                  | 11.524 ms                 | 18.551 ms                 |
| Optimize                  | 2.759 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 43.837 us                 | 154.924 ms                |
| AfterBackward             | 61.909 ms                 | 136.892 ms                |
| BlockToStepN              | 9.419 ms                  | 904.529 ms                |
| OneStep                   | 224.655 ms                | 1.029 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:05:56.862900 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240208 05:05:57.973800 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240208 05:05:59.026568 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.293 ms                  | 291.580 ms                |
| ProcessBack:UpdateCache   | 9.624 ms                  | 653.952 ms                |
| ProcessBack:UpsertPq      | 36.826 ms                 | 86.172 ms                 |
| ProcessOneStep            | 59.733 ms                 | 136.844 ms                |
| BlockToStepN              | 9.332 ms                  | 904.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:00.144227 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.856 ms                  | 174.848 ms                |
| Forward                   | 5.483 ms                  | 11.711 ms                 |
| Backward                  | 11.487 ms                 | 18.551 ms                 |
| Optimize                  | 2.792 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 36.384 us                 | 154.924 ms                |
| AfterBackward             | 59.531 ms                 | 136.892 ms                |
| BlockToStepN              | 9.419 ms                  | 904.529 ms                |
| OneStep                   | 224.655 ms                | 1.029 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:01.374964 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240208 05:06:02.374007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240208 05:06:03.374006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240208 05:06:04.374006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.174 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.530 ms                  | 14.986 ms                 |
| ProcessBack:UpsertPq      | 36.375 ms                 | 80.714 ms                 |
| ProcessOneStep            | 59.273 ms                 | 136.844 ms                |
| BlockToStepN              | 9.332 ms                  | 904.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:05.404094 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.441 ms                  | 174.848 ms                |
| Forward                   | 5.471 ms                  | 11.711 ms                 |
| Backward                  | 11.471 ms                 | 34.490 ms                 |
| Optimize                  | 2.792 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 48.487 us                 | 170.057 ms                |
| AfterBackward             | 59.307 ms                 | 136.892 ms                |
| BlockToStepN              | 9.419 ms                  | 904.529 ms                |
| OneStep                   | 336.039 ms                | 1.029 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:06.404003 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240208 05:06:07.404006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240208 05:06:08.468431 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240208 05:06:09.683984 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.750 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.602 ms                  | 14.986 ms                 |
| ProcessBack:UpsertPq      | 36.160 ms                 | 80.714 ms                 |
| ProcessOneStep            | 59.707 ms                 | 136.844 ms                |
| BlockToStepN              | 9.332 ms                  | 904.408 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 36.310, sample: 1.988, forward: 1.035, backward: 0.705, update: 0.295
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 36.333, sample: 1.846, forward: 0.988, backward: 1.308, update: 0.301
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 38.200, sample: 1.976, forward: 1.031, backward: 0.998, update: 0.307
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 38.954, sample: 1.453, forward: 1.023, backward: 1.109, update: 0.310
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 38.725, sample: 1.887, forward: 1.043, backward: 0.970, update: 0.293
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 34.874, sample: 2.031, forward: 1.038, backward: 1.292, update: 0.293
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 37.126, sample: 2.093, forward: 1.042, backward: 1.276, update: 0.298
train_sampler.Prefill()
-------Step 0-------
tensor([   44683,    44710,    44732,    44757,  5918920,   123441, 65610455,
        15617272, 23433596,    44783]) tensor([ 5236820, 13708296, 66434350, 81793663, 24959896, 39098822, 41236349,
        84145227, 63686731, 25084132])
-------Step 1-------
tensor([   44683,    44710,    44732,    44757,  5918920,   123441, 65610455,
        15617272, 23433596,    44783]) tensor([62574474, 24690612, 12668856, 72372687, 82692320, 47650073, 67133900,
        41803258, 32256580, 11834791])
-------Step 2-------
tensor([  111211,   111243,   111268,    23119,   111292,   111314,   111338,
        22752208,   111362,   111395]) tensor([62472526, 26850938, 74561038, 56307882, 34609324, 31530914, 62989003,
        35515707, 12591159, 46690835])
-------Step 3-------
tensor([  111211,   111243,   111268,    23119,   111292,   111314,   111338,
        22752208,   111362,   111395]) tensor([41880746, 72486185, 40025411, 46671749, 54102050, 55061515, 32578211,
        14526871, 22765104,   780919])
-------Step 4-------
tensor([  176690, 50474570,   176716,   155791,   176739,   155828,   176762,
        48537358,   176794,   176820]) tensor([69011129,  9135126, 85345672, 22077763, 61173153, 40299398, 71120565,
        45850090, 72508052, 43388818])
-------Step 5-------
tensor([  176690, 50474570,   176716,   155791,   176739,   155828,   176762,
        48537358,   176794,   176820]) tensor([27946839, 85201240,   284859, 85849297, 68582802, 46539627, 13101471,
         8784948, 75763787, 34609999])
-------Step 6-------
tensor([  242059,    48167,   242083,   242108,    48212, 77559994,   242139,
          242167,   171677, 44595247]) tensor([15702757, 44369438, 40875833, 70860332, 26783830, 41289489, 22002601,
         6477817, 58419500, 70783479])
-------Step 7-------
tensor([  242059,    48167,   242083,   242108,    48212, 77559994,   242139,
          242167,   171677, 44595247]) tensor([27856698, 44853629, 79646121, 48712871, 70834616, 38216835, 66854634,
        47707563, 41075394, 27963468])
-------Step 8-------
tensor([  305855, 31340762,   305878,   187063,   305906,    60581,   305932,
          305955,   305983,   306012]) tensor([37731389, 21611385, 29570561,  1886716, 42563319, 60937719, 16715608,
        62039161,  1485037, 71041496])
-------Step 9-------
tensor([  305855, 31340762,   305878,   187063,   305906,    60581,   305932,
          305955,   305983,   306012]) tensor([59997386, 43311008, 12690277, 50989920,  8303904, 46804070, 23486777,
        33888629, 85949882, 74864028])
before start barrier
start train
[proc 0] 100 steps, total: 36.391, sample: 2.009, forward: 1.035, backward: 1.380, update: 0.365
W20240208 05:06:11.050235 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.936 ms                  | 174.848 ms                |
| Forward                   | 5.337 ms                  | 11.711 ms                 |
| Backward                  | 11.459 ms                 | 34.490 ms                 |
| Optimize                  | 2.804 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 257.103 us                | 170.057 ms                |
| AfterBackward             | 59.796 ms                 | 136.892 ms                |
| BlockToStepN              | 9.419 ms                  | 904.529 ms                |
| OneStep                   | 336.039 ms                | 1.029 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:12.165889 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240208 05:06:13.227968 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240208 05:06:14.323983 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.853 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.550 ms                  | 14.986 ms                 |
| ProcessBack:UpsertPq      | 36.748 ms                 | 80.714 ms                 |
| ProcessOneStep            | 59.707 ms                 | 136.844 ms                |
| BlockToStepN              | 9.332 ms                  | 904.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:15.762708 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.474 ms                  | 220.457 ms                |
| Forward                   | 5.335 ms                  | 11.711 ms                 |
| Backward                  | 11.459 ms                 | 34.490 ms                 |
| Optimize                  | 2.828 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 48.592 us                 | 170.057 ms                |
| AfterBackward             | 59.765 ms                 | 136.892 ms                |
| BlockToStepN              | 9.419 ms                  | 904.529 ms                |
| OneStep                   | 336.039 ms                | 1.029 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:16.881193 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240208 05:06:17.958760 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240208 05:06:19.022884 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.750 ms                  | 19.313 ms                 |
| ProcessBack:UpdateCache   | 9.530 ms                  | 14.912 ms                 |
| ProcessBack:UpsertPq      | 36.385 ms                 | 74.247 ms                 |
| ProcessOneStep            | 59.363 ms                 | 136.844 ms                |
| BlockToStepN              | 9.332 ms                  | 904.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:20.383590 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.502 ms                  | 300.695 ms                |
| Forward                   | 5.292 ms                  | 11.711 ms                 |
| Backward                  | 11.459 ms                 | 34.490 ms                 |
| Optimize                  | 2.828 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 45.488 us                 | 170.057 ms                |
| AfterBackward             | 59.350 ms                 | 136.892 ms                |
| BlockToStepN              | 9.419 ms                  | 904.529 ms                |
| OneStep                   | 336.039 ms                | 1.029 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:21.512104 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240208 05:06:22.592542 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240208 05:06:23.634850 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.853 ms                  | 19.313 ms                 |
| ProcessBack:UpdateCache   | 9.526 ms                  | 14.912 ms                 |
| ProcessBack:UpsertPq      | 35.962 ms                 | 74.247 ms                 |
| ProcessOneStep            | 58.814 ms                 | 136.844 ms                |
| BlockToStepN              | 9.332 ms                  | 904.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:24.966282 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240208 05:06:25.966007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.627 ms                  | 300.103 ms                |
| Forward                   | 5.282 ms                  | 7.577 ms                  |
| Backward                  | 11.457 ms                 | 18.551 ms                 |
| Optimize                  | 2.828 ms                  | 5.534 ms                  |
| BarrierTimeBeforeRank0    | 40.951 us                 | 154.924 ms                |
| AfterBackward             | 58.851 ms                 | 106.910 ms                |
| BlockToStepN              | 9.419 ms                  | 852.016 ms                |
| OneStep                   | 336.039 ms                | 1.014 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:26.966006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240208 05:06:27.966006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240208 05:06:28.966006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.853 ms                  | 36.824 ms                 |
| ProcessBack:UpdateCache   | 9.503 ms                  | 14.912 ms                 |
| ProcessBack:UpsertPq      | 35.678 ms                 | 74.247 ms                 |
| ProcessOneStep            | 58.840 ms                 | 106.866 ms                |
| BlockToStepN              | 9.332 ms                  | 851.550 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:29.966004 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240208 05:06:30.966006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.627 ms                  | 300.103 ms                |
| Forward                   | 5.250 ms                  | 7.577 ms                  |
| Backward                  | 11.450 ms                 | 18.551 ms                 |
| Optimize                  | 2.828 ms                  | 5.534 ms                  |
| BarrierTimeBeforeRank0    | 43.736 us                 | 154.924 ms                |
| AfterBackward             | 58.877 ms                 | 106.910 ms                |
| BlockToStepN              | 326.266 ms                | 852.016 ms                |
| OneStep                   | 432.499 ms                | 1.014 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:31.966006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240208 05:06:32.966007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240208 05:06:33.966006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.716 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.508 ms                  | 14.752 ms                 |
| ProcessBack:UpsertPq      | 35.508 ms                 | 73.440 ms                 |
| ProcessOneStep            | 58.814 ms                 | 106.866 ms                |
| BlockToStepN              | 10.670 ms                 | 904.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:34.966003 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240208 05:06:36.134140 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.108 ms                  | 300.103 ms                |
| Forward                   | 5.249 ms                  | 7.577 ms                  |
| Backward                  | 11.450 ms                 | 18.551 ms                 |
| Optimize                  | 2.828 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 40.175 us                 | 154.924 ms                |
| AfterBackward             | 58.877 ms                 | 106.910 ms                |
| BlockToStepN              | 10.725 ms                 | 913.183 ms                |
| OneStep                   | 336.039 ms                | 1.014 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:37.348867 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240208 05:06:38.573661 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240208 05:06:39.717140 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.716 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.519 ms                  | 14.752 ms                 |
| ProcessBack:UpsertPq      | 35.812 ms                 | 95.320 ms                 |
| ProcessOneStep            | 59.019 ms                 | 126.909 ms                |
| BlockToStepN              | 10.670 ms                 | 913.089 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:40.883852 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.163 ms                  | 300.103 ms                |
| Forward                   | 5.251 ms                  | 7.577 ms                  |
| Backward                  | 11.462 ms                 | 18.551 ms                 |
| Optimize                  | 2.828 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 39.763 us                 | 154.924 ms                |
| AfterBackward             | 59.071 ms                 | 127.005 ms                |
| BlockToStepN              | 10.725 ms                 | 913.183 ms                |
| OneStep                   | 336.039 ms                | 1.060 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:41.939738 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
W20240208 05:06:42.939024 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240208 05:06:43.939007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.714 ms                  | 22.274 ms                 |
| ProcessBack:UpdateCache   | 9.529 ms                  | 14.752 ms                 |
| ProcessBack:UpsertPq      | 35.997 ms                 | 95.320 ms                 |
| ProcessOneStep            | 59.188 ms                 | 126.909 ms                |
| BlockToStepN              | 154.794 ms                | 913.089 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:44.939004 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240208 05:06:45.967278 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.583 ms                  | 300.103 ms                |
| Forward                   | 5.266 ms                  | 7.991 ms                  |
| Backward                  | 11.457 ms                 | 18.551 ms                 |
| Optimize                  | 2.823 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 36.550 us                 | 154.924 ms                |
| AfterBackward             | 59.307 ms                 | 127.005 ms                |
| BlockToStepN              | 157.894 ms                | 913.183 ms                |
| OneStep                   | 336.039 ms                | 1.060 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:47.026352 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=200, pq.top=200
[proc 7] 200 steps, total: 36.864, sample: 1.289, forward: 0.481, backward: 1.131, update: 0.282
[proc 5] 200 steps, total: 36.864, sample: 2.027, forward: 0.519, backward: 1.082, update: 0.248
[proc 4] 200 steps, total: 36.864, sample: 2.458, forward: 0.510, backward: 0.775, update: 0.252
[proc 6] 200 steps, total: 36.864, sample: 2.161, forward: 0.554, backward: 1.009, update: 0.257
[proc 2] 200 steps, total: 36.863, sample: 1.719, forward: 0.500, backward: 1.016, update: 0.266
[proc 1] 200 steps, total: 36.864, sample: 2.496, forward: 0.505, backward: 0.515, update: 0.241
[proc 3] 200 steps, total: 36.864, sample: 2.047, forward: 0.519, backward: 1.063, update: 0.255
[proc 0] 200 steps, total: 36.863, sample: 3.072, forward: 0.527, backward: 1.140, update: 0.343
W20240208 05:06:48.106549 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=202, pq.top=202
W20240208 05:06:49.212436 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=204, pq.top=204
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 22.274 ms                 |
| ProcessBack:UpdateCache   | 9.529 ms                  | 14.752 ms                 |
| ProcessBack:UpsertPq      | 36.294 ms                 | 95.320 ms                 |
| ProcessOneStep            | 59.212 ms                 | 126.909 ms                |
| BlockToStepN              | 157.832 ms                | 913.089 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:50.212004 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240208 05:06:51.212007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.681 ms                  | 300.103 ms                |
| Forward                   | 5.251 ms                  | 7.991 ms                  |
| Backward                  | 11.445 ms                 | 18.551 ms                 |
| Optimize                  | 2.817 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 36.550 us                 | 154.924 ms                |
| AfterBackward             | 59.219 ms                 | 127.005 ms                |
| BlockToStepN              | 157.894 ms                | 913.183 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:52.212006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240208 05:06:53.212007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240208 05:06:54.212006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 22.274 ms                 |
| ProcessBack:UpdateCache   | 9.508 ms                  | 14.752 ms                 |
| ProcessBack:UpsertPq      | 36.013 ms                 | 95.320 ms                 |
| ProcessOneStep            | 59.037 ms                 | 126.909 ms                |
| BlockToStepN              | 162.156 ms                | 915.068 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:55.212003 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240208 05:06:56.212006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.681 ms                  | 300.103 ms                |
| Forward                   | 5.250 ms                  | 7.991 ms                  |
| Backward                  | 11.438 ms                 | 18.551 ms                 |
| Optimize                  | 2.802 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 36.530 us                 | 154.924 ms                |
| AfterBackward             | 59.056 ms                 | 127.005 ms                |
| BlockToStepN              | 169.606 ms                | 915.163 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:06:57.212007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240208 05:06:58.215867 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240208 05:06:59.238695 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.714 ms                  | 22.274 ms                 |
| ProcessBack:UpdateCache   | 9.496 ms                  | 14.752 ms                 |
| ProcessBack:UpsertPq      | 35.982 ms                 | 95.320 ms                 |
| ProcessOneStep            | 58.924 ms                 | 126.909 ms                |
| BlockToStepN              | 196.669 ms                | 922.322 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:00.238004 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240208 05:07:01.238008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.737 ms                  | 300.103 ms                |
| Forward                   | 5.249 ms                  | 7.991 ms                  |
| Backward                  | 11.435 ms                 | 18.551 ms                 |
| Optimize                  | 2.797 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 36.178 us                 | 154.924 ms                |
| AfterBackward             | 58.958 ms                 | 127.005 ms                |
| BlockToStepN              | 196.756 ms                | 922.413 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:02.238008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240208 05:07:03.312265 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240208 05:07:04.312006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.716 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.488 ms                  | 14.692 ms                 |
| ProcessBack:UpsertPq      | 35.962 ms                 | 91.219 ms                 |
| ProcessOneStep            | 58.923 ms                 | 126.909 ms                |
| BlockToStepN              | 196.669 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:05.312007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.737 ms                  | 300.103 ms                |
| Forward                   | 5.235 ms                  | 7.991 ms                  |
| Backward                  | 11.429 ms                 | 18.551 ms                 |
| Optimize                  | 2.792 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 36.118 us                 | 154.924 ms                |
| AfterBackward             | 58.958 ms                 | 127.005 ms                |
| BlockToStepN              | 196.756 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:06.312003 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240208 05:07:07.312006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240208 05:07:08.312006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240208 05:07:09.312008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.714 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.487 ms                  | 14.692 ms                 |
| ProcessBack:UpsertPq      | 35.997 ms                 | 91.219 ms                 |
| ProcessOneStep            | 58.944 ms                 | 126.909 ms                |
| BlockToStepN              | 196.669 ms                | 922.528 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:10.312008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.776 ms                  | 300.103 ms                |
| Forward                   | 5.237 ms                  | 7.991 ms                  |
| Backward                  | 11.420 ms                 | 18.551 ms                 |
| Optimize                  | 2.791 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 36.384 us                 | 154.924 ms                |
| AfterBackward             | 59.042 ms                 | 127.005 ms                |
| BlockToStepN              | 196.756 ms                | 922.684 ms                |
| OneStep                   | 336.039 ms                | 1.246 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:11.312004 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240208 05:07:12.312006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240208 05:07:13.387699 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240208 05:07:14.482563 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.488 ms                  | 14.692 ms                 |
| ProcessBack:UpsertPq      | 36.230 ms                 | 91.219 ms                 |
| ProcessOneStep            | 59.037 ms                 | 126.909 ms                |
| BlockToStepN              | 196.669 ms                | 922.528 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:15.482007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=246, pq.top=246
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.776 ms                  | 300.103 ms                |
| Forward                   | 5.227 ms                  | 7.991 ms                  |
| Backward                  | 11.413 ms                 | 18.551 ms                 |
| Optimize                  | 2.788 ms                  | 9.129 ms                  |
| BarrierTimeBeforeRank0    | 36.384 us                 | 154.924 ms                |
| AfterBackward             | 59.071 ms                 | 127.005 ms                |
| BlockToStepN              | 196.756 ms                | 922.684 ms                |
| OneStep                   | 336.039 ms                | 1.246 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:16.482008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240208 05:07:17.482008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240208 05:07:18.482008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240208 05:07:19.482009 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.474 ms                  | 14.692 ms                 |
| ProcessBack:UpsertPq      | 36.278 ms                 | 91.219 ms                 |
| ProcessOneStep            | 59.019 ms                 | 120.795 ms                |
| BlockToStepN              | 326.191 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:20.482014 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.975 ms                  | 256.320 ms                |
| Forward                   | 5.237 ms                  | 7.991 ms                  |
| Backward                  | 11.399 ms                 | 16.528 ms                 |
| Optimize                  | 2.780 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.606 us                 | 143.434 ms                |
| AfterBackward             | 59.071 ms                 | 120.850 ms                |
| BlockToStepN              | 196.756 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:21.482013 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240208 05:07:22.482007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240208 05:07:23.482007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240208 05:07:24.723644 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.710 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.451 ms                  | 14.692 ms                 |
| ProcessBack:UpsertPq      | 36.286 ms                 | 91.219 ms                 |
| ProcessOneStep            | 59.118 ms                 | 120.795 ms                |
| BlockToStepN              | 196.669 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:25.796422 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.169 ms                 | 256.320 ms                |
| Forward                   | 5.237 ms                  | 7.991 ms                  |
| Backward                  | 11.388 ms                 | 16.528 ms                 |
| Optimize                  | 2.773 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.578 us                 | 143.434 ms                |
| AfterBackward             | 59.195 ms                 | 120.850 ms                |
| BlockToStepN              | 196.756 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:26.844544 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240208 05:07:27.929464 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240208 05:07:28.929008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.704 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.422 ms                  | 14.692 ms                 |
| ProcessBack:UpsertPq      | 36.335 ms                 | 91.219 ms                 |
| ProcessOneStep            | 59.212 ms                 | 120.795 ms                |
| BlockToStepN              | 326.191 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:29.929004 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240208 05:07:31.020510 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.169 ms                 | 256.320 ms                |
| Forward                   | 5.237 ms                  | 7.991 ms                  |
| Backward                  | 11.377 ms                 | 16.528 ms                 |
| Optimize                  | 2.774 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.902 us                 | 143.434 ms                |
| AfterBackward             | 59.307 ms                 | 120.850 ms                |
| BlockToStepN              | 196.756 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:32.020009 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240208 05:07:33.020006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240208 05:07:34.020006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.693 ms                  | 19.313 ms                 |
| ProcessBack:UpdateCache   | 9.386 ms                  | 13.917 ms                 |
| ProcessBack:UpsertPq      | 36.316 ms                 | 87.065 ms                 |
| ProcessOneStep            | 59.319 ms                 | 120.795 ms                |
| BlockToStepN              | 196.669 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:35.020006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240208 05:07:36.020007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.169 ms                 | 256.320 ms                |
| Forward                   | 5.235 ms                  | 7.991 ms                  |
| Backward                  | 11.370 ms                 | 16.528 ms                 |
| Optimize                  | 2.773 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.902 us                 | 143.434 ms                |
| AfterBackward             | 59.350 ms                 | 120.850 ms                |
| BlockToStepN              | 196.756 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:37.020005 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240208 05:07:38.020005 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240208 05:07:39.020007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.683 ms                  | 19.313 ms                 |
| ProcessBack:UpdateCache   | 9.336 ms                  | 13.917 ms                 |
| ProcessBack:UpsertPq      | 36.316 ms                 | 87.065 ms                 |
| ProcessOneStep            | 59.498 ms                 | 120.795 ms                |
| BlockToStepN              | 326.191 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:40.020007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=290, pq.top=290
W20240208 05:07:41.020007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.169 ms                 | 256.320 ms                |
| Forward                   | 5.235 ms                  | 7.991 ms                  |
| Backward                  | 11.349 ms                 | 16.528 ms                 |
| Optimize                  | 2.767 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.743 us                 | 143.434 ms                |
| AfterBackward             | 59.531 ms                 | 120.850 ms                |
| BlockToStepN              | 326.266 ms                | 922.540 ms                |
| OneStep                   | 432.499 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:42.020009 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240208 05:07:43.020009 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240208 05:07:44.020007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.680 ms                  | 19.313 ms                 |
| ProcessBack:UpdateCache   | 9.336 ms                  | 13.917 ms                 |
| ProcessBack:UpsertPq      | 36.300 ms                 | 87.065 ms                 |
| ProcessOneStep            | 59.502 ms                 | 120.795 ms                |
| BlockToStepN              | 196.669 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:45.020004 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 3] 300 steps, total: 58.775, sample: 1.794, forward: 0.550, backward: 0.838, update: 0.255
[proc 6] 300 steps, total: 58.775, sample: 1.810, forward: 0.528, backward: 1.061, update: 0.265
[proc 1] 300 steps, total: 58.775, sample: 1.882, forward: 0.535, backward: 0.502, update: 0.243
[proc 5] 300 steps, total: 58.775, sample: 1.403, forward: 0.530, backward: 1.072, update: 0.271
[proc 4] 300 steps, total: 58.775, sample: 1.666, forward: 0.556, backward: 1.058, update: 0.267
[proc 2] 300 steps, total: 58.775, sample: 1.392, forward: 0.504, backward: 0.850, update: 0.261
[proc 7] 300 steps, total: 58.775, sample: 1.288, forward: 0.511, backward: 1.142, update: 0.287
[proc 0] 300 steps, total: 58.775, sample: 2.444, forward: 0.529, backward: 1.007, update: 0.283
W20240208 05:07:46.020006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.169 ms                 | 256.320 ms                |
| Forward                   | 5.237 ms                  | 7.991 ms                  |
| Backward                  | 11.337 ms                 | 16.528 ms                 |
| Optimize                  | 2.762 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.743 us                 | 143.434 ms                |
| AfterBackward             | 59.560 ms                 | 120.850 ms                |
| BlockToStepN              | 196.756 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:47.021706 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240208 05:07:48.021008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=304, pq.top=304
W20240208 05:07:49.042981 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=306, pq.top=306
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.680 ms                  | 22.274 ms                 |
| ProcessBack:UpdateCache   | 9.331 ms                  | 13.917 ms                 |
| ProcessBack:UpsertPq      | 36.300 ms                 | 87.065 ms                 |
| ProcessOneStep            | 59.559 ms                 | 120.795 ms                |
| BlockToStepN              | 196.669 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:50.042004 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240208 05:07:51.042007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.113 ms                 | 256.320 ms                |
| Forward                   | 5.237 ms                  | 7.991 ms                  |
| Backward                  | 11.333 ms                 | 16.528 ms                 |
| Optimize                  | 2.762 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.743 us                 | 143.434 ms                |
| AfterBackward             | 59.623 ms                 | 120.850 ms                |
| BlockToStepN              | 326.266 ms                | 922.540 ms                |
| OneStep                   | 432.499 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:52.042012 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240208 05:07:53.042007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240208 05:07:54.042007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.683 ms                  | 22.274 ms                 |
| ProcessBack:UpdateCache   | 9.330 ms                  | 13.917 ms                 |
| ProcessBack:UpsertPq      | 36.300 ms                 | 87.065 ms                 |
| ProcessOneStep            | 59.707 ms                 | 120.795 ms                |
| BlockToStepN              | 326.191 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:55.101539 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240208 05:07:56.101007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.039 ms                 | 256.320 ms                |
| Forward                   | 5.247 ms                  | 7.991 ms                  |
| Backward                  | 11.312 ms                 | 16.528 ms                 |
| Optimize                  | 2.762 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.902 us                 | 143.434 ms                |
| AfterBackward             | 59.773 ms                 | 120.850 ms                |
| BlockToStepN              | 196.756 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:07:57.107604 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240208 05:07:58.107008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240208 05:07:59.107008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.683 ms                  | 22.274 ms                 |
| ProcessBack:UpdateCache   | 9.308 ms                  | 13.917 ms                 |
| ProcessBack:UpsertPq      | 36.300 ms                 | 87.065 ms                 |
| ProcessOneStep            | 59.760 ms                 | 120.795 ms                |
| BlockToStepN              | 215.572 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:08:00.107007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240208 05:08:01.107007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.908 ms                  | 256.320 ms                |
| Forward                   | 5.237 ms                  | 7.991 ms                  |
| Backward                  | 11.293 ms                 | 16.528 ms                 |
| Optimize                  | 2.756 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.833 us                 | 143.434 ms                |
| AfterBackward             | 59.856 ms                 | 120.850 ms                |
| BlockToStepN              | 215.641 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:08:02.107007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240208 05:08:03.107007 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240208 05:08:04.146425 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=332, pq.top=332
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.681 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.296 ms                  | 13.635 ms                 |
| ProcessBack:UpsertPq      | 36.316 ms                 | 86.172 ms                 |
| ProcessOneStep            | 59.899 ms                 | 120.795 ms                |
| BlockToStepN              | 215.572 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240208 05:08:05.146005 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=333, pq.top=333
W20240208 05:08:06.146008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.904 ms                  | 256.320 ms                |
| Forward                   | 5.237 ms                  | 8.003 ms                  |
| Backward                  | 11.280 ms                 | 16.528 ms                 |
| Optimize                  | 2.753 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.902 us                 | 143.434 ms                |
| AfterBackward             | 59.934 ms                 | 120.850 ms                |
| BlockToStepN              | 215.641 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
W20240208 05:08:07.146006 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240208 05:08:08.146008 24877 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=339, pq.top=339
Successfully xmh. training takes 155.2644281387329 seconds
before call kg_cache_controller.StopThreads()
W20240208 05:08:09.046279 24877 grad_async_v1.h:243] call StopThreads. PID = 23361
W20240208 05:08:09.046304 24877 grad_base.h:212] before processOneStepNegThread_.join();
W20240208 05:08:09.050611 24877 grad_base.h:214] after processOneStepNegThread_.join();
W20240208 05:08:09.050621 24877 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240208 05:08:09.099685 24877 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.681 ms                  | 21.572 ms                 |
| ProcessBack:UpdateCache   | 9.287 ms                  | 13.635 ms                 |
| ProcessBack:UpsertPq      | 36.385 ms                 | 86.172 ms                 |
| ProcessOneStep            | 59.930 ms                 | 120.795 ms                |
| BlockToStepN              | 235.642 ms                | 922.437 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.776 ms                  | 256.320 ms                |
| Forward                   | 5.235 ms                  | 8.003 ms                  |
| Backward                  | 11.278 ms                 | 16.528 ms                 |
| Optimize                  | 2.741 ms                  | 5.914 ms                  |
| BarrierTimeBeforeRank0    | 35.902 us                 | 143.434 ms                |
| AfterBackward             | 59.961 ms                 | 120.850 ms                |
| BlockToStepN              | 235.720 ms                | 922.540 ms                |
| OneStep                   | 336.039 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
