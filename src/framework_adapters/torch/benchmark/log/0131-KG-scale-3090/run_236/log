WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240207 11:25:36.627532 48811 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_38', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [48811 sampler.py:454] Start PreSampling
WARNING [48811 sampler.py:532] Before construct renumbering_dict
WARNING [48811 sampler.py:555] PreSampling done
W20240207 11:41:45.987984 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240207 11:41:45.988194 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240207 11:41:45.988240 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240207 11:41:45.988281 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240207 11:41:45.988314 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240207 11:41:45.988348 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240207 11:41:45.988379 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240207 11:41:45.988420 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240207 11:41:45.988448 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240207 11:41:45.988482 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240207 11:41:45.988519 48811 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240207 11:41:45.988548 48811 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240207 11:41:45.988579 48811 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240207 11:41:45.988751 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240207 11:41:45.988794 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240207 11:41:45.988823 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240207 11:41:45.988867 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240207 11:41:45.988904 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240207 11:41:45.988934 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240207 11:41:45.988962 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240207 11:41:45.988998 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240207 11:41:45.989027 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240207 11:41:45.989063 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240207 11:41:45.989094 48811 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240207 11:41:45.989116 48811 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240207 11:41:45.989145 48811 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240207 11:41:45.989204 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240207 11:41:45.989236 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240207 11:41:45.989262 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240207 11:41:45.989295 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240207 11:41:45.989326 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240207 11:41:45.989359 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240207 11:41:45.989390 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240207 11:41:45.989418 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240207 11:41:45.989449 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240207 11:41:45.989491 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240207 11:41:45.989521 48811 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240207 11:41:45.989544 48811 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240207 11:41:45.989571 48811 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240207 11:41:45.989627 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240207 11:41:45.989656 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240207 11:41:45.989686 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240207 11:41:45.989714 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240207 11:41:45.989742 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240207 11:41:45.989773 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240207 11:41:45.989801 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240207 11:41:45.989827 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240207 11:41:45.989856 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240207 11:41:45.989885 48811 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240207 11:41:45.989912 48811 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240207 11:41:45.989933 48811 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240207 11:41:45.989959 48811 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240207 11:41:46.408844 48811 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240207 11:50:17.006827 48811 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4302712,  4302738,   122956,  ..., 67036606, 12761010,  2481415]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1983.088 seconds
[Rank1] pid = 49810
[Rank2] pid = 49904
INFO [48811 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [49810 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [48811 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [49810 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [49971 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [49971 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [49904 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
W20240207 11:58:45.677677 49972 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
INFO [49904 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240207 11:58:45.678891 49811 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240207 11:58:45.679888 50035 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240207 11:58:45.683120 49905 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240207 11:58:45.733322 50035 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102036619000 7.629 MB
W20240207 11:58:45.733388 49972 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102036dbc000 7.629 MB
W20240207 11:58:45.733487 49905 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10203755f000 7.629 MB
W20240207 11:58:45.733500 49811 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102037d02000 7.629 MB
W20240207 11:58:45.733522 50035 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020384a5000 7.629 MB
W20240207 11:58:45.733539 49972 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102038c48000 7.629 MB
W20240207 11:58:45.733600 49972 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1020393eb000 1.49 GB
W20240207 11:58:45.733606 50035 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1020989ce000 1.49 GB
W20240207 11:58:45.733633 49972 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020f7fb1000 1.49 GB
W20240207 11:58:45.733664 50035 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102157594000 1.49 GB
W20240207 11:58:45.733670 49811 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1021b6b77000 7.629 MB
W20240207 11:58:45.733675 49972 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 11:58:45.733692 49905 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1021b731a000 7.629 MB
W20240207 11:58:45.733719 50035 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240207 11:58:45.733750 49811 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021b7abd000 1.49 GB
W20240207 11:58:45.733759 49905 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1022170a0000 1.49 GB
W20240207 11:58:45.733806 49811 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x102276683000 1.49 GB
W20240207 11:58:45.733824 49905 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022d5c66000 1.49 GB
W20240207 11:58:45.733865 49811 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 11:58:45.733891 49905 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 11:58:45.739874 49972 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 11:58:45.739894 49811 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 11:58:45.739908 49905 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 11:58:45.739924 50035 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [49810 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [49971 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank3] pid = 49971
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [48811 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [49904 DistTensor.py:59] The tensor name already exists in the kvstore
I20240207 11:59:17.806732 49905 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240207 11:59:17.806833 49811 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240207 11:59:17.807330 50035 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240207 11:59:17.807386 49972 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240207 11:59:17.808858 49972 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240207 11:59:17.809114 49972 grad_base.h:184] Init GradProcessingBase done
I20240207 11:59:30.793691 49972 grad_async_v1.h:203] Use main thread to update emb.
W20240207 11:59:30.793864 49972 kg_controller.h:75] after init GradAsyncProcessing
I20240207 11:59:30.793874 49972 kg_controller.h:84] Construct KGCacheController done
E20240207 11:59:31.260735 49905 recstore.cc:66] init folly done
E20240207 11:59:31.260835 49972 recstore.cc:66] init folly done
E20240207 11:59:31.260871 50035 recstore.cc:66] init folly done
E20240207 11:59:31.260888 49811 recstore.cc:66] init folly done
I20240207 11:59:31.261693 49972 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240207 11:59:49.603400 50035 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240207 11:59:52.110513 49972 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240207 11:59:52.683769 49905 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240207 11:59:52.745385 49811 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.870 ms                 | 19.870 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240207 11:59:54.047784 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240207 11:59:54.339893 50141 grad_async_v1.h:533] Stalled in ProcessBackward: rank=1, step_no=1, sample_step_cpp_seen_[rank]=0
W20240207 11:59:55.047006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240207 11:59:56.082002 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.391 ms                  | 169.060 ms                |
| ProcessBack:UpdateCache   | 3.041 ms                  | 256.817 ms                |
| ProcessBack:UpsertPq      | 37.155 ms                 | 45.292 ms                 |
| ProcessOneStep            | 47.517 ms                 | 535.587 ms                |
| BlockToStepN              | 4.481 us                  | 256.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 11:59:57.081007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.828 ms                  | 225.902 ms                |
| Forward                   | 4.791 ms                  | 506.814 ms                |
| Backward                  | 10.218 ms                 | 189.904 ms                |
| Optimize                  | 2.416 ms                  | 44.572 ms                 |
| BarrierTimeBeforeRank0    | 5.695 ms                  | 114.944 ms                |
| AfterBackward             | 41.647 ms                 | 535.828 ms                |
| BlockToStepN              | 529.716 us                | 324.688 ms                |
| OneStep                   | 156.048 ms                | 1.560 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 11:59:58.086823 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240207 11:59:59.211732 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240207 12:00:00.211004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240207 12:00:01.211004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.437 ms                  | 135.935 ms                |
| ProcessBack:UpdateCache   | 2.879 ms                  | 255.916 ms                |
| ProcessBack:UpsertPq      | 19.681 ms                 | 45.148 ms                 |
| ProcessOneStep            | 26.975 ms                 | 535.587 ms                |
| BlockToStepN              | 607.332 us                | 338.199 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:02.304762 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.647 ms                  | 225.902 ms                |
| Forward                   | 4.701 ms                  | 506.814 ms                |
| Backward                  | 10.131 ms                 | 189.904 ms                |
| Optimize                  | 2.353 ms                  | 44.572 ms                 |
| BarrierTimeBeforeRank0    | 3.133 ms                  | 114.944 ms                |
| AfterBackward             | 26.951 ms                 | 535.828 ms                |
| BlockToStepN              | 1.015 ms                  | 338.251 ms                |
| OneStep                   | 156.048 ms                | 1.560 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:03.304006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240207 12:00:04.411610 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240207 12:00:05.420931 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.503 ms                  | 135.935 ms                |
| ProcessBack:UpdateCache   | 2.862 ms                  | 255.916 ms                |
| ProcessBack:UpsertPq      | 20.384 ms                 | 81.001 ms                 |
| ProcessOneStep            | 27.245 ms                 | 94.565 ms                 |
| BlockToStepN              | 225.246 ms                | 338.174 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:06.420006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240207 12:00:07.665928 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.122 ms                  | 197.417 ms                |
| Forward                   | 4.756 ms                  | 6.732 ms                  |
| Backward                  | 10.181 ms                 | 13.180 ms                 |
| Optimize                  | 2.321 ms                  | 5.776 ms                  |
| BarrierTimeBeforeRank0    | 3.133 ms                  | 193.764 ms                |
| AfterBackward             | 28.117 ms                 | 94.602 ms                 |
| BlockToStepN              | 1.015 ms                  | 338.222 ms                |
| OneStep                   | 179.428 ms                | 669.949 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:08.665014 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240207 12:00:09.665006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240207 12:00:10.665006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.593 ms                  | 135.935 ms                |
| ProcessBack:UpdateCache   | 2.873 ms                  | 255.916 ms                |
| ProcessBack:UpsertPq      | 20.922 ms                 | 81.001 ms                 |
| ProcessOneStep            | 29.032 ms                 | 94.565 ms                 |
| BlockToStepN              | 1.644 ms                  | 339.953 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:11.665005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240207 12:00:12.683553 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=78, pq.top=78
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.393 ms                  | 197.417 ms                |
| Forward                   | 4.859 ms                  | 6.732 ms                  |
| Backward                  | 10.159 ms                 | 13.180 ms                 |
| Optimize                  | 2.423 ms                  | 5.776 ms                  |
| BarrierTimeBeforeRank0    | 2.308 ms                  | 193.764 ms                |
| AfterBackward             | 29.066 ms                 | 94.602 ms                 |
| BlockToStepN              | 1.677 ms                  | 340.132 ms                |
| OneStep                   | 179.428 ms                | 669.949 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:13.683004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240207 12:00:14.683005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240207 12:00:15.683004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.586 ms                  | 30.107 ms                 |
| ProcessBack:UpdateCache   | 2.870 ms                  | 29.556 ms                 |
| ProcessBack:UpsertPq      | 20.658 ms                 | 54.651 ms                 |
| ProcessOneStep            | 28.094 ms                 | 94.565 ms                 |
| BlockToStepN              | 1.644 ms                  | 359.058 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:16.683005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240207 12:00:17.683005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.783 ms                  | 197.417 ms                |
| Forward                   | 4.859 ms                  | 6.732 ms                  |
| Backward                  | 10.252 ms                 | 13.180 ms                 |
| Optimize                  | 2.511 ms                  | 5.776 ms                  |
| BarrierTimeBeforeRank0    | 1.272 ms                  | 193.764 ms                |
| AfterBackward             | 28.115 ms                 | 94.602 ms                 |
| BlockToStepN              | 1.677 ms                  | 405.092 ms                |
| OneStep                   | 179.428 ms                | 669.949 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.155, sample: 1.749, forward: 0.960, backward: 1.200, update: 0.283
train_sampler.Prefill()
-------Step 0-------
tensor([   56419,   621907, 46555389,   935813,   556475,   621928,   621959,
          259516,    56459,    56490]) tensor([ 5010089, 24187246, 20045362, 45023454, 58408130, 31899565, 73451609,
        65711951, 49358117, 81887917])
-------Step 1-------
tensor([   56419,   621907, 46555389,   935813,   556475,   621928,   621959,
          259516,    56459,    56490]) tensor([31276613, 65865399, 81024138, 11544809, 61453050,  9343381, 84337548,
        69969124, 15986860, 36356733])
-------Step 2-------
tensor([  691388,    69290, 77407801,    69324,   691418,   691438,   691472,
        45856559,   691498,   691525]) tensor([39839007,  5087815, 52429253, 11083879, 17805415, 13425553, 64872499,
         9757592, 51041740, 29204452])
-------Step 3-------
tensor([  691388,    69290, 77407801,    69324,   691418,   691438,   691472,
        45856559,   691498,   691525]) tensor([19335291, 50003803, 66050297, 43877968, 15889854, 73961692, 75354701,
        55045170, 23748731, 67525238])
-------Step 4-------
tensor([761914,  82845, 761950, 761973,  82881, 761997,  82916, 762025,  82967,
        762043]) tensor([72082697, 35130386, 19010372, 14981781, 48962798, 47835578, 70987647,
        43088180, 49814291,  9927103])
-------Step 5-------
tensor([761914,  82845, 761950, 761973,  82881, 761997,  82916, 762025,  82967,
        762043]) tensor([36717842, 48595325, 83398019, 10373542, 41140680, 26757451, 32286962,
        62419744, 78877200,   454456])
-------Step 6-------
tensor([65659837,   831438,   831457,   831478,  4308967,   831502,   831526,
          831556,   831577,   266150]) tensor([23964902, 38662436, 22991562, 18091700, 79584608, 49791305, 46751819,
        16237054, 73367868,  8429960])
-------Step 7-------
tensor([65659837,   831438,   831457,   831478,  4308967,   831502,   831526,
          831556,   831577,   266150]) tensor([34516853, 77565297, 54727014, 61625910, 60513149,  1540394, 19276311,
        53485610, 22963195, 17270943])
-------Step 8-------
tensor([  883518,   111239,   883526, 39472791,   956392,   883538,   883548,
          883558,   268189,   956405]) tensor([28437743, 60615678, 41414547, 84964081, 77100216, 55446978, 65486970,
        81489329, 11774464,  3240074])
-------Step 9-------
tensor([  883518,   111239,   883526, 39472791,   956392,   883538,   883548,
          883558,   268189,   956405]) tensor([64406702, 56787796, 27771470, 37492742, 13453428,  1026611, 21704900,
        16010504, 71132725, 40720989])
before start barrier
start train
[proc 0] 100 steps, total: 25.790, sample: 1.684, forward: 0.986, backward: 1.196, update: 0.323
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 25.217, sample: 2.270, forward: 1.014, backward: 1.213, update: 0.295
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 28.297, sample: 1.515, forward: 0.896, backward: 1.283, update: 0.268
W20240207 12:00:18.683004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240207 12:00:19.683007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240207 12:00:20.683005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.551 ms                  | 30.107 ms                 |
| ProcessBack:UpdateCache   | 2.870 ms                  | 29.556 ms                 |
| ProcessBack:UpsertPq      | 20.175 ms                 | 54.651 ms                 |
| ProcessOneStep            | 27.812 ms                 | 94.565 ms                 |
| BlockToStepN              | 1.644 ms                  | 407.580 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:21.683005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240207 12:00:22.683005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.301 ms                  | 197.417 ms                |
| Forward                   | 4.846 ms                  | 6.732 ms                  |
| Backward                  | 10.529 ms                 | 27.791 ms                 |
| Optimize                  | 2.537 ms                  | 16.230 ms                 |
| BarrierTimeBeforeRank0    | 620.061 us                | 193.764 ms                |
| AfterBackward             | 27.625 ms                 | 94.602 ms                 |
| BlockToStepN              | 1.769 ms                  | 407.632 ms                |
| OneStep                   | 179.428 ms                | 669.949 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:23.683007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240207 12:00:24.683005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240207 12:00:25.683009 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.535 ms                  | 12.688 ms                 |
| ProcessBack:UpdateCache   | 2.873 ms                  | 20.709 ms                 |
| ProcessBack:UpsertPq      | 20.010 ms                 | 52.181 ms                 |
| ProcessOneStep            | 27.601 ms                 | 94.565 ms                 |
| BlockToStepN              | 225.246 ms                | 407.580 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:26.683007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240207 12:00:27.683007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.118 ms                  | 197.417 ms                |
| Forward                   | 4.855 ms                  | 6.732 ms                  |
| Backward                  | 11.082 ms                 | 27.791 ms                 |
| Optimize                  | 2.543 ms                  | 16.230 ms                 |
| BarrierTimeBeforeRank0    | 525.779 us                | 193.764 ms                |
| AfterBackward             | 27.745 ms                 | 94.602 ms                 |
| BlockToStepN              | 6.267 ms                  | 407.632 ms                |
| OneStep                   | 179.428 ms                | 669.949 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:28.683005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240207 12:00:29.683005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240207 12:00:30.767680 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.530 ms                  | 12.688 ms                 |
| ProcessBack:UpdateCache   | 2.845 ms                  | 20.709 ms                 |
| ProcessBack:UpsertPq      | 20.190 ms                 | 52.797 ms                 |
| ProcessOneStep            | 27.902 ms                 | 85.249 ms                 |
| BlockToStepN              | 6.227 ms                  | 405.028 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:31.767004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240207 12:00:32.767015 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.342 ms                  | 123.578 ms                |
| Forward                   | 4.859 ms                  | 6.732 ms                  |
| Backward                  | 11.230 ms                 | 17.806 ms                 |
| Optimize                  | 2.579 ms                  | 10.550 ms                 |
| BarrierTimeBeforeRank0    | 69.322 us                 | 114.944 ms                |
| AfterBackward             | 27.840 ms                 | 85.280 ms                 |
| BlockToStepN              | 6.267 ms                  | 405.092 ms                |
| OneStep                   | 179.428 ms                | 655.840 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:33.810029 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240207 12:00:34.821866 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=170, pq.top=170
W20240207 12:00:35.821003 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.524 ms                  | 8.942 ms                  |
| ProcessBack:UpdateCache   | 2.827 ms                  | 7.737 ms                  |
| ProcessBack:UpsertPq      | 19.895 ms                 | 52.181 ms                 |
| ProcessOneStep            | 27.601 ms                 | 85.249 ms                 |
| BlockToStepN              | 6.227 ms                  | 405.028 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:36.821004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.393 ms                  | 127.491 ms                |
| Forward                   | 4.846 ms                  | 7.852 ms                  |
| Backward                  | 11.260 ms                 | 17.806 ms                 |
| Optimize                  | 2.562 ms                  | 10.550 ms                 |
| BarrierTimeBeforeRank0    | 47.036 us                 | 114.944 ms                |
| AfterBackward             | 27.287 ms                 | 85.280 ms                 |
| BlockToStepN              | 6.267 ms                  | 405.092 ms                |
| OneStep                   | 179.428 ms                | 655.840 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:37.821003 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240207 12:00:38.821004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240207 12:00:39.821004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240207 12:00:40.821005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.517 ms                  | 8.942 ms                  |
| ProcessBack:UpdateCache   | 2.714 ms                  | 7.737 ms                  |
| ProcessBack:UpsertPq      | 19.058 ms                 | 52.181 ms                 |
| ProcessOneStep            | 26.945 ms                 | 85.249 ms                 |
| BlockToStepN              | 6.227 ms                  | 405.028 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 23.718, sample: 1.377, forward: 0.429, backward: 1.108, update: 0.239
[proc 2] 200 steps, total: 23.718, sample: 1.797, forward: 0.514, backward: 1.045, update: 0.250
[proc 0] 200 steps, total: 23.718, sample: 1.607, forward: 0.491, backward: 1.156, update: 0.287
[proc 1] 200 steps, total: 23.718, sample: 1.555, forward: 0.494, backward: 1.022, update: 0.234
W20240207 12:00:41.821004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.488 ms                  | 127.491 ms                |
| Forward                   | 4.844 ms                  | 7.852 ms                  |
| Backward                  | 11.279 ms                 | 17.806 ms                 |
| Optimize                  | 2.543 ms                  | 10.550 ms                 |
| BarrierTimeBeforeRank0    | 40.876 us                 | 114.944 ms                |
| AfterBackward             | 26.853 ms                 | 85.280 ms                 |
| BlockToStepN              | 6.267 ms                  | 405.092 ms                |
| OneStep                   | 179.428 ms                | 655.840 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:42.821003 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240207 12:00:43.821004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240207 12:00:44.870517 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240207 12:00:45.870005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.524 ms                  | 12.688 ms                 |
| ProcessBack:UpdateCache   | 2.691 ms                  | 7.737 ms                  |
| ProcessBack:UpsertPq      | 18.789 ms                 | 52.181 ms                 |
| ProcessOneStep            | 26.458 ms                 | 85.249 ms                 |
| BlockToStepN              | 6.227 ms                  | 405.028 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:46.870667 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.488 ms                  | 127.491 ms                |
| Forward                   | 4.844 ms                  | 7.854 ms                  |
| Backward                  | 11.292 ms                 | 17.806 ms                 |
| Optimize                  | 2.537 ms                  | 10.550 ms                 |
| BarrierTimeBeforeRank0    | 41.328 us                 | 114.944 ms                |
| AfterBackward             | 26.446 ms                 | 85.280 ms                 |
| BlockToStepN              | 225.287 ms                | 405.092 ms                |
| OneStep                   | 298.430 ms                | 655.840 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:47.903614 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240207 12:00:48.975208 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240207 12:00:49.975008 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240207 12:00:50.975005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.517 ms                  | 8.942 ms                  |
| ProcessBack:UpdateCache   | 2.675 ms                  | 5.823 ms                  |
| ProcessBack:UpsertPq      | 18.699 ms                 | 46.792 ms                 |
| ProcessOneStep            | 26.164 ms                 | 85.249 ms                 |
| BlockToStepN              | 6.227 ms                  | 405.028 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:51.975006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.783 ms                  | 127.491 ms                |
| Forward                   | 4.846 ms                  | 9.272 ms                  |
| Backward                  | 11.260 ms                 | 17.806 ms                 |
| Optimize                  | 2.525 ms                  | 10.550 ms                 |
| BarrierTimeBeforeRank0    | 41.547 us                 | 123.670 ms                |
| AfterBackward             | 26.456 ms                 | 85.280 ms                 |
| BlockToStepN              | 6.267 ms                  | 405.092 ms                |
| OneStep                   | 179.428 ms                | 655.840 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:52.975004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240207 12:00:53.975005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240207 12:00:54.975004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240207 12:00:56.004622 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.499 ms                  | 8.942 ms                  |
| ProcessBack:UpdateCache   | 2.663 ms                  | 5.823 ms                  |
| ProcessBack:UpsertPq      | 18.844 ms                 | 46.792 ms                 |
| ProcessOneStep            | 26.458 ms                 | 59.470 ms                 |
| BlockToStepN              | 6.227 ms                  | 398.624 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:57.004006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.931 ms                  | 127.491 ms                |
| Forward                   | 4.838 ms                  | 7.854 ms                  |
| Backward                  | 11.224 ms                 | 15.652 ms                 |
| Optimize                  | 2.527 ms                  | 9.834 ms                  |
| BarrierTimeBeforeRank0    | 40.440 us                 | 114.944 ms                |
| AfterBackward             | 26.531 ms                 | 59.496 ms                 |
| BlockToStepN              | 6.267 ms                  | 398.668 ms                |
| OneStep                   | 179.428 ms                | 652.817 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:00:58.004004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240207 12:00:59.004005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240207 12:01:00.004006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240207 12:01:01.004005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.512 ms                  | 8.560 ms                  |
| ProcessBack:UpdateCache   | 2.737 ms                  | 5.712 ms                  |
| ProcessBack:UpsertPq      | 18.699 ms                 | 45.972 ms                 |
| ProcessOneStep            | 26.205 ms                 | 59.470 ms                 |
| BlockToStepN              | 6.227 ms                  | 398.624 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:02.004004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.946 ms                  | 135.508 ms                |
| Forward                   | 4.810 ms                  | 7.854 ms                  |
| Backward                  | 11.168 ms                 | 15.652 ms                 |
| Optimize                  | 2.511 ms                  | 9.834 ms                  |
| BarrierTimeBeforeRank0    | 40.876 us                 | 114.944 ms                |
| AfterBackward             | 26.097 ms                 | 59.496 ms                 |
| BlockToStepN              | 6.267 ms                  | 398.668 ms                |
| OneStep                   | 179.428 ms                | 652.817 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:03.004004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240207 12:01:04.004004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
[proc 3] 300 steps, total: 23.099, sample: 1.160, forward: 0.424, backward: 1.109, update: 0.230
[proc 1] 300 steps, total: 23.099, sample: 1.651, forward: 0.462, backward: 1.021, update: 0.235
[proc 0] 300 steps, total: 23.099, sample: 1.561, forward: 0.499, backward: 1.009, update: 0.277
[proc 2] 300 steps, total: 23.099, sample: 1.833, forward: 0.487, backward: 0.825, update: 0.229
W20240207 12:01:05.004004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240207 12:01:06.004864 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=306, pq.top=306
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.526 ms                  | 8.560 ms                  |
| ProcessBack:UpdateCache   | 2.753 ms                  | 5.712 ms                  |
| ProcessBack:UpsertPq      | 18.480 ms                 | 45.972 ms                 |
| ProcessOneStep            | 25.843 ms                 | 59.470 ms                 |
| BlockToStepN              | 6.227 ms                  | 398.624 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:07.105623 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.980 ms                  | 135.508 ms                |
| Forward                   | 4.808 ms                  | 7.854 ms                  |
| Backward                  | 11.021 ms                 | 15.652 ms                 |
| Optimize                  | 2.493 ms                  | 9.834 ms                  |
| BarrierTimeBeforeRank0    | 42.621 us                 | 114.944 ms                |
| AfterBackward             | 25.807 ms                 | 59.496 ms                 |
| BlockToStepN              | 6.267 ms                  | 398.668 ms                |
| OneStep                   | 179.428 ms                | 652.817 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:08.105005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240207 12:01:09.105005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240207 12:01:10.119369 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=324, pq.top=324
W20240207 12:01:11.195287 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=328, pq.top=328
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.531 ms                  | 7.065 ms                  |
| ProcessBack:UpdateCache   | 2.755 ms                  | 4.922 ms                  |
| ProcessBack:UpsertPq      | 18.359 ms                 | 45.929 ms                 |
| ProcessOneStep            | 25.585 ms                 | 59.470 ms                 |
| BlockToStepN              | 6.227 ms                  | 398.624 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:12.195005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=333, pq.top=333
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.946 ms                  | 135.508 ms                |
| Forward                   | 4.807 ms                  | 7.854 ms                  |
| Backward                  | 10.790 ms                 | 17.806 ms                 |
| Optimize                  | 2.491 ms                  | 9.834 ms                  |
| BarrierTimeBeforeRank0    | 43.306 us                 | 114.944 ms                |
| AfterBackward             | 25.511 ms                 | 59.496 ms                 |
| BlockToStepN              | 6.267 ms                  | 398.668 ms                |
| OneStep                   | 179.428 ms                | 652.817 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:13.195006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240207 12:01:14.351162 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240207 12:01:15.351006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.547 ms                  | 8.560 ms                  |
| ProcessBack:UpdateCache   | 2.761 ms                  | 4.922 ms                  |
| ProcessBack:UpsertPq      | 18.149 ms                 | 45.929 ms                 |
| ProcessOneStep            | 25.324 ms                 | 59.305 ms                 |
| BlockToStepN              | 6.227 ms                  | 398.624 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:16.351008 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=351, pq.top=351
W20240207 12:01:17.384553 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=356, pq.top=356
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.828 ms                  | 127.491 ms                |
| Forward                   | 4.807 ms                  | 7.852 ms                  |
| Backward                  | 10.573 ms                 | 16.563 ms                 |
| Optimize                  | 2.469 ms                  | 9.723 ms                  |
| BarrierTimeBeforeRank0    | 43.306 us                 | 103.107 ms                |
| AfterBackward             | 25.328 ms                 | 59.333 ms                 |
| BlockToStepN              | 225.287 ms                | 397.151 ms                |
| OneStep                   | 298.430 ms                | 648.729 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:18.384006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240207 12:01:19.384006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240207 12:01:20.469799 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.556 ms                  | 8.560 ms                  |
| ProcessBack:UpdateCache   | 2.776 ms                  | 4.922 ms                  |
| ProcessBack:UpsertPq      | 18.247 ms                 | 46.574 ms                 |
| ProcessOneStep            | 25.468 ms                 | 59.470 ms                 |
| BlockToStepN              | 225.246 ms                | 397.082 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:21.469007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=373, pq.top=373
W20240207 12:01:22.469004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=377, pq.top=377
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.946 ms                  | 155.389 ms                |
| Forward                   | 4.795 ms                  | 7.852 ms                  |
| Backward                  | 10.557 ms                 | 16.563 ms                 |
| Optimize                  | 2.466 ms                  | 9.723 ms                  |
| BarrierTimeBeforeRank0    | 41.547 us                 | 103.107 ms                |
| AfterBackward             | 25.468 ms                 | 59.496 ms                 |
| BlockToStepN              | 6.267 ms                  | 397.151 ms                |
| OneStep                   | 179.428 ms                | 648.729 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:23.469007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240207 12:01:24.469009 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240207 12:01:25.469396 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=390, pq.top=390
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.567 ms                  | 7.065 ms                  |
| ProcessBack:UpdateCache   | 2.788 ms                  | 4.811 ms                  |
| ProcessBack:UpsertPq      | 18.182 ms                 | 45.972 ms                 |
| ProcessOneStep            | 25.485 ms                 | 59.470 ms                 |
| BlockToStepN              | 6.227 ms                  | 397.082 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:26.469004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
W20240207 12:01:27.469004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 3] 400 steps, total: 23.085, sample: 1.234, forward: 0.422, backward: 1.091, update: 0.229
[proc 0] 400 steps, total: 23.084, sample: 1.656, forward: 0.476, backward: 1.035, update: 0.267
[proc 1] 400 steps, total: 23.084, sample: 1.569, forward: 0.476, backward: 1.034, update: 0.256
[proc 2] 400 steps, total: 23.084, sample: 1.816, forward: 0.470, backward: 0.430, update: 0.215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.962 ms                  | 173.475 ms                |
| Forward                   | 4.794 ms                  | 7.852 ms                  |
| Backward                  | 10.483 ms                 | 16.563 ms                 |
| Optimize                  | 2.468 ms                  | 9.723 ms                  |
| BarrierTimeBeforeRank0    | 40.313 us                 | 103.107 ms                |
| AfterBackward             | 25.420 ms                 | 59.496 ms                 |
| BlockToStepN              | 6.267 ms                  | 397.151 ms                |
| OneStep                   | 179.428 ms                | 648.729 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:28.469005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240207 12:01:29.469004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240207 12:01:30.469007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.575 ms                  | 7.065 ms                  |
| ProcessBack:UpdateCache   | 2.791 ms                  | 4.811 ms                  |
| ProcessBack:UpsertPq      | 18.029 ms                 | 45.972 ms                 |
| ProcessOneStep            | 25.270 ms                 | 59.470 ms                 |
| BlockToStepN              | 6.227 ms                  | 397.082 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:31.469007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240207 12:01:32.469005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=421, pq.top=421
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.893 ms                  | 173.475 ms                |
| Forward                   | 4.790 ms                  | 7.852 ms                  |
| Backward                  | 10.420 ms                 | 16.563 ms                 |
| Optimize                  | 2.458 ms                  | 9.723 ms                  |
| BarrierTimeBeforeRank0    | 41.328 us                 | 103.107 ms                |
| AfterBackward             | 25.149 ms                 | 59.496 ms                 |
| BlockToStepN              | 31.892 ms                 | 397.151 ms                |
| OneStep                   | 179.428 ms                | 648.729 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:33.469007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=425, pq.top=425
W20240207 12:01:34.474188 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=430, pq.top=430
W20240207 12:01:35.474004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=435, pq.top=435
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.582 ms                  | 6.854 ms                  |
| ProcessBack:UpdateCache   | 2.803 ms                  | 4.286 ms                  |
| ProcessBack:UpsertPq      | 17.849 ms                 | 45.929 ms                 |
| ProcessOneStep            | 24.978 ms                 | 59.470 ms                 |
| BlockToStepN              | 225.246 ms                | 397.082 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:36.474004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240207 12:01:37.474005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.676 ms                  | 173.475 ms                |
| Forward                   | 4.789 ms                  | 7.852 ms                  |
| Backward                  | 10.362 ms                 | 16.563 ms                 |
| Optimize                  | 2.452 ms                  | 9.723 ms                  |
| BarrierTimeBeforeRank0    | 41.547 us                 | 103.107 ms                |
| AfterBackward             | 24.981 ms                 | 59.496 ms                 |
| BlockToStepN              | 39.741 ms                 | 397.151 ms                |
| OneStep                   | 179.428 ms                | 648.729 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:38.474005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
W20240207 12:01:39.516685 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240207 12:01:40.516006 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.586 ms                  | 7.065 ms                  |
| ProcessBack:UpdateCache   | 2.805 ms                  | 4.286 ms                  |
| ProcessBack:UpsertPq      | 17.697 ms                 | 45.929 ms                 |
| ProcessOneStep            | 24.867 ms                 | 59.305 ms                 |
| BlockToStepN              | 74.376 ms                 | 395.875 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:41.538897 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240207 12:01:42.538005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=465, pq.top=465
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.534 ms                  | 155.389 ms                |
| Forward                   | 4.781 ms                  | 7.795 ms                  |
| Backward                  | 10.324 ms                 | 15.652 ms                 |
| Optimize                  | 2.449 ms                  | 5.776 ms                  |
| BarrierTimeBeforeRank0    | 43.106 us                 | 89.606 ms                 |
| AfterBackward             | 24.846 ms                 | 59.333 ms                 |
| BlockToStepN              | 225.287 ms                | 395.944 ms                |
| OneStep                   | 298.430 ms                | 593.005 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:43.538005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240207 12:01:44.538005 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240207 12:01:45.538010 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=477, pq.top=477
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.589 ms                  | 6.854 ms                  |
| ProcessBack:UpdateCache   | 2.811 ms                  | 4.266 ms                  |
| ProcessBack:UpsertPq      | 17.549 ms                 | 45.292 ms                 |
| ProcessOneStep            | 24.762 ms                 | 59.305 ms                 |
| BlockToStepN              | 74.376 ms                 | 395.875 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:46.538004 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240207 12:01:47.538007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=485, pq.top=485
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.401 ms                  | 155.389 ms                |
| Forward                   | 4.781 ms                  | 7.795 ms                  |
| Backward                  | 10.312 ms                 | 16.306 ms                 |
| Optimize                  | 2.449 ms                  | 9.723 ms                  |
| BarrierTimeBeforeRank0    | 43.234 us                 | 89.606 ms                 |
| AfterBackward             | 24.834 ms                 | 59.496 ms                 |
| BlockToStepN              | 74.415 ms                 | 395.944 ms                |
| OneStep                   | 179.428 ms                | 593.005 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 12:01:48.538007 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=489, pq.top=489
W20240207 12:01:49.581943 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240207 12:01:50.615571 49972 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=499, pq.top=499
[proc 0] 500 steps, total: 23.231, sample: 1.228, forward: 0.466, backward: 1.015, update: 0.265
[proc 2] 500 steps, total: 23.231, sample: 1.587, forward: 0.471, backward: 0.456, update: 0.208
[proc 1] 500 steps, total: 23.231, sample: 1.417, forward: 0.476, backward: 1.018, update: 0.225
[proc 3] 500 steps, total: 23.231, sample: 1.106, forward: 0.448, backward: 1.100, update: 0.226
Successfully xmh. training takes 118.92288732528687 seconds
before call kg_cache_controller.StopThreads()
W20240207 12:01:51.033305 49972 grad_async_v1.h:243] call StopThreads. PID = 48811
W20240207 12:01:51.033326 49972 grad_base.h:212] before processOneStepNegThread_.join();
W20240207 12:01:51.039435 49972 grad_base.h:214] after processOneStepNegThread_.join();
W20240207 12:01:51.039450 49972 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240207 12:01:51.079627 49972 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.593 ms                  | 7.065 ms                  |
| ProcessBack:UpdateCache   | 2.811 ms                  | 4.266 ms                  |
| ProcessBack:UpsertPq      | 17.688 ms                 | 45.929 ms                 |
| ProcessOneStep            | 24.908 ms                 | 59.470 ms                 |
| BlockToStepN              | 74.376 ms                 | 395.875 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.401 ms                  | 155.389 ms                |
| Forward                   | 4.771 ms                  | 7.795 ms                  |
| Backward                  | 10.298 ms                 | 16.306 ms                 |
| Optimize                  | 2.445 ms                  | 9.723 ms                  |
| BarrierTimeBeforeRank0    | 45.312 us                 | 89.606 ms                 |
| AfterBackward             | 24.937 ms                 | 59.496 ms                 |
| BlockToStepN              | 74.415 ms                 | 395.944 ms                |
| OneStep                   | 179.428 ms                | 593.005 ms                |
+---------------------------+---------------------------+---------------------------+
