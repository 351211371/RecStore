WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 23:22:00.130271 55972 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_18', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [55972 sampler.py:454] Start PreSampling
WARNING [55972 sampler.py:532] Before construct renumbering_dict
WARNING [55972 sampler.py:555] PreSampling done
W20240206 23:41:46.719863 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 23:41:46.720067 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 23:41:46.720121 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 23:41:46.720162 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 23:41:46.720199 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 23:41:46.720238 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 23:41:46.720281 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 23:41:46.720331 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 23:41:46.720361 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 23:41:46.720398 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 23:41:46.720436 55972 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 23:41:46.720466 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 23:41:46.720499 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 23:41:46.720635 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 23:41:46.720677 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 23:41:46.720707 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 23:41:46.720747 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 23:41:46.720777 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 23:41:46.720805 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 23:41:46.720837 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 23:41:46.720865 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 23:41:46.720904 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 23:41:46.720935 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 23:41:46.720968 55972 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 23:41:46.720992 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 23:41:46.721017 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 23:41:46.721073 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 23:41:46.721104 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 23:41:46.721133 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 23:41:46.721163 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 23:41:46.721196 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 23:41:46.721230 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 23:41:46.721259 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 23:41:46.721289 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 23:41:46.721320 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 23:41:46.721362 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 23:41:46.721391 55972 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 23:41:46.721415 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 23:41:46.721441 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 23:41:46.721495 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 23:41:46.721534 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 23:41:46.721570 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 23:41:46.721611 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 23:41:46.721642 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 23:41:46.721683 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 23:41:46.721722 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 23:41:46.721766 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 23:41:46.721797 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 23:41:46.721832 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 23:41:46.721860 55972 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 23:41:46.721884 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 23:41:46.721910 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 23:41:46.721976 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 23:41:46.722008 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 23:41:46.722054 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 23:41:46.722096 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 23:41:46.722126 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 23:41:46.722168 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 23:41:46.722198 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 23:41:46.722229 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 23:41:46.722259 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 23:41:46.722288 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 23:41:46.722317 55972 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 23:41:46.722342 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 23:41:46.722369 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 23:41:46.722430 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 23:41:46.722461 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 23:41:46.722491 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 23:41:46.722522 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 23:41:46.722559 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 23:41:46.722596 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 23:41:46.722635 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 23:41:46.722666 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 23:41:46.722707 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 23:41:46.722740 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 23:41:46.722776 55972 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 23:41:46.722802 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 23:41:46.722831 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 23:41:46.722884 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 23:41:46.722918 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 23:41:46.722949 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 23:41:46.722988 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 23:41:46.723019 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 23:41:46.723054 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 23:41:46.723084 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 23:41:46.723127 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 23:41:46.723165 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 23:41:46.723198 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 23:41:46.723228 55972 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 23:41:46.723254 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 23:41:46.723279 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 23:41:46.723343 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240206 23:41:46.723384 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240206 23:41:46.723419 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240206 23:41:46.723457 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240206 23:41:46.723495 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240206 23:41:46.723526 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240206 23:41:46.723556 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240206 23:41:46.723598 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240206 23:41:46.723637 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240206 23:41:46.723667 55972 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240206 23:41:46.723697 55972 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240206 23:41:46.723723 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240206 23:41:46.723748 55972 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240206 23:41:47.256464 55972 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240206 23:44:45.013418 55972 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605422,  8605458,    61049,  ..., 54480593, 65648078,  9411365]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1530.081 seconds
[Rank1] pid = 56790
[Rank2] pid = 56887
[Rank3] pid = 56954
[Rank4] pid = 57022
[Rank5] pid = 57091
[Rank6] pid = 57158
INFO [55972 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [56790 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [56887 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [56954 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [57022 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [57091 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [57158 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [57225 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [56954 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57091 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57158 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57225 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [57022 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55972 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56790 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [56887 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240206 23:47:43.003039 56955 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
W20240206 23:47:43.003253 57092 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [8605415, 400]; dev=5; size=12.82 GB
W20240206 23:47:43.003332 57159 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [8605415, 400]; dev=6; size=12.82 GB
W20240206 23:47:43.004657 57289 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [8605415, 400]; dev=7; size=12.82 GB
W20240206 23:47:43.005148 57226 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
W20240206 23:47:43.005335 57023 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [8605415, 400]; dev=4; size=12.82 GB
W20240206 23:47:43.005519 56791 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240206 23:47:43.006716 56888 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240206 23:47:43.097959 57159 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1020497ab000 7.629 MB
W20240206 23:47:43.098043 57289 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102049f4e000 7.629 MB
W20240206 23:47:43.098112 57023 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204ae94000 7.629 MB
W20240206 23:47:43.098109 57092 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204a6f1000 7.629 MB
W20240206 23:47:43.098151 57159 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204bdda000 7.629 MB
W20240206 23:47:43.098145 56955 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204b637000 7.629 MB
W20240206 23:47:43.098206 57289 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204c57d000 7.629 MB
W20240206 23:47:43.098212 57159 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10204cd20000 1.49 GB
W20240206 23:47:43.098260 57159 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1020ac303000 1.49 GB
W20240206 23:47:43.098279 57023 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10210b8e6000 7.629 MB
W20240206 23:47:43.098284 57289 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10210c089000 1.49 GB
W20240206 23:47:43.098306 57092 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10216b66c000 7.629 MB
W20240206 23:47:43.098328 57159 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240206 23:47:43.098347 57289 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10216be0f000 1.49 GB
W20240206 23:47:43.098356 57023 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1021cb3f2000 1.49 GB
W20240206 23:47:43.098379 57092 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10222a9d5000 1.49 GB
W20240206 23:47:43.098410 57289 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240206 23:47:43.098446 57023 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x102289fb8000 1.49 GB
W20240206 23:47:43.098526 57092 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1022e959b000 1.49 GB
W20240206 23:47:43.098578 57092 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240206 23:47:43.098655 57023 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 23:47:43.098846 56955 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x102348b7e000 7.629 MB
W20240206 23:47:43.098919 56955 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102349321000 1.49 GB
W20240206 23:47:43.098963 56955 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1023a8904000 1.49 GB
W20240206 23:47:43.099009 56955 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 23:47:43.108546 57023 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 23:47:43.108554 57092 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240206 23:47:43.108556 57289 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240206 23:47:43.108559 57159 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240206 23:47:43.109166 56955 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 23:47:43.186331 57226 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102407f01000 7.629 MB
W20240206 23:47:43.186471 57226 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1024095ea000 7.629 MB
W20240206 23:47:43.186465 56791 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1024086a4000 7.629 MB
W20240206 23:47:43.186467 56888 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102408e47000 7.629 MB
W20240206 23:47:43.186525 57226 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102409d8d000 1.49 GB
W20240206 23:47:43.186570 57226 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102469370000 1.49 GB
W20240206 23:47:43.186628 56888 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1024c8953000 7.629 MB
W20240206 23:47:43.186632 57226 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 23:47:43.186635 56791 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1024c90f6000 7.629 MB
W20240206 23:47:43.186686 56888 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1024c9899000 1.49 GB
W20240206 23:47:43.186702 56791 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102528e7c000 1.49 GB
W20240206 23:47:43.188867 57226 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 23:47:43.188930 56791 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x102588461000 1.49 GB
W20240206 23:47:43.188935 56888 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1025e7a44000 1.49 GB
W20240206 23:47:43.188985 56791 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 23:47:43.192239 56888 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 23:47:43.193953 56791 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 23:47:43.194053 56888 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [56790 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [57022 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [57158 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [56954 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [57225 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [57091 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [56887 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 57225
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [55972 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 23:48:35.990983 57226 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240206 23:48:35.991034 56888 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 23:48:35.991166 57092 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 23:48:35.991201 57023 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 23:48:35.991248 56955 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 23:48:35.991281 56791 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 23:48:35.991345 57289 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 23:48:35.991374 57159 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240206 23:48:35.993575 57226 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240206 23:48:35.993706 57226 grad_base.h:184] Init GradProcessingBase done
I20240206 23:48:48.674149 57226 grad_async_v2.h:42] Use main thread to update emb.
W20240206 23:48:48.674513 57226 kg_controller.h:78] after init GradAsyncProcessingV2
I20240206 23:48:48.674525 57226 kg_controller.h:84] Construct KGCacheController done
E20240206 23:48:50.473870 57289 recstore.cc:66] init folly done
E20240206 23:48:50.474053 56888 recstore.cc:66] init folly done
E20240206 23:48:50.474179 56791 recstore.cc:66] init folly done
E20240206 23:48:50.474188 57159 recstore.cc:66] init folly done
E20240206 23:48:50.474391 56955 recstore.cc:66] init folly done
E20240206 23:48:50.474809 57092 recstore.cc:66] init folly done
E20240206 23:48:50.475251 57023 recstore.cc:66] init folly done
E20240206 23:48:50.475307 57226 recstore.cc:66] init folly done
I20240206 23:48:50.476611 57226 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240206 23:49:09.030956 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240206 23:49:09.031749 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:49:10.218909 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240206 23:49:10.219039 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 126.643 us                | 362.292 us                |
+---------------------------+---------------------------+---------------------------+
W20240206 23:49:11.331755 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240206 23:49:11.331885 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
I20240206 23:49:11.756697 57092 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240206 23:49:12.328462 57023 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240206 23:49:12.331013 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240206 23:49:12.451972 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
I20240206 23:49:12.456847 57289 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 23:49:12.894953 56888 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240206 23:49:14.056421 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 23:49:14.074373 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240206 23:49:14.107292 57226 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 23:49:14.338339 56955 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 124.931 us                | 255.705 us                |
+---------------------------+---------------------------+---------------------------+
W20240206 23:49:15.563406 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 23:49:15.580222 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240206 23:49:15.757539 56791 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240206 23:49:16.580008 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
I20240206 23:49:16.615208 57159 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240206 23:49:16.621062 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
E20240206 23:49:19.052032 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240206 23:49:19.226739 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240206 23:49:19.232236 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 23:49:20.052026 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1425
W20240206 23:49:20.367761 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 261.614 us                | 792.581 us                |
| ProcessBack:Shuffle       | 9.822 ms                  | 358.527 ms                |
| ProcessBack:UpdateCache   | 10.013 ms                 | 715.052 ms                |
| ProcessBack:UpsertPq      | 26.758 ms                 | 176.516 ms                |
| ProcessOneStep            | 69.648 ms                 | 1.532 s                   |
| BlockToStepN              | 402.500 us                | 8.424 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240206 23:49:20.737927 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.803 ms                  | 148.762 ms                |
| Forward                   | 7.965 ms                  | 546.778 ms                |
| Backward                  | 4.957 ms                  | 195.895 ms                |
| Optimize                  | 3.677 ms                  | 44.926 ms                 |
| BarrierTimeBeforeRank0    | 1.726 ms                  | 403.329 ms                |
| AfterBackward             | 70.354 ms                 | 1.533 s                   |
| BlockToStepN              | 538.694 us                | 8.503 ms                  |
| OneStep                   | 189.795 ms                | 2.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:49:21.052009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=17736
W20240206 23:49:21.513585 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240206 23:49:21.769120 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=13, pq.top=13
E20240206 23:49:22.052012 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=2852
E20240206 23:49:22.508183 57226 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=19, sample_step_cpp_seen_[rank]=18
W20240206 23:49:22.720732 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240206 23:49:23.052012 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=375
W20240206 23:49:23.761518 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240206 23:49:24.019568 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=20, pq.top=20
E20240206 23:49:24.052012 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=66
W20240206 23:49:24.775152 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240206 23:49:25.052068 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 375.435 us                | 4.077 ms                  |
| ProcessBack:Shuffle       | 8.773 ms                  | 358.527 ms                |
| ProcessBack:UpdateCache   | 10.748 ms                 | 715.052 ms                |
| ProcessBack:UpsertPq      | 30.490 ms                 | 176.516 ms                |
| ProcessOneStep            | 102.729 ms                | 1.532 s                   |
| BlockToStepN              | 522.031 us                | 30.186 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:49:25.948983 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.477 ms                  | 239.737 ms                |
| Forward                   | 6.616 ms                  | 546.778 ms                |
| Backward                  | 5.108 ms                  | 195.895 ms                |
| Optimize                  | 2.882 ms                  | 44.926 ms                 |
| BarrierTimeBeforeRank0    | 1.793 ms                  | 403.329 ms                |
| AfterBackward             | 120.906 ms                | 1.533 s                   |
| BlockToStepN              | 641.741 us                | 30.310 ms                 |
| OneStep                   | 181.434 ms                | 2.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:49:26.052026 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1545
W20240206 23:49:26.304951 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240206 23:49:27.008764 57804 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240206 23:49:27.052028 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240206 23:49:27.508212 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=33, sample_step_cpp_seen_[rank]=32
W20240206 23:49:28.025490 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240206 23:49:28.052016 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240206 23:49:29.025321 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240206 23:49:29.052016 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
W20240206 23:49:30.043342 57804 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240206 23:49:30.052027 57826 parallel_pq_v2.h:79] insert failed, size(hashtable)=2983
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 425.357 us                | 5.964 ms                  |
| ProcessBack:Shuffle       | 8.749 ms                  | 322.518 ms                |
| ProcessBack:UpdateCache   | 11.084 ms                 | 710.699 ms                |
| ProcessBack:UpsertPq      | 41.595 ms                 | 187.546 ms                |
| ProcessOneStep            | 119.261 ms                | 1.893 s                   |
| BlockToStepN              | 361.277 us                | 30.186 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.386 ms                 | 239.737 ms                |
| Forward                   | 6.240 ms                  | 546.778 ms                |
| Backward                  | 5.289 ms                  | 195.895 ms                |
| Optimize                  | 2.544 ms                  | 44.926 ms                 |
| BarrierTimeBeforeRank0    | 89.450 us                 | 403.329 ms                |
| AfterBackward             | 120.906 ms                | 1.894 s                   |
| BlockToStepN              | 538.694 us                | 30.310 ms                 |
| OneStep                   | 189.795 ms                | 2.614 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:49:31.052011 57422 parallel_pq_v2.h:79] insert failed, size(hashtable)=15203
W20240206 23:49:31.063278 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
W20240206 23:49:31.234973 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=43, pq.top=43
E20240206 23:49:32.052007 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=983
W20240206 23:49:32.166329 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
W20240206 23:49:32.450094 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=51, pq.top=51
E20240206 23:49:33.052400 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240206 23:49:33.274107 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=55, sample_step_cpp_seen_[rank]=54
W20240206 23:49:33.354604 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240206 23:49:34.052026 57808 parallel_pq_v2.h:79] insert failed, size(hashtable)=865
W20240206 23:49:34.146015 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240206 23:49:34.386426 57804 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240206 23:49:35.052008 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=20430
W20240206 23:49:35.160918 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240206 23:49:35.443553 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 563.973 us                | 4.023 ms                  |
| ProcessBack:Shuffle       | 8.731 ms                  | 322.518 ms                |
| ProcessBack:UpdateCache   | 10.614 ms                 | 710.699 ms                |
| ProcessBack:UpsertPq      | 32.845 ms                 | 187.971 ms                |
| ProcessOneStep            | 109.183 ms                | 1.532 s                   |
| BlockToStepN              | 529.960 us                | 8.424 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.803 ms                  | 148.762 ms                |
| Forward                   | 5.688 ms                  | 16.529 ms                 |
| Backward                  | 5.353 ms                  | 9.802 ms                  |
| Optimize                  | 2.576 ms                  | 7.879 ms                  |
| BarrierTimeBeforeRank0    | 1.002 ms                  | 301.555 ms                |
| AfterBackward             | 109.238 ms                | 1.533 s                   |
| BlockToStepN              | 723.809 us                | 8.503 ms                  |
| OneStep                   | 159.023 ms                | 1.986 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:49:36.052012 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240206 23:49:36.804543 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240206 23:49:37.052013 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=67
W20240206 23:49:37.509869 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240206 23:49:37.837692 57804 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240206 23:49:38.052016 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=5853
W20240206 23:49:38.547253 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=78, pq.top=78
W20240206 23:49:38.880558 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240206 23:49:39.055573 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1698
E20240206 23:49:39.524075 57226 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=85, sample_step_cpp_seen_[rank]=84
W20240206 23:49:40.045131 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240206 23:49:40.055580 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 368.222 us                | 2.497 ms                  |
| ProcessBack:Shuffle       | 8.901 ms                  | 20.922 ms                 |
| ProcessBack:UpdateCache   | 10.662 ms                 | 27.576 ms                 |
| ProcessBack:UpsertPq      | 28.179 ms                 | 187.546 ms                |
| ProcessOneStep            | 110.372 ms                | 1.532 s                   |
| BlockToStepN              | 713.054 us                | 20.258 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.216 ms                  | 148.762 ms                |
| Forward                   | 5.456 ms                  | 16.529 ms                 |
| Backward                  | 5.325 ms                  | 9.802 ms                  |
| Optimize                  | 2.562 ms                  | 7.879 ms                  |
| BarrierTimeBeforeRank0    | 2.475 ms                  | 301.555 ms                |
| AfterBackward             | 110.417 ms                | 1.533 s                   |
| BlockToStepN              | 803.525 us                | 20.319 ms                 |
| OneStep                   | 159.023 ms                | 1.986 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:49:41.055027 57822 parallel_pq_v2.h:79] insert failed, size(hashtable)=15661
W20240206 23:49:41.104324 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240206 23:49:41.138870 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240206 23:49:42.055009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=8657
W20240206 23:49:42.217787 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240206 23:49:42.238019 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240206 23:49:43.055007 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 26.506, sample: 2.034, forward: 1.105, backward: 0.894, update: 0.273
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 30.793, sample: 2.400, forward: 1.120, backward: 0.792, update: 0.294
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 28.783, sample: 2.245, forward: 1.124, backward: 0.897, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 30.665, sample: 2.330, forward: 1.129, backward: 0.909, update: 0.272
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 31.365, sample: 2.516, forward: 1.140, backward: 0.693, update: 0.303
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 30.227, sample: 1.552, forward: 1.372, backward: 0.972, update: 0.289
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 27.364, sample: 2.721, forward: 1.073, backward: 0.712, update: 0.315
train_sampler.Prefill()
-------Step 0-------
tensor([  143410,   143434,   143458,   143480, 10200626,  1037072, 64118069,
        19231298, 26974997,   143500]) tensor([ 9535596, 17314483, 53462246, 65547771, 26106211, 38959452, 46031138,
        81098018, 63705353, 27894306])
-------Step 1-------
tensor([  143410,   143434,   143458,   143480, 10200626,  1037072, 64118069,
        19231298, 26974997,   143500]) tensor([ 3806285, 27279888, 15922654, 73154378, 73221168, 52418522, 75335170,
        57737637, 34714838, 15670452])
-------Step 2-------
tensor([  197314,   197338,   197371,   322310,   197390,   197412, 85619830,
        32184383,   197439,   197465]) tensor([63280332, 24197647, 73323190, 44304237, 52016603, 34289225, 60898763,
        37614208, 19985006, 51456145])
-------Step 3-------
tensor([  197314,   197338,   197371,   322310,   197390,   197412, 85619830,
        32184383,   197439,   197465]) tensor([44266538, 85077128, 32065768, 45801585, 56803898, 74620892, 45084875,
        18185492, 25732885,  1634076])
-------Step 4-------
tensor([  253204, 40994647,   253227,  1050276,   253247,  1050289,   253274,
        47613996,   253301,   253335]) tensor([83885093, 13149818, 85107575, 23731049, 62334874, 48203954, 76263931,
        45059506, 73550768, 46599486])
-------Step 5-------
tensor([  253204, 40994647,   253227,  1050276,   253247,  1050289,   253274,
        47613996,   253301,   253335]) tensor([30602187,  1472927,   946656, 85384620, 51180583, 56045831, 20487050,
        14379653, 62749011, 43981556])
-------Step 6-------
tensor([  310542,   351194, 31018349,   310568, 33865391, 81199110,   310599,
          310636, 47085897, 43939347]) tensor([18490925, 34783979, 43087100, 82900867, 29247871, 46086224, 31270442,
        11068812, 60130621, 71891889])
-------Step 7-------
tensor([  310542,   351194, 31018349,   310568, 33865391, 81199110,   310599,
          310636, 47085897, 43939347]) tensor([24874245, 61268692, 62850926, 70998761, 82806828, 43624453, 62086100,
        50136847, 32728291,  1005190])
-------Step 8-------
tensor([  365579, 31927687,   365604,  1061753,   365632,   365328,   365653,
          365678,   365699,   365727]) tensor([39685160, 32338365, 32059119,  3516508, 58156636,   203553, 21798084,
          761122,  2916586, 73390988])
-------Step 9-------
tensor([  365579, 31927687,   365604,  1061753,   365632,   365328,   365653,
          365678,   365699,   365727]) tensor([63087114,  2094033, 18906291, 50232414, 12443473, 48925796,   503798,
        35892055, 85147774, 73942701])
before start barrier
start train
[proc 0] 100 steps, total: 29.014, sample: 2.422, forward: 1.164, backward: 0.759, update: 0.342
W20240206 23:49:43.282635 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240206 23:49:43.370008 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240206 23:49:44.055011 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=207
W20240206 23:49:44.429337 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240206 23:49:44.524006 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=105, sample_step_cpp_seen_[rank]=104
E20240206 23:49:45.056078 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:49:45.459475 57804 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 258.603 us                | 1.152 ms                  |
| ProcessBack:Shuffle       | 8.895 ms                  | 20.922 ms                 |
| ProcessBack:UpdateCache   | 10.881 ms                 | 27.576 ms                 |
| ProcessBack:UpsertPq      | 26.800 ms                 | 187.546 ms                |
| ProcessOneStep            | 111.155 ms                | 1.532 s                   |
| BlockToStepN              | 726.082 us                | 20.258 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:49:45.706357 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.403 ms                  | 148.762 ms                |
| Forward                   | 5.655 ms                  | 16.529 ms                 |
| Backward                  | 5.364 ms                  | 9.802 ms                  |
| Optimize                  | 2.820 ms                  | 7.879 ms                  |
| BarrierTimeBeforeRank0    | 2.557 ms                  | 301.555 ms                |
| AfterBackward             | 119.310 ms                | 1.533 s                   |
| BlockToStepN              | 837.414 us                | 20.319 ms                 |
| OneStep                   | 160.100 ms                | 1.986 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:49:46.056111 57838 parallel_pq_v2.h:79] insert failed, size(hashtable)=5911
W20240206 23:49:46.619695 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
W20240206 23:49:46.732118 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=115, pq.top=115
E20240206 23:49:47.056017 57422 parallel_pq_v2.h:79] insert failed, size(hashtable)=3535
W20240206 23:49:47.640271 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
E20240206 23:49:48.056030 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=257
W20240206 23:49:48.651715 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240206 23:49:49.056008 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=32465
W20240206 23:49:49.733942 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
W20240206 23:49:49.944211 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=129, pq.top=129
E20240206 23:49:50.056008 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=12266
E20240206 23:49:50.314177 57226 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=132, sample_step_cpp_seen_[rank]=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 450.132 us                | 12.071 ms                 |
| ProcessBack:Shuffle       | 8.958 ms                  | 18.264 ms                 |
| ProcessBack:UpdateCache   | 11.424 ms                 | 27.514 ms                 |
| ProcessBack:UpsertPq      | 29.558 ms                 | 186.848 ms                |
| ProcessOneStep            | 111.155 ms                | 1.532 s                   |
| BlockToStepN              | 774.568 us                | 20.258 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:49:50.866326 57804 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.537 ms                  | 148.762 ms                |
| Forward                   | 5.501 ms                  | 16.529 ms                 |
| Backward                  | 5.583 ms                  | 9.802 ms                  |
| Optimize                  | 2.749 ms                  | 7.879 ms                  |
| BarrierTimeBeforeRank0    | 3.199 ms                  | 301.555 ms                |
| AfterBackward             | 111.220 ms                | 1.533 s                   |
| BlockToStepN              | 892.100 us                | 20.319 ms                 |
| OneStep                   | 158.493 ms                | 1.986 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:49:51.064679 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:49:51.403244 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240206 23:49:51.882558 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240206 23:49:52.064008 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=4321
W20240206 23:49:52.482882 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240206 23:49:52.969861 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240206 23:49:53.064008 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1633
W20240206 23:49:53.546711 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=147, pq.top=147
E20240206 23:49:54.064236 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:49:54.088274 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240206 23:49:55.064014 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=2198
W20240206 23:49:55.139825 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240206 23:49:55.389688 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 383.748 us                | 3.695 ms                  |
| ProcessBack:Shuffle       | 8.971 ms                  | 18.987 ms                 |
| ProcessBack:UpdateCache   | 11.697 ms                 | 27.514 ms                 |
| ProcessBack:UpsertPq      | 28.508 ms                 | 186.848 ms                |
| ProcessOneStep            | 109.183 ms                | 1.610 s                   |
| BlockToStepN              | 824.056 us                | 41.881 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.221 ms                  | 141.788 ms                |
| Forward                   | 5.496 ms                  | 13.383 ms                 |
| Backward                  | 5.922 ms                  | 8.941 ms                  |
| Optimize                  | 2.576 ms                  | 7.342 ms                  |
| BarrierTimeBeforeRank0    | 3.576 ms                  | 297.677 ms                |
| AfterBackward             | 110.417 ms                | 1.533 s                   |
| BlockToStepN              | 945.141 us                | 30.310 ms                 |
| OneStep                   | 158.601 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:49:56.064008 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=307
W20240206 23:49:56.245469 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
W20240206 23:49:56.423048 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=155, pq.top=155
E20240206 23:49:57.064033 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=7830
E20240206 23:49:57.457057 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=163, sample_step_cpp_seen_[rank]=162
W20240206 23:49:57.516957 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240206 23:49:57.673656 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=164, pq.top=164
E20240206 23:49:58.064010 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=4229
W20240206 23:49:58.767828 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
E20240206 23:49:59.064015 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=2262
W20240206 23:49:59.437435 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240206 23:49:59.870949 57804 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240206 23:50:00.064038 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 417.664 us                | 8.582 ms                  |
| ProcessBack:Shuffle       | 9.095 ms                  | 20.922 ms                 |
| ProcessBack:UpdateCache   | 11.692 ms                 | 27.514 ms                 |
| ProcessBack:UpsertPq      | 29.110 ms                 | 186.848 ms                |
| ProcessOneStep            | 109.183 ms                | 1.610 s                   |
| BlockToStepN              | 872.598 us                | 30.186 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:00.524207 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.632 ms                  | 141.788 ms                |
| Forward                   | 5.496 ms                  | 13.383 ms                 |
| Backward                  | 5.965 ms                  | 9.802 ms                  |
| Optimize                  | 2.701 ms                  | 7.342 ms                  |
| BarrierTimeBeforeRank0    | 3.957 ms                  | 297.677 ms                |
| AfterBackward             | 109.238 ms                | 1.610 s                   |
| BlockToStepN              | 959.237 us                | 30.310 ms                 |
| OneStep                   | 157.172 ms                | 1.765 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:01.004654 57804 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240206 23:50:01.064013 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=13739
E20240206 23:50:02.067354 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:50:02.082126 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240206 23:50:02.395543 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=179, pq.top=179
E20240206 23:50:03.067008 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=296
W20240206 23:50:03.188975 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
W20240206 23:50:03.423099 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=186, pq.top=185
E20240206 23:50:04.067034 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=12729
E20240206 23:50:04.236219 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=191, sample_step_cpp_seen_[rank]=190
W20240206 23:50:04.445511 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240206 23:50:05.067009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=4406
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 341.343 us                | 5.584 ms                  |
| ProcessBack:Shuffle       | 9.059 ms                  | 20.035 ms                 |
| ProcessBack:UpdateCache   | 11.692 ms                 | 17.600 ms                 |
| ProcessBack:UpsertPq      | 29.429 ms                 | 185.416 ms                |
| ProcessOneStep            | 107.028 ms                | 1.610 s                   |
| BlockToStepN              | 925.297 us                | 41.881 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:05.581976 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.492 ms                  | 141.788 ms                |
| Forward                   | 5.496 ms                  | 13.383 ms                 |
| Backward                  | 6.009 ms                  | 9.802 ms                  |
| Optimize                  | 2.695 ms                  | 7.342 ms                  |
| BarrierTimeBeforeRank0    | 3.825 ms                  | 297.677 ms                |
| AfterBackward             | 107.074 ms                | 1.610 s                   |
| BlockToStepN              | 1.021 ms                  | 42.015 ms                 |
| OneStep                   | 156.064 ms                | 1.765 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:06.067011 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=13303
W20240206 23:50:06.200459 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240206 23:50:06.637490 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
E20240206 23:50:07.067008 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=478
[proc 0] 200 steps, total: 24.216, sample: 1.078, forward: 0.559, backward: 0.743, update: 0.295
[proc 7] 200 steps, total: 24.217, sample: 1.714, forward: 0.514, backward: 0.650, update: 0.218
[proc 4] 200 steps, total: 24.217, sample: 1.914, forward: 0.534, backward: 0.787, update: 0.217
[proc 2] 200 steps, total: 24.217, sample: 1.236, forward: 0.512, backward: 0.681, update: 0.237
[proc 5] 200 steps, total: 24.217, sample: 1.638, forward: 0.543, backward: 0.623, update: 0.228
[proc 3] 200 steps, total: 24.217, sample: 2.160, forward: 0.561, backward: 0.705, update: 0.227
[proc 6] 200 steps, total: 24.217, sample: 1.831, forward: 0.531, backward: 0.745, update: 0.228
[proc 1] 200 steps, total: 24.217, sample: 1.875, forward: 0.533, backward: 0.529, update: 0.239
W20240206 23:50:07.478493 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240206 23:50:07.807471 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240206 23:50:08.067008 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=38
W20240206 23:50:08.823766 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240206 23:50:09.067077 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240206 23:50:09.236009 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=210, sample_step_cpp_seen_[rank]=209
W20240206 23:50:09.876727 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240206 23:50:09.947638 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=212, pq.top=212
E20240206 23:50:10.067009 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 359.401 us                | 6.677 ms                  |
| ProcessBack:Shuffle       | 9.040 ms                  | 20.643 ms                 |
| ProcessBack:UpdateCache   | 11.262 ms                 | 17.600 ms                 |
| ProcessBack:UpsertPq      | 28.596 ms                 | 185.416 ms                |
| ProcessOneStep            | 107.452 ms                | 1.729 s                   |
| BlockToStepN              | 1.046 ms                  | 43.864 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.987 ms                  | 141.788 ms                |
| Forward                   | 5.491 ms                  | 16.529 ms                 |
| Backward                  | 6.545 ms                  | 9.802 ms                  |
| Optimize                  | 2.660 ms                  | 7.342 ms                  |
| BarrierTimeBeforeRank0    | 3.825 ms                  | 297.677 ms                |
| AfterBackward             | 107.883 ms                | 1.729 s                   |
| BlockToStepN              | 1.140 ms                  | 44.003 ms                 |
| OneStep                   | 152.986 ms                | 1.809 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:11.010361 57804 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240206 23:50:11.067714 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:50:11.374598 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=219, pq.top=219
E20240206 23:50:12.067009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1526
W20240206 23:50:12.182919 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240206 23:50:13.067027 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=3680
W20240206 23:50:13.528057 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240206 23:50:14.067016 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1775
E20240206 23:50:14.236011 57226 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=225, sample_step_cpp_seen_[rank]=224
W20240206 23:50:14.526191 57226 grad_async_v2.h:257] pq is empty
W20240206 23:50:14.530912 57804 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240206 23:50:14.928015 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=228, pq.top=228
E20240206 23:50:15.067030 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=112
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 405.588 us                | 4.343 ms                  |
| ProcessBack:Shuffle       | 9.070 ms                  | 21.056 ms                 |
| ProcessBack:UpdateCache   | 11.192 ms                 | 17.071 ms                 |
| ProcessBack:UpsertPq      | 29.429 ms                 | 187.971 ms                |
| ProcessOneStep            | 109.183 ms                | 1.786 s                   |
| BlockToStepN              | 1.087 ms                  | 43.864 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:15.754617 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.997 ms                  | 141.788 ms                |
| Forward                   | 5.459 ms                  | 16.529 ms                 |
| Backward                  | 6.978 ms                  | 9.802 ms                  |
| Optimize                  | 2.654 ms                  | 7.879 ms                  |
| BarrierTimeBeforeRank0    | 3.468 ms                  | 297.677 ms                |
| AfterBackward             | 109.238 ms                | 1.786 s                   |
| BlockToStepN              | 1.209 ms                  | 44.003 ms                 |
| OneStep                   | 156.137 ms                | 1.986 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:16.067008 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=295
W20240206 23:50:16.142522 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240206 23:50:16.816555 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240206 23:50:17.067018 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=10231
W20240206 23:50:17.847071 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240206 23:50:18.068559 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=5615
W20240206 23:50:18.653185 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240206 23:50:18.928391 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240206 23:50:19.068011 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=3445
W20240206 23:50:20.036393 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=247, pq.top=247
E20240206 23:50:20.068015 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=38930
W20240206 23:50:20.177490 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 422.985 us                | 12.982 ms                 |
| ProcessBack:Shuffle       | 9.125 ms                  | 21.056 ms                 |
| ProcessBack:UpdateCache   | 11.192 ms                 | 17.304 ms                 |
| ProcessBack:UpsertPq      | 30.327 ms                 | 187.971 ms                |
| ProcessOneStep            | 109.183 ms                | 1.786 s                   |
| BlockToStepN              | 1.231 ms                  | 43.864 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:20.648605 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=251, sample_step_cpp_seen_[rank]=250
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.191 ms                  | 131.242 ms                |
| Forward                   | 5.458 ms                  | 13.383 ms                 |
| Backward                  | 7.673 ms                  | 8.941 ms                  |
| Optimize                  | 2.660 ms                  | 7.342 ms                  |
| BarrierTimeBeforeRank0    | 3.825 ms                  | 281.645 ms                |
| AfterBackward             | 109.562 ms                | 1.729 s                   |
| BlockToStepN              | 1.315 ms                  | 42.015 ms                 |
| OneStep                   | 156.169 ms                | 1.809 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:21.076614 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:50:21.270893 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240206 23:50:22.076009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1629
W20240206 23:50:22.282060 57804 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240206 23:50:22.671219 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=255, pq.top=255
E20240206 23:50:23.076009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=48083
W20240206 23:50:23.389989 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
W20240206 23:50:23.932170 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=263, pq.top=263
E20240206 23:50:24.076009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=522
W20240206 23:50:24.492661 57804 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240206 23:50:25.076045 57820 parallel_pq_v2.h:79] insert failed, size(hashtable)=51635
W20240206 23:50:25.082123 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 369.729 us                | 6.456 ms                  |
| ProcessBack:Shuffle       | 9.125 ms                  | 21.056 ms                 |
| ProcessBack:UpdateCache   | 11.473 ms                 | 17.600 ms                 |
| ProcessBack:UpsertPq      | 30.111 ms                 | 187.971 ms                |
| ProcessOneStep            | 109.518 ms                | 1.729 s                   |
| BlockToStepN              | 1.301 ms                  | 43.864 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:25.588326 57804 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.324 ms                  | 131.242 ms                |
| Forward                   | 5.458 ms                  | 13.383 ms                 |
| Backward                  | 7.647 ms                  | 8.941 ms                  |
| Optimize                  | 2.654 ms                  | 7.879 ms                  |
| BarrierTimeBeforeRank0    | 4.120 ms                  | 281.645 ms                |
| AfterBackward             | 109.562 ms                | 1.729 s                   |
| BlockToStepN              | 1.410 ms                  | 44.003 ms                 |
| OneStep                   | 156.169 ms                | 1.809 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:26.076010 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=146222
W20240206 23:50:26.109580 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240206 23:50:26.678789 57804 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240206 23:50:27.076014 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=3275
E20240206 23:50:27.360504 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=279, sample_step_cpp_seen_[rank]=278
W20240206 23:50:27.693914 57804 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240206 23:50:28.076020 57813 parallel_pq_v2.h:79] insert failed, size(hashtable)=44760
W20240206 23:50:28.133337 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240206 23:50:28.755396 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
E20240206 23:50:29.076011 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240206 23:50:29.194242 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240206 23:50:29.937662 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240206 23:50:30.076017 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=771
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 463.687 us                | 6.807 ms                  |
| ProcessBack:Shuffle       | 9.158 ms                  | 20.922 ms                 |
| ProcessBack:UpdateCache   | 11.412 ms                 | 17.628 ms                 |
| ProcessBack:UpsertPq      | 30.331 ms                 | 187.546 ms                |
| ProcessOneStep            | 110.372 ms                | 1.729 s                   |
| BlockToStepN              | 1.404 ms                  | 59.849 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:30.644045 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=292, pq.top=292
W20240206 23:50:30.985109 57804 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.288 ms                  | 141.788 ms                |
| Forward                   | 5.485 ms                  | 13.383 ms                 |
| Backward                  | 6.679 ms                  | 9.802 ms                  |
| Optimize                  | 2.660 ms                  | 7.879 ms                  |
| BarrierTimeBeforeRank0    | 3.825 ms                  | 281.645 ms                |
| AfterBackward             | 110.417 ms                | 1.729 s                   |
| BlockToStepN              | 1.488 ms                  | 59.984 ms                 |
| OneStep                   | 157.172 ms                | 1.809 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:31.076464 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:50:31.690402 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240206 23:50:31.994483 57804 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240206 23:50:32.076016 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=25
[proc 2] 300 steps, total: 24.752, sample: 1.200, forward: 0.634, backward: 0.891, update: 0.273
[proc 7] 300 steps, total: 24.752, sample: 1.785, forward: 0.594, backward: 0.558, update: 0.231
[proc 1] 300 steps, total: 24.752, sample: 1.474, forward: 0.507, backward: 0.531, update: 0.233
[proc 6] 300 steps, total: 24.752, sample: 1.636, forward: 0.605, backward: 0.520, update: 0.237
[proc 5] 300 steps, total: 24.752, sample: 1.595, forward: 0.661, backward: 0.648, update: 0.298
[proc 3] 300 steps, total: 24.752, sample: 1.849, forward: 0.535, backward: 0.515, update: 0.239
[proc 4] 300 steps, total: 24.752, sample: 1.560, forward: 0.550, backward: 0.768, update: 0.231
[proc 0] 300 steps, total: 24.752, sample: 1.614, forward: 0.587, backward: 0.710, update: 0.332
W20240206 23:50:32.744108 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=303, pq.top=303
E20240206 23:50:33.076012 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=695
W20240206 23:50:33.120683 57804 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240206 23:50:33.565297 57226 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=309, sample_step_cpp_seen_[rank]=308
E20240206 23:50:34.076011 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=4576
W20240206 23:50:34.179800 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240206 23:50:35.076015 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=1256
W20240206 23:50:35.111338 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240206 23:50:35.197954 57804 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 405.089 us                | 4.943 ms                  |
| ProcessBack:Shuffle       | 9.160 ms                  | 22.906 ms                 |
| ProcessBack:UpdateCache   | 11.242 ms                 | 17.628 ms                 |
| ProcessBack:UpsertPq      | 30.111 ms                 | 187.546 ms                |
| ProcessOneStep            | 111.550 ms                | 1.729 s                   |
| BlockToStepN              | 1.449 ms                  | 77.000 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.324 ms                  | 148.762 ms                |
| Forward                   | 5.491 ms                  | 13.383 ms                 |
| Backward                  | 6.679 ms                  | 11.337 ms                 |
| Optimize                  | 2.695 ms                  | 7.879 ms                  |
| BarrierTimeBeforeRank0    | 3.517 ms                  | 281.645 ms                |
| AfterBackward             | 111.220 ms                | 1.729 s                   |
| BlockToStepN              | 1.536 ms                  | 77.094 ms                 |
| OneStep                   | 158.493 ms                | 1.809 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:36.076014 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=309
W20240206 23:50:36.246771 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240206 23:50:36.351382 57804 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240206 23:50:37.076009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=4335
W20240206 23:50:37.525341 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
E20240206 23:50:38.076011 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=2132
W20240206 23:50:38.155678 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240206 23:50:38.548280 57804 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240206 23:50:39.076014 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=134
W20240206 23:50:39.170707 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240206 23:50:39.600111 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240206 23:50:39.870283 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=340, sample_step_cpp_seen_[rank]=339
E20240206 23:50:40.076014 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 458.542 us                | 19.653 ms                 |
| ProcessBack:Shuffle       | 9.209 ms                  | 22.906 ms                 |
| ProcessBack:UpdateCache   | 11.443 ms                 | 17.600 ms                 |
| ProcessBack:UpsertPq      | 29.558 ms                 | 186.848 ms                |
| ProcessOneStep            | 111.587 ms                | 1.729 s                   |
| BlockToStepN              | 1.515 ms                  | 77.000 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:40.733494 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.324 ms                  | 148.762 ms                |
| Forward                   | 5.485 ms                  | 13.383 ms                 |
| Backward                  | 6.581 ms                  | 11.337 ms                 |
| Optimize                  | 2.684 ms                  | 7.879 ms                  |
| BarrierTimeBeforeRank0    | 3.576 ms                  | 281.645 ms                |
| AfterBackward             | 111.636 ms                | 1.729 s                   |
| BlockToStepN              | 1.594 ms                  | 77.094 ms                 |
| OneStep                   | 157.172 ms                | 1.809 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:41.076016 57836 parallel_pq_v2.h:79] insert failed, size(hashtable)=1897
W20240206 23:50:41.780382 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240206 23:50:42.063186 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=349, pq.top=349
E20240206 23:50:42.076015 57837 parallel_pq_v2.h:79] insert failed, size(hashtable)=31261
W20240206 23:50:43.019977 57804 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240206 23:50:43.076014 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=444
W20240206 23:50:43.180347 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240206 23:50:44.055318 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240206 23:50:44.076004 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=5890
W20240206 23:50:44.400897 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240206 23:50:45.072149 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240206 23:50:45.076009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=12204
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 692.297 us                | 14.183 ms                 |
| ProcessBack:Shuffle       | 9.264 ms                  | 22.906 ms                 |
| ProcessBack:UpdateCache   | 11.359 ms                 | 17.600 ms                 |
| ProcessBack:UpsertPq      | 29.369 ms                 | 186.848 ms                |
| ProcessOneStep            | 111.550 ms                | 1.646 s                   |
| BlockToStepN              | 1.632 ms                  | 65.097 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:45.524171 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=367, pq.top=367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.380 ms                  | 141.788 ms                |
| Forward                   | 5.491 ms                  | 12.974 ms                 |
| Backward                  | 6.666 ms                  | 9.802 ms                  |
| Optimize                  | 2.701 ms                  | 7.342 ms                  |
| BarrierTimeBeforeRank0    | 3.576 ms                  | 217.649 ms                |
| AfterBackward             | 111.602 ms                | 1.646 s                   |
| BlockToStepN              | 1.743 ms                  | 65.226 ms                 |
| OneStep                   | 155.899 ms                | 1.765 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:46.076010 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=51059
E20240206 23:50:46.133957 57226 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=372, sample_step_cpp_seen_[rank]=371
W20240206 23:50:46.349634 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240206 23:50:47.079185 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:50:47.514182 57804 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
W20240206 23:50:48.040488 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=374, pq.top=373
E20240206 23:50:48.081571 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:50:48.584498 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240206 23:50:49.075326 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=381, pq.top=381
E20240206 23:50:49.083199 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=168
W20240206 23:50:49.704407 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240206 23:50:50.083010 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=17904
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 558.479 us                | 11.263 ms                 |
| ProcessBack:Shuffle       | 9.288 ms                  | 21.524 ms                 |
| ProcessBack:UpdateCache   | 11.359 ms                 | 17.527 ms                 |
| ProcessBack:UpsertPq      | 28.791 ms                 | 185.416 ms                |
| ProcessOneStep            | 111.155 ms                | 1.729 s                   |
| BlockToStepN              | 1.678 ms                  | 77.000 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:50.738890 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.324 ms                  | 141.788 ms                |
| Forward                   | 5.502 ms                  | 12.974 ms                 |
| Backward                  | 6.449 ms                  | 9.802 ms                  |
| Optimize                  | 2.747 ms                  | 7.342 ms                  |
| BarrierTimeBeforeRank0    | 3.517 ms                  | 217.649 ms                |
| AfterBackward             | 111.220 ms                | 1.729 s                   |
| BlockToStepN              | 1.753 ms                  | 77.094 ms                 |
| OneStep                   | 155.899 ms                | 1.809 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:51.083019 57814 parallel_pq_v2.h:79] insert failed, size(hashtable)=45309
W20240206 23:50:51.095109 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=389, pq.top=389
W20240206 23:50:51.747794 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
E20240206 23:50:52.083009 57422 parallel_pq_v2.h:79] insert failed, size(hashtable)=125806
W20240206 23:50:52.168519 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=397, pq.top=397
[proc 0] 400 steps, total: 20.491, sample: 1.136, forward: 0.578, backward: 0.641, update: 0.317
[proc 7] 400 steps, total: 20.491, sample: 1.164, forward: 0.551, backward: 0.513, update: 0.234
[proc 6] 400 steps, total: 20.491, sample: 1.468, forward: 0.516, backward: 0.659, update: 0.233
[proc 4] 400 steps, total: 20.491, sample: 1.365, forward: 0.550, backward: 0.618, update: 0.242
[proc 2] 400 steps, total: 20.491, sample: 0.970, forward: 0.527, backward: 0.840, update: 0.258
[proc 1] 400 steps, total: 20.492, sample: 1.302, forward: 0.567, backward: 0.533, update: 0.253
[proc 3] 400 steps, total: 20.491, sample: 1.507, forward: 0.510, backward: 0.488, update: 0.231
[proc 5] 400 steps, total: 20.491, sample: 1.624, forward: 0.557, backward: 0.550, update: 0.288
W20240206 23:50:52.774222 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240206 23:50:53.083009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=47050
E20240206 23:50:53.175168 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=404, sample_step_cpp_seen_[rank]=403
W20240206 23:50:53.798102 57804 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240206 23:50:53.917302 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=405, pq.top=405
E20240206 23:50:54.083029 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=241
W20240206 23:50:54.946027 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
E20240206 23:50:55.083014 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=357
W20240206 23:50:55.115186 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=413, pq.top=413
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 561.245 us                | 17.415 ms                 |
| ProcessBack:Shuffle       | 9.351 ms                  | 22.219 ms                 |
| ProcessBack:UpdateCache   | 11.412 ms                 | 17.527 ms                 |
| ProcessBack:UpsertPq      | 28.790 ms                 | 185.416 ms                |
| ProcessOneStep            | 110.869 ms                | 1.729 s                   |
| BlockToStepN              | 1.781 ms                  | 83.619 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:50:55.988137 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.380 ms                  | 141.788 ms                |
| Forward                   | 5.496 ms                  | 12.974 ms                 |
| Backward                  | 6.581 ms                  | 9.802 ms                  |
| Optimize                  | 2.670 ms                  | 7.342 ms                  |
| BarrierTimeBeforeRank0    | 3.199 ms                  | 217.649 ms                |
| AfterBackward             | 110.925 ms                | 1.729 s                   |
| BlockToStepN              | 1.874 ms                  | 83.773 ms                 |
| OneStep                   | 153.398 ms                | 1.809 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:50:56.083007 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=4959
W20240206 23:50:57.060315 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240206 23:50:57.064157 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240206 23:50:57.083009 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=41814
E20240206 23:50:58.083010 57226 parallel_pq_v2.h:79] insert failed, size(hashtable)=7574
W20240206 23:50:58.173090 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240206 23:50:58.217972 57804 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
E20240206 23:50:58.961525 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=433, sample_step_cpp_seen_[rank]=432
E20240206 23:50:59.083012 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=18407
W20240206 23:50:59.250118 57804 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240206 23:51:00.083014 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=33478
W20240206 23:51:00.258678 57804 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240206 23:51:00.476116 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=437, pq.top=437
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 575.488 us                | 10.790 ms                 |
| ProcessBack:Shuffle       | 9.380 ms                  | 21.524 ms                 |
| ProcessBack:UpdateCache   | 11.326 ms                 | 17.304 ms                 |
| ProcessBack:UpsertPq      | 28.785 ms                 | 180.707 ms                |
| ProcessOneStep            | 111.430 ms                | 1.729 s                   |
| BlockToStepN              | 1.844 ms                  | 83.619 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.243 ms                  | 141.788 ms                |
| Forward                   | 5.486 ms                  | 12.974 ms                 |
| Backward                  | 6.501 ms                  | 9.802 ms                  |
| Optimize                  | 2.660 ms                  | 7.342 ms                  |
| BarrierTimeBeforeRank0    | 3.199 ms                  | 217.649 ms                |
| AfterBackward             | 111.472 ms                | 1.729 s                   |
| BlockToStepN              | 1.949 ms                  | 83.773 ms                 |
| OneStep                   | 153.053 ms                | 1.809 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:51:01.083011 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=4455
W20240206 23:51:01.281757 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240206 23:51:01.490548 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=443, pq.top=443
E20240206 23:51:02.085290 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240206 23:51:02.521687 57804 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 23:51:03.086845 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 23:51:03.533201 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240206 23:51:03.576925 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240206 23:51:04.086174 57820 parallel_pq_v2.h:79] insert failed, size(hashtable)=20603
W20240206 23:51:04.557543 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=458, pq.top=457
W20240206 23:51:04.588372 57804 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
E20240206 23:51:05.086007 57422 parallel_pq_v2.h:79] insert failed, size(hashtable)=2990
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 552.919 us                | 24.624 ms                 |
| ProcessBack:Shuffle       | 9.427 ms                  | 21.524 ms                 |
| ProcessBack:UpdateCache   | 11.318 ms                 | 17.304 ms                 |
| ProcessBack:UpsertPq      | 28.596 ms                 | 180.707 ms                |
| ProcessOneStep            | 110.372 ms                | 1.646 s                   |
| BlockToStepN              | 1.883 ms                  | 77.000 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:51:05.769846 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
W20240206 23:51:05.771538 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=467, pq.top=467
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.072 ms                  | 131.242 ms                |
| Forward                   | 5.474 ms                  | 12.974 ms                 |
| Backward                  | 6.397 ms                  | 8.941 ms                  |
| Optimize                  | 2.670 ms                  | 7.275 ms                  |
| BarrierTimeBeforeRank0    | 3.621 ms                  | 177.975 ms                |
| AfterBackward             | 110.925 ms                | 1.646 s                   |
| BlockToStepN              | 1.993 ms                  | 77.094 ms                 |
| OneStep                   | 152.772 ms                | 1.765 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:51:06.035856 57422 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=469, sample_step_cpp_seen_[rank]=468
E20240206 23:51:06.086010 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=142
W20240206 23:51:06.805140 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240206 23:51:07.086038 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=829
W20240206 23:51:07.407938 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240206 23:51:07.840225 57804 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240206 23:51:08.086021 57818 parallel_pq_v2.h:79] insert failed, size(hashtable)=40234
W20240206 23:51:08.438895 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=478, pq.top=478
W20240206 23:51:08.852892 57804 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
E20240206 23:51:09.086016 57838 parallel_pq_v2.h:79] insert failed, size(hashtable)=70226
W20240206 23:51:09.463891 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240206 23:51:09.980104 57804 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
E20240206 23:51:10.093204 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=6093
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 619.819 us                | 38.178 ms                 |
| ProcessBack:Shuffle       | 9.427 ms                  | 21.524 ms                 |
| ProcessBack:UpdateCache   | 11.242 ms                 | 17.071 ms                 |
| ProcessBack:UpsertPq      | 28.557 ms                 | 180.701 ms                |
| ProcessOneStep            | 109.183 ms                | 1.646 s                   |
| BlockToStepN              | 1.971 ms                  | 77.000 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 23:51:10.820283 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240206 23:51:10.987249 57804 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.096 ms                  | 131.242 ms                |
| Forward                   | 5.486 ms                  | 13.383 ms                 |
| Backward                  | 6.549 ms                  | 9.915 ms                  |
| Optimize                  | 2.671 ms                  | 7.275 ms                  |
| BarrierTimeBeforeRank0    | 3.576 ms                  | 177.975 ms                |
| AfterBackward             | 109.238 ms                | 1.646 s                   |
| BlockToStepN              | 2.033 ms                  | 77.094 ms                 |
| OneStep                   | 152.748 ms                | 1.765 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 23:51:11.093011 57836 parallel_pq_v2.h:79] insert failed, size(hashtable)=31568
W20240206 23:51:11.820120 57226 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240206 23:51:11.990326 57804 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
E20240206 23:51:12.093012 57809 parallel_pq_v2.h:79] insert failed, size(hashtable)=58044
[proc 5] 500 steps, total: 20.193, sample: 1.696, forward: 0.567, backward: 0.548, update: 0.281
[proc 3] 500 steps, total: 20.193, sample: 1.252, forward: 0.506, backward: 0.543, update: 0.228
[proc 6] 500 steps, total: 20.193, sample: 1.448, forward: 0.519, backward: 0.552, update: 0.231
[proc 7] 500 steps, total: 20.193, sample: 1.011, forward: 0.545, backward: 0.552, update: 0.229
[proc 4] 500 steps, total: 20.193, sample: 1.122, forward: 0.532, backward: 0.840, update: 0.240
[proc 1] 500 steps, total: 20.193, sample: 1.192, forward: 0.555, backward: 0.540, update: 0.236
[proc 0] 500 steps, total: 20.193, sample: 1.120, forward: 0.605, backward: 0.698, update: 0.281
[proc 2] 500 steps, total: 20.193, sample: 1.073, forward: 0.542, backward: 0.821, update: 0.263
Successfully xmh. training takes 118.66840863227844 seconds
before call kg_cache_controller.StopThreads()
W20240206 23:51:12.776115 57226 grad_async_v2.h:84] call StopThreads. PID = 55972
W20240206 23:51:12.776167 57226 grad_base.h:212] before processOneStepNegThread_.join();
W20240206 23:51:12.776419 57226 grad_base.h:214] after processOneStepNegThread_.join();
W20240206 23:51:12.776433 57226 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
E20240206 23:51:13.093037 57804 parallel_pq_v2.h:79] insert failed, size(hashtable)=5610
W20240206 23:51:13.160277 57804 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
W20240206 23:51:13.656533 57226 grad_async_v2.h:105] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 705.107 us                | 13.839 ms                 |
| ProcessBack:Shuffle       | 9.432 ms                  | 22.219 ms                 |
| ProcessBack:UpdateCache   | 11.250 ms                 | 17.071 ms                 |
| ProcessBack:UpsertPq      | 28.518 ms                 | 181.059 ms                |
| ProcessOneStep            | 109.183 ms                | 1.646 s                   |
| BlockToStepN              | 1.995 ms                  | 77.000 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.028 ms                  | 131.242 ms                |
| Forward                   | 5.496 ms                  | 13.383 ms                 |
| Backward                  | 6.581 ms                  | 9.915 ms                  |
| Optimize                  | 2.673 ms                  | 7.275 ms                  |
| BarrierTimeBeforeRank0    | 3.465 ms                  | 177.975 ms                |
| AfterBackward             | 109.238 ms                | 1.646 s                   |
| BlockToStepN              | 2.096 ms                  | 77.094 ms                 |
| OneStep                   | 152.617 ms                | 1.765 s                   |
+---------------------------+---------------------------+---------------------------+
