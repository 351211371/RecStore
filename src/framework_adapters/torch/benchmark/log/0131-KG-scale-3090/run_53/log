WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 19:59:39.539544 28685 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_47', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [28685 sampler.py:454] Start PreSampling
WARNING [28685 sampler.py:532] Before construct renumbering_dict
WARNING [28685 sampler.py:555] PreSampling done
W20240202 20:18:50.447172 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 20:18:50.447371 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 20:18:50.447407 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 20:18:50.447446 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 20:18:50.447479 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 20:18:50.447511 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 20:18:50.447544 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 20:18:50.447579 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 20:18:50.447608 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 20:18:50.447638 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 20:18:50.447675 28685 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 20:18:50.447702 28685 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 20:18:50.447726 28685 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 20:18:50.447889 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 20:18:50.447922 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 20:18:50.447952 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 20:18:50.447993 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 20:18:50.448022 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 20:18:50.448060 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 20:18:50.448101 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 20:18:50.448138 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 20:18:50.448168 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 20:18:50.448199 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 20:18:50.448232 28685 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 20:18:50.448254 28685 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 20:18:50.448278 28685 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 20:18:50.448338 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 20:18:50.448374 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 20:18:50.448407 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 20:18:50.448434 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 20:18:50.448465 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 20:18:50.448498 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 20:18:50.448531 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 20:18:50.448565 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 20:18:50.448602 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 20:18:50.448637 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 20:18:50.448669 28685 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 20:18:50.448691 28685 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 20:18:50.448717 28685 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 20:18:50.448781 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 20:18:50.448812 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 20:18:50.448838 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 20:18:50.448866 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 20:18:50.448899 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 20:18:50.448941 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 20:18:50.448971 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 20:18:50.449004 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 20:18:50.449034 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 20:18:50.449067 28685 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 20:18:50.449102 28685 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 20:18:50.449124 28685 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 20:18:50.449152 28685 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 20:18:50.871059 28685 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240202 20:27:31.785835 28685 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4302704,  4302723,   118242,  ..., 69574402, 16086433,  2458763]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2180.556 seconds
[Rank1] pid = 56078
[Rank2] pid = 56174
INFO [28685 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [28685 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [56078 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [56174 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [56241 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [56078 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [56174 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [56241 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [56078 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [56174 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [28685 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [56241 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 20:36:14.257701 56305 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240202 20:36:14.258114 56242 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240202 20:36:14.258446 56175 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240202 20:36:14.258682 56079 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240202 20:36:14.712658 56305 recstore.cc:66] init folly done
E20240202 20:36:14.712661 56079 recstore.cc:66] init folly done
E20240202 20:36:14.712668 56242 recstore.cc:66] init folly done
E20240202 20:36:14.712677 56175 recstore.cc:66] init folly done
I20240202 20:36:24.819530 56305 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240202 20:36:28.809284 56175 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240202 20:36:28.826761 56079 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240202 20:36:29.815796 56242 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.070 ms                  | 103.072 ms                |
| bucket keys               | 2.052 ms                  | 157.854 ms                |
| forward: a2a keys         | 5.608 ms                  | 810.611 ms                |
| forward: search cache     | 231.560 us                | 21.145 ms                 |
| forward: a2a values       | 2.917 ms                  | 19.851 ms                 |
| forward: join             | 1.532 ms                  | 3.641 ms                  |
| Forward                   | 47.852 ms                 | 1.478 s                   |
| back: aggr dram keys      | 33.430 ms                 | 406.473 ms                |
| back: set dram grad       | 3.584 ms                  | 15.736 ms                 |
| back: a2a grad            | 5.708 ms                  | 22.628 ms                 |
| back: grad sum & grad cache  | 2.372 ms                  | 79.213 ms                 |
| Backward                  | 140.788 ms                | 619.161 ms                |
| Optimize                  | 21.841 ms                 | 34.082 ms                 |
| BarrierTimeBeforeRank0    | 72.379 us                 | 93.579 us                 |
| BlockToStepN              | 21.477 us                 | 60.025 us                 |
| OneStep                   | 228.763 ms                | 2.154 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.706 ms                  | 103.072 ms                |
| bucket keys               | 2.052 ms                  | 5.321 ms                  |
| forward: a2a keys         | 3.010 ms                  | 84.697 ms                 |
| forward: search cache     | 237.828 us                | 321.218 us                |
| forward: a2a values       | 2.917 ms                  | 12.383 ms                 |
| forward: join             | 1.532 ms                  | 3.227 ms                  |
| Forward                   | 35.139 ms                 | 1.478 s                   |
| back: aggr dram keys      | 33.430 ms                 | 72.644 ms                 |
| back: set dram grad       | 3.563 ms                  | 9.280 ms                  |
| back: a2a grad            | 9.854 ms                  | 14.181 ms                 |
| back: grad sum & grad cache  | 2.372 ms                  | 52.387 ms                 |
| Backward                  | 126.504 ms                | 619.161 ms                |
| Optimize                  | 20.952 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 53.892 us                 | 93.579 us                 |
| BlockToStepN              | 21.477 us                 | 60.025 us                 |
| OneStep                   | 197.430 ms                | 2.154 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.260 ms                  | 89.556 ms                 |
| bucket keys               | 2.148 ms                  | 5.321 ms                  |
| forward: a2a keys         | 2.785 ms                  | 84.697 ms                 |
| forward: search cache     | 237.035 us                | 388.628 us                |
| forward: a2a values       | 2.917 ms                  | 12.383 ms                 |
| forward: join             | 1.532 ms                  | 3.641 ms                  |
| Forward                   | 34.814 ms                 | 123.901 ms                |
| back: aggr dram keys      | 39.053 ms                 | 90.553 ms                 |
| back: set dram grad       | 7.476 ms                  | 15.736 ms                 |
| back: a2a grad            | 9.854 ms                  | 22.628 ms                 |
| back: grad sum & grad cache  | 2.372 ms                  | 56.138 ms                 |
| Backward                  | 141.960 ms                | 206.219 ms                |
| Optimize                  | 21.052 ms                 | 34.082 ms                 |
| BarrierTimeBeforeRank0    | 51.021 us                 | 87.243 us                 |
| BlockToStepN              | 24.826 us                 | 60.025 us                 |
| OneStep                   | 213.434 ms                | 366.413 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.413 ms                  | 103.072 ms                |
| bucket keys               | 2.477 ms                  | 4.302 ms                  |
| forward: a2a keys         | 2.729 ms                  | 44.461 ms                 |
| forward: search cache     | 236.250 us                | 321.218 us                |
| forward: a2a values       | 7.481 ms                  | 12.914 ms                 |
| forward: join             | 1.532 ms                  | 3.513 ms                  |
| Forward                   | 34.621 ms                 | 123.901 ms                |
| back: aggr dram keys      | 40.116 ms                 | 90.553 ms                 |
| back: set dram grad       | 7.608 ms                  | 15.736 ms                 |
| back: a2a grad            | 9.854 ms                  | 30.698 ms                 |
| back: grad sum & grad cache  | 2.595 ms                  | 55.601 ms                 |
| Backward                  | 146.816 ms                | 224.223 ms                |
| Optimize                  | 21.591 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 49.888 us                 | 87.243 us                 |
| BlockToStepN              | 40.326 us                 | 60.597 us                 |
| OneStep                   | 216.678 ms                | 366.413 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 29.330, sample: 1.447, forward: 6.150, backward: 10.336, update: 0.385
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 25.340, sample: 1.486, forward: 5.956, backward: 10.497, update: 0.423
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.323, sample: 1.485, forward: 6.018, backward: 10.700, update: 0.340
[Rank3] pid = 56241
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
train_sampler.Prefill()
-------Step 0-------
tensor([   62978,   748166, 41604540,   682020,   496699,   748202,   748222,
          238185,    63027,    63074]) tensor([ 5018399, 24085234, 19375970, 58820247, 62692602, 32717938, 84934922,
        78477013, 61661872, 70244309])
-------Step 1-------
tensor([   62978,   748166, 41604540,   682020,   496699,   748202,   748222,
          238185,    63027,    63074]) tensor([33976895, 62860224, 81838708,  9298021, 49529171,  9437770, 85348865,
        72854916, 19523437, 38078006])
-------Step 2-------
tensor([  820483,    76927, 78934902,    76966,   820506,   820533,   820554,
        47896349,   820586,   820601]) tensor([30511277,  5030802, 50303227, 11378834, 13446857, 13998163, 67332595,
         8618822, 66373327, 27833772])
-------Step 3-------
tensor([  820483,    76927, 78934902,    76966,   820506,   820533,   820554,
        47896349,   820586,   820601]) tensor([15862390, 37946362, 80122213, 43437122, 13085589, 75925393, 58100993,
        70345678, 19283199, 79592555])
-------Step 4-------
tensor([870722,  91634, 870732, 870759,  91665, 870770,  91715, 870782,  91750,
        870788]) tensor([75289921, 33433780, 19548055, 12222919, 47618309, 38122509, 81370508,
        54702539, 64644346, 10172677])
-------Step 5-------
tensor([870722,  91634, 870732, 870759,  91665, 870770,  91715, 870782,  91750,
        870788]) tensor([40227454, 38753627, 84482607,  8481182, 31461783, 25709363, 42204084,
        60065245, 83222673,   624230])
-------Step 6-------
tensor([68563792,   902421,   902440,   902452,  4309561,   902465,   902472,
          902496,   902516,   244140]) tensor([23028601, 50818212, 29149365, 23712463, 80599660, 64614163, 35514355,
        13353752, 56344854,  9093082])
-------Step 7-------
tensor([68563792,   902421,   902440,   902452,  4309561,   902465,   902472,
          902496,   902516,   244140]) tensor([43996328, 75374496, 44185107, 58825098, 76717686,  1739583, 19847128,
        55585762, 17084102, 13408240])
-------Step 8-------
tensor([  933892,   121273,   933901, 38669632,   718929,   933910,   933923,
          933931,   245951,   718954]) tensor([28636366, 46437491, 39942458, 85893945, 68978094, 58576002, 50252195,
        82420670,  9451860,  3240989])
-------Step 9-------
tensor([  933892,   121273,   933901, 38669632,   718929,   933910,   933923,
          933931,   245951,   718954]) tensor([61461240, 73428902, 20772344, 35207514, 10423110,  1068564, 17465680,
        12367992, 81452835, 51179342])
before start barrier
start train
[proc 0] 100 steps, total: 24.334, sample: 1.463, forward: 5.297, backward: 15.152, update: 2.328
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.934 ms                  | 103.072 ms                |
| bucket keys               | 2.477 ms                  | 4.302 ms                  |
| forward: a2a keys         | 2.790 ms                  | 44.461 ms                 |
| forward: search cache     | 237.522 us                | 323.084 us                |
| forward: a2a values       | 7.481 ms                  | 12.914 ms                 |
| forward: join             | 1.532 ms                  | 3.513 ms                  |
| Forward                   | 35.139 ms                 | 123.901 ms                |
| back: aggr dram keys      | 46.136 ms                 | 90.553 ms                 |
| back: set dram grad       | 7.652 ms                  | 15.736 ms                 |
| back: a2a grad            | 9.859 ms                  | 30.698 ms                 |
| back: grad sum & grad cache  | 2.595 ms                  | 55.601 ms                 |
| Backward                  | 146.483 ms                | 224.223 ms                |
| Optimize                  | 23.038 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 48.785 us                 | 93.579 us                 |
| BlockToStepN              | 40.335 us                 | 148.638 us                |
| OneStep                   | 215.545 ms                | 366.413 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.491 ms                  | 103.072 ms                |
| bucket keys               | 2.148 ms                  | 4.232 ms                  |
| forward: a2a keys         | 2.732 ms                  | 32.610 ms                 |
| forward: search cache     | 237.522 us                | 323.592 us                |
| forward: a2a values       | 7.462 ms                  | 12.383 ms                 |
| forward: join             | 1.532 ms                  | 3.437 ms                  |
| Forward                   | 34.364 ms                 | 123.901 ms                |
| back: aggr dram keys      | 43.708 ms                 | 72.644 ms                 |
| back: set dram grad       | 7.624 ms                  | 12.366 ms                 |
| back: a2a grad            | 9.859 ms                  | 22.628 ms                 |
| back: grad sum & grad cache  | 2.595 ms                  | 55.316 ms                 |
| Backward                  | 143.239 ms                | 224.223 ms                |
| Optimize                  | 21.389 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 46.162 us                 | 93.579 us                 |
| BlockToStepN              | 28.963 us                 | 404.352 us                |
| OneStep                   | 211.647 ms                | 366.413 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.526 ms                  | 90.563 ms                 |
| bucket keys               | 2.150 ms                  | 4.287 ms                  |
| forward: a2a keys         | 2.654 ms                  | 37.757 ms                 |
| forward: search cache     | 237.783 us                | 339.637 us                |
| forward: a2a values       | 7.481 ms                  | 12.914 ms                 |
| forward: join             | 2.131 ms                  | 3.437 ms                  |
| Forward                   | 34.050 ms                 | 75.657 ms                 |
| back: aggr dram keys      | 43.708 ms                 | 73.154 ms                 |
| back: set dram grad       | 7.608 ms                  | 12.366 ms                 |
| back: a2a grad            | 9.859 ms                  | 25.483 ms                 |
| back: grad sum & grad cache  | 2.595 ms                  | 56.138 ms                 |
| Backward                  | 142.475 ms                | 224.223 ms                |
| Optimize                  | 21.278 ms                 | 38.451 ms                 |
| BarrierTimeBeforeRank0    | 46.046 us                 | 93.579 us                 |
| BlockToStepN              | 24.826 us                 | 4.015 ms                  |
| OneStep                   | 209.978 ms                | 366.413 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.464 ms                  | 90.563 ms                 |
| bucket keys               | 2.162 ms                  | 4.232 ms                  |
| forward: a2a keys         | 2.789 ms                  | 35.805 ms                 |
| forward: search cache     | 236.250 us                | 339.637 us                |
| forward: a2a values       | 7.481 ms                  | 12.914 ms                 |
| forward: join             | 2.131 ms                  | 3.437 ms                  |
| Forward                   | 34.214 ms                 | 75.657 ms                 |
| back: aggr dram keys      | 43.278 ms                 | 73.154 ms                 |
| back: set dram grad       | 7.563 ms                  | 13.066 ms                 |
| back: a2a grad            | 9.859 ms                  | 30.698 ms                 |
| back: grad sum & grad cache  | 2.670 ms                  | 62.254 ms                 |
| Backward                  | 142.114 ms                | 206.219 ms                |
| Optimize                  | 20.961 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 45.388 us                 | 87.243 us                 |
| BlockToStepN              | 23.590 us                 | 4.015 ms                  |
| OneStep                   | 208.862 ms                | 336.050 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.512 ms                  | 90.563 ms                 |
| bucket keys               | 2.162 ms                  | 4.287 ms                  |
| forward: a2a keys         | 2.805 ms                  | 35.805 ms                 |
| forward: search cache     | 236.143 us                | 339.637 us                |
| forward: a2a values       | 7.481 ms                  | 12.914 ms                 |
| forward: join             | 2.131 ms                  | 3.513 ms                  |
| Forward                   | 34.511 ms                 | 75.657 ms                 |
| back: aggr dram keys      | 40.582 ms                 | 73.662 ms                 |
| back: set dram grad       | 7.610 ms                  | 12.366 ms                 |
| back: a2a grad            | 9.777 ms                  | 27.426 ms                 |
| back: grad sum & grad cache  | 2.670 ms                  | 56.138 ms                 |
| Backward                  | 142.263 ms                | 206.219 ms                |
| Optimize                  | 21.164 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 45.234 us                 | 93.579 us                 |
| BlockToStepN              | 23.503 us                 | 4.015 ms                  |
| OneStep                   | 208.916 ms                | 336.050 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 20.675, sample: 1.195, forward: 4.690, backward: 9.417, update: 0.439
[proc 1] 200 steps, total: 20.675, sample: 1.352, forward: 4.473, backward: 9.782, update: 0.394
[proc 0] 200 steps, total: 20.675, sample: 1.443, forward: 3.832, backward: 13.309, update: 1.981
[proc 3] 200 steps, total: 20.675, sample: 1.548, forward: 4.332, backward: 9.413, update: 0.399
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.897 ms                  | 91.956 ms                 |
| bucket keys               | 2.164 ms                  | 4.287 ms                  |
| forward: a2a keys         | 2.791 ms                  | 35.805 ms                 |
| forward: search cache     | 236.752 us                | 388.628 us                |
| forward: a2a values       | 7.481 ms                  | 19.552 ms                 |
| forward: join             | 2.142 ms                  | 3.514 ms                  |
| Forward                   | 34.636 ms                 | 75.657 ms                 |
| back: aggr dram keys      | 40.582 ms                 | 73.662 ms                 |
| back: set dram grad       | 7.630 ms                  | 12.366 ms                 |
| back: a2a grad            | 9.643 ms                  | 27.426 ms                 |
| back: grad sum & grad cache  | 2.670 ms                  | 56.138 ms                 |
| Backward                  | 142.236 ms                | 206.219 ms                |
| Optimize                  | 21.332 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 45.234 us                 | 93.579 us                 |
| BlockToStepN              | 23.332 us                 | 4.015 ms                  |
| OneStep                   | 208.862 ms                | 336.050 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.438 ms                  | 91.956 ms                 |
| bucket keys               | 2.164 ms                  | 4.274 ms                  |
| forward: a2a keys         | 2.675 ms                  | 34.213 ms                 |
| forward: search cache     | 236.777 us                | 339.637 us                |
| forward: a2a values       | 7.481 ms                  | 12.914 ms                 |
| forward: join             | 2.142 ms                  | 3.513 ms                  |
| Forward                   | 34.214 ms                 | 75.657 ms                 |
| back: aggr dram keys      | 42.537 ms                 | 73.154 ms                 |
| back: set dram grad       | 7.635 ms                  | 12.114 ms                 |
| back: a2a grad            | 9.704 ms                  | 27.426 ms                 |
| back: grad sum & grad cache  | 2.670 ms                  | 57.173 ms                 |
| Backward                  | 142.236 ms                | 211.254 ms                |
| Optimize                  | 21.344 ms                 | 38.701 ms                 |
| BarrierTimeBeforeRank0    | 45.421 us                 | 93.579 us                 |
| BlockToStepN              | 23.223 us                 | 6.071 ms                  |
| OneStep                   | 208.544 ms                | 336.050 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.438 ms                  | 90.563 ms                 |
| bucket keys               | 2.396 ms                  | 4.287 ms                  |
| forward: a2a keys         | 2.526 ms                  | 34.213 ms                 |
| forward: search cache     | 237.035 us                | 339.637 us                |
| forward: a2a values       | 7.491 ms                  | 19.552 ms                 |
| forward: join             | 2.142 ms                  | 3.513 ms                  |
| Forward                   | 34.050 ms                 | 73.782 ms                 |
| back: aggr dram keys      | 42.537 ms                 | 73.154 ms                 |
| back: set dram grad       | 7.610 ms                  | 12.114 ms                 |
| back: a2a grad            | 9.754 ms                  | 27.426 ms                 |
| back: grad sum & grad cache  | 2.713 ms                  | 57.173 ms                 |
| Backward                  | 141.709 ms                | 206.219 ms                |
| Optimize                  | 21.337 ms                 | 38.451 ms                 |
| BarrierTimeBeforeRank0    | 45.599 us                 | 87.243 us                 |
| BlockToStepN              | 23.155 us                 | 6.071 ms                  |
| OneStep                   | 207.775 ms                | 327.640 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.502 ms                  | 91.956 ms                 |
| bucket keys               | 2.134 ms                  | 4.274 ms                  |
| forward: a2a keys         | 2.475 ms                  | 34.213 ms                 |
| forward: search cache     | 237.274 us                | 339.637 us                |
| forward: a2a values       | 7.491 ms                  | 19.552 ms                 |
| forward: join             | 2.124 ms                  | 3.437 ms                  |
| Forward                   | 33.888 ms                 | 75.810 ms                 |
| back: aggr dram keys      | 42.537 ms                 | 73.154 ms                 |
| back: set dram grad       | 7.605 ms                  | 12.366 ms                 |
| back: a2a grad            | 9.754 ms                  | 26.151 ms                 |
| back: grad sum & grad cache  | 2.713 ms                  | 56.138 ms                 |
| Backward                  | 140.788 ms                | 206.219 ms                |
| Optimize                  | 21.171 ms                 | 38.451 ms                 |
| BarrierTimeBeforeRank0    | 45.542 us                 | 87.243 us                 |
| BlockToStepN              | 23.250 us                 | 7.934 ms                  |
| OneStep                   | 206.776 ms                | 327.640 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 20.587, sample: 1.162, forward: 4.187, backward: 9.755, update: 0.402
[proc 3] 300 steps, total: 20.587, sample: 1.308, forward: 4.097, backward: 9.411, update: 0.419
[proc 2] 300 steps, total: 20.587, sample: 1.091, forward: 4.273, backward: 9.450, update: 0.410
[proc 0] 300 steps, total: 20.587, sample: 1.208, forward: 3.640, backward: 13.505, update: 2.113
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.464 ms                  | 91.956 ms                 |
| bucket keys               | 2.140 ms                  | 4.274 ms                  |
| forward: a2a keys         | 2.475 ms                  | 34.213 ms                 |
| forward: search cache     | 237.263 us                | 339.637 us                |
| forward: a2a values       | 7.491 ms                  | 19.552 ms                 |
| forward: join             | 2.124 ms                  | 3.437 ms                  |
| Forward                   | 33.937 ms                 | 75.810 ms                 |
| back: aggr dram keys      | 42.106 ms                 | 73.154 ms                 |
| back: set dram grad       | 7.592 ms                  | 12.388 ms                 |
| back: a2a grad            | 9.754 ms                  | 26.151 ms                 |
| back: grad sum & grad cache  | 2.713 ms                  | 56.138 ms                 |
| Backward                  | 139.784 ms                | 206.219 ms                |
| Optimize                  | 21.128 ms                 | 38.451 ms                 |
| BarrierTimeBeforeRank0    | 45.599 us                 | 87.243 us                 |
| BlockToStepN              | 23.284 us                 | 7.934 ms                  |
| OneStep                   | 205.063 ms                | 327.640 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.434 ms                  | 94.463 ms                 |
| bucket keys               | 2.140 ms                  | 4.274 ms                  |
| forward: a2a keys         | 2.427 ms                  | 32.610 ms                 |
| forward: search cache     | 237.373 us                | 328.958 us                |
| forward: a2a values       | 7.491 ms                  | 19.552 ms                 |
| forward: join             | 2.124 ms                  | 3.422 ms                  |
| Forward                   | 33.832 ms                 | 75.810 ms                 |
| back: aggr dram keys      | 42.046 ms                 | 72.644 ms                 |
| back: set dram grad       | 7.560 ms                  | 12.366 ms                 |
| back: a2a grad            | 9.754 ms                  | 26.151 ms                 |
| back: grad sum & grad cache  | 2.713 ms                  | 55.601 ms                 |
| Backward                  | 138.560 ms                | 206.219 ms                |
| Optimize                  | 21.013 ms                 | 38.451 ms                 |
| BarrierTimeBeforeRank0    | 45.534 us                 | 87.243 us                 |
| BlockToStepN              | 22.989 us                 | 7.934 ms                  |
| OneStep                   | 204.351 ms                | 327.640 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.312 ms                  | 91.956 ms                 |
| bucket keys               | 2.147 ms                  | 4.302 ms                  |
| forward: a2a keys         | 2.372 ms                  | 32.610 ms                 |
| forward: search cache     | 237.403 us                | 328.958 us                |
| forward: a2a values       | 7.243 ms                  | 19.552 ms                 |
| forward: join             | 2.124 ms                  | 3.437 ms                  |
| Forward                   | 33.653 ms                 | 75.657 ms                 |
| back: aggr dram keys      | 41.175 ms                 | 72.644 ms                 |
| back: set dram grad       | 7.541 ms                  | 12.366 ms                 |
| back: a2a grad            | 9.754 ms                  | 26.151 ms                 |
| back: grad sum & grad cache  | 3.576 ms                  | 55.601 ms                 |
| Backward                  | 136.226 ms                | 187.753 ms                |
| Optimize                  | 20.961 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 45.734 us                 | 83.507 us                 |
| BlockToStepN              | 22.606 us                 | 6.071 ms                  |
| OneStep                   | 202.599 ms                | 327.217 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.405 ms                  | 91.956 ms                 |
| bucket keys               | 2.148 ms                  | 4.411 ms                  |
| forward: a2a keys         | 2.310 ms                  | 32.539 ms                 |
| forward: search cache     | 237.467 us                | 328.077 us                |
| forward: a2a values       | 7.243 ms                  | 12.914 ms                 |
| forward: join             | 2.124 ms                  | 3.422 ms                  |
| Forward                   | 33.253 ms                 | 75.657 ms                 |
| back: aggr dram keys      | 40.646 ms                 | 68.988 ms                 |
| back: set dram grad       | 7.479 ms                  | 12.114 ms                 |
| back: a2a grad            | 9.777 ms                  | 25.483 ms                 |
| back: grad sum & grad cache  | 3.576 ms                  | 55.601 ms                 |
| Backward                  | 131.185 ms                | 187.753 ms                |
| Optimize                  | 20.885 ms                 | 38.451 ms                 |
| BarrierTimeBeforeRank0    | 45.708 us                 | 83.507 us                 |
| BlockToStepN              | 22.361 us                 | 6.071 ms                  |
| OneStep                   | 201.496 ms                | 327.217 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 19.307, sample: 0.946, forward: 4.050, backward: 9.192, update: 0.382
[proc 3] 400 steps, total: 19.307, sample: 1.159, forward: 3.871, backward: 8.828, update: 0.426
[proc 2] 400 steps, total: 19.307, sample: 1.049, forward: 3.955, backward: 8.834, update: 0.407
[proc 0] 400 steps, total: 19.307, sample: 1.156, forward: 3.388, backward: 12.690, update: 1.988
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.405 ms                  | 91.956 ms                 |
| bucket keys               | 2.150 ms                  | 4.411 ms                  |
| forward: a2a keys         | 2.262 ms                  | 32.610 ms                 |
| forward: search cache     | 237.533 us                | 328.077 us                |
| forward: a2a values       | 7.243 ms                  | 13.006 ms                 |
| forward: join             | 2.124 ms                  | 3.422 ms                  |
| Forward                   | 33.073 ms                 | 75.810 ms                 |
| back: aggr dram keys      | 40.630 ms                 | 68.988 ms                 |
| back: set dram grad       | 7.350 ms                  | 12.114 ms                 |
| back: a2a grad            | 9.745 ms                  | 25.483 ms                 |
| back: grad sum & grad cache  | 3.576 ms                  | 55.601 ms                 |
| Backward                  | 129.632 ms                | 187.753 ms                |
| Optimize                  | 20.780 ms                 | 38.451 ms                 |
| BarrierTimeBeforeRank0    | 45.734 us                 | 83.507 us                 |
| BlockToStepN              | 22.111 us                 | 6.071 ms                  |
| OneStep                   | 199.611 ms                | 327.217 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.397 ms                  | 91.956 ms                 |
| bucket keys               | 2.159 ms                  | 4.390 ms                  |
| forward: a2a keys         | 2.262 ms                  | 32.539 ms                 |
| forward: search cache     | 237.641 us                | 323.592 us                |
| forward: a2a values       | 7.271 ms                  | 12.914 ms                 |
| forward: join             | 2.124 ms                  | 3.422 ms                  |
| Forward                   | 33.199 ms                 | 75.810 ms                 |
| back: aggr dram keys      | 40.630 ms                 | 68.609 ms                 |
| back: set dram grad       | 6.757 ms                  | 12.114 ms                 |
| back: a2a grad            | 9.745 ms                  | 25.483 ms                 |
| back: grad sum & grad cache  | 3.576 ms                  | 55.316 ms                 |
| Backward                  | 128.979 ms                | 206.219 ms                |
| Optimize                  | 20.767 ms                 | 38.451 ms                 |
| BarrierTimeBeforeRank0    | 45.923 us                 | 83.507 us                 |
| BlockToStepN              | 22.285 us                 | 7.934 ms                  |
| OneStep                   | 198.201 ms                | 327.640 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.299 ms                  | 91.956 ms                 |
| bucket keys               | 2.159 ms                  | 4.390 ms                  |
| forward: a2a keys         | 2.250 ms                  | 32.539 ms                 |
| forward: search cache     | 237.757 us                | 323.592 us                |
| forward: a2a values       | 7.243 ms                  | 12.914 ms                 |
| forward: join             | 2.124 ms                  | 3.422 ms                  |
| Forward                   | 33.199 ms                 | 75.657 ms                 |
| back: aggr dram keys      | 40.630 ms                 | 68.609 ms                 |
| back: set dram grad       | 4.727 ms                  | 12.114 ms                 |
| back: a2a grad            | 9.754 ms                  | 25.483 ms                 |
| back: grad sum & grad cache  | 3.576 ms                  | 55.316 ms                 |
| Backward                  | 127.846 ms                | 187.753 ms                |
| Optimize                  | 20.732 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 45.923 us                 | 80.720 us                 |
| BlockToStepN              | 21.973 us                 | 6.071 ms                  |
| OneStep                   | 196.730 ms                | 327.217 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 19.500, sample: 1.108, forward: 3.958, backward: 8.957, update: 0.361
[proc 2] 500 steps, total: 19.500, sample: 1.021, forward: 3.970, backward: 9.033, update: 0.420
[proc 1] 500 steps, total: 19.500, sample: 1.010, forward: 3.977, backward: 9.304, update: 0.389
[proc 0] 500 steps, total: 19.500, sample: 1.143, forward: 3.459, backward: 12.802, update: 2.000
Successfully xmh. training takes 104.40279221534729 seconds
before call kg_cache_controller.StopThreads()
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
INFO [28685 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.312 ms                  | 91.956 ms                 |
| bucket keys               | 2.162 ms                  | 4.345 ms                  |
| forward: a2a keys         | 2.191 ms                  | 31.869 ms                 |
| forward: search cache     | 237.673 us                | 323.478 us                |
| forward: a2a values       | 7.271 ms                  | 12.857 ms                 |
| forward: join             | 2.124 ms                  | 3.422 ms                  |
| Forward                   | 32.966 ms                 | 75.657 ms                 |
| back: aggr dram keys      | 40.646 ms                 | 67.934 ms                 |
| back: set dram grad       | 4.295 ms                  | 11.756 ms                 |
| back: a2a grad            | 9.754 ms                  | 24.305 ms                 |
| back: grad sum & grad cache  | 3.576 ms                  | 55.316 ms                 |
| Backward                  | 127.648 ms                | 187.753 ms                |
| Optimize                  | 20.720 ms                 | 35.359 ms                 |
| BarrierTimeBeforeRank0    | 45.926 us                 | 80.720 us                 |
| BlockToStepN              | 22.111 us                 | 6.071 ms                  |
| OneStep                   | 195.719 ms                | 327.217 ms                |
+---------------------------+---------------------------+---------------------------+
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
