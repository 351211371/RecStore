WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 21:55:52.970906 34764 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_50', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [34764 sampler.py:454] Start PreSampling
WARNING [34764 sampler.py:532] Before construct renumbering_dict
WARNING [34764 sampler.py:555] PreSampling done
W20240205 21:55:57.629942 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 21:55:57.630125 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 21:55:57.630175 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 21:55:57.630206 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 21:55:57.630246 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 21:55:57.630290 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 21:55:57.630321 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 21:55:57.630365 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 21:55:57.630404 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 21:55:57.630440 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 21:55:57.630479 34764 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 21:55:57.630510 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 21:55:57.630538 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 21:55:57.630692 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 21:55:57.630736 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 21:55:57.630772 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 21:55:57.630815 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 21:55:57.630851 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 21:55:57.630882 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 21:55:57.630920 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 21:55:57.630956 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 21:55:57.630995 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 21:55:57.631026 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 21:55:57.631064 34764 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 21:55:57.631091 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 21:55:57.631120 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 21:55:57.631188 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 21:55:57.631222 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 21:55:57.631253 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 21:55:57.631284 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 21:55:57.631320 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 21:55:57.631351 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 21:55:57.631386 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 21:55:57.631426 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 21:55:57.631457 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 21:55:57.631493 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 21:55:57.631523 34764 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 21:55:57.631549 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 21:55:57.631575 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 21:55:57.631639 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 21:55:57.631676 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 21:55:57.631714 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 21:55:57.631745 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 21:55:57.631783 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 21:55:57.631829 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 21:55:57.631886 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 21:55:57.631920 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 21:55:57.631963 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 21:55:57.632002 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 21:55:57.632037 34764 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 21:55:57.632071 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 21:55:57.632103 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 21:55:57.632169 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 21:55:57.632205 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 21:55:57.632241 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 21:55:57.632272 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 21:55:57.632306 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 21:55:57.632344 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 21:55:57.632377 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 21:55:57.632408 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 21:55:57.632440 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 21:55:57.632477 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 21:55:57.632512 34764 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 21:55:57.632539 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 21:55:57.632570 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 21:55:57.632625 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 21:55:57.632668 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 21:55:57.632699 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 21:55:57.632736 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 21:55:57.632774 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 21:55:57.632809 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 21:55:57.632848 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 21:55:57.632882 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 21:55:57.632922 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 21:55:57.632961 34764 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 21:55:57.632994 34764 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 21:55:57.633021 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 21:55:57.633049 34764 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 21:55:57.869020 34764 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10001ca5a000 22.81 MB
W20240205 21:55:57.956945 34764 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10001e12c000 58.4 kB
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  826,   946,  1035,  ...,  3043,  2329, 10549]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.083 seconds
[Rank1] pid = 34968
[Rank2] pid = 35029
[Rank3] pid = 35033
[Rank4] pid = 35160
INFO [34764 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [34968 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [35033 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [35160 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [35029 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [35160 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [35029 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [34968 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [35161 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [35033 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [35161 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [34764 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240205 21:56:00.274410 35162 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240205 21:56:00.274626 35163 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240205 21:56:00.274698 35034 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240205 21:56:00.274701 34969 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240205 21:56:00.274708 35055 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240205 21:56:00.274933 35288 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240205 21:56:00.302181 35055 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10001e8e3000 7.629 MB
W20240205 21:56:00.302176 35163 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10001e140000 7.629 MB
W20240205 21:56:00.302371 35055 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10001f086000 7.629 MB
W20240205 21:56:00.302387 35163 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10001f829000 7.629 MB
W20240205 21:56:00.302448 35055 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10001ffcc000 1.49 GB
W20240205 21:56:00.302464 35163 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10007f5af000 1.49 GB
W20240205 21:56:00.302510 35055 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1000deb92000 1.49 GB
W20240205 21:56:00.302518 35163 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10013e175000 1.49 GB
W20240205 21:56:00.302567 35055 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 21:56:00.302589 35163 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 21:56:00.306758 35288 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10019d75c000 7.629 MB
W20240205 21:56:00.306833 35055 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 21:56:00.306915 35163 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 21:56:00.306939 35288 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10019df07000 7.629 MB
W20240205 21:56:00.306996 35162 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10019e6aa000 7.629 MB
W20240205 21:56:00.307014 35288 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10019ee4d000 1.49 GB
W20240205 21:56:00.307078 35288 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1001fe430000 1.49 GB
W20240205 21:56:00.307125 35162 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10025da13000 7.629 MB
W20240205 21:56:00.307138 35034 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10025e1b6000 7.629 MB
W20240205 21:56:00.307154 35288 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 21:56:00.307195 35162 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10025f0fc000 1.49 GB
W20240205 21:56:00.307183 34969 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10025e959000 7.629 MB
W20240205 21:56:00.307255 35162 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1002be6df000 1.49 GB
W20240205 21:56:00.307308 35162 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 21:56:00.307327 35034 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10031dcc2000 7.629 MB
W20240205 21:56:00.307353 34969 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10031e465000 7.629 MB
W20240205 21:56:00.307416 35034 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10031ec08000 1.49 GB
W20240205 21:56:00.307444 34969 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10037e1eb000 1.49 GB
W20240205 21:56:00.307494 35034 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1003dd7ce000 1.49 GB
W20240205 21:56:00.307518 34969 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10043cdb1000 1.49 GB
W20240205 21:56:00.307564 35034 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 21:56:00.307569 34969 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 21:56:00.316802 35162 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 21:56:00.316813 35034 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 21:56:00.316846 34969 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 21:56:00.316892 35288 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x10001ca5a000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x10001ca5a000
5: KnownLocalCachedEmbedding init done
WARNING [35161 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [35160 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
3: KnownLocalCachedEmbedding init done
WARNING [35033 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
1: KnownLocalCachedEmbedding init done
WARNING [34968 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
2: KnownLocalCachedEmbedding init done
WARNING [35029 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank5] pid = 35161
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
cudaHostRegister 0x10001ca5a000
0: KnownLocalCachedEmbedding init done
WARNING [34764 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 21:56:02.119361 35162 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240205 21:56:02.119697 34969 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240205 21:56:02.119791 35288 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240205 21:56:02.119895 35055 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240205 21:56:02.119969 35163 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240205 21:56:02.120044 35034 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240205 21:56:02.122821 35162 grad_base.h:55] KGCacheController, config={
        "num_gpus": 6,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 21:56:02.122933 35162 grad_base.h:184] Init GradProcessingBase done
I20240205 21:56:02.125272 35162 grad_async_v1.h:203] Use main thread to update emb.
W20240205 21:56:02.125316 35162 kg_controller.h:75] after init GradAsyncProcessing
I20240205 21:56:02.125324 35162 kg_controller.h:84] Construct KGCacheController done
E20240205 21:56:02.771770 35288 recstore.cc:66] init folly done
E20240205 21:56:02.771812 34969 recstore.cc:66] init folly done
E20240205 21:56:02.771822 35034 recstore.cc:66] init folly done
E20240205 21:56:02.771899 35162 recstore.cc:66] init folly done
E20240205 21:56:02.771944 35163 recstore.cc:66] init folly done
E20240205 21:56:02.772044 35055 recstore.cc:66] init folly done
I20240205 21:56:02.773201 35162 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 21:56:03.395781 35162 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240205 21:56:03.399251 35055 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240205 21:56:03.402223 35288 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240205 21:56:03.405058 35034 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240205 21:56:03.406018 34969 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240205 21:56:03.429160 35163 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
W20240205 21:56:05.160144 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240205 21:56:05.261880 35431 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
W20240205 21:56:06.176100 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.210 ms                  | 24.338 ms                 |
| Forward                   | 5.530 ms                  | 429.159 ms                |
| Backward                  | 9.835 ms                  | 212.158 ms                |
| Optimize                  | 2.519 ms                  | 46.482 ms                 |
| BarrierTimeBeforeRank0    | 95.603 us                 | 6.157 ms                  |
| AfterBackward             | 26.991 ms                 | 1.041 s                   |
| BlockToStepN              | 5.532 ms                  | 524.387 ms                |
| OneStep                   | 64.576 ms                 | 1.797 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:07.176015 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.268 ms                  | 298.292 ms                |
| ProcessBack:UpdateCache   | 6.270 ms                  | 542.543 ms                |
| ProcessBack:UpsertPq      | 13.816 ms                 | 47.991 ms                 |
| ProcessOneStep            | 26.697 ms                 | 1.040 s                   |
| BlockToStepN              | 7.167 ms                  | 524.190 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:08.204893 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240205 21:56:09.204018 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=22, pq.top=22
W20240205 21:56:10.204007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240205 21:56:11.204034 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.753 ms                  | 27.112 ms                 |
| Forward                   | 5.635 ms                  | 429.159 ms                |
| Backward                  | 4.655 ms                  | 212.158 ms                |
| Optimize                  | 2.351 ms                  | 46.482 ms                 |
| BarrierTimeBeforeRank0    | 1.467 ms                  | 10.125 ms                 |
| AfterBackward             | 26.254 ms                 | 1.041 s                   |
| BlockToStepN              | 214.128 ms                | 592.358 ms                |
| OneStep                   | 265.757 ms                | 1.797 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:12.204006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=32, pq.top=32
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.103 ms                  | 268.518 ms                |
| ProcessBack:UpdateCache   | 5.521 ms                  | 541.621 ms                |
| ProcessBack:UpsertPq      | 14.902 ms                 | 42.328 ms                 |
| ProcessOneStep            | 26.218 ms                 | 1.040 s                   |
| BlockToStepN              | 220.537 ms                | 592.222 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:13.204020 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=36, pq.top=36
W20240205 21:56:14.204006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240205 21:56:15.204016 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=42, pq.top=42
W20240205 21:56:16.204012 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=46, pq.top=46
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.838 ms                  | 28.198 ms                 |
| Forward                   | 5.700 ms                  | 429.159 ms                |
| Backward                  | 4.532 ms                  | 212.158 ms                |
| Optimize                  | 2.312 ms                  | 46.482 ms                 |
| BarrierTimeBeforeRank0    | 3.829 ms                  | 11.479 ms                 |
| AfterBackward             | 26.112 ms                 | 1.041 s                   |
| BlockToStepN              | 224.802 ms                | 592.358 ms                |
| OneStep                   | 275.918 ms                | 1.797 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:17.204005 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.997 ms                  | 268.518 ms                |
| ProcessBack:UpdateCache   | 5.350 ms                  | 541.621 ms                |
| ProcessBack:UpsertPq      | 14.610 ms                 | 42.328 ms                 |
| ProcessOneStep            | 26.045 ms                 | 76.888 ms                 |
| BlockToStepN              | 226.789 ms                | 592.222 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:18.204005 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240205 21:56:19.204018 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240205 21:56:20.204006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240205 21:56:21.211848 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=62, pq.top=62
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.838 ms                  | 27.410 ms                 |
| Forward                   | 5.739 ms                  | 10.704 ms                 |
| Backward                  | 4.472 ms                  | 10.853 ms                 |
| Optimize                  | 2.250 ms                  | 8.440 ms                  |
| BarrierTimeBeforeRank0    | 4.251 ms                  | 10.125 ms                 |
| AfterBackward             | 26.073 ms                 | 76.931 ms                 |
| BlockToStepN              | 240.086 ms                | 524.387 ms                |
| OneStep                   | 291.997 ms                | 642.426 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:22.211006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.943 ms                  | 268.518 ms                |
| ProcessBack:UpdateCache   | 5.394 ms                  | 541.621 ms                |
| ProcessBack:UpsertPq      | 14.918 ms                 | 42.328 ms                 |
| ProcessOneStep            | 26.045 ms                 | 76.888 ms                 |
| BlockToStepN              | 241.112 ms                | 524.190 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:23.241389 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=68, pq.top=68
W20240205 21:56:24.241021 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240205 21:56:25.241006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=74, pq.top=74
W20240205 21:56:26.274713 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.927 ms                  | 27.439 ms                 |
| Forward                   | 5.736 ms                  | 10.704 ms                 |
| Backward                  | 4.470 ms                  | 10.853 ms                 |
| Optimize                  | 2.285 ms                  | 8.440 ms                  |
| BarrierTimeBeforeRank0    | 4.398 ms                  | 10.125 ms                 |
| AfterBackward             | 26.016 ms                 | 76.931 ms                 |
| BlockToStepN              | 249.213 ms                | 524.387 ms                |
| OneStep                   | 303.745 ms                | 642.426 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:27.295085 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=80, pq.top=80
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.882 ms                  | 10.271 ms                 |
| ProcessBack:UpdateCache   | 5.417 ms                  | 9.668 ms                  |
| ProcessBack:UpsertPq      | 14.868 ms                 | 30.995 ms                 |
| ProcessOneStep            | 25.881 ms                 | 76.888 ms                 |
| BlockToStepN              | 250.147 ms                | 524.190 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:28.295007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240205 21:56:29.295014 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=86, pq.top=86
W20240205 21:56:30.295012 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240205 21:56:31.295014 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=92, pq.top=92
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.949 ms                  | 27.439 ms                 |
| Forward                   | 5.623 ms                  | 10.704 ms                 |
| Backward                  | 4.464 ms                  | 10.853 ms                 |
| Optimize                  | 2.253 ms                  | 8.440 ms                  |
| BarrierTimeBeforeRank0    | 4.510 ms                  | 32.111 ms                 |
| AfterBackward             | 25.806 ms                 | 76.931 ms                 |
| BlockToStepN              | 254.603 ms                | 524.387 ms                |
| OneStep                   | 309.504 ms                | 642.426 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:32.295006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.839 ms                  | 10.271 ms                 |
| ProcessBack:UpdateCache   | 5.432 ms                  | 9.668 ms                  |
| ProcessBack:UpsertPq      | 14.807 ms                 | 30.995 ms                 |
| ProcessOneStep            | 25.706 ms                 | 76.888 ms                 |
| BlockToStepN              | 254.517 ms                | 524.190 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:33.295008 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=98, pq.top=98
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 30.870, sample: 0.383, forward: 0.919, backward: 0.593, update: 0.253
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 30.876, sample: 0.308, forward: 0.885, backward: 1.240, update: 0.271
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 30.871, sample: 0.407, forward: 0.918, backward: 1.159, update: 0.295
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 30.847, sample: 0.392, forward: 0.896, backward: 1.095, update: 0.290
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 30.874, sample: 0.390, forward: 0.888, backward: 1.211, update: 0.300
train_sampler.Prefill()
-------Step 0-------
tensor([   95,  7566,  9545,   927, 11385,  7363,   118,  8019,  4652,  1685]) tensor([ 1035,   109,  5752,  6775,    70,  4974, 11994, 14759,  1665, 11388])
-------Step 1-------
tensor([   95,  7566,  9545,   927, 11385,  7363,   118,  8019,  4652,  1685]) tensor([ 7213,  3988,   386,  8612,  4949, 14212,  2926, 11063, 14238,  9879])
-------Step 2-------
tensor([ 1050,  3847, 11385,  6160,  9353, 12683,    35, 11929,  9310,  5221]) tensor([ 6507, 11370,  3644, 12812,  4996,  8004,  6517,  6331,  1302, 12615])
-------Step 3-------
tensor([ 1050,  3847, 11385,  6160,  9353, 12683,    35, 11929,  9310,  5221]) tensor([ 7121,  3495,  4241, 11712, 10429,   443,  7137,  4900,   195,  2994])
-------Step 4-------
tensor([   93,  4626,  8876,  7980, 10451,  1631, 11385, 10211,  8575,  9121]) tensor([ 3308,  4010,  2735,  1683, 13619, 14374,  8764,  5348, 12622,  2945])
-------Step 5-------
tensor([   93,  4626,  8876,  7980, 10451,  1631, 11385, 10211,  8575,  9121]) tensor([ 3200, 10405,   582, 11816,  9919,  3811,  6485,   512, 10331,  1899])
-------Step 6-------
tensor([ 7742, 14051, 12077,  2865,  5118,   154,    21, 12122,    93,     6]) tensor([ 5493,  5600,  2846,  4061,  1431,   406,  4727, 14017,  2013,  4100])
-------Step 7-------
tensor([ 7742, 14051, 12077,  2865,  5118,   154,    21, 12122,    93,     6]) tensor([13408,   257,  4195,  5832, 14674,  9534,  9459,  6888,  7085,  6429])
-------Step 8-------
tensor([3734, 3898, 1258,  722, 4629, 2384, 6590,   99, 4680,   21]) tensor([11538,  3848,  1971,  9948, 12055, 10854,  9562,  3396,  2188, 12591])
-------Step 9-------
tensor([3734, 3898, 1258,  722, 4629, 2384, 6590,   99, 4680,   21]) tensor([10327, 12619, 10707,  8834,  2319,  8751,   420,  7020,  4995,  2784])
before start barrier
start train
[proc 0] 100 steps, total: 30.880, sample: 0.509, forward: 0.990, backward: 0.703, update: 0.287
W20240205 21:56:34.319386 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240205 21:56:35.319011 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240205 21:56:36.356660 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.949 ms                  | 27.439 ms                 |
| Forward                   | 5.623 ms                  | 10.704 ms                 |
| Backward                  | 4.460 ms                  | 10.853 ms                 |
| Optimize                  | 2.260 ms                  | 8.440 ms                  |
| BarrierTimeBeforeRank0    | 5.011 ms                  | 32.111 ms                 |
| AfterBackward             | 25.692 ms                 | 76.931 ms                 |
| BlockToStepN              | 265.505 ms                | 524.387 ms                |
| OneStep                   | 314.432 ms                | 642.426 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:37.356016 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.825 ms                  | 10.271 ms                 |
| ProcessBack:UpdateCache   | 5.417 ms                  | 9.668 ms                  |
| ProcessBack:UpsertPq      | 14.760 ms                 | 30.995 ms                 |
| ProcessOneStep            | 25.658 ms                 | 76.888 ms                 |
| BlockToStepN              | 266.104 ms                | 524.190 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:38.356006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=112, pq.top=112
W20240205 21:56:39.356006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240205 21:56:40.356016 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=118, pq.top=118
W20240205 21:56:41.356011 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.941 ms                  | 31.577 ms                 |
| Forward                   | 5.579 ms                  | 10.704 ms                 |
| Backward                  | 4.442 ms                  | 10.853 ms                 |
| Optimize                  | 2.250 ms                  | 8.440 ms                  |
| BarrierTimeBeforeRank0    | 5.074 ms                  | 33.470 ms                 |
| AfterBackward             | 25.578 ms                 | 76.931 ms                 |
| BlockToStepN              | 269.404 ms                | 524.387 ms                |
| OneStep                   | 320.995 ms                | 642.426 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:42.356006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.790 ms                  | 10.271 ms                 |
| ProcessBack:UpdateCache   | 5.411 ms                  | 9.668 ms                  |
| ProcessBack:UpsertPq      | 14.744 ms                 | 30.995 ms                 |
| ProcessOneStep            | 25.545 ms                 | 76.888 ms                 |
| BlockToStepN              | 269.804 ms                | 524.190 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:43.356007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=126, pq.top=126
W20240205 21:56:44.356019 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240205 21:56:45.356006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=132, pq.top=132
W20240205 21:56:46.368237 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.941 ms                  | 31.577 ms                 |
| Forward                   | 5.579 ms                  | 10.704 ms                 |
| Backward                  | 4.425 ms                  | 10.853 ms                 |
| Optimize                  | 2.242 ms                  | 8.440 ms                  |
| BarrierTimeBeforeRank0    | 5.116 ms                  | 33.470 ms                 |
| AfterBackward             | 25.544 ms                 | 76.931 ms                 |
| BlockToStepN              | 271.278 ms                | 524.387 ms                |
| OneStep                   | 323.431 ms                | 642.426 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:47.368009 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.776 ms                  | 8.416 ms                  |
| ProcessBack:UpdateCache   | 5.399 ms                  | 8.693 ms                  |
| ProcessBack:UpsertPq      | 14.695 ms                 | 24.147 ms                 |
| ProcessOneStep            | 25.432 ms                 | 76.888 ms                 |
| BlockToStepN              | 271.205 ms                | 524.190 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:48.368006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240205 21:56:49.368007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240205 21:56:50.423203 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=146, pq.top=146
W20240205 21:56:51.423012 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=148, pq.top=148
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.941 ms                  | 31.577 ms                 |
| Forward                   | 5.642 ms                  | 10.704 ms                 |
| Backward                  | 4.410 ms                  | 10.853 ms                 |
| Optimize                  | 2.242 ms                  | 8.440 ms                  |
| BarrierTimeBeforeRank0    | 5.120 ms                  | 33.470 ms                 |
| AfterBackward             | 25.544 ms                 | 76.931 ms                 |
| BlockToStepN              | 274.476 ms                | 524.387 ms                |
| OneStep                   | 332.390 ms                | 642.426 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:52.423007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.776 ms                  | 8.416 ms                  |
| ProcessBack:UpdateCache   | 5.387 ms                  | 8.693 ms                  |
| ProcessBack:UpsertPq      | 14.790 ms                 | 24.147 ms                 |
| ProcessOneStep            | 25.518 ms                 | 58.875 ms                 |
| BlockToStepN              | 276.605 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:53.423007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240205 21:56:54.423014 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240205 21:56:55.423012 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240205 21:56:56.423005 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.888 ms                  | 30.587 ms                 |
| Forward                   | 5.641 ms                  | 8.718 ms                  |
| Backward                  | 4.410 ms                  | 10.512 ms                 |
| Optimize                  | 2.242 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.338 ms                  | 33.109 ms                 |
| AfterBackward             | 25.578 ms                 | 58.966 ms                 |
| BlockToStepN              | 278.980 ms                | 439.448 ms                |
| OneStep                   | 337.502 ms                | 571.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:57.423007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.774 ms                  | 8.416 ms                  |
| ProcessBack:UpdateCache   | 5.359 ms                  | 8.693 ms                  |
| ProcessBack:UpsertPq      | 14.864 ms                 | 24.147 ms                 |
| ProcessOneStep            | 25.546 ms                 | 58.875 ms                 |
| BlockToStepN              | 279.352 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:56:58.441184 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=168, pq.top=168
W20240205 21:56:59.466281 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240205 21:57:00.466008 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240205 21:57:01.466006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.867 ms                  | 30.587 ms                 |
| Forward                   | 5.642 ms                  | 8.718 ms                  |
| Backward                  | 4.390 ms                  | 10.512 ms                 |
| Optimize                  | 2.242 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.391 ms                  | 33.109 ms                 |
| AfterBackward             | 25.574 ms                 | 58.966 ms                 |
| BlockToStepN              | 280.935 ms                | 439.448 ms                |
| OneStep                   | 341.295 ms                | 571.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:02.466014 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=178, pq.top=178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.752 ms                  | 8.271 ms                  |
| ProcessBack:UpdateCache   | 5.357 ms                  | 7.900 ms                  |
| ProcessBack:UpsertPq      | 14.823 ms                 | 22.957 ms                 |
| ProcessOneStep            | 25.518 ms                 | 58.875 ms                 |
| BlockToStepN              | 280.874 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:03.466006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240205 21:57:04.466006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240205 21:57:05.466013 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=186, pq.top=186
W20240205 21:57:06.466012 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.840 ms                  | 30.587 ms                 |
| Forward                   | 5.698 ms                  | 8.718 ms                  |
| Backward                  | 4.388 ms                  | 10.512 ms                 |
| Optimize                  | 2.242 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.432 ms                  | 33.109 ms                 |
| AfterBackward             | 25.532 ms                 | 58.966 ms                 |
| BlockToStepN              | 283.005 ms                | 439.448 ms                |
| OneStep                   | 342.454 ms                | 571.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:07.466006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.752 ms                  | 8.271 ms                  |
| ProcessBack:UpdateCache   | 5.337 ms                  | 7.900 ms                  |
| ProcessBack:UpsertPq      | 14.867 ms                 | 22.957 ms                 |
| ProcessOneStep            | 25.496 ms                 | 58.875 ms                 |
| BlockToStepN              | 284.439 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:08.466013 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240205 21:57:09.466010 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240205 21:57:10.466006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 5] 200 steps, total: 36.908, sample: 0.458, forward: 0.473, backward: 1.027, update: 0.247
[proc 3] 200 steps, total: 36.908, sample: 0.414, forward: 0.481, backward: 0.989, update: 0.236
[proc 2] 200 steps, total: 36.908, sample: 0.401, forward: 0.495, backward: 1.040, update: 0.233
[proc 4] 200 steps, total: 36.908, sample: 0.430, forward: 0.466, backward: 1.005, update: 0.246
[proc 1] 200 steps, total: 36.908, sample: 0.408, forward: 0.503, backward: 0.395, update: 0.216
[proc 0] 200 steps, total: 36.908, sample: 0.553, forward: 0.563, backward: 0.429, update: 0.243
W20240205 21:57:11.466006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.840 ms                  | 30.587 ms                 |
| Forward                   | 5.718 ms                  | 8.718 ms                  |
| Backward                  | 4.385 ms                  | 10.512 ms                 |
| Optimize                  | 2.241 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.460 ms                  | 33.470 ms                 |
| AfterBackward             | 25.574 ms                 | 58.966 ms                 |
| BlockToStepN              | 286.851 ms                | 439.448 ms                |
| OneStep                   | 344.286 ms                | 571.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:12.523811 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=204, pq.top=204
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.770 ms                  | 8.271 ms                  |
| ProcessBack:UpdateCache   | 5.318 ms                  | 7.900 ms                  |
| ProcessBack:UpsertPq      | 14.870 ms                 | 22.957 ms                 |
| ProcessOneStep            | 25.518 ms                 | 58.875 ms                 |
| BlockToStepN              | 287.556 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:13.523010 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240205 21:57:14.523007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240205 21:57:15.523011 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240205 21:57:16.523015 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.838 ms                  | 30.587 ms                 |
| Forward                   | 5.736 ms                  | 8.718 ms                  |
| Backward                  | 4.384 ms                  | 10.512 ms                 |
| Optimize                  | 2.228 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.432 ms                  | 33.470 ms                 |
| AfterBackward             | 25.578 ms                 | 58.966 ms                 |
| BlockToStepN              | 289.039 ms                | 439.448 ms                |
| OneStep                   | 347.342 ms                | 571.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:17.572371 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.752 ms                  | 8.271 ms                  |
| ProcessBack:UpdateCache   | 5.309 ms                  | 7.900 ms                  |
| ProcessBack:UpsertPq      | 14.877 ms                 | 22.957 ms                 |
| ProcessOneStep            | 25.546 ms                 | 58.875 ms                 |
| BlockToStepN              | 288.976 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:18.572008 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240205 21:57:19.572014 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240205 21:57:20.626796 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240205 21:57:21.626006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.840 ms                  | 30.587 ms                 |
| Forward                   | 5.740 ms                  | 8.718 ms                  |
| Backward                  | 4.378 ms                  | 10.512 ms                 |
| Optimize                  | 2.231 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.493 ms                  | 33.470 ms                 |
| AfterBackward             | 25.578 ms                 | 58.966 ms                 |
| BlockToStepN              | 294.197 ms                | 439.448 ms                |
| OneStep                   | 348.494 ms                | 571.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:22.626006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=230, pq.top=230
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.752 ms                  | 7.695 ms                  |
| ProcessBack:UpdateCache   | 5.296 ms                  | 6.955 ms                  |
| ProcessBack:UpsertPq      | 14.915 ms                 | 22.957 ms                 |
| ProcessOneStep            | 25.566 ms                 | 58.875 ms                 |
| BlockToStepN              | 294.535 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:23.626021 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240205 21:57:24.626006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240205 21:57:25.626008 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240205 21:57:26.626013 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.867 ms                  | 31.577 ms                 |
| Forward                   | 5.793 ms                  | 8.718 ms                  |
| Backward                  | 4.378 ms                  | 10.512 ms                 |
| Optimize                  | 2.234 ms                  | 6.863 ms                  |
| BarrierTimeBeforeRank0    | 5.478 ms                  | 33.470 ms                 |
| AfterBackward             | 25.578 ms                 | 58.966 ms                 |
| BlockToStepN              | 297.095 ms                | 439.448 ms                |
| OneStep                   | 349.800 ms                | 571.575 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:27.626010 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.748 ms                  | 7.695 ms                  |
| ProcessBack:UpdateCache   | 5.281 ms                  | 6.955 ms                  |
| ProcessBack:UpsertPq      | 14.959 ms                 | 22.957 ms                 |
| ProcessOneStep            | 25.545 ms                 | 58.875 ms                 |
| BlockToStepN              | 297.419 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:28.626008 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240205 21:57:29.626008 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240205 21:57:30.626014 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
W20240205 21:57:31.626010 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.840 ms                  | 31.436 ms                 |
| Forward                   | 5.824 ms                  | 8.241 ms                  |
| Backward                  | 4.375 ms                  | 10.252 ms                 |
| Optimize                  | 2.239 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.493 ms                  | 33.109 ms                 |
| AfterBackward             | 25.604 ms                 | 50.371 ms                 |
| BlockToStepN              | 300.795 ms                | 421.546 ms                |
| OneStep                   | 351.743 ms                | 522.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:32.671422 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.748 ms                  | 7.848 ms                  |
| ProcessBack:UpdateCache   | 5.252 ms                  | 6.955 ms                  |
| ProcessBack:UpsertPq      | 14.962 ms                 | 23.102 ms                 |
| ProcessOneStep            | 25.546 ms                 | 50.342 ms                 |
| BlockToStepN              | 300.802 ms                | 421.389 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:33.671007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240205 21:57:34.671016 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240205 21:57:35.671013 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
W20240205 21:57:36.671008 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=264, pq.top=264
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.840 ms                  | 31.436 ms                 |
| Forward                   | 5.841 ms                  | 8.241 ms                  |
| Backward                  | 4.379 ms                  | 10.252 ms                 |
| Optimize                  | 2.231 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.493 ms                  | 33.109 ms                 |
| AfterBackward             | 25.605 ms                 | 50.371 ms                 |
| BlockToStepN              | 303.442 ms                | 421.546 ms                |
| OneStep                   | 353.849 ms                | 522.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:37.671007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.748 ms                  | 7.848 ms                  |
| ProcessBack:UpdateCache   | 5.213 ms                  | 6.955 ms                  |
| ProcessBack:UpsertPq      | 15.008 ms                 | 23.102 ms                 |
| ProcessOneStep            | 25.578 ms                 | 50.342 ms                 |
| BlockToStepN              | 303.297 ms                | 421.389 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:38.671007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240205 21:57:39.671013 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240205 21:57:40.671011 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240205 21:57:41.671007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=276, pq.top=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.840 ms                  | 31.436 ms                 |
| Forward                   | 5.848 ms                  | 8.241 ms                  |
| Backward                  | 4.380 ms                  | 10.252 ms                 |
| Optimize                  | 2.226 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.496 ms                  | 33.109 ms                 |
| AfterBackward             | 25.574 ms                 | 50.371 ms                 |
| BlockToStepN              | 304.981 ms                | 421.546 ms                |
| OneStep                   | 360.231 ms                | 522.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:42.671007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.748 ms                  | 7.695 ms                  |
| ProcessBack:UpdateCache   | 5.195 ms                  | 6.909 ms                  |
| ProcessBack:UpsertPq      | 15.008 ms                 | 22.957 ms                 |
| ProcessOneStep            | 25.545 ms                 | 50.342 ms                 |
| BlockToStepN              | 304.757 ms                | 421.389 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:43.674618 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=282, pq.top=282
W20240205 21:57:44.674010 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240205 21:57:45.674006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240205 21:57:46.674007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.840 ms                  | 31.436 ms                 |
| Forward                   | 5.882 ms                  | 8.241 ms                  |
| Backward                  | 4.380 ms                  | 10.252 ms                 |
| Optimize                  | 2.226 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.493 ms                  | 33.109 ms                 |
| AfterBackward             | 25.574 ms                 | 50.371 ms                 |
| BlockToStepN              | 305.963 ms                | 439.448 ms                |
| OneStep                   | 361.652 ms                | 522.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:47.674006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.743 ms                  | 7.695 ms                  |
| ProcessBack:UpdateCache   | 5.189 ms                  | 6.909 ms                  |
| ProcessBack:UpsertPq      | 15.019 ms                 | 22.957 ms                 |
| ProcessOneStep            | 25.546 ms                 | 50.342 ms                 |
| BlockToStepN              | 306.125 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:48.674021 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=294, pq.top=294
W20240205 21:57:49.674007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240205 21:57:50.674006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 0] 300 steps, total: 40.334, sample: 0.515, forward: 0.591, backward: 0.428, update: 0.240
[proc 4] 300 steps, total: 40.334, sample: 0.379, forward: 0.464, backward: 0.971, update: 0.242
[proc 2] 300 steps, total: 40.334, sample: 0.405, forward: 0.493, backward: 1.040, update: 0.235
[proc 3] 300 steps, total: 40.334, sample: 0.447, forward: 0.459, backward: 0.984, update: 0.230
[proc 1] 300 steps, total: 40.334, sample: 0.401, forward: 0.496, backward: 0.393, update: 0.211
[proc 5] 300 steps, total: 40.334, sample: 0.423, forward: 0.465, backward: 1.028, update: 0.248
W20240205 21:57:51.674006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.867 ms                  | 31.436 ms                 |
| Forward                   | 5.896 ms                  | 8.241 ms                  |
| Backward                  | 4.379 ms                  | 10.252 ms                 |
| Optimize                  | 2.227 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.493 ms                  | 33.109 ms                 |
| AfterBackward             | 25.604 ms                 | 50.371 ms                 |
| BlockToStepN              | 308.057 ms                | 439.448 ms                |
| OneStep                   | 364.750 ms                | 522.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:52.674014 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.743 ms                  | 7.695 ms                  |
| ProcessBack:UpdateCache   | 5.189 ms                  | 6.909 ms                  |
| ProcessBack:UpsertPq      | 15.026 ms                 | 22.957 ms                 |
| ProcessOneStep            | 25.578 ms                 | 50.342 ms                 |
| BlockToStepN              | 308.109 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:53.674016 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240205 21:57:54.674006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240205 21:57:55.674007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=310, pq.top=310
W20240205 21:57:56.674019 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.867 ms                  | 31.436 ms                 |
| Forward                   | 5.899 ms                  | 8.241 ms                  |
| Backward                  | 4.383 ms                  | 10.252 ms                 |
| Optimize                  | 2.225 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.460 ms                  | 33.109 ms                 |
| AfterBackward             | 25.604 ms                 | 50.371 ms                 |
| BlockToStepN              | 309.569 ms                | 443.846 ms                |
| OneStep                   | 367.608 ms                | 535.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:57.674006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.744 ms                  | 7.695 ms                  |
| ProcessBack:UpdateCache   | 5.176 ms                  | 6.909 ms                  |
| ProcessBack:UpsertPq      | 15.034 ms                 | 23.571 ms                 |
| ProcessOneStep            | 25.578 ms                 | 50.342 ms                 |
| BlockToStepN              | 309.356 ms                | 443.786 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:57:58.674007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
W20240205 21:57:59.674016 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240205 21:58:00.678002 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240205 21:58:01.677006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.883 ms                  | 31.436 ms                 |
| Forward                   | 5.901 ms                  | 8.241 ms                  |
| Backward                  | 4.383 ms                  | 10.252 ms                 |
| Optimize                  | 2.224 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.432 ms                  | 33.109 ms                 |
| AfterBackward             | 25.593 ms                 | 50.371 ms                 |
| BlockToStepN              | 310.060 ms                | 443.846 ms                |
| OneStep                   | 369.383 ms                | 535.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:02.677008 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.744 ms                  | 7.670 ms                  |
| ProcessBack:UpdateCache   | 5.159 ms                  | 6.718 ms                  |
| ProcessBack:UpsertPq      | 15.046 ms                 | 23.571 ms                 |
| ProcessOneStep            | 25.566 ms                 | 50.342 ms                 |
| BlockToStepN              | 310.543 ms                | 443.786 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:03.677016 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240205 21:58:04.677012 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=332, pq.top=332
W20240205 21:58:05.677007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240205 21:58:06.677007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.890 ms                  | 31.436 ms                 |
| Forward                   | 5.902 ms                  | 8.241 ms                  |
| Backward                  | 4.380 ms                  | 10.252 ms                 |
| Optimize                  | 2.224 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.478 ms                  | 33.275 ms                 |
| AfterBackward             | 25.686 ms                 | 50.371 ms                 |
| BlockToStepN              | 313.949 ms                | 443.846 ms                |
| OneStep                   | 371.004 ms                | 535.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:07.677012 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.744 ms                  | 7.670 ms                  |
| ProcessBack:UpdateCache   | 5.159 ms                  | 6.718 ms                  |
| ProcessBack:UpsertPq      | 15.062 ms                 | 23.571 ms                 |
| ProcessOneStep            | 25.658 ms                 | 50.342 ms                 |
| BlockToStepN              | 313.899 ms                | 443.786 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:08.677013 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=342, pq.top=342
W20240205 21:58:09.677007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=344, pq.top=344
W20240205 21:58:10.677006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240205 21:58:11.677016 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=349, pq.top=349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.888 ms                  | 31.436 ms                 |
| Forward                   | 5.915 ms                  | 8.241 ms                  |
| Backward                  | 4.383 ms                  | 10.252 ms                 |
| Optimize                  | 2.217 ms                  | 5.003 ms                  |
| BarrierTimeBeforeRank0    | 5.496 ms                  | 33.275 ms                 |
| AfterBackward             | 25.686 ms                 | 50.371 ms                 |
| BlockToStepN              | 314.973 ms                | 443.846 ms                |
| OneStep                   | 372.994 ms                | 535.836 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:12.685052 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=352, pq.top=352
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.748 ms                  | 7.670 ms                  |
| ProcessBack:UpdateCache   | 5.143 ms                  | 6.909 ms                  |
| ProcessBack:UpsertPq      | 15.094 ms                 | 24.147 ms                 |
| ProcessOneStep            | 25.658 ms                 | 37.476 ms                 |
| BlockToStepN              | 314.865 ms                | 439.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:13.685009 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=354, pq.top=354
W20240205 21:58:14.685007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240205 21:58:15.685014 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240205 21:58:16.685015 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=361, pq.top=361
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.888 ms                  | 30.587 ms                 |
| Forward                   | 5.935 ms                  | 7.915 ms                  |
| Backward                  | 4.384 ms                  | 10.146 ms                 |
| Optimize                  | 2.217 ms                  | 4.977 ms                  |
| BarrierTimeBeforeRank0    | 5.511 ms                  | 33.109 ms                 |
| AfterBackward             | 25.701 ms                 | 37.504 ms                 |
| BlockToStepN              | 317.437 ms                | 443.846 ms                |
| OneStep                   | 374.215 ms                | 530.925 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:17.685006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=364, pq.top=364
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.748 ms                  | 7.670 ms                  |
| ProcessBack:UpdateCache   | 5.132 ms                  | 6.909 ms                  |
| ProcessBack:UpsertPq      | 15.106 ms                 | 24.262 ms                 |
| ProcessOneStep            | 25.673 ms                 | 37.476 ms                 |
| BlockToStepN              | 318.045 ms                | 443.786 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:18.685007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=366, pq.top=366
W20240205 21:58:19.731016 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240205 21:58:20.730006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240205 21:58:21.730007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=373, pq.top=373
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.890 ms                  | 31.480 ms                 |
| Forward                   | 5.935 ms                  | 7.915 ms                  |
| Backward                  | 4.385 ms                  | 10.146 ms                 |
| Optimize                  | 2.224 ms                  | 4.977 ms                  |
| BarrierTimeBeforeRank0    | 5.493 ms                  | 33.109 ms                 |
| AfterBackward             | 25.733 ms                 | 37.504 ms                 |
| BlockToStepN              | 319.311 ms                | 443.846 ms                |
| OneStep                   | 376.708 ms                | 530.925 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:22.730012 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.753 ms                  | 7.670 ms                  |
| ProcessBack:UpdateCache   | 5.132 ms                  | 6.909 ms                  |
| ProcessBack:UpsertPq      | 15.131 ms                 | 24.262 ms                 |
| ProcessOneStep            | 25.733 ms                 | 37.476 ms                 |
| BlockToStepN              | 319.251 ms                | 443.786 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:23.730015 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240205 21:58:24.730005 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=380, pq.top=380
W20240205 21:58:25.730007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240205 21:58:26.730007 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.911 ms                  | 31.480 ms                 |
| Forward                   | 5.943 ms                  | 7.915 ms                  |
| Backward                  | 4.388 ms                  | 10.146 ms                 |
| Optimize                  | 2.221 ms                  | 4.977 ms                  |
| BarrierTimeBeforeRank0    | 5.578 ms                  | 33.109 ms                 |
| AfterBackward             | 25.761 ms                 | 40.961 ms                 |
| BlockToStepN              | 320.680 ms                | 451.333 ms                |
| OneStep                   | 379.475 ms                | 530.925 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:27.730010 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.755 ms                  | 7.240 ms                  |
| ProcessBack:UpdateCache   | 5.125 ms                  | 6.718 ms                  |
| ProcessBack:UpsertPq      | 15.165 ms                 | 24.262 ms                 |
| ProcessOneStep            | 25.735 ms                 | 40.934 ms                 |
| BlockToStepN              | 319.974 ms                | 451.207 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:28.758688 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=390, pq.top=390
W20240205 21:58:29.758006 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=392, pq.top=392
W20240205 21:58:30.758008 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=394, pq.top=394
W20240205 21:58:31.777853 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=397, pq.top=397
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.911 ms                  | 31.577 ms                 |
| Forward                   | 5.946 ms                  | 7.915 ms                  |
| Backward                  | 4.385 ms                  | 10.146 ms                 |
| Optimize                  | 2.216 ms                  | 4.977 ms                  |
| BarrierTimeBeforeRank0    | 5.604 ms                  | 33.109 ms                 |
| AfterBackward             | 25.778 ms                 | 40.961 ms                 |
| BlockToStepN              | 321.855 ms                | 457.906 ms                |
| OneStep                   | 381.985 ms                | 530.925 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:58:32.777011 35162 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.768 ms                  | 7.240 ms                  |
| ProcessBack:UpdateCache   | 5.122 ms                  | 6.718 ms                  |
| ProcessBack:UpsertPq      | 15.165 ms                 | 24.262 ms                 |
| ProcessOneStep            | 25.733 ms                 | 40.934 ms                 |
| BlockToStepN              | 321.798 ms                | 457.856 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 41.959, sample: 0.403, forward: 0.499, backward: 1.050, update: 0.234
[proc 0] 400 steps, total: 41.959, sample: 0.582, forward: 0.582, backward: 0.435, update: 0.230
[proc 4] 400 steps, total: 41.959, sample: 0.427, forward: 0.468, backward: 1.032, update: 0.242
[proc 1] 400 steps, total: 41.959, sample: 0.403, forward: 0.496, backward: 0.547, update: 0.213
[proc 5] 400 steps, total: 41.959, sample: 0.388, forward: 0.463, backward: 1.022, update: 0.246
[proc 3] 400 steps, total: 41.959, sample: 0.406, forward: 0.467, backward: 0.978, update: 0.239
Successfully xmh. training takes 150.0818576812744 seconds
before call kg_cache_controller.StopThreads()
W20240205 21:58:33.477675 35162 grad_async_v1.h:243] call StopThreads. PID = 34764
W20240205 21:58:33.477700 35162 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 21:58:33.490926 35162 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 21:58:33.490962 35162 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 21:58:33.655241 35162 grad_async_v1.h:264] StopThreads done.
