WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 23:02:35.597414 14111 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_48', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [14111 sampler.py:454] Start PreSampling
WARNING [14111 sampler.py:532] Before construct renumbering_dict
WARNING [14111 sampler.py:555] PreSampling done
W20240202 23:22:59.478991 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 23:22:59.479190 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 23:22:59.479228 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 23:22:59.479261 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 23:22:59.479305 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 23:22:59.479336 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 23:22:59.479377 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 23:22:59.479418 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 23:22:59.479450 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 23:22:59.479488 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 23:22:59.479522 14111 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 23:22:59.479554 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 23:22:59.479583 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 23:22:59.479745 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 23:22:59.479785 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 23:22:59.479820 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 23:22:59.479869 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 23:22:59.479897 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 23:22:59.479923 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 23:22:59.479959 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 23:22:59.479984 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 23:22:59.480016 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 23:22:59.480044 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 23:22:59.480087 14111 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 23:22:59.480109 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 23:22:59.480135 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 23:22:59.480192 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 23:22:59.480233 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 23:22:59.480262 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 23:22:59.480293 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 23:22:59.480322 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 23:22:59.480356 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 23:22:59.480386 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 23:22:59.480410 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 23:22:59.480437 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 23:22:59.480466 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 23:22:59.480500 14111 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 23:22:59.480522 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 23:22:59.480551 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 23:22:59.480618 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 23:22:59.480649 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 23:22:59.480676 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 23:22:59.480705 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 23:22:59.480741 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 23:22:59.480773 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 23:22:59.480801 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 23:22:59.480837 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 23:22:59.480872 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 23:22:59.480908 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 23:22:59.480937 14111 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 23:22:59.480959 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 23:22:59.480988 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 23:22:59.481047 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240202 23:22:59.481081 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240202 23:22:59.481114 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240202 23:22:59.481141 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240202 23:22:59.481168 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240202 23:22:59.481206 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240202 23:22:59.481240 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240202 23:22:59.481273 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240202 23:22:59.481305 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240202 23:22:59.481341 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240202 23:22:59.481367 14111 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240202 23:22:59.481390 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240202 23:22:59.481412 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240202 23:22:59.481460 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240202 23:22:59.481503 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240202 23:22:59.481539 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240202 23:22:59.481567 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240202 23:22:59.481593 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240202 23:22:59.481621 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240202 23:22:59.481649 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240202 23:22:59.481678 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240202 23:22:59.481704 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240202 23:22:59.481735 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240202 23:22:59.481762 14111 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240202 23:22:59.481786 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240202 23:22:59.481807 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240202 23:22:59.481863 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240202 23:22:59.481900 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240202 23:22:59.481930 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240202 23:22:59.481957 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240202 23:22:59.481987 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240202 23:22:59.482014 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240202 23:22:59.482049 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240202 23:22:59.482079 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240202 23:22:59.482105 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240202 23:22:59.482133 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240202 23:22:59.482167 14111 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240202 23:22:59.482190 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240202 23:22:59.482213 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240202 23:22:59.482267 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240202 23:22:59.482300 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240202 23:22:59.482333 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240202 23:22:59.482364 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240202 23:22:59.482398 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240202 23:22:59.482429 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240202 23:22:59.482461 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240202 23:22:59.482491 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240202 23:22:59.482518 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240202 23:22:59.482549 14111 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240202 23:22:59.482576 14111 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240202 23:22:59.482599 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240202 23:22:59.482625 14111 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240202 23:22:59.892089 14111 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240202 23:31:38.560233 14111 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302716,  4302765,    90908,  ..., 70729144, 53954310,  5205038]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2254.016 seconds
[Rank1] pid = 43901
[Rank2] pid = 44091
[Rank3] pid = 44252
[Rank4] pid = 44421
[Rank5] pid = 44608
[Rank6] pid = 44784
INFO [14111 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [43901 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [44091 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [44252 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [44421 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [44608 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [44961 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [44784 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [44421 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44091 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44252 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44784 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44961 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [44608 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [14111 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [43901 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240202 23:40:20.782214 44253 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240202 23:40:20.782315 44785 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240202 23:40:20.782315 45025 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240202 23:40:20.782837 44609 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240202 23:40:20.783277 44422 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240202 23:40:20.783277 44092 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240202 23:40:20.783974 44962 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240202 23:40:20.785359 43902 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240202 23:40:20.862780 44609 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1020497b1000 7.629 MB
W20240202 23:40:20.862793 44962 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102049f54000 7.629 MB
W20240202 23:40:20.862803 44253 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204a6f7000 7.629 MB
W20240202 23:40:20.862810 45025 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204ae9a000 7.629 MB
W20240202 23:40:20.862815 44785 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204b63d000 7.629 MB
W20240202 23:40:20.862840 43902 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204bde0000 7.629 MB
W20240202 23:40:20.862864 44092 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204c583000 7.629 MB
W20240202 23:40:20.862864 44422 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204cd26000 7.629 MB
W20240202 23:40:20.862969 44609 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10204d4c9000 7.629 MB
W20240202 23:40:20.862972 44962 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10204dc6c000 7.629 MB
W20240202 23:40:20.863015 43902 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10204e40f000 7.629 MB
W20240202 23:40:20.863020 45025 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204ebb2000 7.629 MB
W20240202 23:40:20.863024 44785 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204f355000 7.629 MB
W20240202 23:40:20.863026 44962 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10204faf8000 1.49 GB
W20240202 23:40:20.863042 44253 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020af0db000 7.629 MB
W20240202 23:40:20.863065 44962 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020af87e000 1.49 GB
W20240202 23:40:20.863072 44609 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10210ee61000 1.49 GB
W20240202 23:40:20.863113 44962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 23:40:20.863117 44785 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10216e444000 1.49 GB
W20240202 23:40:20.863124 43902 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021cda27000 1.49 GB
W20240202 23:40:20.863134 44092 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10222d00a000 7.629 MB
W20240202 23:40:20.863140 45025 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10222d7ad000 1.49 GB
W20240202 23:40:20.863148 44422 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10228cd90000 7.629 MB
W20240202 23:40:20.863154 44253 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10228d533000 1.49 GB
W20240202 23:40:20.863171 44609 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1022ecb16000 1.49 GB
W20240202 23:40:20.863209 44785 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x10234c0f9000 1.49 GB
W20240202 23:40:20.863215 43902 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1023ab6dc000 1.49 GB
W20240202 23:40:20.863238 45025 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10240acbf000 1.49 GB
W20240202 23:40:20.863252 44253 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10246a2a2000 1.49 GB
W20240202 23:40:20.863288 44609 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 23:40:20.863291 43902 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 23:40:20.863291 44785 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240202 23:40:20.863296 44422 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1024c9885000 1.49 GB
W20240202 23:40:20.863303 44092 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102528e68000 1.49 GB
W20240202 23:40:20.863320 44253 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 23:40:20.863323 45025 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240202 23:40:20.863373 44092 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10258844b000 1.49 GB
W20240202 23:40:20.863380 44422 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240202 23:40:20.863453 44092 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 23:40:20.863459 44422 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 23:40:20.876504 44962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 23:40:20.876561 44609 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 23:40:20.876567 43902 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 23:40:20.876567 45025 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240202 23:40:20.876572 44253 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 23:40:20.876590 44785 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240202 23:40:20.876602 44422 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 23:40:20.876631 44092 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [44252 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [44091 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [44608 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [44784 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 44961
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [14111 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [44421 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [43901 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [44961 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 23:41:11.600656 45025 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240202 23:41:11.601276 43902 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 23:41:11.601395 44962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 23:41:11.601426 44422 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 23:41:11.601462 44785 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 23:41:11.601533 44092 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 23:41:11.601612 44609 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 23:41:11.601686 44253 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240202 23:41:11.604341 44962 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240202 23:41:11.604488 44962 grad_base.h:184] Init GradProcessingBase done
I20240202 23:41:24.478932 44962 grad_async_v2.h:42] Use main thread to update emb.
W20240202 23:41:24.479095 44962 kg_controller.h:78] after init GradAsyncProcessingV2
I20240202 23:41:24.479105 44962 kg_controller.h:84] Construct KGCacheController done
E20240202 23:41:25.237501 44253 recstore.cc:66] init folly done
E20240202 23:41:25.237550 45025 recstore.cc:66] init folly done
E20240202 23:41:25.237625 44422 recstore.cc:66] init folly done
E20240202 23:41:25.237644 44609 recstore.cc:66] init folly done
E20240202 23:41:25.237645 43902 recstore.cc:66] init folly done
E20240202 23:41:25.237668 44092 recstore.cc:66] init folly done
E20240202 23:41:25.237684 44785 recstore.cc:66] init folly done
E20240202 23:41:25.238412 44962 recstore.cc:66] init folly done
I20240202 23:41:25.239925 44962 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240202 23:41:43.495882 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240202 23:41:43.496421 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:41:44.539974 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240202 23:41:44.540156 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 155.660 us                | 327.135 us                |
+---------------------------+---------------------------+---------------------------+
W20240202 23:41:46.530040 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240202 23:41:46.546198 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240202 23:41:46.694545 45025 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240202 23:41:46.853432 44422 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240202 23:41:47.619764 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240202 23:41:47.637068 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240202 23:41:47.795585 44609 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 23:41:48.454178 44092 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240202 23:41:48.637012 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240202 23:41:48.713938 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240202 23:41:48.754940 44962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 23:41:49.269790 44253 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240202 23:41:49.637009 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=29
I20240202 23:41:49.680012 44785 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240202 23:41:49.715325 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240202 23:41:49.763959 43902 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 153.172 us                | 292.798 us                |
+---------------------------+---------------------------+---------------------------+
E20240202 23:41:50.637009 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240202 23:41:50.732823 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.667 ms                  | 7.667 ms                  |
| Forward                   | 892.450 ms                | 892.450 ms                |
| Backward                  | 248.645 ms                | 248.645 ms                |
| Optimize                  | 2.418 ms                  | 2.418 ms                  |
| BarrierTimeBeforeRank0    | 36.335 us                 | 36.335 us                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:41:52.211500 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240202 23:41:52.308264 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240202 23:41:52.326427 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240202 23:41:53.211015 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=11
W20240202 23:41:53.381417 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240202 23:41:53.523345 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
E20240202 23:41:54.211006 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=106
E20240202 23:41:54.404647 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=14, sample_step_cpp_seen_[rank]=13
W20240202 23:41:54.523538 50357 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240202 23:41:54.650322 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=15, pq.top=15
E20240202 23:41:55.211009 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=384
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 267.544 us                | 996.822 us                |
| ProcessBack:Shuffle       | 8.771 ms                  | 293.795 ms                |
| ProcessBack:UpdateCache   | 10.317 ms                 | 727.542 ms                |
| ProcessBack:UpsertPq      | 21.585 ms                 | 108.209 ms                |
| ProcessOneStep            | 105.468 ms                | 1.391 s                   |
| BlockToStepN              | 1.245 ms                  | 19.122 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240202 23:41:55.630522 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
E20240202 23:41:56.211385 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.916 ms                  | 83.533 ms                 |
| Forward                   | 5.652 ms                  | 892.450 ms                |
| Backward                  | 5.052 ms                  | 248.645 ms                |
| Optimize                  | 2.677 ms                  | 7.273 ms                  |
| BarrierTimeBeforeRank0    | 5.381 ms                  | 307.549 ms                |
| AfterBackward             | 105.515 ms                | 1.774 s                   |
| BlockToStepN              | 1.060 ms                  | 19.186 ms                 |
| OneStep                   | 157.088 ms                | 2.559 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:41:56.637715 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240202 23:41:57.211014 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=48
W20240202 23:41:57.673307 50357 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end1
E20240202 23:41:58.211014 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:41:58.703282 50357 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240202 23:41:59.211007 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=56
W20240202 23:41:59.326989 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240202 23:41:59.753410 50357 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240202 23:42:00.211015 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=50
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 476.537 us                | 11.297 ms                 |
| ProcessBack:Shuffle       | 8.799 ms                  | 252.791 ms                |
| ProcessBack:UpdateCache   | 10.507 ms                 | 727.039 ms                |
| ProcessBack:UpsertPq      | 24.699 ms                 | 173.974 ms                |
| ProcessOneStep            | 111.926 ms                | 1.774 s                   |
| BlockToStepN              | 349.853 us                | 19.122 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:00.416682 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=34, pq.top=34
E20240202 23:42:00.924759 44962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=37, sample_step_cpp_seen_[rank]=36
W20240202 23:42:00.950982 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240202 23:42:01.211009 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=216
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.337 ms                  | 485.353 ms                |
| Forward                   | 6.100 ms                  | 892.450 ms                |
| Backward                  | 4.758 ms                  | 248.645 ms                |
| Optimize                  | 2.616 ms                  | 13.887 ms                 |
| BarrierTimeBeforeRank0    | 72.152 us                 | 307.549 ms                |
| AfterBackward             | 115.332 ms                | 1.774 s                   |
| BlockToStepN              | 519.506 us                | 19.186 ms                 |
| OneStep                   | 158.173 ms                | 2.559 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:02.104460 50357 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240202 23:42:02.211046 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=451
W20240202 23:42:02.482240 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240202 23:42:03.125950 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240202 23:42:03.211010 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=185
W20240202 23:42:03.562232 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=47, pq.top=47
E20240202 23:42:04.211964 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:04.359222 50357 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240202 23:42:05.233273 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 413.699 us                | 2.989 ms                  |
| ProcessBack:Shuffle       | 9.015 ms                  | 252.791 ms                |
| ProcessBack:UpdateCache   | 10.469 ms                 | 727.039 ms                |
| ProcessBack:UpsertPq      | 24.079 ms                 | 173.974 ms                |
| ProcessOneStep            | 105.971 ms                | 1.391 s                   |
| BlockToStepN              | 760.479 us                | 14.867 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:05.379570 50357 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240202 23:42:05.579406 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=55, pq.top=55
E20240202 23:42:06.238497 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:06.414453 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240202 23:42:06.608955 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=64, pq.top=64
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.337 ms                  | 209.618 ms                |
| Forward                   | 5.890 ms                  | 22.267 ms                 |
| Backward                  | 4.640 ms                  | 9.572 ms                  |
| Optimize                  | 2.677 ms                  | 12.954 ms                 |
| BarrierTimeBeforeRank0    | 821.942 us                | 208.537 ms                |
| AfterBackward             | 99.589 ms                 | 1.392 s                   |
| BlockToStepN              | 1.060 ms                  | 14.968 ms                 |
| OneStep                   | 142.257 ms                | 1.795 s                   |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:07.075759 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=68, sample_step_cpp_seen_[rank]=67
E20240202 23:42:07.238008 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=3850
W20240202 23:42:07.593252 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240202 23:42:08.238009 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1193
W20240202 23:42:08.613787 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240202 23:42:08.751902 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=73, pq.top=73
E20240202 23:42:09.238008 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=6423
W20240202 23:42:09.663592 50357 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
W20240202 23:42:09.788699 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=83, pq.top=83
E20240202 23:42:10.238009 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1793
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 462.542 us                | 8.623 ms                  |
| ProcessBack:Shuffle       | 8.825 ms                  | 40.894 ms                 |
| ProcessBack:UpdateCache   | 10.440 ms                 | 28.007 ms                 |
| ProcessBack:UpsertPq      | 29.142 ms                 | 169.352 ms                |
| ProcessOneStep            | 98.438 ms                 | 1.391 s                   |
| BlockToStepN              | 1.001 ms                  | 14.867 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:10.783476 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end5
W20240202 23:42:11.125926 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=85, pq.top=85
E20240202 23:42:11.241370 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.667 ms                  | 209.618 ms                |
| Forward                   | 5.733 ms                  | 22.267 ms                 |
| Backward                  | 4.796 ms                  | 9.572 ms                  |
| Optimize                  | 2.772 ms                  | 12.954 ms                 |
| BarrierTimeBeforeRank0    | 2.847 ms                  | 208.537 ms                |
| AfterBackward             | 98.487 ms                 | 1.392 s                   |
| BlockToStepN              | 1.060 ms                  | 14.968 ms                 |
| OneStep                   | 138.253 ms                | 1.795 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:11.826712 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240202 23:42:12.125041 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=93, pq.top=93
E20240202 23:42:12.241007 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=1483
E20240202 23:42:12.771747 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=99, sample_step_cpp_seen_[rank]=98
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 25.036, sample: 1.305, forward: 1.316, backward: 1.080, update: 0.287
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 24.378, sample: 2.340, forward: 1.350, backward: 0.729, update: 0.250
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 23.152, sample: 1.556, forward: 1.320, backward: 0.871, update: 0.253
train_sampler.Prefill()
-------Step 0-------
tensor([   59461,    59495,    59525,    59563,  6233520,   143617, 66811846,
        20935064, 18573995,    59597]) tensor([ 5454519, 18074653, 68622538, 79484481, 17685018, 38320055, 31352518,
        81497413, 77485570, 24592461])
-------Step 1-------
tensor([   59461,    59495,    59525,    59563,  6233520,   143617, 66811846,
        20935064, 18573995,    59597]) tensor([77221569, 32784012, 10103040, 82352885, 71943734, 49239851, 63394800,
        42492160, 43335647, 15147730])
-------Step 2-------
tensor([  147971,   148005,   148044,    23673,   148077,   148105,   148154,
        26050621,   148190,   148224]) tensor([79347561, 20696264, 70807952, 56246108, 35769771, 24921365, 77381268,
        46815272, 12337686, 48199349])
-------Step 3-------
tensor([  147971,   148005,   148044,    23673,   148077,   148105,   148154,
        26050621,   148190,   148224]) tensor([56601363, 74425994, 39730538, 46316208, 55153413, 72786633, 36406084,
        19179479, 22281728,   689176])
-------Step 4-------
tensor([  239856, 39309773,   239889,   177539,   239919,   177569,   239949,
        48321201,   239993,   240025]) tensor([70943138, 11076879, 74007214, 15911551, 78886163, 36592590, 57090242,
        45451395, 85063166, 59488068])
-------Step 5-------
tensor([  239856, 39309773,   239889,   177539,   239919,   177569,   239949,
        48321201,   239993,   240025]) tensor([40108667, 68682297,   294887, 85932822, 65860952, 47597211, 12873952,
         8594033, 77842694, 34813685])
-------Step 6-------
tensor([  331974,    49433,   332016,   332064,    49463, 64977760,   332107,
          332146,   194236, 44137953]) tensor([12006047, 43504485, 41749801, 82712606, 38116053, 31393554, 25325675,
         6917995, 77085400, 84533346])
-------Step 7-------
tensor([  331974,    49433,   332016,   332064,    49463, 64977760,   332107,
          332146,   194236, 44137953]) tensor([21414756, 59045184, 62634102, 50542587, 76078579, 57629011, 46607903,
        64665665, 40650578, 27105132])
-------Step 8-------
tensor([  421719, 30186737,   421762,   210225,   421793,    62053,   421821,
          421875,   421918,   421951]) tensor([50803519, 28290951, 39579438,  2006629, 55875605, 57259911, 13127456,
        79412096,  1457375, 72594459])
-------Step 9-------
tensor([  421719, 30186737,   421762,   210225,   421793,    62053,   421821,
          421875,   421918,   421951]) tensor([45522637, 42095658, 14407354, 47310592, 10121897, 47626251, 31133735,
        43377976, 73844213, 59646026])
before start barrier
start train
[proc 0] 100 steps, total: 24.077, sample: 2.332, forward: 1.502, backward: 0.756, update: 0.326
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 23.562, sample: 1.681, forward: 1.267, backward: 0.879, update: 0.275
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 23.068, sample: 2.525, forward: 1.281, backward: 0.740, update: 0.239
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 26.137, sample: 1.277, forward: 1.325, backward: 0.798, update: 0.308
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 25.979, sample: 1.359, forward: 1.313, backward: 0.972, update: 0.248
W20240202 23:42:13.023077 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
E20240202 23:42:13.241007 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=5952
W20240202 23:42:13.857620 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240202 23:42:14.075594 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240202 23:42:14.241010 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=58367
W20240202 23:42:14.889570 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=108, pq.top=107
W20240202 23:42:15.151892 50357 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
E20240202 23:42:15.241034 50696 parallel_pq_v2.h:79] insert failed, size(hashtable)=17240
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 489.122 us                | 17.050 ms                 |
| ProcessBack:Shuffle       | 8.772 ms                  | 40.894 ms                 |
| ProcessBack:UpdateCache   | 10.469 ms                 | 28.007 ms                 |
| ProcessBack:UpsertPq      | 28.445 ms                 | 169.352 ms                |
| ProcessOneStep            | 97.905 ms                 | 1.391 s                   |
| BlockToStepN              | 1.374 ms                  | 27.431 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:16.007835 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=117, pq.top=117
E20240202 23:42:16.241008 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1640
W20240202 23:42:16.385205 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.180 ms                  | 209.618 ms                |
| Forward                   | 5.707 ms                  | 22.267 ms                 |
| Backward                  | 5.070 ms                  | 11.682 ms                 |
| Optimize                  | 2.724 ms                  | 12.954 ms                 |
| BarrierTimeBeforeRank0    | 2.469 ms                  | 208.537 ms                |
| AfterBackward             | 97.953 ms                 | 1.392 s                   |
| BlockToStepN              | 1.544 ms                  | 42.584 ms                 |
| OneStep                   | 134.931 ms                | 1.795 s                   |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:17.241017 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=2286
W20240202 23:42:17.547986 50357 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240202 23:42:18.241022 50698 parallel_pq_v2.h:79] insert failed, size(hashtable)=38034
W20240202 23:42:18.789866 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
W20240202 23:42:18.805881 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=127, pq.top=126
E20240202 23:42:19.241031 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=665
E20240202 23:42:19.639281 44962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=133, sample_step_cpp_seen_[rank]=132
W20240202 23:42:19.991789 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240202 23:42:20.241010 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1717
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 371.794 us                | 5.615 ms                  |
| ProcessBack:Shuffle       | 8.884 ms                  | 21.952 ms                 |
| ProcessBack:UpdateCache   | 10.469 ms                 | 27.664 ms                 |
| ProcessBack:UpsertPq      | 28.754 ms                 | 165.267 ms                |
| ProcessOneStep            | 97.425 ms                 | 1.391 s                   |
| BlockToStepN              | 1.420 ms                  | 49.085 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:20.732187 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240202 23:42:21.059429 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240202 23:42:21.241007 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=119778
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.545 ms                  | 209.618 ms                |
| Forward                   | 5.683 ms                  | 22.267 ms                 |
| Backward                  | 5.068 ms                  | 11.682 ms                 |
| Optimize                  | 2.741 ms                  | 12.954 ms                 |
| BarrierTimeBeforeRank0    | 2.392 ms                  | 208.537 ms                |
| AfterBackward             | 97.477 ms                 | 1.392 s                   |
| BlockToStepN              | 1.717 ms                  | 49.938 ms                 |
| OneStep                   | 135.735 ms                | 1.795 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:21.788311 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=143, pq.top=143
E20240202 23:42:22.241026 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=80786
W20240202 23:42:22.256333 50357 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240202 23:42:23.241014 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:23.352216 50357 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
W20240202 23:42:23.586983 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=151, pq.top=151
E20240202 23:42:24.241009 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=728
W20240202 23:42:24.375371 50357 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
W20240202 23:42:24.693874 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240202 23:42:25.043094 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=164, sample_step_cpp_seen_[rank]=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 586.260 us                | 21.921 ms                 |
| ProcessBack:Shuffle       | 8.848 ms                  | 21.952 ms                 |
| ProcessBack:UpdateCache   | 10.459 ms                 | 27.664 ms                 |
| ProcessBack:UpsertPq      | 27.951 ms                 | 165.267 ms                |
| ProcessOneStep            | 96.349 ms                 | 1.150 s                   |
| BlockToStepN              | 1.638 ms                  | 49.840 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:25.249861 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:25.429816 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240202 23:42:26.249804 50716 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:26.442052 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.041 ms                  | 182.370 ms                |
| Forward                   | 5.627 ms                  | 14.746 ms                 |
| Backward                  | 4.921 ms                  | 11.606 ms                 |
| Optimize                  | 2.724 ms                  | 8.217 ms                  |
| BarrierTimeBeforeRank0    | 2.749 ms                  | 174.717 ms                |
| AfterBackward             | 96.769 ms                 | 1.151 s                   |
| BlockToStepN              | 1.717 ms                  | 49.938 ms                 |
| OneStep                   | 134.931 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:26.994146 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=171, pq.top=170
E20240202 23:42:27.250248 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=123
W20240202 23:42:27.443940 50357 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
W20240202 23:42:28.045974 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=180, pq.top=180
E20240202 23:42:28.250008 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=3084
W20240202 23:42:28.656368 50357 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240202 23:42:29.250881 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:29.543113 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240202 23:42:29.675192 50357 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 427.642 us                | 9.235 ms                  |
| ProcessBack:Shuffle       | 8.771 ms                  | 21.952 ms                 |
| ProcessBack:UpdateCache   | 10.378 ms                 | 16.984 ms                 |
| ProcessBack:UpsertPq      | 27.530 ms                 | 164.133 ms                |
| ProcessOneStep            | 94.106 ms                 | 1.150 s                   |
| BlockToStepN              | 1.624 ms                  | 65.161 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:30.250025 50709 parallel_pq_v2.h:79] insert failed, size(hashtable)=39713
W20240202 23:42:30.615849 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=190, pq.top=189
W20240202 23:42:30.742832 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
E20240202 23:42:31.250018 50712 parallel_pq_v2.h:79] insert failed, size(hashtable)=22329
E20240202 23:42:31.549679 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=197, sample_step_cpp_seen_[rank]=196
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.990 ms                  | 182.370 ms                |
| Forward                   | 5.595 ms                  | 14.746 ms                 |
| Backward                  | 5.246 ms                  | 11.606 ms                 |
| Optimize                  | 2.695 ms                  | 8.217 ms                  |
| BarrierTimeBeforeRank0    | 2.787 ms                  | 174.717 ms                |
| AfterBackward             | 93.313 ms                 | 1.151 s                   |
| BlockToStepN              | 1.818 ms                  | 76.980 ms                 |
| OneStep                   | 135.735 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:31.825345 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240202 23:42:32.250012 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=3408
W20240202 23:42:32.641466 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=199, pq.top=199
W20240202 23:42:32.841791 50357 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
[proc 0] 200 steps, total: 20.176, sample: 1.595, forward: 0.567, backward: 0.597, update: 0.308
[proc 3] 200 steps, total: 20.175, sample: 1.099, forward: 0.532, backward: 0.701, update: 0.262
[proc 7] 200 steps, total: 20.175, sample: 1.113, forward: 0.558, backward: 0.620, update: 0.263
[proc 2] 200 steps, total: 20.176, sample: 1.817, forward: 0.531, backward: 0.572, update: 0.279
[proc 4] 200 steps, total: 20.175, sample: 1.370, forward: 0.615, backward: 0.686, update: 0.272
[proc 6] 200 steps, total: 20.176, sample: 1.259, forward: 0.531, backward: 0.723, update: 0.271
[proc 1] 200 steps, total: 20.175, sample: 1.592, forward: 0.521, backward: 0.506, update: 0.232
[proc 5] 200 steps, total: 20.176, sample: 1.404, forward: 0.585, backward: 0.663, update: 0.295
E20240202 23:42:33.252111 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:33.641194 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240202 23:42:33.937165 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240202 23:42:34.252008 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=803
W20240202 23:42:35.120934 50357 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 376.303 us                | 8.944 ms                  |
| ProcessBack:Shuffle       | 8.731 ms                  | 21.952 ms                 |
| ProcessBack:UpdateCache   | 10.427 ms                 | 16.984 ms                 |
| ProcessBack:UpsertPq      | 27.429 ms                 | 164.133 ms                |
| ProcessOneStep            | 92.995 ms                 | 1.150 s                   |
| BlockToStepN              | 1.775 ms                  | 78.164 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:35.263374 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:35.871649 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240202 23:42:36.211405 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240202 23:42:36.273600 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.637 ms                  | 182.370 ms                |
| Forward                   | 5.591 ms                  | 14.746 ms                 |
| Backward                  | 5.346 ms                  | 11.606 ms                 |
| Optimize                  | 2.760 ms                  | 9.488 ms                  |
| BarrierTimeBeforeRank0    | 2.847 ms                  | 174.717 ms                |
| AfterBackward             | 93.052 ms                 | 1.392 s                   |
| BlockToStepN              | 1.841 ms                  | 78.284 ms                 |
| OneStep                   | 134.931 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:36.871075 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=220, pq.top=220
E20240202 23:42:37.276705 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=35699
W20240202 23:42:37.416532 50357 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240202 23:42:37.450409 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=224, sample_step_cpp_seen_[rank]=223
E20240202 23:42:38.276017 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=7014
W20240202 23:42:38.471746 50357 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240202 23:42:38.791117 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=227, pq.top=227
E20240202 23:42:39.281549 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:39.516549 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240202 23:42:39.816669 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=234, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 587.937 us                | 14.258 ms                 |
| ProcessBack:Shuffle       | 8.671 ms                  | 21.458 ms                 |
| ProcessBack:UpdateCache   | 10.314 ms                 | 15.700 ms                 |
| ProcessBack:UpsertPq      | 27.530 ms                 | 151.090 ms                |
| ProcessOneStep            | 92.793 ms                 | 1.391 s                   |
| BlockToStepN              | 1.949 ms                  | 78.164 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:40.281011 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=52545
W20240202 23:42:40.710222 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240202 23:42:41.281014 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=5165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.578 ms                  | 182.370 ms                |
| Forward                   | 5.591 ms                  | 14.746 ms                 |
| Backward                  | 5.420 ms                  | 11.606 ms                 |
| Optimize                  | 2.741 ms                  | 12.080 ms                 |
| BarrierTimeBeforeRank0    | 2.919 ms                  | 174.717 ms                |
| AfterBackward             | 92.844 ms                 | 1.392 s                   |
| BlockToStepN              | 2.039 ms                  | 78.284 ms                 |
| OneStep                   | 135.735 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:41.725720 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240202 23:42:41.955660 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=241, pq.top=241
E20240202 23:42:42.281013 48072 parallel_pq_v2.h:79] insert failed, size(hashtable)=51354
W20240202 23:42:42.823474 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
W20240202 23:42:42.969301 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=248, pq.top=248
E20240202 23:42:43.281014 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=1843
W20240202 23:42:43.876718 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240202 23:42:43.918706 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=255, sample_step_cpp_seen_[rank]=254
E20240202 23:42:44.281455 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:42:44.903641 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
W20240202 23:42:45.145478 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=256, pq.top=256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 370.725 us                | 3.755 ms                  |
| ProcessBack:Shuffle       | 8.624 ms                  | 21.458 ms                 |
| ProcessBack:UpdateCache   | 10.236 ms                 | 15.700 ms                 |
| ProcessBack:UpsertPq      | 27.874 ms                 | 151.090 ms                |
| ProcessOneStep            | 92.856 ms                 | 1.247 s                   |
| BlockToStepN              | 2.024 ms                  | 76.848 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:45.281008 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=58974
W20240202 23:42:45.979542 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240202 23:42:46.281030 50693 parallel_pq_v2.h:79] insert failed, size(hashtable)=42501
W20240202 23:42:46.289732 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.340 ms                  | 173.301 ms                |
| Forward                   | 5.570 ms                  | 11.761 ms                 |
| Backward                  | 5.517 ms                  | 11.606 ms                 |
| Optimize                  | 2.712 ms                  | 9.488 ms                  |
| BarrierTimeBeforeRank0    | 2.919 ms                  | 160.580 ms                |
| AfterBackward             | 92.844 ms                 | 1.247 s                   |
| BlockToStepN              | 2.174 ms                  | 76.980 ms                 |
| OneStep                   | 134.931 ms                | 1.438 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:47.131278 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240202 23:42:47.281016 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=873
W20240202 23:42:48.138967 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240202 23:42:48.143939 50357 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240202 23:42:48.281009 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=150
E20240202 23:42:49.281009 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=4135
W20240202 23:42:49.304610 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
W20240202 23:42:49.494557 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=279, pq.top=279
E20240202 23:42:49.894178 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=281, sample_step_cpp_seen_[rank]=280
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 507.559 us                | 15.933 ms                 |
| ProcessBack:Shuffle       | 8.610 ms                  | 21.458 ms                 |
| ProcessBack:UpdateCache   | 10.136 ms                 | 16.623 ms                 |
| ProcessBack:UpsertPq      | 27.792 ms                 | 150.888 ms                |
| ProcessOneStep            | 92.856 ms                 | 1.391 s                   |
| BlockToStepN              | 2.103 ms                  | 76.848 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:50.281090 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=4135
W20240202 23:42:50.334722 50357 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240202 23:42:51.281011 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=7741
W20240202 23:42:51.353762 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240202 23:42:51.493989 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.324 ms                  | 182.370 ms                |
| Forward                   | 5.560 ms                  | 11.761 ms                 |
| Backward                  | 5.453 ms                  | 11.606 ms                 |
| Optimize                  | 2.677 ms                  | 9.488 ms                  |
| BarrierTimeBeforeRank0    | 2.941 ms                  | 160.580 ms                |
| AfterBackward             | 92.909 ms                 | 1.413 s                   |
| BlockToStepN              | 2.219 ms                  | 76.980 ms                 |
| OneStep                   | 134.865 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:52.281009 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=730
W20240202 23:42:52.443877 50357 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
W20240202 23:42:52.548025 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=290
E20240202 23:42:53.281020 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1685
W20240202 23:42:53.445240 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
W20240202 23:42:54.244544 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=298, pq.top=298
E20240202 23:42:54.281033 50701 parallel_pq_v2.h:79] insert failed, size(hashtable)=77068
W20240202 23:42:54.680177 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
E20240202 23:42:54.894008 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=299, sample_step_cpp_seen_[rank]=298
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 574.698 us                | 9.190 ms                  |
| ProcessBack:Shuffle       | 8.658 ms                  | 23.181 ms                 |
| ProcessBack:UpdateCache   | 10.171 ms                 | 16.623 ms                 |
| ProcessBack:UpsertPq      | 28.096 ms                 | 165.267 ms                |
| ProcessOneStep            | 92.995 ms                 | 1.413 s                   |
| BlockToStepN              | 2.215 ms                  | 76.848 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:42:55.281008 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=2775
[proc 7] 300 steps, total: 22.514, sample: 0.989, forward: 0.565, backward: 0.606, update: 0.261
[proc 3] 300 steps, total: 22.514, sample: 1.225, forward: 0.536, backward: 0.758, update: 0.271
[proc 4] 300 steps, total: 22.514, sample: 1.036, forward: 0.573, backward: 0.751, update: 0.252
[proc 6] 300 steps, total: 22.514, sample: 1.148, forward: 0.537, backward: 0.737, update: 0.281
[proc 2] 300 steps, total: 22.514, sample: 1.519, forward: 0.601, backward: 0.690, update: 0.226
[proc 0] 300 steps, total: 22.514, sample: 1.977, forward: 0.598, backward: 0.617, update: 0.335
[proc 1] 300 steps, total: 22.514, sample: 1.520, forward: 0.557, backward: 0.722, update: 0.239
[proc 5] 300 steps, total: 22.514, sample: 1.052, forward: 0.542, backward: 0.739, update: 0.242
W20240202 23:42:55.700067 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240202 23:42:55.719353 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240202 23:42:56.281009 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=11483
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.456 ms                  | 209.618 ms                |
| Forward                   | 5.595 ms                  | 14.746 ms                 |
| Backward                  | 5.500 ms                  | 11.726 ms                 |
| Optimize                  | 2.695 ms                  | 12.080 ms                 |
| BarrierTimeBeforeRank0    | 2.608 ms                  | 160.580 ms                |
| AfterBackward             | 93.313 ms                 | 1.413 s                   |
| BlockToStepN              | 2.307 ms                  | 76.980 ms                 |
| OneStep                   | 136.060 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:42:56.825521 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240202 23:42:56.941506 50357 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240202 23:42:57.281009 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=586
W20240202 23:42:58.122922 50357 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240202 23:42:58.281010 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=5573
W20240202 23:42:59.218714 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240202 23:42:59.224560 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240202 23:42:59.281009 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=2260
W20240202 23:43:00.244330 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 408.867 us                | 8.576 ms                  |
| ProcessBack:Shuffle       | 8.671 ms                  | 25.674 ms                 |
| ProcessBack:UpdateCache   | 10.209 ms                 | 16.984 ms                 |
| ProcessBack:UpsertPq      | 28.196 ms                 | 165.267 ms                |
| ProcessOneStep            | 93.433 ms                 | 1.413 s                   |
| BlockToStepN              | 2.298 ms                  | 76.848 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:43:00.281029 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=79
W20240202 23:43:00.297564 50357 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240202 23:43:01.040450 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=329, sample_step_cpp_seen_[rank]=328
E20240202 23:43:01.281014 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=4066
W20240202 23:43:01.303145 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.537 ms                  | 209.618 ms                |
| Forward                   | 5.606 ms                  | 14.746 ms                 |
| Backward                  | 5.523 ms                  | 11.829 ms                 |
| Optimize                  | 2.712 ms                  | 12.080 ms                 |
| BarrierTimeBeforeRank0    | 2.428 ms                  | 160.580 ms                |
| AfterBackward             | 93.313 ms                 | 1.413 s                   |
| BlockToStepN              | 2.402 ms                  | 76.980 ms                 |
| OneStep                   | 136.060 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
E20240202 23:43:02.289921 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:43:02.455446 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
W20240202 23:43:02.778720 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=330, pq.top=330
E20240202 23:43:03.289014 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1660
W20240202 23:43:03.590279 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
W20240202 23:43:03.831135 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240202 23:43:04.289011 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=4223
W20240202 23:43:04.638245 50357 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 492.007 us                | 7.799 ms                  |
| ProcessBack:Shuffle       | 8.680 ms                  | 23.181 ms                 |
| ProcessBack:UpdateCache   | 10.130 ms                 | 16.623 ms                 |
| ProcessBack:UpsertPq      | 27.951 ms                 | 164.133 ms                |
| ProcessOneStep            | 93.265 ms                 | 1.424 s                   |
| BlockToStepN              | 2.308 ms                  | 76.848 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:43:05.289023 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=10
W20240202 23:43:05.407567 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=342, pq.top=341
W20240202 23:43:05.685674 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240202 23:43:06.289016 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=163
W20240202 23:43:06.449743 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=348, pq.top=348
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.578 ms                  | 238.223 ms                |
| Forward                   | 5.595 ms                  | 14.746 ms                 |
| Backward                  | 5.541 ms                  | 11.829 ms                 |
| Optimize                  | 2.695 ms                  | 12.080 ms                 |
| BarrierTimeBeforeRank0    | 2.392 ms                  | 160.580 ms                |
| AfterBackward             | 93.313 ms                 | 1.424 s                   |
| BlockToStepN              | 2.414 ms                  | 76.980 ms                 |
| OneStep                   | 136.400 ms                | 1.588 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:43:06.792909 50357 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240202 23:43:07.289007 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=12992
E20240202 23:43:07.428937 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=355, sample_step_cpp_seen_[rank]=354
W20240202 23:43:08.057658 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240202 23:43:08.297241 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:43:09.084462 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240202 23:43:09.131158 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240202 23:43:09.302168 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1736
W20240202 23:43:10.120504 50357 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 484.733 us                | 9.010 ms                  |
| ProcessBack:Shuffle       | 8.752 ms                  | 23.181 ms                 |
| ProcessBack:UpdateCache   | 10.171 ms                 | 16.623 ms                 |
| ProcessBack:UpsertPq      | 28.689 ms                 | 164.133 ms                |
| ProcessOneStep            | 93.176 ms                 | 1.424 s                   |
| BlockToStepN              | 2.341 ms                  | 70.602 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240202 23:43:10.281313 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=365, pq.top=365
E20240202 23:43:10.302014 50702 parallel_pq_v2.h:79] insert failed, size(hashtable)=32307
W20240202 23:43:11.130483 50357 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240202 23:43:11.302011 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=7544
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.905 ms                  | 223.902 ms                |
| Forward                   | 5.593 ms                  | 11.761 ms                 |
| Backward                  | 5.507 ms                  | 11.726 ms                 |
| Optimize                  | 2.688 ms                  | 9.488 ms                  |
| BarrierTimeBeforeRank0    | 2.322 ms                  | 158.974 ms                |
| AfterBackward             | 93.219 ms                 | 1.424 s                   |
| BlockToStepN              | 2.489 ms                  | 70.709 ms                 |
| OneStep                   | 136.675 ms                | 1.562 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:43:12.133354 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240202 23:43:12.298954 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=373, pq.top=373
E20240202 23:43:12.302901 50708 parallel_pq_v2.h:79] insert failed, size(hashtable)=49637
W20240202 23:43:13.241879 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240202 23:43:13.302008 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=4124
W20240202 23:43:13.324414 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=380, pq.top=379
W20240202 23:43:14.247809 50357 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240202 23:43:14.302011 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=194
W20240202 23:43:14.450443 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=389, pq.top=389
E20240202 23:43:14.495322 44962 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=389, sample_step_cpp_seen_[rank]=388
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 499.062 us                | 36.223 ms                 |
| ProcessBack:Shuffle       | 8.852 ms                  | 22.740 ms                 |
| ProcessBack:UpdateCache   | 10.274 ms                 | 16.623 ms                 |
| ProcessBack:UpsertPq      | 28.562 ms                 | 151.090 ms                |
| ProcessOneStep            | 92.995 ms                 | 1.424 s                   |
| BlockToStepN              | 2.483 ms                  | 70.602 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240202 23:43:15.298242 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240202 23:43:15.309026 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:43:15.961174 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=393, pq.top=393
E20240202 23:43:16.309026 50691 parallel_pq_v2.h:79] insert failed, size(hashtable)=60407
W20240202 23:43:16.313975 50357 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.180 ms                  | 223.902 ms                |
| Forward                   | 5.580 ms                  | 11.761 ms                 |
| Backward                  | 5.453 ms                  | 11.726 ms                 |
| Optimize                  | 2.674 ms                  | 9.488 ms                  |
| BarrierTimeBeforeRank0    | 2.380 ms                  | 158.974 ms                |
| AfterBackward             | 93.052 ms                 | 1.424 s                   |
| BlockToStepN              | 2.616 ms                  | 70.709 ms                 |
| OneStep                   | 136.675 ms                | 1.562 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 21.321, sample: 2.491, forward: 0.567, backward: 0.581, update: 0.282
[proc 6] 400 steps, total: 21.321, sample: 1.203, forward: 0.579, backward: 0.803, update: 0.268
[proc 3] 400 steps, total: 21.322, sample: 1.184, forward: 0.542, backward: 0.730, update: 0.269
[proc 5] 400 steps, total: 21.321, sample: 1.013, forward: 0.596, backward: 0.613, update: 0.258
[proc 2] 400 steps, total: 21.321, sample: 1.617, forward: 0.602, backward: 0.659, update: 0.245
[proc 1] 400 steps, total: 21.321, sample: 1.479, forward: 0.563, backward: 0.603, update: 0.248
[proc 4] 400 steps, total: 21.322, sample: 1.101, forward: 0.553, backward: 0.651, update: 0.253
[proc 7] 400 steps, total: 21.322, sample: 1.049, forward: 0.559, backward: 0.709, update: 0.265
W20240202 23:43:16.971946 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=401, pq.top=401
E20240202 23:43:17.309062 50716 parallel_pq_v2.h:79] insert failed, size(hashtable)=59768
W20240202 23:43:17.452275 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240202 23:43:18.309015 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240202 23:43:18.467502 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240202 23:43:18.529559 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240202 23:43:19.309010 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=3055
W20240202 23:43:19.515786 50357 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
W20240202 23:43:19.921125 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=417, pq.top=417
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 454.117 us                | 12.783 ms                 |
| ProcessBack:Shuffle       | 8.854 ms                  | 22.740 ms                 |
| ProcessBack:UpdateCache   | 10.289 ms                 | 16.623 ms                 |
| ProcessBack:UpsertPq      | 28.689 ms                 | 155.422 ms                |
| ProcessOneStep            | 92.995 ms                 | 1.424 s                   |
| BlockToStepN              | 2.495 ms                  | 70.602 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:43:20.309010 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=59848
W20240202 23:43:20.521675 50357 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240202 23:43:20.732374 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=422, sample_step_cpp_seen_[rank]=421
E20240202 23:43:21.309463 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.233 ms                  | 223.902 ms                |
| Forward                   | 5.593 ms                  | 11.761 ms                 |
| Backward                  | 5.483 ms                  | 11.829 ms                 |
| Optimize                  | 2.662 ms                  | 10.898 ms                 |
| BarrierTimeBeforeRank0    | 2.322 ms                  | 158.974 ms                |
| AfterBackward             | 93.052 ms                 | 1.424 s                   |
| BlockToStepN              | 2.623 ms                  | 70.709 ms                 |
| OneStep                   | 136.477 ms                | 1.562 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:43:21.618482 50357 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240202 23:43:22.106436 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=427, pq.top=426
E20240202 23:43:22.309484 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=34964
W20240202 23:43:22.734603 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
W20240202 23:43:23.177534 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=435, pq.top=435
E20240202 23:43:23.309010 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=5937
W20240202 23:43:23.796329 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240202 23:43:24.309013 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=1084
W20240202 23:43:24.801986 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240202 23:43:24.808393 50357 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 471.882 us                | 22.999 ms                 |
| ProcessBack:Shuffle       | 8.876 ms                  | 23.181 ms                 |
| ProcessBack:UpdateCache   | 10.274 ms                 | 16.609 ms                 |
| ProcessBack:UpsertPq      | 28.505 ms                 | 151.090 ms                |
| ProcessOneStep            | 92.856 ms                 | 1.424 s                   |
| BlockToStepN              | 2.547 ms                  | 70.602 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:43:25.309008 44962 parallel_pq_v2.h:79] insert failed, size(hashtable)=2812
W20240202 23:43:25.848641 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=447, pq.top=447
W20240202 23:43:25.866235 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240202 23:43:26.309201 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.041 ms                  | 209.618 ms                |
| Forward                   | 5.595 ms                  | 11.326 ms                 |
| Backward                  | 5.453 ms                  | 11.829 ms                 |
| Optimize                  | 2.686 ms                  | 9.488 ms                  |
| BarrierTimeBeforeRank0    | 2.380 ms                  | 127.819 ms                |
| AfterBackward             | 92.879 ms                 | 1.413 s                   |
| BlockToStepN              | 2.660 ms                  | 70.709 ms                 |
| OneStep                   | 136.477 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
E20240202 23:43:26.747542 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=453, sample_step_cpp_seen_[rank]=452
W20240202 23:43:27.087894 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240202 23:43:27.309051 50710 parallel_pq_v2.h:79] insert failed, size(hashtable)=7051
W20240202 23:43:28.003425 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240202 23:43:28.099682 50357 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240202 23:43:28.309010 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=904
W20240202 23:43:29.099433 50357 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
E20240202 23:43:29.309010 48072 parallel_pq_v2.h:79] insert failed, size(hashtable)=125080
W20240202 23:43:29.769886 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=466, pq.top=465
W20240202 23:43:30.233027 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 560.382 us                | 23.307 ms                 |
| ProcessBack:Shuffle       | 8.875 ms                  | 25.674 ms                 |
| ProcessBack:UpdateCache   | 10.209 ms                 | 16.609 ms                 |
| ProcessBack:UpsertPq      | 28.689 ms                 | 164.133 ms                |
| ProcessOneStep            | 92.995 ms                 | 1.413 s                   |
| BlockToStepN              | 2.579 ms                  | 75.314 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:43:30.309013 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=2279
W20240202 23:43:30.804056 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240202 23:43:31.237144 50357 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240202 23:43:31.309013 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.041 ms                  | 209.618 ms                |
| Forward                   | 5.595 ms                  | 11.326 ms                 |
| Backward                  | 5.453 ms                  | 11.829 ms                 |
| Optimize                  | 2.688 ms                  | 9.488 ms                  |
| BarrierTimeBeforeRank0    | 2.362 ms                  | 127.819 ms                |
| AfterBackward             | 93.021 ms                 | 1.413 s                   |
| BlockToStepN              | 2.686 ms                  | 75.441 ms                 |
| OneStep                   | 136.783 ms                | 1.489 s                   |
+---------------------------+---------------------------+---------------------------+
E20240202 23:43:31.747009 48072 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=475, sample_step_cpp_seen_[rank]=474
W20240202 23:43:32.268918 50357 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240202 23:43:32.309015 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=46
W20240202 23:43:32.697898 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=480, pq.top=480
E20240202 23:43:33.309010 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=985
W20240202 23:43:33.431717 50357 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
W20240202 23:43:34.020267 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=489, pq.top=489
E20240202 23:43:34.309011 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=2848
W20240202 23:43:34.653738 50357 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 524.034 us                | 28.834 ms                 |
| ProcessBack:Shuffle       | 8.883 ms                  | 23.626 ms                 |
| ProcessBack:UpdateCache   | 10.201 ms                 | 16.556 ms                 |
| ProcessBack:UpsertPq      | 28.476 ms                 | 160.204 ms                |
| ProcessOneStep            | 92.995 ms                 | 1.413 s                   |
| BlockToStepN              | 2.628 ms                  | 75.314 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240202 23:43:35.309007 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
W20240202 23:43:35.642745 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=490, pq.top=490
W20240202 23:43:35.691434 50357 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240202 23:43:36.309013 50357 parallel_pq_v2.h:79] insert failed, size(hashtable)=37245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.054 ms                  | 209.618 ms                |
| Forward                   | 5.593 ms                  | 11.761 ms                 |
| Backward                  | 5.404 ms                  | 11.829 ms                 |
| Optimize                  | 2.690 ms                  | 9.488 ms                  |
| BarrierTimeBeforeRank0    | 2.428 ms                  | 127.819 ms                |
| AfterBackward             | 93.052 ms                 | 1.424 s                   |
| BlockToStepN              | 2.799 ms                  | 75.441 ms                 |
| OneStep                   | 136.972 ms                | 1.546 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 23:43:36.699502 44962 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=499, pq.top=499
[proc 1] 500 steps, total: 19.992, sample: 1.389, forward: 0.643, backward: 0.681, update: 0.256
[proc 2] 500 steps, total: 19.992, sample: 1.226, forward: 0.584, backward: 0.662, update: 0.235
[proc 0] 500 steps, total: 19.992, sample: 1.458, forward: 0.608, backward: 0.574, update: 0.295
[proc 3] 500 steps, total: 19.992, sample: 0.849, forward: 0.513, backward: 0.720, update: 0.240
[proc 5] 500 steps, total: 19.992, sample: 0.947, forward: 0.554, backward: 0.629, update: 0.250
[proc 6] 500 steps, total: 19.992, sample: 1.045, forward: 0.552, backward: 0.757, update: 0.246
[proc 7] 500 steps, total: 19.992, sample: 1.041, forward: 0.568, backward: 0.750, update: 0.259
Successfully xmh. training takes 108.08041286468506 seconds
[proc 4] 500 steps, total: 19.992, sample: 0.968, forward: 0.546, backward: 0.665, update: 0.239
before call kg_cache_controller.StopThreads()
W20240202 23:43:36.835465 44962 grad_async_v2.h:84] call StopThreads. PID = 14111
W20240202 23:43:36.835501 44962 grad_base.h:212] before processOneStepNegThread_.join();
W20240202 23:43:36.835884 44962 grad_base.h:214] after processOneStepNegThread_.join();
W20240202 23:43:36.835894 44962 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240202 23:43:36.909826 50357 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
W20240202 23:43:37.308539 44962 grad_async_v2.h:105] StopThreads done.
