WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 22:04:36.579154 43428 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_54', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [43428 sampler.py:454] Start PreSampling
WARNING [43428 sampler.py:532] Before construct renumbering_dict
WARNING [43428 sampler.py:555] PreSampling done
W20240205 22:04:41.318655 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 22:04:41.318874 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 22:04:41.318933 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 22:04:41.318987 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 22:04:41.319029 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 22:04:41.319074 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 22:04:41.319118 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 22:04:41.319169 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 22:04:41.319211 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 22:04:41.319258 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 22:04:41.319309 43428 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 22:04:41.319348 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 22:04:41.319387 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 22:04:41.319528 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 22:04:41.319581 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 22:04:41.319622 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 22:04:41.319694 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 22:04:41.319741 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 22:04:41.319792 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 22:04:41.319837 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 22:04:41.319886 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 22:04:41.319926 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 22:04:41.319983 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 22:04:41.320021 43428 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 22:04:41.320062 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 22:04:41.320099 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 22:04:41.320183 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 22:04:41.320240 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 22:04:41.320278 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 22:04:41.320317 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 22:04:41.320366 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 22:04:41.320415 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 22:04:41.320457 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 22:04:41.320500 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 22:04:41.320549 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 22:04:41.320588 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 22:04:41.320629 43428 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 22:04:41.320663 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 22:04:41.320698 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 22:04:41.320768 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 22:04:41.320818 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 22:04:41.320858 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 22:04:41.320906 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 22:04:41.320950 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 22:04:41.320997 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 22:04:41.321049 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 22:04:41.321105 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 22:04:41.321156 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 22:04:41.321203 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 22:04:41.321245 43428 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 22:04:41.321280 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 22:04:41.321313 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 22:04:41.321390 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 22:04:41.321452 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 22:04:41.321506 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 22:04:41.321547 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 22:04:41.321588 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 22:04:41.321637 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 22:04:41.321682 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 22:04:41.321735 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 22:04:41.321781 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 22:04:41.321826 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 22:04:41.321866 43428 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 22:04:41.321902 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 22:04:41.321935 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 22:04:41.322005 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 22:04:41.322054 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 22:04:41.322095 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 22:04:41.322137 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 22:04:41.322177 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 22:04:41.322219 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 22:04:41.322264 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 22:04:41.322310 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 22:04:41.322360 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 22:04:41.322415 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 22:04:41.322459 43428 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 22:04:41.322494 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 22:04:41.322535 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 22:04:41.322607 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 22:04:41.322659 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 22:04:41.322706 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 22:04:41.322754 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 22:04:41.322811 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 22:04:41.322866 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 22:04:41.322917 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 22:04:41.322962 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 22:04:41.323015 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 22:04:41.323057 43428 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 22:04:41.323109 43428 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 22:04:41.323145 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 22:04:41.323179 43428 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 22:04:41.585614 43428 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x1000216be000 22.81 MB
W20240205 22:04:41.675498 43428 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100022d90000 58.4 kB
{0: Graph(num_nodes=8708, num_edges=114062,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=8851, num_edges=101101,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=6696, num_edges=94778,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10148, num_edges=151271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8972, num_edges=107004,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8551, num_edges=124920,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=9450, num_edges=118501,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8708 N 114062 E
MertisPartition: part 1 has 8851 N 101101 E
MertisPartition: part 2 has 6696 N 94778 E
MertisPartition: part 3 has 10148 N 151271 E
MertisPartition: part 4 has 8972 N 107004 E
MertisPartition: part 5 has 8551 N 124920 E
MertisPartition: part 6 has 9450 N 118501 E
Rank0: cached key size 106
Rank1: cached key size 106
Rank2: cached key size 106
Rank3: cached key size 106
Rank4: cached key size 106
Rank5: cached key size 106
Rank6: cached key size 106
Before renumbering graph:  {'_ID': tensor([    7,    16,    18,  ..., 13890,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 5, 1])}
After renumbering graph:  {'_ID': tensor([  879,  1059,  1100,  ...,  9351,  1934, 11337]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 5, 1])}
part_g: DGLGraph(num_nodes=8708, num_edges=114062,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8708, num_edges=114062,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.195 seconds
[Rank1] pid = 43632
[Rank2] pid = 43656
[Rank3] pid = 43760
[Rank4] pid = 43812
[Rank5] pid = 43888
INFO [43428 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [43632 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [43656 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [43760 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [43888 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [43812 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [43952 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [43428 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [43632 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [43760 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [43888 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [43656 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [43812 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [43952 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
W20240205 22:04:44.086056 43953 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240205 22:04:44.087105 43889 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240205 22:04:44.087191 43825 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240205 22:04:44.087193 44017 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240205 22:04:44.087194 43761 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240205 22:04:44.087304 43697 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240205 22:04:44.087317 43633 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240205 22:04:44.114836 43825 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100022da6000 7.629 MB
W20240205 22:04:44.114843 43889 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100023549000 7.629 MB
W20240205 22:04:44.114861 44017 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100023cec000 7.629 MB
W20240205 22:04:44.115067 43825 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10002448f000 7.629 MB
W20240205 22:04:44.115072 44017 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100024c32000 7.629 MB
W20240205 22:04:44.115094 43889 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1000253d5000 7.629 MB
W20240205 22:04:44.115154 43825 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x100025b78000 1.49 GB
W20240205 22:04:44.115161 44017 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10008515b000 1.49 GB
W20240205 22:04:44.115180 43889 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1000e473e000 1.49 GB
W20240205 22:04:44.115218 43825 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x100143d21000 1.49 GB
W20240205 22:04:44.115227 43889 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1001a3304000 1.49 GB
W20240205 22:04:44.115245 44017 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1002028e7000 1.49 GB
W20240205 22:04:44.115285 43825 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 22:04:44.115294 44017 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 22:04:44.115294 43889 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 22:04:44.123525 43825 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 22:04:44.123539 44017 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 22:04:44.123556 43889 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 22:04:44.123683 43953 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100261ed8000 7.629 MB
W20240205 22:04:44.123785 43761 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10026267b000 7.629 MB
W20240205 22:04:44.123800 43953 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100262e1e000 7.629 MB
W20240205 22:04:44.123869 43953 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100264507000 1.49 GB
W20240205 22:04:44.123862 43633 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1002635c1000 7.629 MB
W20240205 22:04:44.123868 43697 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100263d64000 7.629 MB
W20240205 22:04:44.123915 43953 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1002c3aea000 1.49 GB
W20240205 22:04:44.123957 43953 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 22:04:44.123966 43761 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1003230cd000 7.629 MB
W20240205 22:04:44.124037 43761 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100323870000 1.49 GB
W20240205 22:04:44.124066 43633 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100382e53000 7.629 MB
W20240205 22:04:44.124074 43697 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1003835f6000 7.629 MB
W20240205 22:04:44.124125 43761 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100383d99000 1.49 GB
W20240205 22:04:44.124179 43761 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 22:04:44.124181 43697 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1003e337c000 1.49 GB
W20240205 22:04:44.124190 43633 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10044295f000 1.49 GB
W20240205 22:04:44.124246 43697 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1004a1f42000 1.49 GB
W20240205 22:04:44.124270 43633 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100501525000 1.49 GB
W20240205 22:04:44.124312 43697 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 22:04:44.124330 43633 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 22:04:44.136922 43953 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 22:04:44.136958 43697 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 22:04:44.136968 43633 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 22:04:44.136986 43761 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x1000216be000
4: KnownLocalCachedEmbedding init done
WARNING [43812 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
5: KnownLocalCachedEmbedding init done
WARNING [43888 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
1: KnownLocalCachedEmbedding init done
WARNING [43632 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x1000216be000
2: KnownLocalCachedEmbedding init done
WARNING [43952 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [43656 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
3: KnownLocalCachedEmbedding init done
WARNING [43760 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank6] pid = 43952
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229)]
cudaHostRegister 0x1000216be000
0: KnownLocalCachedEmbedding init done
WARNING [43428 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 22:04:45.906428 43953 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240205 22:04:45.906754 44017 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 22:04:45.906970 43889 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 22:04:45.907260 43697 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 22:04:45.907374 43825 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 22:04:45.907481 43761 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240205 22:04:45.907603 43633 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
W20240205 22:04:45.910943 43953 grad_base.h:55] KGCacheController, config={
        "num_gpus": 7,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 22:04:45.911070 43953 grad_base.h:184] Init GradProcessingBase done
I20240205 22:04:45.915700 43953 grad_async_v2.h:42] Use main thread to update emb.
W20240205 22:04:45.915750 43953 kg_controller.h:78] after init GradAsyncProcessingV2
I20240205 22:04:45.915760 43953 kg_controller.h:84] Construct KGCacheController done
E20240205 22:04:46.606295 43697 recstore.cc:66] init folly done
E20240205 22:04:46.606369 43825 recstore.cc:66] init folly done
E20240205 22:04:46.606402 44017 recstore.cc:66] init folly done
E20240205 22:04:46.606564 43889 recstore.cc:66] init folly done
E20240205 22:04:46.606693 43953 recstore.cc:66] init folly done
E20240205 22:04:46.606716 43761 recstore.cc:66] init folly done
E20240205 22:04:46.606855 43633 recstore.cc:66] init folly done
I20240205 22:04:46.607981 43953 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240205 22:04:47.277001 44492 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 22:04:47.277453 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240205 22:04:47.310690 43633 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240205 22:04:47.314532 43697 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 22:04:47.315912 43825 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 22:04:47.317204 44017 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 22:04:47.320200 43761 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 22:04:47.321122 43953 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240205 22:04:47.324664 43889 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
E20240205 22:04:49.292898 43953 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240205 22:04:49.344139 44492 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240205 22:04:49.387470 43953 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=1, sample_step_cpp_seen_[rank]=0
W20240205 22:04:50.032115 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=11, pq.top=11
E20240205 22:04:50.292012 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=658
W20240205 22:04:50.382328 44492 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.445 ms                  | 30.299 ms                 |
| Forward                   | 6.394 ms                  | 436.995 ms                |
| Backward                  | 4.704 ms                  | 217.660 ms                |
| Optimize                  | 2.731 ms                  | 47.123 ms                 |
| BarrierTimeBeforeRank0    | 3.080 ms                  | 69.032 ms                 |
| AfterBackward             | 40.039 ms                 | 1.244 s                   |
| BlockToStepN              | 71.329 us                 | 11.383 ms                 |
| OneStep                   | 60.794 ms                 | 2.018 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 22:04:51.072449 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=20, pq.top=20
E20240205 22:04:51.292052 44511 parallel_pq_v2.h:79] insert failed, size(hashtable)=7622
W20240205 22:04:51.396108 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 288.360 us                | 6.357 ms                  |
| ProcessBack:Shuffle       | 7.044 ms                  | 318.736 ms                |
| ProcessBack:UpdateCache   | 7.144 ms                  | 640.177 ms                |
| ProcessBack:UpsertPq      | 28.024 ms                 | 69.679 ms                 |
| ProcessOneStep            | 42.193 ms                 | 1.243 s                   |
| BlockToStepN              | 29.018 us                 | 11.332 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240205 22:04:52.190208 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=31, pq.top=31
E20240205 22:04:52.292068 44507 parallel_pq_v2.h:79] insert failed, size(hashtable)=6313
W20240205 22:04:52.408711 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240205 22:04:53.253000 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=42, pq.top=42
E20240205 22:04:53.292246 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=317
W20240205 22:04:53.415488 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
W20240205 22:04:54.289326 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=57, pq.top=57
E20240205 22:04:54.293090 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=17
W20240205 22:04:54.498396 44492 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
E20240205 22:04:54.890040 44167 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=66, sample_step_cpp_seen_[rank]=65
W20240205 22:04:55.580555 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
E20240205 22:04:55.667171 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 22:04:55.701618 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.620 ms                  | 30.401 ms                 |
| Forward                   | 6.191 ms                  | 13.708 ms                 |
| Backward                  | 4.719 ms                  | 7.611 ms                  |
| Optimize                  | 2.806 ms                  | 5.522 ms                  |
| BarrierTimeBeforeRank0    | 1.861 ms                  | 13.296 ms                 |
| AfterBackward             | 47.513 ms                 | 823.207 ms                |
| BlockToStepN              | 297.878 us                | 6.084 ms                  |
| OneStep                   | 68.500 ms                 | 840.752 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 22:04:56.585883 44492 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 297.692 us                | 10.845 ms                 |
| ProcessBack:Shuffle       | 7.044 ms                  | 19.390 ms                 |
| ProcessBack:UpdateCache   | 7.448 ms                  | 12.162 ms                 |
| ProcessBack:UpsertPq      | 32.162 ms                 | 67.071 ms                 |
| ProcessOneStep            | 47.584 ms                 | 823.152 ms                |
| BlockToStepN              | 240.526 us                | 6.008 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 22:04:56.667052 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=691
W20240205 22:04:56.763937 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240205 22:04:57.591032 44492 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240205 22:04:57.667011 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=209
W20240205 22:04:57.802860 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=91, pq.top=91
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 11.158, sample: 0.426, forward: 1.072, backward: 0.905, update: 0.297
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 11.166, sample: 0.445, forward: 0.986, backward: 0.801, update: 0.282
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 11.162, sample: 0.427, forward: 0.974, backward: 0.910, update: 0.286
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 11.168, sample: 0.399, forward: 0.989, backward: 0.666, update: 0.276
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 11.165, sample: 0.450, forward: 1.001, backward: 0.705, update: 0.298
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 11.172, sample: 0.454, forward: 1.067, backward: 0.796, update: 0.295
train_sampler.Prefill()
-------Step 0-------
tensor([ 3055,  4795, 10890, 12470,  6729, 13537,  3135,     0,     8, 10595]) tensor([ 1100,  8974,  1909, 12164,    25,  7348,   284,  3408,  9117, 12525])
-------Step 1-------
tensor([ 3055,  4795, 10890, 12470,  6729, 13537,  3135,     0,     8, 10595]) tensor([12849,  9126,  4012, 14642, 10253,  9360,  1882,  1407,   539,  6101])
-------Step 2-------
tensor([ 3348, 11425,  3126, 14332, 12604, 10726,  4363, 14768,  7287,    25]) tensor([ 3696,  9086, 10157,  5123,  9118, 13391,  8915,  8157,  9049, 11903])
-------Step 3-------
tensor([ 3348, 11425,  3126, 14332, 12604, 10726,  4363, 14768,  7287,    25]) tensor([ 5446, 13259,   569,  5018,  2103,   925,  7879, 11674,  3812, 10487])
-------Step 4-------
tensor([13671, 10529,  7856,  6974,  3870,   927, 12577,  8005, 10577,  2082]) tensor([10100,  9387,  2798,  1080, 13761,  6517, 12629,  9577,  3055,  6114])
-------Step 5-------
tensor([13671, 10529,  7856,  6974,  3870,   927, 12577,  8005, 10577,  2082]) tensor([ 4884,  7190,  7921,  4475,  3354, 14162, 10499, 11334,  2324,  2552])
-------Step 6-------
tensor([   27,   926, 12813,  1236,  3431,  2553,  8536, 12439, 11402,    50]) tensor([ 5246,  1130,  7525, 13687,   194,  2955,  6220, 10527,  3937,  5176])
-------Step 7-------
tensor([   27,   926, 12813,  1236,  3431,  2553,  8536, 12439, 11402,    50]) tensor([ 4045,  6559,  5156,  2012, 10251,  4318,  2925,  5244,  8087,    93])
-------Step 8-------
tensor([ 5372, 14086, 13208,   879,  1771,  3118,  3489, 11255,  8464,  2823]) tensor([ 1565,  1065, 11551, 13079,  8243,  8165,  5283,  9254,  8715,  1129])
-------Step 9-------
tensor([ 5372, 14086, 13208,   879,  1771,  3118,  3489, 11255,  8464,  2823]) tensor([ 4708,  6329,  9502, 10764,  1848,  9794, 13352,  3610, 11894,  6280])
before start barrier
start train
[proc 0] 100 steps, total: 11.161, sample: 0.492, forward: 1.069, backward: 0.685, update: 0.320
W20240205 22:04:58.622581 44492 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240205 22:04:58.667075 44500 parallel_pq_v2.h:79] insert failed, size(hashtable)=10289
W20240205 22:04:58.917487 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240205 22:04:59.634730 44492 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 22:04:59.667021 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=544
W20240205 22:04:59.993274 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=115, pq.top=115
E20240205 22:05:00.667021 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=2382
W20240205 22:05:00.822105 44492 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.685 ms                  | 32.136 ms                 |
| Forward                   | 5.974 ms                  | 13.708 ms                 |
| Backward                  | 4.574 ms                  | 7.611 ms                  |
| Optimize                  | 2.791 ms                  | 9.473 ms                  |
| BarrierTimeBeforeRank0    | 2.801 ms                  | 32.890 ms                 |
| AfterBackward             | 47.513 ms                 | 823.207 ms                |
| BlockToStepN              | 546.261 us                | 6.084 ms                  |
| OneStep                   | 78.504 ms                 | 840.752 ms                |
+---------------------------+---------------------------+---------------------------+
E20240205 22:05:00.928320 43953 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=126, sample_step_cpp_seen_[rank]=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 337.305 us                | 6.889 ms                  |
| ProcessBack:Shuffle       | 7.064 ms                  | 16.119 ms                 |
| ProcessBack:UpdateCache   | 7.587 ms                  | 13.766 ms                 |
| ProcessBack:UpsertPq      | 31.851 ms                 | 55.828 ms                 |
| ProcessOneStep            | 47.524 ms                 | 823.152 ms                |
| BlockToStepN              | 472.922 us                | 6.008 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 22:05:01.667008 43953 parallel_pq_v2.h:79] insert failed, size(hashtable)=907
W20240205 22:05:01.787325 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=132, pq.top=132
W20240205 22:05:01.832212 44492 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240205 22:05:02.667068 43953 parallel_pq_v2.h:79] insert failed, size(hashtable)=83
W20240205 22:05:02.843410 44492 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240205 22:05:02.915040 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=143, pq.top=143
E20240205 22:05:03.667032 44516 parallel_pq_v2.h:79] insert failed, size(hashtable)=8794
W20240205 22:05:03.923647 44492 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
W20240205 22:05:04.534610 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=159, pq.top=159
E20240205 22:05:04.667016 44496 parallel_pq_v2.h:79] insert failed, size(hashtable)=11639
W20240205 22:05:04.930577 44492 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
W20240205 22:05:05.641198 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=170, pq.top=170
E20240205 22:05:05.667078 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=60
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.671 ms                  | 30.911 ms                 |
| Forward                   | 5.819 ms                  | 10.117 ms                 |
| Backward                  | 4.525 ms                  | 7.611 ms                  |
| Optimize                  | 2.724 ms                  | 5.522 ms                  |
| BarrierTimeBeforeRank0    | 3.663 ms                  | 32.890 ms                 |
| AfterBackward             | 49.935 ms                 | 471.958 ms                |
| BlockToStepN              | 671.553 us                | 5.273 ms                  |
| OneStep                   | 86.972 ms                 | 493.053 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 22:05:05.936671 44492 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 340.177 us                | 10.523 ms                 |
| ProcessBack:Shuffle       | 7.200 ms                  | 11.363 ms                 |
| ProcessBack:UpdateCache   | 7.790 ms                  | 13.844 ms                 |
| ProcessBack:UpsertPq      | 33.814 ms                 | 55.828 ms                 |
| ProcessOneStep            | 50.190 ms                 | 471.749 ms                |
| BlockToStepN              | 628.340 us                | 5.203 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 22:05:06.666762 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=180, pq.top=180
E20240205 22:05:06.667245 44521 parallel_pq_v2.h:79] insert failed, size(hashtable)=707
W20240205 22:05:06.951706 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240205 22:05:07.667016 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=1963
W20240205 22:05:07.672534 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240205 22:05:07.977608 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
[proc 1] 200 steps, total: 10.150, sample: 0.420, forward: 0.528, backward: 0.635, update: 0.233
[proc 2] 200 steps, total: 10.150, sample: 0.427, forward: 0.538, backward: 0.477, update: 0.209
[proc 5] 200 steps, total: 10.150, sample: 0.462, forward: 0.536, backward: 0.602, update: 0.245
[proc 0] 200 steps, total: 10.150, sample: 0.508, forward: 0.551, backward: 0.440, update: 0.261
[proc 6] 200 steps, total: 10.150, sample: 0.477, forward: 0.564, backward: 0.546, update: 0.246
[proc 4] 200 steps, total: 10.150, sample: 0.388, forward: 0.522, backward: 0.584, update: 0.225
[proc 3] 200 steps, total: 10.150, sample: 0.453, forward: 0.525, backward: 0.631, update: 0.238
E20240205 22:05:08.667407 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=46
W20240205 22:05:08.985103 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240205 22:05:09.010345 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=204, pq.top=204
E20240205 22:05:09.667045 44507 parallel_pq_v2.h:79] insert failed, size(hashtable)=10078
W20240205 22:05:09.985126 44492 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
W20240205 22:05:10.043365 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=218, pq.top=218
E20240205 22:05:10.434144 44167 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=222, sample_step_cpp_seen_[rank]=221
E20240205 22:05:10.734151 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.705 ms                  | 31.804 ms                 |
| Forward                   | 5.724 ms                  | 10.117 ms                 |
| Backward                  | 4.522 ms                  | 7.611 ms                  |
| Optimize                  | 2.718 ms                  | 5.522 ms                  |
| BarrierTimeBeforeRank0    | 3.924 ms                  | 41.223 ms                 |
| AfterBackward             | 50.340 ms                 | 471.958 ms                |
| BlockToStepN              | 753.355 us                | 5.273 ms                  |
| OneStep                   | 88.017 ms                 | 493.053 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 22:05:10.997629 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240205 22:05:11.457270 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 330.701 us                | 11.473 ms                 |
| ProcessBack:Shuffle       | 7.296 ms                  | 11.348 ms                 |
| ProcessBack:UpdateCache   | 7.671 ms                  | 13.766 ms                 |
| ProcessBack:UpsertPq      | 33.615 ms                 | 55.828 ms                 |
| ProcessOneStep            | 50.030 ms                 | 574.015 ms                |
| BlockToStepN              | 669.243 us                | 5.203 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 22:05:11.734130 44512 parallel_pq_v2.h:79] insert failed, size(hashtable)=7240
W20240205 22:05:12.018000 44492 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
W20240205 22:05:12.524474 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=243, pq.top=243
E20240205 22:05:12.734009 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=944
W20240205 22:05:13.034885 44492 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end1
W20240205 22:05:13.707618 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=252, pq.top=252
E20240205 22:05:13.734014 44500 parallel_pq_v2.h:79] insert failed, size(hashtable)=7589
W20240205 22:05:14.044183 44492 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240205 22:05:14.734009 44512 parallel_pq_v2.h:79] insert failed, size(hashtable)=11251
W20240205 22:05:14.765342 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240205 22:05:15.048960 44492 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240205 22:05:15.734038 44496 parallel_pq_v2.h:79] insert failed, size(hashtable)=8489
W20240205 22:05:15.788856 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=278, pq.top=278
E20240205 22:05:15.819932 43953 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=278, sample_step_cpp_seen_[rank]=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.765 ms                  | 31.804 ms                 |
| Forward                   | 5.691 ms                  | 9.837 ms                  |
| Backward                  | 4.500 ms                  | 7.524 ms                  |
| Optimize                  | 2.701 ms                  | 5.416 ms                  |
| BarrierTimeBeforeRank0    | 3.815 ms                  | 35.090 ms                 |
| AfterBackward             | 49.163 ms                 | 574.147 ms                |
| BlockToStepN              | 769.515 us                | 3.684 ms                  |
| OneStep                   | 86.593 ms                 | 605.765 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 22:05:16.126855 44492 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 339.846 us                | 15.516 ms                 |
| ProcessBack:Shuffle       | 7.296 ms                  | 11.041 ms                 |
| ProcessBack:UpdateCache   | 7.581 ms                  | 13.766 ms                 |
| ProcessBack:UpsertPq      | 32.742 ms                 | 55.801 ms                 |
| ProcessOneStep            | 48.794 ms                 | 574.015 ms                |
| BlockToStepN              | 689.959 us                | 3.601 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 22:05:16.734035 44504 parallel_pq_v2.h:79] insert failed, size(hashtable)=4808
W20240205 22:05:16.822583 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240205 22:05:17.142032 44492 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240205 22:05:17.734009 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=312
W20240205 22:05:17.870527 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 1] 300 steps, total: 9.239, sample: 0.418, forward: 0.517, backward: 0.722, update: 0.230
[proc 4] 300 steps, total: 9.239, sample: 0.428, forward: 0.521, backward: 0.484, update: 0.230
[proc 0] 300 steps, total: 9.239, sample: 0.567, forward: 0.545, backward: 0.437, update: 0.259
[proc 5] 300 steps, total: 9.239, sample: 0.403, forward: 0.530, backward: 0.654, update: 0.243
[proc 6] 300 steps, total: 9.239, sample: 0.435, forward: 0.528, backward: 0.692, update: 0.226
[proc 2] 300 steps, total: 9.240, sample: 0.399, forward: 0.541, backward: 0.410, update: 0.224
[proc 3] 300 steps, total: 9.240, sample: 0.462, forward: 0.526, backward: 0.577, update: 0.241
W20240205 22:05:18.206378 44492 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240205 22:05:18.734019 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=494
W20240205 22:05:19.212607 44492 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240205 22:05:19.351018 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=313, pq.top=313
E20240205 22:05:19.734010 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=1498
W20240205 22:05:20.369021 44492 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
W20240205 22:05:20.403690 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=326, pq.top=326
E20240205 22:05:20.734109 44497 parallel_pq_v2.h:79] insert failed, size(hashtable)=164
E20240205 22:05:20.819007 43953 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=326, sample_step_cpp_seen_[rank]=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.780 ms                  | 31.804 ms                 |
| Forward                   | 5.663 ms                  | 9.837 ms                  |
| Backward                  | 4.484 ms                  | 7.611 ms                  |
| Optimize                  | 2.689 ms                  | 5.416 ms                  |
| BarrierTimeBeforeRank0    | 3.939 ms                  | 39.394 ms                 |
| AfterBackward             | 48.738 ms                 | 574.147 ms                |
| BlockToStepN              | 773.703 us                | 5.273 ms                  |
| OneStep                   | 85.353 ms                 | 605.765 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 22:05:21.393200 44492 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
W20240205 22:05:21.469532 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=331, pq.top=331
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 293.934 us                | 8.203 ms                  |
| ProcessBack:Shuffle       | 7.295 ms                  | 10.992 ms                 |
| ProcessBack:UpdateCache   | 7.541 ms                  | 13.630 ms                 |
| ProcessBack:UpsertPq      | 32.440 ms                 | 55.684 ms                 |
| ProcessOneStep            | 48.660 ms                 | 589.880 ms                |
| BlockToStepN              | 704.742 us                | 5.203 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240205 22:05:21.734045 44522 parallel_pq_v2.h:79] insert failed, size(hashtable)=9409
W20240205 22:05:22.400082 44492 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240205 22:05:22.744406 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 22:05:23.079448 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240205 22:05:23.425232 44492 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
E20240205 22:05:23.744055 44506 parallel_pq_v2.h:79] insert failed, size(hashtable)=10726
W20240205 22:05:24.108868 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=358, pq.top=358
W20240205 22:05:24.492867 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240205 22:05:24.794970 44492 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 22:05:25.231114 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240205 22:05:25.519910 44492 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
E20240205 22:05:25.794015 44520 parallel_pq_v2.h:79] insert failed, size(hashtable)=4978
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.826 ms                  | 31.970 ms                 |
| Forward                   | 5.650 ms                  | 9.370 ms                  |
| Backward                  | 4.461 ms                  | 7.611 ms                  |
| Optimize                  | 2.684 ms                  | 5.411 ms                  |
| BarrierTimeBeforeRank0    | 4.485 ms                  | 38.887 ms                 |
| AfterBackward             | 48.151 ms                 | 589.930 ms                |
| BlockToStepN              | 814.526 us                | 3.712 ms                  |
| OneStep                   | 84.653 ms                 | 630.533 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 22:05:26.533262 44492 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 336.705 us                | 11.053 ms                 |
| ProcessBack:Shuffle       | 7.315 ms                  | 10.870 ms                 |
| ProcessBack:UpdateCache   | 7.516 ms                  | 12.162 ms                 |
| ProcessBack:UpsertPq      | 31.876 ms                 | 55.519 ms                 |
| ProcessOneStep            | 47.953 ms                 | 589.880 ms                |
| BlockToStepN              | 740.196 us                | 3.630 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 22:05:26.737597 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=384, pq.top=384
E20240205 22:05:26.794011 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=1344
W20240205 22:05:27.596486 44492 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240205 22:05:27.609383 43953 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=394, sample_step_cpp_seen_[rank]=393
E20240205 22:05:28.092034 43953 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240205 22:05:28.125599 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=395, pq.top=395
[proc 2] 400 steps, total: 10.677, sample: 0.417, forward: 0.533, backward: 0.429, update: 0.212
[proc 0] 400 steps, total: 10.677, sample: 0.539, forward: 0.539, backward: 0.428, update: 0.260
[proc 5] 400 steps, total: 10.677, sample: 0.434, forward: 0.523, backward: 0.671, update: 0.236
[proc 6] 400 steps, total: 10.677, sample: 0.430, forward: 0.526, backward: 0.707, update: 0.232
[proc 1] 400 steps, total: 10.677, sample: 0.430, forward: 0.525, backward: 0.685, update: 0.246
[proc 3] 400 steps, total: 10.677, sample: 0.405, forward: 0.542, backward: 0.752, update: 0.230
[proc 4] 400 steps, total: 10.677, sample: 0.425, forward: 0.538, backward: 0.497, update: 0.225
W20240205 22:05:28.603366 44492 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240205 22:05:29.092067 43953 parallel_pq_v2.h:79] insert failed, size(hashtable)=1705
W20240205 22:05:29.188611 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=408, pq.top=408
W20240205 22:05:29.619514 44492 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240205 22:05:30.092010 43953 parallel_pq_v2.h:79] insert failed, size(hashtable)=216
W20240205 22:05:30.209542 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=420, pq.top=420
W20240205 22:05:30.623570 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.867 ms                  | 32.136 ms                 |
| Forward                   | 5.628 ms                  | 9.370 ms                  |
| Backward                  | 4.443 ms                  | 7.611 ms                  |
| Optimize                  | 2.685 ms                  | 5.411 ms                  |
| BarrierTimeBeforeRank0    | 5.266 ms                  | 38.887 ms                 |
| AfterBackward             | 47.954 ms                 | 589.930 ms                |
| BlockToStepN              | 860.900 us                | 3.712 ms                  |
| OneStep                   | 84.844 ms                 | 630.533 ms                |
+---------------------------+---------------------------+---------------------------+
E20240205 22:05:31.092077 44515 parallel_pq_v2.h:79] insert failed, size(hashtable)=10220
W20240205 22:05:31.243096 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=432, pq.top=432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 327.754 us                | 9.454 ms                  |
| ProcessBack:Shuffle       | 7.337 ms                  | 10.821 ms                 |
| ProcessBack:UpdateCache   | 7.521 ms                  | 12.015 ms                 |
| ProcessBack:UpsertPq      | 31.908 ms                 | 55.117 ms                 |
| ProcessOneStep            | 47.915 ms                 | 589.880 ms                |
| BlockToStepN              | 794.881 us                | 3.636 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 22:05:31.631902 44492 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240205 22:05:32.092087 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=52
W20240205 22:05:32.276482 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240205 22:05:32.648860 44492 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240205 22:05:33.092010 44515 parallel_pq_v2.h:79] insert failed, size(hashtable)=9530
E20240205 22:05:33.291442 43953 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=457, sample_step_cpp_seen_[rank]=456
W20240205 22:05:33.713850 44492 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
W20240205 22:05:33.813071 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=458, pq.top=458
E20240205 22:05:34.092026 44523 parallel_pq_v2.h:79] insert failed, size(hashtable)=6391
W20240205 22:05:34.798419 44492 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
W20240205 22:05:34.839536 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=471, pq.top=471
E20240205 22:05:35.092010 44167 parallel_pq_v2.h:79] insert failed, size(hashtable)=2129
W20240205 22:05:35.807710 44492 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.873 ms                  | 32.136 ms                 |
| Forward                   | 5.583 ms                  | 9.264 ms                  |
| Backward                  | 4.440 ms                  | 7.579 ms                  |
| Optimize                  | 2.673 ms                  | 5.039 ms                  |
| BarrierTimeBeforeRank0    | 5.266 ms                  | 35.090 ms                 |
| AfterBackward             | 47.991 ms                 | 574.147 ms                |
| BlockToStepN              | 896.245 us                | 5.273 ms                  |
| OneStep                   | 84.844 ms                 | 605.765 ms                |
+---------------------------+---------------------------+---------------------------+
E20240205 22:05:36.092010 43953 parallel_pq_v2.h:79] insert failed, size(hashtable)=1072
W20240205 22:05:36.393143 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=487, pq.top=487
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 335.219 us                | 19.227 ms                 |
| ProcessBack:Shuffle       | 7.308 ms                  | 10.608 ms                 |
| ProcessBack:UpdateCache   | 7.529 ms                  | 11.871 ms                 |
| ProcessBack:UpsertPq      | 31.883 ms                 | 54.784 ms                 |
| ProcessOneStep            | 47.915 ms                 | 574.015 ms                |
| BlockToStepN              | 831.015 us                | 6.008 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240205 22:05:36.823266 44492 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
E20240205 22:05:37.092031 44494 parallel_pq_v2.h:79] insert failed, size(hashtable)=12821
W20240205 22:05:37.487138 43953 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 6] 500 steps, total: 8.940, sample: 0.423, forward: 0.516, backward: 0.701, update: 0.232
[proc 4] 500 steps, total: 8.940, sample: 0.422, forward: 0.504, backward: 0.501, update: 0.228
[proc 1] 500 steps, total: 8.940, sample: 0.406, forward: 0.509, backward: 0.716, update: 0.232
[proc 0] 500 steps, total: 8.940, sample: 0.538, forward: 0.523, backward: 0.425, update: 0.252
[proc 5] 500 steps, total: 8.940, sample: 0.396, forward: 0.516, backward: 0.587, update: 0.235
[proc 3] 500 steps, total: 8.940, sample: 0.418, forward: 0.510, backward: 0.698, update: 0.233
Successfully xmh. training takes 50.16757559776306 seconds
[proc 2] 500 steps, total: 8.940, sample: 0.387, forward: 0.526, backward: 0.428, update: 0.218
before call kg_cache_controller.StopThreads()
W20240205 22:05:37.488791 43953 grad_async_v2.h:84] call StopThreads. PID = 43428
W20240205 22:05:37.488814 43953 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 22:05:37.489235 43953 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 22:05:37.489251 43953 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
