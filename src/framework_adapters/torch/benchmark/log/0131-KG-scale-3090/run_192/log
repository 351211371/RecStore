WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 06:17:13.571233  6837 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_136', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Partitoning with metis
[06:34:40] /home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 86054151 nodes and 421063214 edges into 7 parts and get 28763153 edge cuts
WARNING [6837 sampler.py:454] Start PreSampling
WARNING [6837 sampler.py:532] Before construct renumbering_dict
WARNING [6837 sampler.py:555] PreSampling done
W20240206 06:45:33.897740  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 06:45:33.897936  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 06:45:33.897975  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 06:45:33.898011  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 06:45:33.898037  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 06:45:33.898067  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 06:45:33.898105  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 06:45:33.898149  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 06:45:33.898182  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 06:45:33.898211  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 06:45:33.898247  6837 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 06:45:33.898276  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 06:45:33.898301  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 06:45:33.898458  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 06:45:33.898511  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 06:45:33.898538  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 06:45:33.898579  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 06:45:33.898614  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 06:45:33.898643  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 06:45:33.898677  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 06:45:33.898708  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 06:45:33.898736  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 06:45:33.898777  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 06:45:33.898806  6837 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 06:45:33.898833  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 06:45:33.898857  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 06:45:33.898922  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 06:45:33.898959  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 06:45:33.898985  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 06:45:33.899025  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 06:45:33.899058  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 06:45:33.899086  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 06:45:33.899119  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 06:45:33.899152  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 06:45:33.899190  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 06:45:33.899228  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 06:45:33.899259  6837 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 06:45:33.899281  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 06:45:33.899305  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 06:45:33.899363  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 06:45:33.899408  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 06:45:33.899434  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 06:45:33.899463  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 06:45:33.899492  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 06:45:33.899529  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 06:45:33.899564  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 06:45:33.899600  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 06:45:33.899628  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 06:45:33.899664  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 06:45:33.899703  6837 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 06:45:33.899727  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 06:45:33.899751  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 06:45:33.899809  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 06:45:33.899839  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 06:45:33.899871  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 06:45:33.899902  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 06:45:33.899932  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 06:45:33.899966  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 06:45:33.899997  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 06:45:33.900027  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 06:45:33.900074  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 06:45:33.900103  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 06:45:33.900139  6837 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 06:45:33.900164  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 06:45:33.900188  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 06:45:33.900249  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 06:45:33.900279  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 06:45:33.900312  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 06:45:33.900346  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 06:45:33.900380  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 06:45:33.900414  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 06:45:33.900446  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 06:45:33.900477  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 06:45:33.900506  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 06:45:33.900543  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 06:45:33.900571  6837 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 06:45:33.900596  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 06:45:33.900626  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 06:45:33.900677  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 06:45:33.900712  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 06:45:33.900740  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 06:45:33.900768  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 06:45:33.900797  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 06:45:33.900837  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 06:45:33.900873  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 06:45:33.900903  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 06:45:33.900943  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 06:45:33.900978  6837 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 06:45:33.901005  6837 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 06:45:33.901031  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 06:45:33.901053  6837 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 06:45:34.794721  6837 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000216be000 128.2 GB
W20240206 06:54:08.875553  6837 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020302f6000 328.3 MB
Convert a graph into a bidirected graph: 53.435 seconds, peak memory: 265.175 GB
Construct multi-constraint weights: 0.001 seconds, peak memory: 265.175 GB
Metis partitioning: 467.007 seconds, peak memory: 276.617 GB
Split the graph: 92.880 seconds
Construct subgraphs: 19.323 seconds
MertisPartition: part 0 has 15380073 N 42467395 E
MertisPartition: part 1 has 16359015 N 65830196 E
MertisPartition: part 2 has 16649310 N 43584356 E
MertisPartition: part 3 has 13918614 N 50952482 E
MertisPartition: part 4 has 14713191 N 52450022 E
MertisPartition: part 5 has 14150782 N 58077216 E
MertisPartition: part 6 has 21311359 N 64967677 E
Rank0: cached key size 614672
Rank1: cached key size 614672
Rank2: cached key size 614672
Rank3: cached key size 614672
Rank4: cached key size 614672
Rank5: cached key size 614672
Rank6: cached key size 614672
Before renumbering graph:  {'_ID': tensor([     239,      240,      329,  ..., 86019793, 84488282, 82976992]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4310727,  4310761,  4313740,  ..., 85846172, 45027306, 64196499]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2720.271 seconds
[Rank1] pid = 8333
[Rank2] pid = 8427
[Rank3] pid = 8496
[Rank4] pid = 8563
[Rank5] pid = 8630
INFO [6837 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [8333 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [8427 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [8630 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [8496 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [8563 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [8699 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [8563 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [8496 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [8630 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [8699 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [6837 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [8427 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [8333 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
W20240206 07:02:44.899302  8564 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240206 07:02:44.902400  8700 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240206 07:02:44.903172  8631 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240206 07:02:44.903268  8334 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240206 07:02:44.903278  8428 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240206 07:02:44.903285  8763 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240206 07:02:44.903295  8497 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240206 07:02:44.948940  8564 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102044b41000 7.629 MB
W20240206 07:02:44.949023  8700 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1020452e4000 7.629 MB
W20240206 07:02:44.949198  8564 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x102045a87000 7.629 MB
W20240206 07:02:44.949290  8564 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10204622a000 1.49 GB
W20240206 07:02:44.949342  8700 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020a580d000 7.629 MB
W20240206 07:02:44.949357  8564 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1020a5fb0000 1.49 GB
W20240206 07:02:44.949414  8564 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 07:02:44.949429  8700 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102105593000 1.49 GB
W20240206 07:02:44.949487  8700 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102164b76000 1.49 GB
W20240206 07:02:44.951015  8700 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 07:02:44.952889  8564 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 07:02:44.952999  8700 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 07:02:44.998091  8763 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1021c490c000 7.629 MB
W20240206 07:02:44.998095  8428 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1021c50af000 7.629 MB
W20240206 07:02:44.998088  8631 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1021c4169000 7.629 MB
W20240206 07:02:44.998107  8334 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1021c5852000 7.629 MB
W20240206 07:02:44.998248  8428 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1021c5ff7000 7.629 MB
W20240206 07:02:44.998255  8763 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1021c679a000 7.629 MB
W20240206 07:02:44.998268  8631 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1021c6f3d000 7.629 MB
W20240206 07:02:44.998322  8334 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1021c76e0000 7.629 MB
W20240206 07:02:44.998437  8334 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021c8626000 1.49 GB
W20240206 07:02:44.998427  8497 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1021c7e83000 7.629 MB
W20240206 07:02:44.998453  8428 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102227c09000 1.49 GB
W20240206 07:02:44.998461  8631 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1022871ec000 1.49 GB
W20240206 07:02:44.998468  8763 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1022e67cf000 1.49 GB
W20240206 07:02:44.998524  8334 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x102345db2000 1.49 GB
W20240206 07:02:44.998533  8631 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1023a5395000 1.49 GB
W20240206 07:02:44.998545  8428 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102404978000 1.49 GB
W20240206 07:02:44.998553  8763 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x102463f5b000 1.49 GB
W20240206 07:02:44.998591  8428 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 07:02:44.998596  8763 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240206 07:02:44.998600  8497 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1024c353e000 7.629 MB
W20240206 07:02:44.998610  8631 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240206 07:02:44.998631  8334 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 07:02:44.998672  8497 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1024c3ce1000 1.49 GB
W20240206 07:02:44.998732  8497 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1025232c4000 1.49 GB
W20240206 07:02:44.998771  8497 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 07:02:45.008716  8763 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240206 07:02:45.008729  8428 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 07:02:45.008738  8497 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 07:02:45.008752  8631 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240206 07:02:45.008760  8334 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x1000216be000
5: KnownLocalCachedEmbedding init done
WARNING [8630 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
4: KnownLocalCachedEmbedding init done
WARNING [8563 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
6: KnownLocalCachedEmbedding init done
WARNING [8699 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
1: KnownLocalCachedEmbedding init done
WARNING [8333 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
3: KnownLocalCachedEmbedding init done
WARNING [8496 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank6] pid = 8699
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949)]
cudaHostRegister 0x1000216be000
0: KnownLocalCachedEmbedding init done
WARNING [6837 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
2: KnownLocalCachedEmbedding init done
WARNING [8427 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 07:03:29.853446  8428 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240206 07:03:29.853494  8700 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 07:03:29.853662  8497 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 07:03:29.853962  8631 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 07:03:29.854189  8763 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 07:03:29.854319  8564 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 07:03:29.854444  8334 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
W20240206 07:03:29.856390  8700 grad_base.h:55] KGCacheController, config={
        "num_gpus": 7,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240206 07:03:29.856526  8700 grad_base.h:184] Init GradProcessingBase done
I20240206 07:03:42.488539  8700 grad_async_v2.h:42] Use main thread to update emb.
W20240206 07:03:42.488646  8700 kg_controller.h:78] after init GradAsyncProcessingV2
I20240206 07:03:42.488656  8700 kg_controller.h:84] Construct KGCacheController done
E20240206 07:03:43.154443  8763 recstore.cc:66] init folly done
E20240206 07:03:43.154467  8497 recstore.cc:66] init folly done
E20240206 07:03:43.154479  8564 recstore.cc:66] init folly done
E20240206 07:03:43.154561  8334 recstore.cc:66] init folly done
E20240206 07:03:43.154616  8428 recstore.cc:66] init folly done
E20240206 07:03:43.154626  8631 recstore.cc:66] init folly done
E20240206 07:03:43.154626  8700 recstore.cc:66] init folly done
I20240206 07:03:43.155582  8700 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240206 07:03:59.392273  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240206 07:03:59.392839  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
E20240206 07:04:00.392030  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240206 07:04:00.429396  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240206 07:04:01.392032  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240206 07:04:02.555858  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240206 07:04:02.556022  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 159.595 us                | 360.884 us                |
+---------------------------+---------------------------+---------------------------+
I20240206 07:04:03.246798  8428 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240206 07:04:03.350853  8700 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
E20240206 07:04:03.556022  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:04:03.625464  9220 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
I20240206 07:04:04.348825  8497 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 07:04:04.360311  8564 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
E20240206 07:04:04.556027  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:04:04.743527  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
W20240206 07:04:05.857681  9220 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 07:04:05.880859  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240206 07:04:06.011380  8631 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 07:04:06.843470  8334 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
E20240206 07:04:06.880025  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240206 07:04:07.081552  9220 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.546 us                | 289.117 us                |
+---------------------------+---------------------------+---------------------------+
W20240206 07:04:08.614041  9220 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 07:04:08.634044  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240206 07:04:08.801409  8763 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 41.346 ms                 | 41.346 ms                 |
| Forward                   | 710.322 ms                | 710.322 ms                |
| Backward                  | 197.140 ms                | 197.140 ms                |
| Optimize                  | 4.922 ms                  | 4.922 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:10.971273  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240206 07:04:11.079999  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240206 07:04:11.085346  9220 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 07:04:11.971011  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=145
W20240206 07:04:12.137470  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240206 07:04:12.228552  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
E20240206 07:04:12.971010  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=1148
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 345.250 us                | 4.062 ms                  |
| ProcessBack:Shuffle       | 6.812 ms                  | 290.346 ms                |
| ProcessBack:UpdateCache   | 8.860 ms                  | 553.630 ms                |
| ProcessBack:UpsertPq      | 27.273 ms                 | 184.276 ms                |
| ProcessOneStep            | 87.448 ms                 | 1.159 s                   |
| BlockToStepN              | 562.089 us                | 1.849 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240206 07:04:13.280941  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=15, pq.top=15
E20240206 07:04:13.422680  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=16, sample_step_cpp_seen_[rank]=15
W20240206 07:04:13.501749  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240206 07:04:13.983938  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240206 07:04:14.607808  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.257 ms                 | 215.332 ms                |
| Forward                   | 5.627 ms                  | 710.322 ms                |
| Backward                  | 4.857 ms                  | 197.140 ms                |
| Optimize                  | 1.987 ms                  | 4.922 ms                  |
| BarrierTimeBeforeRank0    | 29.639 us                 | 163.924 ms                |
| AfterBackward             | 105.997 ms                | 1.159 s                   |
| BlockToStepN              | 804.961 us                | 14.113 ms                 |
| OneStep                   | 164.624 ms                | 2.280 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:14.988230  8887 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:04:15.632187  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240206 07:04:15.656005  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=21, pq.top=21
E20240206 07:04:15.988011  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240206 07:04:16.656538  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240206 07:04:16.686589  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=25, pq.top=25
E20240206 07:04:16.988407  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
W20240206 07:04:17.670567  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240206 07:04:17.902441  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=33, pq.top=33
E20240206 07:04:17.988016  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=684
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 518.754 us                | 3.281 ms                  |
| ProcessBack:Shuffle       | 6.976 ms                  | 256.501 ms                |
| ProcessBack:UpdateCache   | 8.748 ms                  | 552.598 ms                |
| ProcessBack:UpsertPq      | 36.910 ms                 | 187.061 ms                |
| ProcessOneStep            | 116.787 ms                | 1.281 s                   |
| BlockToStepN              | 562.089 us                | 14.039 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:04:18.813815  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
W20240206 07:04:18.954010  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=39, pq.top=39
E20240206 07:04:18.990125  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=333
E20240206 07:04:19.484938  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=42, sample_step_cpp_seen_[rank]=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.303 ms                  | 308.577 ms                |
| Forward                   | 7.392 ms                  | 710.322 ms                |
| Backward                  | 4.990 ms                  | 197.140 ms                |
| Optimize                  | 3.014 ms                  | 14.400 ms                 |
| BarrierTimeBeforeRank0    | 52.181 us                 | 163.924 ms                |
| AfterBackward             | 116.826 ms                | 1.281 s                   |
| BlockToStepN              | 709.914 us                | 14.113 ms                 |
| OneStep                   | 182.471 ms                | 2.280 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 07:04:19.986681  9220 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
E20240206 07:04:19.990003  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=848
W20240206 07:04:20.500545  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=43, pq.top=43
E20240206 07:04:21.007229  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=2407
W20240206 07:04:21.068014  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
W20240206 07:04:21.774338  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=49, pq.top=49
E20240206 07:04:22.007014  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=57
W20240206 07:04:22.131830  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240206 07:04:22.949136  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=55, pq.top=55
E20240206 07:04:23.007009  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1007
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 402.651 us                | 4.666 ms                  |
| ProcessBack:Shuffle       | 7.089 ms                  | 256.501 ms                |
| ProcessBack:UpdateCache   | 8.748 ms                  | 552.598 ms                |
| ProcessBack:UpsertPq      | 41.221 ms                 | 205.184 ms                |
| ProcessOneStep            | 135.103 ms                | 1.159 s                   |
| BlockToStepN              | 562.089 us                | 7.140 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240206 07:04:23.231710  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
W20240206 07:04:23.962122  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=62, pq.top=62
E20240206 07:04:24.007009  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=7435
W20240206 07:04:24.298714  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240206 07:04:24.484006  8700 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=62, sample_step_cpp_seen_[rank]=61
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.281 ms                  | 215.332 ms                |
| Forward                   | 7.403 ms                  | 30.878 ms                 |
| Backward                  | 5.065 ms                  | 9.951 ms                  |
| Optimize                  | 3.081 ms                  | 12.254 ms                 |
| BarrierTimeBeforeRank0    | 68.454 us                 | 43.024 ms                 |
| AfterBackward             | 115.697 ms                | 1.159 s                   |
| BlockToStepN              | 707.881 us                | 7.247 ms                  |
| OneStep                   | 180.936 ms                | 1.306 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:25.007014  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=135
W20240206 07:04:25.208909  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240206 07:04:25.313959  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240206 07:04:26.007010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=11374
W20240206 07:04:26.267561  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240206 07:04:26.420748  9220 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240206 07:04:27.007012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1289
W20240206 07:04:27.689522  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240206 07:04:28.007009  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=383
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 317.588 us                | 1.017 ms                  |
| ProcessBack:Shuffle       | 7.181 ms                  | 49.902 ms                 |
| ProcessBack:UpdateCache   | 8.910 ms                  | 14.486 ms                 |
| ProcessBack:UpsertPq      | 36.910 ms                 | 200.050 ms                |
| ProcessOneStep            | 114.667 ms                | 1.212 s                   |
| BlockToStepN              | 613.524 us                | 7.140 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240206 07:04:28.582368  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=78, pq.top=78
W20240206 07:04:28.714432  9220 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240206 07:04:29.007010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=37577
W20240206 07:04:29.728040  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end7
W20240206 07:04:29.786976  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.698 ms                  | 215.332 ms                |
| Forward                   | 6.337 ms                  | 30.878 ms                 |
| Backward                  | 4.928 ms                  | 10.168 ms                 |
| Optimize                  | 3.014 ms                  | 12.254 ms                 |
| BarrierTimeBeforeRank0    | 244.855 us                | 70.564 ms                 |
| AfterBackward             | 112.830 ms                | 1.281 s                   |
| BlockToStepN              | 784.048 us                | 7.247 ms                  |
| OneStep                   | 161.398 ms                | 1.475 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:30.007012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=2785
E20240206 07:04:30.396423  8700 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=91, sample_step_cpp_seen_[rank]=90
W20240206 07:04:30.747998  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240206 07:04:31.013574  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:04:31.812120  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240206 07:04:32.013008  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=45
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 28.194, sample: 1.267, forward: 1.192, backward: 0.864, update: 0.245
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 26.543, sample: 1.219, forward: 1.166, backward: 0.873, update: 0.218
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 23.753, sample: 1.964, forward: 1.293, backward: 0.898, update: 0.258
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 29.308, sample: 1.446, forward: 1.196, backward: 0.900, update: 0.217
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 28.206, sample: 1.251, forward: 1.181, backward: 0.944, update: 0.209
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.711, sample: 1.680, forward: 1.287, backward: 0.936, update: 0.268
train_sampler.Prefill()
-------Step 0-------
tensor([ 4313787,   297915,   297953,   297999,   331926,   560589, 29131096,
          331947,   331962,    32955]) tensor([11184124, 27319960, 83787193, 71595827, 77990080, 48250740, 41349624,
        37697693, 73345815, 52169978])
-------Step 1-------
tensor([ 4313787,   297915,   297953,   297999,   331926,   560589, 29131096,
          331947,   331962,    32955]) tensor([39960504, 16514527, 25037131, 16225835, 67949692, 31185219, 83868628,
        23441616, 18010562, 41689862])
-------Step 2-------
tensor([  395054,   309107,   395084,   395109,   395143, 29131540,   569124,
          395175,   569141,   395200]) tensor([37574794,  7625721, 84447438,  1505658, 70536577, 21546995, 60983822,
           34694, 45513599, 83852950])
-------Step 3-------
tensor([  395054,   309107,   395084,   395109,   395143, 29131540,   569124,
          395175,   569141,   395200]) tensor([50324481, 12028335, 30830167,     5820, 42202663, 62748440, 65640499,
        57407140, 65947547, 81090652])
-------Step 4-------
tensor([  577580,   319926,   456121,   577596, 29131096,   251935,   319974,
        34688339,   456141,  4749321]) tensor([72810133, 49553985, 49661214, 10652620, 41584469, 38455280, 15281785,
        60496963, 83193227, 27070887])
-------Step 5-------
tensor([  577580,   319926,   456121,   577596, 29131096,   251935,   319974,
        34688339,   456141,  4749321]) tensor([45638435, 33814139,  9898569, 53554183, 52092719, 71548017,  9133558,
        85618695, 63783244, 61324465])
-------Step 6-------
tensor([ 526204, 4313787,    2672,    2695,   94843,  329292,    2727,    2755,
           2785,    2813]) tensor([39680736, 25815750, 62518933, 51932303, 61454637, 35727162, 36181444,
        40299499, 13487573, 64931244])
-------Step 7-------
tensor([ 526204, 4313787,    2672,    2695,   94843,  329292,    2727,    2755,
           2785,    2813]) tensor([51389473,  5181760, 79802008, 51191332, 85776687, 55421231,  6421385,
        14921775, 26475645,  4662483])
-------Step 8-------
tensor([  527013,    66867,    66902,    66923, 78484868,  4313787,    66953,
         4732049,   595178,    66985]) tensor([80521723,  9623539, 64423758, 81624799, 43331395, 58310962,  4733580,
        31658726, 33998691,   232998])
-------Step 9-------
tensor([  527013,    66867,    66902,    66923, 78484868,  4313787,    66953,
         4732049,   595178,    66985]) tensor([19336716, 22411113, 74744424, 50287874, 45110289, 16905370, 55066026,
        18365213, 54652020, 76868665])
before start barrier
start train
[proc 0] 100 steps, total: 29.204, sample: 2.267, forward: 1.377, backward: 0.709, update: 0.321
W20240206 07:04:33.000386  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=103, pq.top=103
E20240206 07:04:33.013183  9240 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:04:33.042121  9220 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 395.475 us                | 6.446 ms                  |
| ProcessBack:Shuffle       | 7.434 ms                  | 49.902 ms                 |
| ProcessBack:UpdateCache   | 9.540 ms                  | 14.486 ms                 |
| ProcessBack:UpsertPq      | 28.986 ms                 | 200.050 ms                |
| ProcessOneStep            | 107.159 ms                | 1.302 s                   |
| BlockToStepN              | 622.845 us                | 7.140 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:34.013012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=311
W20240206 07:04:34.257306  9220 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
W20240206 07:04:34.681185  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.141 ms                  | 215.332 ms                |
| Forward                   | 5.858 ms                  | 30.878 ms                 |
| Backward                  | 4.890 ms                  | 10.168 ms                 |
| Optimize                  | 3.002 ms                  | 12.254 ms                 |
| BarrierTimeBeforeRank0    | 1.695 ms                  | 70.564 ms                 |
| AfterBackward             | 107.194 ms                | 1.302 s                   |
| BlockToStepN              | 731.515 us                | 7.247 ms                  |
| OneStep                   | 152.766 ms                | 1.475 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:35.013010  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=2360
W20240206 07:04:35.410581  9220 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
W20240206 07:04:35.712241  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=118, pq.top=118
E20240206 07:04:35.830869  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=118, sample_step_cpp_seen_[rank]=117
E20240206 07:04:36.013012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1013
W20240206 07:04:36.576987  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
E20240206 07:04:37.013026  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=32728
W20240206 07:04:37.037228  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240206 07:04:37.630525  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end3
E20240206 07:04:38.013013  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=39139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 402.289 us                | 3.784 ms                  |
| ProcessBack:Shuffle       | 7.457 ms                  | 27.449 ms                 |
| ProcessBack:UpdateCache   | 9.202 ms                  | 12.523 ms                 |
| ProcessBack:UpsertPq      | 27.427 ms                 | 190.710 ms                |
| ProcessOneStep            | 102.193 ms                | 1.302 s                   |
| BlockToStepN              | 665.460 us                | 7.140 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240206 07:04:38.252758  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240206 07:04:38.714965  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240206 07:04:39.013015  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1269
W20240206 07:04:39.856308  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.864 ms                  | 215.332 ms                |
| Forward                   | 5.824 ms                  | 30.878 ms                 |
| Backward                  | 5.065 ms                  | 10.168 ms                 |
| Optimize                  | 2.982 ms                  | 12.254 ms                 |
| BarrierTimeBeforeRank0    | 2.125 ms                  | 70.564 ms                 |
| AfterBackward             | 99.606 ms                 | 1.302 s                   |
| BlockToStepN              | 818.860 us                | 7.247 ms                  |
| OneStep                   | 147.934 ms                | 1.475 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:40.013010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1156
W20240206 07:04:40.449456  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240206 07:04:40.868242  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240206 07:04:41.013010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=44184
W20240206 07:04:41.471220  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=144, pq.top=143
E20240206 07:04:42.013017  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=66430
W20240206 07:04:42.016974  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240206 07:04:42.526257  8700 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=150, sample_step_cpp_seen_[rank]=149
E20240206 07:04:43.013010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240206 07:04:43.031591  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 308.561 us                | 5.057 ms                  |
| ProcessBack:Shuffle       | 7.457 ms                  | 27.449 ms                 |
| ProcessBack:UpdateCache   | 9.146 ms                  | 12.523 ms                 |
| ProcessBack:UpsertPq      | 26.831 ms                 | 190.710 ms                |
| ProcessOneStep            | 102.193 ms                | 1.302 s                   |
| BlockToStepN              | 748.607 us                | 15.132 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:04:43.364919  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=151, pq.top=151
E20240206 07:04:44.022468  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:04:44.062170  9220 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
W20240206 07:04:44.368744  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=161, pq.top=161
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.688 ms                  | 156.324 ms                |
| Forward                   | 5.804 ms                  | 26.658 ms                 |
| Backward                  | 5.235 ms                  | 9.951 ms                  |
| Optimize                  | 2.938 ms                  | 12.254 ms                 |
| BarrierTimeBeforeRank0    | 1.630 ms                  | 107.633 ms                |
| AfterBackward             | 99.603 ms                 | 1.281 s                   |
| BlockToStepN              | 859.985 us                | 15.122 ms                 |
| OneStep                   | 145.363 ms                | 1.349 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:45.028847  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:04:45.126325  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240206 07:04:46.028009  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=18681
W20240206 07:04:46.231225  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
E20240206 07:04:47.028010  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240206 07:04:47.181746  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240206 07:04:47.260217  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
E20240206 07:04:48.028010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=3661
E20240206 07:04:48.106981  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=182, sample_step_cpp_seen_[rank]=181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 373.364 us                | 8.609 ms                  |
| ProcessBack:Shuffle       | 7.325 ms                  | 23.207 ms                 |
| ProcessBack:UpdateCache   | 9.269 ms                  | 13.685 ms                 |
| ProcessBack:UpsertPq      | 25.698 ms                 | 187.061 ms                |
| ProcessOneStep            | 99.569 ms                 | 1.281 s                   |
| BlockToStepN              | 857.681 us                | 15.006 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:04:48.392565  9220 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240206 07:04:49.028014  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=331
W20240206 07:04:49.419171  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
W20240206 07:04:49.576608  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=187, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.280 ms                  | 156.324 ms                |
| Forward                   | 5.679 ms                  | 26.658 ms                 |
| Backward                  | 5.270 ms                  | 10.168 ms                 |
| Optimize                  | 2.859 ms                  | 12.394 ms                 |
| BarrierTimeBeforeRank0    | 3.178 ms                  | 107.633 ms                |
| AfterBackward             | 99.606 ms                 | 1.281 s                   |
| BlockToStepN              | 1.003 ms                  | 15.122 ms                 |
| OneStep                   | 144.271 ms                | 1.349 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:50.028009  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=243
W20240206 07:04:50.518505  9220 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
W20240206 07:04:50.686558  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=197, pq.top=197
E20240206 07:04:51.028014  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=6034
W20240206 07:04:51.521026  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
W20240206 07:04:51.860304  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 0] 200 steps, total: 19.413, sample: 1.344, forward: 0.574, backward: 0.642, update: 0.315
[proc 2] 200 steps, total: 19.413, sample: 1.309, forward: 0.545, backward: 0.605, update: 0.230
[proc 1] 200 steps, total: 19.413, sample: 1.810, forward: 0.574, backward: 0.718, update: 0.250
[proc 5] 200 steps, total: 19.413, sample: 1.321, forward: 0.515, backward: 0.666, update: 0.231
[proc 6] 200 steps, total: 19.413, sample: 1.339, forward: 0.501, backward: 0.804, update: 0.224
[proc 4] 200 steps, total: 19.413, sample: 1.112, forward: 0.518, backward: 0.706, update: 0.225
[proc 3] 200 steps, total: 19.413, sample: 1.118, forward: 0.551, backward: 0.636, update: 0.224
E20240206 07:04:52.028008  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=140
W20240206 07:04:52.604188  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
W20240206 07:04:52.899797  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=209, pq.top=209
E20240206 07:04:53.028007  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=1324
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 395.413 us                | 12.531 ms                 |
| ProcessBack:Shuffle       | 7.265 ms                  | 23.207 ms                 |
| ProcessBack:UpdateCache   | 9.126 ms                  | 13.685 ms                 |
| ProcessBack:UpsertPq      | 25.699 ms                 | 187.061 ms                |
| ProcessOneStep            | 95.870 ms                 | 1.281 s                   |
| BlockToStepN              | 955.029 us                | 15.132 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:53.185819  8700 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=212, sample_step_cpp_seen_[rank]=211
W20240206 07:04:53.693320  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240206 07:04:54.036011  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:04:54.713092  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240206 07:04:54.745371  9220 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.041 ms                  | 156.324 ms                |
| Forward                   | 5.693 ms                  | 26.658 ms                 |
| Backward                  | 5.285 ms                  | 12.448 ms                 |
| Optimize                  | 2.757 ms                  | 12.394 ms                 |
| BarrierTimeBeforeRank0    | 3.991 ms                  | 107.633 ms                |
| AfterBackward             | 95.624 ms                 | 1.281 s                   |
| BlockToStepN              | 1.020 ms                  | 15.207 ms                 |
| OneStep                   | 136.522 ms                | 1.349 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:55.036010  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=14178
W20240206 07:04:55.724678  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240206 07:04:55.950567  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240206 07:04:56.036010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=5669
W20240206 07:04:56.909358  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240206 07:04:56.985538  9220 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
E20240206 07:04:57.036020  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=314
W20240206 07:04:57.937196  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=238, pq.top=238
E20240206 07:04:58.036123  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=10031
W20240206 07:04:58.085283  9220 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 391.298 us                | 11.063 ms                 |
| ProcessBack:Shuffle       | 7.276 ms                  | 21.983 ms                 |
| ProcessBack:UpdateCache   | 9.012 ms                  | 12.979 ms                 |
| ProcessBack:UpsertPq      | 25.248 ms                 | 184.276 ms                |
| ProcessOneStep            | 92.121 ms                 | 1.281 s                   |
| BlockToStepN              | 997.405 us                | 47.442 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 07:04:58.469372  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=243, sample_step_cpp_seen_[rank]=242
E20240206 07:04:59.036010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240206 07:04:59.253607  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.840 ms                  | 156.324 ms                |
| Forward                   | 5.810 ms                  | 26.658 ms                 |
| Backward                  | 5.324 ms                  | 12.448 ms                 |
| Optimize                  | 2.712 ms                  | 12.394 ms                 |
| BarrierTimeBeforeRank0    | 3.050 ms                  | 107.633 ms                |
| AfterBackward             | 92.187 ms                 | 1.281 s                   |
| BlockToStepN              | 1.073 ms                  | 47.592 ms                 |
| OneStep                   | 132.087 ms                | 1.349 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:00.036010  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=164
W20240206 07:05:00.267619  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end8
W20240206 07:05:00.717007  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=251, pq.top=251
E20240206 07:05:01.036015  9248 parallel_pq_v2.h:79] insert failed, size(hashtable)=44466
W20240206 07:05:01.553833  9220 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240206 07:05:02.036046  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=5
W20240206 07:05:02.690431  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end0
E20240206 07:05:03.036020  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=4173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 285.408 us                | 2.957 ms                  |
| ProcessBack:Shuffle       | 7.251 ms                  | 21.983 ms                 |
| ProcessBack:UpdateCache   | 8.927 ms                  | 12.979 ms                 |
| ProcessBack:UpsertPq      | 25.789 ms                 | 184.276 ms                |
| ProcessOneStep            | 92.634 ms                 | 1.281 s                   |
| BlockToStepN              | 1.017 ms                  | 47.442 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:03.755282  9220 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end4
E20240206 07:05:04.036007  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=56221
W20240206 07:05:04.254973  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=268, pq.top=268
W20240206 07:05:04.834412  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.902 ms                  | 136.100 ms                |
| Forward                   | 5.791 ms                  | 12.635 ms                 |
| Backward                  | 5.395 ms                  | 12.448 ms                 |
| Optimize                  | 2.712 ms                  | 12.254 ms                 |
| BarrierTimeBeforeRank0    | 2.850 ms                  | 81.412 ms                 |
| AfterBackward             | 92.187 ms                 | 1.281 s                   |
| BlockToStepN              | 1.128 ms                  | 48.013 ms                 |
| OneStep                   | 132.087 ms                | 1.349 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:04.919234  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=273, sample_step_cpp_seen_[rank]=272
E20240206 07:05:05.036010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=2247
W20240206 07:05:05.839565  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240206 07:05:06.036016  9238 parallel_pq_v2.h:79] insert failed, size(hashtable)=62434
W20240206 07:05:06.306664  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240206 07:05:06.849304  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240206 07:05:07.036013  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=52654
W20240206 07:05:07.408344  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240206 07:05:08.022219  9220 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240206 07:05:08.036012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=237
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 401.620 us                | 7.845 ms                  |
| ProcessBack:Shuffle       | 7.267 ms                  | 23.207 ms                 |
| ProcessBack:UpdateCache   | 8.951 ms                  | 13.540 ms                 |
| ProcessBack:UpsertPq      | 26.168 ms                 | 181.206 ms                |
| ProcessOneStep            | 92.649 ms                 | 1.281 s                   |
| BlockToStepN              | 1.121 ms                  | 47.875 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:09.036008  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=4743
W20240206 07:05:09.084836  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240206 07:05:09.613982  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=293, pq.top=293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.221 ms                  | 136.100 ms                |
| Forward                   | 5.791 ms                  | 12.751 ms                 |
| Backward                  | 5.466 ms                  | 12.448 ms                 |
| Optimize                  | 2.705 ms                  | 12.254 ms                 |
| BarrierTimeBeforeRank0    | 2.506 ms                  | 81.412 ms                 |
| AfterBackward             | 92.712 ms                 | 1.302 s                   |
| BlockToStepN              | 1.212 ms                  | 48.013 ms                 |
| OneStep                   | 133.754 ms                | 1.382 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:10.036008  8887 parallel_pq_v2.h:79] insert failed, size(hashtable)=2260
W20240206 07:05:10.168998  9220 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
[proc 5] 300 steps, total: 18.631, sample: 1.187, forward: 0.565, backward: 0.702, update: 0.257
[proc 4] 300 steps, total: 18.631, sample: 1.038, forward: 0.534, backward: 0.715, update: 0.256
[proc 3] 300 steps, total: 18.631, sample: 0.912, forward: 0.520, backward: 0.689, update: 0.220
[proc 1] 300 steps, total: 18.631, sample: 1.209, forward: 0.495, backward: 0.801, update: 0.234
[proc 6] 300 steps, total: 18.631, sample: 1.086, forward: 0.497, backward: 0.674, update: 0.242
[proc 2] 300 steps, total: 18.631, sample: 1.121, forward: 0.495, backward: 0.599, update: 0.223
[proc 0] 300 steps, total: 18.631, sample: 1.382, forward: 0.594, backward: 0.610, update: 0.288
W20240206 07:05:10.821964  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=301, pq.top=301
E20240206 07:05:11.036187  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=61
W20240206 07:05:11.221822  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240206 07:05:11.271329  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=305, sample_step_cpp_seen_[rank]=304
E20240206 07:05:12.036012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=4927
W20240206 07:05:12.249825  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240206 07:05:12.401849  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=307, pq.top=307
E20240206 07:05:13.036013  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=6932
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 359.385 us                | 5.960 ms                  |
| ProcessBack:Shuffle       | 7.252 ms                  | 23.207 ms                 |
| ProcessBack:UpdateCache   | 8.882 ms                  | 13.540 ms                 |
| ProcessBack:UpsertPq      | 26.385 ms                 | 181.206 ms                |
| ProcessOneStep            | 92.649 ms                 | 1.302 s                   |
| BlockToStepN              | 1.244 ms                  | 47.875 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:13.301826  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
W20240206 07:05:13.670845  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=317, pq.top=317
E20240206 07:05:14.036012  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=5192
W20240206 07:05:14.339169  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.299 ms                  | 136.100 ms                |
| Forward                   | 5.754 ms                  | 12.751 ms                 |
| Backward                  | 5.395 ms                  | 12.448 ms                 |
| Optimize                  | 2.696 ms                  | 12.254 ms                 |
| BarrierTimeBeforeRank0    | 2.392 ms                  | 81.412 ms                 |
| AfterBackward             | 92.776 ms                 | 1.302 s                   |
| BlockToStepN              | 1.405 ms                  | 48.013 ms                 |
| OneStep                   | 136.510 ms                | 1.382 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:15.036036  9229 parallel_pq_v2.h:79] insert failed, size(hashtable)=4958
W20240206 07:05:15.306298  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240206 07:05:15.371703  9220 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240206 07:05:16.036010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=13668
W20240206 07:05:16.357350  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240206 07:05:16.482043  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end3
E20240206 07:05:17.005831  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=337, sample_step_cpp_seen_[rank]=336
E20240206 07:05:17.036008  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=3
W20240206 07:05:17.516513  9220 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end9
E20240206 07:05:18.036032  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=1073
W20240206 07:05:18.106969  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=339, pq.top=339
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 375.259 us                | 5.019 ms                  |
| ProcessBack:Shuffle       | 7.209 ms                  | 21.983 ms                 |
| ProcessBack:UpdateCache   | 8.821 ms                  | 12.979 ms                 |
| ProcessBack:UpsertPq      | 26.356 ms                 | 176.535 ms                |
| ProcessOneStep            | 94.200 ms                 | 1.302 s                   |
| BlockToStepN              | 1.403 ms                  | 47.875 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:18.626253  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240206 07:05:19.036011  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=940
W20240206 07:05:19.154528  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=348, pq.top=348
W20240206 07:05:19.635948  9220 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.477 ms                  | 136.012 ms                |
| Forward                   | 5.765 ms                  | 12.635 ms                 |
| Backward                  | 5.465 ms                  | 11.176 ms                 |
| Optimize                  | 2.666 ms                  | 9.996 ms                  |
| BarrierTimeBeforeRank0    | 2.234 ms                  | 70.564 ms                 |
| AfterBackward             | 92.776 ms                 | 1.281 s                   |
| BlockToStepN              | 1.517 ms                  | 47.592 ms                 |
| OneStep                   | 133.754 ms                | 1.349 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:20.038112  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:05:20.638389  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240206 07:05:21.038025  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=7
W20240206 07:05:21.145965  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240206 07:05:21.689981  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end8
E20240206 07:05:22.038012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=4286
W20240206 07:05:22.189348  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=361, pq.top=361
E20240206 07:05:22.646555  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=365, sample_step_cpp_seen_[rank]=364
W20240206 07:05:23.014972  9220 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240206 07:05:23.038007  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=4754
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 494.146 us                | 19.078 ms                 |
| ProcessBack:Shuffle       | 7.229 ms                  | 21.983 ms                 |
| ProcessBack:UpdateCache   | 8.748 ms                  | 12.979 ms                 |
| ProcessBack:UpsertPq      | 26.590 ms                 | 176.535 ms                |
| ProcessOneStep            | 92.730 ms                 | 1.302 s                   |
| BlockToStepN              | 1.453 ms                  | 47.442 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:24.038023  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=10752
W20240206 07:05:24.045641  9220 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240206 07:05:24.188748  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=367, pq.top=367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.455 ms                  | 136.012 ms                |
| Forward                   | 5.734 ms                  | 12.635 ms                 |
| Backward                  | 5.488 ms                  | 11.176 ms                 |
| Optimize                  | 2.696 ms                  | 9.996 ms                  |
| BarrierTimeBeforeRank0    | 2.129 ms                  | 70.564 ms                 |
| AfterBackward             | 92.776 ms                 | 1.361 s                   |
| BlockToStepN              | 1.549 ms                  | 48.013 ms                 |
| OneStep                   | 133.256 ms                | 1.412 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:25.038017  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=2544
W20240206 07:05:25.074326  9220 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end5
W20240206 07:05:25.202461  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240206 07:05:26.038015  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=6577
W20240206 07:05:26.321700  9220 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240206 07:05:27.038010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=6622
W20240206 07:05:27.342506  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240206 07:05:27.857908  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240206 07:05:28.038369  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 371.657 us                | 5.331 ms                  |
| ProcessBack:Shuffle       | 7.235 ms                  | 16.902 ms                 |
| ProcessBack:UpdateCache   | 8.649 ms                  | 12.659 ms                 |
| ProcessBack:UpsertPq      | 26.831 ms                 | 175.447 ms                |
| ProcessOneStep            | 94.665 ms                 | 1.392 s                   |
| BlockToStepN              | 1.536 ms                  | 47.875 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:28.491873  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
W20240206 07:05:29.008985  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=393, pq.top=393
E20240206 07:05:29.040750  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240206 07:05:29.472219  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=397, sample_step_cpp_seen_[rank]=396
W20240206 07:05:29.702589  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.477 ms                  | 136.012 ms                |
| Forward                   | 5.664 ms                  | 12.635 ms                 |
| Backward                  | 5.460 ms                  | 11.176 ms                 |
| Optimize                  | 2.662 ms                  | 9.996 ms                  |
| BarrierTimeBeforeRank0    | 2.183 ms                  | 70.564 ms                 |
| AfterBackward             | 94.281 ms                 | 1.392 s                   |
| BlockToStepN              | 1.646 ms                  | 49.182 ms                 |
| OneStep                   | 134.302 ms                | 1.427 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:30.048255  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:05:30.738729  9220 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
E20240206 07:05:31.048018  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=867
W20240206 07:05:31.066002  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 3] 400 steps, total: 20.581, sample: 1.063, forward: 0.529, backward: 0.647, update: 0.236
[proc 2] 400 steps, total: 20.581, sample: 1.061, forward: 0.506, backward: 0.649, update: 0.242
[proc 6] 400 steps, total: 20.581, sample: 1.147, forward: 0.497, backward: 0.725, update: 0.234
[proc 0] 400 steps, total: 20.581, sample: 1.330, forward: 0.547, backward: 0.569, update: 0.282
[proc 5] 400 steps, total: 20.582, sample: 0.971, forward: 0.558, backward: 0.831, update: 0.249
[proc 1] 400 steps, total: 20.581, sample: 1.020, forward: 0.517, backward: 0.837, update: 0.235
[proc 4] 400 steps, total: 20.582, sample: 1.026, forward: 0.529, backward: 0.639, update: 0.234
W20240206 07:05:31.791882  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240206 07:05:32.048010  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=2160
W20240206 07:05:32.072119  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240206 07:05:32.986865  9220 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240206 07:05:33.048009  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=763
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 422.833 us                | 7.806 ms                  |
| ProcessBack:Shuffle       | 7.209 ms                  | 23.207 ms                 |
| ProcessBack:UpdateCache   | 8.561 ms                  | 12.659 ms                 |
| ProcessBack:UpsertPq      | 26.623 ms                 | 175.447 ms                |
| ProcessOneStep            | 94.200 ms                 | 1.400 s                   |
| BlockToStepN              | 1.638 ms                  | 49.011 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:33.779884  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=413, pq.top=413
W20240206 07:05:33.990456  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end5
E20240206 07:05:34.048010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=46194
W20240206 07:05:34.811250  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=422, pq.top=422
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.379 ms                  | 136.012 ms                |
| Forward                   | 5.664 ms                  | 12.635 ms                 |
| Backward                  | 5.395 ms                  | 11.176 ms                 |
| Optimize                  | 2.663 ms                  | 9.996 ms                  |
| BarrierTimeBeforeRank0    | 2.443 ms                  | 70.564 ms                 |
| AfterBackward             | 93.308 ms                 | 1.400 s                   |
| BlockToStepN              | 1.776 ms                  | 49.182 ms                 |
| OneStep                   | 134.302 ms                | 1.460 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 07:05:35.048010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1872
W20240206 07:05:35.142534  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
W20240206 07:05:35.915308  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=431, pq.top=431
E20240206 07:05:35.973433  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=431, sample_step_cpp_seen_[rank]=430
E20240206 07:05:36.048012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=3503
W20240206 07:05:36.160218  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end2
E20240206 07:05:37.048010  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=29912
W20240206 07:05:37.114306  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=433, pq.top=433
W20240206 07:05:37.180737  9220 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end4
E20240206 07:05:38.048013  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=54528
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 488.293 us                | 5.589 ms                  |
| ProcessBack:Shuffle       | 7.231 ms                  | 21.983 ms                 |
| ProcessBack:UpdateCache   | 8.480 ms                  | 12.549 ms                 |
| ProcessBack:UpsertPq      | 26.412 ms                 | 175.187 ms                |
| ProcessOneStep            | 92.730 ms                 | 1.400 s                   |
| BlockToStepN              | 1.742 ms                  | 53.726 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:38.252041  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=442, pq.top=441
W20240206 07:05:38.306124  9220 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240206 07:05:39.062810  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:05:39.514134  9220 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.298 ms                  | 136.012 ms                |
| Forward                   | 5.706 ms                  | 12.635 ms                 |
| Backward                  | 5.401 ms                  | 11.176 ms                 |
| Optimize                  | 2.693 ms                  | 9.996 ms                  |
| BarrierTimeBeforeRank0    | 2.326 ms                  | 70.564 ms                 |
| AfterBackward             | 92.712 ms                 | 1.400 s                   |
| BlockToStepN              | 1.832 ms                  | 53.803 ms                 |
| OneStep                   | 132.232 ms                | 1.460 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:40.023074  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=447, pq.top=447
E20240206 07:05:40.062016  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=81
W20240206 07:05:40.574702  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end3
E20240206 07:05:41.062012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=63161
W20240206 07:05:41.141480  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=457, pq.top=456
E20240206 07:05:41.453123  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=459, sample_step_cpp_seen_[rank]=458
W20240206 07:05:41.619786  9220 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240206 07:05:42.062011  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=2005
W20240206 07:05:42.623966  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
W20240206 07:05:43.003965  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=465, pq.top=464
E20240206 07:05:43.062016  9223 parallel_pq_v2.h:79] insert failed, size(hashtable)=37085
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 470.407 us                | 27.586 ms                 |
| ProcessBack:Shuffle       | 7.215 ms                  | 21.983 ms                 |
| ProcessBack:UpdateCache   | 8.418 ms                  | 12.549 ms                 |
| ProcessBack:UpsertPq      | 26.283 ms                 | 175.187 ms                |
| ProcessOneStep            | 92.634 ms                 | 1.392 s                   |
| BlockToStepN              | 1.765 ms                  | 53.726 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:43.633837  9220 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end0
E20240206 07:05:44.062012  8700 parallel_pq_v2.h:79] insert failed, size(hashtable)=3823
W20240206 07:05:44.099099  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=473, pq.top=473
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.156 ms                  | 133.161 ms                |
| Forward                   | 5.745 ms                  | 10.970 ms                 |
| Backward                  | 5.455 ms                  | 10.215 ms                 |
| Optimize                  | 2.691 ms                  | 9.996 ms                  |
| BarrierTimeBeforeRank0    | 2.213 ms                  | 70.027 ms                 |
| AfterBackward             | 92.697 ms                 | 1.392 s                   |
| BlockToStepN              | 1.841 ms                  | 53.803 ms                 |
| OneStep                   | 132.087 ms                | 1.427 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:44.901165  9220 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end6
E20240206 07:05:45.063788  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 07:05:45.978790  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
E20240206 07:05:46.063012  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=52177
W20240206 07:05:46.226761  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240206 07:05:47.015765  9220 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240206 07:05:47.063006  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=12890
E20240206 07:05:47.327597  8887 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=490, sample_step_cpp_seen_[rank]=489
E20240206 07:05:48.063009  9220 parallel_pq_v2.h:79] insert failed, size(hashtable)=301
W20240206 07:05:48.101536  9220 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 437.335 us                | 22.906 ms                 |
| ProcessBack:Shuffle       | 7.217 ms                  | 16.902 ms                 |
| ProcessBack:UpdateCache   | 8.328 ms                  | 12.523 ms                 |
| ProcessBack:UpsertPq      | 26.613 ms                 | 174.914 ms                |
| ProcessOneStep            | 92.649 ms                 | 1.392 s                   |
| BlockToStepN              | 1.786 ms                  | 53.726 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 07:05:48.420686  8700 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=491, pq.top=491
E20240206 07:05:49.063012  9248 parallel_pq_v2.h:79] insert failed, size(hashtable)=40558
W20240206 07:05:49.166582  9220 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end9
[proc 4] 500 steps, total: 18.165, sample: 1.010, forward: 0.528, backward: 0.792, update: 0.252
[proc 1] 500 steps, total: 18.165, sample: 1.051, forward: 0.513, backward: 0.705, update: 0.231
[proc 3] 500 steps, total: 18.165, sample: 0.976, forward: 0.519, backward: 0.640, update: 0.212
[proc 0] 500 steps, total: 18.165, sample: 1.171, forward: 0.602, backward: 0.548, update: 0.293
[proc 5] 500 steps, total: 18.165, sample: 0.996, forward: 0.495, backward: 0.770, update: 0.228
[proc 2] 500 steps, total: 18.165, sample: 0.969, forward: 0.542, backward: 0.642, update: 0.229
Successfully xmh. training takes 105.99421000480652 seconds
[proc 6] 500 steps, total: 18.165, sample: 1.374, forward: 0.553, backward: 0.801, update: 0.266
before call kg_cache_controller.StopThreads()
W20240206 07:05:49.344877  8700 grad_async_v2.h:84] call StopThreads. PID = 6837
W20240206 07:05:49.344911  8700 grad_base.h:212] before processOneStepNegThread_.join();
W20240206 07:05:49.345219  8700 grad_base.h:214] after processOneStepNegThread_.join();
W20240206 07:05:49.345227  8700 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240206 07:05:49.625316  8700 grad_async_v2.h:105] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.966 ms                  | 133.161 ms                |
| Forward                   | 5.758 ms                  | 12.635 ms                 |
| Backward                  | 5.455 ms                  | 10.419 ms                 |
| Optimize                  | 2.681 ms                  | 9.996 ms                  |
| BarrierTimeBeforeRank0    | 2.234 ms                  | 70.564 ms                 |
| AfterBackward             | 92.351 ms                 | 1.392 s                   |
| BlockToStepN              | 1.881 ms                  | 56.688 ms                 |
| OneStep                   | 131.205 ms                | 1.427 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 458.634 us                | 8.098 ms                  |
| ProcessBack:Shuffle       | 7.206 ms                  | 16.902 ms                 |
| ProcessBack:UpdateCache   | 8.311 ms                  | 12.523 ms                 |
| ProcessBack:UpsertPq      | 26.590 ms                 | 174.914 ms                |
| ProcessOneStep            | 92.295 ms                 | 1.392 s                   |
| BlockToStepN              | 1.812 ms                  | 56.530 ms                 |
+---------------------------+---------------------------+---------------------------+
