WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240207 21:51:59.811077 23174 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_55', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [23174 sampler.py:454] Start PreSampling
WARNING [23174 sampler.py:532] Before construct renumbering_dict
WARNING [23174 sampler.py:555] PreSampling done
W20240207 22:11:37.521907 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240207 22:11:37.522097 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240207 22:11:37.522137 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240207 22:11:37.522181 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240207 22:11:37.522212 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240207 22:11:37.522248 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240207 22:11:37.522281 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240207 22:11:37.522320 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240207 22:11:37.522352 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240207 22:11:37.522383 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240207 22:11:37.522421 23174 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240207 22:11:37.522446 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240207 22:11:37.522473 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240207 22:11:37.522640 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240207 22:11:37.522677 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240207 22:11:37.522704 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240207 22:11:37.522754 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240207 22:11:37.522783 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240207 22:11:37.522821 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240207 22:11:37.522852 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240207 22:11:37.522888 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240207 22:11:37.522915 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240207 22:11:37.522944 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240207 22:11:37.522975 23174 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240207 22:11:37.523000 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240207 22:11:37.523025 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240207 22:11:37.523080 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240207 22:11:37.523113 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240207 22:11:37.523144 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240207 22:11:37.523169 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240207 22:11:37.523207 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240207 22:11:37.523236 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240207 22:11:37.523260 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240207 22:11:37.523301 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240207 22:11:37.523337 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240207 22:11:37.523363 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240207 22:11:37.523396 23174 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240207 22:11:37.523417 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240207 22:11:37.523439 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240207 22:11:37.523501 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240207 22:11:37.523540 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240207 22:11:37.523568 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240207 22:11:37.523598 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240207 22:11:37.523624 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240207 22:11:37.523655 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240207 22:11:37.523684 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240207 22:11:37.523713 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240207 22:11:37.523742 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240207 22:11:37.523778 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240207 22:11:37.523808 23174 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240207 22:11:37.523833 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240207 22:11:37.523854 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240207 22:11:37.523909 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240207 22:11:37.523943 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240207 22:11:37.523977 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240207 22:11:37.524010 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240207 22:11:37.524044 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240207 22:11:37.524099 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240207 22:11:37.524137 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240207 22:11:37.524171 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240207 22:11:37.524209 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240207 22:11:37.524237 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240207 22:11:37.524268 23174 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240207 22:11:37.524292 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240207 22:11:37.524317 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240207 22:11:37.524374 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240207 22:11:37.524411 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240207 22:11:37.524438 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240207 22:11:37.524471 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240207 22:11:37.524508 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240207 22:11:37.524539 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240207 22:11:37.524570 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240207 22:11:37.524608 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240207 22:11:37.524644 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240207 22:11:37.524677 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240207 22:11:37.524706 23174 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240207 22:11:37.524730 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240207 22:11:37.524755 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240207 22:11:37.524817 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240207 22:11:37.524854 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240207 22:11:37.524892 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240207 22:11:37.524932 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240207 22:11:37.524964 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240207 22:11:37.524997 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240207 22:11:37.525032 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240207 22:11:37.525063 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240207 22:11:37.525092 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240207 22:11:37.525125 23174 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240207 22:11:37.525161 23174 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240207 22:11:37.525184 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240207 22:11:37.525216 23174 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240207 22:11:37.955330 23174 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000216be000 128.2 GB
W20240207 22:20:08.384512 23174 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020302f6000 328.3 MB
{0: Graph(num_nodes=15380073, num_edges=42467395,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=16359015, num_edges=65830196,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16649310, num_edges=43584356,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=13918614, num_edges=50952482,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14713191, num_edges=52450022,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14150782, num_edges=58077216,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=21311359, num_edges=64967677,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 15380073 N 42467395 E
MertisPartition: part 1 has 16359015 N 65830196 E
MertisPartition: part 2 has 16649310 N 43584356 E
MertisPartition: part 3 has 13918614 N 50952482 E
MertisPartition: part 4 has 14713191 N 52450022 E
MertisPartition: part 5 has 14150782 N 58077216 E
MertisPartition: part 6 has 21311359 N 64967677 E
Rank0: cached key size 614672
Rank1: cached key size 614672
Rank2: cached key size 614672
Rank3: cached key size 614672
Rank4: cached key size 614672
Rank5: cached key size 614672
Rank6: cached key size 614672
Before renumbering graph:  {'_ID': tensor([     239,      240,      329,  ..., 86019793, 84488282, 82976992]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4310491,  4310531,  4313510,  ..., 84025388, 40806257, 71147879]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2191.637 seconds
[Rank1] pid = 24267
[Rank2] pid = 24364
[Rank3] pid = 24431
[Rank4] pid = 24498
[Rank5] pid = 24567
INFO [23174 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [24267 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [24364 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [24431 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [24567 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [24634 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [24498 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [24567 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [24498 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [24634 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [24364 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [24431 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [24267 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [23174 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
W20240207 22:28:41.463551 24568 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240207 22:28:41.463943 24499 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240207 22:28:41.463934 24700 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240207 22:28:41.464105 24635 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240207 22:28:41.464699 24365 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240207 22:28:41.465488 24432 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240207 22:28:41.465545 24268 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240207 22:28:41.537750 24700 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x102046234000 7.629 MB
W20240207 22:28:41.537739 24635 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102044b4b000 7.629 MB
W20240207 22:28:41.537744 24365 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102045a91000 7.629 MB
W20240207 22:28:41.537741 24568 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1020452ee000 7.629 MB
W20240207 22:28:41.537755 24499 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1020469d7000 7.629 MB
W20240207 22:28:41.537761 24268 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204717a000 7.629 MB
W20240207 22:28:41.537773 24432 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204791d000 7.629 MB
W20240207 22:28:41.537914 24635 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020480c0000 7.629 MB
W20240207 22:28:41.537947 24700 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x102048863000 7.629 MB
W20240207 22:28:41.537964 24568 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102049006000 7.629 MB
W20240207 22:28:41.537971 24365 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1020497a9000 7.629 MB
W20240207 22:28:41.537971 24635 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102049f4c000 1.49 GB
W20240207 22:28:41.537989 24499 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1020a952f000 7.629 MB
W20240207 22:28:41.538004 24432 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020a9cd2000 7.629 MB
W20240207 22:28:41.538031 24268 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1020aa475000 7.629 MB
W20240207 22:28:41.538038 24635 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020aac18000 1.49 GB
W20240207 22:28:41.538049 24700 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10210a1fb000 1.49 GB
W20240207 22:28:41.538064 24568 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1021697de000 1.49 GB
W20240207 22:28:41.538070 24365 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1021c8dc1000 1.49 GB
W20240207 22:28:41.538090 24499 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1022283a4000 1.49 GB
W20240207 22:28:41.538100 24635 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 22:28:41.538108 24432 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102287987000 1.49 GB
W20240207 22:28:41.538137 24700 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1022e6f6a000 1.49 GB
W20240207 22:28:41.538146 24268 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10234654d000 1.49 GB
W20240207 22:28:41.538152 24568 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1023a5b30000 1.49 GB
W20240207 22:28:41.538159 24365 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102405113000 1.49 GB
W20240207 22:28:41.538177 24499 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1024646f6000 1.49 GB
W20240207 22:28:41.538184 24432 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1024c3cd9000 1.49 GB
W20240207 22:28:41.538223 24700 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240207 22:28:41.538229 24499 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240207 22:28:41.538230 24268 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025232bc000 1.49 GB
W20240207 22:28:41.538242 24365 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 22:28:41.538249 24432 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240207 22:28:41.538250 24568 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240207 22:28:41.538296 24268 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 22:28:41.551443 24635 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 22:28:41.551474 24700 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240207 22:28:41.551491 24499 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240207 22:28:41.551551 24365 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 22:28:41.551564 24568 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240207 22:28:41.551569 24432 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240207 22:28:41.551576 24268 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x1000216be000
4: KnownLocalCachedEmbedding init done
WARNING [24498 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
5: KnownLocalCachedEmbedding init done
WARNING [24567 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
6: KnownLocalCachedEmbedding init done
WARNING [24634 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
2: KnownLocalCachedEmbedding init done
WARNING [24364 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank6] pid = 24634
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949)]
cudaHostRegister 0x1000216be000
0: KnownLocalCachedEmbedding init done
WARNING [23174 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
3: KnownLocalCachedEmbedding init done
WARNING [24431 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
1: KnownLocalCachedEmbedding init done
WARNING [24267 DistTensor.py:59] The tensor name already exists in the kvstore
I20240207 22:29:27.327514 24268 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240207 22:29:27.327726 24365 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 22:29:27.327831 24499 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 22:29:27.327903 24635 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 22:29:27.328009 24432 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 22:29:27.328213 24568 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 22:29:27.328281 24700 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
E20240207 22:29:28.989583 24700 recstore.cc:66] init folly done
E20240207 22:29:28.989629 24635 recstore.cc:66] init folly done
E20240207 22:29:28.989646 24499 recstore.cc:66] init folly done
E20240207 22:29:28.989660 24568 recstore.cc:66] init folly done
E20240207 22:29:28.989720 24268 recstore.cc:66] init folly done
E20240207 22:29:28.989811 24432 recstore.cc:66] init folly done
E20240207 22:29:28.989828 24365 recstore.cc:66] init folly done
I20240207 22:29:35.794363 24635 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240207 22:29:35.866159 24365 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 22:29:36.962129 24499 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 22:29:37.236384 24432 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 22:29:37.911968 24568 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 22:29:38.516299 24268 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 22:29:38.778601 24700 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.899 ms                  | 8.765 ms                  |
| Forward                   | 5.008 ms                  | 396.420 ms                |
| back: bucket keys         | 564.779 us                | 20.278 ms                 |
| back: a2a                 | 62.410 ms                 | 1.294 s                   |
| back: cache               | 8.498 ms                  | 111.165 ms                |
| back: aggr dram keys      | 140.935 ms                | 861.593 ms                |
| back: set dram grad       | 5.827 ms                  | 27.083 ms                 |
| Backward                  | 2.856 s                   | 2.856 s                   |
| Optimize                  | 160.054 ms                | 160.054 ms                |
| BarrierTimeBeforeRank0    | 51.086 us                 | 51.086 us                 |
| BlockToStepN              | 327.744 us                | 327.744 us                |
| OneStep                   | 3.423 s                   | 3.423 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.490 ms                  | 342.839 ms                |
| Forward                   | 5.008 ms                  | 396.420 ms                |
| back: bucket keys         | 1.345 ms                  | 20.278 ms                 |
| back: a2a                 | 21.615 ms                 | 1.294 s                   |
| back: cache               | 8.498 ms                  | 128.798 ms                |
| back: aggr dram keys      | 75.894 ms                 | 861.593 ms                |
| back: set dram grad       | 9.872 ms                  | 27.887 ms                 |
| Backward                  | 330.717 ms                | 2.856 s                   |
| Optimize                  | 98.946 ms                 | 160.054 ms                |
| BarrierTimeBeforeRank0    | 47.116 us                 | 106.289 us                |
| BlockToStepN              | 47.440 us                 | 20.682 ms                 |
| OneStep                   | 449.739 ms                | 3.423 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.414 ms                  | 342.839 ms                |
| Forward                   | 4.923 ms                  | 396.420 ms                |
| back: bucket keys         | 1.282 ms                  | 20.278 ms                 |
| back: a2a                 | 22.056 ms                 | 1.294 s                   |
| back: cache               | 8.498 ms                  | 128.798 ms                |
| back: aggr dram keys      | 65.987 ms                 | 861.593 ms                |
| back: set dram grad       | 8.014 ms                  | 54.068 ms                 |
| Backward                  | 283.096 ms                | 2.856 s                   |
| Optimize                  | 98.946 ms                 | 160.054 ms                |
| BarrierTimeBeforeRank0    | 49.112 us                 | 106.289 us                |
| BlockToStepN              | 47.440 us                 | 20.682 ms                 |
| OneStep                   | 402.153 ms                | 3.423 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.414 ms                  | 342.839 ms                |
| Forward                   | 4.870 ms                  | 396.420 ms                |
| back: bucket keys         | 601.853 us                | 1.448 ms                  |
| back: a2a                 | 22.495 ms                 | 73.593 ms                 |
| back: cache               | 8.498 ms                  | 111.165 ms                |
| back: aggr dram keys      | 65.988 ms                 | 140.935 ms                |
| back: set dram grad       | 8.055 ms                  | 29.684 ms                 |
| Backward                  | 283.096 ms                | 2.856 s                   |
| Optimize                  | 98.873 ms                 | 160.054 ms                |
| BarrierTimeBeforeRank0    | 48.088 us                 | 106.289 us                |
| BlockToStepN              | 46.448 us                 | 20.682 ms                 |
| OneStep                   | 398.505 ms                | 3.423 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.414 ms                  | 342.839 ms                |
| Forward                   | 4.870 ms                  | 396.420 ms                |
| back: bucket keys         | 601.853 us                | 1.448 ms                  |
| back: a2a                 | 22.546 ms                 | 174.979 ms                |
| back: cache               | 8.498 ms                  | 111.165 ms                |
| back: aggr dram keys      | 64.053 ms                 | 140.935 ms                |
| back: set dram grad       | 8.055 ms                  | 29.684 ms                 |
| Backward                  | 278.465 ms                | 2.856 s                   |
| Optimize                  | 98.873 ms                 | 160.054 ms                |
| BarrierTimeBeforeRank0    | 46.465 us                 | 106.289 us                |
| BlockToStepN              | 42.763 us                 | 20.682 ms                 |
| OneStep                   | 389.851 ms                | 3.423 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.569 ms                  | 304.938 ms                |
| Forward                   | 4.870 ms                  | 29.446 ms                 |
| back: bucket keys         | 601.853 us                | 1.448 ms                  |
| back: a2a                 | 22.565 ms                 | 174.979 ms                |
| back: cache               | 8.498 ms                  | 111.165 ms                |
| back: aggr dram keys      | 62.478 ms                 | 140.935 ms                |
| back: set dram grad       | 8.055 ms                  | 29.684 ms                 |
| Backward                  | 278.135 ms                | 414.374 ms                |
| Optimize                  | 99.610 ms                 | 123.522 ms                |
| BarrierTimeBeforeRank0    | 44.043 us                 | 92.824 us                 |
| BlockToStepN              | 42.799 us                 | 3.856 ms                  |
| OneStep                   | 390.219 ms                | 708.954 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.834 ms                  | 304.938 ms                |
| Forward                   | 4.870 ms                  | 29.446 ms                 |
| back: bucket keys         | 784.703 us                | 1.694 ms                  |
| back: a2a                 | 22.620 ms                 | 174.979 ms                |
| back: cache               | 8.498 ms                  | 111.165 ms                |
| back: aggr dram keys      | 63.359 ms                 | 140.935 ms                |
| back: set dram grad       | 8.055 ms                  | 29.684 ms                 |
| Backward                  | 278.465 ms                | 414.374 ms                |
| Optimize                  | 100.747 ms                | 127.653 ms                |
| BarrierTimeBeforeRank0    | 40.913 us                 | 92.824 us                 |
| BlockToStepN              | 43.867 us                 | 3.856 ms                  |
| OneStep                   | 392.095 ms                | 708.954 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.551 ms                  | 304.938 ms                |
| Forward                   | 4.859 ms                  | 29.446 ms                 |
| back: bucket keys         | 784.703 us                | 1.724 ms                  |
| back: a2a                 | 22.666 ms                 | 152.574 ms                |
| back: cache               | 8.498 ms                  | 94.936 ms                 |
| back: aggr dram keys      | 61.886 ms                 | 121.161 ms                |
| back: set dram grad       | 8.055 ms                  | 29.320 ms                 |
| Backward                  | 273.869 ms                | 414.374 ms                |
| Optimize                  | 100.747 ms                | 127.653 ms                |
| BarrierTimeBeforeRank0    | 40.913 us                 | 92.824 us                 |
| BlockToStepN              | 42.763 us                 | 3.856 ms                  |
| OneStep                   | 389.851 ms                | 708.954 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.551 ms                  | 304.938 ms                |
| Forward                   | 4.811 ms                  | 29.446 ms                 |
| back: bucket keys         | 614.520 us                | 1.724 ms                  |
| back: a2a                 | 22.620 ms                 | 152.574 ms                |
| back: cache               | 8.498 ms                  | 94.936 ms                 |
| back: aggr dram keys      | 61.789 ms                 | 121.161 ms                |
| back: set dram grad       | 8.055 ms                  | 29.320 ms                 |
| Backward                  | 272.579 ms                | 414.374 ms                |
| Optimize                  | 101.342 ms                | 127.653 ms                |
| BarrierTimeBeforeRank0    | 39.909 us                 | 92.824 us                 |
| BlockToStepN              | 42.173 us                 | 3.856 ms                  |
| OneStep                   | 389.117 ms                | 708.954 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 44.111, sample: 2.516, forward: 0.893, backward: 16.985, update: 0.349
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 44.715, sample: 1.284, forward: 0.849, backward: 17.653, update: 0.319
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 45.391, sample: 1.132, forward: 0.858, backward: 17.970, update: 0.322
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 46.761, sample: 1.208, forward: 0.853, backward: 17.914, update: 0.322
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 43.849, sample: 1.402, forward: 0.840, backward: 17.830, update: 0.349
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 45.665, sample: 1.630, forward: 0.868, backward: 17.207, update: 0.308
train_sampler.Prefill()
-------Step 0-------
tensor([ 4313550,   306846,   306892,   306930,   496191,   587918, 32055934,
          496210,   496229,    30550]) tensor([11871307, 26089803, 66017051, 51279768, 79699761, 54423770, 46016828,
        38879464, 72968128, 45471436])
-------Step 1-------
tensor([ 4313550,   306846,   306892,   306930,   496191,   587918, 32055934,
          496210,   496229,    30550]) tensor([41167427, 15695522, 18473443, 12644134, 49362311, 29502903, 77481198,
        17364690, 16900844, 36780994])
-------Step 2-------
tensor([  542475,   318637,   542492,   542511,   542529, 32056500,   593004,
          542549,   593014,   542569]) tensor([28932108,  7830618, 81566256,  1531326, 76160773, 22981706, 58803874,
           39987, 32796055, 68392838])
-------Step 3-------
tensor([  542475,   318637,   542492,   542511,   542529, 32056500,   593004,
          542549,   593014,   542569]) tensor([52698942, 12448262, 22832518,     4040, 40136886, 48053113, 50512579,
        55908020, 68885911, 77798065])
-------Step 4-------
tensor([  597910,   329822,   587763,   597920, 32055934,   238414,   329869,
        47296982,   587774,  4768684]) tensor([84565785, 54085196, 54155026, 14227219, 46018862, 42757729, 16581638,
        66123967, 80524019, 25509365])
-------Step 5-------
tensor([  597910,   329822,   587763,   597920, 32055934,   238414,   329869,
        47296982,   587774,  4768684]) tensor([32874532, 24194612,  9575548, 66407696, 56667378, 67503551,  9971080,
        70019287, 63282942, 65958313])
-------Step 6-------
tensor([ 489887, 4313550,    2489,    2513,   89286,  339770,    2541,    2560,
           2589,    2620]) tensor([37589515, 19397324, 79642518, 37089419, 56612710, 33934544, 37417300,
        38263666, 14974118, 49939200])
-------Step 7-------
tensor([ 489887, 4313550,    2489,    2513,   89286,  339770,    2541,    2560,
           2589,    2620]) tensor([36790009,  5531558, 71643124, 37091636, 70851017, 41146100,  5729611,
        19911951, 36261067,  4833762])
-------Step 8-------
tensor([  490544,    63091,    63114,    63138, 82888439,  4313550,    63166,
         4749985,   607377,    63195]) tensor([77965677,  9260719, 54603172, 64618425, 31455309, 43912648,  4955102,
        34175855, 24407170,   153725])
-------Step 9-------
tensor([  490544,    63091,    63114,    63138, 82888439,  4313550,    63166,
         4749985,   607377,    63195]) tensor([21805935, 16655555, 76748650, 52667232, 47563830, 18941053, 39148510,
        14058730, 52720561, 71655169])
before start barrier
start train
[proc 0] 100 steps, total: 46.833, sample: 2.054, forward: 0.909, backward: 30.766, update: 9.988
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.606 ms                  | 304.938 ms                |
| Forward                   | 4.811 ms                  | 29.446 ms                 |
| back: bucket keys         | 784.703 us                | 1.724 ms                  |
| back: a2a                 | 22.737 ms                 | 152.574 ms                |
| back: cache               | 8.498 ms                  | 94.936 ms                 |
| back: aggr dram keys      | 61.943 ms                 | 121.161 ms                |
| back: set dram grad       | 8.055 ms                  | 29.320 ms                 |
| Backward                  | 272.606 ms                | 414.374 ms                |
| Optimize                  | 101.485 ms                | 128.328 ms                |
| BarrierTimeBeforeRank0    | 39.761 us                 | 92.824 us                 |
| BlockToStepN              | 42.173 us                 | 10.452 ms                 |
| OneStep                   | 390.219 ms                | 708.954 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.562 ms                  | 304.938 ms                |
| Forward                   | 4.824 ms                  | 29.446 ms                 |
| back: bucket keys         | 784.703 us                | 1.724 ms                  |
| back: a2a                 | 22.763 ms                 | 152.574 ms                |
| back: cache               | 8.498 ms                  | 94.936 ms                 |
| back: aggr dram keys      | 61.971 ms                 | 121.161 ms                |
| back: set dram grad       | 8.055 ms                  | 29.320 ms                 |
| Backward                  | 273.026 ms                | 414.374 ms                |
| Optimize                  | 101.528 ms                | 131.412 ms                |
| BarrierTimeBeforeRank0    | 39.195 us                 | 92.824 us                 |
| BlockToStepN              | 42.763 us                 | 20.682 ms                 |
| OneStep                   | 390.945 ms                | 708.954 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.979 ms                  | 304.938 ms                |
| Forward                   | 4.811 ms                  | 29.446 ms                 |
| back: bucket keys         | 614.520 us                | 1.694 ms                  |
| back: a2a                 | 22.709 ms                 | 148.087 ms                |
| back: cache               | 8.498 ms                  | 90.746 ms                 |
| back: aggr dram keys      | 61.971 ms                 | 116.176 ms                |
| back: set dram grad       | 8.055 ms                  | 29.320 ms                 |
| Backward                  | 273.026 ms                | 414.374 ms                |
| Optimize                  | 101.919 ms                | 131.412 ms                |
| BarrierTimeBeforeRank0    | 38.940 us                 | 92.824 us                 |
| BlockToStepN              | 42.763 us                 | 20.682 ms                 |
| OneStep                   | 390.715 ms                | 708.954 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.211 ms                  | 304.938 ms                |
| Forward                   | 4.811 ms                  | 29.446 ms                 |
| back: bucket keys         | 614.520 us                | 1.694 ms                  |
| back: a2a                 | 22.647 ms                 | 148.087 ms                |
| back: cache               | 8.498 ms                  | 90.746 ms                 |
| back: aggr dram keys      | 61.886 ms                 | 116.176 ms                |
| back: set dram grad       | 8.055 ms                  | 29.320 ms                 |
| Backward                  | 272.069 ms                | 414.374 ms                |
| Optimize                  | 101.679 ms                | 131.412 ms                |
| BarrierTimeBeforeRank0    | 38.940 us                 | 92.824 us                 |
| BlockToStepN              | 40.360 us                 | 20.682 ms                 |
| OneStep                   | 389.117 ms                | 708.954 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.211 ms                  | 236.007 ms                |
| Forward                   | 4.811 ms                  | 18.311 ms                 |
| back: bucket keys         | 614.520 us                | 1.760 ms                  |
| back: a2a                 | 22.620 ms                 | 148.087 ms                |
| back: cache               | 29.825 ms                 | 90.746 ms                 |
| back: aggr dram keys      | 62.045 ms                 | 116.176 ms                |
| back: set dram grad       | 8.055 ms                  | 29.320 ms                 |
| Backward                  | 271.926 ms                | 396.473 ms                |
| Optimize                  | 101.919 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.692 us                 | 91.388 us                 |
| BlockToStepN              | 41.806 us                 | 19.863 ms                 |
| OneStep                   | 388.384 ms                | 684.845 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.492 ms                  | 236.007 ms                |
| Forward                   | 4.811 ms                  | 18.311 ms                 |
| back: bucket keys         | 614.520 us                | 1.760 ms                  |
| back: a2a                 | 22.578 ms                 | 148.087 ms                |
| back: cache               | 29.825 ms                 | 90.746 ms                 |
| back: aggr dram keys      | 62.478 ms                 | 116.176 ms                |
| back: set dram grad       | 8.055 ms                  | 30.352 ms                 |
| Backward                  | 272.606 ms                | 396.473 ms                |
| Optimize                  | 101.540 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.577 us                 | 91.388 us                 |
| BlockToStepN              | 42.144 us                 | 19.863 ms                 |
| OneStep                   | 389.845 ms                | 684.845 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.512 ms                  | 236.007 ms                |
| Forward                   | 4.819 ms                  | 18.311 ms                 |
| back: bucket keys         | 816.160 us                | 1.760 ms                  |
| back: a2a                 | 22.555 ms                 | 73.593 ms                 |
| back: cache               | 29.825 ms                 | 86.704 ms                 |
| back: aggr dram keys      | 62.066 ms                 | 105.649 ms                |
| back: set dram grad       | 8.055 ms                  | 29.684 ms                 |
| Backward                  | 272.069 ms                | 396.473 ms                |
| Optimize                  | 101.528 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.577 us                 | 91.388 us                 |
| BlockToStepN              | 41.884 us                 | 19.863 ms                 |
| OneStep                   | 389.117 ms                | 684.845 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.512 ms                  | 236.007 ms                |
| Forward                   | 4.819 ms                  | 18.311 ms                 |
| back: bucket keys         | 784.703 us                | 1.760 ms                  |
| back: a2a                 | 22.532 ms                 | 73.593 ms                 |
| back: cache               | 29.825 ms                 | 86.704 ms                 |
| back: aggr dram keys      | 62.339 ms                 | 105.649 ms                |
| back: set dram grad       | 8.055 ms                  | 29.684 ms                 |
| Backward                  | 271.727 ms                | 396.473 ms                |
| Optimize                  | 101.919 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.577 us                 | 91.388 us                 |
| BlockToStepN              | 41.328 us                 | 19.863 ms                 |
| OneStep                   | 388.275 ms                | 684.845 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 40.329, sample: 1.146, forward: 0.503, backward: 15.155, update: 0.316
[proc 4] 200 steps, total: 40.329, sample: 1.315, forward: 0.465, backward: 14.765, update: 0.306
[proc 6] 200 steps, total: 40.329, sample: 1.257, forward: 0.490, backward: 15.073, update: 0.304
[proc 1] 200 steps, total: 40.329, sample: 2.141, forward: 0.519, backward: 14.610, update: 0.318
[proc 3] 200 steps, total: 40.329, sample: 1.149, forward: 0.524, backward: 15.122, update: 0.289
[proc 5] 200 steps, total: 40.329, sample: 1.370, forward: 0.468, backward: 14.796, update: 0.281
[proc 0] 200 steps, total: 40.329, sample: 2.182, forward: 0.487, backward: 27.282, update: 10.207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.512 ms                  | 236.007 ms                |
| Forward                   | 4.811 ms                  | 18.311 ms                 |
| back: bucket keys         | 784.703 us                | 1.760 ms                  |
| back: a2a                 | 22.547 ms                 | 73.593 ms                 |
| back: cache               | 29.825 ms                 | 86.704 ms                 |
| back: aggr dram keys      | 62.339 ms                 | 105.649 ms                |
| back: set dram grad       | 8.055 ms                  | 30.352 ms                 |
| Backward                  | 271.727 ms                | 396.473 ms                |
| Optimize                  | 101.528 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.516 us                 | 91.388 us                 |
| BlockToStepN              | 41.806 us                 | 19.863 ms                 |
| OneStep                   | 388.275 ms                | 684.845 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.284 ms                  | 236.007 ms                |
| Forward                   | 4.821 ms                  | 29.446 ms                 |
| back: bucket keys         | 784.703 us                | 1.760 ms                  |
| back: a2a                 | 22.547 ms                 | 73.593 ms                 |
| back: cache               | 29.825 ms                 | 86.704 ms                 |
| back: aggr dram keys      | 63.289 ms                 | 105.649 ms                |
| back: set dram grad       | 9.681 ms                  | 30.352 ms                 |
| Backward                  | 271.926 ms                | 396.473 ms                |
| Optimize                  | 101.523 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.508 us                 | 91.388 us                 |
| BlockToStepN              | 42.173 us                 | 19.863 ms                 |
| OneStep                   | 388.384 ms                | 684.845 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.284 ms                  | 236.007 ms                |
| Forward                   | 4.819 ms                  | 29.446 ms                 |
| back: bucket keys         | 784.703 us                | 1.760 ms                  |
| back: a2a                 | 22.547 ms                 | 70.965 ms                 |
| back: cache               | 29.825 ms                 | 84.586 ms                 |
| back: aggr dram keys      | 62.478 ms                 | 105.133 ms                |
| back: set dram grad       | 9.681 ms                  | 30.333 ms                 |
| Backward                  | 272.069 ms                | 396.473 ms                |
| Optimize                  | 101.405 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.577 us                 | 91.388 us                 |
| BlockToStepN              | 42.208 us                 | 19.863 ms                 |
| OneStep                   | 387.564 ms                | 684.845 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.211 ms                  | 236.007 ms                |
| Forward                   | 4.811 ms                  | 29.446 ms                 |
| back: bucket keys         | 784.703 us                | 1.760 ms                  |
| back: a2a                 | 22.547 ms                 | 70.965 ms                 |
| back: cache               | 29.825 ms                 | 84.586 ms                 |
| back: aggr dram keys      | 62.478 ms                 | 105.649 ms                |
| back: set dram grad       | 9.681 ms                  | 30.333 ms                 |
| Backward                  | 271.537 ms                | 396.473 ms                |
| Optimize                  | 101.330 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.516 us                 | 91.388 us                 |
| BlockToStepN              | 42.526 us                 | 19.863 ms                 |
| OneStep                   | 387.181 ms                | 684.845 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.916 ms                  | 216.361 ms                |
| Forward                   | 4.819 ms                  | 19.017 ms                 |
| back: bucket keys         | 784.703 us                | 1.760 ms                  |
| back: a2a                 | 22.506 ms                 | 70.965 ms                 |
| back: cache               | 29.825 ms                 | 84.586 ms                 |
| back: aggr dram keys      | 63.289 ms                 | 105.649 ms                |
| back: set dram grad       | 9.681 ms                  | 30.352 ms                 |
| Backward                  | 271.500 ms                | 390.228 ms                |
| Optimize                  | 101.277 ms                | 128.328 ms                |
| BarrierTimeBeforeRank0    | 38.510 us                 | 79.725 us                 |
| BlockToStepN              | 42.526 us                 | 14.514 ms                 |
| OneStep                   | 387.181 ms                | 623.911 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.629 ms                  | 216.361 ms                |
| Forward                   | 4.822 ms                  | 19.017 ms                 |
| back: bucket keys         | 784.703 us                | 1.760 ms                  |
| back: a2a                 | 22.462 ms                 | 70.965 ms                 |
| back: cache               | 29.825 ms                 | 86.704 ms                 |
| back: aggr dram keys      | 62.805 ms                 | 110.990 ms                |
| back: set dram grad       | 9.681 ms                  | 31.267 ms                 |
| Backward                  | 271.727 ms                | 390.752 ms                |
| Optimize                  | 101.342 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.508 us                 | 79.725 us                 |
| BlockToStepN              | 42.930 us                 | 14.514 ms                 |
| OneStep                   | 387.399 ms                | 623.911 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.562 ms                  | 216.361 ms                |
| Forward                   | 4.823 ms                  | 19.017 ms                 |
| back: bucket keys         | 784.703 us                | 1.782 ms                  |
| back: a2a                 | 22.334 ms                 | 66.687 ms                 |
| back: cache               | 29.825 ms                 | 84.586 ms                 |
| back: aggr dram keys      | 63.289 ms                 | 105.649 ms                |
| back: set dram grad       | 9.681 ms                  | 30.352 ms                 |
| Backward                  | 271.537 ms                | 390.752 ms                |
| Optimize                  | 101.375 ms                | 130.841 ms                |
| BarrierTimeBeforeRank0    | 38.692 us                 | 91.388 us                 |
| BlockToStepN              | 42.915 us                 | 14.514 ms                 |
| OneStep                   | 387.564 ms                | 623.911 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 39.000, sample: 1.045, forward: 0.483, backward: 14.699, update: 0.297
[proc 6] 300 steps, total: 39.000, sample: 1.133, forward: 0.526, backward: 14.814, update: 0.284
[proc 1] 300 steps, total: 39.000, sample: 1.609, forward: 0.511, backward: 14.511, update: 0.322
[proc 5] 300 steps, total: 39.000, sample: 1.100, forward: 0.478, backward: 14.390, update: 0.276
[proc 4] 300 steps, total: 39.000, sample: 1.121, forward: 0.474, backward: 14.380, update: 0.286
[proc 2] 300 steps, total: 39.001, sample: 1.055, forward: 0.498, backward: 14.640, update: 0.287
[proc 0] 300 steps, total: 39.000, sample: 1.614, forward: 0.530, backward: 27.156, update: 9.534
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.535 ms                  | 216.361 ms                |
| Forward                   | 4.824 ms                  | 19.017 ms                 |
| back: bucket keys         | 816.160 us                | 1.782 ms                  |
| back: a2a                 | 22.189 ms                 | 66.687 ms                 |
| back: cache               | 29.825 ms                 | 84.586 ms                 |
| back: aggr dram keys      | 64.053 ms                 | 105.649 ms                |
| back: set dram grad       | 9.681 ms                  | 30.352 ms                 |
| Backward                  | 270.680 ms                | 390.752 ms                |
| Optimize                  | 101.330 ms                | 130.841 ms                |
| BarrierTimeBeforeRank0    | 38.780 us                 | 91.388 us                 |
| BlockToStepN              | 42.777 us                 | 19.802 ms                 |
| OneStep                   | 387.048 ms                | 623.911 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.058 ms                  | 216.361 ms                |
| Forward                   | 4.834 ms                  | 19.017 ms                 |
| back: bucket keys         | 784.703 us                | 1.782 ms                  |
| back: a2a                 | 21.978 ms                 | 68.689 ms                 |
| back: cache               | 29.825 ms                 | 84.586 ms                 |
| back: aggr dram keys      | 64.468 ms                 | 105.649 ms                |
| back: set dram grad       | 9.681 ms                  | 30.352 ms                 |
| Backward                  | 270.555 ms                | 390.752 ms                |
| Optimize                  | 101.139 ms                | 130.841 ms                |
| BarrierTimeBeforeRank0    | 38.780 us                 | 91.388 us                 |
| BlockToStepN              | 42.799 us                 | 19.802 ms                 |
| OneStep                   | 385.875 ms                | 623.911 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.881 ms                  | 216.361 ms                |
| Forward                   | 4.834 ms                  | 19.017 ms                 |
| back: bucket keys         | 816.160 us                | 1.760 ms                  |
| back: a2a                 | 21.725 ms                 | 66.687 ms                 |
| back: cache               | 29.825 ms                 | 82.753 ms                 |
| back: aggr dram keys      | 64.618 ms                 | 105.649 ms                |
| back: set dram grad       | 9.681 ms                  | 30.352 ms                 |
| Backward                  | 269.981 ms                | 390.752 ms                |
| Optimize                  | 100.771 ms                | 130.841 ms                |
| BarrierTimeBeforeRank0    | 38.660 us                 | 91.388 us                 |
| BlockToStepN              | 42.930 us                 | 19.802 ms                 |
| OneStep                   | 384.624 ms                | 623.911 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.716 ms                  | 216.361 ms                |
| Forward                   | 4.841 ms                  | 19.017 ms                 |
| back: bucket keys         | 776.783 us                | 1.760 ms                  |
| back: a2a                 | 21.397 ms                 | 66.687 ms                 |
| back: cache               | 29.825 ms                 | 82.753 ms                 |
| back: aggr dram keys      | 64.618 ms                 | 105.649 ms                |
| back: set dram grad       | 9.681 ms                  | 31.267 ms                 |
| Backward                  | 269.163 ms                | 390.752 ms                |
| Optimize                  | 100.406 ms                | 130.841 ms                |
| BarrierTimeBeforeRank0    | 38.660 us                 | 91.388 us                 |
| BlockToStepN              | 42.915 us                 | 19.802 ms                 |
| OneStep                   | 383.231 ms                | 623.911 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.683 ms                  | 194.484 ms                |
| Forward                   | 4.859 ms                  | 18.311 ms                 |
| back: bucket keys         | 784.703 us                | 1.760 ms                  |
| back: a2a                 | 21.138 ms                 | 66.687 ms                 |
| back: cache               | 19.708 ms                 | 82.753 ms                 |
| back: aggr dram keys      | 64.618 ms                 | 105.649 ms                |
| back: set dram grad       | 9.681 ms                  | 31.267 ms                 |
| Backward                  | 267.581 ms                | 390.228 ms                |
| Optimize                  | 100.039 ms                | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.510 us                 | 79.725 us                 |
| BlockToStepN              | 42.799 us                 | 17.953 ms                 |
| OneStep                   | 381.069 ms                | 609.507 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.236 ms                  | 194.484 ms                |
| Forward                   | 4.873 ms                  | 18.311 ms                 |
| back: bucket keys         | 776.783 us                | 1.782 ms                  |
| back: a2a                 | 20.277 ms                 | 66.687 ms                 |
| back: cache               | 19.343 ms                 | 82.753 ms                 |
| back: aggr dram keys      | 65.511 ms                 | 110.990 ms                |
| back: set dram grad       | 9.681 ms                  | 33.182 ms                 |
| Backward                  | 266.657 ms                | 390.228 ms                |
| Optimize                  | 99.719 ms                 | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.385 us                 | 79.725 us                 |
| BlockToStepN              | 42.636 us                 | 17.953 ms                 |
| OneStep                   | 380.021 ms                | 609.507 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 154.1425359249115 seconds
before call kg_cache_controller.StopThreads()
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
INFO [23174 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.035 ms                  | 194.484 ms                |
| Forward                   | 4.873 ms                  | 18.311 ms                 |
| back: bucket keys         | 776.783 us                | 1.760 ms                  |
| back: a2a                 | 20.059 ms                 | 64.402 ms                 |
| back: cache               | 19.332 ms                 | 80.591 ms                 |
| back: aggr dram keys      | 65.908 ms                 | 110.990 ms                |
| back: set dram grad       | 9.681 ms                  | 31.267 ms                 |
| Backward                  | 265.856 ms                | 390.228 ms                |
| Optimize                  | 99.610 ms                 | 128.858 ms                |
| BarrierTimeBeforeRank0    | 38.311 us                 | 79.725 us                 |
| BlockToStepN              | 42.830 us                 | 17.953 ms                 |
| OneStep                   | 379.436 ms                | 609.507 ms                |
+---------------------------+---------------------------+---------------------------+
