WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 15:13:07.958132 40110 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_97', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [40110 sampler.py:454] Start PreSampling
WARNING [40110 sampler.py:532] Before construct renumbering_dict
WARNING [40110 sampler.py:555] PreSampling done
W20240202 15:13:12.733394 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 15:13:12.733619 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 15:13:12.733668 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 15:13:12.733729 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 15:13:12.733781 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 15:13:12.733820 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 15:13:12.733868 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 15:13:12.733917 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 15:13:12.733968 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 15:13:12.734014 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 15:13:12.734061 40110 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 15:13:12.734097 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 15:13:12.734138 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 15:13:12.734277 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 15:13:12.734320 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 15:13:12.734364 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 15:13:12.734421 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 15:13:12.734464 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 15:13:12.734517 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 15:13:12.734570 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 15:13:12.734622 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 15:13:12.734666 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 15:13:12.734717 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 15:13:12.734763 40110 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 15:13:12.734798 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 15:13:12.734839 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 15:13:12.734911 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 15:13:12.734963 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 15:13:12.735002 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 15:13:12.735052 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 15:13:12.735100 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 15:13:12.735139 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 15:13:12.735183 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 15:13:12.735239 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 15:13:12.735288 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 15:13:12.735329 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 15:13:12.735369 40110 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 15:13:12.735404 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 15:13:12.735441 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 15:13:12.735514 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 15:13:12.735570 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 15:13:12.735615 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 15:13:12.735654 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 15:13:12.735693 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 15:13:12.735733 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 15:13:12.735775 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 15:13:12.735826 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 15:13:12.735879 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 15:13:12.735919 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 15:13:12.735970 40110 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 15:13:12.736002 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 15:13:12.736037 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 15:13:12.736120 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240202 15:13:12.736168 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240202 15:13:12.736217 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240202 15:13:12.736258 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240202 15:13:12.736297 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240202 15:13:12.736337 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240202 15:13:12.736377 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240202 15:13:12.736428 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240202 15:13:12.736472 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240202 15:13:12.736515 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240202 15:13:12.736562 40110 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240202 15:13:12.736598 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240202 15:13:12.736639 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240202 15:13:12.736707 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240202 15:13:12.736750 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240202 15:13:12.736791 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240202 15:13:12.736831 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240202 15:13:12.736872 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240202 15:13:12.736913 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240202 15:13:12.736954 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240202 15:13:12.737007 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240202 15:13:12.737054 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240202 15:13:12.737102 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240202 15:13:12.737149 40110 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240202 15:13:12.737183 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240202 15:13:12.737224 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240202 15:13:12.737293 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240202 15:13:12.737344 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240202 15:13:12.737396 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240202 15:13:12.737437 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240202 15:13:12.737484 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240202 15:13:12.737527 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240202 15:13:12.737568 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240202 15:13:12.737630 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240202 15:13:12.737672 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240202 15:13:12.737715 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240202 15:13:12.737762 40110 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240202 15:13:12.737798 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240202 15:13:12.737833 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240202 15:13:12.737905 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240202 15:13:12.737957 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240202 15:13:12.738010 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240202 15:13:12.738051 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240202 15:13:12.738096 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240202 15:13:12.738148 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240202 15:13:12.738193 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240202 15:13:12.738247 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240202 15:13:12.738298 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240202 15:13:12.738348 40110 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240202 15:13:12.738399 40110 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240202 15:13:12.738435 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240202 15:13:12.738474 40110 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240202 15:13:12.982151 40110 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240202 15:13:13.074726 40110 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([  744,  1090,  1561,  ..., 10026,  8778,  6924]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.215 seconds
[Rank1] pid = 40696
[Rank2] pid = 40747
[Rank3] pid = 40826
[Rank4] pid = 40827
[Rank5] pid = 40960
[Rank6] pid = 41024
INFO [40110 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [40696 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [40827 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [40826 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [40747 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [40696 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40110 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41024 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [41095 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [40960 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [41095 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40827 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40960 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41024 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40826 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40747 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240202 15:13:15.716123 41096 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240202 15:13:15.717231 40697 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240202 15:13:15.717916 41097 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240202 15:13:15.717947 40961 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240202 15:13:15.717974 41026 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240202 15:13:15.717975 40832 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240202 15:13:15.718168 40763 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240202 15:13:15.718179 40828 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240202 15:13:15.745888 41096 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100027a06000 7.629 MB
W20240202 15:13:15.746098 41096 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000281a9000 7.629 MB
W20240202 15:13:15.746183 41096 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10002894c000 1.49 GB
W20240202 15:13:15.746232 41096 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x100087f2f000 1.49 GB
W20240202 15:13:15.746304 41096 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 15:13:15.746572 40697 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000e7514000 7.629 MB
W20240202 15:13:15.746784 40697 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000e7cb7000 7.629 MB
W20240202 15:13:15.746876 40697 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1000e845a000 1.49 GB
W20240202 15:13:15.746929 40697 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100147a3d000 1.49 GB
W20240202 15:13:15.747005 40697 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 15:13:15.751008 41097 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1001a702e000 7.629 MB
W20240202 15:13:15.751046 41096 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 15:13:15.751076 41026 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1001a77d3000 7.629 MB
W20240202 15:13:15.751111 40832 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1001a7f76000 7.629 MB
W20240202 15:13:15.751134 40961 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1001a8719000 7.629 MB
W20240202 15:13:15.751140 40697 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 15:13:15.751188 41097 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1001a8ebc000 7.629 MB
W20240202 15:13:15.751228 40828 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1001a965f000 7.629 MB
W20240202 15:13:15.751237 40763 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1001a9e02000 7.629 MB
W20240202 15:13:15.751277 41097 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1001aa5a5000 1.49 GB
W20240202 15:13:15.751293 41026 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100209b88000 7.629 MB
W20240202 15:13:15.751344 40832 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10020a32b000 7.629 MB
W20240202 15:13:15.751358 41097 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10020aace000 1.49 GB
W20240202 15:13:15.751365 40961 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10026a0b1000 7.629 MB
W20240202 15:13:15.751405 41026 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10026a854000 1.49 GB
W20240202 15:13:15.751415 41097 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240202 15:13:15.751446 40832 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1002c9e37000 1.49 GB
W20240202 15:13:15.751464 40961 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10032941a000 1.49 GB
W20240202 15:13:15.751472 41026 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1003889fd000 1.49 GB
W20240202 15:13:15.751489 40763 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1003e7fe0000 7.629 MB
W20240202 15:13:15.751506 40828 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1003e8783000 7.629 MB
W20240202 15:13:15.751523 40832 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1003e8f26000 1.49 GB
W20240202 15:13:15.751545 41026 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240202 15:13:15.751549 40961 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x100448509000 1.49 GB
W20240202 15:13:15.751577 40832 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 15:13:15.751593 40961 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 15:13:15.751608 40828 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1004a7aec000 1.49 GB
W20240202 15:13:15.751616 40763 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1005070cf000 1.49 GB
W20240202 15:13:15.751694 40763 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1005666b2000 1.49 GB
W20240202 15:13:15.751709 40828 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1005c5c95000 1.49 GB
W20240202 15:13:15.751746 40763 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 15:13:15.751755 40828 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 15:13:15.763025 40763 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 15:13:15.763038 41026 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240202 15:13:15.763064 40832 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 15:13:15.763077 41097 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240202 15:13:15.764529 40828 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 15:13:15.773741 40961 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [40826 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [41095 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [40827 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [40960 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [41024 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 41095
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [40110 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [40747 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [40696 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 15:13:18.493119 40697 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240202 15:13:18.494676 41096 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 15:13:18.494764 41026 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 15:13:18.494845 40961 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 15:13:18.495129 40763 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 15:13:18.495378 41097 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 15:13:18.495493 40828 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 15:13:18.495579 40832 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240202 15:13:18.501888 41096 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240202 15:13:18.502219 41096 grad_base.h:184] Init GradProcessingBase done
I20240202 15:13:18.513832 41096 grad_async_v1.h:203] Use main thread to update emb.
W20240202 15:13:18.514025 41096 kg_controller.h:75] after init GradAsyncProcessing
I20240202 15:13:18.514043 41096 kg_controller.h:84] Construct KGCacheController done
E20240202 15:13:19.305518 40763 recstore.cc:66] init folly done
E20240202 15:13:19.305722 41026 recstore.cc:66] init folly done
E20240202 15:13:19.305675 40961 recstore.cc:66] init folly done
E20240202 15:13:19.306198 41097 recstore.cc:66] init folly done
E20240202 15:13:19.306566 40832 recstore.cc:66] init folly done
E20240202 15:13:19.306646 41096 recstore.cc:66] init folly done
E20240202 15:13:19.306653 40697 recstore.cc:66] init folly done
E20240202 15:13:19.306646 40828 recstore.cc:66] init folly done
I20240202 15:13:19.307451 41096 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240202 15:13:20.135834 40961 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240202 15:13:20.150621 40697 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 15:13:20.154004 40828 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 15:13:20.154284 40832 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 15:13:20.162567 41026 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 15:13:20.164011 41096 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 15:13:20.174563 40763 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 15:13:20.174726 41097 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240202 15:13:22.614190 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.079 ms                  | 31.914 ms                 |
| Forward                   | 5.642 ms                  | 725.884 ms                |
| Backward                  | 8.975 ms                  | 285.255 ms                |
| Optimize                  | 4.410 ms                  | 11.127 ms                 |
| BarrierTimeBeforeRank0    | 105.808 us                | 6.819 ms                  |
| AfterBackward             | 29.978 ms                 | 1.416 s                   |
| BlockToStepN              | 40.335 us                 | 35.197 ms                 |
| OneStep                   | 53.487 ms                 | 2.475 s                   |
+---------------------------+---------------------------+---------------------------+
E20240202 15:13:23.604307 41616 grad_async_v1.h:533] Stalled in ProcessBackward: rank=2, step_no=17, sample_step_cpp_seen_[rank]=16
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.094 ms                  | 362.154 ms                |
| ProcessBack:UpdateCache   | 9.007 ms                  | 723.542 ms                |
| ProcessBack:UpsertPq      | 11.126 ms                 | 19.757 ms                 |
| ProcessOneStep            | 29.802 ms                 | 1.415 s                   |
| BlockToStepN              | 402.000 ns                | 34.633 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240202 15:13:24.356237 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=18, pq.top=18
W20240202 15:13:25.360059 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=30, pq.top=30
W20240202 15:13:26.360015 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240202 15:13:27.360011 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=34, pq.top=34
W20240202 15:13:28.360023 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.137 ms                  | 31.914 ms                 |
| Forward                   | 5.568 ms                  | 725.884 ms                |
| Backward                  | 9.036 ms                  | 285.255 ms                |
| Optimize                  | 3.231 ms                  | 11.127 ms                 |
| BarrierTimeBeforeRank0    | 455.138 us                | 11.491 ms                 |
| AfterBackward             | 30.647 ms                 | 1.416 s                   |
| BlockToStepN              | 6.549 ms                  | 919.014 ms                |
| OneStep                   | 66.318 ms                 | 2.475 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.260 ms                  | 329.944 ms                |
| ProcessBack:UpdateCache   | 9.138 ms                  | 723.242 ms                |
| ProcessBack:UpsertPq      | 11.913 ms                 | 59.211 ms                 |
| ProcessOneStep            | 30.613 ms                 | 1.415 s                   |
| BlockToStepN              | 12.935 ms                 | 918.678 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:13:29.360004 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240202 15:13:30.360005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240202 15:13:31.360018 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=42, pq.top=42
W20240202 15:13:32.360008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240202 15:13:33.360014 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=48, pq.top=48
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.535 ms                  | 31.914 ms                 |
| Forward                   | 5.713 ms                  | 725.884 ms                |
| Backward                  | 9.117 ms                  | 285.255 ms                |
| Optimize                  | 2.819 ms                  | 11.127 ms                 |
| BarrierTimeBeforeRank0    | 523.141 us                | 13.077 ms                 |
| AfterBackward             | 31.402 ms                 | 1.416 s                   |
| BlockToStepN              | 21.548 ms                 | 919.014 ms                |
| OneStep                   | 75.820 ms                 | 2.475 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.378 ms                  | 329.944 ms                |
| ProcessBack:UpdateCache   | 9.284 ms                  | 723.242 ms                |
| ProcessBack:UpsertPq      | 12.953 ms                 | 59.211 ms                 |
| ProcessOneStep            | 32.127 ms                 | 1.415 s                   |
| BlockToStepN              | 21.486 ms                 | 918.678 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:13:34.360006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240202 15:13:35.360006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=54, pq.top=54
W20240202 15:13:36.360019 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240202 15:13:37.360006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=60, pq.top=60
W20240202 15:13:38.392076 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=64, pq.top=64
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.595 ms                  | 31.914 ms                 |
| Forward                   | 5.707 ms                  | 12.938 ms                 |
| Backward                  | 9.117 ms                  | 10.836 ms                 |
| Optimize                  | 2.749 ms                  | 9.667 ms                  |
| BarrierTimeBeforeRank0    | 891.867 us                | 12.071 ms                 |
| AfterBackward             | 32.915 ms                 | 769.284 ms                |
| BlockToStepN              | 222.131 ms                | 909.287 ms                |
| OneStep                   | 285.241 ms                | 1.020 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.485 ms                  | 329.944 ms                |
| ProcessBack:UpdateCache   | 9.221 ms                  | 723.242 ms                |
| ProcessBack:UpsertPq      | 14.467 ms                 | 59.211 ms                 |
| ProcessOneStep            | 32.936 ms                 | 769.145 ms                |
| BlockToStepN              | 226.068 ms                | 909.154 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:13:39.392006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240202 15:13:40.392014 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
W20240202 15:13:41.392010 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240202 15:13:42.392006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=76, pq.top=76
W20240202 15:13:43.392376 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 31.914 ms                 |
| Forward                   | 5.686 ms                  | 12.938 ms                 |
| Backward                  | 9.108 ms                  | 10.836 ms                 |
| Optimize                  | 2.729 ms                  | 9.667 ms                  |
| BarrierTimeBeforeRank0    | 1.282 ms                  | 14.484 ms                 |
| AfterBackward             | 33.423 ms                 | 769.284 ms                |
| BlockToStepN              | 245.680 ms                | 909.287 ms                |
| OneStep                   | 309.411 ms                | 1.020 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.485 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.310 ms                  | 12.554 ms                 |
| ProcessBack:UpsertPq      | 14.907 ms                 | 52.830 ms                 |
| ProcessOneStep            | 33.440 ms                 | 769.145 ms                |
| BlockToStepN              | 246.784 ms                | 909.154 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:13:44.392014 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=82, pq.top=82
W20240202 15:13:45.392007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240202 15:13:46.437733 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=88, pq.top=88
W20240202 15:13:47.437005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240202 15:13:48.437005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=94, pq.top=94
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 31.914 ms                 |
| Forward                   | 5.642 ms                  | 12.938 ms                 |
| Backward                  | 9.044 ms                  | 13.177 ms                 |
| Optimize                  | 2.694 ms                  | 9.667 ms                  |
| BarrierTimeBeforeRank0    | 1.472 ms                  | 33.910 ms                 |
| AfterBackward             | 33.664 ms                 | 769.284 ms                |
| BlockToStepN              | 254.984 ms                | 909.287 ms                |
| OneStep                   | 319.920 ms                | 1.020 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.328 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.619 ms                  | 12.554 ms                 |
| ProcessBack:UpsertPq      | 15.074 ms                 | 52.830 ms                 |
| ProcessOneStep            | 33.665 ms                 | 769.145 ms                |
| BlockToStepN              | 254.789 ms                | 909.154 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:13:49.439785 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240202 15:13:50.439019 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=100, pq.top=100
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 30.513, sample: 0.500, forward: 1.122, backward: 1.170, update: 0.258
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 30.513, sample: 0.430, forward: 1.161, backward: 1.142, update: 0.272
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 30.533, sample: 0.466, forward: 1.117, backward: 1.236, update: 0.273
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 30.525, sample: 0.486, forward: 1.219, backward: 1.250, update: 0.293
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 30.552, sample: 0.457, forward: 1.117, backward: 1.254, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 30.533, sample: 0.442, forward: 1.123, backward: 1.273, update: 0.265
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 30.537, sample: 0.574, forward: 1.223, backward: 0.936, update: 0.269
train_sampler.Prefill()
-------Step 0-------
tensor([ 2157,    70,  3480,    56, 11569, 12810,  1095,  7436, 13722, 11380]) tensor([ 1561,  8876,  6522, 11104, 12394,  1073,  5571,  5491,   531, 12006])
-------Step 1-------
tensor([ 2157,    70,  3480,    56, 11569, 12810,  1095,  7436, 13722, 11380]) tensor([ 5035, 10849, 10508,  5112,  1798,  9003, 10064,  4335, 10859, 10716])
-------Step 2-------
tensor([ 1584, 12580,  6936, 12619, 14720,  6402, 13822,  8059,  5626, 11252]) tensor([ 7712,  4367,  1591,  6394, 12941,  3272,   150,  4147,   172, 13390])
-------Step 3-------
tensor([ 1584, 12580,  6936, 12619, 14720,  6402, 13822,  8059,  5626, 11252]) tensor([ 9116, 11493,  6477,  9554,  5084, 12073,  7033, 11323, 10313, 11176])
-------Step 4-------
tensor([ 4516,    46, 12772, 12192,  4442, 13526, 14002,  3542,     2,  8254]) tensor([ 6651,  6473,   515, 12005, 12880, 11067, 11238,  4112, 11846,   454])
-------Step 5-------
tensor([ 4516,    46, 12772, 12192,  4442, 13526, 14002,  3542,     2,  8254]) tensor([ 2964,  2560, 10612,  1243,  4302, 14295, 10258, 13908,  4174, 12854])
-------Step 6-------
tensor([ 5812, 10480,  5334,  6699,  7580,  1008,  7168, 10051, 13371,  8878]) tensor([ 9744, 11435, 12762,  2147,  2398,  3542,  6541,  3702,  3235,  4394])
-------Step 7-------
tensor([ 5812, 10480,  5334,  6699,  7580,  1008,  7168, 10051, 13371,  8878]) tensor([10739,  9523,  7077,  6733, 12562,  1992, 10740,   251, 13963, 14918])
-------Step 8-------
tensor([ 9660,  3059, 12497, 10263,  2770,  9553, 12192,  3432,  4343,   812]) tensor([ 2765,  9413,  1681,  4784,  9312, 11077,  8235,  6304, 13252,  5303])
-------Step 9-------
tensor([ 9660,  3059, 12497, 10263,  2770,  9553, 12192,  3432,  4343,   812]) tensor([ 9375, 10698,  8682,   223,  8756,  7232,  2524,  3225,  3111, 12729])
before start barrier
start train
[proc 0] 100 steps, total: 30.524, sample: 0.553, forward: 1.322, backward: 1.070, update: 0.310
W20240202 15:13:51.439006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=102, pq.top=102
W20240202 15:13:52.439005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240202 15:13:53.439007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=108, pq.top=108
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.125 ms                  | 31.914 ms                 |
| Forward                   | 5.648 ms                  | 12.938 ms                 |
| Backward                  | 8.956 ms                  | 13.177 ms                 |
| Optimize                  | 2.669 ms                  | 9.667 ms                  |
| BarrierTimeBeforeRank0    | 1.902 ms                  | 36.676 ms                 |
| AfterBackward             | 33.867 ms                 | 769.284 ms                |
| BlockToStepN              | 256.585 ms                | 909.287 ms                |
| OneStep                   | 324.906 ms                | 1.020 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.251 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.663 ms                  | 12.554 ms                 |
| ProcessBack:UpsertPq      | 15.361 ms                 | 52.830 ms                 |
| ProcessOneStep            | 34.204 ms                 | 769.145 ms                |
| BlockToStepN              | 256.598 ms                | 909.154 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:13:54.439013 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240202 15:13:55.439010 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=114, pq.top=114
W20240202 15:13:56.474581 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240202 15:13:57.474022 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240202 15:13:58.474010 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=122, pq.top=122
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 31.914 ms                 |
| Forward                   | 5.686 ms                  | 12.938 ms                 |
| Backward                  | 8.953 ms                  | 16.833 ms                 |
| Optimize                  | 2.674 ms                  | 9.667 ms                  |
| BarrierTimeBeforeRank0    | 2.246 ms                  | 41.079 ms                 |
| AfterBackward             | 34.270 ms                 | 769.284 ms                |
| BlockToStepN              | 258.729 ms                | 909.287 ms                |
| OneStep                   | 330.455 ms                | 1.020 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.257 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.812 ms                  | 12.554 ms                 |
| ProcessBack:UpsertPq      | 15.452 ms                 | 52.830 ms                 |
| ProcessOneStep            | 34.276 ms                 | 769.145 ms                |
| BlockToStepN              | 262.691 ms                | 909.154 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:13:59.474005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240202 15:14:00.474020 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240202 15:14:01.474005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240202 15:14:02.474015 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240202 15:14:03.474010 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=136, pq.top=136
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.125 ms                  | 31.914 ms                 |
| Forward                   | 5.648 ms                  | 15.310 ms                 |
| Backward                  | 8.956 ms                  | 16.833 ms                 |
| Optimize                  | 2.674 ms                  | 9.667 ms                  |
| BarrierTimeBeforeRank0    | 2.458 ms                  | 41.079 ms                 |
| AfterBackward             | 34.308 ms                 | 769.284 ms                |
| BlockToStepN              | 266.543 ms                | 909.287 ms                |
| OneStep                   | 335.813 ms                | 1.020 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.243 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.822 ms                  | 12.409 ms                 |
| ProcessBack:UpsertPq      | 15.439 ms                 | 52.042 ms                 |
| ProcessOneStep            | 34.276 ms                 | 769.145 ms                |
| BlockToStepN              | 266.551 ms                | 909.154 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:04.474004 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=138, pq.top=138
W20240202 15:14:05.474005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240202 15:14:06.480300 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=144, pq.top=144
W20240202 15:14:07.480010 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=146, pq.top=146
W20240202 15:14:08.480006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.116 ms                  | 31.914 ms                 |
| Forward                   | 5.703 ms                  | 15.310 ms                 |
| Backward                  | 8.943 ms                  | 16.833 ms                 |
| Optimize                  | 2.669 ms                  | 9.667 ms                  |
| BarrierTimeBeforeRank0    | 3.265 ms                  | 41.079 ms                 |
| AfterBackward             | 34.366 ms                 | 769.284 ms                |
| BlockToStepN              | 270.842 ms                | 909.287 ms                |
| OneStep                   | 338.199 ms                | 1.020 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.243 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.791 ms                  | 12.409 ms                 |
| ProcessBack:UpsertPq      | 15.452 ms                 | 52.042 ms                 |
| ProcessOneStep            | 34.321 ms                 | 73.575 ms                 |
| BlockToStepN              | 270.905 ms                | 909.154 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:09.480015 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240202 15:14:10.480008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240202 15:14:11.480010 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
W20240202 15:14:12.480008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.182 ms                  | 29.768 ms                 |
| Forward                   | 5.715 ms                  | 13.271 ms                 |
| Backward                  | 8.947 ms                  | 13.177 ms                 |
| Optimize                  | 2.665 ms                  | 8.908 ms                  |
| BarrierTimeBeforeRank0    | 3.416 ms                  | 39.712 ms                 |
| AfterBackward             | 34.466 ms                 | 73.636 ms                 |
| BlockToStepN              | 273.453 ms                | 543.760 ms                |
| OneStep                   | 341.842 ms                | 1.003 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:13.551723 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.284 ms                  | 13.137 ms                 |
| ProcessBack:UpdateCache   | 9.825 ms                  | 12.409 ms                 |
| ProcessBack:UpsertPq      | 15.466 ms                 | 52.042 ms                 |
| ProcessOneStep            | 34.442 ms                 | 73.575 ms                 |
| BlockToStepN              | 273.393 ms                | 543.642 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:14.551023 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=164, pq.top=164
W20240202 15:14:15.551008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240202 15:14:16.551008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240202 15:14:17.551008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=172, pq.top=172
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.116 ms                  | 31.914 ms                 |
| Forward                   | 5.800 ms                  | 13.271 ms                 |
| Backward                  | 8.947 ms                  | 13.177 ms                 |
| Optimize                  | 2.676 ms                  | 8.908 ms                  |
| BarrierTimeBeforeRank0    | 3.192 ms                  | 39.712 ms                 |
| AfterBackward             | 34.546 ms                 | 73.636 ms                 |
| BlockToStepN              | 275.912 ms                | 543.760 ms                |
| OneStep                   | 346.593 ms                | 1.003 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:18.551005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=174, pq.top=174
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.381 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.866 ms                  | 11.616 ms                 |
| ProcessBack:UpsertPq      | 15.531 ms                 | 42.350 ms                 |
| ProcessOneStep            | 34.530 ms                 | 73.575 ms                 |
| BlockToStepN              | 275.852 ms                | 543.642 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:19.551016 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240202 15:14:20.624699 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240202 15:14:21.624007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=182, pq.top=182
W20240202 15:14:22.624008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 31.914 ms                 |
| Forward                   | 5.877 ms                  | 13.271 ms                 |
| Backward                  | 8.947 ms                  | 14.332 ms                 |
| Optimize                  | 2.696 ms                  | 8.908 ms                  |
| BarrierTimeBeforeRank0    | 3.265 ms                  | 39.712 ms                 |
| AfterBackward             | 34.670 ms                 | 73.636 ms                 |
| BlockToStepN              | 279.820 ms                | 543.760 ms                |
| OneStep                   | 349.717 ms                | 1.003 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:23.639694 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.405 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.857 ms                  | 11.738 ms                 |
| ProcessBack:UpsertPq      | 15.541 ms                 | 42.350 ms                 |
| ProcessOneStep            | 34.632 ms                 | 73.575 ms                 |
| BlockToStepN              | 279.985 ms                | 543.642 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:24.639007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240202 15:14:25.645910 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240202 15:14:26.645009 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240202 15:14:27.674554 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.941 ms                  | 31.914 ms                 |
| Forward                   | 5.912 ms                  | 13.271 ms                 |
| Backward                  | 8.947 ms                  | 14.332 ms                 |
| Optimize                  | 2.691 ms                  | 8.908 ms                  |
| BarrierTimeBeforeRank0    | 3.416 ms                  | 39.712 ms                 |
| AfterBackward             | 34.670 ms                 | 73.636 ms                 |
| BlockToStepN              | 281.937 ms                | 543.760 ms                |
| OneStep                   | 352.928 ms                | 1.003 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:28.674008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=200, pq.top=200
[proc 7] 200 steps, total: 38.087, sample: 0.471, forward: 0.567, backward: 0.903, update: 0.258
[proc 1] 200 steps, total: 38.086, sample: 0.477, forward: 0.503, backward: 0.384, update: 0.237
[proc 5] 200 steps, total: 38.086, sample: 0.468, forward: 0.565, backward: 0.791, update: 0.259
[proc 2] 200 steps, total: 38.087, sample: 0.450, forward: 0.505, backward: 0.867, update: 0.250
[proc 3] 200 steps, total: 38.087, sample: 0.467, forward: 0.520, backward: 0.988, update: 0.265
[proc 6] 200 steps, total: 38.086, sample: 0.468, forward: 0.505, backward: 0.985, update: 0.273
[proc 4] 200 steps, total: 38.086, sample: 0.473, forward: 0.537, backward: 0.841, update: 0.259
[proc 0] 200 steps, total: 38.086, sample: 0.568, forward: 0.627, backward: 0.769, update: 0.284
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.457 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.896 ms                  | 12.110 ms                 |
| ProcessBack:UpsertPq      | 15.560 ms                 | 42.350 ms                 |
| ProcessOneStep            | 34.639 ms                 | 73.575 ms                 |
| BlockToStepN              | 281.763 ms                | 543.642 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:29.674007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240202 15:14:30.674008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240202 15:14:31.674024 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
W20240202 15:14:32.674007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.926 ms                  | 31.914 ms                 |
| Forward                   | 6.011 ms                  | 13.271 ms                 |
| Backward                  | 8.948 ms                  | 14.332 ms                 |
| Optimize                  | 2.694 ms                  | 8.908 ms                  |
| BarrierTimeBeforeRank0    | 3.192 ms                  | 39.712 ms                 |
| AfterBackward             | 34.721 ms                 | 73.636 ms                 |
| BlockToStepN              | 283.339 ms                | 543.760 ms                |
| OneStep                   | 355.381 ms                | 1.003 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:33.674007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.485 ms                  | 12.645 ms                 |
| ProcessBack:UpdateCache   | 9.896 ms                  | 12.110 ms                 |
| ProcessBack:UpsertPq      | 15.533 ms                 | 42.350 ms                 |
| ProcessOneStep            | 34.719 ms                 | 73.575 ms                 |
| BlockToStepN              | 283.272 ms                | 543.642 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:34.674008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240202 15:14:35.674008 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240202 15:14:36.674024 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=220, pq.top=220
W20240202 15:14:37.674011 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.868 ms                  | 31.914 ms                 |
| Forward                   | 6.036 ms                  | 13.271 ms                 |
| Backward                  | 8.948 ms                  | 14.332 ms                 |
| Optimize                  | 2.691 ms                  | 8.908 ms                  |
| BarrierTimeBeforeRank0    | 3.192 ms                  | 39.712 ms                 |
| AfterBackward             | 34.839 ms                 | 73.636 ms                 |
| BlockToStepN              | 287.445 ms                | 543.760 ms                |
| OneStep                   | 359.293 ms                | 1.003 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:38.711179 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.485 ms                  | 12.464 ms                 |
| ProcessBack:UpdateCache   | 9.898 ms                  | 11.881 ms                 |
| ProcessBack:UpsertPq      | 15.541 ms                 | 41.017 ms                 |
| ProcessOneStep            | 34.827 ms                 | 73.575 ms                 |
| BlockToStepN              | 287.573 ms                | 543.642 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:39.711006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240202 15:14:40.711009 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240202 15:14:41.711014 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240202 15:14:42.711010 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=234, pq.top=234
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.864 ms                  | 31.914 ms                 |
| Forward                   | 6.032 ms                  | 13.271 ms                 |
| Backward                  | 8.956 ms                  | 14.332 ms                 |
| Optimize                  | 2.691 ms                  | 8.908 ms                  |
| BarrierTimeBeforeRank0    | 3.192 ms                  | 39.712 ms                 |
| AfterBackward             | 34.898 ms                 | 73.636 ms                 |
| BlockToStepN              | 290.653 ms                | 543.760 ms                |
| OneStep                   | 362.130 ms                | 1.003 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:43.711004 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.478 ms                  | 12.464 ms                 |
| ProcessBack:UpdateCache   | 9.898 ms                  | 11.881 ms                 |
| ProcessBack:UpsertPq      | 15.567 ms                 | 41.017 ms                 |
| ProcessOneStep            | 34.876 ms                 | 73.575 ms                 |
| BlockToStepN              | 291.158 ms                | 543.642 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:44.759843 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240202 15:14:45.759006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240202 15:14:46.759011 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=244, pq.top=244
W20240202 15:14:47.759016 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=246, pq.top=246
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.863 ms                  | 31.914 ms                 |
| Forward                   | 6.009 ms                  | 13.271 ms                 |
| Backward                  | 8.929 ms                  | 14.332 ms                 |
| Optimize                  | 2.685 ms                  | 8.908 ms                  |
| BarrierTimeBeforeRank0    | 3.587 ms                  | 39.712 ms                 |
| AfterBackward             | 34.898 ms                 | 73.636 ms                 |
| BlockToStepN              | 294.912 ms                | 543.760 ms                |
| OneStep                   | 362.883 ms                | 1.003 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:48.759006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=248, pq.top=248
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.444 ms                  | 12.464 ms                 |
| ProcessBack:UpdateCache   | 9.923 ms                  | 11.881 ms                 |
| ProcessBack:UpsertPq      | 15.591 ms                 | 41.017 ms                 |
| ProcessOneStep            | 34.876 ms                 | 73.575 ms                 |
| BlockToStepN              | 294.798 ms                | 543.642 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:49.759006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
W20240202 15:14:50.759006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240202 15:14:51.759011 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240202 15:14:52.814031 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.863 ms                  | 31.914 ms                 |
| Forward                   | 5.979 ms                  | 12.938 ms                 |
| Backward                  | 8.922 ms                  | 13.177 ms                 |
| Optimize                  | 2.677 ms                  | 7.148 ms                  |
| BarrierTimeBeforeRank0    | 4.118 ms                  | 38.461 ms                 |
| AfterBackward             | 34.898 ms                 | 61.868 ms                 |
| BlockToStepN              | 297.298 ms                | 511.294 ms                |
| OneStep                   | 367.106 ms                | 819.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:53.814005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.404 ms                  | 12.464 ms                 |
| ProcessBack:UpdateCache   | 9.935 ms                  | 11.881 ms                 |
| ProcessBack:UpsertPq      | 15.673 ms                 | 41.017 ms                 |
| ProcessOneStep            | 34.827 ms                 | 61.816 ms                 |
| BlockToStepN              | 297.403 ms                | 511.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:54.814006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
W20240202 15:14:55.828289 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240202 15:14:56.828009 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240202 15:14:57.828015 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.830 ms                  | 31.914 ms                 |
| Forward                   | 5.940 ms                  | 12.938 ms                 |
| Backward                  | 8.907 ms                  | 13.177 ms                 |
| Optimize                  | 2.674 ms                  | 7.148 ms                  |
| BarrierTimeBeforeRank0    | 4.462 ms                  | 38.461 ms                 |
| AfterBackward             | 34.839 ms                 | 61.868 ms                 |
| BlockToStepN              | 299.644 ms                | 511.294 ms                |
| OneStep                   | 370.037 ms                | 819.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:58.828006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.383 ms                  | 12.464 ms                 |
| ProcessBack:UpdateCache   | 9.941 ms                  | 11.881 ms                 |
| ProcessBack:UpsertPq      | 15.725 ms                 | 41.017 ms                 |
| ProcessOneStep            | 34.808 ms                 | 61.816 ms                 |
| BlockToStepN              | 299.707 ms                | 511.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:14:59.828006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240202 15:15:00.828006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240202 15:15:01.828011 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240202 15:15:02.828017 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.789 ms                  | 31.914 ms                 |
| Forward                   | 5.940 ms                  | 12.938 ms                 |
| Backward                  | 8.908 ms                  | 13.177 ms                 |
| Optimize                  | 2.669 ms                  | 7.148 ms                  |
| BarrierTimeBeforeRank0    | 4.755 ms                  | 38.461 ms                 |
| AfterBackward             | 34.843 ms                 | 61.868 ms                 |
| BlockToStepN              | 303.542 ms                | 511.294 ms                |
| OneStep                   | 374.709 ms                | 819.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:03.828006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.378 ms                  | 12.432 ms                 |
| ProcessBack:UpdateCache   | 9.941 ms                  | 11.738 ms                 |
| ProcessBack:UpsertPq      | 15.741 ms                 | 27.691 ms                 |
| ProcessOneStep            | 34.808 ms                 | 61.816 ms                 |
| BlockToStepN              | 303.786 ms                | 511.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:04.828006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240202 15:15:05.828006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240202 15:15:06.841764 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240202 15:15:07.841017 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.760 ms                  | 31.914 ms                 |
| Forward                   | 5.926 ms                  | 12.938 ms                 |
| Backward                  | 8.908 ms                  | 13.177 ms                 |
| Optimize                  | 2.665 ms                  | 7.148 ms                  |
| BarrierTimeBeforeRank0    | 4.837 ms                  | 38.461 ms                 |
| AfterBackward             | 34.898 ms                 | 61.868 ms                 |
| BlockToStepN              | 304.772 ms                | 511.294 ms                |
| OneStep                   | 374.907 ms                | 819.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:08.862423 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=298, pq.top=298
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.369 ms                  | 12.432 ms                 |
| ProcessBack:UpdateCache   | 9.947 ms                  | 11.881 ms                 |
| ProcessBack:UpsertPq      | 15.755 ms                 | 27.691 ms                 |
| ProcessOneStep            | 34.808 ms                 | 61.816 ms                 |
| BlockToStepN              | 306.712 ms                | 511.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:09.862006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 1] 300 steps, total: 41.405, sample: 0.376, forward: 0.471, backward: 0.367, update: 0.219
[proc 2] 300 steps, total: 41.405, sample: 0.394, forward: 0.455, backward: 0.853, update: 0.235
[proc 5] 300 steps, total: 41.406, sample: 0.433, forward: 0.519, backward: 0.964, update: 0.245
[proc 7] 300 steps, total: 41.406, sample: 0.440, forward: 0.520, backward: 0.900, update: 0.252
[proc 3] 300 steps, total: 41.405, sample: 0.445, forward: 0.519, backward: 0.930, update: 0.260
[proc 4] 300 steps, total: 41.405, sample: 0.474, forward: 0.527, backward: 0.935, update: 0.261
[proc 6] 300 steps, total: 41.405, sample: 0.380, forward: 0.472, backward: 0.975, update: 0.261
[proc 0] 300 steps, total: 41.405, sample: 0.537, forward: 0.584, backward: 0.655, update: 0.274
W20240202 15:15:10.862006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
W20240202 15:15:11.862006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=304, pq.top=304
W20240202 15:15:12.862017 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=307, pq.top=307
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.733 ms                  | 31.914 ms                 |
| Forward                   | 5.912 ms                  | 12.938 ms                 |
| Backward                  | 8.884 ms                  | 13.177 ms                 |
| Optimize                  | 2.657 ms                  | 7.148 ms                  |
| BarrierTimeBeforeRank0    | 5.203 ms                  | 38.461 ms                 |
| AfterBackward             | 34.912 ms                 | 61.868 ms                 |
| BlockToStepN              | 310.558 ms                | 511.294 ms                |
| OneStep                   | 376.611 ms                | 819.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:13.862005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.350 ms                  | 12.432 ms                 |
| ProcessBack:UpdateCache   | 9.941 ms                  | 11.881 ms                 |
| ProcessBack:UpsertPq      | 15.792 ms                 | 27.691 ms                 |
| ProcessOneStep            | 34.876 ms                 | 61.816 ms                 |
| BlockToStepN              | 312.171 ms                | 511.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:14.862006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240202 15:15:15.862006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240202 15:15:16.862005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=316, pq.top=316
W20240202 15:15:17.862005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.723 ms                  | 31.914 ms                 |
| Forward                   | 5.882 ms                  | 12.938 ms                 |
| Backward                  | 8.877 ms                  | 13.177 ms                 |
| Optimize                  | 2.648 ms                  | 7.148 ms                  |
| BarrierTimeBeforeRank0    | 5.495 ms                  | 38.461 ms                 |
| AfterBackward             | 34.930 ms                 | 73.636 ms                 |
| BlockToStepN              | 313.369 ms                | 511.294 ms                |
| OneStep                   | 378.951 ms                | 819.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:18.862016 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=320, pq.top=320
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.345 ms                  | 12.432 ms                 |
| ProcessBack:UpdateCache   | 9.940 ms                  | 11.881 ms                 |
| ProcessBack:UpsertPq      | 15.820 ms                 | 42.350 ms                 |
| ProcessOneStep            | 35.003 ms                 | 73.575 ms                 |
| BlockToStepN              | 313.284 ms                | 511.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:19.862005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=322, pq.top=322
W20240202 15:15:20.862007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=324, pq.top=324
W20240202 15:15:21.864187 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240202 15:15:22.864006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=329, pq.top=329
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.723 ms                  | 31.914 ms                 |
| Forward                   | 5.882 ms                  | 12.938 ms                 |
| Backward                  | 8.889 ms                  | 13.177 ms                 |
| Optimize                  | 2.646 ms                  | 7.148 ms                  |
| BarrierTimeBeforeRank0    | 5.421 ms                  | 38.461 ms                 |
| AfterBackward             | 35.064 ms                 | 73.636 ms                 |
| BlockToStepN              | 316.206 ms                | 511.294 ms                |
| OneStep                   | 381.508 ms                | 819.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:23.864012 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=331, pq.top=331
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.333 ms                  | 12.366 ms                 |
| ProcessBack:UpdateCache   | 9.908 ms                  | 11.738 ms                 |
| ProcessBack:UpsertPq      | 15.829 ms                 | 41.017 ms                 |
| ProcessOneStep            | 35.003 ms                 | 73.575 ms                 |
| BlockToStepN              | 316.411 ms                | 511.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:24.882970 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=334, pq.top=334
W20240202 15:15:25.882005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=336, pq.top=336
W20240202 15:15:26.882006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=338, pq.top=338
W20240202 15:15:27.890277 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=341, pq.top=341
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.707 ms                  | 32.488 ms                 |
| Forward                   | 5.882 ms                  | 12.938 ms                 |
| Backward                  | 8.889 ms                  | 13.177 ms                 |
| Optimize                  | 2.642 ms                  | 7.148 ms                  |
| BarrierTimeBeforeRank0    | 5.203 ms                  | 38.461 ms                 |
| AfterBackward             | 35.073 ms                 | 73.636 ms                 |
| BlockToStepN              | 318.222 ms                | 511.294 ms                |
| OneStep                   | 382.975 ms                | 819.990 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:28.890007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.325 ms                  | 12.366 ms                 |
| ProcessBack:UpdateCache   | 9.898 ms                  | 11.738 ms                 |
| ProcessBack:UpsertPq      | 15.876 ms                 | 41.017 ms                 |
| ProcessOneStep            | 35.037 ms                 | 73.575 ms                 |
| BlockToStepN              | 318.273 ms                | 511.104 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:29.890019 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240202 15:15:30.890007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240202 15:15:31.890005 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=350, pq.top=350
W20240202 15:15:32.890007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=352, pq.top=352
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.733 ms                  | 31.914 ms                 |
| Forward                   | 5.882 ms                  | 11.716 ms                 |
| Backward                  | 8.903 ms                  | 12.170 ms                 |
| Optimize                  | 2.641 ms                  | 6.842 ms                  |
| BarrierTimeBeforeRank0    | 5.264 ms                  | 36.676 ms                 |
| AfterBackward             | 35.144 ms                 | 61.868 ms                 |
| BlockToStepN              | 318.449 ms                | 500.958 ms                |
| OneStep                   | 385.292 ms                | 601.752 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:33.890007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=354, pq.top=354
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.328 ms                  | 12.366 ms                 |
| ProcessBack:UpdateCache   | 9.884 ms                  | 11.738 ms                 |
| ProcessBack:UpsertPq      | 15.890 ms                 | 41.017 ms                 |
| ProcessOneStep            | 35.103 ms                 | 61.816 ms                 |
| BlockToStepN              | 318.877 ms                | 500.725 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:34.966768 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240202 15:15:35.966017 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240202 15:15:36.966006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=361, pq.top=361
W20240202 15:15:37.966007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=363, pq.top=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.709 ms                  | 31.914 ms                 |
| Forward                   | 5.882 ms                  | 11.716 ms                 |
| Backward                  | 8.912 ms                  | 12.170 ms                 |
| Optimize                  | 2.638 ms                  | 6.842 ms                  |
| BarrierTimeBeforeRank0    | 5.421 ms                  | 36.676 ms                 |
| AfterBackward             | 35.146 ms                 | 61.868 ms                 |
| BlockToStepN              | 320.430 ms                | 500.958 ms                |
| OneStep                   | 390.951 ms                | 601.752 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:38.966007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.324 ms                  | 12.366 ms                 |
| ProcessBack:UpdateCache   | 9.896 ms                  | 11.738 ms                 |
| ProcessBack:UpsertPq      | 15.896 ms                 | 41.017 ms                 |
| ProcessOneStep            | 35.111 ms                 | 61.816 ms                 |
| BlockToStepN              | 320.586 ms                | 500.725 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:39.966007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=367, pq.top=367
W20240202 15:15:40.981210 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=370, pq.top=370
W20240202 15:15:41.981006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240202 15:15:42.981007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=374, pq.top=374
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.723 ms                  | 31.914 ms                 |
| Forward                   | 5.896 ms                  | 11.716 ms                 |
| Backward                  | 8.919 ms                  | 12.170 ms                 |
| Optimize                  | 2.638 ms                  | 6.842 ms                  |
| BarrierTimeBeforeRank0    | 5.264 ms                  | 36.676 ms                 |
| AfterBackward             | 35.218 ms                 | 61.868 ms                 |
| BlockToStepN              | 321.702 ms                | 500.958 ms                |
| OneStep                   | 392.462 ms                | 601.752 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:43.981007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=376, pq.top=376
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.325 ms                  | 12.358 ms                 |
| ProcessBack:UpdateCache   | 9.908 ms                  | 11.738 ms                 |
| ProcessBack:UpsertPq      | 15.906 ms                 | 34.598 ms                 |
| ProcessOneStep            | 35.180 ms                 | 61.816 ms                 |
| BlockToStepN              | 321.647 ms                | 500.725 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:44.981007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=378, pq.top=378
W20240202 15:15:45.981009 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=380, pq.top=380
W20240202 15:15:46.981022 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240202 15:15:47.981012 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=384, pq.top=384
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.723 ms                  | 31.914 ms                 |
| Forward                   | 5.882 ms                  | 11.716 ms                 |
| Backward                  | 8.924 ms                  | 12.170 ms                 |
| Optimize                  | 2.638 ms                  | 6.842 ms                  |
| BarrierTimeBeforeRank0    | 5.354 ms                  | 36.676 ms                 |
| AfterBackward             | 35.278 ms                 | 61.868 ms                 |
| BlockToStepN              | 322.339 ms                | 511.294 ms                |
| OneStep                   | 395.233 ms                | 601.752 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:48.981009 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=386, pq.top=386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.350 ms                  | 12.358 ms                 |
| ProcessBack:UpdateCache   | 9.901 ms                  | 11.738 ms                 |
| ProcessBack:UpsertPq      | 15.954 ms                 | 34.598 ms                 |
| ProcessOneStep            | 35.252 ms                 | 61.816 ms                 |
| BlockToStepN              | 322.421 ms                | 513.883 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:15:49.981007 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=388, pq.top=388
W20240202 15:15:50.981006 41096 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=390, pq.top=390
Successfully xmh. training takes 150.82945442199707 seconds
before call kg_cache_controller.StopThreads()
W20240202 15:15:50.993171 41096 grad_async_v1.h:243] call StopThreads. PID = 40110
W20240202 15:15:50.993198 41096 grad_base.h:212] before processOneStepNegThread_.join();
W20240202 15:15:51.003351 41096 grad_base.h:214] after processOneStepNegThread_.join();
W20240202 15:15:51.003391 41096 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240202 15:15:51.063961 41096 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.723 ms                  | 31.914 ms                 |
| Forward                   | 5.877 ms                  | 11.716 ms                 |
| Backward                  | 8.924 ms                  | 12.170 ms                 |
| Optimize                  | 2.629 ms                  | 6.842 ms                  |
| BarrierTimeBeforeRank0    | 5.264 ms                  | 36.676 ms                 |
| AfterBackward             | 35.293 ms                 | 61.868 ms                 |
| BlockToStepN              | 322.617 ms                | 513.982 ms                |
| OneStep                   | 396.555 ms                | 601.752 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.345 ms                  | 12.358 ms                 |
| ProcessBack:UpdateCache   | 9.909 ms                  | 11.738 ms                 |
| ProcessBack:UpsertPq      | 15.963 ms                 | 34.598 ms                 |
| ProcessOneStep            | 35.256 ms                 | 61.816 ms                 |
| BlockToStepN              | 322.439 ms                | 513.883 ms                |
+---------------------------+---------------------------+---------------------------+
