WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240203 22:43:49.432765 55775 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_79', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [55775 sampler.py:454] Start PreSampling
WARNING [55775 sampler.py:532] Before construct renumbering_dict
WARNING [55775 sampler.py:555] PreSampling done
W20240203 23:03:51.376241 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240203 23:03:51.376422 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240203 23:03:51.376466 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240203 23:03:51.376500 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240203 23:03:51.376533 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240203 23:03:51.376565 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240203 23:03:51.376592 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240203 23:03:51.376627 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240203 23:03:51.376658 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240203 23:03:51.376685 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240203 23:03:51.376724 55775 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240203 23:03:51.376751 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240203 23:03:51.376775 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240203 23:03:51.376935 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240203 23:03:51.376969 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240203 23:03:51.376997 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240203 23:03:51.377045 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240203 23:03:51.377086 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240203 23:03:51.377118 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240203 23:03:51.377146 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240203 23:03:51.377183 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240203 23:03:51.377210 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240203 23:03:51.377245 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240203 23:03:51.377272 55775 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240203 23:03:51.377295 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240203 23:03:51.377316 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240203 23:03:51.377372 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240203 23:03:51.377405 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240203 23:03:51.377432 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240203 23:03:51.377467 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240203 23:03:51.377503 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240203 23:03:51.377539 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240203 23:03:51.377574 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240203 23:03:51.377606 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240203 23:03:51.377635 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240203 23:03:51.377669 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240203 23:03:51.377697 55775 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240203 23:03:51.377718 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240203 23:03:51.377740 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240203 23:03:51.377799 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240203 23:03:51.377828 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240203 23:03:51.377862 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240203 23:03:51.377892 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240203 23:03:51.377918 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240203 23:03:51.377947 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240203 23:03:51.377983 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240203 23:03:51.378015 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240203 23:03:51.378050 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240203 23:03:51.378086 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240203 23:03:51.378118 55775 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240203 23:03:51.378139 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240203 23:03:51.378167 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240203 23:03:51.378224 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240203 23:03:51.378259 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240203 23:03:51.378291 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240203 23:03:51.378319 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240203 23:03:51.378351 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240203 23:03:51.378378 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240203 23:03:51.378407 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240203 23:03:51.378432 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240203 23:03:51.378461 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240203 23:03:51.378492 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240203 23:03:51.378525 55775 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240203 23:03:51.378548 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240203 23:03:51.378578 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240203 23:03:51.378633 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240203 23:03:51.378665 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240203 23:03:51.378695 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240203 23:03:51.378727 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240203 23:03:51.378754 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240203 23:03:51.378787 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240203 23:03:51.378816 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240203 23:03:51.378844 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240203 23:03:51.378871 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240203 23:03:51.378912 55775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240203 23:03:51.378938 55775 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240203 23:03:51.378962 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240203 23:03:51.378984 55775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240203 23:03:51.778478 55775 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x10001ca5a000 128.2 GB
W20240203 23:12:28.858812 55775 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10202b692000 328.3 MB
{0: Graph(num_nodes=16391033, num_edges=60554486,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=22850318, num_edges=74912573,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16459669, num_edges=67428404,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=17554345, num_edges=53272616,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=17824082, num_edges=71836124,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=18730250, num_edges=46391216,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 16391033 N 60554486 E
MertisPartition: part 1 has 22850318 N 74912573 E
MertisPartition: part 2 has 16459669 N 67428404 E
MertisPartition: part 3 has 17554345 N 53272616 E
MertisPartition: part 4 has 17824082 N 71836124 E
MertisPartition: part 5 has 18730250 N 46391216 E
Rank0: cached key size 717117
Rank1: cached key size 717117
Rank2: cached key size 717117
Rank3: cached key size 717117
Rank4: cached key size 717117
Rank5: cached key size 717117
Before renumbering graph:  {'_ID': tensor([       4,        5,       14,  ..., 12367661, 70093925, 61280605]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 4302831,  4302880,   600239,  ..., 56842056,  8550833, 77541661]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=16391033, num_edges=60554486,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=16391033, num_edges=60554486,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2180.421 seconds
[Rank1] pid = 22759
[Rank2] pid = 22855
[Rank3] pid = 22986
[Rank4] pid = 23151
INFO [55775 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [22759 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [22855 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [23151 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [22986 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [23312 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [55775 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [22759 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [23151 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [23312 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [22986 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [22855 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240203 23:20:19.221539 23313 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240203 23:20:19.222779 23158 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240203 23:20:19.222813 23387 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240203 23:20:19.222818 22760 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240203 23:20:19.222821 22996 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240203 23:20:19.223610 22856 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240203 23:20:19.288817 23158 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102040686000 7.629 MB
W20240203 23:20:19.288821 22996 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102040e29000 7.629 MB
W20240203 23:20:19.288810 23313 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10203fee3000 7.629 MB
W20240203 23:20:19.288828 23387 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1020415cc000 7.629 MB
W20240203 23:20:19.288928 22856 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102041d6f000 7.629 MB
W20240203 23:20:19.288975 23313 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102042512000 7.629 MB
W20240203 23:20:19.289019 23158 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x102042cb5000 7.629 MB
W20240203 23:20:19.289023 22996 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x102043458000 7.629 MB
W20240203 23:20:19.289055 23387 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102043bfd000 7.629 MB
W20240203 23:20:19.289057 23313 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1020443a0000 1.49 GB
W20240203 23:20:19.289113 23158 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1020a3983000 1.49 GB
W20240203 23:20:19.289115 23313 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102102f66000 1.49 GB
W20240203 23:20:19.289122 22996 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102162549000 1.49 GB
W20240203 23:20:19.289152 22856 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1021c1b2c000 7.629 MB
W20240203 23:20:19.289162 23313 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 23:20:19.289167 23387 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1021c22cf000 1.49 GB
W20240203 23:20:19.289180 23158 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1022218b2000 1.49 GB
W20240203 23:20:19.289204 22996 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102280e95000 1.49 GB
W20240203 23:20:19.289234 23387 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1022e0478000 1.49 GB
W20240203 23:20:19.289256 23158 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 23:20:19.289266 22996 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 23:20:19.289283 22856 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10233fa5b000 1.49 GB
W20240203 23:20:19.289304 23387 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 23:20:19.289330 22856 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10239f03e000 1.49 GB
W20240203 23:20:19.289371 22760 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1023fe621000 7.629 MB
W20240203 23:20:19.289397 22856 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 23:20:19.289542 22760 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1023fedc4000 7.629 MB
W20240203 23:20:19.289633 22760 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1023ff567000 1.49 GB
W20240203 23:20:19.289683 22760 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10245eb4a000 1.49 GB
W20240203 23:20:19.289770 22760 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 23:20:19.300343 23313 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 23:20:19.300411 23158 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 23:20:19.300422 22856 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 23:20:19.300422 23387 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 23:20:19.300446 22996 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 23:20:19.300487 22760 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x10001ca5a000
5: KnownLocalCachedEmbedding init done
WARNING [23312 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
4: KnownLocalCachedEmbedding init done
WARNING [23151 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
3: KnownLocalCachedEmbedding init done
WARNING [22986 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank5] pid = 23312
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242)]
cudaHostRegister 0x10001ca5a000
0: KnownLocalCachedEmbedding init done
WARNING [55775 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
2: KnownLocalCachedEmbedding init done
WARNING [22855 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
1: KnownLocalCachedEmbedding init done
WARNING [22759 DistTensor.py:59] The tensor name already exists in the kvstore
I20240203 23:21:00.110088 22760 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240203 23:21:00.110285 22856 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240203 23:21:00.110332 23158 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240203 23:21:00.110411 22996 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240203 23:21:00.110484 23387 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240203 23:21:00.110556 23313 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
E20240203 23:21:00.728652 22996 recstore.cc:66] init folly done
E20240203 23:21:00.728744 22856 recstore.cc:66] init folly done
E20240203 23:21:00.728747 23158 recstore.cc:66] init folly done
E20240203 23:21:00.728751 22760 recstore.cc:66] init folly done
E20240203 23:21:00.730744 23387 recstore.cc:66] init folly done
E20240203 23:21:00.730746 23313 recstore.cc:66] init folly done
I20240203 23:21:08.471089 23387 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240203 23:21:08.877559 22996 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240203 23:21:09.997664 23313 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240203 23:21:10.868470 22856 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240203 23:21:11.521513 23158 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240203 23:21:12.316160 22760 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.365 ms                 | 13.365 ms                 |
| Forward                   | 553.734 ms                | 553.734 ms                |
| Backward                  | 2.215 s                   | 2.215 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.855 ms                  | 108.928 ms                |
| Forward                   | 5.010 ms                  | 553.734 ms                |
| Backward                  | 220.149 ms                | 2.215 s                   |
| Optimize                  | 51.018 ms                 | 86.531 ms                 |
| BarrierTimeBeforeRank0    | 47.834 us                 | 77.765 us                 |
| BlockToStepN              | 21.973 us                 | 88.686 us                 |
| OneStep                   | 296.834 ms                | 2.870 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.865 ms                  | 108.928 ms                |
| Forward                   | 4.978 ms                  | 553.734 ms                |
| Backward                  | 211.653 ms                | 2.215 s                   |
| Optimize                  | 73.325 ms                 | 109.523 ms                |
| BarrierTimeBeforeRank0    | 47.538 us                 | 93.663 us                 |
| BlockToStepN              | 45.573 us                 | 4.413 ms                  |
| OneStep                   | 304.114 ms                | 2.870 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.555 ms                  | 108.928 ms                |
| Forward                   | 4.844 ms                  | 553.734 ms                |
| Backward                  | 206.873 ms                | 2.215 s                   |
| Optimize                  | 80.025 ms                 | 109.523 ms                |
| BarrierTimeBeforeRank0    | 46.484 us                 | 93.663 us                 |
| BlockToStepN              | 47.037 us                 | 21.266 ms                 |
| OneStep                   | 299.601 ms                | 2.870 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.638 ms                  | 107.665 ms                |
| Forward                   | 4.803 ms                  | 5.979 ms                  |
| Backward                  | 203.946 ms                | 296.503 ms                |
| Optimize                  | 80.025 ms                 | 102.648 ms                |
| BarrierTimeBeforeRank0    | 46.106 us                 | 77.765 us                 |
| BlockToStepN              | 46.287 us                 | 6.802 ms                  |
| OneStep                   | 298.395 ms                | 435.214 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.865 ms                  | 107.665 ms                |
| Forward                   | 4.778 ms                  | 5.979 ms                  |
| Backward                  | 201.795 ms                | 296.503 ms                |
| Optimize                  | 81.021 ms                 | 102.648 ms                |
| BarrierTimeBeforeRank0    | 42.919 us                 | 77.765 us                 |
| BlockToStepN              | 44.733 us                 | 6.802 ms                  |
| OneStep                   | 295.570 ms                | 435.214 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.319 ms                  | 107.665 ms                |
| Forward                   | 4.841 ms                  | 5.979 ms                  |
| Backward                  | 201.831 ms                | 296.503 ms                |
| Optimize                  | 83.059 ms                 | 102.648 ms                |
| BarrierTimeBeforeRank0    | 41.199 us                 | 77.765 us                 |
| BlockToStepN              | 45.573 us                 | 14.956 ms                 |
| OneStep                   | 296.834 ms                | 435.214 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 34.006, sample: 1.333, forward: 1.060, backward: 13.973, update: 0.284
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 34.659, sample: 1.361, forward: 1.039, backward: 14.284, update: 0.294
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 37.057, sample: 1.497, forward: 1.006, backward: 14.261, update: 0.319
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 33.212, sample: 1.421, forward: 1.048, backward: 14.651, update: 0.304
train_sampler.Prefill()
-------Step 0-------
tensor([24828345,   691544,   478140,   691556,   691568,   691584,  5112698,
          691598,   691612,   360584]) tensor([  191109, 35628472, 35713959,  5181417, 76470682, 28729525, 56010999,
        19455432, 80140526,  3749610])
-------Step 1-------
tensor([24828345,   691544,   478140,   691556,   691568,   691584,  5112698,
          691598,   691612,   360584]) tensor([80460041, 71487396,  4756860,  1220322, 72751389, 67105234, 31428624,
        50593104, 48610623, 28488975])
-------Step 2-------
tensor([   27076,    27115,    27172,    31804, 35321060,    27226, 36516995,
           27287, 24828345, 84436372]) tensor([10124786, 32125357, 25552534, 51953883, 49745810, 56651030, 42095327,
        46033840,  7885043, 24798719])
-------Step 3-------
tensor([   27076,    27115,    27172,    31804, 35321060,    27226, 36516995,
           27287, 24828345, 84436372]) tensor([31576609, 19985220,  8996800, 62764459, 12077092, 15318575, 13953291,
        85967145, 83529823, 64844465])
-------Step 4-------
tensor([  636443,    21542,   145023, 10015303,   145065,   364910,   145106,
         4452673,   145142,   636460]) tensor([67966931, 85560009, 17563134, 37148128, 50231012, 76551420, 61856170,
        22421290, 33149632, 82012685])
-------Step 5-------
tensor([  636443,    21542,   145023, 10015303,   145065,   364910,   145106,
         4452673,   145142,   636460]) tensor([ 4253030,   171487,  8761695, 82358987, 66004908, 33996609, 52274070,
        59948602, 61882758, 27920728])
-------Step 6-------
tensor([  251137,   251182, 24828345,   251219,    38632,   251260,   485521,
          485554, 41946779,  4444615]) tensor([44966349, 47289425, 44985627, 72590149, 45862619,  1167307, 10454808,
         4976569, 61028936, 17158935])
-------Step 7-------
tensor([  251137,   251182, 24828345,   251219,    38632,   251260,   485521,
          485554, 41946779,  4444615]) tensor([25842311, 24550849, 38894856, 69973038, 77431421, 15790218,  1966610,
        43401266, 55492561, 28670034])
-------Step 8-------
tensor([  186715,   352091,   352142,  5402539,  4309804,    90431,    39239,
           39266,   352185, 39154142]) tensor([70840267, 21935703, 60353903, 52473137,  6653672, 16860099, 30355260,
        36212890, 66149659, 26366136])
-------Step 9-------
tensor([  186715,   352091,   352142,  5402539,  4309804,    90431,    39239,
           39266,   352185, 39154142]) tensor([  626275, 49696553, 84843489, 41812956, 69497249, 63848719, 63976849,
        37509949, 78418207, 13712546])
before start barrier
start train
[proc 0] 100 steps, total: 35.530, sample: 1.513, forward: 1.024, backward: 22.728, update: 7.795
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 36.650, sample: 1.497, forward: 1.017, backward: 14.218, update: 0.288
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.829 ms                  | 107.665 ms                |
| Forward                   | 4.798 ms                  | 6.114 ms                  |
| Backward                  | 201.948 ms                | 296.503 ms                |
| Optimize                  | 83.059 ms                 | 102.648 ms                |
| BarrierTimeBeforeRank0    | 40.716 us                 | 93.663 us                 |
| BlockToStepN              | 46.287 us                 | 21.266 ms                 |
| OneStep                   | 296.834 ms                | 435.214 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.829 ms                  | 107.665 ms                |
| Forward                   | 4.789 ms                  | 6.114 ms                  |
| Backward                  | 200.660 ms                | 296.503 ms                |
| Optimize                  | 82.594 ms                 | 102.648 ms                |
| BarrierTimeBeforeRank0    | 40.684 us                 | 93.663 us                 |
| BlockToStepN              | 46.285 us                 | 21.266 ms                 |
| OneStep                   | 296.106 ms                | 435.214 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.212 ms                  | 107.665 ms                |
| Forward                   | 4.789 ms                  | 6.114 ms                  |
| Backward                  | 200.542 ms                | 296.503 ms                |
| Optimize                  | 82.594 ms                 | 109.523 ms                |
| BarrierTimeBeforeRank0    | 40.684 us                 | 93.663 us                 |
| BlockToStepN              | 46.285 us                 | 21.266 ms                 |
| OneStep                   | 295.570 ms                | 435.214 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.714 ms                  | 105.206 ms                |
| Forward                   | 4.788 ms                  | 5.979 ms                  |
| Backward                  | 200.487 ms                | 270.792 ms                |
| Optimize                  | 83.059 ms                 | 109.523 ms                |
| BarrierTimeBeforeRank0    | 39.866 us                 | 78.842 us                 |
| BlockToStepN              | 46.374 us                 | 21.266 ms                 |
| OneStep                   | 295.738 ms                | 434.994 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.616 ms                  | 105.206 ms                |
| Forward                   | 4.778 ms                  | 5.979 ms                  |
| Backward                  | 199.940 ms                | 270.792 ms                |
| Optimize                  | 83.784 ms                 | 111.073 ms                |
| BarrierTimeBeforeRank0    | 39.627 us                 | 78.842 us                 |
| BlockToStepN              | 47.279 us                 | 21.266 ms                 |
| OneStep                   | 295.276 ms                | 434.994 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.544 ms                  | 105.206 ms                |
| Forward                   | 4.798 ms                  | 5.979 ms                  |
| Backward                  | 198.717 ms                | 270.792 ms                |
| Optimize                  | 84.291 ms                 | 111.073 ms                |
| BarrierTimeBeforeRank0    | 40.092 us                 | 78.842 us                 |
| BlockToStepN              | 47.037 us                 | 21.266 ms                 |
| OneStep                   | 293.968 ms                | 434.994 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 30.240, sample: 1.342, forward: 0.494, backward: 11.795, update: 0.281
[proc 4] 200 steps, total: 30.240, sample: 1.309, forward: 0.507, backward: 11.530, update: 0.279
[proc 1] 200 steps, total: 30.240, sample: 1.398, forward: 0.503, backward: 12.121, update: 0.312
[proc 0] 200 steps, total: 30.240, sample: 1.348, forward: 0.470, backward: 20.022, update: 8.216
[proc 2] 200 steps, total: 30.240, sample: 1.716, forward: 0.482, backward: 11.403, update: 0.295
[proc 5] 200 steps, total: 30.240, sample: 1.446, forward: 0.496, backward: 11.702, update: 0.301
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.457 ms                  | 105.206 ms                |
| Forward                   | 4.831 ms                  | 5.979 ms                  |
| Backward                  | 199.314 ms                | 270.792 ms                |
| Optimize                  | 84.302 ms                 | 111.073 ms                |
| BarrierTimeBeforeRank0    | 39.791 us                 | 78.842 us                 |
| BlockToStepN              | 47.279 us                 | 21.266 ms                 |
| OneStep                   | 294.699 ms                | 434.994 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.268 ms                  | 105.206 ms                |
| Forward                   | 4.841 ms                  | 5.979 ms                  |
| Backward                  | 199.940 ms                | 271.469 ms                |
| Optimize                  | 84.633 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 39.626 us                 | 78.842 us                 |
| BlockToStepN              | 47.306 us                 | 21.266 ms                 |
| OneStep                   | 295.570 ms                | 434.994 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.219 ms                  | 105.206 ms                |
| Forward                   | 4.831 ms                  | 5.979 ms                  |
| Backward                  | 199.708 ms                | 271.469 ms                |
| Optimize                  | 84.714 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 39.334 us                 | 78.842 us                 |
| BlockToStepN              | 47.479 us                 | 21.266 ms                 |
| OneStep                   | 295.350 ms                | 434.994 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.169 ms                  | 98.695 ms                 |
| Forward                   | 4.855 ms                  | 5.915 ms                  |
| Backward                  | 198.311 ms                | 270.792 ms                |
| Optimize                  | 84.882 ms                 | 111.073 ms                |
| BarrierTimeBeforeRank0    | 39.349 us                 | 77.765 us                 |
| BlockToStepN              | 47.398 us                 | 15.230 ms                 |
| OneStep                   | 295.078 ms                | 413.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.982 ms                  | 98.695 ms                 |
| Forward                   | 4.885 ms                  | 5.915 ms                  |
| Backward                  | 197.678 ms                | 271.469 ms                |
| Optimize                  | 84.882 ms                 | 111.073 ms                |
| BarrierTimeBeforeRank0    | 39.310 us                 | 77.765 us                 |
| BlockToStepN              | 47.690 us                 | 15.230 ms                 |
| OneStep                   | 294.961 ms                | 433.754 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.937 ms                  | 98.695 ms                 |
| Forward                   | 4.932 ms                  | 5.915 ms                  |
| Backward                  | 198.286 ms                | 271.469 ms                |
| Optimize                  | 85.098 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 39.178 us                 | 77.765 us                 |
| BlockToStepN              | 48.051 us                 | 15.230 ms                 |
| OneStep                   | 295.276 ms                | 433.754 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 30.801, sample: 1.175, forward: 0.510, backward: 12.078, update: 0.298
[proc 0] 300 steps, total: 30.801, sample: 1.019, forward: 0.485, backward: 20.486, update: 8.647
[proc 4] 300 steps, total: 30.801, sample: 1.069, forward: 0.476, backward: 11.989, update: 0.289
[proc 1] 300 steps, total: 30.801, sample: 1.096, forward: 0.544, backward: 12.525, update: 0.289
[proc 5] 300 steps, total: 30.801, sample: 1.120, forward: 0.479, backward: 12.155, update: 0.302
[proc 3] 300 steps, total: 30.801, sample: 1.115, forward: 0.502, backward: 12.031, update: 0.296
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.880 ms                  | 98.695 ms                 |
| Forward                   | 4.932 ms                  | 5.915 ms                  |
| Backward                  | 198.717 ms                | 271.469 ms                |
| Optimize                  | 85.162 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 39.310 us                 | 77.765 us                 |
| BlockToStepN              | 48.563 us                 | 15.230 ms                 |
| OneStep                   | 296.106 ms                | 433.754 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.955 ms                  | 98.695 ms                 |
| Forward                   | 4.943 ms                  | 5.915 ms                  |
| Backward                  | 197.255 ms                | 271.469 ms                |
| Optimize                  | 85.184 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 39.215 us                 | 77.765 us                 |
| BlockToStepN              | 48.051 us                 | 15.230 ms                 |
| OneStep                   | 295.350 ms                | 433.754 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.835 ms                  | 98.695 ms                 |
| Forward                   | 4.955 ms                  | 5.915 ms                  |
| Backward                  | 197.678 ms                | 271.469 ms                |
| Optimize                  | 85.294 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 39.215 us                 | 77.765 us                 |
| BlockToStepN              | 47.660 us                 | 15.230 ms                 |
| OneStep                   | 296.106 ms                | 433.754 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.739 ms                  | 96.141 ms                 |
| Forward                   | 4.973 ms                  | 5.871 ms                  |
| Backward                  | 198.717 ms                | 270.792 ms                |
| Optimize                  | 85.474 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 39.079 us                 | 73.449 us                 |
| BlockToStepN              | 48.044 us                 | 14.956 ms                 |
| OneStep                   | 296.834 ms                | 413.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.739 ms                  | 96.141 ms                 |
| Forward                   | 4.973 ms                  | 5.871 ms                  |
| Backward                  | 197.400 ms                | 270.792 ms                |
| Optimize                  | 85.371 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 39.127 us                 | 73.449 us                 |
| BlockToStepN              | 48.044 us                 | 14.956 ms                 |
| OneStep                   | 295.811 ms                | 413.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.662 ms                  | 96.141 ms                 |
| Forward                   | 4.978 ms                  | 5.871 ms                  |
| Backward                  | 196.433 ms                | 270.792 ms                |
| Optimize                  | 85.579 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 39.079 us                 | 73.449 us                 |
| BlockToStepN              | 47.660 us                 | 15.230 ms                 |
| OneStep                   | 294.986 ms                | 413.956 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 29.607, sample: 1.162, forward: 0.522, backward: 11.639, update: 0.303
[proc 1] 400 steps, total: 29.607, sample: 1.131, forward: 0.523, backward: 12.030, update: 0.364
[proc 0] 400 steps, total: 29.607, sample: 1.100, forward: 0.494, backward: 19.523, update: 8.358
[proc 5] 400 steps, total: 29.607, sample: 1.096, forward: 0.498, backward: 11.737, update: 0.317
[proc 3] 400 steps, total: 29.607, sample: 1.103, forward: 0.519, backward: 11.704, update: 0.321
[proc 4] 400 steps, total: 29.607, sample: 1.089, forward: 0.478, backward: 11.550, update: 0.309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.554 ms                  | 96.141 ms                 |
| Forward                   | 4.994 ms                  | 5.871 ms                  |
| Backward                  | 195.985 ms                | 270.792 ms                |
| Optimize                  | 85.720 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 38.927 us                 | 73.449 us                 |
| BlockToStepN              | 47.718 us                 | 15.909 ms                 |
| OneStep                   | 294.521 ms                | 413.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.392 ms                  | 96.141 ms                 |
| Forward                   | 4.999 ms                  | 6.004 ms                  |
| Backward                  | 195.535 ms                | 270.792 ms                |
| Optimize                  | 85.847 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 38.888 us                 | 73.449 us                 |
| BlockToStepN              | 47.997 us                 | 15.909 ms                 |
| OneStep                   | 293.507 ms                | 413.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.403 ms                  | 96.766 ms                 |
| Forward                   | 5.010 ms                  | 6.212 ms                  |
| Backward                  | 195.053 ms                | 270.792 ms                |
| Optimize                  | 85.899 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 38.967 us                 | 73.449 us                 |
| BlockToStepN              | 48.051 us                 | 15.909 ms                 |
| OneStep                   | 292.579 ms                | 413.956 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.366 ms                  | 96.141 ms                 |
| Forward                   | 5.019 ms                  | 6.114 ms                  |
| Backward                  | 194.324 ms                | 265.857 ms                |
| Optimize                  | 85.990 ms                 | 111.073 ms                |
| BarrierTimeBeforeRank0    | 38.863 us                 | 70.823 us                 |
| BlockToStepN              | 47.718 us                 | 15.230 ms                 |
| OneStep                   | 291.603 ms                | 411.236 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.329 ms                  | 96.141 ms                 |
| Forward                   | 5.025 ms                  | 6.114 ms                  |
| Backward                  | 193.968 ms                | 265.857 ms                |
| Optimize                  | 86.027 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 38.781 us                 | 73.449 us                 |
| BlockToStepN              | 47.997 us                 | 15.909 ms                 |
| OneStep                   | 291.457 ms                | 411.236 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 28.064, sample: 1.056, forward: 0.482, backward: 11.413, update: 0.396
[proc 0] 500 steps, total: 28.064, sample: 0.961, forward: 0.570, backward: 17.453, update: 8.915
[proc 3] 500 steps, total: 28.064, sample: 1.040, forward: 0.551, backward: 11.473, update: 0.293
[proc 5] 500 steps, total: 28.064, sample: 1.015, forward: 0.482, backward: 11.552, update: 0.425
[proc 1] 500 steps, total: 28.064, sample: 1.033, forward: 0.560, backward: 11.688, update: 0.393
[proc 2] 500 steps, total: 28.065, sample: 1.083, forward: 0.557, backward: 11.431, update: 0.420
Successfully xmh. training takes 154.24323844909668 seconds
before call kg_cache_controller.StopThreads()
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
INFO [55775 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.299 ms                  | 96.141 ms                 |
| Forward                   | 5.025 ms                  | 6.212 ms                  |
| Backward                  | 193.631 ms                | 265.857 ms                |
| Optimize                  | 86.136 ms                 | 111.297 ms                |
| BarrierTimeBeforeRank0    | 38.750 us                 | 73.449 us                 |
| BlockToStepN              | 47.718 us                 | 15.909 ms                 |
| OneStep                   | 290.843 ms                | 411.236 ms                |
+---------------------------+---------------------------+---------------------------+
