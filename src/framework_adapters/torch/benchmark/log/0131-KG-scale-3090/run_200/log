WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 11:39:10.558822  2326 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_2', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [2326 sampler.py:454] Start PreSampling
WARNING [2326 sampler.py:532] Before construct renumbering_dict
WARNING [2326 sampler.py:555] PreSampling done
W20240206 11:57:48.473691  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 11:57:48.473888  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 11:57:48.473928  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 11:57:48.473960  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 11:57:48.474000  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 11:57:48.474036  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 11:57:48.474074  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 11:57:48.474130  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 11:57:48.474165  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 11:57:48.474207  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 11:57:48.474252  2326 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 11:57:48.474284  2326 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 11:57:48.474319  2326 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 11:57:48.474483  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 11:57:48.474519  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 11:57:48.474556  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 11:57:48.474602  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 11:57:48.474639  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 11:57:48.474673  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 11:57:48.474707  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 11:57:48.474745  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 11:57:48.474781  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 11:57:48.474812  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 11:57:48.474849  2326 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 11:57:48.474874  2326 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 11:57:48.474901  2326 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 11:57:48.474972  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 11:57:48.475008  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 11:57:48.475039  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 11:57:48.475075  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 11:57:48.475114  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 11:57:48.475147  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 11:57:48.475183  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 11:57:48.475219  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 11:57:48.475250  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 11:57:48.475287  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 11:57:48.475323  2326 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 11:57:48.475348  2326 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 11:57:48.475379  2326 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 11:57:48.475445  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 11:57:48.475482  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 11:57:48.475518  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 11:57:48.475555  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 11:57:48.475589  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 11:57:48.475628  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 11:57:48.475664  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 11:57:48.475701  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 11:57:48.475733  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 11:57:48.475769  2326 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 11:57:48.475800  2326 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 11:57:48.475826  2326 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 11:57:48.475852  2326 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 11:57:48.919909  2326 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240206 12:06:21.006866  2326 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4302717,  4302745,   102405,  ..., 63886367, 14525878,  2464353]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2137.055 seconds
[Rank1] pid = 3455
[Rank2] pid = 3550
INFO [2326 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3455 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3455 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [3617 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [3550 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [3550 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [3617 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [2326 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240206 12:14:53.708159  3627 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240206 12:14:53.708844  3456 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240206 12:14:53.709245  3618 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240206 12:14:53.709251  3551 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240206 12:14:53.761607  3627 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102036619000 7.629 MB
W20240206 12:14:53.761631  3456 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10203755f000 7.629 MB
W20240206 12:14:53.761627  3618 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102036dbc000 7.629 MB
W20240206 12:14:53.761680  3551 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102037d02000 7.629 MB
W20240206 12:14:53.761765  3627 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020384a5000 7.629 MB
W20240206 12:14:53.761801  3456 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102038c48000 7.629 MB
W20240206 12:14:53.761804  3618 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020393eb000 7.629 MB
W20240206 12:14:53.761822  3551 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102039b8e000 7.629 MB
W20240206 12:14:53.761824  3627 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10203a331000 1.49 GB
W20240206 12:14:53.761870  3627 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102099914000 1.49 GB
W20240206 12:14:53.761888  3456 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1020f8ef7000 1.49 GB
W20240206 12:14:53.761895  3618 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1021584da000 1.49 GB
W20240206 12:14:53.761909  3627 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 12:14:53.761914  3551 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1021b7abd000 1.49 GB
W20240206 12:14:53.761942  3456 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1022170a0000 1.49 GB
W20240206 12:14:53.761950  3618 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102276683000 1.49 GB
W20240206 12:14:53.761970  3551 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022d5c66000 1.49 GB
W20240206 12:14:53.761994  3456 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 12:14:53.762001  3618 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 12:14:53.762008  3551 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 12:14:53.768334  3627 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 12:14:53.768380  3456 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 12:14:53.768399  3618 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 12:14:53.768404  3551 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [3455 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank3] pid = 3617
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [2326 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [3550 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [3617 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 12:15:26.136219  3618 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240206 12:15:26.136399  3551 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240206 12:15:26.136480  3456 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240206 12:15:26.136569  3627 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240206 12:15:26.138495  3627 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240206 12:15:26.138779  3627 grad_base.h:184] Init GradProcessingBase done
I20240206 12:15:39.202649  3627 grad_async_v1.h:203] Use main thread to update emb.
W20240206 12:15:39.202802  3627 kg_controller.h:75] after init GradAsyncProcessing
I20240206 12:15:39.202813  3627 kg_controller.h:84] Construct KGCacheController done
E20240206 12:15:39.660831  3456 recstore.cc:66] init folly done
E20240206 12:15:39.660883  3618 recstore.cc:66] init folly done
E20240206 12:15:39.661159  3551 recstore.cc:66] init folly done
E20240206 12:15:39.661429  3627 recstore.cc:66] init folly done
I20240206 12:15:39.662223  3627 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240206 12:15:58.242202  3618 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240206 12:16:01.239609  3456 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240206 12:16:01.336980  3627 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240206 12:16:01.490568  3551 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240206 12:16:02.786056  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240206 12:16:03.090837  3787 grad_async_v1.h:533] Stalled in ProcessBackward: rank=2, step_no=1, sample_step_cpp_seen_[rank]=0
W20240206 12:16:03.786008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.672 ms                  | 187.910 ms                |
| ProcessBack:UpdateCache   | 3.048 ms                  | 283.262 ms                |
| ProcessBack:UpsertPq      | 25.363 ms                 | 47.573 ms                 |
| ProcessOneStep            | 49.227 ms                 | 553.873 ms                |
| BlockToStepN              | 228.203 ms                | 272.324 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:04.885525  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240206 12:16:05.885010  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.763 ms                  | 95.250 ms                 |
| Forward                   | 5.263 ms                  | 437.783 ms                |
| Backward                  | 11.196 ms                 | 219.541 ms                |
| Optimize                  | 2.275 ms                  | 42.577 ms                 |
| BarrierTimeBeforeRank0    | 5.496 ms                  | 242.634 ms                |
| AfterBackward             | 45.314 ms                 | 554.021 ms                |
| BlockToStepN              | 75.123 us                 | 318.062 ms                |
| OneStep                   | 175.194 ms                | 1.568 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:06.885007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240206 12:16:07.947702  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240206 12:16:08.947007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.573 ms                  | 146.445 ms                |
| ProcessBack:UpdateCache   | 2.818 ms                  | 282.353 ms                |
| ProcessBack:UpsertPq      | 19.677 ms                 | 44.832 ms                 |
| ProcessOneStep            | 26.713 ms                 | 553.873 ms                |
| BlockToStepN              | 221.143 ms                | 336.737 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:09.947007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240206 12:16:10.991159  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.475 ms                  | 95.250 ms                 |
| Forward                   | 5.291 ms                  | 437.783 ms                |
| Backward                  | 11.111 ms                 | 219.541 ms                |
| Optimize                  | 2.340 ms                  | 42.577 ms                 |
| BarrierTimeBeforeRank0    | 2.745 ms                  | 242.634 ms                |
| AfterBackward             | 26.461 ms                 | 554.021 ms                |
| BlockToStepN              | 254.743 us                | 336.818 ms                |
| OneStep                   | 175.194 ms                | 1.568 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:11.991008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240206 12:16:13.042990  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240206 12:16:14.042021  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.541 ms                  | 146.445 ms                |
| ProcessBack:UpdateCache   | 2.886 ms                  | 282.353 ms                |
| ProcessBack:UpsertPq      | 19.940 ms                 | 44.832 ms                 |
| ProcessOneStep            | 26.594 ms                 | 133.601 ms                |
| BlockToStepN              | 219.823 us                | 336.737 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:15.042007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240206 12:16:16.081140  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.127 ms                  | 95.250 ms                 |
| Forward                   | 5.204 ms                  | 10.590 ms                 |
| Backward                  | 11.128 ms                 | 14.679 ms                 |
| Optimize                  | 2.340 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 4.456 ms                  | 208.424 ms                |
| AfterBackward             | 26.913 ms                 | 133.645 ms                |
| BlockToStepN              | 254.743 us                | 321.532 ms                |
| OneStep                   | 175.194 ms                | 648.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:17.081008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240206 12:16:18.081007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240206 12:16:19.081008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.640 ms                  | 146.445 ms                |
| ProcessBack:UpdateCache   | 2.942 ms                  | 282.353 ms                |
| ProcessBack:UpsertPq      | 20.658 ms                 | 50.767 ms                 |
| ProcessOneStep            | 28.288 ms                 | 133.601 ms                |
| BlockToStepN              | 219.823 us                | 326.589 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:20.081033  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240206 12:16:21.081007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.226 ms                  | 195.495 ms                |
| Forward                   | 5.019 ms                  | 10.590 ms                 |
| Backward                  | 11.134 ms                 | 14.679 ms                 |
| Optimize                  | 2.363 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 1.093 ms                  | 208.424 ms                |
| AfterBackward             | 27.663 ms                 | 133.645 ms                |
| BlockToStepN              | 254.743 us                | 336.818 ms                |
| OneStep                   | 175.194 ms                | 648.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:22.081007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240206 12:16:23.367933  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240206 12:16:24.367007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.625 ms                  | 25.165 ms                 |
| ProcessBack:UpdateCache   | 2.846 ms                  | 18.920 ms                 |
| ProcessBack:UpsertPq      | 19.211 ms                 | 47.573 ms                 |
| ProcessOneStep            | 26.594 ms                 | 133.601 ms                |
| BlockToStepN              | 221.143 ms                | 340.701 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:25.367007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.505 ms                  | 195.495 ms                |
| Forward                   | 4.899 ms                  | 10.590 ms                 |
| Backward                  | 11.083 ms                 | 14.679 ms                 |
| Optimize                  | 2.357 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 306.680 us                | 208.424 ms                |
| AfterBackward             | 26.283 ms                 | 133.645 ms                |
| BlockToStepN              | 254.743 us                | 340.786 ms                |
| OneStep                   | 175.194 ms                | 648.830 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 24.895, sample: 2.251, forward: 0.911, backward: 1.379, update: 0.274
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 28.143, sample: 1.469, forward: 0.893, backward: 1.251, update: 0.277
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 25.145, sample: 2.245, forward: 0.926, backward: 1.180, update: 0.280
train_sampler.Prefill()
-------Step 0-------
tensor([   62211,   502483, 42191967,   909516,   440005,   502500,   502523,
          209136,    62243,    62289]) tensor([ 4919132, 28661569, 23174614, 47941132, 50385043, 26266440, 83457729,
        70070551, 57448186, 75686914])
-------Step 1-------
tensor([   62211,   502483, 42191967,   909516,   440005,   502500,   502523,
          209136,    62243,    62289]) tensor([27444341, 78147995, 81438096, 10230616, 55021095,  8318570, 85535678,
        79953230, 18087856, 30411308])
-------Step 2-------
tensor([  573851,    76982, 67058605,    77019,   573873,   573900,   573925,
        38876075,   573943,   573968]) tensor([33289353,  4948808, 60918416,  9478728, 16018834, 12528615, 61993463,
         9342585, 52996124, 34441035])
-------Step 3-------
tensor([  573851,    76982, 67058605,    77019,   573873,   573900,   573925,
        38876075,   573943,   573968]) tensor([17992747, 41797749, 71288519, 36471075, 14154431, 71305472, 65954511,
        58869609, 21959753, 79702488])
-------Step 4-------
tensor([643967,  92003, 643991, 644024,  92038, 644046,  92084, 644074,  92134,
        644107]) tensor([69875419, 40914223, 15211694, 13727279, 57535476, 41899586, 82737939,
        49982405, 53082957,  9239779])
-------Step 5-------
tensor([643967,  92003, 643991, 644024,  92038, 644046,  92084, 644074,  92134,
        644107]) tensor([31414489, 42549971, 84743065,  9295779, 34359414, 31317614, 37645636,
        72831168, 84575391,   391255])
-------Step 6-------
tensor([76092424,   713515,   713540,   713563,  4309254,   713592,   713611,
          713636,   713655,   214176]) tensor([27764788, 39126512, 26573142, 18663639, 69292309, 53057652, 39073605,
        14487193, 69100894,  8133392])
-------Step 7-------
tensor([76092424,   713515,   713540,   713563,  4309254,   713592,   713611,
          713636,   713655,   214176]) tensor([40044704, 85861689, 49888668, 72883375, 63412803,  1512316, 15450744,
        45204079, 19312349, 15344552])
-------Step 8-------
tensor([  783941,   122607,   783968, 32407716,   940662,   783992,   784022,
          784050,   215714,   940679]) tensor([23116880, 53619461, 48727111, 85903654, 83354335, 65775248, 57793382,
        82203021, 10415683,  3243716])
-------Step 9-------
tensor([  783941,   122607,   783968, 32407716,   940662,   783992,   784022,
          784050,   215714,   940679]) tensor([76358888, 60559235, 23562463, 37875032, 11421986,  1070294, 19429073,
        13772047, 82848579, 47336404])
before start barrier
start train
[proc 0] 100 steps, total: 25.048, sample: 1.899, forward: 0.936, backward: 1.302, update: 0.314
W20240206 12:16:26.432492  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240206 12:16:27.540828  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240206 12:16:28.540007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240206 12:16:29.540006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.574 ms                  | 25.165 ms                 |
| ProcessBack:UpdateCache   | 2.708 ms                  | 18.920 ms                 |
| ProcessBack:UpsertPq      | 18.274 ms                 | 47.573 ms                 |
| ProcessOneStep            | 25.166 ms                 | 133.601 ms                |
| BlockToStepN              | 221.143 ms                | 342.843 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:30.582592  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=118, pq.top=118
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.621 ms                  | 195.495 ms                |
| Forward                   | 4.863 ms                  | 10.590 ms                 |
| Backward                  | 11.022 ms                 | 37.592 ms                 |
| Optimize                  | 2.364 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 46.592 us                 | 208.424 ms                |
| AfterBackward             | 24.998 ms                 | 133.645 ms                |
| BlockToStepN              | 351.460 us                | 343.328 ms                |
| OneStep                   | 175.194 ms                | 648.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:31.582007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240206 12:16:32.635852  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240206 12:16:33.635005  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240206 12:16:34.635010  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.554 ms                  | 24.956 ms                 |
| ProcessBack:UpdateCache   | 2.695 ms                  | 9.865 ms                  |
| ProcessBack:UpsertPq      | 18.130 ms                 | 44.832 ms                 |
| ProcessOneStep            | 24.711 ms                 | 133.601 ms                |
| BlockToStepN              | 312.604 us                | 346.889 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:35.635007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.141 ms                  | 195.495 ms                |
| Forward                   | 4.837 ms                  | 10.590 ms                 |
| Backward                  | 11.009 ms                 | 37.592 ms                 |
| Optimize                  | 2.438 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 324.900 us                | 208.424 ms                |
| AfterBackward             | 24.998 ms                 | 133.645 ms                |
| BlockToStepN              | 351.460 us                | 346.946 ms                |
| OneStep                   | 175.194 ms                | 648.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:36.635007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240206 12:16:37.635007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240206 12:16:38.635005  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240206 12:16:39.635018  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.542 ms                  | 24.956 ms                 |
| ProcessBack:UpdateCache   | 2.687 ms                  | 9.865 ms                  |
| ProcessBack:UpsertPq      | 18.180 ms                 | 47.573 ms                 |
| ProcessOneStep            | 25.125 ms                 | 58.061 ms                 |
| BlockToStepN              | 324.356 us                | 342.843 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:40.635010  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.577 ms                  | 195.495 ms                |
| Forward                   | 4.848 ms                  | 7.782 ms                  |
| Backward                  | 10.990 ms                 | 14.679 ms                 |
| Optimize                  | 2.442 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 242.325 us                | 193.518 ms                |
| AfterBackward             | 25.363 ms                 | 58.116 ms                 |
| BlockToStepN              | 394.832 us                | 343.328 ms                |
| OneStep                   | 199.472 ms                | 642.874 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:41.741225  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240206 12:16:42.741006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240206 12:16:43.741009  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.554 ms                  | 24.956 ms                 |
| ProcessBack:UpdateCache   | 2.688 ms                  | 9.865 ms                  |
| ProcessBack:UpsertPq      | 18.371 ms                 | 47.573 ms                 |
| ProcessOneStep            | 25.656 ms                 | 58.061 ms                 |
| BlockToStepN              | 324.356 us                | 349.904 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:44.741004  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240206 12:16:45.741008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.125 ms                  | 199.588 ms                |
| Forward                   | 4.858 ms                  | 7.782 ms                  |
| Backward                  | 11.022 ms                 | 14.679 ms                 |
| Optimize                  | 2.465 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 46.847 us                 | 193.518 ms                |
| AfterBackward             | 25.363 ms                 | 58.116 ms                 |
| BlockToStepN              | 837.939 us                | 402.151 ms                |
| OneStep                   | 199.472 ms                | 648.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:46.741007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240206 12:16:47.803436  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240206 12:16:48.844848  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.573 ms                  | 21.663 ms                 |
| ProcessBack:UpdateCache   | 2.671 ms                  | 6.802 ms                  |
| ProcessBack:UpsertPq      | 18.135 ms                 | 45.672 ms                 |
| ProcessOneStep            | 25.331 ms                 | 58.061 ms                 |
| BlockToStepN              | 798.044 us                | 410.894 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:49.870275  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.408 ms                  | 287.433 ms                |
| Forward                   | 4.859 ms                  | 7.782 ms                  |
| Backward                  | 11.076 ms                 | 14.679 ms                 |
| Optimize                  | 2.494 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 44.267 us                 | 193.518 ms                |
| AfterBackward             | 25.310 ms                 | 58.116 ms                 |
| BlockToStepN              | 837.939 us                | 410.954 ms                |
| OneStep                   | 199.472 ms                | 681.898 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:51.188930  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 3] 200 steps, total: 25.330, sample: 1.594, forward: 0.420, backward: 1.017, update: 0.230
[proc 2] 200 steps, total: 25.330, sample: 1.855, forward: 0.469, backward: 1.144, update: 0.239
[proc 1] 200 steps, total: 25.330, sample: 2.446, forward: 0.499, backward: 1.122, update: 0.228
[proc 0] 200 steps, total: 25.330, sample: 2.746, forward: 0.485, backward: 1.154, update: 0.299
W20240206 12:16:52.244046  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240206 12:16:53.269841  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240206 12:16:54.305483  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.578 ms                  | 21.663 ms                 |
| ProcessBack:UpdateCache   | 2.670 ms                  | 6.802 ms                  |
| ProcessBack:UpsertPq      | 18.011 ms                 | 45.672 ms                 |
| ProcessOneStep            | 25.280 ms                 | 58.061 ms                 |
| BlockToStepN              | 798.044 us                | 416.620 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:55.587783  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.515 ms                  | 287.433 ms                |
| Forward                   | 4.863 ms                  | 7.782 ms                  |
| Backward                  | 11.126 ms                 | 14.679 ms                 |
| Optimize                  | 2.498 ms                  | 10.999 ms                 |
| BarrierTimeBeforeRank0    | 44.011 us                 | 193.518 ms                |
| AfterBackward             | 25.310 ms                 | 58.116 ms                 |
| BlockToStepN              | 837.939 us                | 416.701 ms                |
| OneStep                   | 199.472 ms                | 738.236 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:16:56.587005  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240206 12:16:57.587007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240206 12:16:58.587007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240206 12:16:59.587006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.603 ms                  | 16.175 ms                 |
| ProcessBack:UpdateCache   | 2.658 ms                  | 6.740 ms                  |
| ProcessBack:UpsertPq      | 17.878 ms                 | 44.832 ms                 |
| ProcessOneStep            | 25.166 ms                 | 58.061 ms                 |
| BlockToStepN              | 798.044 us                | 416.620 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:00.587007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.989 ms                  | 287.433 ms                |
| Forward                   | 4.881 ms                  | 7.782 ms                  |
| Backward                  | 11.186 ms                 | 14.679 ms                 |
| Optimize                  | 2.541 ms                  | 16.780 ms                 |
| BarrierTimeBeforeRank0    | 44.011 us                 | 193.518 ms                |
| AfterBackward             | 25.093 ms                 | 58.116 ms                 |
| BlockToStepN              | 837.939 us                | 416.701 ms                |
| OneStep                   | 199.472 ms                | 738.236 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:01.622753  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240206 12:17:02.622007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240206 12:17:03.622007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240206 12:17:04.622007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.618 ms                  | 24.956 ms                 |
| ProcessBack:UpdateCache   | 2.670 ms                  | 6.802 ms                  |
| ProcessBack:UpsertPq      | 17.878 ms                 | 44.832 ms                 |
| ProcessOneStep            | 25.331 ms                 | 57.627 ms                 |
| BlockToStepN              | 798.044 us                | 414.886 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:05.684157  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.037 ms                  | 270.813 ms                |
| Forward                   | 4.885 ms                  | 7.644 ms                  |
| Backward                  | 11.227 ms                 | 14.575 ms                 |
| Optimize                  | 2.559 ms                  | 10.999 ms                 |
| BarrierTimeBeforeRank0    | 39.167 us                 | 77.386 ms                 |
| AfterBackward             | 25.428 ms                 | 57.657 ms                 |
| BlockToStepN              | 837.939 us                | 414.950 ms                |
| OneStep                   | 199.472 ms                | 700.203 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:06.684008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240206 12:17:07.688899  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240206 12:17:08.829008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.622 ms                  | 21.663 ms                 |
| ProcessBack:UpdateCache   | 2.658 ms                  | 6.740 ms                  |
| ProcessBack:UpsertPq      | 17.921 ms                 | 44.495 ms                 |
| ProcessOneStep            | 25.394 ms                 | 57.627 ms                 |
| BlockToStepN              | 798.044 us                | 414.886 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:09.829007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240206 12:17:10.829006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.989 ms                  | 270.813 ms                |
| Forward                   | 4.895 ms                  | 7.644 ms                  |
| Backward                  | 11.317 ms                 | 14.679 ms                 |
| Optimize                  | 2.564 ms                  | 10.999 ms                 |
| BarrierTimeBeforeRank0    | 37.678 us                 | 77.386 ms                 |
| AfterBackward             | 25.381 ms                 | 57.657 ms                 |
| BlockToStepN              | 5.387 ms                  | 414.950 ms                |
| OneStep                   | 199.472 ms                | 700.203 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:11.829020  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240206 12:17:12.829007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240206 12:17:13.829007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 2] 300 steps, total: 22.300, sample: 2.063, forward: 0.502, backward: 1.141, update: 0.239
[proc 3] 300 steps, total: 22.300, sample: 1.424, forward: 0.433, backward: 1.028, update: 0.238
[proc 0] 300 steps, total: 22.300, sample: 2.372, forward: 0.499, backward: 1.281, update: 0.311
[proc 1] 300 steps, total: 22.300, sample: 1.818, forward: 0.497, backward: 1.151, update: 0.233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.622 ms                  | 21.663 ms                 |
| ProcessBack:UpdateCache   | 2.658 ms                  | 6.740 ms                  |
| ProcessBack:UpsertPq      | 17.908 ms                 | 44.495 ms                 |
| ProcessOneStep            | 25.394 ms                 | 57.627 ms                 |
| BlockToStepN              | 5.343 ms                  | 414.886 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:14.948277  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240206 12:17:15.948007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.989 ms                  | 270.813 ms                |
| Forward                   | 4.883 ms                  | 7.644 ms                  |
| Backward                  | 11.405 ms                 | 14.679 ms                 |
| Optimize                  | 2.564 ms                  | 10.999 ms                 |
| BarrierTimeBeforeRank0    | 34.925 us                 | 77.386 ms                 |
| AfterBackward             | 25.428 ms                 | 57.657 ms                 |
| BlockToStepN              | 139.194 ms                | 414.950 ms                |
| OneStep                   | 201.597 ms                | 700.203 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:16.948005  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240206 12:17:17.948009  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240206 12:17:19.040514  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.614 ms                  | 21.663 ms                 |
| ProcessBack:UpdateCache   | 2.652 ms                  | 6.740 ms                  |
| ProcessBack:UpsertPq      | 17.658 ms                 | 44.495 ms                 |
| ProcessOneStep            | 25.331 ms                 | 57.627 ms                 |
| BlockToStepN              | 5.343 ms                  | 414.886 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:20.090327  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240206 12:17:21.090006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=331, pq.top=331
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.071 ms                  | 270.813 ms                |
| Forward                   | 4.898 ms                  | 7.644 ms                  |
| Backward                  | 11.485 ms                 | 14.679 ms                 |
| Optimize                  | 2.574 ms                  | 10.999 ms                 |
| BarrierTimeBeforeRank0    | 34.925 us                 | 77.386 ms                 |
| AfterBackward             | 25.324 ms                 | 57.657 ms                 |
| BlockToStepN              | 5.387 ms                  | 414.950 ms                |
| OneStep                   | 199.472 ms                | 700.203 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:22.090008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240206 12:17:23.107206  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=341, pq.top=341
W20240206 12:17:24.175570  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=345, pq.top=345
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.618 ms                  | 16.175 ms                 |
| ProcessBack:UpdateCache   | 2.643 ms                  | 6.234 ms                  |
| ProcessBack:UpsertPq      | 17.506 ms                 | 42.795 ms                 |
| ProcessOneStep            | 25.208 ms                 | 57.627 ms                 |
| BlockToStepN              | 5.343 ms                  | 414.886 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:25.175007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=349, pq.top=349
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.101 ms                  | 240.246 ms                |
| Forward                   | 4.907 ms                  | 7.253 ms                  |
| Backward                  | 11.505 ms                 | 14.575 ms                 |
| Optimize                  | 2.574 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 34.096 us                 | 72.631 ms                 |
| AfterBackward             | 25.192 ms                 | 57.570 ms                 |
| BlockToStepN              | 5.387 ms                  | 414.265 ms                |
| OneStep                   | 199.472 ms                | 681.898 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:26.175006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240206 12:17:27.376062  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240206 12:17:28.376006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=363, pq.top=363
W20240206 12:17:29.376006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=367, pq.top=367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.620 ms                  | 16.175 ms                 |
| ProcessBack:UpdateCache   | 2.643 ms                  | 6.234 ms                  |
| ProcessBack:UpsertPq      | 17.329 ms                 | 42.795 ms                 |
| ProcessOneStep            | 25.131 ms                 | 57.539 ms                 |
| BlockToStepN              | 5.343 ms                  | 414.194 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:30.376008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.122 ms                  | 240.246 ms                |
| Forward                   | 4.905 ms                  | 7.253 ms                  |
| Backward                  | 11.584 ms                 | 14.575 ms                 |
| Optimize                  | 2.572 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 32.990 us                 | 72.631 ms                 |
| AfterBackward             | 25.165 ms                 | 57.570 ms                 |
| BlockToStepN              | 5.387 ms                  | 414.265 ms                |
| OneStep                   | 199.472 ms                | 681.898 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:31.376006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240206 12:17:32.393621  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=380, pq.top=380
W20240206 12:17:33.393007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240206 12:17:34.393007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=389, pq.top=389
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.622 ms                  | 15.856 ms                 |
| ProcessBack:UpdateCache   | 2.640 ms                  | 6.184 ms                  |
| ProcessBack:UpsertPq      | 17.171 ms                 | 42.784 ms                 |
| ProcessOneStep            | 25.090 ms                 | 57.539 ms                 |
| BlockToStepN              | 5.343 ms                  | 414.194 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:35.393007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.086 ms                  | 240.246 ms                |
| Forward                   | 4.907 ms                  | 7.253 ms                  |
| Backward                  | 11.699 ms                 | 14.575 ms                 |
| Optimize                  | 2.571 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 32.275 us                 | 72.631 ms                 |
| AfterBackward             | 25.047 ms                 | 57.570 ms                 |
| BlockToStepN              | 5.387 ms                  | 414.265 ms                |
| OneStep                   | 199.472 ms                | 681.898 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:36.396225  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=397, pq.top=397
[proc 0] 400 steps, total: 22.886, sample: 1.908, forward: 0.491, backward: 1.230, update: 0.288
[proc 2] 400 steps, total: 22.886, sample: 1.817, forward: 0.483, backward: 1.127, update: 0.248
[proc 3] 400 steps, total: 22.886, sample: 1.281, forward: 0.420, backward: 1.027, update: 0.240
[proc 1] 400 steps, total: 22.886, sample: 1.620, forward: 0.486, backward: 1.089, update: 0.232
W20240206 12:17:37.396008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240206 12:17:38.443536  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240206 12:17:39.443006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.622 ms                  | 15.856 ms                 |
| ProcessBack:UpdateCache   | 2.629 ms                  | 6.184 ms                  |
| ProcessBack:UpsertPq      | 17.171 ms                 | 42.784 ms                 |
| ProcessOneStep            | 25.090 ms                 | 57.539 ms                 |
| BlockToStepN              | 5.343 ms                  | 414.194 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:40.443007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=415, pq.top=415
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.086 ms                  | 240.246 ms                |
| Forward                   | 4.910 ms                  | 7.644 ms                  |
| Backward                  | 11.721 ms                 | 14.575 ms                 |
| Optimize                  | 2.564 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 31.392 us                 | 72.631 ms                 |
| AfterBackward             | 25.165 ms                 | 57.570 ms                 |
| BlockToStepN              | 5.387 ms                  | 414.265 ms                |
| OneStep                   | 199.472 ms                | 681.898 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:41.514988  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240206 12:17:42.559760  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=425, pq.top=425
W20240206 12:17:43.559007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240206 12:17:44.559007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=433, pq.top=433
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.623 ms                  | 14.394 ms                 |
| ProcessBack:UpdateCache   | 2.629 ms                  | 6.097 ms                  |
| ProcessBack:UpsertPq      | 17.203 ms                 | 42.264 ms                 |
| ProcessOneStep            | 25.121 ms                 | 57.539 ms                 |
| BlockToStepN              | 15.909 ms                 | 414.194 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:45.581378  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=438, pq.top=438
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.101 ms                  | 240.246 ms                |
| Forward                   | 4.911 ms                  | 7.644 ms                  |
| Backward                  | 11.755 ms                 | 14.575 ms                 |
| Optimize                  | 2.563 ms                  | 9.474 ms                  |
| BarrierTimeBeforeRank0    | 30.745 us                 | 72.631 ms                 |
| AfterBackward             | 25.165 ms                 | 57.570 ms                 |
| BlockToStepN              | 139.194 ms                | 414.265 ms                |
| OneStep                   | 201.597 ms                | 681.898 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:46.581008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240206 12:17:47.625209  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
W20240206 12:17:48.625006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240206 12:17:49.625006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.625 ms                  | 16.175 ms                 |
| ProcessBack:UpdateCache   | 2.633 ms                  | 6.097 ms                  |
| ProcessBack:UpsertPq      | 17.238 ms                 | 42.264 ms                 |
| ProcessOneStep            | 25.162 ms                 | 52.659 ms                 |
| BlockToStepN              | 37.055 ms                 | 413.101 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:50.625007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=459, pq.top=459
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.116 ms                  | 238.469 ms                |
| Forward                   | 4.910 ms                  | 7.253 ms                  |
| Backward                  | 11.815 ms                 | 14.565 ms                 |
| Optimize                  | 2.561 ms                  | 8.832 ms                  |
| BarrierTimeBeforeRank0    | 30.619 us                 | 72.156 ms                 |
| AfterBackward             | 25.165 ms                 | 52.711 ms                 |
| BlockToStepN              | 37.120 ms                 | 413.194 ms                |
| OneStep                   | 199.472 ms                | 648.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:51.625007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=463, pq.top=463
W20240206 12:17:52.625008  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240206 12:17:53.625007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.625 ms                  | 15.856 ms                 |
| ProcessBack:UpdateCache   | 2.640 ms                  | 5.703 ms                  |
| ProcessBack:UpsertPq      | 17.163 ms                 | 41.883 ms                 |
| ProcessOneStep            | 25.131 ms                 | 52.659 ms                 |
| BlockToStepN              | 43.648 ms                 | 413.101 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:54.704182  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240206 12:17:55.704007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=481, pq.top=481
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.118 ms                  | 238.469 ms                |
| Forward                   | 4.904 ms                  | 7.253 ms                  |
| Backward                  | 11.856 ms                 | 14.565 ms                 |
| Optimize                  | 2.558 ms                  | 8.832 ms                  |
| BarrierTimeBeforeRank0    | 30.450 us                 | 72.156 ms                 |
| AfterBackward             | 25.159 ms                 | 52.711 ms                 |
| BlockToStepN              | 43.705 ms                 | 413.194 ms                |
| OneStep                   | 199.472 ms                | 648.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:56.704007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240206 12:17:57.704006  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=489, pq.top=489
W20240206 12:17:58.704007  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=493, pq.top=493
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.625 ms                  | 15.856 ms                 |
| ProcessBack:UpdateCache   | 2.634 ms                  | 5.703 ms                  |
| ProcessBack:UpsertPq      | 17.035 ms                 | 41.883 ms                 |
| ProcessOneStep            | 25.121 ms                 | 52.659 ms                 |
| BlockToStepN              | 48.888 ms                 | 413.101 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 12:17:59.732120  3627 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=498, pq.top=498
[proc 3] 500 steps, total: 23.339, sample: 1.216, forward: 0.411, backward: 1.033, update: 0.232
[proc 1] 500 steps, total: 23.339, sample: 1.406, forward: 0.484, backward: 1.139, update: 0.240
[proc 0] 500 steps, total: 23.339, sample: 1.733, forward: 0.495, backward: 1.211, update: 0.277
[proc 2] 500 steps, total: 23.339, sample: 1.614, forward: 0.462, backward: 1.145, update: 0.240
Successfully xmh. training takes 118.90329813957214 seconds
before call kg_cache_controller.StopThreads()
W20240206 12:18:00.240316  3627 grad_async_v1.h:243] call StopThreads. PID = 2326
W20240206 12:18:00.240341  3627 grad_base.h:212] before processOneStepNegThread_.join();
W20240206 12:18:00.245445  3627 grad_base.h:214] after processOneStepNegThread_.join();
W20240206 12:18:00.245461  3627 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240206 12:18:00.259971  3627 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.116 ms                  | 238.469 ms                |
| Forward                   | 4.905 ms                  | 7.253 ms                  |
| Backward                  | 11.913 ms                 | 14.565 ms                 |
| Optimize                  | 2.555 ms                  | 8.832 ms                  |
| BarrierTimeBeforeRank0    | 30.788 us                 | 72.156 ms                 |
| AfterBackward             | 25.125 ms                 | 52.711 ms                 |
| BlockToStepN              | 48.940 ms                 | 413.194 ms                |
| OneStep                   | 199.472 ms                | 648.830 ms                |
+---------------------------+---------------------------+---------------------------+
