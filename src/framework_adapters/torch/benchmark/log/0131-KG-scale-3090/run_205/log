WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 15:15:35.067514 49967 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_7', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [49967 sampler.py:454] Start PreSampling
WARNING [49967 sampler.py:532] Before construct renumbering_dict
WARNING [49967 sampler.py:555] PreSampling done
W20240206 15:36:00.782790 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 15:36:00.782979 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 15:36:00.783025 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 15:36:00.783059 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 15:36:00.783089 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 15:36:00.783123 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 15:36:00.783155 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 15:36:00.783193 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 15:36:00.783229 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 15:36:00.783254 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 15:36:00.783288 49967 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 15:36:00.783314 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 15:36:00.783344 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 15:36:00.783499 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 15:36:00.783537 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 15:36:00.783564 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 15:36:00.783618 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 15:36:00.783651 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 15:36:00.783684 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 15:36:00.783720 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 15:36:00.783758 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 15:36:00.783797 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 15:36:00.783828 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 15:36:00.783855 49967 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 15:36:00.783877 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 15:36:00.783901 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 15:36:00.783955 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 15:36:00.783984 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 15:36:00.784018 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 15:36:00.784057 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 15:36:00.784086 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 15:36:00.784119 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 15:36:00.784153 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 15:36:00.784179 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 15:36:00.784214 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 15:36:00.784248 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 15:36:00.784276 49967 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 15:36:00.784298 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 15:36:00.784327 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 15:36:00.784387 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 15:36:00.784415 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 15:36:00.784444 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 15:36:00.784476 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 15:36:00.784509 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 15:36:00.784538 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 15:36:00.784567 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 15:36:00.784595 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 15:36:00.784627 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 15:36:00.784659 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 15:36:00.784684 49967 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 15:36:00.784708 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 15:36:00.784729 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 15:36:00.784788 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 15:36:00.784832 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 15:36:00.784862 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 15:36:00.784889 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 15:36:00.784919 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 15:36:00.784955 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 15:36:00.784981 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 15:36:00.785012 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 15:36:00.785039 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 15:36:00.785065 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 15:36:00.785092 49967 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 15:36:00.785115 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 15:36:00.785144 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 15:36:00.785192 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 15:36:00.785226 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 15:36:00.785254 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 15:36:00.785281 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 15:36:00.785312 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 15:36:00.785348 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 15:36:00.785378 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 15:36:00.785409 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 15:36:00.785437 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 15:36:00.785472 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 15:36:00.785499 49967 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 15:36:00.785521 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 15:36:00.785548 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 15:36:00.785598 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 15:36:00.785629 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 15:36:00.785660 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 15:36:00.785688 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 15:36:00.785727 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 15:36:00.785759 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 15:36:00.785796 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 15:36:00.785823 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 15:36:00.785856 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 15:36:00.785895 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 15:36:00.785923 49967 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 15:36:00.785946 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 15:36:00.785970 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 15:36:00.786022 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240206 15:36:00.786058 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240206 15:36:00.786088 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240206 15:36:00.786123 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240206 15:36:00.786155 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240206 15:36:00.786188 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240206 15:36:00.786218 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240206 15:36:00.786247 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240206 15:36:00.786278 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240206 15:36:00.786314 49967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240206 15:36:00.786341 49967 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240206 15:36:00.786365 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240206 15:36:00.786388 49967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240206 15:36:01.211030 49967 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240206 15:44:34.270202 49967 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302710,  4302736,    96648,  ..., 70240677, 48563542,  5165320]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2242.413 seconds
[Rank1] pid = 51081
[Rank2] pid = 51179
[Rank3] pid = 51246
[Rank4] pid = 51315
[Rank5] pid = 51382
[Rank6] pid = 51450
INFO [49967 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [51081 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [51179 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [51246 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [51315 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [51382 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [51519 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [51450 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [51315 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51519 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51382 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51450 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51179 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240206 15:53:10.770745 51316 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240206 15:53:10.773908 51180 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240206 15:53:10.774000 51520 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240206 15:53:10.774003 51383 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240206 15:53:10.774314 51451 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
INFO [51246 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49967 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51081 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240206 15:53:10.776651 51528 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240206 15:53:10.778020 51082 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240206 15:53:10.778672 51247 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240206 15:53:10.851119 51082 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1020497a9000 7.629 MB
W20240206 15:53:10.851218 51520 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x102049f4c000 7.629 MB
W20240206 15:53:10.851315 51528 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204a6ef000 7.629 MB
W20240206 15:53:10.851320 51180 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204ae92000 7.629 MB
W20240206 15:53:10.851368 51082 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10204b635000 7.629 MB
W20240206 15:53:10.851532 51082 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10204bdd8000 1.49 GB
W20240206 15:53:10.851534 51528 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020ab3bb000 7.629 MB
W20240206 15:53:10.851560 51180 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1020abb5e000 7.629 MB
W20240206 15:53:10.851569 51520 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1020ac301000 7.629 MB
W20240206 15:53:10.851608 51082 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1020acaa4000 1.49 GB
W20240206 15:53:10.851635 51528 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210c087000 1.49 GB
W20240206 15:53:10.851698 51180 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10216b66e000 1.49 GB
W20240206 15:53:10.851704 51520 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1021cac51000 1.49 GB
W20240206 15:53:10.851711 51528 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10222a234000 1.49 GB
W20240206 15:53:10.851734 51082 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 15:53:10.851778 51520 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x102289817000 1.49 GB
W20240206 15:53:10.851802 51528 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 15:53:10.851810 51180 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022e8dfa000 1.49 GB
W20240206 15:53:10.851843 51520 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240206 15:53:10.851876 51180 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 15:53:10.851881 51316 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1023483dd000 7.629 MB
W20240206 15:53:10.851928 51383 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102348b80000 7.629 MB
W20240206 15:53:10.852025 51316 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x102349323000 7.629 MB
W20240206 15:53:10.852088 51383 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102349ac6000 7.629 MB
W20240206 15:53:10.852154 51316 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10234a269000 1.49 GB
W20240206 15:53:10.852169 51383 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1023a984c000 1.49 GB
W20240206 15:53:10.852213 51316 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x102408e2f000 1.49 GB
W20240206 15:53:10.852237 51383 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x102468412000 1.49 GB
W20240206 15:53:10.852308 51316 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 15:53:10.852308 51383 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240206 15:53:10.870131 51082 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 15:53:10.870134 51528 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 15:53:10.870154 51180 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 15:53:10.870172 51316 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 15:53:10.870179 51520 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240206 15:53:10.877516 51383 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240206 15:53:10.888389 51451 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1024c7a0f000 7.629 MB
W20240206 15:53:10.888530 51451 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1024c81b2000 7.629 MB
W20240206 15:53:10.888603 51451 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1024c8955000 1.49 GB
W20240206 15:53:10.888669 51451 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x102527f38000 1.49 GB
W20240206 15:53:10.888738 51451 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240206 15:53:10.889549 51247 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10258751d000 7.629 MB
W20240206 15:53:10.889657 51247 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x102587cc0000 7.629 MB
W20240206 15:53:10.889729 51247 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102588463000 1.49 GB
W20240206 15:53:10.889791 51247 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1025e7a46000 1.49 GB
W20240206 15:53:10.889835 51247 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 15:53:10.894543 51451 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240206 15:53:10.895108 51247 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [51519 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [51382 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [51450 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [51246 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [51315 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
[Rank7] pid = 51519
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [51179 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [51081 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [49967 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 15:54:00.235589 51528 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240206 15:54:00.236141 51247 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 15:54:00.236246 51082 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 15:54:00.236362 51520 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 15:54:00.236462 51451 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 15:54:00.236532 51180 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 15:54:00.236748 51383 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 15:54:00.236855 51316 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240206 15:54:02.061280 51316 recstore.cc:66] init folly done
E20240206 15:54:02.061735 51520 recstore.cc:66] init folly done
E20240206 15:54:02.061848 51451 recstore.cc:66] init folly done
E20240206 15:54:02.061861 51180 recstore.cc:66] init folly done
E20240206 15:54:02.062081 51383 recstore.cc:66] init folly done
E20240206 15:54:02.062103 51528 recstore.cc:66] init folly done
E20240206 15:54:02.062105 51082 recstore.cc:66] init folly done
E20240206 15:54:02.062227 51247 recstore.cc:66] init folly done
I20240206 15:54:08.014794 51316 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240206 15:54:08.108527 51383 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 15:54:08.195055 51520 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 15:54:08.985071 51180 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 15:54:09.815500 51082 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 15:54:10.267045 51528 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 15:54:10.349982 51247 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 15:54:11.567664 51451 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.671 ms                 | 10.671 ms                 |
| Forward                   | 380.004 ms                | 380.004 ms                |
| back: bucket keys         | 570.891 us                | 21.366 ms                 |
| back: a2a                 | 54.249 ms                 | 1.462 s                   |
| back: cache               | 7.801 ms                  | 185.065 ms                |
| back: aggr dram keys      | 135.403 ms                | 1.101 s                   |
| back: set dram grad       | 5.169 ms                  | 30.907 ms                 |
| Backward                  | 3.199 s                   | 3.199 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.064 ms                  | 111.553 ms                |
| Forward                   | 5.049 ms                  | 380.004 ms                |
| back: bucket keys         | 667.079 us                | 21.366 ms                 |
| back: a2a                 | 27.766 ms                 | 1.462 s                   |
| back: cache               | 7.944 ms                  | 185.065 ms                |
| back: aggr dram keys      | 113.589 ms                | 1.101 s                   |
| back: set dram grad       | 9.778 ms                  | 41.020 ms                 |
| Backward                  | 436.348 ms                | 3.199 s                   |
| Optimize                  | 119.818 ms                | 162.447 ms                |
| BarrierTimeBeforeRank0    | 49.011 us                 | 64.504 us                 |
| BlockToStepN              | 70.386 us                 | 550.430 us                |
| OneStep                   | 564.398 ms                | 3.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.649 ms                  | 111.553 ms                |
| Forward                   | 5.205 ms                  | 380.004 ms                |
| back: bucket keys         | 733.866 us                | 21.366 ms                 |
| back: a2a                 | 27.561 ms                 | 1.462 s                   |
| back: cache               | 8.337 ms                  | 185.065 ms                |
| back: aggr dram keys      | 113.589 ms                | 1.101 s                   |
| back: set dram grad       | 9.778 ms                  | 41.020 ms                 |
| Backward                  | 420.938 ms                | 3.199 s                   |
| Optimize                  | 120.270 ms                | 162.447 ms                |
| BarrierTimeBeforeRank0    | 49.085 us                 | 95.041 us                 |
| BlockToStepN              | 55.456 us                 | 873.761 us                |
| OneStep                   | 540.995 ms                | 3.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.770 ms                  | 111.553 ms                |
| Forward                   | 5.174 ms                  | 380.004 ms                |
| back: bucket keys         | 733.866 us                | 1.967 ms                  |
| back: a2a                 | 27.209 ms                 | 63.297 ms                 |
| back: cache               | 8.337 ms                  | 150.448 ms                |
| back: aggr dram keys      | 113.589 ms                | 167.875 ms                |
| back: set dram grad       | 9.778 ms                  | 36.997 ms                 |
| Backward                  | 411.788 ms                | 3.199 s                   |
| Optimize                  | 120.270 ms                | 162.447 ms                |
| BarrierTimeBeforeRank0    | 47.964 us                 | 95.041 us                 |
| BlockToStepN              | 55.456 us                 | 17.112 ms                 |
| OneStep                   | 540.995 ms                | 3.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.707 ms                  | 111.553 ms                |
| Forward                   | 5.283 ms                  | 380.004 ms                |
| back: bucket keys         | 717.873 us                | 1.967 ms                  |
| back: a2a                 | 27.164 ms                 | 63.297 ms                 |
| back: cache               | 8.337 ms                  | 150.448 ms                |
| back: aggr dram keys      | 113.589 ms                | 167.875 ms                |
| back: set dram grad       | 9.778 ms                  | 36.997 ms                 |
| Backward                  | 405.820 ms                | 3.199 s                   |
| Optimize                  | 120.270 ms                | 162.447 ms                |
| BarrierTimeBeforeRank0    | 49.011 us                 | 133.755 us                |
| BlockToStepN              | 55.456 us                 | 17.112 ms                 |
| OneStep                   | 536.751 ms                | 3.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.266 ms                  | 111.553 ms                |
| Forward                   | 5.274 ms                  | 380.004 ms                |
| back: bucket keys         | 717.873 us                | 1.967 ms                  |
| back: a2a                 | 27.209 ms                 | 94.364 ms                 |
| back: cache               | 8.337 ms                  | 150.448 ms                |
| back: aggr dram keys      | 95.091 ms                 | 167.875 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 405.637 ms                | 3.199 s                   |
| Optimize                  | 120.205 ms                | 162.447 ms                |
| BarrierTimeBeforeRank0    | 47.964 us                 | 133.755 us                |
| BlockToStepN              | 55.560 us                 | 17.112 ms                 |
| OneStep                   | 535.356 ms                | 3.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.707 ms                  | 111.553 ms                |
| Forward                   | 5.219 ms                  | 10.047 ms                 |
| back: bucket keys         | 717.873 us                | 1.967 ms                  |
| back: a2a                 | 26.816 ms                 | 94.364 ms                 |
| back: cache               | 9.343 ms                  | 150.448 ms                |
| back: aggr dram keys      | 94.291 ms                 | 167.875 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 394.161 ms                | 497.672 ms                |
| Optimize                  | 120.205 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 47.337 us                 | 95.041 us                 |
| BlockToStepN              | 55.521 us                 | 15.892 ms                 |
| OneStep                   | 527.003 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.582 ms                  | 111.553 ms                |
| Forward                   | 5.219 ms                  | 10.047 ms                 |
| back: bucket keys         | 733.866 us                | 1.967 ms                  |
| back: a2a                 | 26.603 ms                 | 94.364 ms                 |
| back: cache               | 9.343 ms                  | 150.448 ms                |
| back: aggr dram keys      | 94.291 ms                 | 167.875 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 386.356 ms                | 497.672 ms                |
| Optimize                  | 120.162 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 46.222 us                 | 95.041 us                 |
| BlockToStepN              | 55.456 us                 | 17.112 ms                 |
| OneStep                   | 520.539 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.582 ms                  | 111.553 ms                |
| Forward                   | 5.214 ms                  | 10.047 ms                 |
| back: bucket keys         | 717.873 us                | 1.918 ms                  |
| back: a2a                 | 26.294 ms                 | 63.297 ms                 |
| back: cache               | 9.343 ms                  | 139.249 ms                |
| back: aggr dram keys      | 94.291 ms                 | 156.835 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 385.778 ms                | 497.672 ms                |
| Optimize                  | 120.162 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 44.717 us                 | 95.041 us                 |
| BlockToStepN              | 55.278 us                 | 17.112 ms                 |
| OneStep                   | 520.539 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.582 ms                  | 111.553 ms                |
| Forward                   | 5.228 ms                  | 10.047 ms                 |
| back: bucket keys         | 733.866 us                | 1.918 ms                  |
| back: a2a                 | 26.014 ms                 | 63.297 ms                 |
| back: cache               | 9.343 ms                  | 139.249 ms                |
| back: aggr dram keys      | 94.291 ms                 | 156.835 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 385.328 ms                | 497.672 ms                |
| Optimize                  | 120.205 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 44.131 us                 | 97.974 us                 |
| BlockToStepN              | 55.521 us                 | 17.112 ms                 |
| OneStep                   | 520.539 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.913 ms                  | 111.553 ms                |
| Forward                   | 5.219 ms                  | 10.047 ms                 |
| back: bucket keys         | 717.873 us                | 1.918 ms                  |
| back: a2a                 | 25.915 ms                 | 63.297 ms                 |
| back: cache               | 9.343 ms                  | 139.249 ms                |
| back: aggr dram keys      | 94.291 ms                 | 156.835 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 383.353 ms                | 497.672 ms                |
| Optimize                  | 120.490 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 43.748 us                 | 97.974 us                 |
| BlockToStepN              | 55.346 us                 | 17.112 ms                 |
| OneStep                   | 520.506 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 57.307, sample: 1.207, forward: 0.886, backward: 19.399, update: 0.327
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 56.772, sample: 1.324, forward: 0.899, backward: 18.849, update: 0.314
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 59.014, sample: 1.227, forward: 0.929, backward: 18.612, update: 0.331
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 58.137, sample: 1.402, forward: 0.919, backward: 18.796, update: 0.331
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 59.107, sample: 1.287, forward: 0.909, backward: 18.477, update: 0.319
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 55.555, sample: 1.438, forward: 0.945, backward: 18.509, update: 0.349
train_sampler.Prefill()
-------Step 0-------
tensor([   67032,    67067,    67093,    67139,  6072646,    83047, 50847457,
        16652554, 19762027,    67176]) tensor([ 5340124, 14668912, 51220922, 80399116, 18668328, 30282932, 30390632,
        81537435, 62729533, 31091419])
-------Step 1-------
tensor([   67032,    67067,    67093,    67139,  6072646,    83047, 50847457,
        16652554, 19762027,    67176]) tensor([61291335, 24387616, 10735061, 72492342, 75579937, 38612369, 80629576,
        54646854, 42202645, 12588069])
-------Step 2-------
tensor([  166432,   166468,   166496,    35273,   166525,   166564,   166604,
        23679449,   166661,   166690]) tensor([78758627, 22132074, 82097551, 41883287, 46432321, 26156962, 61546497,
        35994408, 15041119, 37862714])
-------Step 3-------
tensor([  166432,   166468,   166496,    35273,   166525,   166564,   166604,
        23679449,   166661,   166690]) tensor([55795493, 82821262, 30903732, 36188306, 72006980, 57322800, 32549430,
        15423254, 27800053,   773359])
-------Step 4-------
tensor([  265369, 40059506,   265420,   105605,   265448,   105625,   265488,
        37548020,   265533,   265562]) tensor([81321102,  9755244, 73940470, 16795304, 78933202, 48150293, 74739922,
        35598144, 75152839, 51472821])
-------Step 5-------
tensor([  265369, 40059506,   265420,   105605,   265448,   105625,   265488,
        37548020,   265533,   265562]) tensor([38964694, 69060364,   195444, 76893697, 52571432, 61816402, 15804550,
         9760826, 61253705, 45461344])
-------Step 6-------
tensor([  361886,    72581,   361927,   361962,    72622, 81162284,   362006,
          362027,   116761, 34720294]) tensor([12718967, 33413465, 31628666, 71409915, 36911749, 30426810, 22928977,
         6700927, 76492098, 73372130])
-------Step 7-------
tensor([  361886,    72581,   361927,   361962,    72622, 81162284,   362006,
          362027,   116761, 34720294]) tensor([22806113, 46723563, 63844334, 65991683, 68328216, 56515965, 47491609,
        64106704, 31506517, 35905970])
-------Step 8-------
tensor([  437432, 23860996,   437448,   127397,   437476,    90762,   437494,
          437510,   437528,   437551]) tensor([40291610, 23004180, 38448867,  2038946, 44160529, 75572422, 13434611,
        79553206,  1473838, 54402041])
-------Step 9-------
tensor([  437432, 23860996,   437448,   127397,   437476,    90762,   437494,
          437510,   437528,   437551]) tensor([60049833, 33551943, 13136646, 62313363,  9062907, 35609321, 24865309,
        34274493, 73590804, 60979873])
before start barrier
start train
[proc 0] 100 steps, total: 56.855, sample: 1.443, forward: 0.895, backward: 41.235, update: 11.793
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 58.927, sample: 1.362, forward: 0.964, backward: 18.901, update: 0.329
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.707 ms                  | 111.553 ms                |
| Forward                   | 5.183 ms                  | 10.047 ms                 |
| back: bucket keys         | 717.873 us                | 1.918 ms                  |
| back: a2a                 | 25.915 ms                 | 63.297 ms                 |
| back: cache               | 9.343 ms                  | 139.249 ms                |
| back: aggr dram keys      | 93.633 ms                 | 156.835 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 381.256 ms                | 497.672 ms                |
| Optimize                  | 120.490 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 43.748 us                 | 97.974 us                 |
| BlockToStepN              | 55.276 us                 | 17.112 ms                 |
| OneStep                   | 517.945 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.459 ms                  | 111.553 ms                |
| Forward                   | 5.183 ms                  | 10.047 ms                 |
| back: bucket keys         | 692.777 us                | 1.918 ms                  |
| back: a2a                 | 25.930 ms                 | 63.297 ms                 |
| back: cache               | 9.343 ms                  | 139.249 ms                |
| back: aggr dram keys      | 94.120 ms                 | 156.835 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 381.530 ms                | 497.672 ms                |
| Optimize                  | 120.270 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 42.705 us                 | 97.974 us                 |
| BlockToStepN              | 54.603 us                 | 17.112 ms                 |
| OneStep                   | 517.945 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.347 ms                  | 111.553 ms                |
| Forward                   | 5.183 ms                  | 12.585 ms                 |
| back: bucket keys         | 691.247 us                | 1.918 ms                  |
| back: a2a                 | 25.945 ms                 | 63.297 ms                 |
| back: cache               | 9.343 ms                  | 139.249 ms                |
| back: aggr dram keys      | 94.120 ms                 | 156.835 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 381.256 ms                | 497.672 ms                |
| Optimize                  | 120.433 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 41.838 us                 | 97.974 us                 |
| BlockToStepN              | 54.724 us                 | 17.112 ms                 |
| OneStep                   | 517.337 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.266 ms                  | 111.553 ms                |
| Forward                   | 5.183 ms                  | 12.585 ms                 |
| back: bucket keys         | 691.247 us                | 1.908 ms                  |
| back: a2a                 | 25.930 ms                 | 57.743 ms                 |
| back: cache               | 9.343 ms                  | 124.803 ms                |
| back: aggr dram keys      | 94.120 ms                 | 153.047 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 379.976 ms                | 497.672 ms                |
| Optimize                  | 120.162 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 41.117 us                 | 97.974 us                 |
| BlockToStepN              | 54.603 us                 | 17.112 ms                 |
| OneStep                   | 515.858 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.347 ms                  | 111.553 ms                |
| Forward                   | 5.174 ms                  | 12.585 ms                 |
| back: bucket keys         | 691.247 us                | 1.908 ms                  |
| back: a2a                 | 25.915 ms                 | 57.743 ms                 |
| back: cache               | 9.343 ms                  | 124.803 ms                |
| back: aggr dram keys      | 94.120 ms                 | 153.047 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 379.149 ms                | 497.672 ms                |
| Optimize                  | 119.976 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 40.499 us                 | 97.974 us                 |
| BlockToStepN              | 53.567 us                 | 17.112 ms                 |
| OneStep                   | 514.593 ms                | 669.331 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.459 ms                  | 105.717 ms                |
| Forward                   | 5.174 ms                  | 10.047 ms                 |
| back: bucket keys         | 691.247 us                | 1.908 ms                  |
| back: a2a                 | 25.983 ms                 | 57.743 ms                 |
| back: cache               | 9.343 ms                  | 124.803 ms                |
| back: aggr dram keys      | 94.120 ms                 | 153.047 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 379.976 ms                | 487.414 ms                |
| Optimize                  | 120.089 ms                | 149.035 ms                |
| BarrierTimeBeforeRank0    | 40.499 us                 | 95.041 us                 |
| BlockToStepN              | 53.519 us                 | 16.502 ms                 |
| OneStep                   | 514.593 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.127 ms                  | 105.717 ms                |
| Forward                   | 5.165 ms                  | 10.047 ms                 |
| back: bucket keys         | 692.777 us                | 1.908 ms                  |
| back: a2a                 | 26.025 ms                 | 63.297 ms                 |
| back: cache               | 9.343 ms                  | 124.803 ms                |
| back: aggr dram keys      | 94.216 ms                 | 153.047 ms                |
| back: set dram grad       | 9.778 ms                  | 51.281 ms                 |
| Backward                  | 381.255 ms                | 487.414 ms                |
| Optimize                  | 120.089 ms                | 149.035 ms                |
| BarrierTimeBeforeRank0    | 40.209 us                 | 95.041 us                 |
| BlockToStepN              | 54.050 us                 | 16.502 ms                 |
| OneStep                   | 515.858 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.254 ms                  | 105.717 ms                |
| Forward                   | 5.165 ms                  | 10.047 ms                 |
| back: bucket keys         | 692.777 us                | 1.908 ms                  |
| back: a2a                 | 26.016 ms                 | 63.297 ms                 |
| back: cache               | 9.343 ms                  | 124.803 ms                |
| back: aggr dram keys      | 94.216 ms                 | 153.047 ms                |
| back: set dram grad       | 9.778 ms                  | 51.281 ms                 |
| Backward                  | 379.976 ms                | 487.414 ms                |
| Optimize                  | 119.888 ms                | 149.035 ms                |
| BarrierTimeBeforeRank0    | 40.119 us                 | 95.041 us                 |
| BlockToStepN              | 54.561 us                 | 16.502 ms                 |
| OneStep                   | 514.593 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.266 ms                  | 105.717 ms                |
| Forward                   | 5.165 ms                  | 10.047 ms                 |
| back: bucket keys         | 692.777 us                | 1.907 ms                  |
| back: a2a                 | 25.983 ms                 | 57.743 ms                 |
| back: cache               | 9.343 ms                  | 124.567 ms                |
| back: aggr dram keys      | 94.216 ms                 | 150.991 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 376.401 ms                | 487.414 ms                |
| Optimize                  | 119.575 ms                | 149.035 ms                |
| BarrierTimeBeforeRank0    | 40.119 us                 | 95.041 us                 |
| BlockToStepN              | 54.050 us                 | 16.502 ms                 |
| OneStep                   | 512.718 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.054 ms                  | 105.717 ms                |
| Forward                   | 5.165 ms                  | 12.585 ms                 |
| back: bucket keys         | 692.777 us                | 1.907 ms                  |
| back: a2a                 | 25.905 ms                 | 57.743 ms                 |
| back: cache               | 27.829 ms                 | 124.567 ms                |
| back: aggr dram keys      | 94.216 ms                 | 150.991 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 375.131 ms                | 487.414 ms                |
| Optimize                  | 119.474 ms                | 149.035 ms                |
| BarrierTimeBeforeRank0    | 40.098 us                 | 95.041 us                 |
| BlockToStepN              | 54.050 us                 | 17.112 ms                 |
| OneStep                   | 511.551 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 50.864, sample: 1.406, forward: 0.538, backward: 37.036, update: 11.654
[proc 3] 200 steps, total: 50.864, sample: 1.150, forward: 0.489, backward: 16.150, update: 0.275
[proc 1] 200 steps, total: 50.864, sample: 1.181, forward: 0.533, backward: 16.472, update: 0.303
[proc 5] 200 steps, total: 50.864, sample: 1.186, forward: 0.551, backward: 15.799, update: 0.325
[proc 4] 200 steps, total: 50.864, sample: 1.236, forward: 0.524, backward: 15.736, update: 0.290
[proc 7] 200 steps, total: 50.864, sample: 1.501, forward: 0.500, backward: 15.962, update: 0.294
[proc 6] 200 steps, total: 50.864, sample: 1.374, forward: 0.567, backward: 15.701, update: 0.290
[proc 2] 200 steps, total: 50.864, sample: 1.310, forward: 0.506, backward: 16.137, update: 0.331
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.948 ms                  | 105.717 ms                |
| Forward                   | 5.155 ms                  | 12.585 ms                 |
| back: bucket keys         | 717.873 us                | 1.907 ms                  |
| back: a2a                 | 25.734 ms                 | 57.743 ms                 |
| back: cache               | 27.829 ms                 | 124.567 ms                |
| back: aggr dram keys      | 94.216 ms                 | 150.991 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 374.408 ms                | 487.414 ms                |
| Optimize                  | 119.474 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 39.983 us                 | 95.041 us                 |
| BlockToStepN              | 54.561 us                 | 17.112 ms                 |
| OneStep                   | 507.952 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.948 ms                  | 105.717 ms                |
| Forward                   | 5.155 ms                  | 12.585 ms                 |
| back: bucket keys         | 717.873 us                | 1.907 ms                  |
| back: a2a                 | 25.519 ms                 | 57.743 ms                 |
| back: cache               | 27.829 ms                 | 124.567 ms                |
| back: aggr dram keys      | 94.216 ms                 | 150.991 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 370.276 ms                | 487.414 ms                |
| Optimize                  | 119.474 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 39.967 us                 | 95.041 us                 |
| BlockToStepN              | 54.246 us                 | 17.112 ms                 |
| OneStep                   | 506.817 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.948 ms                  | 105.717 ms                |
| Forward                   | 5.153 ms                  | 12.585 ms                 |
| back: bucket keys         | 717.873 us                | 1.906 ms                  |
| back: a2a                 | 24.915 ms                 | 57.635 ms                 |
| back: cache               | 27.829 ms                 | 123.913 ms                |
| back: aggr dram keys      | 94.216 ms                 | 149.378 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 368.561 ms                | 487.414 ms                |
| Optimize                  | 119.504 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 39.967 us                 | 95.041 us                 |
| BlockToStepN              | 53.790 us                 | 17.112 ms                 |
| OneStep                   | 504.062 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.610 ms                  | 105.717 ms                |
| Forward                   | 5.151 ms                  | 12.585 ms                 |
| back: bucket keys         | 692.777 us                | 1.906 ms                  |
| back: a2a                 | 23.658 ms                 | 63.297 ms                 |
| back: cache               | 27.829 ms                 | 123.913 ms                |
| back: aggr dram keys      | 94.216 ms                 | 149.378 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 367.925 ms                | 487.414 ms                |
| Optimize                  | 119.575 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 39.970 us                 | 95.041 us                 |
| BlockToStepN              | 54.044 us                 | 17.112 ms                 |
| OneStep                   | 503.631 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.539 ms                  | 105.717 ms                |
| Forward                   | 5.153 ms                  | 12.585 ms                 |
| back: bucket keys         | 717.873 us                | 1.906 ms                  |
| back: a2a                 | 22.420 ms                 | 63.297 ms                 |
| back: cache               | 27.829 ms                 | 123.913 ms                |
| back: aggr dram keys      | 94.291 ms                 | 149.378 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 366.140 ms                | 487.414 ms                |
| Optimize                  | 119.888 ms                | 149.491 ms                |
| BarrierTimeBeforeRank0    | 39.983 us                 | 95.041 us                 |
| BlockToStepN              | 54.561 us                 | 17.112 ms                 |
| OneStep                   | 501.010 ms                | 660.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.525 ms                  | 105.524 ms                |
| Forward                   | 5.151 ms                  | 10.498 ms                 |
| back: bucket keys         | 692.777 us                | 1.906 ms                  |
| back: a2a                 | 21.607 ms                 | 63.297 ms                 |
| back: cache               | 27.829 ms                 | 123.913 ms                |
| back: aggr dram keys      | 94.291 ms                 | 149.378 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 364.459 ms                | 478.111 ms                |
| Optimize                  | 119.888 ms                | 149.035 ms                |
| BarrierTimeBeforeRank0    | 39.975 us                 | 91.316 us                 |
| BlockToStepN              | 54.561 us                 | 16.955 ms                 |
| OneStep                   | 499.924 ms                | 657.818 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.539 ms                  | 105.717 ms                |
| Forward                   | 5.151 ms                  | 10.498 ms                 |
| back: bucket keys         | 692.777 us                | 1.906 ms                  |
| back: a2a                 | 20.930 ms                 | 63.297 ms                 |
| back: cache               | 25.890 ms                 | 123.913 ms                |
| back: aggr dram keys      | 94.291 ms                 | 149.378 ms                |
| back: set dram grad       | 9.778 ms                  | 43.920 ms                 |
| Backward                  | 362.552 ms                | 478.111 ms                |
| Optimize                  | 119.943 ms                | 149.035 ms                |
| BarrierTimeBeforeRank0    | 39.975 us                 | 91.316 us                 |
| BlockToStepN              | 54.158 us                 | 16.955 ms                 |
| OneStep                   | 497.365 ms                | 657.818 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.500 ms                  | 105.717 ms                |
| Forward                   | 5.131 ms                  | 10.498 ms                 |
| back: bucket keys         | 717.873 us                | 1.906 ms                  |
| back: a2a                 | 20.544 ms                 | 63.297 ms                 |
| back: cache               | 25.890 ms                 | 123.074 ms                |
| back: aggr dram keys      | 95.091 ms                 | 148.520 ms                |
| back: set dram grad       | 9.778 ms                  | 49.754 ms                 |
| Backward                  | 361.681 ms                | 478.111 ms                |
| Optimize                  | 119.888 ms                | 149.035 ms                |
| BarrierTimeBeforeRank0    | 39.944 us                 | 91.316 us                 |
| BlockToStepN              | 54.158 us                 | 16.955 ms                 |
| OneStep                   | 495.041 ms                | 657.818 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.283 ms                  | 105.717 ms                |
| Forward                   | 5.153 ms                  | 10.498 ms                 |
| back: bucket keys         | 717.873 us                | 1.906 ms                  |
| back: a2a                 | 20.315 ms                 | 63.297 ms                 |
| back: cache               | 25.890 ms                 | 123.074 ms                |
| back: aggr dram keys      | 95.091 ms                 | 148.520 ms                |
| back: set dram grad       | 9.778 ms                  | 51.281 ms                 |
| Backward                  | 359.769 ms                | 478.111 ms                |
| Optimize                  | 119.822 ms                | 149.035 ms                |
| BarrierTimeBeforeRank0    | 39.944 us                 | 91.316 us                 |
| BlockToStepN              | 54.603 us                 | 16.955 ms                 |
| OneStep                   | 492.858 ms                | 657.818 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 300 steps, total: 44.692, sample: 1.056, forward: 0.537, backward: 14.879, update: 0.395
[proc 1] 300 steps, total: 44.692, sample: 1.108, forward: 0.517, backward: 15.213, update: 0.389
[proc 0] 300 steps, total: 44.692, sample: 1.251, forward: 0.519, backward: 31.035, update: 11.692
[proc 3] 300 steps, total: 44.692, sample: 1.107, forward: 0.533, backward: 14.859, update: 0.391
[proc 4] 300 steps, total: 44.692, sample: 1.090, forward: 0.523, backward: 14.750, update: 0.404
[proc 2] 300 steps, total: 44.692, sample: 1.125, forward: 0.594, backward: 14.885, update: 0.416
[proc 7] 300 steps, total: 44.692, sample: 1.131, forward: 0.503, backward: 14.737, update: 0.399
Successfully xmh. training takes 152.41194701194763 seconds
[proc 6] 300 steps, total: 44.692, sample: 1.218, forward: 0.522, backward: 14.604, update: 0.402
before call kg_cache_controller.StopThreads()
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
INFO [49967 controller_process.py:421] call rank0 to StopThreads
