WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 21:42:03.719399 19878 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_43', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=5, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=5, gpu=[0, 1, 2, 3, 4], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [19878 sampler.py:454] Start PreSampling
WARNING [19878 sampler.py:532] Before construct renumbering_dict
WARNING [19878 sampler.py:555] PreSampling done
W20240205 21:42:08.381330 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 21:42:08.381531 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 21:42:08.381569 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 21:42:08.381601 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 21:42:08.381639 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 21:42:08.381662 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 21:42:08.381687 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 21:42:08.381718 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 21:42:08.381742 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 21:42:08.381772 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 21:42:08.381812 19878 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 21:42:08.381837 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 21:42:08.381865 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 21:42:08.382001 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 21:42:08.382040 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 21:42:08.382068 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 21:42:08.382110 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 21:42:08.382133 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 21:42:08.382161 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 21:42:08.382190 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 21:42:08.382225 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 21:42:08.382252 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 21:42:08.382273 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 21:42:08.382309 19878 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 21:42:08.382328 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 21:42:08.382355 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 21:42:08.382405 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 21:42:08.382431 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 21:42:08.382452 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 21:42:08.382474 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 21:42:08.382504 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 21:42:08.382531 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 21:42:08.382566 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 21:42:08.382596 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 21:42:08.382623 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 21:42:08.382649 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 21:42:08.382673 19878 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 21:42:08.382692 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 21:42:08.382712 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 21:42:08.382758 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 21:42:08.382787 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 21:42:08.382809 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 21:42:08.382839 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 21:42:08.382864 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 21:42:08.382886 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 21:42:08.382921 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 21:42:08.382942 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 21:42:08.382972 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 21:42:08.382999 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 21:42:08.383028 19878 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 21:42:08.383046 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 21:42:08.383077 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 21:42:08.383137 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 21:42:08.383174 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 21:42:08.383195 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 21:42:08.383234 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 21:42:08.383266 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 21:42:08.383289 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 21:42:08.383317 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 21:42:08.383338 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 21:42:08.383378 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 21:42:08.383404 19878 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 21:42:08.383424 19878 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 21:42:08.383442 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 21:42:08.383469 19878 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 21:42:08.613384 19878 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100017df6000 22.81 MB
W20240205 21:42:08.643478 19878 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000194c8000 58.4 kB
{0: Graph(num_nodes=10222, num_edges=137205,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=7861, num_edges=113516,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10587, num_edges=145765,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9264, num_edges=181068,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10248, num_edges=191956,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10222 N 137205 E
MertisPartition: part 1 has 7861 N 113516 E
MertisPartition: part 2 has 10587 N 145765 E
MertisPartition: part 3 has 9264 N 181068 E
MertisPartition: part 4 has 10248 N 191956 E
Rank0: cached key size 149
Rank1: cached key size 149
Rank2: cached key size 149
Rank3: cached key size 149
Rank4: cached key size 149
Before renumbering graph:  {'_ID': tensor([    7,    16,    18,  ..., 13890,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([ 1004,  1298,  1381,  ..., 12114,  1788,  7986]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=10222, num_edges=137205,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10222, num_edges=137205,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 4.958 seconds
[Rank1] pid = 20082
[Rank2] pid = 20147
[Rank3] pid = 20211
INFO [19878 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [20147 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [20082 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [20211 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [20275 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [20082 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [20211 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [20275 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [19878 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
W20240205 21:42:10.743539 20276 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
INFO [20147 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
W20240205 21:42:10.744719 20083 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240205 21:42:10.744798 20212 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240205 21:42:10.744804 20294 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240205 21:42:10.747059 20148 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240205 21:42:10.781157 20294 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1000194e2000 7.629 MB
W20240205 21:42:10.781253 20083 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100019c85000 7.629 MB
W20240205 21:42:10.781261 20276 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10001a428000 7.629 MB
W20240205 21:42:10.781286 20212 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10001abcb000 7.629 MB
W20240205 21:42:10.781296 20148 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10001b36e000 7.629 MB
W20240205 21:42:10.781422 20294 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10001bb11000 7.629 MB
W20240205 21:42:10.781479 20148 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10001c2b4000 7.629 MB
W20240205 21:42:10.781499 20212 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10001ca57000 7.629 MB
W20240205 21:42:10.781504 20294 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10001d1fa000 1.49 GB
W20240205 21:42:10.781543 20276 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10007c7dd000 7.629 MB
W20240205 21:42:10.781584 20294 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10007cf80000 1.49 GB
W20240205 21:42:10.781594 20083 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000dc563000 7.629 MB
W20240205 21:42:10.781600 20148 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1000dcd06000 1.49 GB
W20240205 21:42:10.781607 20276 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10013c2e9000 1.49 GB
W20240205 21:42:10.781615 20212 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10019b8cc000 1.49 GB
W20240205 21:42:10.781659 20294 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 21:42:10.781669 20276 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1001faeaf000 1.49 GB
W20240205 21:42:10.781689 20212 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10025a492000 1.49 GB
W20240205 21:42:10.781715 20083 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1002b9a75000 1.49 GB
W20240205 21:42:10.781734 20148 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x100319058000 1.49 GB
W20240205 21:42:10.781735 20276 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 21:42:10.781752 20212 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 21:42:10.781781 20083 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10037863b000 1.49 GB
W20240205 21:42:10.781795 20148 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 21:42:10.781829 20083 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 21:42:10.790354 20276 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 21:42:10.790355 20148 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 21:42:10.790364 20212 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 21:42:10.790366 20083 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 21:42:10.790376 20294 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
cudaHostRegister 0x100017df6000
3: KnownLocalCachedEmbedding init done
WARNING [20211 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
2: KnownLocalCachedEmbedding init done
WARNING [20147 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
1: KnownLocalCachedEmbedding init done
WARNING [20082 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
4: KnownLocalCachedEmbedding init done
WARNING [20275 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank4] pid = 20275
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735)]
cudaHostRegister 0x100017df6000
0: KnownLocalCachedEmbedding init done
WARNING [19878 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 21:42:13.546427 20276 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 5
I20240205 21:42:13.546550 20083 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240205 21:42:13.546635 20148 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240205 21:42:13.546818 20212 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240205 21:42:13.547361 20294 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
E20240205 21:42:14.081985 20294 recstore.cc:66] init folly done
E20240205 21:42:14.082031 20148 recstore.cc:66] init folly done
E20240205 21:42:14.083698 20276 recstore.cc:66] init folly done
E20240205 21:42:14.084141 20212 recstore.cc:66] init folly done
E20240205 21:42:14.084107 20083 recstore.cc:66] init folly done
I20240205 21:42:14.172583 20083 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 5
I20240205 21:42:14.177127 20148 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240205 21:42:14.179044 20276 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240205 21:42:14.183686 20212 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240205 21:42:14.195052 20294 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.813 ms                  | 26.913 ms                 |
| Forward                   | 5.934 ms                  | 421.212 ms                |
| back: bucket keys         | 456.727 us                | 20.944 ms                 |
| back: a2a                 | 7.557 ms                  | 993.323 ms                |
| back: cache               | 3.752 ms                  | 9.031 ms                  |
| back: aggr dram keys      | 39.012 ms                 | 573.234 ms                |
| back: set dram grad       | 2.790 ms                  | 9.696 ms                  |
| Backward                  | 123.103 ms                | 1.884 s                   |
| Optimize                  | 32.066 ms                 | 72.498 ms                 |
| BarrierTimeBeforeRank0    | 55.302 us                 | 103.799 us                |
| BlockToStepN              | 24.183 us                 | 431.408 us                |
| OneStep                   | 161.213 ms                | 2.381 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.599 ms                  | 29.099 ms                 |
| Forward                   | 5.537 ms                  | 421.212 ms                |
| back: bucket keys         | 600.872 us                | 1.255 ms                  |
| back: a2a                 | 8.346 ms                  | 16.911 ms                 |
| back: cache               | 4.060 ms                  | 11.092 ms                 |
| back: aggr dram keys      | 38.848 ms                 | 61.215 ms                 |
| back: set dram grad       | 2.682 ms                  | 9.401 ms                  |
| Backward                  | 123.103 ms                | 1.884 s                   |
| Optimize                  | 31.042 ms                 | 72.498 ms                 |
| BarrierTimeBeforeRank0    | 53.958 us                 | 103.799 us                |
| BlockToStepN              | 30.633 us                 | 431.408 us                |
| OneStep                   | 163.045 ms                | 2.381 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.621 ms                  | 26.913 ms                 |
| Forward                   | 5.586 ms                  | 8.037 ms                  |
| back: bucket keys         | 456.727 us                | 1.255 ms                  |
| back: a2a                 | 8.239 ms                  | 16.911 ms                 |
| back: cache               | 3.941 ms                  | 11.092 ms                 |
| back: aggr dram keys      | 39.012 ms                 | 61.215 ms                 |
| back: set dram grad       | 2.681 ms                  | 9.401 ms                  |
| Backward                  | 121.275 ms                | 140.681 ms                |
| Optimize                  | 30.109 ms                 | 52.339 ms                 |
| BarrierTimeBeforeRank0    | 51.207 us                 | 99.633 us                 |
| BlockToStepN              | 22.883 us                 | 285.436 us                |
| OneStep                   | 161.213 ms                | 210.645 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 18.603, sample: 0.405, forward: 0.931, backward: 10.512, update: 0.478
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 18.626, sample: 0.392, forward: 0.951, backward: 10.515, update: 0.520
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 18.621, sample: 0.401, forward: 0.887, backward: 10.589, update: 0.495
train_sampler.Prefill()
-------Step 0-------
tensor([13406,    77, 12207, 13018,    65,    25, 10618, 13239,  3176, 11387]) tensor([ 1381,  1728,   108,  2911,  4283, 11963,   451,  3004,  4727, 14423])
-------Step 1-------
tensor([13406,    77, 12207, 13018,    65,    25, 10618, 13239,  3176, 11387]) tensor([  188, 10412,  3428, 12249, 13566, 11968,  3666,  7782,  9779,  4396])
-------Step 2-------
tensor([  141, 12945,  9191, 14580,  7406, 14154, 14064, 10860,  4667,    69]) tensor([ 8665,  4911,  6871, 14282,  6951,  1130,  2244,   715,  9204,  1606])
-------Step 3-------
tensor([  141, 12945,  9191, 14580,  7406, 14154, 14064, 10860,  4667,    69]) tensor([14351,  2571,  6443,  7538, 13643,   403, 10582, 13862,   361,  2186])
-------Step 4-------
tensor([ 7750,  9377, 12494, 11183,  1915,  6680,  7644,  4573,  6793,  1947]) tensor([  472,  2953,  1003,  5102,  7085, 12167, 13807, 12079,  7804,   489])
-------Step 5-------
tensor([ 7750,  9377, 12494, 11183,  1915,  6680,  7644,  4573,  6793,  1947]) tensor([10739, 13801,  6434,  7609,  4554,  1109,  3707,  5261,  4605, 13006])
-------Step 6-------
tensor([  872,   305,  8468,  2613,   143, 13647, 14580,    71,   777, 10906]) tensor([14861, 12009, 14067,  8182,  8504,  2191,  3185, 14150, 14152,  6638])
-------Step 7-------
tensor([  872,   305,  8468,  2613,   143, 13647, 14580,    71,   777, 10906]) tensor([ 4838,  9905,  4086, 13159,   274, 11580, 11389, 14220,  6420, 10890])
-------Step 8-------
tensor([ 9195,  9681,   815,  8117,  3853,    98, 12517,  6506,  4225,  2985]) tensor([ 1338,   892,  5431, 11797,  6225, 13998,  7310, 13513, 14715,   966])
-------Step 9-------
tensor([ 9195,  9681,   815,  8117,  3853,    98, 12517,  6506,  4225,  2985]) tensor([ 8337,  3100, 14283,  6006, 14063, 10678,  4229, 13474,  7527,   629])
before start barrier
start train
[proc 0] 100 steps, total: 18.619, sample: 0.437, forward: 0.967, backward: 13.885, update: 3.213
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 18.615, sample: 0.390, forward: 0.894, backward: 10.605, update: 0.461
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.615 ms                  | 26.913 ms                 |
| Forward                   | 5.591 ms                  | 8.037 ms                  |
| back: bucket keys         | 556.072 us                | 1.458 ms                  |
| back: a2a                 | 8.289 ms                  | 15.289 ms                 |
| back: cache               | 3.951 ms                  | 9.876 ms                  |
| back: aggr dram keys      | 39.521 ms                 | 60.920 ms                 |
| back: set dram grad       | 2.786 ms                  | 9.696 ms                  |
| Backward                  | 122.087 ms                | 143.748 ms                |
| Optimize                  | 30.562 ms                 | 52.339 ms                 |
| BarrierTimeBeforeRank0    | 49.582 us                 | 99.633 us                 |
| BlockToStepN              | 21.273 us                 | 339.442 us                |
| OneStep                   | 162.523 ms                | 210.645 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.576 ms                  | 29.099 ms                 |
| Forward                   | 5.591 ms                  | 8.037 ms                  |
| back: bucket keys         | 461.480 us                | 1.279 ms                  |
| back: a2a                 | 8.213 ms                  | 23.469 ms                 |
| back: cache               | 3.936 ms                  | 9.425 ms                  |
| back: aggr dram keys      | 39.135 ms                 | 52.977 ms                 |
| back: set dram grad       | 2.681 ms                  | 11.077 ms                 |
| Backward                  | 121.586 ms                | 151.055 ms                |
| Optimize                  | 31.042 ms                 | 52.339 ms                 |
| BarrierTimeBeforeRank0    | 48.931 us                 | 99.633 us                 |
| BlockToStepN              | 20.627 us                 | 339.442 us                |
| OneStep                   | 161.734 ms                | 210.645 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.576 ms                  | 28.660 ms                 |
| Forward                   | 5.591 ms                  | 7.562 ms                  |
| back: bucket keys         | 525.217 us                | 1.279 ms                  |
| back: a2a                 | 8.182 ms                  | 31.940 ms                 |
| back: cache               | 3.849 ms                  | 9.425 ms                  |
| back: aggr dram keys      | 38.395 ms                 | 52.977 ms                 |
| back: set dram grad       | 2.614 ms                  | 11.077 ms                 |
| Backward                  | 120.375 ms                | 151.055 ms                |
| Optimize                  | 30.735 ms                 | 49.469 ms                 |
| BarrierTimeBeforeRank0    | 48.792 us                 | 98.842 us                 |
| BlockToStepN              | 20.472 us                 | 306.311 us                |
| OneStep                   | 159.774 ms                | 207.209 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.573 ms                  | 28.660 ms                 |
| Forward                   | 5.586 ms                  | 7.562 ms                  |
| back: bucket keys         | 461.580 us                | 1.255 ms                  |
| back: a2a                 | 8.213 ms                  | 37.173 ms                 |
| back: cache               | 3.836 ms                  | 9.296 ms                  |
| back: aggr dram keys      | 38.031 ms                 | 52.977 ms                 |
| back: set dram grad       | 2.569 ms                  | 9.696 ms                  |
| Backward                  | 120.124 ms                | 155.463 ms                |
| Optimize                  | 30.735 ms                 | 49.469 ms                 |
| BarrierTimeBeforeRank0    | 47.981 us                 | 98.842 us                 |
| BlockToStepN              | 20.472 us                 | 306.311 us                |
| OneStep                   | 159.580 ms                | 207.209 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 15.847, sample: 0.428, forward: 0.502, backward: 8.912, update: 0.441
[proc 4] 200 steps, total: 15.847, sample: 0.440, forward: 0.461, backward: 8.908, update: 0.447
[proc 3] 200 steps, total: 15.847, sample: 0.393, forward: 0.496, backward: 8.925, update: 0.410
[proc 0] 200 steps, total: 15.847, sample: 0.448, forward: 0.535, backward: 11.686, update: 3.083
[proc 1] 200 steps, total: 15.847, sample: 0.441, forward: 0.503, backward: 8.871, update: 0.474
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.558 ms                  | 28.660 ms                 |
| Forward                   | 5.576 ms                  | 7.562 ms                  |
| back: bucket keys         | 461.580 us                | 1.218 ms                  |
| back: a2a                 | 8.213 ms                  | 35.264 ms                 |
| back: cache               | 3.838 ms                  | 9.296 ms                  |
| back: aggr dram keys      | 38.106 ms                 | 52.977 ms                 |
| back: set dram grad       | 2.576 ms                  | 9.401 ms                  |
| Backward                  | 120.375 ms                | 155.869 ms                |
| Optimize                  | 30.793 ms                 | 49.469 ms                 |
| BarrierTimeBeforeRank0    | 47.981 us                 | 99.033 us                 |
| BlockToStepN              | 20.485 us                 | 306.311 us                |
| OneStep                   | 160.620 ms                | 207.418 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.573 ms                  | 26.913 ms                 |
| Forward                   | 5.548 ms                  | 7.141 ms                  |
| back: bucket keys         | 461.580 us                | 1.218 ms                  |
| back: a2a                 | 8.213 ms                  | 35.624 ms                 |
| back: cache               | 3.805 ms                  | 9.425 ms                  |
| back: aggr dram keys      | 37.748 ms                 | 52.977 ms                 |
| back: set dram grad       | 2.577 ms                  | 9.401 ms                  |
| Backward                  | 120.622 ms                | 155.463 ms                |
| Optimize                  | 30.562 ms                 | 47.714 ms                 |
| BarrierTimeBeforeRank0    | 48.135 us                 | 98.842 us                 |
| BlockToStepN              | 20.474 us                 | 285.436 us                |
| OneStep                   | 160.906 ms                | 207.209 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.573 ms                  | 28.660 ms                 |
| Forward                   | 5.546 ms                  | 7.562 ms                  |
| back: bucket keys         | 461.580 us                | 1.214 ms                  |
| back: a2a                 | 8.213 ms                  | 35.264 ms                 |
| back: cache               | 3.789 ms                  | 9.296 ms                  |
| back: aggr dram keys      | 37.701 ms                 | 52.295 ms                 |
| back: set dram grad       | 2.571 ms                  | 9.184 ms                  |
| Backward                  | 120.786 ms                | 155.463 ms                |
| Optimize                  | 30.743 ms                 | 47.714 ms                 |
| BarrierTimeBeforeRank0    | 48.154 us                 | 99.033 us                 |
| BlockToStepN              | 20.733 us                 | 285.436 us                |
| OneStep                   | 161.365 ms                | 207.209 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 16.439, sample: 0.388, forward: 0.497, backward: 9.197, update: 0.436
[proc 4] 300 steps, total: 16.439, sample: 0.379, forward: 0.461, backward: 9.247, update: 0.470
[proc 3] 300 steps, total: 16.439, sample: 0.431, forward: 0.490, backward: 9.168, update: 0.409
[proc 0] 300 steps, total: 16.438, sample: 0.457, forward: 0.530, backward: 12.227, update: 3.126
[proc 1] 300 steps, total: 16.438, sample: 0.383, forward: 0.498, backward: 9.210, update: 0.455
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.558 ms                  | 28.660 ms                 |
| Forward                   | 5.546 ms                  | 7.562 ms                  |
| back: bucket keys         | 461.580 us                | 1.218 ms                  |
| back: a2a                 | 8.182 ms                  | 35.264 ms                 |
| back: cache               | 3.786 ms                  | 9.296 ms                  |
| back: aggr dram keys      | 37.628 ms                 | 52.295 ms                 |
| back: set dram grad       | 2.571 ms                  | 9.401 ms                  |
| Backward                  | 120.628 ms                | 155.463 ms                |
| Optimize                  | 30.735 ms                 | 49.453 ms                 |
| BarrierTimeBeforeRank0    | 47.979 us                 | 99.033 us                 |
| BlockToStepN              | 20.805 us                 | 285.436 us                |
| OneStep                   | 160.901 ms                | 207.209 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.558 ms                  | 28.212 ms                 |
| Forward                   | 5.542 ms                  | 7.248 ms                  |
| back: bucket keys         | 461.480 us                | 1.214 ms                  |
| back: a2a                 | 8.029 ms                  | 35.624 ms                 |
| back: cache               | 3.787 ms                  | 9.031 ms                  |
| back: aggr dram keys      | 37.609 ms                 | 52.295 ms                 |
| back: set dram grad       | 2.571 ms                  | 9.401 ms                  |
| Backward                  | 120.680 ms                | 155.463 ms                |
| Optimize                  | 30.815 ms                 | 47.714 ms                 |
| BarrierTimeBeforeRank0    | 47.953 us                 | 98.842 us                 |
| BlockToStepN              | 20.925 us                 | 177.037 us                |
| OneStep                   | 160.906 ms                | 206.189 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.546 ms                  | 28.212 ms                 |
| Forward                   | 5.525 ms                  | 7.248 ms                  |
| back: bucket keys         | 442.236 us                | 1.214 ms                  |
| back: a2a                 | 7.652 ms                  | 35.624 ms                 |
| back: cache               | 3.781 ms                  | 8.968 ms                  |
| back: aggr dram keys      | 37.519 ms                 | 52.099 ms                 |
| back: set dram grad       | 2.561 ms                  | 9.184 ms                  |
| Backward                  | 120.424 ms                | 155.463 ms                |
| Optimize                  | 30.994 ms                 | 47.714 ms                 |
| BarrierTimeBeforeRank0    | 47.953 us                 | 98.842 us                 |
| BlockToStepN              | 20.965 us                 | 285.436 us                |
| OneStep                   | 160.906 ms                | 206.189 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 16.242, sample: 0.395, forward: 0.485, backward: 8.906, update: 0.364
[proc 4] 400 steps, total: 16.242, sample: 0.388, forward: 0.454, backward: 8.938, update: 0.472
[proc 1] 400 steps, total: 16.242, sample: 0.373, forward: 0.492, backward: 8.934, update: 0.476
[proc 2] 400 steps, total: 16.242, sample: 0.368, forward: 0.497, backward: 8.877, update: 0.416
[proc 0] 400 steps, total: 16.242, sample: 0.458, forward: 0.533, backward: 11.821, update: 3.323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.530 ms                  | 28.474 ms                 |
| Forward                   | 5.504 ms                  | 7.248 ms                  |
| back: bucket keys         | 442.236 us                | 1.214 ms                  |
| back: a2a                 | 7.639 ms                  | 35.624 ms                 |
| back: cache               | 3.779 ms                  | 9.031 ms                  |
| back: aggr dram keys      | 37.590 ms                 | 52.295 ms                 |
| back: set dram grad       | 2.566 ms                  | 9.401 ms                  |
| Backward                  | 120.589 ms                | 155.463 ms                |
| Optimize                  | 31.189 ms                 | 47.714 ms                 |
| BarrierTimeBeforeRank0    | 47.974 us                 | 98.842 us                 |
| BlockToStepN              | 20.942 us                 | 285.436 us                |
| OneStep                   | 161.365 ms                | 206.189 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.552 ms                  | 28.474 ms                 |
| Forward                   | 5.495 ms                  | 7.248 ms                  |
| back: bucket keys         | 456.727 us                | 1.216 ms                  |
| back: a2a                 | 7.639 ms                  | 35.624 ms                 |
| back: cache               | 3.772 ms                  | 9.031 ms                  |
| back: aggr dram keys      | 37.660 ms                 | 52.295 ms                 |
| back: set dram grad       | 2.571 ms                  | 9.401 ms                  |
| Backward                  | 120.786 ms                | 155.463 ms                |
| Optimize                  | 31.478 ms                 | 47.714 ms                 |
| BarrierTimeBeforeRank0    | 47.979 us                 | 98.842 us                 |
| BlockToStepN              | 20.925 us                 | 285.436 us                |
| OneStep                   | 162.339 ms                | 206.189 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.552 ms                  | 28.212 ms                 |
| Forward                   | 5.487 ms                  | 7.141 ms                  |
| back: bucket keys         | 442.236 us                | 1.216 ms                  |
| back: a2a                 | 7.639 ms                  | 35.624 ms                 |
| back: cache               | 3.776 ms                  | 9.125 ms                  |
| back: aggr dram keys      | 37.725 ms                 | 52.483 ms                 |
| back: set dram grad       | 2.577 ms                  | 9.696 ms                  |
| Backward                  | 120.920 ms                | 155.356 ms                |
| Optimize                  | 31.485 ms                 | 47.336 ms                 |
| BarrierTimeBeforeRank0    | 47.959 us                 | 96.124 us                 |
| BlockToStepN              | 20.905 us                 | 177.037 us                |
| OneStep                   | 162.826 ms                | 205.085 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 16.812, sample: 0.380, forward: 0.497, backward: 9.206, update: 0.428
[proc 4] 500 steps, total: 16.812, sample: 0.414, forward: 0.450, backward: 9.218, update: 0.454
[proc 3] 500 steps, total: 16.812, sample: 0.374, forward: 0.491, backward: 9.218, update: 0.402
[proc 1] 500 steps, total: 16.812, sample: 0.373, forward: 0.495, backward: 9.221, update: 0.489
[proc 0] 500 steps, total: 16.812, sample: 0.414, forward: 0.534, backward: 12.454, update: 3.303
Successfully xmh. training takes 83.95940136909485 seconds
before call kg_cache_controller.StopThreads()
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
INFO [19878 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.557 ms                  | 28.212 ms                 |
| Forward                   | 5.492 ms                  | 7.141 ms                  |
| back: bucket keys         | 456.727 us                | 1.214 ms                  |
| back: a2a                 | 7.652 ms                  | 35.458 ms                 |
| back: cache               | 3.772 ms                  | 9.125 ms                  |
| back: aggr dram keys      | 37.895 ms                 | 52.483 ms                 |
| back: set dram grad       | 2.582 ms                  | 9.401 ms                  |
| Backward                  | 121.053 ms                | 155.356 ms                |
| Optimize                  | 31.248 ms                 | 47.336 ms                 |
| BarrierTimeBeforeRank0    | 47.953 us                 | 96.124 us                 |
| BlockToStepN              | 20.897 us                 | 177.037 us                |
| OneStep                   | 162.826 ms                | 205.085 ms                |
+---------------------------+---------------------------+---------------------------+
