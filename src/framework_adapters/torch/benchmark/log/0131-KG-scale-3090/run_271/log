WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240209 21:52:38.819612  5057 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_189', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [5057 sampler.py:454] Start PreSampling
WARNING [5057 sampler.py:532] Before construct renumbering_dict
WARNING [5057 sampler.py:555] PreSampling done
W20240209 21:52:44.368371  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240209 21:52:44.368558  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240209 21:52:44.368604  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240209 21:52:44.368647  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240209 21:52:44.368681  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240209 21:52:44.368721  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240209 21:52:44.368752  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240209 21:52:44.368793  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240209 21:52:44.368835  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240209 21:52:44.368877  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240209 21:52:44.368909  5057 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240209 21:52:44.368938  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240209 21:52:44.368961  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240209 21:52:44.369132  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240209 21:52:44.369165  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240209 21:52:44.369201  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240209 21:52:44.369240  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240209 21:52:44.369266  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240209 21:52:44.369304  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240209 21:52:44.369328  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240209 21:52:44.369351  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240209 21:52:44.369392  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240209 21:52:44.369421  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240209 21:52:44.369452  5057 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240209 21:52:44.369474  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240209 21:52:44.369495  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240209 21:52:44.369546  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240209 21:52:44.369582  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240209 21:52:44.369621  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240209 21:52:44.369657  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240209 21:52:44.369691  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240209 21:52:44.369722  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240209 21:52:44.369755  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240209 21:52:44.369786  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240209 21:52:44.369818  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240209 21:52:44.369841  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240209 21:52:44.369865  5057 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240209 21:52:44.369886  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240209 21:52:44.369915  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240209 21:52:44.369961  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240209 21:52:44.369992  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240209 21:52:44.370019  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240209 21:52:44.370043  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240209 21:52:44.370071  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240209 21:52:44.370102  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240209 21:52:44.370144  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240209 21:52:44.370173  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240209 21:52:44.370199  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240209 21:52:44.370223  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240209 21:52:44.370255  5057 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240209 21:52:44.370277  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240209 21:52:44.370296  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240209 21:52:44.370353  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240209 21:52:44.370388  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240209 21:52:44.370415  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240209 21:52:44.370442  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240209 21:52:44.370469  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240209 21:52:44.370497  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240209 21:52:44.370532  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240209 21:52:44.370569  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240209 21:52:44.370602  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240209 21:52:44.370630  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240209 21:52:44.370663  5057 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240209 21:52:44.370684  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240209 21:52:44.370714  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240209 21:52:44.370764  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240209 21:52:44.370792  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240209 21:52:44.370823  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240209 21:52:44.370847  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240209 21:52:44.370872  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240209 21:52:44.370914  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240209 21:52:44.370952  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240209 21:52:44.370982  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240209 21:52:44.371011  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240209 21:52:44.371043  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240209 21:52:44.371078  5057 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240209 21:52:44.371098  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240209 21:52:44.371119  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240209 21:52:44.371160  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240209 21:52:44.371212  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240209 21:52:44.371243  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240209 21:52:44.371279  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240209 21:52:44.371308  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240209 21:52:44.371345  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240209 21:52:44.371372  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240209 21:52:44.371407  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240209 21:52:44.371435  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240209 21:52:44.371464  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240209 21:52:44.371500  5057 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240209 21:52:44.371522  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240209 21:52:44.371542  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240209 21:52:44.371590  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240209 21:52:44.371619  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240209 21:52:44.371656  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240209 21:52:44.371681  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240209 21:52:44.371709  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240209 21:52:44.371733  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240209 21:52:44.371766  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240209 21:52:44.371791  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240209 21:52:44.371834  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240209 21:52:44.371860  5057 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240209 21:52:44.371886  5057 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240209 21:52:44.371906  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240209 21:52:44.371927  5057 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240209 21:52:44.574528  5057 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240209 21:52:44.608997  5057 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 1490,  1738,  2113,  ..., 10426,  9964,  8535]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.820 seconds
[Rank1] pid = 5261
[Rank2] pid = 5304
[Rank3] pid = 5327
[Rank4] pid = 5408
[Rank5] pid = 5520
[Rank6] pid = 5592
INFO [5057 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [5261 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [5304 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [5408 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [5327 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [5520 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [5592 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [5593 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [5592 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [5593 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [5408 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [5304 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [5327 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [5520 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [5261 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240209 21:52:47.175845  5522 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1495, 400]; dev=5; size=2.281 MB
W20240209 21:52:47.176012  5391 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240209 21:52:47.176005  5455 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1495, 400]; dev=4; size=2.281 MB
W20240209 21:52:47.176002  5661 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1495, 400]; dev=7; size=2.281 MB
W20240209 21:52:47.176038  5262 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240209 21:52:47.176260  5660 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1495, 400]; dev=6; size=2.281 MB
W20240209 21:52:47.176509  5326 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
INFO [5057 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240209 21:52:47.180476  5595 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240209 21:52:47.221405  5661 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100027a14000 7.629 MB
W20240209 21:52:47.221508  5595 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000281b7000 7.629 MB
W20240209 21:52:47.221524  5522 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10002895a000 7.629 MB
W20240209 21:52:47.221581  5391 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000290fd000 7.629 MB
W20240209 21:52:47.221599  5455 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1000298a0000 7.629 MB
W20240209 21:52:47.221607  5262 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10002a043000 7.629 MB
W20240209 21:52:47.221617  5660 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10002a7e6000 7.629 MB
W20240209 21:52:47.221619  5326 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10002af89000 7.629 MB
W20240209 21:52:47.221737  5661 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10002b72c000 7.629 MB
W20240209 21:52:47.221791  5391 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10002becf000 7.629 MB
W20240209 21:52:47.221796  5455 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10002c672000 7.629 MB
W20240209 21:52:47.221834  5660 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10002ce15000 7.629 MB
W20240209 21:52:47.221865  5595 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10002d5b8000 7.629 MB
W20240209 21:52:47.221871  5661 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10002dd5b000 1.49 GB
W20240209 21:52:47.221899  5522 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10008d33e000 7.629 MB
W20240209 21:52:47.221935  5595 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10008dae1000 1.49 GB
W20240209 21:52:47.221966  5326 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1000ed0c4000 7.629 MB
W20240209 21:52:47.221974  5262 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000ed867000 7.629 MB
W20240209 21:52:47.221993  5661 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1000ee00a000 1.49 GB
W20240209 21:52:47.222003  5660 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10014d5ed000 1.49 GB
W20240209 21:52:47.222009  5595 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1001acbd0000 1.49 GB
W20240209 21:52:47.222082  5661 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240209 21:52:47.222090  5262 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10020c1b3000 1.49 GB
W20240209 21:52:47.222100  5522 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10026b796000 1.49 GB
W20240209 21:52:47.222110  5326 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1002cad79000 1.49 GB
W20240209 21:52:47.222129  5595 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240209 21:52:47.222134  5455 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10032a35c000 1.49 GB
W20240209 21:52:47.222153  5391 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10038993f000 1.49 GB
W20240209 21:52:47.222187  5660 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1003e8f22000 1.49 GB
W20240209 21:52:47.222218  5262 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100448505000 1.49 GB
W20240209 21:52:47.222227  5326 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1004a7ae8000 1.49 GB
W20240209 21:52:47.222236  5522 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1005070cb000 1.49 GB
W20240209 21:52:47.222244  5455 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1005666ae000 1.49 GB
W20240209 21:52:47.222260  5391 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1005c5c91000 1.49 GB
W20240209 21:52:47.222301  5262 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240209 21:52:47.223673  5391 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240209 21:52:47.223696  5522 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240209 21:52:47.223698  5326 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240209 21:52:47.227097  5455 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240209 21:52:47.227134  5660 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240209 21:52:47.236536  5661 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240209 21:52:47.236682  5595 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240209 21:52:47.236704  5262 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240209 21:52:47.238350  5326 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240209 21:52:47.238363  5455 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240209 21:52:47.241348  5391 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240209 21:52:47.241356  5522 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240209 21:52:47.241379  5660 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [5408 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [5327 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [5261 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [5304 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [5520 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [5592 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [5593 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 5593
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [5057 DistTensor.py:59] The tensor name already exists in the kvstore
I20240209 21:52:49.219017  5391 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240209 21:52:49.219206  5262 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240209 21:52:49.219334  5522 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240209 21:52:49.219442  5326 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240209 21:52:49.219554  5661 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240209 21:52:49.219619  5660 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240209 21:52:49.219728  5455 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240209 21:52:49.219851  5595 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240209 21:52:50.966333  5660 recstore.cc:66] init folly done
E20240209 21:52:50.966352  5455 recstore.cc:66] init folly done
E20240209 21:52:50.966511  5595 recstore.cc:66] init folly done
E20240209 21:52:50.966667  5326 recstore.cc:66] init folly done
E20240209 21:52:50.966667  5661 recstore.cc:66] init folly done
E20240209 21:52:50.966740  5522 recstore.cc:66] init folly done
E20240209 21:52:50.966830  5262 recstore.cc:66] init folly done
E20240209 21:52:50.967208  5391 recstore.cc:66] init folly done
I20240209 21:52:51.041043  5391 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240209 21:52:51.041971  5522 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240209 21:52:51.044257  5262 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240209 21:52:51.045709  5326 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240209 21:52:51.047888  5661 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240209 21:52:51.050890  5595 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240209 21:52:51.066195  5455 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240209 21:52:51.066637  5660 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.349 us                | 813.349 us                |
| Forward                   | 657.413 ms                | 657.413 ms                |
| back: bucket keys         | 21.706 ms                 | 21.706 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.483 ms                  | 3.935 ms                  |
| Forward                   | 5.534 ms                  | 657.413 ms                |
| back: bucket keys         | 757.694 us                | 21.706 ms                 |
| back: a2a                 | 17.948 ms                 | 50.313 s                  |
| back: cache               | 7.738 ms                  | 20.385 ms                 |
| back: aggr dram keys      | 46.138 ms                 | 1.059 s                   |
| back: set dram grad       | 2.394 ms                  | 4.728 ms                  |
| Backward                  | 143.885 ms                | 51.759 s                  |
| Optimize                  | 33.652 ms                 | 46.000 ms                 |
| BarrierTimeBeforeRank0    | 89.187 us                 | 157.324 us                |
| BlockToStepN              | 112.469 us                | 133.576 us                |
| OneStep                   | 187.564 ms                | 52.465 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.648 ms                  | 20.640 ms                 |
| Forward                   | 4.951 ms                  | 657.413 ms                |
| back: bucket keys         | 768.423 us                | 2.232 ms                  |
| back: a2a                 | 13.542 ms                 | 37.111 ms                 |
| back: cache               | 8.155 ms                  | 20.385 ms                 |
| back: aggr dram keys      | 46.997 ms                 | 70.870 ms                 |
| back: set dram grad       | 2.474 ms                  | 7.962 ms                  |
| Backward                  | 151.213 ms                | 51.759 s                  |
| Optimize                  | 33.815 ms                 | 46.000 ms                 |
| BarrierTimeBeforeRank0    | 56.951 us                 | 157.324 us                |
| BlockToStepN              | 114.379 us                | 1.177 ms                  |
| OneStep                   | 196.426 ms                | 52.465 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.847 ms                  | 19.502 ms                 |
| Forward                   | 4.936 ms                  | 14.649 ms                 |
| back: bucket keys         | 768.423 us                | 6.084 ms                  |
| back: a2a                 | 13.677 ms                 | 37.111 ms                 |
| back: cache               | 8.115 ms                  | 20.385 ms                 |
| back: aggr dram keys      | 46.228 ms                 | 70.870 ms                 |
| back: set dram grad       | 2.474 ms                  | 8.677 ms                  |
| Backward                  | 151.478 ms                | 194.246 ms                |
| Optimize                  | 33.652 ms                 | 42.712 ms                 |
| BarrierTimeBeforeRank0    | 55.447 us                 | 217.497 us                |
| BlockToStepN              | 120.279 us                | 1.480 ms                  |
| OneStep                   | 195.851 ms                | 239.528 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.891 ms                  | 20.491 ms                 |
| Forward                   | 4.908 ms                  | 14.649 ms                 |
| back: bucket keys         | 684.500 us                | 3.283 ms                  |
| back: a2a                 | 13.940 ms                 | 37.111 ms                 |
| back: cache               | 8.117 ms                  | 20.385 ms                 |
| back: aggr dram keys      | 46.138 ms                 | 70.535 ms                 |
| back: set dram grad       | 2.476 ms                  | 9.197 ms                  |
| Backward                  | 151.185 ms                | 194.246 ms                |
| Optimize                  | 33.688 ms                 | 42.712 ms                 |
| BarrierTimeBeforeRank0    | 55.447 us                 | 217.497 us                |
| BlockToStepN              | 120.516 us                | 1.527 ms                  |
| OneStep                   | 196.426 ms                | 239.528 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 72.101, sample: 0.382, forward: 1.037, backward: 62.787, update: 0.375
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 72.077, sample: 0.418, forward: 1.131, backward: 62.663, update: 0.386
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 72.076, sample: 0.391, forward: 1.185, backward: 62.707, update: 0.299
train_sampler.Prefill()
-------Step 0-------
tensor([  125,   181,  4014,    95, 13367, 13970,  1883,  7018, 11510, 12054]) tensor([ 2113,  7041,  7125, 12571,    72,  1844,  1267,  5358,  1074,  9345])
-------Step 1-------
tensor([  125,   181,  4014,    95, 13367, 13970,  1883,  7018, 11510, 12054]) tensor([  961,   228, 14721,  2052,  1799,  8797, 14801,  9432,  6688, 13143])
-------Step 2-------
tensor([ 8036, 11348,  5606,  4011,   124,  7741, 10743,  5806, 12239,  1644]) tensor([ 3474,  5697,  4516,  7082,   328,  8474, 14381,  8612, 14393,  6587])
-------Step 3-------
tensor([ 8036, 11348,  5606,  4011,   124,  7741, 10743,  5806, 12239,  1644]) tensor([10163,  6727,  8849, 12458,  7566,  1385,   570,  3064,  8357,  2230])
-------Step 4-------
tensor([ 181, 9306, 7801, 6975, 4941, 4425,   41, 7567,   47, 1784]) tensor([1232, 1846,  564, 3455, 3153, 3284, 7018, 8151, 7096, 2040])
-------Step 5-------
tensor([ 181, 9306, 7801, 6975, 4941, 4425,   41, 7567,   47, 1784]) tensor([8299, 5924,  524, 2401, 4284, 1563, 1549, 2135, 6805, 7970])
-------Step 6-------
tensor([ 2448,  9737,    69,   131,  6569,  3330,  8044, 11764, 12986,   158]) tensor([11348,  3275,  8669,  3727, 10671,  9774,  5142,  7790, 11752, 13142])
-------Step 7-------
tensor([ 2448,  9737,    69,   131,  6569,  3330,  8044, 11764, 12986,   158]) tensor([8640,  795, 4110, 6653, 2077, 1396, 7752, 3489, 9397, 1406])
-------Step 8-------
tensor([ 4228,  7264,  6130,  8393,    65,    22,  9708, 11781,    26,  2870]) tensor([ 6089,  5419,  4601,  8065,  3737, 14111, 10010,  2088,  7514,  4037])
-------Step 9-------
tensor([ 4228,  7264,  6130,  8393,    65,    22,  9708, 11781,    26,  2870]) tensor([13470,  5165, 13480,  9200, 10034,   810, 14544,  9432,  1421, 13266])
before start barrier
start train
[proc 0] 100 steps, total: 72.092, sample: 0.441, forward: 1.195, backward: 66.978, update: 3.308
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 72.099, sample: 0.400, forward: 1.053, backward: 62.788, update: 0.376
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 72.102, sample: 0.408, forward: 1.163, backward: 62.725, update: 0.374
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 72.095, sample: 0.387, forward: 1.106, backward: 62.781, update: 0.306
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 72.097, sample: 0.412, forward: 1.129, backward: 62.667, update: 0.384
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.008 ms                  | 20.640 ms                 |
| Forward                   | 5.012 ms                  | 14.649 ms                 |
| back: bucket keys         | 684.977 us                | 6.084 ms                  |
| back: a2a                 | 13.940 ms                 | 37.111 ms                 |
| back: cache               | 8.169 ms                  | 21.903 ms                 |
| back: aggr dram keys      | 46.013 ms                 | 70.535 ms                 |
| back: set dram grad       | 2.469 ms                  | 9.417 ms                  |
| Backward                  | 151.185 ms                | 194.246 ms                |
| Optimize                  | 33.688 ms                 | 45.803 ms                 |
| BarrierTimeBeforeRank0    | 55.351 us                 | 483.292 us                |
| BlockToStepN              | 122.014 us                | 2.004 ms                  |
| OneStep                   | 196.627 ms                | 241.569 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.186 ms                  | 22.996 ms                 |
| Forward                   | 5.087 ms                  | 14.649 ms                 |
| back: bucket keys         | 685.930 us                | 3.631 ms                  |
| back: a2a                 | 13.964 ms                 | 34.348 ms                 |
| back: cache               | 8.174 ms                  | 21.903 ms                 |
| back: aggr dram keys      | 46.403 ms                 | 68.477 ms                 |
| back: set dram grad       | 2.476 ms                  | 9.417 ms                  |
| Backward                  | 151.783 ms                | 195.378 ms                |
| Optimize                  | 33.815 ms                 | 45.803 ms                 |
| BarrierTimeBeforeRank0    | 55.426 us                 | 483.292 us                |
| BlockToStepN              | 138.127 us                | 2.004 ms                  |
| OneStep                   | 198.536 ms                | 250.187 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.220 ms                  | 22.905 ms                 |
| Forward                   | 5.039 ms                  | 13.777 ms                 |
| back: bucket keys         | 696.421 us                | 3.631 ms                  |
| back: a2a                 | 13.965 ms                 | 34.348 ms                 |
| back: cache               | 8.142 ms                  | 21.903 ms                 |
| back: aggr dram keys      | 46.286 ms                 | 68.477 ms                 |
| back: set dram grad       | 2.476 ms                  | 10.304 ms                 |
| Backward                  | 152.703 ms                | 194.246 ms                |
| Optimize                  | 33.815 ms                 | 44.684 ms                 |
| BarrierTimeBeforeRank0    | 55.318 us                 | 409.678 us                |
| BlockToStepN              | 133.298 us                | 1.602 ms                  |
| OneStep                   | 198.905 ms                | 250.187 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.220 ms                  | 22.905 ms                 |
| Forward                   | 4.979 ms                  | 13.777 ms                 |
| back: bucket keys         | 697.374 us                | 4.466 ms                  |
| back: a2a                 | 13.994 ms                 | 38.416 ms                 |
| back: cache               | 8.126 ms                  | 20.385 ms                 |
| back: aggr dram keys      | 46.286 ms                 | 68.120 ms                 |
| back: set dram grad       | 2.474 ms                  | 10.114 ms                 |
| Backward                  | 153.747 ms                | 195.378 ms                |
| Optimize                  | 33.741 ms                 | 44.684 ms                 |
| BarrierTimeBeforeRank0    | 53.944 us                 | 409.678 us                |
| BlockToStepN              | 133.298 us                | 2.059 ms                  |
| OneStep                   | 199.403 ms                | 250.187 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 90.48303961753845 seconds
before call kg_cache_controller.StopThreads()
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
INFO [5057 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.186 ms                  | 22.905 ms                 |
| Forward                   | 4.968 ms                  | 13.777 ms                 |
| back: bucket keys         | 690.699 us                | 4.466 ms                  |
| back: a2a                 | 13.940 ms                 | 38.416 ms                 |
| back: cache               | 8.111 ms                  | 20.385 ms                 |
| back: aggr dram keys      | 46.403 ms                 | 68.120 ms                 |
| back: set dram grad       | 2.474 ms                  | 10.114 ms                 |
| Backward                  | 154.721 ms                | 195.378 ms                |
| Optimize                  | 33.652 ms                 | 44.684 ms                 |
| BarrierTimeBeforeRank0    | 52.749 us                 | 409.678 us                |
| BlockToStepN              | 130.491 us                | 2.059 ms                  |
| OneStep                   | 199.403 ms                | 250.187 ms                |
+---------------------------+---------------------------+---------------------------+
