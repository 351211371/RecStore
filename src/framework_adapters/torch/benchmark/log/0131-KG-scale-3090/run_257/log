WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240208 01:17:49.938562 59388 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_59', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [59388 sampler.py:454] Start PreSampling
WARNING [59388 sampler.py:532] Before construct renumbering_dict
WARNING [59388 sampler.py:555] PreSampling done
W20240208 01:38:26.512791 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240208 01:38:26.512979 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240208 01:38:26.513028 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240208 01:38:26.513062 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240208 01:38:26.513095 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240208 01:38:26.513137 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240208 01:38:26.513168 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240208 01:38:26.513214 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240208 01:38:26.513245 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240208 01:38:26.513275 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240208 01:38:26.513305 59388 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240208 01:38:26.513331 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240208 01:38:26.513362 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240208 01:38:26.513506 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240208 01:38:26.513538 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240208 01:38:26.513567 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240208 01:38:26.513607 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240208 01:38:26.513633 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240208 01:38:26.513666 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240208 01:38:26.513695 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240208 01:38:26.513724 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240208 01:38:26.513752 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240208 01:38:26.513793 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240208 01:38:26.513818 59388 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240208 01:38:26.513844 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240208 01:38:26.513871 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240208 01:38:26.513927 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240208 01:38:26.513959 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240208 01:38:26.513985 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240208 01:38:26.514014 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240208 01:38:26.514043 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240208 01:38:26.514073 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240208 01:38:26.514101 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240208 01:38:26.514125 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240208 01:38:26.514159 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240208 01:38:26.514191 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240208 01:38:26.514222 59388 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240208 01:38:26.514245 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240208 01:38:26.514273 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240208 01:38:26.514336 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240208 01:38:26.514367 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240208 01:38:26.514396 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240208 01:38:26.514422 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240208 01:38:26.514456 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240208 01:38:26.514499 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240208 01:38:26.514528 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240208 01:38:26.514560 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240208 01:38:26.514592 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240208 01:38:26.514621 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240208 01:38:26.514648 59388 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240208 01:38:26.514670 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240208 01:38:26.514693 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240208 01:38:26.514757 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240208 01:38:26.514792 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240208 01:38:26.514825 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240208 01:38:26.514859 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240208 01:38:26.514887 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240208 01:38:26.514916 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240208 01:38:26.514952 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240208 01:38:26.514983 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240208 01:38:26.515017 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240208 01:38:26.515054 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240208 01:38:26.515087 59388 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240208 01:38:26.515112 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240208 01:38:26.515141 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240208 01:38:26.515195 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240208 01:38:26.515236 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240208 01:38:26.515264 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240208 01:38:26.515290 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240208 01:38:26.515317 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240208 01:38:26.515347 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240208 01:38:26.515380 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240208 01:38:26.515409 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240208 01:38:26.515441 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240208 01:38:26.515475 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240208 01:38:26.515504 59388 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240208 01:38:26.515527 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240208 01:38:26.515549 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240208 01:38:26.515606 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240208 01:38:26.515645 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240208 01:38:26.515672 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240208 01:38:26.515702 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240208 01:38:26.515731 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240208 01:38:26.515766 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240208 01:38:26.515794 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240208 01:38:26.515830 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240208 01:38:26.515858 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240208 01:38:26.515904 59388 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240208 01:38:26.515937 59388 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240208 01:38:26.515962 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240208 01:38:26.515992 59388 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240208 01:38:26.934522 59388 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000216be000 128.2 GB
W20240208 01:47:01.712514 59388 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020302f6000 328.3 MB
{0: Graph(num_nodes=15380073, num_edges=42467395,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=16359015, num_edges=65830196,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16649310, num_edges=43584356,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=13918614, num_edges=50952482,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14713191, num_edges=52450022,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14150782, num_edges=58077216,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=21311359, num_edges=64967677,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 15380073 N 42467395 E
MertisPartition: part 1 has 16359015 N 65830196 E
MertisPartition: part 2 has 16649310 N 43584356 E
MertisPartition: part 3 has 13918614 N 50952482 E
MertisPartition: part 4 has 14713191 N 52450022 E
MertisPartition: part 5 has 14150782 N 58077216 E
MertisPartition: part 6 has 21311359 N 64967677 E
Rank0: cached key size 614672
Rank1: cached key size 614672
Rank2: cached key size 614672
Rank3: cached key size 614672
Rank4: cached key size 614672
Rank5: cached key size 614672
Rank6: cached key size 614672
Before renumbering graph:  {'_ID': tensor([     239,      240,      329,  ..., 86019793, 84488282, 82976992]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4317372,  4317420,  4320752,  ..., 75762585, 35099494, 68039063]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2262.458 seconds
[Rank1] pid = 60582
[Rank2] pid = 60676
[Rank3] pid = 60743
[Rank4] pid = 60812
[Rank5] pid = 60879
INFO [59388 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [60582 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [60676 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [60743 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [60812 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [60676 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60946 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [60879 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [60879 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60946 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60743 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [59388 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60812 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [60582 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
WARNING [60946 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60812 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60879 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [59388 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60743 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60676 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [60582 DistTensor.py:59] The tensor name already exists in the kvstore
I20240208 01:55:52.032605 60583 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240208 01:55:52.033598 60744 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240208 01:55:52.033797 60880 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240208 01:55:52.033987 60813 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240208 01:55:52.034157 60951 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240208 01:55:52.034344 60947 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240208 01:55:52.034479 60677 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
E20240208 01:55:52.669159 60677 recstore.cc:66] init folly done
E20240208 01:55:52.669195 60947 recstore.cc:66] init folly done
E20240208 01:55:52.669195 60813 recstore.cc:66] init folly done
E20240208 01:55:52.669549 60880 recstore.cc:66] init folly done
E20240208 01:55:52.669682 60744 recstore.cc:66] init folly done
E20240208 01:55:52.669741 60951 recstore.cc:66] init folly done
E20240208 01:55:52.669977 60583 recstore.cc:66] init folly done
I20240208 01:55:59.248615 60951 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240208 01:55:59.323309 60677 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240208 01:56:00.622748 60813 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240208 01:56:01.064492 60744 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240208 01:56:01.248356 60880 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240208 01:56:02.413154 60947 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240208 01:56:02.733515 60583 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.056 ms                 | 27.413 ms                 |
| bucket keys               | 2.594 ms                  | 136.193 ms                |
| forward: a2a keys         | 6.941 ms                  | 1.158 s                   |
| forward: search cache     | 348.865 us                | 23.423 ms                 |
| forward: a2a values       | 6.707 ms                  | 46.258 ms                 |
| forward: join             | 2.657 ms                  | 3.550 ms                  |
| Forward                   | 49.305 ms                 | 1.670 s                   |
| back: aggr dram keys      | 30.785 ms                 | 828.590 ms                |
| back: set dram grad       | 2.131 ms                  | 12.957 ms                 |
| back: a2a grad            | 10.430 ms                 | 46.483 ms                 |
| back: grad sum & grad cache  | 4.176 ms                  | 135.760 ms                |
| Backward                  | 218.399 ms                | 1.234 s                   |
| Optimize                  | 30.459 ms                 | 56.962 ms                 |
| BarrierTimeBeforeRank0    | 66.000 us                 | 96.638 us                 |
| BlockToStepN              | 25.057 us                 | 42.567 us                 |
| OneStep                   | 315.357 ms                | 2.990 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.563 ms                  | 327.599 ms                |
| bucket keys               | 2.594 ms                  | 136.193 ms                |
| forward: a2a keys         | 6.493 ms                  | 1.158 s                   |
| forward: search cache     | 350.744 us                | 23.423 ms                 |
| forward: a2a values       | 6.707 ms                  | 46.258 ms                 |
| forward: join             | 2.611 ms                  | 3.550 ms                  |
| Forward                   | 50.654 ms                 | 1.670 s                   |
| back: aggr dram keys      | 37.730 ms                 | 828.590 ms                |
| back: set dram grad       | 2.131 ms                  | 12.957 ms                 |
| back: a2a grad            | 14.821 ms                 | 69.330 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 135.760 ms                |
| Backward                  | 218.399 ms                | 1.234 s                   |
| Optimize                  | 27.490 ms                 | 56.962 ms                 |
| BarrierTimeBeforeRank0    | 48.093 us                 | 104.556 us                |
| BlockToStepN              | 29.923 us                 | 28.332 ms                 |
| OneStep                   | 315.357 ms                | 2.990 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.587 ms                  | 327.599 ms                |
| bucket keys               | 2.993 ms                  | 3.781 ms                  |
| forward: a2a keys         | 6.320 ms                  | 48.750 ms                 |
| forward: search cache     | 350.972 us                | 460.886 us                |
| forward: a2a values       | 6.707 ms                  | 36.278 ms                 |
| forward: join             | 2.591 ms                  | 3.553 ms                  |
| Forward                   | 51.784 ms                 | 1.670 s                   |
| back: aggr dram keys      | 44.641 ms                 | 94.030 ms                 |
| back: set dram grad       | 2.131 ms                  | 11.874 ms                 |
| back: a2a grad            | 22.183 ms                 | 57.799 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 108.979 ms                |
| Backward                  | 213.660 ms                | 1.234 s                   |
| Optimize                  | 27.072 ms                 | 56.962 ms                 |
| BarrierTimeBeforeRank0    | 43.759 us                 | 104.556 us                |
| BlockToStepN              | 34.158 us                 | 28.332 ms                 |
| OneStep                   | 312.191 ms                | 2.990 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.850 ms                  | 323.455 ms                |
| bucket keys               | 2.993 ms                  | 8.003 ms                  |
| forward: a2a keys         | 6.253 ms                  | 51.002 ms                 |
| forward: search cache     | 350.985 us                | 460.886 us                |
| forward: a2a values       | 16.031 ms                 | 36.278 ms                 |
| forward: join             | 2.591 ms                  | 3.553 ms                  |
| Forward                   | 51.720 ms                 | 1.670 s                   |
| back: aggr dram keys      | 44.641 ms                 | 94.030 ms                 |
| back: set dram grad       | 2.131 ms                  | 11.874 ms                 |
| back: a2a grad            | 21.096 ms                 | 57.799 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 108.979 ms                |
| Backward                  | 211.177 ms                | 1.234 s                   |
| Optimize                  | 27.072 ms                 | 56.962 ms                 |
| BarrierTimeBeforeRank0    | 40.749 us                 | 104.556 us                |
| BlockToStepN              | 35.517 us                 | 28.332 ms                 |
| OneStep                   | 311.127 ms                | 2.990 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.419 ms                  | 323.455 ms                |
| bucket keys               | 2.993 ms                  | 8.003 ms                  |
| forward: a2a keys         | 6.184 ms                  | 144.854 ms                |
| forward: search cache     | 350.972 us                | 460.886 us                |
| forward: a2a values       | 6.707 ms                  | 36.278 ms                 |
| forward: join             | 2.591 ms                  | 3.553 ms                  |
| Forward                   | 50.688 ms                 | 194.403 ms                |
| back: aggr dram keys      | 44.641 ms                 | 94.030 ms                 |
| back: set dram grad       | 2.547 ms                  | 11.874 ms                 |
| back: a2a grad            | 21.096 ms                 | 57.799 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 108.979 ms                |
| Backward                  | 205.958 ms                | 275.883 ms                |
| Optimize                  | 26.842 ms                 | 54.613 ms                 |
| BarrierTimeBeforeRank0    | 38.743 us                 | 97.233 us                 |
| BlockToStepN              | 34.790 us                 | 26.205 ms                 |
| OneStep                   | 304.441 ms                | 661.939 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.546 ms                  | 323.455 ms                |
| bucket keys               | 2.991 ms                  | 4.064 ms                  |
| forward: a2a keys         | 5.983 ms                  | 101.197 ms                |
| forward: search cache     | 351.512 us                | 438.944 us                |
| forward: a2a values       | 16.031 ms                 | 28.398 ms                 |
| forward: join             | 2.591 ms                  | 3.553 ms                  |
| Forward                   | 50.085 ms                 | 194.403 ms                |
| back: aggr dram keys      | 44.641 ms                 | 83.474 ms                 |
| back: set dram grad       | 2.547 ms                  | 11.579 ms                 |
| back: a2a grad            | 21.096 ms                 | 56.995 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 103.373 ms                |
| Backward                  | 201.971 ms                | 275.883 ms                |
| Optimize                  | 26.761 ms                 | 54.613 ms                 |
| BarrierTimeBeforeRank0    | 38.208 us                 | 97.233 us                 |
| BlockToStepN              | 32.579 us                 | 26.205 ms                 |
| OneStep                   | 301.732 ms                | 661.939 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.033 ms                  | 323.455 ms                |
| bucket keys               | 2.991 ms                  | 6.680 ms                  |
| forward: a2a keys         | 5.887 ms                  | 110.231 ms                |
| forward: search cache     | 352.029 us                | 460.886 us                |
| forward: a2a values       | 15.913 ms                 | 36.278 ms                 |
| forward: join             | 2.591 ms                  | 3.855 ms                  |
| Forward                   | 49.305 ms                 | 194.403 ms                |
| back: aggr dram keys      | 43.717 ms                 | 83.474 ms                 |
| back: set dram grad       | 2.547 ms                  | 11.579 ms                 |
| back: a2a grad            | 21.341 ms                 | 56.995 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 103.373 ms                |
| Backward                  | 202.574 ms                | 275.883 ms                |
| Optimize                  | 26.738 ms                 | 54.613 ms                 |
| BarrierTimeBeforeRank0    | 37.695 us                 | 97.233 us                 |
| BlockToStepN              | 32.248 us                 | 26.205 ms                 |
| OneStep                   | 299.909 ms                | 661.939 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 36.146, sample: 1.221, forward: 9.330, backward: 13.461, update: 0.494
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 34.982, sample: 1.205, forward: 9.285, backward: 13.750, update: 0.450
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 38.071, sample: 1.302, forward: 9.194, backward: 13.893, update: 0.426
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 36.330, sample: 1.258, forward: 9.192, backward: 13.793, update: 0.479
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 34.661, sample: 2.528, forward: 7.852, backward: 14.414, update: 0.441
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 36.772, sample: 1.094, forward: 9.418, backward: 13.532, update: 0.507
[Rank6] pid = 60946
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 4320790,   291842,   291870,   291902,   359291,   562271, 24135207,
          359320,   359356,    28928]) tensor([ 9914393, 34608065, 72591945, 69336671, 77079346, 39037609, 39684074,
        40799196, 77839348, 45664167])
-------Step 1-------
tensor([ 4320790,   291842,   291870,   291902,   359291,   562271, 24135207,
          359320,   359356,    28928]) tensor([43930634, 17987620, 24119730, 15723207, 55210739, 33704157, 71091880,
        22508504, 21279824, 37980007])
-------Step 2-------
tensor([  421581,   303278,   421611,   421628,   421657, 24135613,   570119,
          421689,   570136,   421716]) tensor([31327634,  7210027, 81196063,  1527536, 70190467, 17679933, 63163988,
           34599, 44719871, 83206495])
-------Step 3-------
tensor([  421581,   303278,   421611,   421628,   421657, 24135613,   570119,
          421689,   570136,   421716]) tensor([47371419, 10805296, 25967832,     4433, 53521448, 66649611, 70409419,
        73637405, 52607937, 65769539])
-------Step 4-------
tensor([  578029,   313970,   485589,   578042, 24135207,   224383,   314008,
        44652911,   485611,  4776617]) tensor([74050215, 65722716, 40460589, 11435848, 54437557, 36711472, 14349873,
        58923040, 72651710, 27896888])
-------Step 5-------
tensor([  578029,   313970,   485589,   578042, 24135207,   224383,   314008,
        44652911,   485611,  4776617]) tensor([44836575, 29234834, 11346075, 70931866, 69307682, 61492212,  8142629,
        74054609, 80064161, 80076555])
-------Step 6-------
tensor([ 485092, 4320790,    2675,    2695,   82353,  323341,    2729,    2753,
           2782,    2812]) tensor([39627205, 21946813, 79699946, 41164057, 59000720, 45192871, 38718141,
        40201828, 11318993, 69495566])
-------Step 7-------
tensor([ 485092, 4320790,    2675,    2695,   82353,  323341,    2729,    2753,
           2782,    2812]) tensor([42266745,  5099493, 77931174, 50897795, 74859241, 56585501,  5908536,
        15909277, 33255168,  4866638])
-------Step 8-------
tensor([  486669,    91422,    91444,    91470, 63527655,  4320790,    91493,
         4758624,   594705,    91521]) tensor([68016572, 10667160, 54968553, 79938926, 42669093, 60565310,  4706315,
        26207616, 32580665,   167594])
-------Step 9-------
tensor([  486669,    91422,    91444,    91470, 63527655,  4320790,    91493,
         4758624,   594705,    91521]) tensor([20308486, 21494628, 76993857, 47337741, 36912263, 13816194, 52515692,
        17702242, 71485361, 59433039])
before start barrier
start train
[proc 0] 100 steps, total: 38.146, sample: 2.446, forward: 7.357, backward: 21.671, update: 2.864
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.198 ms                  | 323.455 ms                |
| bucket keys               | 2.993 ms                  | 6.680 ms                  |
| forward: a2a keys         | 5.821 ms                  | 110.231 ms                |
| forward: search cache     | 352.160 us                | 460.886 us                |
| forward: a2a values       | 16.020 ms                 | 36.278 ms                 |
| forward: join             | 2.591 ms                  | 3.885 ms                  |
| Forward                   | 49.262 ms                 | 194.403 ms                |
| back: aggr dram keys      | 44.641 ms                 | 83.474 ms                 |
| back: set dram grad       | 2.625 ms                  | 11.579 ms                 |
| back: a2a grad            | 21.387 ms                 | 56.995 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 103.373 ms                |
| Backward                  | 203.858 ms                | 275.883 ms                |
| Optimize                  | 26.752 ms                 | 54.613 ms                 |
| BarrierTimeBeforeRank0    | 37.594 us                 | 97.233 us                 |
| BlockToStepN              | 34.093 us                 | 26.205 ms                 |
| OneStep                   | 299.275 ms                | 661.939 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.198 ms                  | 323.455 ms                |
| bucket keys               | 2.993 ms                  | 4.277 ms                  |
| forward: a2a keys         | 6.039 ms                  | 101.197 ms                |
| forward: search cache     | 352.404 us                | 438.944 us                |
| forward: a2a values       | 16.020 ms                 | 31.617 ms                 |
| forward: join             | 2.591 ms                  | 3.855 ms                  |
| Forward                   | 49.305 ms                 | 194.403 ms                |
| back: aggr dram keys      | 46.425 ms                 | 83.086 ms                 |
| back: set dram grad       | 2.625 ms                  | 11.206 ms                 |
| back: a2a grad            | 21.487 ms                 | 46.483 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 100.131 ms                |
| Backward                  | 201.145 ms                | 275.883 ms                |
| Optimize                  | 26.710 ms                 | 54.613 ms                 |
| BarrierTimeBeforeRank0    | 38.127 us                 | 97.233 us                 |
| BlockToStepN              | 35.199 us                 | 26.205 ms                 |
| OneStep                   | 297.195 ms                | 661.939 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.454 ms                  | 323.455 ms                |
| bucket keys               | 2.993 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.887 ms                  | 101.197 ms                |
| forward: search cache     | 352.404 us                | 438.944 us                |
| forward: a2a values       | 16.024 ms                 | 35.152 ms                 |
| forward: join             | 2.591 ms                  | 3.855 ms                  |
| Forward                   | 49.262 ms                 | 194.403 ms                |
| back: aggr dram keys      | 46.425 ms                 | 83.086 ms                 |
| back: set dram grad       | 2.625 ms                  | 11.206 ms                 |
| back: a2a grad            | 21.552 ms                 | 48.739 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 100.131 ms                |
| Backward                  | 198.705 ms                | 275.883 ms                |
| Optimize                  | 26.654 ms                 | 54.613 ms                 |
| BarrierTimeBeforeRank0    | 38.127 us                 | 97.233 us                 |
| BlockToStepN              | 34.057 us                 | 26.205 ms                 |
| OneStep                   | 293.417 ms                | 661.939 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.697 ms                  | 277.337 ms                |
| bucket keys               | 2.993 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.887 ms                  | 101.197 ms                |
| forward: search cache     | 352.462 us                | 460.886 us                |
| forward: a2a values       | 16.020 ms                 | 35.152 ms                 |
| forward: join             | 2.591 ms                  | 3.855 ms                  |
| Forward                   | 49.234 ms                 | 156.980 ms                |
| back: aggr dram keys      | 46.425 ms                 | 83.086 ms                 |
| back: set dram grad       | 2.625 ms                  | 11.206 ms                 |
| back: a2a grad            | 21.601 ms                 | 48.739 ms                 |
| back: grad sum & grad cache  | 5.735 ms                  | 100.131 ms                |
| Backward                  | 198.543 ms                | 259.918 ms                |
| Optimize                  | 26.654 ms                 | 54.514 ms                 |
| BarrierTimeBeforeRank0    | 37.695 us                 | 96.638 us                 |
| BlockToStepN              | 32.579 us                 | 24.936 ms                 |
| OneStep                   | 292.986 ms                | 648.523 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.454 ms                  | 277.337 ms                |
| bucket keys               | 2.999 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.887 ms                  | 99.676 ms                 |
| forward: search cache     | 352.810 us                | 505.895 us                |
| forward: a2a values       | 16.020 ms                 | 36.278 ms                 |
| forward: join             | 2.591 ms                  | 3.885 ms                  |
| Forward                   | 49.262 ms                 | 156.980 ms                |
| back: aggr dram keys      | 46.425 ms                 | 80.455 ms                 |
| back: set dram grad       | 3.996 ms                  | 10.943 ms                 |
| back: a2a grad            | 21.663 ms                 | 48.739 ms                 |
| back: grad sum & grad cache  | 5.978 ms                  | 98.344 ms                 |
| Backward                  | 198.705 ms                | 259.918 ms                |
| Optimize                  | 26.656 ms                 | 54.514 ms                 |
| BarrierTimeBeforeRank0    | 37.614 us                 | 96.638 us                 |
| BlockToStepN              | 32.467 us                 | 24.936 ms                 |
| OneStep                   | 293.417 ms                | 648.523 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.697 ms                  | 277.337 ms                |
| bucket keys               | 2.998 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.821 ms                  | 99.676 ms                 |
| forward: search cache     | 352.810 us                | 624.767 us                |
| forward: a2a values       | 16.020 ms                 | 36.278 ms                 |
| forward: join             | 2.591 ms                  | 3.885 ms                  |
| Forward                   | 49.100 ms                 | 156.980 ms                |
| back: aggr dram keys      | 46.446 ms                 | 83.086 ms                 |
| back: set dram grad       | 3.996 ms                  | 10.943 ms                 |
| back: a2a grad            | 21.726 ms                 | 48.739 ms                 |
| back: grad sum & grad cache  | 5.978 ms                  | 98.344 ms                 |
| Backward                  | 198.561 ms                | 259.918 ms                |
| Optimize                  | 26.682 ms                 | 54.514 ms                 |
| BarrierTimeBeforeRank0    | 37.614 us                 | 97.233 us                 |
| BlockToStepN              | 32.294 us                 | 24.936 ms                 |
| OneStep                   | 294.127 ms                | 648.523 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 200 steps, total: 30.888, sample: 1.106, forward: 7.180, backward: 12.419, update: 0.455
[proc 2] 200 steps, total: 30.888, sample: 1.079, forward: 7.135, backward: 12.786, update: 0.432
[proc 3] 200 steps, total: 30.888, sample: 1.216, forward: 6.992, backward: 12.712, update: 0.413
[proc 5] 200 steps, total: 30.889, sample: 1.483, forward: 6.785, backward: 12.418, update: 0.461
[proc 6] 200 steps, total: 30.889, sample: 1.107, forward: 7.142, backward: 12.675, update: 0.435
[proc 1] 200 steps, total: 30.888, sample: 1.954, forward: 6.204, backward: 13.276, update: 0.421
[proc 0] 200 steps, total: 30.888, sample: 2.171, forward: 5.505, backward: 20.248, update: 2.723
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.640 ms                  | 277.337 ms                |
| bucket keys               | 2.997 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.898 ms                  | 99.676 ms                 |
| forward: search cache     | 352.794 us                | 624.767 us                |
| forward: a2a values       | 15.906 ms                 | 36.278 ms                 |
| forward: join             | 2.591 ms                  | 3.892 ms                  |
| Forward                   | 49.157 ms                 | 156.980 ms                |
| back: aggr dram keys      | 46.446 ms                 | 83.086 ms                 |
| back: set dram grad       | 4.012 ms                  | 11.206 ms                 |
| back: a2a grad            | 21.726 ms                 | 48.739 ms                 |
| back: grad sum & grad cache  | 25.980 ms                 | 98.344 ms                 |
| Backward                  | 198.470 ms                | 259.918 ms                |
| Optimize                  | 26.710 ms                 | 54.514 ms                 |
| BarrierTimeBeforeRank0    | 37.668 us                 | 97.233 us                 |
| BlockToStepN              | 33.159 us                 | 24.936 ms                 |
| OneStep                   | 293.356 ms                | 648.523 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.584 ms                  | 277.337 ms                |
| bucket keys               | 2.997 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.759 ms                  | 51.002 ms                 |
| forward: search cache     | 352.969 us                | 621.185 us                |
| forward: a2a values       | 15.913 ms                 | 35.152 ms                 |
| forward: join             | 2.591 ms                  | 3.885 ms                  |
| Forward                   | 49.104 ms                 | 156.980 ms                |
| back: aggr dram keys      | 46.446 ms                 | 80.455 ms                 |
| back: set dram grad       | 4.012 ms                  | 10.943 ms                 |
| back: a2a grad            | 21.895 ms                 | 48.414 ms                 |
| back: grad sum & grad cache  | 25.980 ms                 | 96.831 ms                 |
| Backward                  | 197.677 ms                | 259.918 ms                |
| Optimize                  | 26.707 ms                 | 54.514 ms                 |
| BarrierTimeBeforeRank0    | 37.377 us                 | 97.233 us                 |
| BlockToStepN              | 32.248 us                 | 24.936 ms                 |
| OneStep                   | 292.010 ms                | 648.523 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.265 ms                  | 277.337 ms                |
| bucket keys               | 2.996 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.726 ms                  | 51.002 ms                 |
| forward: search cache     | 352.968 us                | 621.185 us                |
| forward: a2a values       | 15.807 ms                 | 35.152 ms                 |
| forward: join             | 2.591 ms                  | 3.885 ms                  |
| Forward                   | 48.919 ms                 | 156.980 ms                |
| back: aggr dram keys      | 46.446 ms                 | 80.455 ms                 |
| back: set dram grad       | 4.012 ms                  | 10.943 ms                 |
| back: a2a grad            | 21.895 ms                 | 48.414 ms                 |
| back: grad sum & grad cache  | 25.980 ms                 | 96.831 ms                 |
| Backward                  | 196.890 ms                | 259.918 ms                |
| Optimize                  | 26.710 ms                 | 54.514 ms                 |
| BarrierTimeBeforeRank0    | 37.464 us                 | 97.233 us                 |
| BlockToStepN              | 32.579 us                 | 24.936 ms                 |
| OneStep                   | 291.236 ms                | 648.523 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.372 ms                  | 213.221 ms                |
| bucket keys               | 2.996 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.739 ms                  | 51.002 ms                 |
| forward: search cache     | 352.810 us                | 621.185 us                |
| forward: a2a values       | 14.805 ms                 | 35.152 ms                 |
| forward: join             | 2.591 ms                  | 3.885 ms                  |
| Forward                   | 49.080 ms                 | 147.221 ms                |
| back: aggr dram keys      | 47.988 ms                 | 80.455 ms                 |
| back: set dram grad       | 4.012 ms                  | 10.943 ms                 |
| back: a2a grad            | 21.268 ms                 | 48.414 ms                 |
| back: grad sum & grad cache  | 25.980 ms                 | 96.831 ms                 |
| Backward                  | 195.928 ms                | 257.235 ms                |
| Optimize                  | 26.782 ms                 | 53.037 ms                 |
| BarrierTimeBeforeRank0    | 37.368 us                 | 96.638 us                 |
| BlockToStepN              | 32.294 us                 | 21.851 ms                 |
| OneStep                   | 290.123 ms                | 555.569 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.248 ms                  | 213.221 ms                |
| bucket keys               | 2.996 ms                  | 4.214 ms                  |
| forward: a2a keys         | 5.726 ms                  | 48.750 ms                 |
| forward: search cache     | 353.128 us                | 620.320 us                |
| forward: a2a values       | 14.795 ms                 | 35.016 ms                 |
| forward: join             | 2.591 ms                  | 3.855 ms                  |
| Forward                   | 49.080 ms                 | 147.221 ms                |
| back: aggr dram keys      | 49.257 ms                 | 80.417 ms                 |
| back: set dram grad       | 4.012 ms                  | 9.548 ms                  |
| back: a2a grad            | 20.812 ms                 | 46.483 ms                 |
| back: grad sum & grad cache  | 25.980 ms                 | 96.338 ms                 |
| Backward                  | 195.916 ms                | 257.235 ms                |
| Optimize                  | 26.885 ms                 | 53.037 ms                 |
| BarrierTimeBeforeRank0    | 37.013 us                 | 96.638 us                 |
| BlockToStepN              | 32.248 us                 | 21.851 ms                 |
| OneStep                   | 290.123 ms                | 555.569 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.847 ms                  | 213.221 ms                |
| bucket keys               | 2.996 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.727 ms                  | 48.750 ms                 |
| forward: search cache     | 353.144 us                | 620.320 us                |
| forward: a2a values       | 11.953 ms                 | 35.016 ms                 |
| forward: join             | 2.591 ms                  | 3.855 ms                  |
| Forward                   | 49.100 ms                 | 147.221 ms                |
| back: aggr dram keys      | 49.257 ms                 | 80.417 ms                 |
| back: set dram grad       | 4.012 ms                  | 10.943 ms                 |
| back: a2a grad            | 20.367 ms                 | 48.414 ms                 |
| back: grad sum & grad cache  | 25.980 ms                 | 96.338 ms                 |
| Backward                  | 195.553 ms                | 257.235 ms                |
| Optimize                  | 26.996 ms                 | 53.037 ms                 |
| BarrierTimeBeforeRank0    | 36.533 us                 | 96.638 us                 |
| BlockToStepN              | 32.294 us                 | 24.936 ms                 |
| OneStep                   | 289.988 ms                | 555.569 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 300 steps, total: 29.035, sample: 1.049, forward: 6.232, backward: 12.357, update: 0.370
[proc 4] 300 steps, total: 29.035, sample: 0.908, forward: 6.385, backward: 12.358, update: 0.440
[proc 6] 300 steps, total: 29.034, sample: 1.007, forward: 6.281, backward: 12.558, update: 0.443
[proc 2] 300 steps, total: 29.035, sample: 0.905, forward: 6.355, backward: 12.643, update: 0.452
[proc 1] 300 steps, total: 29.034, sample: 1.474, forward: 5.703, backward: 13.163, update: 0.431
[proc 3] 300 steps, total: 29.035, sample: 0.926, forward: 6.312, backward: 12.582, update: 0.381
[proc 0] 300 steps, total: 29.034, sample: 1.508, forward: 5.314, backward: 19.100, update: 2.892
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.530 ms                  | 213.221 ms                |
| bucket keys               | 2.996 ms                  | 4.818 ms                  |
| forward: a2a keys         | 5.857 ms                  | 48.750 ms                 |
| forward: search cache     | 353.375 us                | 620.320 us                |
| forward: a2a values       | 10.171 ms                 | 35.016 ms                 |
| forward: join             | 2.591 ms                  | 3.855 ms                  |
| Forward                   | 49.100 ms                 | 147.221 ms                |
| back: aggr dram keys      | 49.257 ms                 | 80.417 ms                 |
| back: set dram grad       | 4.087 ms                  | 10.943 ms                 |
| back: a2a grad            | 17.137 ms                 | 48.414 ms                 |
| back: grad sum & grad cache  | 25.980 ms                 | 96.338 ms                 |
| Backward                  | 194.536 ms                | 257.235 ms                |
| Optimize                  | 27.123 ms                 | 53.037 ms                 |
| BarrierTimeBeforeRank0    | 36.392 us                 | 96.638 us                 |
| BlockToStepN              | 32.248 us                 | 24.936 ms                 |
| OneStep                   | 289.055 ms                | 555.569 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.419 ms                  | 213.221 ms                |
| bucket keys               | 2.996 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.739 ms                  | 47.288 ms                 |
| forward: search cache     | 353.210 us                | 619.533 us                |
| forward: a2a values       | 8.825 ms                  | 34.998 ms                 |
| forward: join             | 2.591 ms                  | 3.632 ms                  |
| Forward                   | 48.853 ms                 | 147.221 ms                |
| back: aggr dram keys      | 49.257 ms                 | 79.116 ms                 |
| back: set dram grad       | 4.172 ms                  | 9.548 ms                  |
| back: a2a grad            | 14.807 ms                 | 46.483 ms                 |
| back: grad sum & grad cache  | 25.980 ms                 | 95.946 ms                 |
| Backward                  | 194.060 ms                | 257.235 ms                |
| Optimize                  | 27.195 ms                 | 53.037 ms                 |
| BarrierTimeBeforeRank0    | 36.145 us                 | 96.638 us                 |
| BlockToStepN              | 31.907 us                 | 24.936 ms                 |
| OneStep                   | 287.514 ms                | 555.569 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.790 ms                  | 202.146 ms                |
| bucket keys               | 2.996 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.711 ms                  | 47.288 ms                 |
| forward: search cache     | 353.210 us                | 619.533 us                |
| forward: a2a values       | 8.442 ms                  | 34.998 ms                 |
| forward: join             | 2.638 ms                  | 3.632 ms                  |
| Forward                   | 48.728 ms                 | 147.114 ms                |
| back: aggr dram keys      | 49.943 ms                 | 80.455 ms                 |
| back: set dram grad       | 4.261 ms                  | 10.943 ms                 |
| back: a2a grad            | 14.360 ms                 | 46.483 ms                 |
| back: grad sum & grad cache  | 19.777 ms                 | 95.946 ms                 |
| Backward                  | 193.611 ms                | 255.475 ms                |
| Optimize                  | 27.273 ms                 | 53.037 ms                 |
| BarrierTimeBeforeRank0    | 35.935 us                 | 85.674 us                 |
| BlockToStepN              | 31.907 us                 | 24.063 ms                 |
| OneStep                   | 285.866 ms                | 553.002 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.292 ms                  | 202.146 ms                |
| bucket keys               | 2.997 ms                  | 4.280 ms                  |
| forward: a2a keys         | 5.674 ms                  | 47.288 ms                 |
| forward: search cache     | 353.210 us                | 619.533 us                |
| forward: a2a values       | 7.652 ms                  | 34.998 ms                 |
| forward: join             | 2.663 ms                  | 3.892 ms                  |
| Forward                   | 48.694 ms                 | 147.114 ms                |
| back: aggr dram keys      | 53.220 ms                 | 83.086 ms                 |
| back: set dram grad       | 4.326 ms                  | 10.943 ms                 |
| back: a2a grad            | 13.602 ms                 | 46.483 ms                 |
| back: grad sum & grad cache  | 18.843 ms                 | 95.946 ms                 |
| Backward                  | 193.339 ms                | 255.475 ms                |
| Optimize                  | 27.428 ms                 | 53.037 ms                 |
| BarrierTimeBeforeRank0    | 35.800 us                 | 85.674 us                 |
| BlockToStepN              | 30.546 us                 | 24.063 ms                 |
| OneStep                   | 285.123 ms                | 553.002 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.205 ms                  | 202.146 ms                |
| bucket keys               | 2.997 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.693 ms                  | 43.056 ms                 |
| forward: search cache     | 353.222 us                | 569.687 us                |
| forward: a2a values       | 7.590 ms                  | 31.767 ms                 |
| forward: join             | 2.680 ms                  | 3.885 ms                  |
| Forward                   | 48.619 ms                 | 147.114 ms                |
| back: aggr dram keys      | 53.737 ms                 | 82.658 ms                 |
| back: set dram grad       | 4.380 ms                  | 9.548 ms                  |
| back: a2a grad            | 13.267 ms                 | 45.481 ms                 |
| back: grad sum & grad cache  | 18.778 ms                 | 95.476 ms                 |
| Backward                  | 192.880 ms                | 255.475 ms                |
| Optimize                  | 27.570 ms                 | 54.613 ms                 |
| BarrierTimeBeforeRank0    | 35.695 us                 | 85.674 us                 |
| BlockToStepN              | 30.084 us                 | 24.063 ms                 |
| OneStep                   | 284.586 ms                | 553.002 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 26.762, sample: 0.886, forward: 5.494, backward: 13.812, update: 0.332
[proc 6] 400 steps, total: 26.762, sample: 0.946, forward: 5.480, backward: 13.790, update: 0.453
[proc 5] 400 steps, total: 26.762, sample: 0.937, forward: 5.481, backward: 13.809, update: 0.459
[proc 2] 400 steps, total: 26.762, sample: 0.894, forward: 5.580, backward: 13.827, update: 0.471
[proc 1] 400 steps, total: 26.762, sample: 1.288, forward: 5.056, backward: 14.326, update: 0.423
[proc 0] 400 steps, total: 26.762, sample: 1.242, forward: 4.750, backward: 16.862, update: 3.755
[proc 4] 400 steps, total: 26.762, sample: 0.934, forward: 5.507, backward: 13.648, update: 0.446
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.971 ms                  | 202.146 ms                |
| bucket keys               | 2.997 ms                  | 4.280 ms                  |
| forward: a2a keys         | 5.674 ms                  | 43.056 ms                 |
| forward: search cache     | 353.228 us                | 569.687 us                |
| forward: a2a values       | 7.582 ms                  | 34.998 ms                 |
| forward: join             | 2.693 ms                  | 3.995 ms                  |
| Forward                   | 48.358 ms                 | 147.114 ms                |
| back: aggr dram keys      | 53.790 ms                 | 82.658 ms                 |
| back: set dram grad       | 4.396 ms                  | 9.548 ms                  |
| back: a2a grad            | 12.238 ms                 | 45.481 ms                 |
| back: grad sum & grad cache  | 18.778 ms                 | 95.476 ms                 |
| Backward                  | 192.415 ms                | 255.475 ms                |
| Optimize                  | 27.661 ms                 | 54.613 ms                 |
| BarrierTimeBeforeRank0    | 35.689 us                 | 85.674 us                 |
| BlockToStepN              | 29.923 us                 | 24.063 ms                 |
| OneStep                   | 283.331 ms                | 553.002 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.662 ms                  | 202.146 ms                |
| bucket keys               | 2.998 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.545 ms                  | 40.588 ms                 |
| forward: search cache     | 353.222 us                | 516.954 us                |
| forward: a2a values       | 7.582 ms                  | 33.802 ms                 |
| forward: join             | 2.699 ms                  | 3.892 ms                  |
| Forward                   | 48.085 ms                 | 147.114 ms                |
| back: aggr dram keys      | 53.737 ms                 | 82.658 ms                 |
| back: set dram grad       | 4.414 ms                  | 9.548 ms                  |
| back: a2a grad            | 12.170 ms                 | 45.265 ms                 |
| back: grad sum & grad cache  | 18.778 ms                 | 94.128 ms                 |
| Backward                  | 192.017 ms                | 255.475 ms                |
| Optimize                  | 27.903 ms                 | 58.172 ms                 |
| BarrierTimeBeforeRank0    | 35.656 us                 | 85.674 us                 |
| BlockToStepN              | 29.409 us                 | 24.063 ms                 |
| OneStep                   | 282.472 ms                | 553.002 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.519 ms                  | 175.755 ms                |
| bucket keys               | 2.998 ms                  | 4.280 ms                  |
| forward: a2a keys         | 5.469 ms                  | 40.588 ms                 |
| forward: search cache     | 353.211 us                | 561.834 us                |
| forward: a2a values       | 7.582 ms                  | 34.998 ms                 |
| forward: join             | 2.704 ms                  | 4.220 ms                  |
| Forward                   | 47.868 ms                 | 114.275 ms                |
| back: aggr dram keys      | 53.790 ms                 | 82.658 ms                 |
| back: set dram grad       | 4.427 ms                  | 9.548 ms                  |
| back: a2a grad            | 12.159 ms                 | 45.265 ms                 |
| back: grad sum & grad cache  | 18.778 ms                 | 94.128 ms                 |
| Backward                  | 191.403 ms                | 255.475 ms                |
| Optimize                  | 28.422 ms                 | 58.172 ms                 |
| BarrierTimeBeforeRank0    | 35.522 us                 | 85.674 us                 |
| BlockToStepN              | 28.947 us                 | 24.063 ms                 |
| OneStep                   | 280.666 ms                | 553.002 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.415 ms                  | 175.755 ms                |
| bucket keys               | 2.998 ms                  | 4.280 ms                  |
| forward: a2a keys         | 5.410 ms                  | 43.056 ms                 |
| forward: search cache     | 353.223 us                | 569.687 us                |
| forward: a2a values       | 7.520 ms                  | 34.998 ms                 |
| forward: join             | 2.707 ms                  | 4.346 ms                  |
| Forward                   | 47.812 ms                 | 114.275 ms                |
| back: aggr dram keys      | 53.848 ms                 | 82.658 ms                 |
| back: set dram grad       | 4.434 ms                  | 10.574 ms                 |
| back: a2a grad            | 12.138 ms                 | 45.265 ms                 |
| back: grad sum & grad cache  | 18.778 ms                 | 94.128 ms                 |
| Backward                  | 190.992 ms                | 251.696 ms                |
| Optimize                  | 28.932 ms                 | 56.962 ms                 |
| BarrierTimeBeforeRank0    | 35.478 us                 | 80.805 us                 |
| BlockToStepN              | 28.906 us                 | 21.970 ms                 |
| OneStep                   | 279.963 ms                | 493.590 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.337 ms                  | 175.755 ms                |
| bucket keys               | 2.999 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.438 ms                  | 40.588 ms                 |
| forward: search cache     | 353.268 us                | 569.687 us                |
| forward: a2a values       | 7.509 ms                  | 33.802 ms                 |
| forward: join             | 2.709 ms                  | 4.346 ms                  |
| Forward                   | 47.789 ms                 | 114.275 ms                |
| back: aggr dram keys      | 53.906 ms                 | 81.572 ms                 |
| back: set dram grad       | 4.438 ms                  | 9.548 ms                  |
| back: a2a grad            | 12.103 ms                 | 44.228 ms                 |
| back: grad sum & grad cache  | 18.684 ms                 | 92.104 ms                 |
| Backward                  | 190.259 ms                | 251.696 ms                |
| Optimize                  | 29.368 ms                 | 56.962 ms                 |
| BarrierTimeBeforeRank0    | 35.469 us                 | 80.805 us                 |
| BlockToStepN              | 28.947 us                 | 21.970 ms                 |
| OneStep                   | 279.550 ms                | 493.590 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 26.262, sample: 1.106, forward: 4.796, backward: 14.860, update: 0.444
[proc 4] 500 steps, total: 26.262, sample: 0.871, forward: 5.139, backward: 14.425, update: 0.414
[proc 0] 500 steps, total: 26.262, sample: 1.022, forward: 4.612, backward: 16.483, update: 3.933
[proc 5] 500 steps, total: 26.262, sample: 0.936, forward: 5.062, backward: 14.634, update: 0.491
[proc 3] 500 steps, total: 26.262, sample: 0.924, forward: 5.048, backward: 14.535, update: 0.472
Successfully xmh. training takes 151.09360027313232 seconds
[proc 2] 500 steps, total: 26.262, sample: 0.877, forward: 5.147, backward: 14.536, update: 0.523
[proc 6] 500 steps, total: 26.262, sample: 0.905, forward: 5.098, backward: 14.528, update: 0.503
before call kg_cache_controller.StopThreads()
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
INFO [59388 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.070 ms                  | 175.755 ms                |
| bucket keys               | 3.002 ms                  | 4.277 ms                  |
| forward: a2a keys         | 5.438 ms                  | 40.588 ms                 |
| forward: search cache     | 353.344 us                | 569.687 us                |
| forward: a2a values       | 7.404 ms                  | 33.802 ms                 |
| forward: join             | 2.712 ms                  | 4.352 ms                  |
| Forward                   | 47.763 ms                 | 114.275 ms                |
| back: aggr dram keys      | 53.906 ms                 | 81.572 ms                 |
| back: set dram grad       | 4.447 ms                  | 9.548 ms                  |
| back: a2a grad            | 12.089 ms                 | 44.228 ms                 |
| back: grad sum & grad cache  | 18.684 ms                 | 92.104 ms                 |
| Backward                  | 189.814 ms                | 251.696 ms                |
| Optimize                  | 29.576 ms                 | 56.962 ms                 |
| BarrierTimeBeforeRank0    | 35.357 us                 | 80.805 us                 |
| BlockToStepN              | 28.999 us                 | 24.063 ms                 |
| OneStep                   | 278.957 ms                | 493.590 ms                |
+---------------------------+---------------------------+---------------------------+
