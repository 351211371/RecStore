WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 21:46:53.165699 23967 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_45', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=5, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=5, gpu=[0, 1, 2, 3, 4], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='None', use_my_emb=False, cache_ratio=0.05, shuffle=False, backwardMode='CppSync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [23967 sampler.py:454] Start PreSampling
WARNING [23967 sampler.py:532] Before construct renumbering_dict
WARNING [23967 sampler.py:555] PreSampling done
W20240205 21:46:57.733666 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 21:46:57.733965 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 21:46:57.734001 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 21:46:57.734040 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 21:46:57.734069 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 21:46:57.734102 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 21:46:57.734134 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 21:46:57.734169 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 21:46:57.734200 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 21:46:57.734225 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 21:46:57.734261 23967 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 21:46:57.734287 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 21:46:57.734309 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 21:46:57.734480 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 21:46:57.734522 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 21:46:57.734560 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 21:46:57.734604 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 21:46:57.734637 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 21:46:57.734660 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 21:46:57.734690 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 21:46:57.734732 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 21:46:57.734760 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 21:46:57.734784 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 21:46:57.734833 23967 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 21:46:57.734856 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 21:46:57.734884 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 21:46:57.734938 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 21:46:57.734979 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 21:46:57.735006 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 21:46:57.735030 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 21:46:57.735056 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 21:46:57.735080 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 21:46:57.735121 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 21:46:57.735162 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 21:46:57.735185 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 21:46:57.735209 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 21:46:57.735252 23967 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 21:46:57.735275 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 21:46:57.735301 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 21:46:57.735347 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 21:46:57.735374 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 21:46:57.735399 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 21:46:57.735430 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 21:46:57.735455 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 21:46:57.735496 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 21:46:57.735529 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 21:46:57.735553 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 21:46:57.735589 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 21:46:57.735620 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 21:46:57.735651 23967 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 21:46:57.735672 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 21:46:57.735693 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 21:46:57.735744 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 21:46:57.735772 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 21:46:57.735796 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 21:46:57.735831 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 21:46:57.735880 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 21:46:57.735906 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 21:46:57.735931 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 21:46:57.735987 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 21:46:57.736019 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 21:46:57.736044 23967 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 21:46:57.736105 23967 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 21:46:57.736128 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 21:46:57.736150 23967 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
{0: Graph(num_nodes=10222, num_edges=137205,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=7861, num_edges=113516,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10587, num_edges=145765,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9264, num_edges=181068,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10248, num_edges=191956,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10222 N 137205 E
MertisPartition: part 1 has 7861 N 113516 E
MertisPartition: part 2 has 10587 N 145765 E
MertisPartition: part 3 has 9264 N 181068 E
MertisPartition: part 4 has 10248 N 191956 E
Rank0: cached key size 149
Rank1: cached key size 149
Rank2: cached key size 149
Rank3: cached key size 149
Rank4: cached key size 149
Before renumbering graph:  {'_ID': tensor([    7,    16,    18,  ..., 13890,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([ 1003,  1302,  1358,  ..., 11568,  2261, 10717]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=10222, num_edges=137205,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10222, num_edges=137205,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 4.937 seconds
[Rank1] pid = 24170
[Rank2] pid = 24184
[Rank3] pid = 24298
INFO [23967 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [24170 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [24298 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [24299 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [24184 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [24298 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [24299 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [24184 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [23967 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [24170 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
E20240205 21:47:00.061923 24171 recstore.cc:66] init folly done
E20240205 21:47:00.062022 24363 recstore.cc:66] init folly done
E20240205 21:47:00.061975 24370 recstore.cc:66] init folly done
E20240205 21:47:00.062094 24235 recstore.cc:66] init folly done
E20240205 21:47:00.062319 24300 recstore.cc:66] init folly done
I20240205 21:47:00.143143 24171 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 5
I20240205 21:47:00.147116 24235 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240205 21:47:00.149406 24363 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240205 21:47:00.149456 24300 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240205 21:47:00.150413 24370 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 3.698, sample: 0.436, forward: 1.214, backward: 0.853, update: 0.855
[Rank4] pid = 24299
train_sampler.Prefill()
-------Step 0-------
tensor([12043,    35, 11642, 11834,   108,    47,  8371, 14945,  3335, 12526]) tensor([ 1358,  1806,   132,  4015,  4495, 10232,   449,  3105,  5431, 14443])
-------Step 1-------
tensor([12043,    35, 11642, 11834,   108,    47,  8371, 14945,  3335, 12526]) tensor([  186, 10020,  3517, 14251, 13801, 13865,  4421,  4227,  9682,  4966])
-------Step 2-------
tensor([   86, 11783,  4283, 14340,  8938, 11293, 13523, 12746,  5365,   115]) tensor([10301,  5815,  7254,  6627,  7340,  1143,  2466,   691, 10997,  1585])
-------Step 3-------
tensor([   86, 11783,  4283, 14340,  8938, 11293, 13523, 12746,  5365,   115]) tensor([14223,  1554,  7497,  7718, 14094,   425, 11849,  6281,   391,  2361])
-------Step 4-------
tensor([10413, 11052, 13898,  9811,  2043,  7331,  8524,  5067,  7970,  2406]) tensor([  447,  3045,   993,  7259,  6383, 12713, 13094,  5403,  4243,   503])
-------Step 5-------
tensor([10413, 11052, 13898,  9811,  2043,  7331,  8524,  5067,  7970,  2406]) tensor([11308, 13323,  3576,  8483,  4434,  1138,  3895,  5260,  4798, 14015])
-------Step 6-------
tensor([  954,   317,  4566,  2960,   124, 12722, 14340,    53,   777, 11682]) tensor([14096, 12235, 13403,  9396,  4029,  2442,  3277, 13623, 12682,  3672])
-------Step 7-------
tensor([  954,   317,  4566,  2960,   124, 12722, 14340,    53,   777, 11682]) tensor([ 5626,  8822,  4085, 14925,   277, 11879, 12104, 12624,  6250,  9346])
-------Step 8-------
tensor([ 9223, 10939,   792,  6630,  4310,    85, 13922,  7381,  5185,  3491]) tensor([ 1410,   968,  6068, 11213,  7187,  8108,  6862, 12684, 14538,  1012])
-------Step 9-------
tensor([ 9223, 10939,   792,  6630,  4310,    85, 13922,  7381,  5185,  3491]) tensor([ 8503,  3774, 12952,  6351, 13792, 11779,  5019, 14687,  7786,   641])
before start barrier
start train
[proc 0] 100 steps, total: 3.695, sample: 0.423, forward: 1.195, backward: 0.791, update: 0.874
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 3.702, sample: 0.417, forward: 1.209, backward: 0.852, update: 0.843
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 3.695, sample: 0.438, forward: 1.180, backward: 0.868, update: 0.902
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 3.694, sample: 0.422, forward: 1.224, backward: 0.845, update: 0.917
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.267 ms                  | 32.909 ms                 |
| Forward                   | 8.155 ms                  | 17.664 ms                 |
| Backward                  | 6.871 ms                  | 10.323 ms                 |
| Optimize                  | 8.080 ms                  | 14.229 ms                 |
| OneStep                   | 27.296 ms                 | 62.476 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 3.642, sample: 0.514, forward: 0.870, backward: 0.574, update: 0.809
[proc 2] 200 steps, total: 3.642, sample: 0.513, forward: 0.908, backward: 0.504, update: 0.823
[proc 4] 200 steps, total: 3.642, sample: 0.498, forward: 0.884, backward: 0.682, update: 0.876
[proc 0] 200 steps, total: 3.642, sample: 0.519, forward: 0.882, backward: 0.676, update: 0.911
[proc 3] 200 steps, total: 3.642, sample: 0.472, forward: 0.883, backward: 0.678, update: 0.899
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.511 ms                  | 33.826 ms                 |
| Forward                   | 8.415 ms                  | 14.928 ms                 |
| Backward                  | 6.942 ms                  | 10.323 ms                 |
| Optimize                  | 8.392 ms                  | 16.515 ms                 |
| OneStep                   | 31.033 ms                 | 62.476 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 4] 300 steps, total: 3.890, sample: 0.441, forward: 0.937, backward: 0.685, update: 0.883
[proc 3] 300 steps, total: 3.890, sample: 0.536, forward: 0.926, backward: 0.679, update: 0.931
[proc 1] 300 steps, total: 3.890, sample: 0.473, forward: 0.864, backward: 0.376, update: 0.746
[proc 2] 300 steps, total: 3.890, sample: 0.531, forward: 0.902, backward: 0.326, update: 0.790
[proc 0] 300 steps, total: 3.890, sample: 0.558, forward: 0.930, backward: 0.686, update: 0.889
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.518 ms                  | 38.192 ms                 |
| Forward                   | 8.420 ms                  | 17.519 ms                 |
| Backward                  | 6.957 ms                  | 10.323 ms                 |
| Optimize                  | 8.328 ms                  | 17.875 ms                 |
| OneStep                   | 32.313 ms                 | 64.039 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 3.799, sample: 0.450, forward: 0.850, backward: 0.311, update: 0.706
[proc 0] 400 steps, total: 3.798, sample: 0.572, forward: 0.878, backward: 0.671, update: 0.907
[proc 4] 400 steps, total: 3.799, sample: 0.457, forward: 0.884, backward: 0.688, update: 0.875
[proc 2] 400 steps, total: 3.799, sample: 0.485, forward: 0.852, backward: 0.314, update: 0.725
[proc 3] 400 steps, total: 3.799, sample: 0.487, forward: 0.914, backward: 0.674, update: 0.896
[proc 4] 500 steps, total: 3.800, sample: 0.515, forward: 0.912, backward: 0.577, update: 0.883
[proc 2] 500 steps, total: 3.800, sample: 0.421, forward: 0.844, backward: 0.335, update: 0.737
[proc 1] 500 steps, total: 3.800, sample: 0.421, forward: 0.859, backward: 0.320, update: 0.722
[proc 0] 500 steps, total: 3.800, sample: 0.503, forward: 0.902, backward: 0.710, update: 0.931
[proc 3] 500 steps, total: 3.800, sample: 0.511, forward: 0.939, backward: 0.680, update: 0.942
Successfully xmh. training takes 18.825902700424194 seconds
before call kg_cache_controller.StopThreads()
KGCacheControllerWrapperDummy.StopThreads
