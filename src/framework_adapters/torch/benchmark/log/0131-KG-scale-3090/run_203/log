WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 13:28:33.078696 19654 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_5', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [19654 sampler.py:454] Start PreSampling
WARNING [19654 sampler.py:532] Before construct renumbering_dict
WARNING [19654 sampler.py:555] PreSampling done
W20240206 13:47:51.254932 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 13:47:51.255125 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 13:47:51.255172 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 13:47:51.255200 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 13:47:51.255234 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 13:47:51.255270 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 13:47:51.255296 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 13:47:51.255342 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 13:47:51.255381 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 13:47:51.255414 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 13:47:51.255460 19654 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 13:47:51.255488 19654 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 13:47:51.255519 19654 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 13:47:51.255681 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 13:47:51.255723 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 13:47:51.255761 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 13:47:51.255800 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 13:47:51.255833 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 13:47:51.255867 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 13:47:51.255906 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 13:47:51.255946 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 13:47:51.255985 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 13:47:51.256023 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 13:47:51.256062 19654 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 13:47:51.256088 19654 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 13:47:51.256119 19654 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 13:47:51.256181 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 13:47:51.256217 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 13:47:51.256244 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 13:47:51.256275 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 13:47:51.256306 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 13:47:51.256337 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 13:47:51.256369 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 13:47:51.256400 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 13:47:51.256435 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 13:47:51.256469 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 13:47:51.256501 19654 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 13:47:51.256525 19654 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 13:47:51.256549 19654 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 13:47:51.256605 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 13:47:51.256644 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 13:47:51.256673 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 13:47:51.256705 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 13:47:51.256736 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 13:47:51.256770 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 13:47:51.256803 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 13:47:51.256834 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 13:47:51.256866 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 13:47:51.256907 19654 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 13:47:51.256940 19654 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 13:47:51.256965 19654 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 13:47:51.256997 19654 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 13:47:51.724849 19654 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240206 13:56:28.865814 19654 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4302727,  4302784,   132471,  ..., 50776446, 16731141,  2451468]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2182.480 seconds
[Rank1] pid = 20740
[Rank2] pid = 20836
INFO [19654 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [20836 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [20740 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [20903 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [19654 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [20903 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [20836 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [20740 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [19654 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [20836 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [20740 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [20903 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 14:05:09.986829 20904 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240206 14:05:09.987043 20967 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240206 14:05:09.987237 20837 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240206 14:05:09.987402 20741 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240206 14:05:11.468891 20904 recstore.cc:66] init folly done
E20240206 14:05:11.469336 20967 recstore.cc:66] init folly done
E20240206 14:05:11.469363 20837 recstore.cc:66] init folly done
E20240206 14:05:11.469373 20741 recstore.cc:66] init folly done
I20240206 14:05:22.737282 20904 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240206 14:05:25.673209 20741 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240206 14:05:26.059789 20967 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240206 14:05:26.271613 20837 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 21.249 ms                 | 114.098 ms                |
| bucket keys               | 1.913 ms                  | 115.394 ms                |
| forward: a2a keys         | 2.700 ms                  | 831.662 ms                |
| forward: search cache     | 245.640 us                | 21.311 ms                 |
| forward: a2a values       | 2.087 ms                  | 25.467 ms                 |
| forward: join             | 1.580 ms                  | 2.965 ms                  |
| Forward                   | 34.084 ms                 | 1.325 s                   |
| back: aggr dram keys      | 43.177 ms                 | 469.597 ms                |
| back: set dram grad       | 1.905 ms                  | 9.144 ms                  |
| back: a2a grad            | 5.507 ms                  | 23.258 ms                 |
| back: grad sum & grad cache  | 2.360 ms                  | 57.517 ms                 |
| Backward                  | 140.080 ms                | 751.913 ms                |
| Optimize                  | 21.340 ms                 | 52.630 ms                 |
| BarrierTimeBeforeRank0    | 57.003 us                 | 66.014 us                 |
| BlockToStepN              | 41.157 us                 | 16.236 ms                 |
| OneStep                   | 219.115 ms                | 2.157 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.239 ms                 | 114.098 ms                |
| bucket keys               | 2.657 ms                  | 24.158 ms                 |
| forward: a2a keys         | 2.808 ms                  | 282.476 ms                |
| forward: search cache     | 241.888 us                | 322.620 us                |
| forward: a2a values       | 4.047 ms                  | 25.467 ms                 |
| forward: join             | 1.580 ms                  | 3.002 ms                  |
| Forward                   | 34.084 ms                 | 1.325 s                   |
| back: aggr dram keys      | 43.177 ms                 | 77.156 ms                 |
| back: set dram grad       | 3.360 ms                  | 8.559 ms                  |
| back: a2a grad            | 6.809 ms                  | 13.131 ms                 |
| back: grad sum & grad cache  | 2.870 ms                  | 47.937 ms                 |
| Backward                  | 122.535 ms                | 751.913 ms                |
| Optimize                  | 21.340 ms                 | 52.630 ms                 |
| BarrierTimeBeforeRank0    | 49.277 us                 | 91.797 us                 |
| BlockToStepN              | 24.477 us                 | 16.236 ms                 |
| OneStep                   | 192.352 ms                | 2.157 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.130 ms                  | 97.481 ms                 |
| bucket keys               | 2.644 ms                  | 24.158 ms                 |
| forward: a2a keys         | 2.708 ms                  | 282.476 ms                |
| forward: search cache     | 239.837 us                | 322.620 us                |
| forward: a2a values       | 4.047 ms                  | 25.467 ms                 |
| forward: join             | 1.580 ms                  | 3.002 ms                  |
| Forward                   | 33.176 ms                 | 311.543 ms                |
| back: aggr dram keys      | 40.010 ms                 | 77.156 ms                 |
| back: set dram grad       | 3.360 ms                  | 8.559 ms                  |
| back: a2a grad            | 6.809 ms                  | 23.258 ms                 |
| back: grad sum & grad cache  | 2.870 ms                  | 47.937 ms                 |
| Backward                  | 121.913 ms                | 153.405 ms                |
| Optimize                  | 21.196 ms                 | 32.392 ms                 |
| BarrierTimeBeforeRank0    | 45.888 us                 | 83.820 us                 |
| BlockToStepN              | 24.160 us                 | 15.848 ms                 |
| OneStep                   | 188.314 ms                | 564.708 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.990 ms                  | 97.481 ms                 |
| bucket keys               | 2.587 ms                  | 3.811 ms                  |
| forward: a2a keys         | 2.178 ms                  | 80.561 ms                 |
| forward: search cache     | 234.160 us                | 313.579 us                |
| forward: a2a values       | 4.047 ms                  | 15.641 ms                 |
| forward: join             | 1.580 ms                  | 2.965 ms                  |
| Forward                   | 32.256 ms                 | 311.543 ms                |
| back: aggr dram keys      | 40.010 ms                 | 71.525 ms                 |
| back: set dram grad       | 3.384 ms                  | 8.473 ms                  |
| back: a2a grad            | 6.809 ms                  | 18.853 ms                 |
| back: grad sum & grad cache  | 2.870 ms                  | 45.847 ms                 |
| Backward                  | 120.592 ms                | 153.405 ms                |
| Optimize                  | 21.096 ms                 | 32.392 ms                 |
| BarrierTimeBeforeRank0    | 43.853 us                 | 83.820 us                 |
| BlockToStepN              | 23.847 us                 | 15.848 ms                 |
| OneStep                   | 185.370 ms                | 564.708 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 22.114, sample: 1.447, forward: 6.262, backward: 9.414, update: 0.432
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 22.712, sample: 1.589, forward: 6.083, backward: 9.784, update: 0.413
[Rank3] pid = 20903
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
train_sampler.Prefill()
-------Step 0-------
tensor([   57128,   715335, 54600567,   973814,   469059,   715371,   715387,
          269398,    57162,    57184]) tensor([ 4990467, 34512514, 27329420, 63287924, 61854091, 33667608, 81663819,
        60716852, 45510122, 68504146])
-------Step 1-------
tensor([   57128,   715335, 54600567,   973814,   469059,   715371,   715387,
          269398,    57162,    57184]) tensor([23428532, 78214470, 64797357, 11416285, 68986914,  9243511, 71367767,
        76682514, 21390158, 39097219])
-------Step 2-------
tensor([  813319,    70391, 78153090,    70438,   813350,   813379,   813416,
        50230933,   813458,   813491]) tensor([42220354,  5000006, 47998662, 11148900, 13169968, 10696229, 49035088,
        11886337, 47423511, 27055477])
-------Step 3-------
tensor([  813319,    70391, 78153090,    70438,   813350,   813379,   813416,
        50230933,   813458,   813491]) tensor([25345223, 53204945, 83667939, 30892073, 17635567, 56390707, 77910232,
        51912791, 30915987, 82267601])
-------Step 4-------
tensor([874772,  84398, 874792, 874819,  84423, 874839,  84472, 874854,  84506,
        874872]) tensor([55309402, 47289162, 19156297, 15592045, 66825655, 36961322, 84134423,
        57991473, 46505418,  8177477])
-------Step 5-------
tensor([874772,  84398, 874792, 874819,  84423, 874839,  84472, 874854,  84506,
        874872]) tensor([38698314, 37553052, 69443940, 10261472, 43615698, 36879978, 44075733,
        57292403, 85399669,   357197])
-------Step 6-------
tensor([74735280,   924508,   924522,   924536,  4310712,   924552,   924570,
          924588,   924603,   275863]) tensor([21789519, 35597603, 31876420, 16838053, 79873999, 46483386, 49676189,
        18026690, 55237400,  7395249])
-------Step 7-------
tensor([74735280,   924508,   924522,   924536,  4310712,   924552,   924570,
          924588,   924603,   275863]) tensor([46912990, 82221541, 61633406, 76387624, 56442513,  1790712, 19457237,
        58219352, 24582420, 18829600])
-------Step 8-------
tensor([  965659,   112678,   965678, 27497309,  1001271,   965690,   965704,
          965716,   277887,  1001290]) tensor([29447428, 65624360, 57468088, 72821503, 82980219, 64892444, 70958985,
        65708639, 11652255,  3240822])
-------Step 9-------
tensor([  965659,   112678,   965678, 27497309,  1001271,   965690,   965704,
          965716,   277887,  1001290]) tensor([77627980, 53152744, 30531370, 33885525, 14359067,   824735, 23183345,
        15920427, 84209851, 37319476])
before start barrier
start train
[proc 0] 100 steps, total: 22.325, sample: 1.535, forward: 5.414, backward: 12.920, update: 2.114
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 25.648, sample: 1.685, forward: 6.029, backward: 9.421, update: 0.326
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.432 ms                  | 97.481 ms                 |
| bucket keys               | 2.609 ms                  | 3.811 ms                  |
| forward: a2a keys         | 2.025 ms                  | 80.561 ms                 |
| forward: search cache     | 232.637 us                | 322.620 us                |
| forward: a2a values       | 4.047 ms                  | 29.576 ms                 |
| forward: join             | 1.580 ms                  | 3.002 ms                  |
| Forward                   | 32.239 ms                 | 311.543 ms                |
| back: aggr dram keys      | 38.480 ms                 | 71.525 ms                 |
| back: set dram grad       | 3.428 ms                  | 8.559 ms                  |
| back: a2a grad            | 10.637 ms                 | 21.480 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.847 ms                 |
| Backward                  | 120.593 ms                | 153.405 ms                |
| Optimize                  | 21.076 ms                 | 32.392 ms                 |
| BarrierTimeBeforeRank0    | 43.564 us                 | 83.820 us                 |
| BlockToStepN              | 23.523 us                 | 15.848 ms                 |
| OneStep                   | 185.370 ms                | 564.708 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.402 ms                  | 97.481 ms                 |
| bucket keys               | 2.627 ms                  | 3.811 ms                  |
| forward: a2a keys         | 1.995 ms                  | 80.561 ms                 |
| forward: search cache     | 229.341 us                | 322.620 us                |
| forward: a2a values       | 4.047 ms                  | 25.467 ms                 |
| forward: join             | 1.636 ms                  | 3.014 ms                  |
| Forward                   | 31.892 ms                 | 311.543 ms                |
| back: aggr dram keys      | 38.480 ms                 | 71.525 ms                 |
| back: set dram grad       | 3.429 ms                  | 8.559 ms                  |
| back: a2a grad            | 10.631 ms                 | 25.372 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 42.463 ms                 |
| Backward                  | 120.842 ms                | 153.405 ms                |
| Optimize                  | 21.055 ms                 | 32.392 ms                 |
| BarrierTimeBeforeRank0    | 42.916 us                 | 83.820 us                 |
| BlockToStepN              | 23.364 us                 | 15.848 ms                 |
| OneStep                   | 183.909 ms                | 564.708 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.402 ms                  | 97.481 ms                 |
| bucket keys               | 2.627 ms                  | 3.985 ms                  |
| forward: a2a keys         | 2.038 ms                  | 80.561 ms                 |
| forward: search cache     | 228.956 us                | 322.620 us                |
| forward: a2a values       | 4.047 ms                  | 25.467 ms                 |
| forward: join             | 1.636 ms                  | 3.014 ms                  |
| Forward                   | 32.137 ms                 | 148.877 ms                |
| back: aggr dram keys      | 41.724 ms                 | 71.525 ms                 |
| back: set dram grad       | 3.432 ms                  | 8.559 ms                  |
| back: a2a grad            | 10.284 ms                 | 25.372 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 42.463 ms                 |
| Backward                  | 120.627 ms                | 152.723 ms                |
| Optimize                  | 21.038 ms                 | 31.139 ms                 |
| BarrierTimeBeforeRank0    | 42.916 us                 | 91.797 us                 |
| BlockToStepN              | 23.268 us                 | 12.527 ms                 |
| OneStep                   | 183.474 ms                | 369.387 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.110 ms                  | 97.481 ms                 |
| bucket keys               | 2.627 ms                  | 3.985 ms                  |
| forward: a2a keys         | 2.029 ms                  | 71.923 ms                 |
| forward: search cache     | 228.711 us                | 322.620 us                |
| forward: a2a values       | 7.965 ms                  | 23.111 ms                 |
| forward: join             | 1.636 ms                  | 3.014 ms                  |
| Forward                   | 32.201 ms                 | 148.877 ms                |
| back: aggr dram keys      | 41.625 ms                 | 64.263 ms                 |
| back: set dram grad       | 3.435 ms                  | 8.473 ms                  |
| back: a2a grad            | 10.190 ms                 | 23.258 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 42.463 ms                 |
| Backward                  | 120.515 ms                | 152.723 ms                |
| Optimize                  | 21.002 ms                 | 31.139 ms                 |
| BarrierTimeBeforeRank0    | 42.725 us                 | 91.797 us                 |
| BlockToStepN              | 23.144 us                 | 12.527 ms                 |
| OneStep                   | 183.121 ms                | 369.387 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 19.530, sample: 1.708, forward: 4.103, backward: 8.897, update: 0.377
[proc 3] 200 steps, total: 19.530, sample: 1.536, forward: 4.358, backward: 8.838, update: 0.274
[proc 1] 200 steps, total: 19.530, sample: 1.690, forward: 4.122, backward: 9.218, update: 0.352
[proc 0] 200 steps, total: 19.530, sample: 1.404, forward: 3.824, backward: 12.150, update: 2.033
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.821 ms                  | 97.481 ms                 |
| bucket keys               | 2.609 ms                  | 4.173 ms                  |
| forward: a2a keys         | 2.029 ms                  | 71.923 ms                 |
| forward: search cache     | 227.986 us                | 322.620 us                |
| forward: a2a values       | 7.925 ms                  | 23.111 ms                 |
| forward: join             | 1.636 ms                  | 3.014 ms                  |
| Forward                   | 32.201 ms                 | 148.877 ms                |
| back: aggr dram keys      | 41.625 ms                 | 64.263 ms                 |
| back: set dram grad       | 3.433 ms                  | 8.473 ms                  |
| back: a2a grad            | 10.190 ms                 | 23.258 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.847 ms                 |
| Backward                  | 120.515 ms                | 152.723 ms                |
| Optimize                  | 20.983 ms                 | 31.139 ms                 |
| BarrierTimeBeforeRank0    | 42.675 us                 | 91.797 us                 |
| BlockToStepN              | 23.346 us                 | 14.172 ms                 |
| OneStep                   | 182.009 ms                | 369.387 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.901 ms                  | 97.481 ms                 |
| bucket keys               | 2.587 ms                  | 4.173 ms                  |
| forward: a2a keys         | 2.018 ms                  | 71.244 ms                 |
| forward: search cache     | 227.671 us                | 321.094 us                |
| forward: a2a values       | 7.925 ms                  | 15.641 ms                 |
| forward: join             | 1.636 ms                  | 3.032 ms                  |
| Forward                   | 32.067 ms                 | 148.877 ms                |
| back: aggr dram keys      | 39.834 ms                 | 64.263 ms                 |
| back: set dram grad       | 3.433 ms                  | 8.436 ms                  |
| back: a2a grad            | 10.191 ms                 | 25.259 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.422 ms                 |
| Backward                  | 120.357 ms                | 153.317 ms                |
| Optimize                  | 20.983 ms                 | 32.392 ms                 |
| BarrierTimeBeforeRank0    | 42.449 us                 | 91.797 us                 |
| BlockToStepN              | 23.268 us                 | 15.848 ms                 |
| OneStep                   | 182.009 ms                | 369.387 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.901 ms                  | 95.155 ms                 |
| bucket keys               | 2.586 ms                  | 4.173 ms                  |
| forward: a2a keys         | 1.994 ms                  | 71.923 ms                 |
| forward: search cache     | 227.544 us                | 322.620 us                |
| forward: a2a values       | 7.925 ms                  | 15.641 ms                 |
| forward: join             | 1.636 ms                  | 3.332 ms                  |
| Forward                   | 31.896 ms                 | 138.579 ms                |
| back: aggr dram keys      | 39.834 ms                 | 64.263 ms                 |
| back: set dram grad       | 3.430 ms                  | 8.459 ms                  |
| back: a2a grad            | 10.191 ms                 | 25.277 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.847 ms                 |
| Backward                  | 120.269 ms                | 152.723 ms                |
| Optimize                  | 21.011 ms                 | 31.139 ms                 |
| BarrierTimeBeforeRank0    | 42.650 us                 | 141.127 us                |
| BlockToStepN              | 23.346 us                 | 14.172 ms                 |
| OneStep                   | 181.751 ms                | 365.422 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.792 ms                  | 95.155 ms                 |
| bucket keys               | 2.586 ms                  | 4.133 ms                  |
| forward: a2a keys         | 1.969 ms                  | 71.923 ms                 |
| forward: search cache     | 227.342 us                | 321.094 us                |
| forward: a2a values       | 7.925 ms                  | 12.508 ms                 |
| forward: join             | 1.636 ms                  | 3.032 ms                  |
| Forward                   | 31.929 ms                 | 138.579 ms                |
| back: aggr dram keys      | 39.834 ms                 | 64.263 ms                 |
| back: set dram grad       | 3.433 ms                  | 8.436 ms                  |
| back: a2a grad            | 10.195 ms                 | 25.277 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.422 ms                 |
| Backward                  | 119.978 ms                | 153.317 ms                |
| Optimize                  | 20.991 ms                 | 31.139 ms                 |
| BarrierTimeBeforeRank0    | 42.408 us                 | 141.127 us                |
| BlockToStepN              | 23.187 us                 | 15.848 ms                 |
| OneStep                   | 181.646 ms                | 365.422 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 19.286, sample: 1.101, forward: 4.368, backward: 8.888, update: 0.323
[proc 2] 300 steps, total: 19.287, sample: 1.541, forward: 3.912, backward: 8.906, update: 0.356
[proc 1] 300 steps, total: 19.286, sample: 1.356, forward: 4.058, backward: 9.236, update: 0.358
[proc 0] 300 steps, total: 19.286, sample: 1.211, forward: 3.688, backward: 12.160, update: 2.056
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.700 ms                  | 95.155 ms                 |
| bucket keys               | 2.586 ms                  | 4.133 ms                  |
| forward: a2a keys         | 1.953 ms                  | 91.017 ms                 |
| forward: search cache     | 227.325 us                | 321.094 us                |
| forward: a2a values       | 7.925 ms                  | 12.508 ms                 |
| forward: join             | 1.636 ms                  | 3.143 ms                  |
| Forward                   | 31.942 ms                 | 148.877 ms                |
| back: aggr dram keys      | 40.010 ms                 | 64.263 ms                 |
| back: set dram grad       | 3.439 ms                  | 8.436 ms                  |
| back: a2a grad            | 10.195 ms                 | 25.277 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.847 ms                 |
| Backward                  | 119.958 ms                | 153.317 ms                |
| Optimize                  | 20.983 ms                 | 32.392 ms                 |
| BarrierTimeBeforeRank0    | 42.282 us                 | 141.127 us                |
| BlockToStepN              | 23.025 us                 | 15.848 ms                 |
| OneStep                   | 181.751 ms                | 365.422 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.717 ms                  | 95.155 ms                 |
| bucket keys               | 2.586 ms                  | 4.065 ms                  |
| forward: a2a keys         | 1.917 ms                  | 80.561 ms                 |
| forward: search cache     | 227.320 us                | 313.579 us                |
| forward: a2a values       | 7.925 ms                  | 12.508 ms                 |
| forward: join             | 1.636 ms                  | 3.332 ms                  |
| Forward                   | 31.892 ms                 | 148.877 ms                |
| back: aggr dram keys      | 40.010 ms                 | 64.159 ms                 |
| back: set dram grad       | 3.441 ms                  | 8.436 ms                  |
| back: a2a grad            | 10.197 ms                 | 25.259 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.847 ms                 |
| Backward                  | 119.723 ms                | 153.405 ms                |
| Optimize                  | 21.011 ms                 | 36.925 ms                 |
| BarrierTimeBeforeRank0    | 41.993 us                 | 141.127 us                |
| BlockToStepN              | 22.905 us                 | 15.848 ms                 |
| OneStep                   | 181.300 ms                | 365.422 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.732 ms                  | 90.787 ms                 |
| bucket keys               | 2.586 ms                  | 4.065 ms                  |
| forward: a2a keys         | 1.839 ms                  | 80.561 ms                 |
| forward: search cache     | 227.192 us                | 313.579 us                |
| forward: a2a values       | 7.381 ms                  | 12.508 ms                 |
| forward: join             | 1.636 ms                  | 3.332 ms                  |
| Forward                   | 31.838 ms                 | 138.579 ms                |
| back: aggr dram keys      | 40.010 ms                 | 64.159 ms                 |
| back: set dram grad       | 3.444 ms                  | 8.436 ms                  |
| back: a2a grad            | 10.197 ms                 | 25.259 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.847 ms                 |
| Backward                  | 119.647 ms                | 153.317 ms                |
| Optimize                  | 21.011 ms                 | 32.392 ms                 |
| BarrierTimeBeforeRank0    | 42.208 us                 | 141.127 us                |
| BlockToStepN              | 22.754 us                 | 14.172 ms                 |
| OneStep                   | 181.186 ms                | 359.559 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.700 ms                  | 90.787 ms                 |
| bucket keys               | 2.587 ms                  | 4.065 ms                  |
| forward: a2a keys         | 1.837 ms                  | 80.490 ms                 |
| forward: search cache     | 227.152 us                | 313.579 us                |
| forward: a2a values       | 7.719 ms                  | 12.834 ms                 |
| forward: join             | 1.798 ms                  | 3.332 ms                  |
| Forward                   | 31.787 ms                 | 138.579 ms                |
| back: aggr dram keys      | 40.010 ms                 | 63.525 ms                 |
| back: set dram grad       | 3.442 ms                  | 8.436 ms                  |
| back: a2a grad            | 10.214 ms                 | 25.372 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.422 ms                 |
| Backward                  | 119.647 ms                | 153.317 ms                |
| Optimize                  | 21.002 ms                 | 32.392 ms                 |
| BarrierTimeBeforeRank0    | 42.057 us                 | 141.127 us                |
| BlockToStepN              | 22.714 us                 | 14.172 ms                 |
| OneStep                   | 181.263 ms                | 359.559 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 19.152, sample: 1.343, forward: 3.999, backward: 9.298, update: 0.342
[proc 2] 400 steps, total: 19.152, sample: 1.528, forward: 3.818, backward: 8.995, update: 0.376
[proc 3] 400 steps, total: 19.152, sample: 1.046, forward: 4.335, backward: 8.966, update: 0.430
[proc 0] 400 steps, total: 19.152, sample: 1.224, forward: 3.659, backward: 12.093, update: 2.071
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.658 ms                  | 90.787 ms                 |
| bucket keys               | 2.587 ms                  | 4.065 ms                  |
| forward: a2a keys         | 1.844 ms                  | 80.561 ms                 |
| forward: search cache     | 227.030 us                | 313.579 us                |
| forward: a2a values       | 7.701 ms                  | 15.641 ms                 |
| forward: join             | 1.798 ms                  | 3.332 ms                  |
| Forward                   | 31.810 ms                 | 138.579 ms                |
| back: aggr dram keys      | 40.107 ms                 | 63.525 ms                 |
| back: set dram grad       | 3.443 ms                  | 8.436 ms                  |
| back: a2a grad            | 10.214 ms                 | 25.372 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.422 ms                 |
| Backward                  | 119.598 ms                | 153.317 ms                |
| Optimize                  | 20.996 ms                 | 32.392 ms                 |
| BarrierTimeBeforeRank0    | 41.867 us                 | 141.127 us                |
| BlockToStepN              | 22.613 us                 | 14.172 ms                 |
| OneStep                   | 181.179 ms                | 359.559 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.613 ms                  | 90.787 ms                 |
| bucket keys               | 2.587 ms                  | 4.065 ms                  |
| forward: a2a keys         | 1.844 ms                  | 80.490 ms                 |
| forward: search cache     | 226.855 us                | 307.067 us                |
| forward: a2a values       | 7.701 ms                  | 15.641 ms                 |
| forward: join             | 1.798 ms                  | 3.143 ms                  |
| Forward                   | 31.787 ms                 | 138.579 ms                |
| back: aggr dram keys      | 40.787 ms                 | 63.525 ms                 |
| back: set dram grad       | 3.444 ms                  | 8.332 ms                  |
| back: a2a grad            | 10.195 ms                 | 25.277 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 43.718 ms                 |
| Backward                  | 119.539 ms                | 153.317 ms                |
| Optimize                  | 20.991 ms                 | 36.925 ms                 |
| BarrierTimeBeforeRank0    | 41.629 us                 | 141.127 us                |
| BlockToStepN              | 22.567 us                 | 15.848 ms                 |
| OneStep                   | 181.155 ms                | 359.559 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.658 ms                  | 90.787 ms                 |
| bucket keys               | 2.553 ms                  | 4.118 ms                  |
| forward: a2a keys         | 1.836 ms                  | 80.490 ms                 |
| forward: search cache     | 226.732 us                | 307.067 us                |
| forward: a2a values       | 7.701 ms                  | 15.641 ms                 |
| forward: join             | 1.798 ms                  | 3.143 ms                  |
| Forward                   | 31.756 ms                 | 130.140 ms                |
| back: aggr dram keys      | 40.010 ms                 | 63.525 ms                 |
| back: set dram grad       | 3.444 ms                  | 8.332 ms                  |
| back: a2a grad            | 10.195 ms                 | 25.372 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 45.422 ms                 |
| Backward                  | 119.321 ms                | 153.317 ms                |
| Optimize                  | 20.991 ms                 | 36.223 ms                 |
| BarrierTimeBeforeRank0    | 41.643 us                 | 189.325 us                |
| BlockToStepN              | 22.478 us                 | 14.172 ms                 |
| OneStep                   | 180.923 ms                | 357.265 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.573 ms                  | 90.787 ms                 |
| bucket keys               | 2.586 ms                  | 4.118 ms                  |
| forward: a2a keys         | 1.798 ms                  | 71.923 ms                 |
| forward: search cache     | 226.732 us                | 306.884 us                |
| forward: a2a values       | 7.707 ms                  | 15.641 ms                 |
| forward: join             | 1.798 ms                  | 3.032 ms                  |
| Forward                   | 31.704 ms                 | 130.140 ms                |
| back: aggr dram keys      | 40.010 ms                 | 63.023 ms                 |
| back: set dram grad       | 3.442 ms                  | 8.323 ms                  |
| back: a2a grad            | 10.195 ms                 | 25.277 ms                 |
| back: grad sum & grad cache  | 22.580 ms                 | 44.708 ms                 |
| Backward                  | 119.081 ms                | 153.317 ms                |
| Optimize                  | 20.991 ms                 | 36.223 ms                 |
| BarrierTimeBeforeRank0    | 41.821 us                 | 189.325 us                |
| BlockToStepN              | 22.359 us                 | 14.172 ms                 |
| OneStep                   | 180.217 ms                | 357.265 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 18.813, sample: 1.032, forward: 4.215, backward: 8.724, update: 0.409
[proc 1] 500 steps, total: 18.813, sample: 1.133, forward: 4.075, backward: 9.059, update: 0.341
[proc 0] 500 steps, total: 18.813, sample: 1.138, forward: 3.652, backward: 11.830, update: 2.055
[proc 2] 500 steps, total: 18.813, sample: 1.472, forward: 3.745, backward: 8.741, update: 0.365
Successfully xmh. training takes 99.10773730278015 seconds
before call kg_cache_controller.StopThreads()
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
INFO [19654 controller_process.py:421] call rank0 to StopThreads
