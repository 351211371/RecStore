WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240203 01:29:20.857318 39576 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_50', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [39576 sampler.py:454] Start PreSampling
WARNING [39576 sampler.py:532] Before construct renumbering_dict
WARNING [39576 sampler.py:555] PreSampling done
W20240203 01:49:25.989328 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240203 01:49:25.989511 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240203 01:49:25.989555 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240203 01:49:25.989595 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240203 01:49:25.989634 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240203 01:49:25.989665 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240203 01:49:25.989696 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240203 01:49:25.989743 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240203 01:49:25.989774 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240203 01:49:25.989806 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240203 01:49:25.989848 39576 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240203 01:49:25.989879 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240203 01:49:25.989907 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240203 01:49:25.990051 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240203 01:49:25.990089 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240203 01:49:25.990130 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240203 01:49:25.990172 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240203 01:49:25.990206 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240203 01:49:25.990236 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240203 01:49:25.990278 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240203 01:49:25.990315 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240203 01:49:25.990356 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240203 01:49:25.990391 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240203 01:49:25.990428 39576 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240203 01:49:25.990455 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240203 01:49:25.990483 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240203 01:49:25.990552 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240203 01:49:25.990585 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240203 01:49:25.990617 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240203 01:49:25.990650 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240203 01:49:25.990681 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240203 01:49:25.990725 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240203 01:49:25.990767 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240203 01:49:25.990797 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240203 01:49:25.990837 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240203 01:49:25.990871 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240203 01:49:25.990907 39576 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240203 01:49:25.990933 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240203 01:49:25.990967 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240203 01:49:25.991025 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240203 01:49:25.991067 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240203 01:49:25.991098 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240203 01:49:25.991134 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240203 01:49:25.991170 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240203 01:49:25.991210 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240203 01:49:25.991242 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240203 01:49:25.991273 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240203 01:49:25.991304 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240203 01:49:25.991339 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240203 01:49:25.991379 39576 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240203 01:49:25.991405 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240203 01:49:25.991439 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240203 01:49:25.991508 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240203 01:49:25.991546 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240203 01:49:25.991583 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240203 01:49:25.991627 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240203 01:49:25.991667 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240203 01:49:25.991708 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240203 01:49:25.991747 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240203 01:49:25.991779 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240203 01:49:25.991819 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240203 01:49:25.991860 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240203 01:49:25.991891 39576 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240203 01:49:25.991917 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240203 01:49:25.991951 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240203 01:49:25.992009 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240203 01:49:25.992061 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240203 01:49:25.992095 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240203 01:49:25.992130 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240203 01:49:25.992163 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240203 01:49:25.992197 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240203 01:49:25.992229 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240203 01:49:25.992261 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240203 01:49:25.992298 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240203 01:49:25.992338 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240203 01:49:25.992378 39576 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240203 01:49:25.992405 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240203 01:49:25.992431 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240203 01:49:25.992491 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240203 01:49:25.992527 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240203 01:49:25.992563 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240203 01:49:25.992596 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240203 01:49:25.992630 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240203 01:49:25.992669 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240203 01:49:25.992708 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240203 01:49:25.992746 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240203 01:49:25.992779 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240203 01:49:25.992816 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240203 01:49:25.992853 39576 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240203 01:49:25.992882 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240203 01:49:25.992908 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240203 01:49:25.992969 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240203 01:49:25.993012 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240203 01:49:25.993048 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240203 01:49:25.993085 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240203 01:49:25.993119 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240203 01:49:25.993151 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240203 01:49:25.993191 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240203 01:49:25.993224 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240203 01:49:25.993263 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240203 01:49:25.993300 39576 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240203 01:49:25.993333 39576 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240203 01:49:25.993360 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240203 01:49:25.993387 39576 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240203 01:49:26.529220 39576 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240203 01:57:37.084758 39576 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302711,  4302731,    93037,  ..., 53340725, 61609040,  4899341]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2203.583 seconds
[Rank1] pid = 65360
[Rank2] pid = 65454
[Rank3] pid = 65523
[Rank4] pid = 565
[Rank5] pid = 660
[Rank6] pid = 849
INFO [39576 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [65360 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [65454 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [65523 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [565 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [849 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [1026 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [660 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [1026 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [660 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65454 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65523 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39576 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [65360 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [565 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [849 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240203 02:06:17.262392  1093 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240203 02:06:17.263322  1027 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240203 02:06:17.264237 65361 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240203 02:06:17.264256 65455 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240203 02:06:17.264274 65524 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240203 02:06:17.264307   661 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240203 02:06:17.264418   568 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240203 02:06:17.268275   850 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240203 02:06:17.343304  1093 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1020497b1000 7.629 MB
W20240203 02:06:17.343341  1027 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102049f54000 7.629 MB
W20240203 02:06:17.343348 65524 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204a6f7000 7.629 MB
W20240203 02:06:17.343389   661 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204ae9a000 7.629 MB
W20240203 02:06:17.343405 65455 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204b63d000 7.629 MB
W20240203 02:06:17.343410 65361 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204bde0000 7.629 MB
W20240203 02:06:17.343428   568 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204c583000 7.629 MB
W20240203 02:06:17.343451   850 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204cd26000 7.629 MB
W20240203 02:06:17.343482  1027 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10204d4c9000 7.629 MB
W20240203 02:06:17.343520  1093 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204dc6c000 7.629 MB
W20240203 02:06:17.343538  1027 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10204e40f000 1.49 GB
W20240203 02:06:17.343566   661 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1020ad9f2000 7.629 MB
W20240203 02:06:17.343575 65524 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020ae195000 7.629 MB
W20240203 02:06:17.343581 65455 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1020ae938000 7.629 MB
W20240203 02:06:17.343582  1027 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020af0db000 1.49 GB
W20240203 02:06:17.343609 65361 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210e6be000 7.629 MB
W20240203 02:06:17.343641   568 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10210ee61000 7.629 MB
W20240203 02:06:17.343663  1093 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10210f604000 1.49 GB
W20240203 02:06:17.343673   661 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10216ebe7000 1.49 GB
W20240203 02:06:17.343703 65361 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021ce1ca000 1.49 GB
W20240203 02:06:17.343734  1093 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10222d7ad000 1.49 GB
W20240203 02:06:17.343763 65361 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10228cd90000 1.49 GB
W20240203 02:06:17.343788  1093 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240203 02:06:17.343794 65524 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1022ec373000 1.49 GB
W20240203 02:06:17.343801 65455 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10234b956000 1.49 GB
W20240203 02:06:17.343832   568 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1023aaf39000 1.49 GB
W20240203 02:06:17.343880 65455 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10240a51c000 1.49 GB
W20240203 02:06:17.343900   568 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x102469aff000 1.49 GB
W20240203 02:06:17.343943   661 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1024c90e2000 1.49 GB
W20240203 02:06:17.343961 65524 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1025286c5000 1.49 GB
W20240203 02:06:17.343981 65361 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 02:06:17.345522   568 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 02:06:17.345527  1027 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 02:06:17.345528 65455 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 02:06:17.347281   661 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 02:06:17.347283 65524 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 02:06:17.351862   850 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x102587ca8000 7.629 MB
W20240203 02:06:17.354796   850 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10258844b000 1.49 GB
W20240203 02:06:17.354849   850 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240203 02:06:17.354889   850 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240203 02:06:17.355250  1093 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240203 02:06:17.356935 65361 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240203 02:06:17.357020   568 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240203 02:06:17.358532 65455 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240203 02:06:17.358566  1027 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240203 02:06:17.358664 65524 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240203 02:06:17.358680   661 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240203 02:06:17.367861   850 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [1026 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [660 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [565 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [65360 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [65454 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [65523 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 1026
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [39576 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [849 DistTensor.py:59] The tensor name already exists in the kvstore
I20240203 02:07:07.985747   850 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240203 02:07:07.985819  1027 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 02:07:07.985849 65361 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 02:07:07.986007  1093 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 02:07:07.986269 65524 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 02:07:07.986435 65455 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 02:07:07.986577   568 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240203 02:07:07.986699   661 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240203 02:07:07.992002  1027 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240203 02:07:07.992142  1027 grad_base.h:184] Init GradProcessingBase done
I20240203 02:07:20.420570  1027 grad_async_v1.h:203] Use main thread to update emb.
W20240203 02:07:20.420841  1027 kg_controller.h:75] after init GradAsyncProcessing
I20240203 02:07:20.420851  1027 kg_controller.h:84] Construct KGCacheController done
E20240203 02:07:22.197130   850 recstore.cc:66] init folly done
E20240203 02:07:22.197572  1093 recstore.cc:66] init folly done
E20240203 02:07:22.197721 65361 recstore.cc:66] init folly done
E20240203 02:07:22.197790   661 recstore.cc:66] init folly done
E20240203 02:07:22.197790  1027 recstore.cc:66] init folly done
E20240203 02:07:22.197855   568 recstore.cc:66] init folly done
E20240203 02:07:22.197901 65455 recstore.cc:66] init folly done
E20240203 02:07:22.197935 65524 recstore.cc:66] init folly done
I20240203 02:07:22.199111  1027 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240203 02:07:43.694455   661 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240203 02:07:43.873288  1093 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 02:07:44.032734   568 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 02:07:44.824000 65455 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 02:07:45.566709 65361 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 02:07:45.946342 65524 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 02:07:46.495405  1027 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240203 02:07:46.858959   850 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.897 ms                  | 7.897 ms                  |
| Forward                   | 746.005 ms                | 746.005 ms                |
| Backward                  | 267.151 ms                | 267.151 ms                |
| Optimize                  | 3.770 ms                  | 3.770 ms                  |
| BarrierTimeBeforeRank0    | 48.234 ms                 | 48.234 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240203 02:07:49.245822  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240203 02:07:50.282342  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=2, pq.top=2
W20240203 02:07:51.282009  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.769 ms                  | 351.638 ms                |
| ProcessBack:UpdateCache   | 9.704 ms                  | 689.633 ms                |
| ProcessBack:UpsertPq      | 30.849 ms                 | 38.706 ms                 |
| ProcessOneStep            | 56.056 ms                 | 1.312 s                   |
| BlockToStepN              | 14.320 ms                 | 957.926 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:07:52.370224  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=6, pq.top=6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 97.957 ms                 |
| Forward                   | 5.676 ms                  | 746.005 ms                |
| Backward                  | 10.607 ms                 | 267.151 ms                |
| Optimize                  | 2.761 ms                  | 4.914 ms                  |
| BarrierTimeBeforeRank0    | 3.019 ms                  | 299.841 ms                |
| AfterBackward             | 56.103 ms                 | 1.312 s                   |
| BlockToStepN              | 14.368 ms                 | 959.464 ms                |
| OneStep                   | 105.526 ms                | 3.347 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:07:53.370011  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240203 02:07:54.370009  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240203 02:07:55.370008  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240203 02:07:56.370008  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.767 ms                  | 351.638 ms                |
| ProcessBack:UpdateCache   | 10.382 ms                 | 689.633 ms                |
| ProcessBack:UpsertPq      | 32.664 ms                 | 49.194 ms                 |
| ProcessOneStep            | 59.180 ms                 | 1.312 s                   |
| BlockToStepN              | 14.320 ms                 | 957.926 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:07:57.370004  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.316 ms                  | 97.957 ms                 |
| Forward                   | 5.676 ms                  | 746.005 ms                |
| Backward                  | 10.717 ms                 | 267.151 ms                |
| Optimize                  | 2.841 ms                  | 5.273 ms                  |
| BarrierTimeBeforeRank0    | 532.360 us                | 299.841 ms                |
| AfterBackward             | 59.223 ms                 | 1.312 s                   |
| BlockToStepN              | 14.368 ms                 | 959.464 ms                |
| OneStep                   | 137.384 ms                | 3.347 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:07:58.370011  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240203 02:07:59.370009  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240203 02:08:00.370009  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240203 02:08:01.370012  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.795 ms                  | 351.638 ms                |
| ProcessBack:UpdateCache   | 10.769 ms                 | 689.633 ms                |
| ProcessBack:UpsertPq      | 33.793 ms                 | 73.673 ms                 |
| ProcessOneStep            | 59.464 ms                 | 1.312 s                   |
| BlockToStepN              | 14.320 ms                 | 957.926 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:02.370005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.063 ms                  | 129.058 ms                |
| Forward                   | 5.676 ms                  | 746.005 ms                |
| Backward                  | 10.684 ms                 | 267.151 ms                |
| Optimize                  | 2.841 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 539.994 us                | 299.841 ms                |
| AfterBackward             | 59.826 ms                 | 1.312 s                   |
| BlockToStepN              | 14.368 ms                 | 959.464 ms                |
| OneStep                   | 259.348 ms                | 3.347 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:03.370007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240203 02:08:04.398257  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240203 02:08:05.466507  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240203 02:08:06.501240  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.891 ms                  | 319.496 ms                |
| ProcessBack:UpdateCache   | 10.783 ms                 | 688.715 ms                |
| ProcessBack:UpsertPq      | 34.956 ms                 | 73.673 ms                 |
| ProcessOneStep            | 68.801 ms                 | 1.312 s                   |
| BlockToStepN              | 14.320 ms                 | 957.926 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:07.510722  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.543 ms                  | 129.058 ms                |
| Forward                   | 5.782 ms                  | 746.005 ms                |
| Backward                  | 10.616 ms                 | 267.151 ms                |
| Optimize                  | 2.829 ms                  | 10.918 ms                 |
| BarrierTimeBeforeRank0    | 397.851 us                | 299.841 ms                |
| AfterBackward             | 70.807 ms                 | 1.312 s                   |
| BlockToStepN              | 14.368 ms                 | 959.464 ms                |
| OneStep                   | 259.348 ms                | 3.347 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:08.510006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240203 02:08:09.845834  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240203 02:08:10.875273  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240203 02:08:11.875005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.926 ms                  | 319.496 ms                |
| ProcessBack:UpdateCache   | 10.769 ms                 | 688.715 ms                |
| ProcessBack:UpsertPq      | 39.968 ms                 | 73.673 ms                 |
| ProcessOneStep            | 70.755 ms                 | 1.312 s                   |
| BlockToStepN              | 14.320 ms                 | 957.926 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:12.875006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.744 ms                  | 379.771 ms                |
| Forward                   | 5.658 ms                  | 746.005 ms                |
| Backward                  | 10.508 ms                 | 267.151 ms                |
| Optimize                  | 2.841 ms                  | 10.918 ms                 |
| BarrierTimeBeforeRank0    | 112.943 us                | 299.841 ms                |
| AfterBackward             | 70.807 ms                 | 1.312 s                   |
| BlockToStepN              | 14.368 ms                 | 959.464 ms                |
| OneStep                   | 259.348 ms                | 3.347 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:13.875006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240203 02:08:14.875007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240203 02:08:15.875006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240203 02:08:16.875007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.913 ms                  | 319.496 ms                |
| ProcessBack:UpdateCache   | 11.149 ms                 | 688.715 ms                |
| ProcessBack:UpsertPq      | 39.397 ms                 | 73.673 ms                 |
| ProcessOneStep            | 69.200 ms                 | 99.365 ms                 |
| BlockToStepN              | 14.320 ms                 | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.696 ms                  | 129.058 ms                |
| Forward                   | 5.562 ms                  | 20.164 ms                 |
| Backward                  | 10.204 ms                 | 21.743 ms                 |
| Optimize                  | 2.841 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 539.994 us                | 245.205 ms                |
| AfterBackward             | 68.841 ms                 | 99.432 ms                 |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 259.348 ms                | 1.274 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:18.205291  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240203 02:08:19.311883  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240203 02:08:20.400403  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240203 02:08:21.400007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.870 ms                  | 319.496 ms                |
| ProcessBack:UpdateCache   | 11.106 ms                 | 688.715 ms                |
| ProcessBack:UpsertPq      | 38.706 ms                 | 73.673 ms                 |
| ProcessOneStep            | 68.786 ms                 | 99.365 ms                 |
| BlockToStepN              | 732.245 ms                | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:22.438580  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.982 ms                  | 379.771 ms                |
| Forward                   | 5.544 ms                  | 20.164 ms                 |
| Backward                  | 6.727 ms                  | 21.743 ms                 |
| Optimize                  | 2.799 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 1.075 ms                  | 245.205 ms                |
| AfterBackward             | 68.583 ms                 | 99.432 ms                 |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:23.472113  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240203 02:08:24.472007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240203 02:08:25.488015  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240203 02:08:26.804724  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.787 ms                  | 319.496 ms                |
| ProcessBack:UpdateCache   | 11.293 ms                 | 688.715 ms                |
| ProcessBack:UpsertPq      | 39.559 ms                 | 73.673 ms                 |
| ProcessOneStep            | 67.222 ms                 | 99.365 ms                 |
| BlockToStepN              | 14.320 ms                 | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:27.808674  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=72, pq.top=72
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.175 ms                  | 379.771 ms                |
| Forward                   | 5.519 ms                  | 20.164 ms                 |
| Backward                  | 6.487 ms                  | 21.743 ms                 |
| Optimize                  | 2.841 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 1.661 ms                  | 245.205 ms                |
| AfterBackward             | 67.250 ms                 | 99.432 ms                 |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:28.895514  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240203 02:08:29.895007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240203 02:08:30.895006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240203 02:08:31.895007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.705 ms                  | 28.626 ms                 |
| ProcessBack:UpdateCache   | 11.169 ms                 | 44.591 ms                 |
| ProcessBack:UpsertPq      | 39.526 ms                 | 65.843 ms                 |
| ProcessOneStep            | 65.882 ms                 | 99.365 ms                 |
| BlockToStepN              | 14.320 ms                 | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:32.895006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.175 ms                  | 379.771 ms                |
| Forward                   | 5.519 ms                  | 20.164 ms                 |
| Backward                  | 6.218 ms                  | 21.743 ms                 |
| Optimize                  | 2.874 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.205 ms                  | 245.205 ms                |
| AfterBackward             | 65.945 ms                 | 99.432 ms                 |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:33.895006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240203 02:08:35.289383  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240203 02:08:36.390849  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.733 ms                  | 28.626 ms                 |
| ProcessBack:UpdateCache   | 11.293 ms                 | 44.591 ms                 |
| ProcessBack:UpsertPq      | 40.524 ms                 | 72.311 ms                 |
| ProcessOneStep            | 68.544 ms                 | 99.365 ms                 |
| BlockToStepN              | 732.245 ms                | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:37.428362  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.392 ms                  | 429.817 ms                |
| Forward                   | 5.533 ms                  | 20.164 ms                 |
| Backward                  | 6.207 ms                  | 21.743 ms                 |
| Optimize                  | 2.860 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.663 ms                  | 245.205 ms                |
| AfterBackward             | 68.583 ms                 | 102.927 ms                |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.312 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:38.428006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240203 02:08:39.483767  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240203 02:08:40.532900  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
W20240203 02:08:41.542608  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.767 ms                  | 28.626 ms                 |
| ProcessBack:UpdateCache   | 11.440 ms                 | 44.591 ms                 |
| ProcessBack:UpsertPq      | 41.429 ms                 | 81.157 ms                 |
| ProcessOneStep            | 68.992 ms                 | 116.343 ms                |
| BlockToStepN              | 14.320 ms                 | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 57.579, sample: 1.304, forward: 1.247, backward: 1.294, update: 0.282
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 55.544, sample: 2.673, forward: 1.302, backward: 1.216, update: 0.259
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 58.530, sample: 1.639, forward: 1.322, backward: 1.226, update: 0.289
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 58.370, sample: 2.530, forward: 1.306, backward: 0.998, update: 0.238
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 56.457, sample: 1.900, forward: 1.198, backward: 1.347, update: 0.272
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 56.837, sample: 2.613, forward: 1.288, backward: 1.155, update: 0.261
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 58.709, sample: 2.116, forward: 1.266, backward: 1.336, update: 0.262
train_sampler.Prefill()
-------Step 0-------
tensor([   43272,    43294,    43319,    43344,  6065996,   138332, 62408084,
        15591243, 24465938,    43372]) tensor([ 5318158, 13714565, 70400175, 81918797, 20033807, 36674872, 38542267,
        70722992, 60515686, 33169691])
-------Step 1-------
tensor([   43272,    43294,    43319,    43344,  6065996,   138332, 62408084,
        15591243, 24465938,    43372]) tensor([61314029, 26731772,  9680068, 69991789, 85046129, 45773637, 65454422,
        52548588, 32046570, 11649285])
-------Step 2-------
tensor([  107837,   107864,   107888,    21687,   107910,   107929,   107958,
        26088981,   107985,   108011]) tensor([64864506, 23936550, 72526218, 57573092, 37498140, 33068135, 61624245,
        37246265, 14428499, 44806891])
-------Step 3-------
tensor([  107837,   107864,   107888,    21687,   107910,   107929,   107958,
        26088981,   107985,   108011]) tensor([42006702, 75757021, 40872016, 43427773, 73356976, 58369623, 39320455,
        14415040, 29830308,   795231])
-------Step 4-------
tensor([  171789, 41701872,   171815,   174859,   171844,   174897,   171879,
        45122460,   171908,   171930]) tensor([72273392,  8985269, 83833669, 17435804, 61534877, 38651484, 72043602,
        42695513, 75256013, 44495792])
-------Step 5-------
tensor([  171789, 41701872,   171815,   174859,   171844,   174897,   171879,
        45122460,   171908,   171930]) tensor([36143673, 81549284,   320202, 85217678, 49695303, 48721454, 14941659,
        10796307, 79998924, 36210537])
-------Step 6-------
tensor([  235321,    45756,   235343,   235367,    45787, 78967773,   235384,
          235410,   192947, 41604111]) tensor([11664820, 44767522, 30429102, 74591626, 34032771, 38596506, 25110340,
         6189773, 61492779, 73297596])
-------Step 7-------
tensor([  235321,    45756,   235343,   235367,    45787, 78967773,   235384,
          235410,   192947, 41604111]) tensor([24685846, 47374358, 65213112, 52332307, 81620514, 53641685, 58435224,
        48896565, 41817793, 33458866])
-------Step 8-------
tensor([  296803, 28558939,   296820,   209855,   296843,    57451,   296865,
          296884,   296907,   296928]) tensor([39690731, 24357153, 29372828,  1888832, 44905646, 59317352, 16117590,
        62386315,  1581012, 53445258])
-------Step 9-------
tensor([  296803, 28558939,   296820,   209855,   296843,    57451,   296865,
          296884,   296907,   296928]) tensor([57766256, 31194435, 12431795, 49212511,  8318477, 34754556, 23515340,
        32407211, 84705029, 72980357])
before start barrier
start train
[proc 0] 100 steps, total: 55.908, sample: 2.849, forward: 1.315, backward: 0.987, update: 0.332
W20240203 02:08:42.542007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.219 ms                  | 429.817 ms                |
| Forward                   | 5.497 ms                  | 20.164 ms                 |
| Backward                  | 6.106 ms                  | 21.743 ms                 |
| Optimize                  | 2.860 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 3.061 ms                  | 245.205 ms                |
| AfterBackward             | 69.030 ms                 | 116.387 ms                |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.312 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:43.852603  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240203 02:08:44.881717  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=104, pq.top=104
W20240203 02:08:45.978524  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240203 02:08:47.004606  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.767 ms                  | 28.626 ms                 |
| ProcessBack:UpdateCache   | 11.527 ms                 | 44.591 ms                 |
| ProcessBack:UpsertPq      | 41.443 ms                 | 81.157 ms                 |
| ProcessOneStep            | 68.992 ms                 | 116.343 ms                |
| BlockToStepN              | 14.320 ms                 | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.681 ms                  | 429.817 ms                |
| Forward                   | 5.475 ms                  | 20.164 ms                 |
| Backward                  | 6.054 ms                  | 21.743 ms                 |
| Optimize                  | 2.874 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 3.061 ms                  | 245.205 ms                |
| AfterBackward             | 69.235 ms                 | 116.387 ms                |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.312 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:48.004005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240203 02:08:49.004005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240203 02:08:50.004006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240203 02:08:51.004005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240203 02:08:52.073729  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.769 ms                  | 28.626 ms                 |
| ProcessBack:UpdateCache   | 11.512 ms                 | 44.591 ms                 |
| ProcessBack:UpsertPq      | 42.170 ms                 | 81.157 ms                 |
| ProcessOneStep            | 69.211 ms                 | 116.343 ms                |
| BlockToStepN              | 14.320 ms                 | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.897 ms                  | 429.817 ms                |
| Forward                   | 5.434 ms                  | 20.164 ms                 |
| Backward                  | 6.008 ms                  | 21.743 ms                 |
| Optimize                  | 2.860 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.796 ms                  | 245.205 ms                |
| AfterBackward             | 69.242 ms                 | 116.387 ms                |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.312 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:53.073005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240203 02:08:54.073007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240203 02:08:55.073007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240203 02:08:56.073006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240203 02:08:57.073007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.787 ms                  | 24.426 ms                 |
| ProcessBack:UpdateCache   | 11.486 ms                 | 37.239 ms                 |
| ProcessBack:UpsertPq      | 42.159 ms                 | 76.817 ms                 |
| ProcessOneStep            | 68.969 ms                 | 116.343 ms                |
| BlockToStepN              | 14.320 ms                 | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.897 ms                  | 429.817 ms                |
| Forward                   | 5.427 ms                  | 20.164 ms                 |
| Backward                  | 5.956 ms                  | 21.743 ms                 |
| Optimize                  | 2.889 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.796 ms                  | 245.205 ms                |
| AfterBackward             | 68.841 ms                 | 116.387 ms                |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.312 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:08:58.073004  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240203 02:08:59.073007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240203 02:09:00.073005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240203 02:09:01.085094  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240203 02:09:02.085005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.802 ms                  | 24.426 ms                 |
| ProcessBack:UpdateCache   | 11.486 ms                 | 37.239 ms                 |
| ProcessBack:UpsertPq      | 42.013 ms                 | 76.817 ms                 |
| ProcessOneStep            | 68.550 ms                 | 116.343 ms                |
| BlockToStepN              | 14.320 ms                 | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.102 ms                  | 429.817 ms                |
| Forward                   | 5.406 ms                  | 20.164 ms                 |
| Backward                  | 5.955 ms                  | 21.743 ms                 |
| Optimize                  | 2.897 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.793 ms                  | 245.205 ms                |
| AfterBackward             | 68.583 ms                 | 116.387 ms                |
| BlockToStepN              | 14.368 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.312 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:03.085005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240203 02:09:04.085007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240203 02:09:05.085005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240203 02:09:06.085007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240203 02:09:07.085007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.822 ms                  | 24.426 ms                 |
| ProcessBack:UpdateCache   | 11.536 ms                 | 37.239 ms                 |
| ProcessBack:UpsertPq      | 41.936 ms                 | 76.817 ms                 |
| ProcessOneStep            | 68.544 ms                 | 116.343 ms                |
| BlockToStepN              | 18.801 ms                 | 918.207 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.102 ms                  | 379.771 ms                |
| Forward                   | 5.350 ms                  | 15.659 ms                 |
| Backward                  | 5.956 ms                  | 13.237 ms                 |
| Optimize                  | 2.897 ms                  | 5.904 ms                  |
| BarrierTimeBeforeRank0    | 3.061 ms                  | 245.205 ms                |
| AfterBackward             | 68.513 ms                 | 116.387 ms                |
| BlockToStepN              | 18.840 ms                 | 918.349 ms                |
| OneStep                   | 311.582 ms                | 1.312 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:08.088200  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240203 02:09:09.104813  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240203 02:09:10.104007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240203 02:09:11.104007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240203 02:09:12.104007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.827 ms                  | 24.426 ms                 |
| ProcessBack:UpdateCache   | 11.559 ms                 | 37.239 ms                 |
| ProcessBack:UpsertPq      | 41.751 ms                 | 76.817 ms                 |
| ProcessOneStep            | 68.483 ms                 | 108.566 ms                |
| BlockToStepN              | 36.765 ms                 | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.102 ms                  | 379.771 ms                |
| Forward                   | 5.288 ms                  | 15.659 ms                 |
| Backward                  | 5.939 ms                  | 13.237 ms                 |
| Optimize                  | 2.897 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 3.126 ms                  | 170.883 ms                |
| AfterBackward             | 68.477 ms                 | 108.603 ms                |
| BlockToStepN              | 82.741 ms                 | 832.009 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:13.138482  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240203 02:09:14.159866  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240203 02:09:15.230278  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240203 02:09:16.418202  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.850 ms                  | 24.426 ms                 |
| ProcessBack:UpdateCache   | 11.565 ms                 | 37.239 ms                 |
| ProcessBack:UpsertPq      | 41.832 ms                 | 76.817 ms                 |
| ProcessOneStep            | 68.544 ms                 | 108.566 ms                |
| BlockToStepN              | 732.245 ms                | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:17.428865  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.439 ms                  | 379.771 ms                |
| Forward                   | 5.275 ms                  | 15.659 ms                 |
| Backward                  | 5.939 ms                  | 13.237 ms                 |
| Optimize                  | 2.897 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 3.154 ms                  | 170.883 ms                |
| AfterBackward             | 68.572 ms                 | 108.603 ms                |
| BlockToStepN              | 82.741 ms                 | 832.009 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:18.428005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240203 02:09:19.428006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240203 02:09:20.496549  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240203 02:09:21.584113  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.842 ms                  | 23.852 ms                 |
| ProcessBack:UpdateCache   | 11.562 ms                 | 35.047 ms                 |
| ProcessBack:UpsertPq      | 41.936 ms                 | 74.754 ms                 |
| ProcessOneStep            | 68.550 ms                 | 108.566 ms                |
| BlockToStepN              | 108.850 ms                | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:22.605638  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.439 ms                  | 379.771 ms                |
| Forward                   | 5.247 ms                  | 15.659 ms                 |
| Backward                  | 5.943 ms                  | 13.237 ms                 |
| Optimize                  | 2.875 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 3.154 ms                  | 170.883 ms                |
| AfterBackward             | 68.809 ms                 | 108.603 ms                |
| BlockToStepN              | 108.921 ms                | 832.009 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:23.648900  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240203 02:09:24.905680  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240203 02:09:25.979454  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240203 02:09:26.979007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.870 ms                  | 23.852 ms                 |
| ProcessBack:UpdateCache   | 11.631 ms                 | 35.047 ms                 |
| ProcessBack:UpsertPq      | 42.218 ms                 | 76.817 ms                 |
| ProcessOneStep            | 68.942 ms                 | 109.448 ms                |
| BlockToStepN              | 108.850 ms                | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.516 ms                  | 379.771 ms                |
| Forward                   | 5.259 ms                  | 15.659 ms                 |
| Backward                  | 5.949 ms                  | 13.237 ms                 |
| Optimize                  | 2.897 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 3.346 ms                  | 170.883 ms                |
| AfterBackward             | 68.975 ms                 | 116.387 ms                |
| BlockToStepN              | 108.921 ms                | 832.009 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:28.115777  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240203 02:09:29.210917  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240203 02:09:30.323321  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240203 02:09:31.411154  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.881 ms                  | 23.852 ms                 |
| ProcessBack:UpdateCache   | 11.570 ms                 | 35.047 ms                 |
| ProcessBack:UpsertPq      | 42.650 ms                 | 84.385 ms                 |
| ProcessOneStep            | 69.211 ms                 | 128.611 ms                |
| BlockToStepN              | 724.256 ms                | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:32.501471  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.516 ms                  | 379.771 ms                |
| Forward                   | 5.247 ms                  | 15.659 ms                 |
| Backward                  | 5.974 ms                  | 13.237 ms                 |
| Optimize                  | 2.889 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 3.182 ms                  | 170.883 ms                |
| AfterBackward             | 69.269 ms                 | 128.649 ms                |
| BlockToStepN              | 124.818 ms                | 832.009 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:33.743753  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 1] 200 steps, total: 52.245, sample: 2.317, forward: 0.517, backward: 0.990, update: 0.256
[proc 6] 200 steps, total: 52.245, sample: 2.322, forward: 0.512, backward: 0.945, update: 0.263
[proc 7] 200 steps, total: 52.245, sample: 1.883, forward: 0.519, backward: 0.951, update: 0.300
[proc 5] 200 steps, total: 52.245, sample: 2.427, forward: 0.535, backward: 0.858, update: 0.273
[proc 4] 200 steps, total: 52.245, sample: 2.556, forward: 0.533, backward: 0.931, update: 0.255
[proc 2] 200 steps, total: 52.245, sample: 1.483, forward: 0.508, backward: 1.064, update: 0.312
[proc 0] 200 steps, total: 52.245, sample: 2.464, forward: 0.525, backward: 0.640, update: 0.335
[proc 3] 200 steps, total: 52.245, sample: 2.247, forward: 0.512, backward: 1.055, update: 0.267
W20240203 02:09:34.762641  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240203 02:09:35.762007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240203 02:09:36.857067  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.890 ms                  | 23.852 ms                 |
| ProcessBack:UpdateCache   | 11.550 ms                 | 35.047 ms                 |
| ProcessBack:UpsertPq      | 42.656 ms                 | 84.385 ms                 |
| ProcessOneStep            | 69.241 ms                 | 128.611 ms                |
| BlockToStepN              | 124.774 ms                | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:37.917809  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.888 ms                  | 379.771 ms                |
| Forward                   | 5.247 ms                  | 15.659 ms                 |
| Backward                  | 6.054 ms                  | 13.237 ms                 |
| Optimize                  | 2.874 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 3.126 ms                  | 170.883 ms                |
| AfterBackward             | 69.449 ms                 | 128.649 ms                |
| BlockToStepN              | 124.818 ms                | 832.009 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:39.065058  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240203 02:09:40.256078  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240203 02:09:41.256006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.892 ms                  | 23.852 ms                 |
| ProcessBack:UpdateCache   | 11.514 ms                 | 35.047 ms                 |
| ProcessBack:UpsertPq      | 42.680 ms                 | 86.551 ms                 |
| ProcessOneStep            | 69.573 ms                 | 132.153 ms                |
| BlockToStepN              | 124.774 ms                | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:42.256003  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.104 ms                  | 379.771 ms                |
| Forward                   | 5.273 ms                  | 15.659 ms                 |
| Backward                  | 6.106 ms                  | 13.237 ms                 |
| Optimize                  | 2.874 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 3.003 ms                  | 170.883 ms                |
| AfterBackward             | 69.586 ms                 | 132.191 ms                |
| BlockToStepN              | 124.818 ms                | 832.009 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:43.256011  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240203 02:09:44.256007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240203 02:09:45.270650  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240203 02:09:46.270007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=224, pq.top=224
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.892 ms                  | 23.852 ms                 |
| ProcessBack:UpdateCache   | 11.462 ms                 | 35.047 ms                 |
| ProcessBack:UpsertPq      | 42.716 ms                 | 86.551 ms                 |
| ProcessOneStep            | 69.631 ms                 | 132.153 ms                |
| BlockToStepN              | 353.003 ms                | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:47.295876  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=226, pq.top=226
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.105 ms                  | 379.771 ms                |
| Forward                   | 5.276 ms                  | 15.659 ms                 |
| Backward                  | 6.146 ms                  | 19.322 ms                 |
| Optimize                  | 2.874 ms                  | 8.730 ms                  |
| BarrierTimeBeforeRank0    | 3.003 ms                  | 170.883 ms                |
| AfterBackward             | 69.703 ms                 | 132.191 ms                |
| BlockToStepN              | 147.586 ms                | 832.009 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:48.295006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240203 02:09:49.295010  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240203 02:09:50.295008  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240203 02:09:51.295008  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.891 ms                  | 22.471 ms                 |
| ProcessBack:UpdateCache   | 11.376 ms                 | 27.408 ms                 |
| ProcessBack:UpsertPq      | 42.670 ms                 | 84.385 ms                 |
| ProcessOneStep            | 69.658 ms                 | 132.153 ms                |
| BlockToStepN              | 147.520 ms                | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:52.295004  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.362 ms                  | 379.771 ms                |
| Forward                   | 5.282 ms                  | 15.659 ms                 |
| Backward                  | 6.217 ms                  | 19.322 ms                 |
| Optimize                  | 2.868 ms                  | 8.730 ms                  |
| BarrierTimeBeforeRank0    | 2.796 ms                  | 170.883 ms                |
| AfterBackward             | 69.703 ms                 | 132.191 ms                |
| BlockToStepN              | 353.073 ms                | 832.009 ms                |
| OneStep                   | 473.317 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:53.305763  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240203 02:09:54.305007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240203 02:09:55.311302  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
W20240203 02:09:56.311009  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.892 ms                  | 22.471 ms                 |
| ProcessBack:UpdateCache   | 11.359 ms                 | 27.408 ms                 |
| ProcessBack:UpsertPq      | 42.680 ms                 | 84.385 ms                 |
| ProcessOneStep            | 69.938 ms                 | 132.153 ms                |
| BlockToStepN              | 153.255 ms                | 831.870 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:57.311007  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.388 ms                  | 379.771 ms                |
| Forward                   | 5.283 ms                  | 15.659 ms                 |
| Backward                  | 6.263 ms                  | 19.322 ms                 |
| Optimize                  | 2.868 ms                  | 8.730 ms                  |
| BarrierTimeBeforeRank0    | 2.793 ms                  | 170.883 ms                |
| AfterBackward             | 69.967 ms                 | 132.191 ms                |
| BlockToStepN              | 153.304 ms                | 832.009 ms                |
| OneStep                   | 311.582 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:09:58.622730  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240203 02:09:59.652132  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240203 02:10:00.652005  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240203 02:10:01.652009  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.892 ms                  | 22.471 ms                 |
| ProcessBack:UpdateCache   | 11.293 ms                 | 27.408 ms                 |
| ProcessBack:UpsertPq      | 42.670 ms                 | 84.385 ms                 |
| ProcessOneStep            | 69.965 ms                 | 128.611 ms                |
| BlockToStepN              | 153.255 ms                | 827.567 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:10:02.652006  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.388 ms                  | 350.772 ms                |
| Forward                   | 5.282 ms                  | 11.833 ms                 |
| Backward                  | 6.315 ms                  | 13.579 ms                 |
| Optimize                  | 2.850 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.793 ms                  | 98.085 ms                 |
| AfterBackward             | 69.967 ms                 | 128.649 ms                |
| BlockToStepN              | 153.304 ms                | 827.687 ms                |
| OneStep                   | 311.582 ms                | 1.274 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:10:03.808236  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240203 02:10:04.816548  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
W20240203 02:10:05.816012  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240203 02:10:06.816013  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.890 ms                  | 22.471 ms                 |
| ProcessBack:UpdateCache   | 11.096 ms                 | 27.408 ms                 |
| ProcessBack:UpsertPq      | 42.462 ms                 | 84.385 ms                 |
| ProcessOneStep            | 69.658 ms                 | 128.611 ms                |
| BlockToStepN              | 159.274 ms                | 827.567 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:10:07.816012  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.306 ms                  | 350.772 ms                |
| Forward                   | 5.278 ms                  | 11.833 ms                 |
| Backward                  | 6.330 ms                  | 13.579 ms                 |
| Optimize                  | 2.841 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.796 ms                  | 98.085 ms                 |
| AfterBackward             | 69.703 ms                 | 128.649 ms                |
| BlockToStepN              | 159.337 ms                | 827.687 ms                |
| OneStep                   | 311.582 ms                | 1.274 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:10:08.816011  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240203 02:10:09.816012  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
W20240203 02:10:10.816344  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240203 02:10:11.816009  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.864 ms                  | 22.471 ms                 |
| ProcessBack:UpdateCache   | 10.945 ms                 | 35.047 ms                 |
| ProcessBack:UpsertPq      | 42.716 ms                 | 84.385 ms                 |
| ProcessOneStep            | 69.916 ms                 | 128.611 ms                |
| BlockToStepN              | 182.668 ms                | 827.567 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:10:12.881960  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=276, pq.top=276
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.105 ms                  | 350.772 ms                |
| Forward                   | 5.288 ms                  | 11.833 ms                 |
| Backward                  | 6.329 ms                  | 18.885 ms                 |
| Optimize                  | 2.841 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.796 ms                  | 98.085 ms                 |
| AfterBackward             | 69.953 ms                 | 128.649 ms                |
| BlockToStepN              | 353.073 ms                | 827.687 ms                |
| OneStep                   | 451.138 ms                | 1.274 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:10:13.881011  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240203 02:10:14.881012  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240203 02:10:15.881011  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240203 02:10:16.881012  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.850 ms                  | 16.547 ms                 |
| ProcessBack:UpdateCache   | 10.856 ms                 | 27.408 ms                 |
| ProcessBack:UpsertPq      | 42.858 ms                 | 83.328 ms                 |
| ProcessOneStep            | 69.965 ms                 | 128.611 ms                |
| BlockToStepN              | 186.557 ms                | 827.567 ms                |
+---------------------------+---------------------------+---------------------------+
W20240203 02:10:17.906325  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.104 ms                  | 350.772 ms                |
| Forward                   | 5.283 ms                  | 11.833 ms                 |
| Backward                  | 6.415 ms                  | 18.885 ms                 |
| Optimize                  | 2.841 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.793 ms                  | 98.085 ms                 |
| AfterBackward             | 69.995 ms                 | 128.649 ms                |
| BlockToStepN              | 200.655 ms                | 827.687 ms                |
| OneStep                   | 311.582 ms                | 1.274 s                   |
+---------------------------+---------------------------+---------------------------+
W20240203 02:10:18.906008  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240203 02:10:19.970623  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240203 02:10:20.970057  1027 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
Successfully xmh. training takes 154.88027358055115 seconds
before call kg_cache_controller.StopThreads()
W20240203 02:10:21.375830  1027 grad_async_v1.h:243] call StopThreads. PID = 39576
W20240203 02:10:21.375857  1027 grad_base.h:212] before processOneStepNegThread_.join();
W20240203 02:10:21.380882  1027 grad_base.h:214] after processOneStepNegThread_.join();
W20240203 02:10:21.380901  1027 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240203 02:10:21.427026  1027 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.850 ms                  | 16.547 ms                 |
| ProcessBack:UpdateCache   | 10.788 ms                 | 27.408 ms                 |
| ProcessBack:UpsertPq      | 42.795 ms                 | 83.328 ms                 |
| ProcessOneStep            | 69.916 ms                 | 128.611 ms                |
| BlockToStepN              | 200.488 ms                | 827.567 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.163 ms                  | 350.772 ms                |
| Forward                   | 5.288 ms                  | 11.833 ms                 |
| Backward                  | 6.434 ms                  | 18.885 ms                 |
| Optimize                  | 2.838 ms                  | 8.614 ms                  |
| BarrierTimeBeforeRank0    | 2.716 ms                  | 98.085 ms                 |
| AfterBackward             | 69.953 ms                 | 128.649 ms                |
| BlockToStepN              | 200.655 ms                | 827.687 ms                |
| OneStep                   | 311.582 ms                | 1.274 s                   |
+---------------------------+---------------------------+---------------------------+
