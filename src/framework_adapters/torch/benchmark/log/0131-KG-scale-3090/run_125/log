WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 20:46:33.645253 23842 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_11', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [23842 sampler.py:454] Start PreSampling
WARNING [23842 sampler.py:532] Before construct renumbering_dict
WARNING [23842 sampler.py:555] PreSampling done
W20240205 20:46:39.211315 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 20:46:39.211519 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 20:46:39.211568 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 20:46:39.211625 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 20:46:39.211658 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 20:46:39.211700 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 20:46:39.211730 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 20:46:39.211787 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 20:46:39.211818 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 20:46:39.211859 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 20:46:39.211899 23842 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 20:46:39.211930 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 20:46:39.211961 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 20:46:39.212111 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 20:46:39.212182 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 20:46:39.212211 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 20:46:39.212250 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 20:46:39.212280 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 20:46:39.212309 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 20:46:39.212338 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 20:46:39.212373 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 20:46:39.212415 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 20:46:39.212445 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 20:46:39.212472 23842 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 20:46:39.212496 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 20:46:39.212522 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 20:46:39.212580 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 20:46:39.212618 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 20:46:39.212647 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 20:46:39.212673 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 20:46:39.212704 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 20:46:39.212734 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 20:46:39.212781 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 20:46:39.212814 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 20:46:39.212843 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 20:46:39.212882 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 20:46:39.212909 23842 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 20:46:39.212932 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 20:46:39.212957 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 20:46:39.213013 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 20:46:39.213042 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 20:46:39.213069 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 20:46:39.213105 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 20:46:39.213132 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 20:46:39.213166 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 20:46:39.213204 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 20:46:39.213240 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 20:46:39.213268 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 20:46:39.213303 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 20:46:39.213332 23842 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 20:46:39.213359 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 20:46:39.213382 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 20:46:39.213444 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 20:46:39.213482 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 20:46:39.213514 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 20:46:39.213552 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 20:46:39.213593 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 20:46:39.213635 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 20:46:39.213667 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 20:46:39.213702 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 20:46:39.213737 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 20:46:39.213778 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 20:46:39.213807 23842 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 20:46:39.213830 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 20:46:39.213855 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 20:46:39.213912 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 20:46:39.213943 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 20:46:39.213979 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 20:46:39.214012 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 20:46:39.214053 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 20:46:39.214087 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 20:46:39.214119 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 20:46:39.214154 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 20:46:39.214180 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 20:46:39.214207 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 20:46:39.214241 23842 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 20:46:39.214263 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 20:46:39.214286 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 20:46:39.214344 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 20:46:39.214375 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 20:46:39.214404 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 20:46:39.214430 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 20:46:39.214468 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 20:46:39.214495 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 20:46:39.214522 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 20:46:39.214552 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 20:46:39.214579 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 20:46:39.214607 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 20:46:39.214645 23842 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 20:46:39.214669 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 20:46:39.214699 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 20:46:39.214751 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 20:46:39.214789 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 20:46:39.214823 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 20:46:39.214855 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 20:46:39.214883 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 20:46:39.214915 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 20:46:39.214941 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 20:46:39.214973 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 20:46:39.215000 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 20:46:39.215036 23842 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 20:46:39.215063 23842 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 20:46:39.215087 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 20:46:39.215111 23842 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 20:46:39.449746 23842 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240205 20:46:39.482373 23842 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 748, 1148, 1769,  ..., 7577, 7579, 8525]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.869 seconds
[Rank1] pid = 24047
[Rank2] pid = 24102
[Rank3] pid = 24175
[Rank4] pid = 24239
[Rank5] pid = 24303
[Rank6] pid = 24319
INFO [23842 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [24047 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [24102 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [24175 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [24239 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [24319 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [24303 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [24431 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [24319 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [23842 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24175 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24431 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24239 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24303 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24047 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [24102 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [23842 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24319 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24239 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24047 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24303 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24431 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24175 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [24102 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 20:46:42.154793 24112 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 20:46:42.154860 24048 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:46:42.154918 24176 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:46:42.154991 24432 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:46:42.155050 24495 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:46:42.155110 24240 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:46:42.155169 24304 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:46:42.155228 24368 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240205 20:46:43.892925 24304 recstore.cc:66] init folly done
E20240205 20:46:43.893043 24048 recstore.cc:66] init folly done
E20240205 20:46:43.893040 24240 recstore.cc:66] init folly done
E20240205 20:46:43.893049 24176 recstore.cc:66] init folly done
E20240205 20:46:43.893051 24495 recstore.cc:66] init folly done
E20240205 20:46:43.893059 24368 recstore.cc:66] init folly done
E20240205 20:46:43.893430 24112 recstore.cc:66] init folly done
E20240205 20:46:43.893424 24432 recstore.cc:66] init folly done
I20240205 20:46:43.961863 24048 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 20:46:43.962356 24304 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:46:43.964217 24240 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:46:43.965497 24176 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:46:43.965929 24495 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:46:43.968745 24432 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:46:43.968884 24368 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:46:43.981271 24112 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 674.377 us                | 674.377 us                |
| bucket keys               | 2.659 ms                  | 128.084 ms                |
| forward: a2a keys         | 2.684 ms                  | 1.355 s                   |
| forward: search cache     | 444.260 us                | 24.887 ms                 |
| forward: a2a values       | 5.343 ms                  | 10.278 ms                 |
| forward: join             | 2.149 ms                  | 3.430 ms                  |
| Forward                   | 1.871 s                   | 1.871 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.785 ms                  | 24.191 ms                 |
| bucket keys               | 2.433 ms                  | 3.710 ms                  |
| forward: a2a keys         | 2.358 ms                  | 4.935 ms                  |
| forward: search cache     | 435.520 us                | 584.235 us                |
| forward: a2a values       | 3.853 ms                  | 5.834 ms                  |
| forward: join             | 2.101 ms                  | 2.633 ms                  |
| Forward                   | 30.154 ms                 | 1.871 s                   |
| back: aggr dram keys      | 40.193 ms                 | 53.367 ms                 |
| back: set dram grad       | 2.666 ms                  | 6.764 ms                  |
| back: a2a grad            | 7.656 ms                  | 9.745 ms                  |
| back: grad sum & grad cache  | 5.199 ms                  | 8.424 ms                  |
| Backward                  | 110.503 ms                | 1.409 s                   |
| Optimize                  | 26.076 ms                 | 58.144 ms                 |
| BarrierTimeBeforeRank0    | 55.118 us                 | 83.929 us                 |
| BlockToStepN              | 21.614 us                 | 2.768 ms                  |
| OneStep                   | 173.063 ms                | 3.342 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.823 ms                  | 20.919 ms                 |
| bucket keys               | 2.442 ms                  | 3.710 ms                  |
| forward: a2a keys         | 2.317 ms                  | 8.885 ms                  |
| forward: search cache     | 435.306 us                | 584.235 us                |
| forward: a2a values       | 3.786 ms                  | 6.267 ms                  |
| forward: join             | 2.123 ms                  | 2.633 ms                  |
| Forward                   | 29.783 ms                 | 39.873 ms                 |
| back: aggr dram keys      | 39.257 ms                 | 56.608 ms                 |
| back: set dram grad       | 2.679 ms                  | 6.764 ms                  |
| back: a2a grad            | 7.563 ms                  | 9.745 ms                  |
| back: grad sum & grad cache  | 5.469 ms                  | 9.650 ms                  |
| Backward                  | 112.480 ms                | 132.325 ms                |
| Optimize                  | 26.393 ms                 | 51.159 ms                 |
| BarrierTimeBeforeRank0    | 51.605 us                 | 83.929 us                 |
| BlockToStepN              | 18.576 us                 | 214.396 us                |
| OneStep                   | 173.063 ms                | 214.208 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.814 ms                  | 20.919 ms                 |
| bucket keys               | 2.460 ms                  | 3.710 ms                  |
| forward: a2a keys         | 2.320 ms                  | 9.874 ms                  |
| forward: search cache     | 441.351 us                | 611.079 us                |
| forward: a2a values       | 3.781 ms                  | 6.490 ms                  |
| forward: join             | 2.143 ms                  | 3.358 ms                  |
| Forward                   | 30.018 ms                 | 47.136 ms                 |
| back: aggr dram keys      | 39.257 ms                 | 56.608 ms                 |
| back: set dram grad       | 2.700 ms                  | 6.898 ms                  |
| back: a2a grad            | 7.524 ms                  | 9.688 ms                  |
| back: grad sum & grad cache  | 5.469 ms                  | 8.778 ms                  |
| Backward                  | 113.449 ms                | 139.140 ms                |
| Optimize                  | 26.382 ms                 | 51.159 ms                 |
| BarrierTimeBeforeRank0    | 51.605 us                 | 83.929 us                 |
| BlockToStepN              | 18.877 us                 | 214.396 us                |
| OneStep                   | 173.093 ms                | 214.208 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 20.633, sample: 0.308, forward: 4.954, backward: 12.380, update: 0.226
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 20.630, sample: 0.308, forward: 4.965, backward: 12.394, update: 0.234
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 20.631, sample: 0.325, forward: 4.938, backward: 12.404, update: 0.319
[Rank7] pid = 24431
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 1759,    16,  3135,  3814, 13532, 14020,  1153,   443, 13592,  9783]) tensor([ 1769,  7294,  4874, 13089, 11932,  1076,   568,  6161,   509,  9805])
-------Step 1-------
tensor([ 1759,    16,  3135,  3814, 13532, 14020,  1153,   443, 13592,  9783]) tensor([ 4051, 12353, 11937,  1555,  1079,  6082, 14509, 12023,  5664, 11198])
-------Step 2-------
tensor([ 6411,  9154,  4487,  4063, 11107,  9094, 11032,    81, 12765,   956]) tensor([ 4009,  4134,  3329,  9127,  4832, 10486, 11420, 10322, 13946, 11780])
-------Step 3-------
tensor([ 6411,  9154,  4487,  4063, 11107,  9094, 11032,    81, 12765,   956]) tensor([ 9211,  5496,  8863, 12912,  8479,   701,  5108,  2545, 13770,  2490])
-------Step 4-------
tensor([   16, 13282,  8160,  5732,  6369,  4069,    73,  7493,  8991,   969]) tensor([ 609, 1134, 3497, 2723, 3236, 2318,  443, 8111, 4651, 2073])
-------Step 5-------
tensor([   16, 13282,  8160,  5732,  6369,  4069,    73,  7493,  8991,   969]) tensor([8668, 5853, 7258, 1973, 3900,  835,  813, 1450, 7333, 5450])
-------Step 6-------
tensor([ 1534,  6984,    19,    66,  9323,  2814,  6992, 12378, 14648, 14157]) tensor([ 9154,  3130,  5975,  3330, 11020,  7835,  4924,  7314, 10901,  9968])
-------Step 7-------
tensor([ 1534,  6984,    19,    66,  9323,  2814,  6992, 12378, 14648, 14157]) tensor([14016, 11144,  4633,  5424,  1245, 10504,  8719,  4032,   143, 10562])
-------Step 8-------
tensor([ 3083,  6046,  6070, 13803,    72,     4, 11711, 10401,    43,  1847]) tensor([ 7246,  5238,  3866,  6361,  2801, 11706,  8003,  1357, 11025,  2850])
-------Step 9-------
tensor([ 3083,  6046,  6070, 13803,    72,     4, 11711, 10401,    43,  1847]) tensor([13614,  4132, 10683,  6408, 14924, 14574, 11584, 12023,   673, 14151])
before start barrier
start train
[proc 0] 100 steps, total: 20.626, sample: 0.383, forward: 4.923, backward: 12.663, update: 2.509
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 20.629, sample: 0.338, forward: 4.925, backward: 12.416, update: 0.370
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 20.633, sample: 0.328, forward: 4.941, backward: 12.394, update: 0.369
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 20.614, sample: 0.326, forward: 4.908, backward: 12.410, update: 0.388
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 20.626, sample: 0.324, forward: 4.951, backward: 12.388, update: 0.280
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.726 ms                  | 21.435 ms                 |
| bucket keys               | 2.520 ms                  | 3.710 ms                  |
| forward: a2a keys         | 2.339 ms                  | 9.874 ms                  |
| forward: search cache     | 458.019 us                | 611.079 us                |
| forward: a2a values       | 3.763 ms                  | 6.490 ms                  |
| forward: join             | 2.169 ms                  | 3.358 ms                  |
| Forward                   | 30.202 ms                 | 47.136 ms                 |
| back: aggr dram keys      | 39.474 ms                 | 56.608 ms                 |
| back: set dram grad       | 2.688 ms                  | 6.898 ms                  |
| back: a2a grad            | 7.463 ms                  | 9.745 ms                  |
| back: grad sum & grad cache  | 5.199 ms                  | 9.650 ms                  |
| Backward                  | 113.257 ms                | 139.140 ms                |
| Optimize                  | 23.329 ms                 | 51.159 ms                 |
| BarrierTimeBeforeRank0    | 50.235 us                 | 83.929 us                 |
| BlockToStepN              | 22.847 us                 | 214.396 us                |
| OneStep                   | 172.703 ms                | 214.208 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.717 ms                  | 24.183 ms                 |
| bucket keys               | 2.509 ms                  | 3.704 ms                  |
| forward: a2a keys         | 2.340 ms                  | 11.650 ms                 |
| forward: search cache     | 456.028 us                | 584.235 us                |
| forward: a2a values       | 3.750 ms                  | 6.452 ms                  |
| forward: join             | 2.167 ms                  | 3.358 ms                  |
| Forward                   | 30.173 ms                 | 48.591 ms                 |
| back: aggr dram keys      | 39.321 ms                 | 56.608 ms                 |
| back: set dram grad       | 2.725 ms                  | 6.764 ms                  |
| back: a2a grad            | 7.463 ms                  | 9.745 ms                  |
| back: grad sum & grad cache  | 5.199 ms                  | 9.650 ms                  |
| Backward                  | 112.771 ms                | 151.649 ms                |
| Optimize                  | 24.056 ms                 | 51.159 ms                 |
| BarrierTimeBeforeRank0    | 49.224 us                 | 84.076 us                 |
| BlockToStepN              | 22.224 us                 | 214.396 us                |
| OneStep                   | 172.703 ms                | 214.208 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.732 ms                  | 23.080 ms                 |
| bucket keys               | 2.525 ms                  | 3.710 ms                  |
| forward: a2a keys         | 2.328 ms                  | 21.296 ms                 |
| forward: search cache     | 456.386 us                | 686.406 us                |
| forward: a2a values       | 3.736 ms                  | 6.490 ms                  |
| forward: join             | 2.165 ms                  | 3.430 ms                  |
| Forward                   | 30.173 ms                 | 50.152 ms                 |
| back: aggr dram keys      | 39.495 ms                 | 59.096 ms                 |
| back: set dram grad       | 2.761 ms                  | 6.764 ms                  |
| back: a2a grad            | 7.433 ms                  | 9.745 ms                  |
| back: grad sum & grad cache  | 5.199 ms                  | 9.650 ms                  |
| Backward                  | 112.543 ms                | 139.140 ms                |
| Optimize                  | 24.853 ms                 | 36.401 ms                 |
| BarrierTimeBeforeRank0    | 49.481 us                 | 83.929 us                 |
| BlockToStepN              | 23.276 us                 | 201.322 us                |
| OneStep                   | 173.093 ms                | 207.043 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.776 ms                  | 23.080 ms                 |
| bucket keys               | 2.534 ms                  | 3.710 ms                  |
| forward: a2a keys         | 2.361 ms                  | 21.650 ms                 |
| forward: search cache     | 459.976 us                | 611.079 us                |
| forward: a2a values       | 3.750 ms                  | 6.841 ms                  |
| forward: join             | 2.169 ms                  | 3.430 ms                  |
| Forward                   | 30.419 ms                 | 52.224 ms                 |
| back: aggr dram keys      | 39.495 ms                 | 56.608 ms                 |
| back: set dram grad       | 2.762 ms                  | 6.761 ms                  |
| back: a2a grad            | 7.387 ms                  | 10.299 ms                 |
| back: grad sum & grad cache  | 5.199 ms                  | 9.503 ms                  |
| Backward                  | 112.486 ms                | 139.140 ms                |
| Optimize                  | 24.853 ms                 | 36.401 ms                 |
| BarrierTimeBeforeRank0    | 49.481 us                 | 84.076 us                 |
| BlockToStepN              | 26.294 us                 | 214.396 us                |
| OneStep                   | 174.787 ms                | 207.043 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 200 steps, total: 17.801, sample: 0.387, forward: 3.465, backward: 11.094, update: 0.339
[proc 0] 200 steps, total: 17.801, sample: 0.435, forward: 3.450, backward: 11.385, update: 2.403
[proc 7] 200 steps, total: 17.801, sample: 0.369, forward: 3.473, backward: 11.099, update: 0.286
[proc 3] 200 steps, total: 17.801, sample: 0.359, forward: 3.489, backward: 11.095, update: 0.223
[proc 4] 200 steps, total: 17.801, sample: 0.385, forward: 3.461, backward: 11.087, update: 0.342
[proc 2] 200 steps, total: 17.801, sample: 0.352, forward: 3.455, backward: 11.093, update: 0.339
[proc 5] 200 steps, total: 17.801, sample: 0.342, forward: 3.513, backward: 11.079, update: 0.206
[proc 1] 200 steps, total: 17.801, sample: 0.361, forward: 3.486, backward: 11.104, update: 0.336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.767 ms                  | 24.183 ms                 |
| bucket keys               | 2.541 ms                  | 3.745 ms                  |
| forward: a2a keys         | 2.375 ms                  | 21.886 ms                 |
| forward: search cache     | 462.011 us                | 904.524 us                |
| forward: a2a values       | 3.725 ms                  | 6.575 ms                  |
| forward: join             | 2.183 ms                  | 3.758 ms                  |
| Forward                   | 30.597 ms                 | 52.852 ms                 |
| back: aggr dram keys      | 39.474 ms                 | 55.590 ms                 |
| back: set dram grad       | 2.785 ms                  | 6.062 ms                  |
| back: a2a grad            | 7.411 ms                  | 9.813 ms                  |
| back: grad sum & grad cache  | 5.199 ms                  | 8.954 ms                  |
| Backward                  | 112.058 ms                | 139.140 ms                |
| Optimize                  | 25.121 ms                 | 38.024 ms                 |
| BarrierTimeBeforeRank0    | 49.415 us                 | 84.076 us                 |
| BlockToStepN              | 24.602 us                 | 214.396 us                |
| OneStep                   | 175.817 ms                | 207.043 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.760 ms                  | 23.080 ms                 |
| bucket keys               | 2.546 ms                  | 3.829 ms                  |
| forward: a2a keys         | 2.401 ms                  | 22.021 ms                 |
| forward: search cache     | 463.118 us                | 904.524 us                |
| forward: a2a values       | 3.714 ms                  | 6.841 ms                  |
| forward: join             | 2.193 ms                  | 3.758 ms                  |
| Forward                   | 30.823 ms                 | 54.296 ms                 |
| back: aggr dram keys      | 39.531 ms                 | 56.608 ms                 |
| back: set dram grad       | 2.794 ms                  | 6.062 ms                  |
| back: a2a grad            | 7.384 ms                  | 10.239 ms                 |
| back: grad sum & grad cache  | 5.297 ms                  | 9.503 ms                  |
| Backward                  | 112.058 ms                | 136.840 ms                |
| Optimize                  | 25.282 ms                 | 38.024 ms                 |
| BarrierTimeBeforeRank0    | 49.415 us                 | 83.929 us                 |
| BlockToStepN              | 25.373 us                 | 214.396 us                |
| OneStep                   | 176.997 ms                | 207.556 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.731 ms                  | 23.080 ms                 |
| bucket keys               | 2.544 ms                  | 3.820 ms                  |
| forward: a2a keys         | 2.401 ms                  | 22.100 ms                 |
| forward: search cache     | 463.758 us                | 698.239 us                |
| forward: a2a values       | 3.714 ms                  | 6.575 ms                  |
| forward: join             | 2.197 ms                  | 3.663 ms                  |
| Forward                   | 30.987 ms                 | 54.911 ms                 |
| back: aggr dram keys      | 39.747 ms                 | 55.590 ms                 |
| back: set dram grad       | 2.809 ms                  | 6.062 ms                  |
| back: a2a grad            | 7.399 ms                  | 10.299 ms                 |
| back: grad sum & grad cache  | 5.199 ms                  | 8.954 ms                  |
| Backward                  | 112.305 ms                | 138.320 ms                |
| Optimize                  | 25.456 ms                 | 38.024 ms                 |
| BarrierTimeBeforeRank0    | 49.151 us                 | 84.076 us                 |
| BlockToStepN              | 25.625 us                 | 214.396 us                |
| OneStep                   | 177.373 ms                | 210.247 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 300 steps, total: 18.647, sample: 0.344, forward: 3.958, backward: 11.228, update: 0.301
[proc 4] 300 steps, total: 18.647, sample: 0.334, forward: 3.967, backward: 11.235, update: 0.284
[proc 2] 300 steps, total: 18.647, sample: 0.302, forward: 3.938, backward: 11.237, update: 0.323
[proc 3] 300 steps, total: 18.647, sample: 0.333, forward: 3.965, backward: 11.257, update: 0.295
[proc 7] 300 steps, total: 18.647, sample: 0.356, forward: 3.948, backward: 11.240, update: 0.296
[proc 6] 300 steps, total: 18.647, sample: 0.325, forward: 3.979, backward: 11.233, update: 0.286
[proc 1] 300 steps, total: 18.647, sample: 0.343, forward: 3.962, backward: 11.259, update: 0.328
[proc 0] 300 steps, total: 18.647, sample: 0.367, forward: 3.991, backward: 11.503, update: 2.664
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.721 ms                  | 23.080 ms                 |
| bucket keys               | 2.551 ms                  | 3.829 ms                  |
| forward: a2a keys         | 2.412 ms                  | 22.349 ms                 |
| forward: search cache     | 465.325 us                | 904.524 us                |
| forward: a2a values       | 3.719 ms                  | 6.841 ms                  |
| forward: join             | 2.206 ms                  | 3.758 ms                  |
| Forward                   | 31.294 ms                 | 59.550 ms                 |
| back: aggr dram keys      | 39.626 ms                 | 55.590 ms                 |
| back: set dram grad       | 2.813 ms                  | 6.062 ms                  |
| back: a2a grad            | 7.385 ms                  | 10.607 ms                 |
| back: grad sum & grad cache  | 5.199 ms                  | 9.503 ms                  |
| Backward                  | 112.305 ms                | 139.140 ms                |
| Optimize                  | 25.828 ms                 | 39.835 ms                 |
| BarrierTimeBeforeRank0    | 49.165 us                 | 84.076 us                 |
| BlockToStepN              | 24.981 us                 | 214.396 us                |
| OneStep                   | 178.487 ms                | 214.208 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.716 ms                  | 23.080 ms                 |
| bucket keys               | 2.553 ms                  | 3.829 ms                  |
| forward: a2a keys         | 2.427 ms                  | 22.349 ms                 |
| forward: search cache     | 465.915 us                | 925.024 us                |
| forward: a2a values       | 3.722 ms                  | 6.959 ms                  |
| forward: join             | 2.214 ms                  | 4.258 ms                  |
| Forward                   | 31.383 ms                 | 59.894 ms                 |
| back: aggr dram keys      | 39.747 ms                 | 55.590 ms                 |
| back: set dram grad       | 2.818 ms                  | 6.271 ms                  |
| back: a2a grad            | 7.383 ms                  | 10.396 ms                 |
| back: grad sum & grad cache  | 5.199 ms                  | 9.058 ms                  |
| Backward                  | 112.374 ms                | 144.082 ms                |
| Optimize                  | 26.109 ms                 | 39.835 ms                 |
| BarrierTimeBeforeRank0    | 49.135 us                 | 84.076 us                 |
| BlockToStepN              | 25.625 us                 | 214.396 us                |
| OneStep                   | 179.357 ms                | 223.578 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.697 ms                  | 23.061 ms                 |
| bucket keys               | 2.550 ms                  | 3.926 ms                  |
| forward: a2a keys         | 2.443 ms                  | 23.722 ms                 |
| forward: search cache     | 465.473 us                | 1.226 ms                  |
| forward: a2a values       | 3.722 ms                  | 6.964 ms                  |
| forward: join             | 2.218 ms                  | 4.258 ms                  |
| Forward                   | 31.574 ms                 | 59.550 ms                 |
| back: aggr dram keys      | 39.868 ms                 | 55.590 ms                 |
| back: set dram grad       | 2.825 ms                  | 6.271 ms                  |
| back: a2a grad            | 7.382 ms                  | 10.708 ms                 |
| back: grad sum & grad cache  | 5.297 ms                  | 9.058 ms                  |
| Backward                  | 112.305 ms                | 141.364 ms                |
| Optimize                  | 26.004 ms                 | 39.706 ms                 |
| BarrierTimeBeforeRank0    | 48.503 us                 | 83.929 us                 |
| BlockToStepN              | 25.796 us                 | 204.350 us                |
| OneStep                   | 179.591 ms                | 216.702 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.677 ms                  | 23.061 ms                 |
| bucket keys               | 2.551 ms                  | 3.926 ms                  |
| forward: a2a keys         | 2.460 ms                  | 23.722 ms                 |
| forward: search cache     | 465.397 us                | 925.024 us                |
| forward: a2a values       | 3.714 ms                  | 6.959 ms                  |
| forward: join             | 2.217 ms                  | 3.975 ms                  |
| Forward                   | 31.678 ms                 | 59.550 ms                 |
| back: aggr dram keys      | 39.885 ms                 | 56.358 ms                 |
| back: set dram grad       | 2.831 ms                  | 6.062 ms                  |
| back: a2a grad            | 7.370 ms                  | 10.708 ms                 |
| back: grad sum & grad cache  | 5.199 ms                  | 9.503 ms                  |
| Backward                  | 112.501 ms                | 141.364 ms                |
| Optimize                  | 25.828 ms                 | 39.706 ms                 |
| BarrierTimeBeforeRank0    | 48.400 us                 | 83.929 us                 |
| BlockToStepN              | 25.738 us                 | 214.396 us                |
| OneStep                   | 180.098 ms                | 216.702 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 18.604, sample: 0.335, forward: 4.044, backward: 11.332, update: 0.301
[proc 0] 400 steps, total: 18.604, sample: 0.362, forward: 4.068, backward: 11.557, update: 2.499
[proc 2] 400 steps, total: 18.604, sample: 0.333, forward: 3.983, backward: 11.330, update: 0.326
[proc 5] 400 steps, total: 18.604, sample: 0.371, forward: 4.018, backward: 11.310, update: 0.314
[proc 4] 400 steps, total: 18.604, sample: 0.368, forward: 4.008, backward: 11.309, update: 0.270
[proc 6] 400 steps, total: 18.604, sample: 0.386, forward: 3.994, backward: 11.324, update: 0.351
[proc 1] 400 steps, total: 18.604, sample: 0.370, forward: 4.015, backward: 11.321, update: 0.335
[proc 7] 400 steps, total: 18.604, sample: 0.338, forward: 4.061, backward: 11.300, update: 0.323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.657 ms                  | 23.061 ms                 |
| bucket keys               | 2.549 ms                  | 3.926 ms                  |
| forward: a2a keys         | 2.463 ms                  | 23.722 ms                 |
| forward: search cache     | 465.286 us                | 925.024 us                |
| forward: a2a values       | 3.679 ms                  | 6.959 ms                  |
| forward: join             | 2.217 ms                  | 3.975 ms                  |
| Forward                   | 31.647 ms                 | 59.550 ms                 |
| back: aggr dram keys      | 39.951 ms                 | 56.358 ms                 |
| back: set dram grad       | 2.831 ms                  | 6.062 ms                  |
| back: a2a grad            | 7.361 ms                  | 10.913 ms                 |
| back: grad sum & grad cache  | 5.178 ms                  | 9.503 ms                  |
| Backward                  | 112.305 ms                | 144.082 ms                |
| Optimize                  | 25.362 ms                 | 39.706 ms                 |
| BarrierTimeBeforeRank0    | 47.280 us                 | 83.929 us                 |
| BlockToStepN              | 25.373 us                 | 214.396 us                |
| OneStep                   | 179.562 ms                | 223.578 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.643 ms                  | 23.219 ms                 |
| bucket keys               | 2.547 ms                  | 3.829 ms                  |
| forward: a2a keys         | 2.477 ms                  | 23.670 ms                 |
| forward: search cache     | 464.956 us                | 904.524 us                |
| forward: a2a values       | 3.676 ms                  | 6.959 ms                  |
| forward: join             | 2.216 ms                  | 3.758 ms                  |
| Forward                   | 31.864 ms                 | 59.894 ms                 |
| back: aggr dram keys      | 40.080 ms                 | 56.246 ms                 |
| back: set dram grad       | 2.830 ms                  | 6.062 ms                  |
| back: a2a grad            | 7.370 ms                  | 10.708 ms                 |
| back: grad sum & grad cache  | 5.199 ms                  | 9.058 ms                  |
| Backward                  | 112.171 ms                | 144.082 ms                |
| Optimize                  | 24.866 ms                 | 39.706 ms                 |
| BarrierTimeBeforeRank0    | 46.997 us                 | 83.929 us                 |
| BlockToStepN              | 25.373 us                 | 214.396 us                |
| OneStep                   | 179.042 ms                | 223.578 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.634 ms                  | 23.080 ms                 |
| bucket keys               | 2.546 ms                  | 3.829 ms                  |
| forward: a2a keys         | 2.481 ms                  | 24.093 ms                 |
| forward: search cache     | 464.951 us                | 904.524 us                |
| forward: a2a values       | 3.667 ms                  | 6.959 ms                  |
| forward: join             | 2.217 ms                  | 3.975 ms                  |
| Forward                   | 31.871 ms                 | 59.550 ms                 |
| back: aggr dram keys      | 39.951 ms                 | 56.246 ms                 |
| back: set dram grad       | 2.833 ms                  | 6.062 ms                  |
| back: a2a grad            | 7.370 ms                  | 10.708 ms                 |
| back: grad sum & grad cache  | 5.199 ms                  | 9.058 ms                  |
| Backward                  | 112.066 ms                | 143.652 ms                |
| Optimize                  | 24.052 ms                 | 38.024 ms                 |
| BarrierTimeBeforeRank0    | 46.636 us                 | 83.052 us                 |
| BlockToStepN              | 25.917 us                 | 209.357 us                |
| OneStep                   | 178.970 ms                | 216.702 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.618 ms                  | 23.080 ms                 |
| bucket keys               | 2.545 ms                  | 3.926 ms                  |
| forward: a2a keys         | 2.495 ms                  | 24.093 ms                 |
| forward: search cache     | 464.883 us                | 904.524 us                |
| forward: a2a values       | 3.652 ms                  | 6.873 ms                  |
| forward: join             | 2.217 ms                  | 3.785 ms                  |
| Forward                   | 31.908 ms                 | 59.550 ms                 |
| back: aggr dram keys      | 40.061 ms                 | 56.358 ms                 |
| back: set dram grad       | 2.836 ms                  | 6.222 ms                  |
| back: a2a grad            | 7.377 ms                  | 10.607 ms                 |
| back: grad sum & grad cache  | 5.217 ms                  | 9.058 ms                  |
| Backward                  | 112.136 ms                | 144.082 ms                |
| Optimize                  | 23.405 ms                 | 38.024 ms                 |
| BarrierTimeBeforeRank0    | 46.511 us                 | 83.052 us                 |
| BlockToStepN              | 26.136 us                 | 209.357 us                |
| OneStep                   | 178.970 ms                | 223.578 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 500 steps, total: 17.698, sample: 0.347, forward: 3.818, backward: 11.217, update: 0.300
[proc 7] 500 steps, total: 17.698, sample: 0.379, forward: 3.765, backward: 11.246, update: 0.288
[proc 1] 500 steps, total: 17.698, sample: 0.369, forward: 3.765, backward: 11.252, update: 0.322
[proc 3] 500 steps, total: 17.699, sample: 0.336, forward: 3.803, backward: 11.245, update: 0.230
[proc 2] 500 steps, total: 17.699, sample: 0.380, forward: 3.686, backward: 11.258, update: 0.329
[proc 5] 500 steps, total: 17.699, sample: 0.357, forward: 3.786, backward: 11.231, update: 0.315
[proc 0] 500 steps, total: 17.699, sample: 0.356, forward: 3.805, backward: 11.503, update: 1.933
[proc 4] 500 steps, total: 17.699, sample: 0.367, forward: 3.775, backward: 11.225, update: 0.328
Successfully xmh. training takes 93.37734246253967 seconds
before call kg_cache_controller.StopThreads()
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
INFO [23842 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
