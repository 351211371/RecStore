WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 20:40:40.120160 16791 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_8', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [16791 sampler.py:454] Start PreSampling
WARNING [16791 sampler.py:532] Before construct renumbering_dict
WARNING [16791 sampler.py:555] PreSampling done
W20240205 20:40:45.669492 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 20:40:45.669701 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 20:40:45.669739 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 20:40:45.669783 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 20:40:45.669813 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 20:40:45.669849 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 20:40:45.669883 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 20:40:45.669917 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 20:40:45.669942 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 20:40:45.669986 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 20:40:45.670024 16791 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 20:40:45.670053 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 20:40:45.670080 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 20:40:45.670212 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 20:40:45.670248 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 20:40:45.670272 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 20:40:45.670341 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 20:40:45.670379 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 20:40:45.670414 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 20:40:45.670449 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 20:40:45.670482 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 20:40:45.670516 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 20:40:45.670550 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 20:40:45.670578 16791 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 20:40:45.670603 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 20:40:45.670624 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 20:40:45.670684 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 20:40:45.670713 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 20:40:45.670748 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 20:40:45.670782 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 20:40:45.670814 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 20:40:45.670848 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 20:40:45.670883 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 20:40:45.670907 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 20:40:45.670948 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 20:40:45.670976 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 20:40:45.671011 16791 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 20:40:45.671032 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 20:40:45.671056 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 20:40:45.671103 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 20:40:45.671130 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 20:40:45.671155 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 20:40:45.671182 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 20:40:45.671211 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 20:40:45.671238 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 20:40:45.671263 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 20:40:45.671296 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 20:40:45.671332 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 20:40:45.671360 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 20:40:45.671383 16791 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 20:40:45.671403 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 20:40:45.671425 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 20:40:45.671500 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 20:40:45.671536 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 20:40:45.671566 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 20:40:45.671591 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 20:40:45.671615 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 20:40:45.671648 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 20:40:45.671675 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 20:40:45.671705 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 20:40:45.671730 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 20:40:45.671762 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 20:40:45.671797 16791 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 20:40:45.671818 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 20:40:45.671849 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 20:40:45.671900 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 20:40:45.671934 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 20:40:45.671968 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 20:40:45.671993 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 20:40:45.672020 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 20:40:45.672045 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 20:40:45.672101 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 20:40:45.672135 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 20:40:45.672160 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 20:40:45.672185 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 20:40:45.672209 16791 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 20:40:45.672230 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 20:40:45.672258 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 20:40:45.672310 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240205 20:40:45.672339 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240205 20:40:45.672363 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240205 20:40:45.672395 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240205 20:40:45.672420 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240205 20:40:45.672462 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240205 20:40:45.672497 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240205 20:40:45.672530 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240205 20:40:45.672555 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240205 20:40:45.672588 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240205 20:40:45.672628 16791 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240205 20:40:45.672649 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240205 20:40:45.672669 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240205 20:40:45.672716 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240205 20:40:45.672745 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240205 20:40:45.672776 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240205 20:40:45.672811 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240205 20:40:45.672845 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240205 20:40:45.672871 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240205 20:40:45.672899 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240205 20:40:45.672940 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240205 20:40:45.672974 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240205 20:40:45.673003 16791 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240205 20:40:45.673028 16791 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240205 20:40:45.673049 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240205 20:40:45.673069 16791 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240205 20:40:45.901547 16791 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240205 20:40:45.982250 16791 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([  757,  1166,  1666,  ..., 12079, 10171,  7488]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.962 seconds
[Rank1] pid = 17011
[Rank2] pid = 17037
[Rank3] pid = 17141
[Rank4] pid = 17143
[Rank5] pid = 17191
[Rank6] pid = 17271
INFO [16791 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [17011 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [17037 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [17141 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [17143 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [17191 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [17337 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [17271 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [17337 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17271 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17191 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17143 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17037 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17141 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17011 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [16791 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240205 20:40:48.716114 17270 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240205 20:40:48.716217 17340 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240205 20:40:48.716364 17532 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240205 20:40:48.716439 17207 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240205 20:40:48.716578 17142 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240205 20:40:48.716775 17341 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240205 20:40:48.720625 17012 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240205 20:40:48.720703 17077 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240205 20:40:48.743057 17532 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100027a06000 7.629 MB
W20240205 20:40:48.743242 17532 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1000281a9000 7.629 MB
W20240205 20:40:48.743307 17532 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10002894c000 1.49 GB
W20240205 20:40:48.743358 17532 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x100087f2f000 1.49 GB
W20240205 20:40:48.743431 17532 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 20:40:48.745255 17532 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240205 20:40:48.747359 17340 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1000e7518000 7.629 MB
W20240205 20:40:48.747543 17340 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000e7cbb000 7.629 MB
W20240205 20:40:48.747611 17340 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1000e845e000 1.49 GB
W20240205 20:40:48.747679 17340 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x100147a41000 1.49 GB
W20240205 20:40:48.747730 17340 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 20:40:48.750097 17340 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240205 20:40:48.750259 17207 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1001a702c000 7.629 MB
W20240205 20:40:48.750334 17270 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1001a77cf000 7.629 MB
W20240205 20:40:48.750375 17142 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1001a7f72000 7.629 MB
W20240205 20:40:48.750419 17207 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1001a8715000 7.629 MB
W20240205 20:40:48.750488 17207 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1001a8eb8000 1.49 GB
W20240205 20:40:48.750496 17270 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10020849b000 7.629 MB
W20240205 20:40:48.750545 17207 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x100208c3e000 1.49 GB
W20240205 20:40:48.750571 17270 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x100268221000 1.49 GB
W20240205 20:40:48.750599 17207 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 20:40:48.750622 17142 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1002c7804000 7.629 MB
W20240205 20:40:48.750630 17270 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1002c7fa7000 1.49 GB
W20240205 20:40:48.750699 17270 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 20:40:48.750720 17142 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10032758a000 1.49 GB
W20240205 20:40:48.750777 17142 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100386b6d000 1.49 GB
W20240205 20:40:48.750819 17142 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 20:40:48.757266 17207 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 20:40:48.757269 17270 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240205 20:40:48.757303 17142 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 20:40:48.763610 17077 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1003e6160000 7.629 MB
W20240205 20:40:48.763953 17077 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1003e6903000 7.629 MB
W20240205 20:40:48.764020 17077 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1003e70a6000 1.49 GB
W20240205 20:40:48.764071 17077 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x100446689000 1.49 GB
W20240205 20:40:48.764196 17077 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 20:40:48.767498 17077 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 20:40:48.787812 17012 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1004a5c72000 7.629 MB
W20240205 20:40:48.787935 17012 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1004a6415000 7.629 MB
W20240205 20:40:48.788020 17012 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1004a6bb8000 1.49 GB
W20240205 20:40:48.788079 17012 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10050619b000 1.49 GB
W20240205 20:40:48.788136 17012 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 20:40:48.790192 17012 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 20:40:48.794976 17341 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100565784000 7.629 MB
W20240205 20:40:48.795135 17341 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100565f27000 7.629 MB
W20240205 20:40:48.795219 17341 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1005666ca000 1.49 GB
W20240205 20:40:48.795287 17341 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1005c5cad000 1.49 GB
W20240205 20:40:48.795351 17341 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 20:40:48.799002 17341 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [17141 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [17011 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [17037 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [17143 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [17191 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [17271 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [17337 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 17337
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [16791 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 20:40:51.412144 17341 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240205 20:40:51.412673 17207 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:40:51.412791 17142 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:40:51.413549 17077 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:40:51.413805 17270 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:40:51.413894 17012 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:40:51.413976 17532 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240205 20:40:51.414059 17340 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240205 20:40:51.418282 17341 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 20:40:51.418591 17341 grad_base.h:184] Init GradProcessingBase done
I20240205 20:40:51.425360 17341 grad_async_v1.h:203] Use main thread to update emb.
W20240205 20:40:51.425493 17341 kg_controller.h:75] after init GradAsyncProcessing
I20240205 20:40:51.425520 17341 kg_controller.h:84] Construct KGCacheController done
E20240205 20:40:52.197182 17142 recstore.cc:66] init folly done
E20240205 20:40:52.198252 17270 recstore.cc:66] init folly done
E20240205 20:40:52.198318 17012 recstore.cc:66] init folly done
E20240205 20:40:52.198323 17340 recstore.cc:66] init folly done
E20240205 20:40:52.198321 17341 recstore.cc:66] init folly done
E20240205 20:40:52.198339 17207 recstore.cc:66] init folly done
E20240205 20:40:52.198343 17532 recstore.cc:66] init folly done
E20240205 20:40:52.198345 17077 recstore.cc:66] init folly done
I20240205 20:40:52.199469 17341 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 20:40:53.086643 17341 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240205 20:40:53.100819 17012 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:40:53.105270 17142 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:40:53.105620 17077 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:40:53.105980 17270 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:40:53.106017 17340 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:40:53.106057 17207 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240205 20:40:53.108624 17532 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240205 20:40:55.266781 17687 grad_async_v1.h:533] Stalled in ProcessBackward: rank=4, step_no=1, sample_step_cpp_seen_[rank]=0
W20240205 20:40:55.909761 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.080 ms                  | 22.996 ms                 |
| Forward                   | 4.571 ms                  | 432.099 ms                |
| Backward                  | 4.012 ms                  | 209.127 ms                |
| Optimize                  | 1.740 ms                  | 47.887 ms                 |
| BarrierTimeBeforeRank0    | 6.456 ms                  | 34.151 ms                 |
| AfterBackward             | 25.648 ms                 | 1.378 s                   |
| BlockToStepN              | 54.834 us                 | 118.739 ms                |
| OneStep                   | 47.072 ms                 | 2.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 20:40:56.909024 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=18, pq.top=18
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.485 ms                  | 374.905 ms                |
| ProcessBack:UpdateCache   | 10.254 ms                 | 708.728 ms                |
| ProcessBack:UpsertPq      | 7.369 ms                  | 26.243 ms                 |
| ProcessOneStep            | 25.867 ms                 | 1.377 s                   |
| BlockToStepN              | 669.000 ns                | 315.477 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:40:57.927356 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=24, pq.top=24
W20240205 20:40:58.927023 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240205 20:40:59.946538 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=38, pq.top=38
W20240205 20:41:00.946005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=44, pq.top=44
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.596 ms                  | 22.996 ms                 |
| Forward                   | 4.749 ms                  | 432.099 ms                |
| Backward                  | 4.807 ms                  | 209.127 ms                |
| Optimize                  | 1.781 ms                  | 47.887 ms                 |
| BarrierTimeBeforeRank0    | 5.135 ms                  | 34.151 ms                 |
| AfterBackward             | 27.587 ms                 | 1.378 s                   |
| BlockToStepN              | 94.187 ms                 | 315.701 ms                |
| OneStep                   | 145.433 ms                | 2.105 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:01.946005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=50, pq.top=50
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.677 ms                  | 335.594 ms                |
| ProcessBack:UpdateCache   | 9.764 ms                  | 708.454 ms                |
| ProcessBack:UpsertPq      | 8.719 ms                  | 24.452 ms                 |
| ProcessOneStep            | 27.560 ms                 | 149.018 ms                |
| BlockToStepN              | 98.510 ms                 | 205.752 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:02.946009 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240205 20:41:03.946853 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=62, pq.top=62
W20240205 20:41:04.946007 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240205 20:41:05.946007 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=72, pq.top=72
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.330 ms                  | 18.710 ms                 |
| Forward                   | 4.657 ms                  | 25.066 ms                 |
| Backward                  | 4.748 ms                  | 12.283 ms                 |
| Optimize                  | 1.806 ms                  | 5.359 ms                  |
| BarrierTimeBeforeRank0    | 4.799 ms                  | 18.340 ms                 |
| AfterBackward             | 27.887 ms                 | 149.091 ms                |
| BlockToStepN              | 107.032 ms                | 205.963 ms                |
| OneStep                   | 159.105 ms                | 357.924 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:06.974653 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=78, pq.top=78
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.660 ms                  | 14.167 ms                 |
| ProcessBack:UpdateCache   | 10.093 ms                 | 11.772 ms                 |
| ProcessBack:UpsertPq      | 9.028 ms                  | 17.168 ms                 |
| ProcessOneStep            | 27.869 ms                 | 149.018 ms                |
| BlockToStepN              | 109.122 ms                | 205.752 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:07.974012 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240205 20:41:08.974005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=88, pq.top=88
W20240205 20:41:09.987707 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240205 20:41:10.987010 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=98, pq.top=98
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.325 ms                  | 18.710 ms                 |
| Forward                   | 4.617 ms                  | 25.066 ms                 |
| Backward                  | 4.607 ms                  | 12.283 ms                 |
| Optimize                  | 1.795 ms                  | 5.359 ms                  |
| BarrierTimeBeforeRank0    | 5.142 ms                  | 18.340 ms                 |
| AfterBackward             | 27.940 ms                 | 149.091 ms                |
| BlockToStepN              | 118.739 ms                | 206.699 ms                |
| OneStep                   | 170.894 ms                | 357.924 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 18.382, sample: 0.306, forward: 0.875, backward: 0.676, update: 0.206
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 18.383, sample: 0.334, forward: 0.885, backward: 1.163, update: 0.213
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 18.382, sample: 0.329, forward: 0.900, backward: 1.038, update: 0.224
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 18.380, sample: 0.312, forward: 0.891, backward: 1.173, update: 0.225
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 18.383, sample: 0.344, forward: 0.888, backward: 0.580, update: 0.191
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 18.388, sample: 0.328, forward: 0.843, backward: 1.195, update: 0.222
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 18.382, sample: 0.327, forward: 0.905, backward: 1.172, update: 0.225
train_sampler.Prefill()
-------Step 0-------
tensor([ 2590,    87,  2650,  2521, 13904, 13065,  1252,   435, 10674, 12023]) tensor([ 1666, 12346,  8026, 13405,  9152,  1193,   575,  4153,   528, 14119])
-------Step 1-------
tensor([ 2590,    87,  2650,  2521, 13904, 13065,  1252,   435, 10674, 12023]) tensor([ 3094,  7972, 12865,  1818,  1024,  6911, 14712,  7737,  7131, 10052])
-------Step 2-------
tensor([ 5685, 11398,  7479,  3230, 12609,  6935,  8133,    24, 11405,   872]) tensor([ 3975,  5515,  3071, 10675,  6361,  7128, 10404,  7778, 14343, 10837])
-------Step 3-------
tensor([ 5685, 11398,  7479,  3230, 12609,  6935,  8133,    24, 11405,   872]) tensor([11277,  7354,  7771, 11649,  9226,   698,  4196,  2687, 13239,  2295])
-------Step 4-------
tensor([   87, 12618, 13056,  4373,  6375,  4331,    92,  5630, 10285,  1027]) tensor([ 603, 1132, 3228, 3582, 3784, 2617,  435, 9108, 5828, 1947])
-------Step 5-------
tensor([   87, 12618, 13056,  4373,  6375,  4331,    92,  5630, 10285,  1027]) tensor([13441,  6403,  7844,  1511,  4175,   805,   815,  1305,  4319,  5032])
-------Step 6-------
tensor([ 1795, 11382,    60,    23,  9001,  2674, 11605,  9069, 11785,  9945]) tensor([11398,  2557,  6778,  5718,  9643,  9752,  5269,  9866,  7977, 13826])
-------Step 7-------
tensor([ 1795, 11382,    60,    23,  9001,  2674, 11605,  9069, 11785,  9945]) tensor([13523, 13656,  5564,  7235,  1342,  9150,  9458,  4000,   146, 13793])
-------Step 8-------
tensor([ 2832,  8145,  6628, 13279,    63,    81,  7223, 13700,    20,  2226]) tensor([ 4735,  5146,  5155,  7990,  2215, 14103,  9966,  1768, 10458,  3655])
-------Step 9-------
tensor([ 2832,  8145,  6628, 13279,    63,    81,  7223, 13700,    20,  2226]) tensor([13969,  3211, 10166,  7262, 14654, 10284, 13145,  7737,   674, 14095])
before start barrier
start train
[proc 0] 100 steps, total: 18.402, sample: 0.384, forward: 0.935, backward: 0.812, update: 0.239
W20240205 20:41:12.001485 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.600 ms                  | 14.167 ms                 |
| ProcessBack:UpdateCache   | 10.090 ms                 | 11.772 ms                 |
| ProcessBack:UpsertPq      | 9.079 ms                  | 17.168 ms                 |
| ProcessOneStep            | 27.892 ms                 | 149.018 ms                |
| BlockToStepN              | 119.996 ms                | 206.600 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:13.001008 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240205 20:41:14.001006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=112, pq.top=112
W20240205 20:41:15.001011 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240205 20:41:16.001010 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.385 ms                  | 20.783 ms                 |
| Forward                   | 4.628 ms                  | 25.066 ms                 |
| Backward                  | 4.733 ms                  | 13.385 ms                 |
| Optimize                  | 1.807 ms                  | 5.359 ms                  |
| BarrierTimeBeforeRank0    | 4.863 ms                  | 18.340 ms                 |
| AfterBackward             | 27.940 ms                 | 149.091 ms                |
| BlockToStepN              | 126.660 ms                | 207.426 ms                |
| OneStep                   | 176.716 ms                | 357.924 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:17.001008 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.660 ms                  | 13.329 ms                 |
| ProcessBack:UpdateCache   | 10.048 ms                 | 11.676 ms                 |
| ProcessBack:UpsertPq      | 9.134 ms                  | 16.708 ms                 |
| ProcessOneStep            | 27.907 ms                 | 149.018 ms                |
| BlockToStepN              | 128.402 ms                | 207.368 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:18.029671 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240205 20:41:19.029006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=134, pq.top=134
W20240205 20:41:20.029006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=138, pq.top=138
W20240205 20:41:21.029019 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=142, pq.top=142
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.402 ms                  | 22.996 ms                 |
| Forward                   | 4.653 ms                  | 25.066 ms                 |
| Backward                  | 4.806 ms                  | 13.812 ms                 |
| Optimize                  | 1.818 ms                  | 5.359 ms                  |
| BarrierTimeBeforeRank0    | 4.798 ms                  | 19.973 ms                 |
| AfterBackward             | 27.940 ms                 | 149.091 ms                |
| BlockToStepN              | 134.100 ms                | 251.066 ms                |
| OneStep                   | 186.676 ms                | 357.924 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:22.029006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=146, pq.top=146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.682 ms                  | 13.329 ms                 |
| ProcessBack:UpdateCache   | 9.949 ms                  | 11.676 ms                 |
| ProcessBack:UpsertPq      | 9.146 ms                  | 16.708 ms                 |
| ProcessOneStep            | 27.907 ms                 | 149.018 ms                |
| BlockToStepN              | 136.588 ms                | 251.015 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:23.029006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=150, pq.top=150
W20240205 20:41:24.029006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240205 20:41:25.029019 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=158, pq.top=158
W20240205 20:41:26.029006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.435 ms                  | 21.652 ms                 |
| Forward                   | 4.624 ms                  | 10.212 ms                 |
| Backward                  | 5.487 ms                  | 13.385 ms                 |
| Optimize                  | 1.826 ms                  | 3.723 ms                  |
| BarrierTimeBeforeRank0    | 4.538 ms                  | 18.343 ms                 |
| AfterBackward             | 27.916 ms                 | 96.691 ms                 |
| BlockToStepN              | 147.262 ms                | 251.066 ms                |
| OneStep                   | 196.157 ms                | 298.952 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:27.029006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.689 ms                  | 13.329 ms                 |
| ProcessBack:UpdateCache   | 9.891 ms                  | 11.676 ms                 |
| ProcessBack:UpsertPq      | 9.194 ms                  | 16.708 ms                 |
| ProcessOneStep            | 27.869 ms                 | 96.583 ms                 |
| BlockToStepN              | 147.214 ms                | 252.780 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:28.029006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240205 20:41:29.029023 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240205 20:41:30.029006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240205 20:41:31.078341 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.439 ms                  | 21.652 ms                 |
| Forward                   | 4.625 ms                  | 10.212 ms                 |
| Backward                  | 9.459 ms                  | 13.812 ms                 |
| Optimize                  | 1.836 ms                  | 3.723 ms                  |
| BarrierTimeBeforeRank0    | 4.538 ms                  | 18.343 ms                 |
| AfterBackward             | 27.896 ms                 | 96.691 ms                 |
| BlockToStepN              | 155.685 ms                | 255.872 ms                |
| OneStep                   | 205.488 ms                | 306.278 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:32.078006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.698 ms                  | 12.823 ms                 |
| ProcessBack:UpdateCache   | 9.822 ms                  | 11.676 ms                 |
| ProcessBack:UpsertPq      | 9.197 ms                  | 16.015 ms                 |
| ProcessOneStep            | 27.887 ms                 | 96.583 ms                 |
| BlockToStepN              | 157.530 ms                | 260.999 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:33.078016 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240205 20:41:34.109340 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
W20240205 20:41:35.154700 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240205 20:41:36.154006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.473 ms                  | 22.112 ms                 |
| Forward                   | 4.625 ms                  | 10.212 ms                 |
| Backward                  | 9.571 ms                  | 13.812 ms                 |
| Optimize                  | 1.838 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 4.538 ms                  | 19.973 ms                 |
| AfterBackward             | 27.916 ms                 | 96.691 ms                 |
| BlockToStepN              | 161.223 ms                | 261.069 ms                |
| OneStep                   | 210.538 ms                | 318.450 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 24.984, sample: 0.340, forward: 0.436, backward: 1.028, update: 0.186
[proc 7] 200 steps, total: 24.985, sample: 0.343, forward: 0.425, backward: 0.995, update: 0.186
[proc 2] 200 steps, total: 24.985, sample: 0.352, forward: 0.434, backward: 0.953, update: 0.172
[proc 1] 200 steps, total: 24.984, sample: 0.357, forward: 0.476, backward: 0.940, update: 0.184
[proc 4] 200 steps, total: 24.985, sample: 0.336, forward: 0.442, backward: 0.958, update: 0.184
[proc 3] 200 steps, total: 24.985, sample: 0.369, forward: 0.429, backward: 0.837, update: 0.173
[proc 6] 200 steps, total: 24.985, sample: 0.384, forward: 0.462, backward: 0.691, update: 0.176
[proc 0] 200 steps, total: 24.984, sample: 0.434, forward: 0.474, backward: 0.927, update: 0.201
W20240205 20:41:37.194072 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=204, pq.top=204
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.694 ms                  | 12.823 ms                 |
| ProcessBack:UpdateCache   | 9.890 ms                  | 11.676 ms                 |
| ProcessBack:UpsertPq      | 9.226 ms                  | 16.015 ms                 |
| ProcessOneStep            | 27.869 ms                 | 96.583 ms                 |
| BlockToStepN              | 162.489 ms                | 260.999 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:38.194016 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240205 20:41:39.194012 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240205 20:41:40.194006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240205 20:41:41.194006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.473 ms                  | 22.112 ms                 |
| Forward                   | 4.612 ms                  | 10.212 ms                 |
| Backward                  | 9.592 ms                  | 13.812 ms                 |
| Optimize                  | 1.855 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 4.538 ms                  | 19.973 ms                 |
| AfterBackward             | 27.916 ms                 | 96.691 ms                 |
| BlockToStepN              | 168.081 ms                | 271.510 ms                |
| OneStep                   | 218.081 ms                | 343.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:42.194005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.694 ms                  | 12.823 ms                 |
| ProcessBack:UpdateCache   | 9.891 ms                  | 11.676 ms                 |
| ProcessBack:UpsertPq      | 9.272 ms                  | 16.015 ms                 |
| ProcessOneStep            | 27.892 ms                 | 96.583 ms                 |
| BlockToStepN              | 168.671 ms                | 271.436 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:43.194006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240205 20:41:44.194021 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240205 20:41:45.194006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240205 20:41:46.194006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.479 ms                  | 22.112 ms                 |
| Forward                   | 4.624 ms                  | 10.212 ms                 |
| Backward                  | 9.599 ms                  | 13.812 ms                 |
| Optimize                  | 1.859 ms                  | 4.151 ms                  |
| BarrierTimeBeforeRank0    | 4.668 ms                  | 19.973 ms                 |
| AfterBackward             | 27.936 ms                 | 96.691 ms                 |
| BlockToStepN              | 173.369 ms                | 271.510 ms                |
| OneStep                   | 223.130 ms                | 343.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:47.197798 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.689 ms                  | 12.823 ms                 |
| ProcessBack:UpdateCache   | 9.901 ms                  | 11.626 ms                 |
| ProcessBack:UpsertPq      | 9.332 ms                  | 15.904 ms                 |
| ProcessOneStep            | 27.907 ms                 | 96.583 ms                 |
| BlockToStepN              | 174.941 ms                | 271.436 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:48.197008 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240205 20:41:49.197018 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240205 20:41:50.197022 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240205 20:41:51.197005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.486 ms                  | 21.652 ms                 |
| Forward                   | 4.625 ms                  | 10.096 ms                 |
| Backward                  | 9.630 ms                  | 13.385 ms                 |
| Optimize                  | 1.861 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 4.791 ms                  | 18.343 ms                 |
| AfterBackward             | 28.042 ms                 | 37.787 ms                 |
| BlockToStepN              | 176.446 ms                | 271.510 ms                |
| OneStep                   | 228.413 ms                | 343.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:52.197006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=256, pq.top=256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.689 ms                  | 12.823 ms                 |
| ProcessBack:UpdateCache   | 9.901 ms                  | 11.626 ms                 |
| ProcessBack:UpsertPq      | 9.341 ms                  | 16.015 ms                 |
| ProcessOneStep            | 28.023 ms                 | 37.746 ms                 |
| BlockToStepN              | 176.881 ms                | 273.412 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:53.197006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240205 20:41:54.197017 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
W20240205 20:41:55.197012 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240205 20:41:56.197006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.511 ms                  | 21.652 ms                 |
| Forward                   | 4.625 ms                  | 10.096 ms                 |
| Backward                  | 9.648 ms                  | 13.385 ms                 |
| Optimize                  | 1.866 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 4.798 ms                  | 18.343 ms                 |
| AfterBackward             | 28.068 ms                 | 37.787 ms                 |
| BlockToStepN              | 180.405 ms                | 287.778 ms                |
| OneStep                   | 234.792 ms                | 344.948 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:57.197007 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.685 ms                  | 12.823 ms                 |
| ProcessBack:UpdateCache   | 9.904 ms                  | 11.626 ms                 |
| ProcessBack:UpsertPq      | 9.354 ms                  | 16.015 ms                 |
| ProcessOneStep            | 28.043 ms                 | 37.746 ms                 |
| BlockToStepN              | 180.975 ms                | 287.714 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:41:58.197006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=276, pq.top=276
W20240205 20:41:59.197026 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240205 20:42:00.242733 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240205 20:42:01.242007 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.519 ms                  | 22.996 ms                 |
| Forward                   | 4.625 ms                  | 10.096 ms                 |
| Backward                  | 9.652 ms                  | 13.385 ms                 |
| Optimize                  | 1.867 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 4.799 ms                  | 18.343 ms                 |
| AfterBackward             | 28.096 ms                 | 37.787 ms                 |
| BlockToStepN              | 183.075 ms                | 290.349 ms                |
| OneStep                   | 240.649 ms                | 357.924 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 12.267 ms                 |
| ProcessBack:UpdateCache   | 9.905 ms                  | 11.575 ms                 |
| ProcessBack:UpsertPq      | 9.376 ms                  | 16.708 ms                 |
| ProcessOneStep            | 28.071 ms                 | 37.746 ms                 |
| BlockToStepN              | 183.091 ms                | 290.288 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:02.242003 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240205 20:42:03.282611 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240205 20:42:04.295953 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240205 20:42:05.333022 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 2] 300 steps, total: 29.162, sample: 0.300, forward: 0.423, backward: 0.934, update: 0.172
[proc 4] 300 steps, total: 29.162, sample: 0.314, forward: 0.438, backward: 0.967, update: 0.177
[proc 5] 300 steps, total: 29.162, sample: 0.318, forward: 0.438, backward: 1.004, update: 0.183
[proc 7] 300 steps, total: 29.162, sample: 0.328, forward: 0.413, backward: 0.977, update: 0.182
[proc 3] 300 steps, total: 29.162, sample: 0.334, forward: 0.429, backward: 0.943, update: 0.180
[proc 6] 300 steps, total: 29.162, sample: 0.313, forward: 0.427, backward: 0.780, update: 0.180
[proc 0] 300 steps, total: 29.162, sample: 0.422, forward: 0.478, backward: 0.970, update: 0.199
[proc 1] 300 steps, total: 29.162, sample: 0.345, forward: 0.443, backward: 0.949, update: 0.187
W20240205 20:42:06.333005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.519 ms                  | 22.996 ms                 |
| Forward                   | 4.624 ms                  | 10.212 ms                 |
| Backward                  | 9.657 ms                  | 13.385 ms                 |
| Optimize                  | 1.866 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 4.943 ms                  | 18.343 ms                 |
| AfterBackward             | 28.116 ms                 | 43.466 ms                 |
| BlockToStepN              | 187.290 ms                | 301.581 ms                |
| OneStep                   | 245.234 ms                | 369.175 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 12.267 ms                 |
| ProcessBack:UpdateCache   | 9.908 ms                  | 11.575 ms                 |
| ProcessBack:UpsertPq      | 9.401 ms                  | 16.843 ms                 |
| ProcessOneStep            | 28.083 ms                 | 43.437 ms                 |
| BlockToStepN              | 189.222 ms                | 301.487 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:07.333005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=306, pq.top=306
W20240205 20:42:08.342526 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=310, pq.top=310
W20240205 20:42:09.342025 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240205 20:42:10.342005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=316, pq.top=316
W20240205 20:42:11.342007 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.524 ms                  | 22.996 ms                 |
| Forward                   | 4.625 ms                  | 10.212 ms                 |
| Backward                  | 9.663 ms                  | 13.812 ms                 |
| Optimize                  | 1.867 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 5.138 ms                  | 19.973 ms                 |
| AfterBackward             | 28.126 ms                 | 43.466 ms                 |
| BlockToStepN              | 192.287 ms                | 306.954 ms                |
| OneStep                   | 250.490 ms                | 369.175 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 12.267 ms                 |
| ProcessBack:UpdateCache   | 9.975 ms                  | 11.626 ms                 |
| ProcessBack:UpsertPq      | 9.429 ms                  | 16.950 ms                 |
| ProcessOneStep            | 28.097 ms                 | 43.437 ms                 |
| BlockToStepN              | 193.154 ms                | 306.768 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:12.342003 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=322, pq.top=322
W20240205 20:42:13.342006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240205 20:42:14.342015 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240205 20:42:15.342011 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=332, pq.top=332
W20240205 20:42:16.342006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.524 ms                  | 22.996 ms                 |
| Forward                   | 4.625 ms                  | 10.212 ms                 |
| Backward                  | 9.666 ms                  | 13.812 ms                 |
| Optimize                  | 1.878 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 5.152 ms                  | 20.022 ms                 |
| AfterBackward             | 28.140 ms                 | 43.466 ms                 |
| BlockToStepN              | 195.300 ms                | 307.446 ms                |
| OneStep                   | 253.081 ms                | 369.175 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 12.151 ms                 |
| ProcessBack:UpdateCache   | 10.026 ms                 | 11.575 ms                 |
| ProcessBack:UpsertPq      | 9.445 ms                  | 16.950 ms                 |
| ProcessOneStep            | 28.111 ms                 | 43.437 ms                 |
| BlockToStepN              | 196.513 ms                | 307.302 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:17.362447 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240205 20:42:18.362006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=342, pq.top=342
W20240205 20:42:19.362007 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240205 20:42:20.369890 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=349, pq.top=349
W20240205 20:42:21.369005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=352, pq.top=352
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.530 ms                  | 22.112 ms                 |
| Forward                   | 4.624 ms                  | 10.096 ms                 |
| Backward                  | 9.670 ms                  | 13.385 ms                 |
| Optimize                  | 1.879 ms                  | 3.723 ms                  |
| BarrierTimeBeforeRank0    | 5.138 ms                  | 19.973 ms                 |
| AfterBackward             | 28.140 ms                 | 37.787 ms                 |
| BlockToStepN              | 200.677 ms                | 307.446 ms                |
| OneStep                   | 257.990 ms                | 368.252 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 12.151 ms                 |
| ProcessBack:UpdateCache   | 10.013 ms                 | 11.575 ms                 |
| ProcessBack:UpsertPq      | 9.442 ms                  | 16.950 ms                 |
| ProcessOneStep            | 28.100 ms                 | 37.746 ms                 |
| BlockToStepN              | 200.700 ms                | 307.302 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:22.369004 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240205 20:42:23.392124 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
W20240205 20:42:24.392006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=362, pq.top=362
W20240205 20:42:25.392007 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240205 20:42:26.408526 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.538 ms                  | 22.112 ms                 |
| Forward                   | 4.624 ms                  | 10.096 ms                 |
| Backward                  | 9.674 ms                  | 13.385 ms                 |
| Optimize                  | 1.882 ms                  | 3.723 ms                  |
| BarrierTimeBeforeRank0    | 5.142 ms                  | 20.022 ms                 |
| AfterBackward             | 28.148 ms                 | 37.787 ms                 |
| BlockToStepN              | 202.830 ms                | 310.293 ms                |
| OneStep                   | 261.865 ms                | 368.252 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 12.151 ms                 |
| ProcessBack:UpdateCache   | 9.975 ms                  | 11.575 ms                 |
| ProcessBack:UpsertPq      | 9.442 ms                  | 17.050 ms                 |
| ProcessOneStep            | 28.121 ms                 | 37.746 ms                 |
| BlockToStepN              | 203.051 ms                | 310.222 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:27.436514 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240205 20:42:28.436005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240205 20:42:29.489909 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240205 20:42:30.489006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=382, pq.top=382
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.538 ms                  | 22.112 ms                 |
| Forward                   | 4.612 ms                  | 10.212 ms                 |
| Backward                  | 9.674 ms                  | 13.812 ms                 |
| Optimize                  | 1.884 ms                  | 3.723 ms                  |
| BarrierTimeBeforeRank0    | 5.142 ms                  | 20.022 ms                 |
| AfterBackward             | 28.177 ms                 | 37.787 ms                 |
| BlockToStepN              | 204.532 ms                | 310.293 ms                |
| OneStep                   | 264.154 ms                | 368.252 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:31.489005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.686 ms                  | 12.151 ms                 |
| ProcessBack:UpdateCache   | 9.979 ms                  | 11.323 ms                 |
| ProcessBack:UpsertPq      | 9.466 ms                  | 17.168 ms                 |
| ProcessOneStep            | 28.146 ms                 | 37.746 ms                 |
| BlockToStepN              | 204.736 ms                | 310.222 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:32.489018 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=388, pq.top=388
W20240205 20:42:33.489010 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240205 20:42:34.489006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=394, pq.top=394
W20240205 20:42:35.489005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=397, pq.top=397
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.541 ms                  | 22.112 ms                 |
| Forward                   | 4.612 ms                  | 10.212 ms                 |
| Backward                  | 9.674 ms                  | 14.910 ms                 |
| Optimize                  | 1.884 ms                  | 3.723 ms                  |
| BarrierTimeBeforeRank0    | 5.152 ms                  | 20.022 ms                 |
| AfterBackward             | 28.186 ms                 | 37.787 ms                 |
| BlockToStepN              | 207.079 ms                | 315.701 ms                |
| OneStep                   | 267.142 ms                | 373.467 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:36.489003 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=400, pq.top=400
[proc 4] 400 steps, total: 30.874, sample: 0.359, forward: 0.442, backward: 0.967, update: 0.177
[proc 7] 400 steps, total: 30.874, sample: 0.310, forward: 0.431, backward: 0.999, update: 0.183
[proc 5] 400 steps, total: 30.874, sample: 0.348, forward: 0.436, backward: 1.022, update: 0.187
[proc 6] 400 steps, total: 30.874, sample: 0.334, forward: 0.415, backward: 0.965, update: 0.184
[proc 3] 400 steps, total: 30.874, sample: 0.315, forward: 0.417, backward: 0.948, update: 0.170
[proc 1] 400 steps, total: 30.873, sample: 0.349, forward: 0.438, backward: 0.972, update: 0.185
[proc 2] 400 steps, total: 30.874, sample: 0.335, forward: 0.427, backward: 0.947, update: 0.175
[proc 0] 400 steps, total: 30.874, sample: 0.405, forward: 0.485, backward: 0.999, update: 0.195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.692 ms                  | 12.151 ms                 |
| ProcessBack:UpdateCache   | 9.970 ms                  | 11.323 ms                 |
| ProcessBack:UpsertPq      | 9.481 ms                  | 17.168 ms                 |
| ProcessOneStep            | 28.171 ms                 | 37.746 ms                 |
| BlockToStepN              | 206.600 ms                | 315.477 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:37.489006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=404, pq.top=404
W20240205 20:42:38.489017 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240205 20:42:39.503598 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240205 20:42:40.503006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.546 ms                  | 22.112 ms                 |
| Forward                   | 4.611 ms                  | 10.212 ms                 |
| Backward                  | 9.681 ms                  | 14.910 ms                 |
| Optimize                  | 1.886 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 5.142 ms                  | 20.022 ms                 |
| AfterBackward             | 28.219 ms                 | 37.787 ms                 |
| BlockToStepN              | 208.466 ms                | 316.209 ms                |
| OneStep                   | 268.566 ms                | 384.689 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:41.503005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.694 ms                  | 12.151 ms                 |
| ProcessBack:UpdateCache   | 9.955 ms                  | 11.323 ms                 |
| ProcessBack:UpsertPq      | 9.497 ms                  | 17.184 ms                 |
| ProcessOneStep            | 28.207 ms                 | 37.746 ms                 |
| BlockToStepN              | 208.535 ms                | 317.704 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:42.503005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240205 20:42:43.503016 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240205 20:42:44.503013 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=426, pq.top=426
W20240205 20:42:45.503006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=429, pq.top=429
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.552 ms                  | 22.996 ms                 |
| Forward                   | 4.610 ms                  | 10.212 ms                 |
| Backward                  | 9.678 ms                  | 14.910 ms                 |
| Optimize                  | 1.884 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 5.138 ms                  | 20.022 ms                 |
| AfterBackward             | 28.240 ms                 | 41.851 ms                 |
| BlockToStepN              | 211.359 ms                | 320.910 ms                |
| OneStep                   | 269.530 ms                | 387.220 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:46.503005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=432, pq.top=432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.686 ms                  | 11.251 ms                 |
| ProcessBack:UpdateCache   | 9.958 ms                  | 11.202 ms                 |
| ProcessBack:UpsertPq      | 9.506 ms                  | 17.216 ms                 |
| ProcessOneStep            | 28.212 ms                 | 43.437 ms                 |
| BlockToStepN              | 211.715 ms                | 320.845 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:47.503006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240205 20:42:48.503012 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240205 20:42:49.503015 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240205 20:42:50.544987 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=445, pq.top=445
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.553 ms                  | 22.996 ms                 |
| Forward                   | 4.603 ms                  | 10.212 ms                 |
| Backward                  | 9.678 ms                  | 14.910 ms                 |
| Optimize                  | 1.886 ms                  | 3.801 ms                  |
| BarrierTimeBeforeRank0    | 5.146 ms                  | 22.175 ms                 |
| AfterBackward             | 28.294 ms                 | 43.466 ms                 |
| BlockToStepN              | 213.308 ms                | 325.106 ms                |
| OneStep                   | 270.966 ms                | 388.845 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:51.544004 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 12.151 ms                 |
| ProcessBack:UpdateCache   | 9.963 ms                  | 11.202 ms                 |
| ProcessBack:UpsertPq      | 9.512 ms                  | 17.720 ms                 |
| ProcessOneStep            | 28.268 ms                 | 43.437 ms                 |
| BlockToStepN              | 213.272 ms                | 325.035 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:52.544006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=450, pq.top=450
W20240205 20:42:53.544008 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240205 20:42:54.544010 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=456, pq.top=456
W20240205 20:42:55.544015 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=459, pq.top=459
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.552 ms                  | 22.904 ms                 |
| Forward                   | 4.603 ms                  | 10.096 ms                 |
| Backward                  | 9.683 ms                  | 14.215 ms                 |
| Optimize                  | 1.886 ms                  | 3.723 ms                  |
| BarrierTimeBeforeRank0    | 5.138 ms                  | 21.077 ms                 |
| AfterBackward             | 28.326 ms                 | 43.466 ms                 |
| BlockToStepN              | 215.302 ms                | 325.420 ms                |
| OneStep                   | 273.472 ms                | 393.072 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:56.562158 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=462, pq.top=462
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.684 ms                  | 12.151 ms                 |
| ProcessBack:UpdateCache   | 9.939 ms                  | 11.202 ms                 |
| ProcessBack:UpsertPq      | 9.531 ms                  | 21.027 ms                 |
| ProcessOneStep            | 28.298 ms                 | 43.437 ms                 |
| BlockToStepN              | 215.537 ms                | 325.342 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:42:57.562006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=465, pq.top=465
W20240205 20:42:58.562006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=468, pq.top=468
W20240205 20:42:59.562005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240205 20:43:00.562005 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=474, pq.top=474
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.546 ms                  | 22.904 ms                 |
| Forward                   | 4.595 ms                  | 10.096 ms                 |
| Backward                  | 9.689 ms                  | 14.215 ms                 |
| Optimize                  | 1.886 ms                  | 3.723 ms                  |
| BarrierTimeBeforeRank0    | 5.059 ms                  | 21.077 ms                 |
| AfterBackward             | 28.327 ms                 | 43.982 ms                 |
| BlockToStepN              | 219.244 ms                | 325.420 ms                |
| OneStep                   | 278.105 ms                | 393.072 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:43:01.562004 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=477, pq.top=477
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.683 ms                  | 11.251 ms                 |
| ProcessBack:UpdateCache   | 9.939 ms                  | 11.202 ms                 |
| ProcessBack:UpsertPq      | 9.547 ms                  | 22.232 ms                 |
| ProcessOneStep            | 28.320 ms                 | 43.957 ms                 |
| BlockToStepN              | 219.501 ms                | 325.342 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:43:02.562019 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240205 20:43:03.624814 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240205 20:43:04.624006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240205 20:43:05.624006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=488, pq.top=488
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.544 ms                  | 22.904 ms                 |
| Forward                   | 4.596 ms                  | 10.096 ms                 |
| Backward                  | 9.688 ms                  | 14.215 ms                 |
| Optimize                  | 1.886 ms                  | 3.723 ms                  |
| BarrierTimeBeforeRank0    | 5.036 ms                  | 21.077 ms                 |
| AfterBackward             | 28.360 ms                 | 44.891 ms                 |
| BlockToStepN              | 220.432 ms                | 341.176 ms                |
| OneStep                   | 280.562 ms                | 398.249 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:43:06.624006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=491, pq.top=491
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.689 ms                  | 11.251 ms                 |
| ProcessBack:UpdateCache   | 9.918 ms                  | 11.202 ms                 |
| ProcessBack:UpsertPq      | 9.550 ms                  | 23.451 ms                 |
| ProcessOneStep            | 28.328 ms                 | 44.862 ms                 |
| BlockToStepN              | 220.728 ms                | 340.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 20:43:07.624006 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=494, pq.top=494
W20240205 20:43:08.624011 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240205 20:43:09.624013 17341 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 4] 500 steps, total: 33.367, sample: 0.298, forward: 0.438, backward: 0.967, update: 0.173
[proc 2] 500 steps, total: 33.366, sample: 0.328, forward: 0.416, backward: 0.927, update: 0.168
[proc 5] 500 steps, total: 33.367, sample: 0.290, forward: 0.441, backward: 0.982, update: 0.185
[proc 6] 500 steps, total: 33.367, sample: 0.294, forward: 0.429, backward: 0.998, update: 0.181
[proc 7] 500 steps, total: 33.367, sample: 0.324, forward: 0.435, backward: 0.984, update: 0.181
[proc 3] 500 steps, total: 33.367, sample: 0.320, forward: 0.414, backward: 0.935, update: 0.168
[proc 1] 500 steps, total: 33.367, sample: 0.321, forward: 0.431, backward: 0.711, update: 0.176
[proc 0] 500 steps, total: 33.367, sample: 0.401, forward: 0.465, backward: 0.902, update: 0.195
Successfully xmh. training takes 136.78914260864258 seconds
before call kg_cache_controller.StopThreads()
W20240205 20:43:09.875820 17341 grad_async_v1.h:243] call StopThreads. PID = 16791
W20240205 20:43:09.875838 17341 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 20:43:09.881899 17341 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 20:43:09.881929 17341 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 20:43:09.907485 17341 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7ff2c6634f10>
