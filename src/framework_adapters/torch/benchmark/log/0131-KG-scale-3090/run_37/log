WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 14:58:26.912756 28536 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_90', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [28536 sampler.py:454] Start PreSampling
WARNING [28536 sampler.py:532] Before construct renumbering_dict
WARNING [28536 sampler.py:555] PreSampling done
W20240202 14:58:31.601593 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 14:58:31.601747 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 14:58:31.601783 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 14:58:31.601812 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 14:58:31.601845 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 14:58:31.601877 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 14:58:31.601912 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 14:58:31.601948 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 14:58:31.601986 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 14:58:31.602025 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 14:58:31.602066 28536 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 14:58:31.602093 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 14:58:31.602116 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 14:58:31.602219 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 14:58:31.602257 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 14:58:31.602288 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 14:58:31.602330 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 14:58:31.602360 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 14:58:31.602396 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 14:58:31.602421 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 14:58:31.602450 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 14:58:31.602480 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 14:58:31.602514 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 14:58:31.602546 28536 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 14:58:31.602569 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 14:58:31.602602 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 14:58:31.602651 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 14:58:31.602680 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 14:58:31.602710 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 14:58:31.602739 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 14:58:31.602766 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 14:58:31.602807 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 14:58:31.602839 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 14:58:31.602869 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 14:58:31.602896 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 14:58:31.602926 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 14:58:31.602955 28536 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 14:58:31.602978 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 14:58:31.603000 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 14:58:31.603055 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 14:58:31.603082 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 14:58:31.603112 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 14:58:31.603143 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 14:58:31.603188 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 14:58:31.603217 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 14:58:31.603256 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 14:58:31.603286 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 14:58:31.603313 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 14:58:31.603340 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 14:58:31.603372 28536 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 14:58:31.603395 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 14:58:31.603418 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 14:58:31.603471 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240202 14:58:31.603507 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240202 14:58:31.603534 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240202 14:58:31.603572 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240202 14:58:31.603605 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240202 14:58:31.603638 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240202 14:58:31.603674 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240202 14:58:31.603703 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240202 14:58:31.603740 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240202 14:58:31.603772 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240202 14:58:31.603799 28536 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240202 14:58:31.603823 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240202 14:58:31.603850 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240202 14:58:31.603899 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240202 14:58:31.603940 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240202 14:58:31.603969 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240202 14:58:31.604007 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240202 14:58:31.604034 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240202 14:58:31.604107 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240202 14:58:31.604140 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240202 14:58:31.604172 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240202 14:58:31.604212 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240202 14:58:31.604249 28536 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240202 14:58:31.604281 28536 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240202 14:58:31.604308 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240202 14:58:31.604334 28536 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240202 14:58:31.836928 28536 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10001ca5a000 22.81 MB
W20240202 14:58:31.926882 28536 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10001e12c000 58.4 kB
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  835,   936,  1016,  ...,  2903,  2224, 10444]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.114 seconds
[Rank1] pid = 28993
[Rank2] pid = 29019
[Rank3] pid = 29121
[Rank4] pid = 29123
INFO [28536 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [28993 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [29019 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [29121 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [29123 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [29125 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [29125 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [29123 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [29019 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [29121 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240202 14:58:34.269088 29284 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240202 14:58:34.269100 29146 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240202 14:58:34.270144 29058 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
INFO [28993 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [28536 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240202 14:58:34.273416 29126 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240202 14:58:34.274729 29162 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240202 14:58:34.275543 28994 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240202 14:58:34.304409 29058 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10001e142000 7.629 MB
W20240202 14:58:34.304499 29284 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10001e8e5000 7.629 MB
W20240202 14:58:34.304507 29146 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10001f088000 7.629 MB
W20240202 14:58:34.304658 29058 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10001f82b000 7.629 MB
W20240202 14:58:34.304680 29146 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10001ffce000 7.629 MB
W20240202 14:58:34.304687 29284 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100020771000 7.629 MB
W20240202 14:58:34.304780 29146 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x100020f14000 1.49 GB
W20240202 14:58:34.304787 29284 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1000804f7000 1.49 GB
W20240202 14:58:34.304814 29058 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1000dfada000 1.49 GB
W20240202 14:58:34.304853 29146 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10013f0bd000 1.49 GB
W20240202 14:58:34.304878 29284 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10019e6a0000 1.49 GB
W20240202 14:58:34.304898 29058 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1001fdc83000 1.49 GB
W20240202 14:58:34.304950 29058 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 14:58:34.304955 29284 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 14:58:34.304960 29146 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 14:58:34.310443 29058 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 14:58:34.310456 29146 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 14:58:34.310459 29284 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 14:58:34.310688 29126 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10025d26e000 7.629 MB
W20240202 14:58:34.310837 29126 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10025da11000 7.629 MB
W20240202 14:58:34.310930 29126 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10025e1b4000 1.49 GB
W20240202 14:58:34.310997 29126 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1002bd797000 1.49 GB
W20240202 14:58:34.313402 29126 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:58:34.317374 29126 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:58:34.317485 29162 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10031cd86000 7.629 MB
W20240202 14:58:34.317569 28994 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10031d529000 7.629 MB
W20240202 14:58:34.319087 28994 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10031dcce000 7.629 MB
W20240202 14:58:34.319121 29162 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10031e471000 7.629 MB
W20240202 14:58:34.319192 28994 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10031ec14000 1.49 GB
W20240202 14:58:34.319211 29162 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10037e1f7000 1.49 GB
W20240202 14:58:34.319262 28994 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1003dd7da000 1.49 GB
W20240202 14:58:34.319300 29162 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10043cdbd000 1.49 GB
W20240202 14:58:34.319331 28994 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 14:58:34.319340 29162 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 14:58:34.324909 28994 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 14:58:34.325659 29162 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x10001ca5a000
4: KnownLocalCachedEmbedding init done
WARNING [29123 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
5: KnownLocalCachedEmbedding init done
WARNING [29125 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
1: KnownLocalCachedEmbedding init done
WARNING [28993 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
3: KnownLocalCachedEmbedding init done
WARNING [29121 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
2: KnownLocalCachedEmbedding init done
WARNING [29019 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank5] pid = 29125
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
cudaHostRegister 0x10001ca5a000
0: KnownLocalCachedEmbedding init done
WARNING [28536 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 14:58:36.777207 29162 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240202 14:58:36.777721 28994 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240202 14:58:36.777910 29284 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240202 14:58:36.778309 29058 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240202 14:58:36.778841 29126 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240202 14:58:36.778937 29146 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
E20240202 14:58:37.381928 29284 recstore.cc:66] init folly done
E20240202 14:58:37.382231 29126 recstore.cc:66] init folly done
E20240202 14:58:37.382234 28994 recstore.cc:66] init folly done
E20240202 14:58:37.382611 29058 recstore.cc:66] init folly done
E20240202 14:58:37.382613 29146 recstore.cc:66] init folly done
E20240202 14:58:37.382656 29162 recstore.cc:66] init folly done
I20240202 14:58:37.471612 29058 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240202 14:58:37.475365 28994 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240202 14:58:37.478935 29284 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240202 14:58:37.480484 29126 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240202 14:58:37.481328 29162 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240202 14:58:37.484752 29146 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.000 ms                  | 30.655 ms                 |
| Forward                   | 6.531 ms                  | 578.497 ms                |
| Backward                  | 128.931 ms                | 2.117 s                   |
| Optimize                  | 44.490 ms                 | 64.387 ms                 |
| BarrierTimeBeforeRank0    | 81.139 us                 | 603.062 us                |
| BlockToStepN              | 46.093 us                 | 219.132 us                |
| OneStep                   | 189.553 ms                | 2.763 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.549 ms                  | 30.655 ms                 |
| Forward                   | 5.476 ms                  | 578.497 ms                |
| Backward                  | 124.405 ms                | 2.117 s                   |
| Optimize                  | 35.675 ms                 | 64.387 ms                 |
| BarrierTimeBeforeRank0    | 58.203 us                 | 603.062 us                |
| BlockToStepN              | 40.084 us                 | 226.878 us                |
| OneStep                   | 173.079 ms                | 2.763 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.633 ms                  | 30.583 ms                 |
| Forward                   | 5.574 ms                  | 8.471 ms                  |
| Backward                  | 126.921 ms                | 161.297 ms                |
| Optimize                  | 35.124 ms                 | 54.105 ms                 |
| BarrierTimeBeforeRank0    | 54.719 us                 | 123.305 us                |
| BlockToStepN              | 42.949 us                 | 226.878 us                |
| OneStep                   | 174.240 ms                | 233.964 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.595 ms                  | 30.583 ms                 |
| Forward                   | 5.387 ms                  | 8.471 ms                  |
| Backward                  | 126.961 ms                | 161.297 ms                |
| Optimize                  | 33.831 ms                 | 54.105 ms                 |
| BarrierTimeBeforeRank0    | 50.999 us                 | 123.305 us                |
| BlockToStepN              | 40.084 us                 | 226.878 us                |
| OneStep                   | 174.055 ms                | 233.964 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
-------Step 0-------
tensor([   66,  7320,  9403,   917, 12567,  7164,   101,  7728,  4417,  1628]) tensor([ 1016,    72,  5646,  7340,    17,  4714, 12116, 14936,  1621,  9674])
-------Step 1-------
tensor([   66,  7320,  9403,   917, 12567,  7164,   101,  7728,  4417,  1628]) tensor([ 6787,  3977,   375,  8548,  5537, 14182,  2600, 10389, 14541,  9841])
-------Step 2-------
tensor([ 1542,  3686, 12567,  6003,  8994, 12850,    16, 11901, 10212,  4929]) tensor([ 6430, 12383,  5951, 13788,  8230,  7701,  6310,  6060,  1267, 12244])
-------Step 3-------
tensor([ 1542,  3686, 12567,  6003,  8994, 12850,    16, 11901, 10212,  4929]) tensor([ 6001,  3359,  4067, 11484,  8931,   458,  7646,  4731,   212,  2661])
-------Step 4-------
tensor([   96,  4607,  8751,  8849, 10466,  2957, 12567,  9905,  8101,  9996]) tensor([ 2067,  3942,  2367,  1634, 13548, 12142,  7442, 11444, 12787,  3173])
-------Step 5-------
tensor([   96,  4607,  8751,  8849, 10466,  2957, 12567,  9905,  8101,  9996]) tensor([ 3053, 10316,   592, 11672,  8472,  3627, 13828,   519,  6074,  1922])
-------Step 6-------
tensor([ 7331, 14154, 12234,  2474,  4354,   128,    42, 11863,    96,    92]) tensor([11761,  6022,  2733,  3856,  1325,   406,  4564, 14276,  1408,  3930])
-------Step 7-------
tensor([ 7331, 14154, 12234,  2474,  4354,   128,    42, 11863,    96,    92]) tensor([13165,   250,  3982,  5486, 14405,  9173,  9111,  6492,  5974,  6059])
-------Step 8-------
tensor([3313, 3764, 1240,  720, 4479, 2303, 6406,   83, 9993,   42]) tensor([11300,  3712,  1909,  9933, 11998, 10577,  9534,  3249,  4324, 12448])
-------Step 9-------
tensor([3313, 3764, 1240,  720, 4479, 2303, 6406,   83, 9993,   42]) tensor([ 9882, 12093, 10796,  8607,  2233,  8545,   450,  6723,  4945,  2598])
before start barrier
start train
[proc 0] 100 steps, total: 20.119, sample: 0.464, forward: 1.132, backward: 14.853, update: 3.549
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 20.120, sample: 0.392, forward: 1.088, backward: 11.468, update: 0.419
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 20.125, sample: 0.404, forward: 1.065, backward: 11.713, update: 0.450
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 20.116, sample: 0.428, forward: 1.083, backward: 11.692, update: 0.475
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 20.122, sample: 0.435, forward: 1.122, backward: 11.601, update: 0.449
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 20.129, sample: 0.444, forward: 1.123, backward: 11.660, update: 0.416
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.580 ms                  | 30.655 ms                 |
| Forward                   | 5.333 ms                  | 8.471 ms                  |
| Backward                  | 126.961 ms                | 161.297 ms                |
| Optimize                  | 34.025 ms                 | 54.105 ms                 |
| BarrierTimeBeforeRank0    | 50.717 us                 | 123.305 us                |
| BlockToStepN              | 39.712 us                 | 269.412 us                |
| OneStep                   | 173.483 ms                | 233.964 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.580 ms                  | 30.583 ms                 |
| Forward                   | 5.341 ms                  | 8.471 ms                  |
| Backward                  | 127.777 ms                | 158.782 ms                |
| Optimize                  | 34.025 ms                 | 49.544 ms                 |
| BarrierTimeBeforeRank0    | 50.589 us                 | 109.630 us                |
| BlockToStepN              | 36.827 us                 | 226.878 us                |
| OneStep                   | 174.240 ms                | 216.213 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.549 ms                  | 30.583 ms                 |
| Forward                   | 5.368 ms                  | 8.471 ms                  |
| Backward                  | 129.550 ms                | 160.997 ms                |
| Optimize                  | 34.025 ms                 | 49.544 ms                 |
| BarrierTimeBeforeRank0    | 49.882 us                 | 109.630 us                |
| BlockToStepN              | 27.907 us                 | 226.878 us                |
| OneStep                   | 175.440 ms                | 216.213 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 17.969, sample: 0.392, forward: 0.466, backward: 10.336, update: 0.353
[proc 2] 200 steps, total: 17.969, sample: 0.415, forward: 0.486, backward: 10.520, update: 0.460
[proc 0] 200 steps, total: 17.969, sample: 0.503, forward: 0.543, backward: 13.403, update: 3.408
[proc 4] 200 steps, total: 17.969, sample: 0.457, forward: 0.482, backward: 10.445, update: 0.432
[proc 1] 200 steps, total: 17.969, sample: 0.420, forward: 0.483, backward: 10.482, update: 0.466
[proc 5] 200 steps, total: 17.969, sample: 0.417, forward: 0.445, backward: 10.553, update: 0.415
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.549 ms                  | 30.583 ms                 |
| Forward                   | 5.345 ms                  | 8.471 ms                  |
| Backward                  | 130.576 ms                | 165.357 ms                |
| Optimize                  | 33.921 ms                 | 49.544 ms                 |
| BarrierTimeBeforeRank0    | 48.845 us                 | 109.630 us                |
| BlockToStepN              | 28.446 us                 | 226.878 us                |
| OneStep                   | 175.993 ms                | 218.509 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.549 ms                  | 30.583 ms                 |
| Forward                   | 5.324 ms                  | 8.471 ms                  |
| Backward                  | 130.607 ms                | 172.630 ms                |
| Optimize                  | 33.710 ms                 | 49.544 ms                 |
| BarrierTimeBeforeRank0    | 48.134 us                 | 109.630 us                |
| BlockToStepN              | 28.446 us                 | 269.412 us                |
| OneStep                   | 175.993 ms                | 226.144 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.523 ms                  | 29.995 ms                 |
| Forward                   | 5.328 ms                  | 8.225 ms                  |
| Backward                  | 130.482 ms                | 172.121 ms                |
| Optimize                  | 33.359 ms                 | 48.460 ms                 |
| BarrierTimeBeforeRank0    | 47.670 us                 | 100.534 us                |
| BlockToStepN              | 35.367 us                 | 228.278 us                |
| OneStep                   | 176.108 ms                | 218.509 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.516 ms                  | 29.995 ms                 |
| Forward                   | 5.328 ms                  | 8.225 ms                  |
| Backward                  | 130.404 ms                | 172.121 ms                |
| Optimize                  | 33.335 ms                 | 48.460 ms                 |
| BarrierTimeBeforeRank0    | 47.659 us                 | 100.534 us                |
| BlockToStepN              | 37.643 us                 | 228.278 us                |
| OneStep                   | 176.108 ms                | 218.509 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 17.776, sample: 0.427, forward: 0.527, backward: 13.274, update: 3.433
[proc 3] 300 steps, total: 17.776, sample: 0.440, forward: 0.467, backward: 10.086, update: 0.372
[proc 2] 300 steps, total: 17.776, sample: 0.426, forward: 0.500, backward: 10.232, update: 0.434
[proc 4] 300 steps, total: 17.776, sample: 0.390, forward: 0.461, backward: 10.298, update: 0.389
[proc 5] 300 steps, total: 17.776, sample: 0.423, forward: 0.453, backward: 10.246, update: 0.396
[proc 1] 300 steps, total: 17.776, sample: 0.408, forward: 0.475, backward: 10.259, update: 0.460
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.514 ms                  | 30.583 ms                 |
| Forward                   | 5.336 ms                  | 8.471 ms                  |
| Backward                  | 129.829 ms                | 172.121 ms                |
| Optimize                  | 33.257 ms                 | 48.460 ms                 |
| BarrierTimeBeforeRank0    | 47.337 us                 | 100.534 us                |
| BlockToStepN              | 37.206 us                 | 228.278 us                |
| OneStep                   | 175.501 ms                | 218.509 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.492 ms                  | 30.583 ms                 |
| Forward                   | 5.336 ms                  | 8.986 ms                  |
| Backward                  | 130.102 ms                | 172.121 ms                |
| Optimize                  | 33.167 ms                 | 48.460 ms                 |
| BarrierTimeBeforeRank0    | 47.173 us                 | 100.534 us                |
| BlockToStepN              | 37.556 us                 | 228.278 us                |
| OneStep                   | 175.501 ms                | 226.144 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.493 ms                  | 29.995 ms                 |
| Forward                   | 5.341 ms                  | 8.471 ms                  |
| Backward                  | 130.266 ms                | 166.208 ms                |
| Optimize                  | 33.196 ms                 | 48.415 ms                 |
| BarrierTimeBeforeRank0    | 47.318 us                 | 98.856 us                 |
| BlockToStepN              | 36.827 us                 | 226.878 us                |
| OneStep                   | 175.501 ms                | 218.509 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 17.711, sample: 0.397, forward: 0.476, backward: 10.149, update: 0.385
[proc 4] 400 steps, total: 17.711, sample: 0.425, forward: 0.462, backward: 10.290, update: 0.369
[proc 2] 400 steps, total: 17.711, sample: 0.397, forward: 0.486, backward: 10.226, update: 0.421
[proc 1] 400 steps, total: 17.711, sample: 0.396, forward: 0.478, backward: 10.239, update: 0.444
[proc 5] 400 steps, total: 17.711, sample: 0.375, forward: 0.456, backward: 10.309, update: 0.433
[proc 0] 400 steps, total: 17.711, sample: 0.497, forward: 0.548, backward: 13.200, update: 3.357
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.475 ms                  | 29.995 ms                 |
| Forward                   | 5.341 ms                  | 8.471 ms                  |
| Backward                  | 130.576 ms                | 166.208 ms                |
| Optimize                  | 33.230 ms                 | 48.415 ms                 |
| BarrierTimeBeforeRank0    | 47.318 us                 | 100.534 us                |
| BlockToStepN              | 35.965 us                 | 226.878 us                |
| OneStep                   | 175.870 ms                | 218.509 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.446 ms                  | 29.995 ms                 |
| Forward                   | 5.341 ms                  | 8.471 ms                  |
| Backward                  | 130.628 ms                | 166.208 ms                |
| Optimize                  | 33.083 ms                 | 48.415 ms                 |
| BarrierTimeBeforeRank0    | 47.058 us                 | 100.534 us                |
| BlockToStepN              | 33.671 us                 | 226.878 us                |
| OneStep                   | 175.506 ms                | 218.509 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.437 ms                  | 29.725 ms                 |
| Forward                   | 5.345 ms                  | 8.495 ms                  |
| Backward                  | 130.607 ms                | 166.208 ms                |
| Optimize                  | 32.918 ms                 | 46.826 ms                 |
| BarrierTimeBeforeRank0    | 47.023 us                 | 98.856 us                 |
| BlockToStepN              | 30.033 us                 | 221.045 us                |
| OneStep                   | 175.506 ms                | 217.606 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.425 ms                  | 29.995 ms                 |
| Forward                   | 5.352 ms                  | 8.495 ms                  |
| Backward                  | 130.708 ms                | 166.208 ms                |
| Optimize                  | 32.801 ms                 | 46.826 ms                 |
| BarrierTimeBeforeRank0    | 47.023 us                 | 98.856 us                 |
| BlockToStepN              | 29.738 us                 | 221.045 us                |
| OneStep                   | 175.771 ms                | 217.606 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 17.659, sample: 0.430, forward: 0.463, backward: 10.303, update: 0.441
[proc 5] 500 steps, total: 17.659, sample: 0.364, forward: 0.446, backward: 10.378, update: 0.375
[proc 3] 500 steps, total: 17.659, sample: 0.367, forward: 0.465, backward: 10.154, update: 0.331
[proc 0] 500 steps, total: 17.659, sample: 0.452, forward: 0.548, backward: 13.278, update: 3.277
[proc 2] 500 steps, total: 17.659, sample: 0.358, forward: 0.492, backward: 10.362, update: 0.436
Successfully xmh. training takes 91.23412251472473 seconds
[proc 1] 500 steps, total: 17.659, sample: 0.402, forward: 0.484, backward: 10.302, update: 0.471
before call kg_cache_controller.StopThreads()
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
INFO [28536 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.419 ms                  | 29.995 ms                 |
| Forward                   | 5.351 ms                  | 8.495 ms                  |
| Backward                  | 130.708 ms                | 166.208 ms                |
| Optimize                  | 32.801 ms                 | 46.826 ms                 |
| BarrierTimeBeforeRank0    | 46.995 us                 | 98.856 us                 |
| BlockToStepN              | 29.475 us                 | 221.045 us                |
| OneStep                   | 175.771 ms                | 217.606 ms                |
+---------------------------+---------------------------+---------------------------+
