WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240207 22:33:24.569293 34646 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_56', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [34646 sampler.py:454] Start PreSampling
WARNING [34646 sampler.py:532] Before construct renumbering_dict
WARNING [34646 sampler.py:555] PreSampling done
W20240207 22:52:45.383739 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240207 22:52:45.383932 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240207 22:52:45.383968 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240207 22:52:45.384003 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240207 22:52:45.384033 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240207 22:52:45.384076 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240207 22:52:45.384109 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240207 22:52:45.384155 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240207 22:52:45.384184 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240207 22:52:45.384217 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240207 22:52:45.384249 34646 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240207 22:52:45.384277 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240207 22:52:45.384306 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240207 22:52:45.384450 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240207 22:52:45.384496 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240207 22:52:45.384527 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240207 22:52:45.384585 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240207 22:52:45.384618 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240207 22:52:45.384649 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240207 22:52:45.384680 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240207 22:52:45.384721 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240207 22:52:45.384748 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240207 22:52:45.384784 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240207 22:52:45.384811 34646 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240207 22:52:45.384837 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240207 22:52:45.384860 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240207 22:52:45.384915 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240207 22:52:45.384963 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240207 22:52:45.384989 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240207 22:52:45.385017 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240207 22:52:45.385051 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240207 22:52:45.385079 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240207 22:52:45.385109 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240207 22:52:45.385135 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240207 22:52:45.385164 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240207 22:52:45.385195 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240207 22:52:45.385224 34646 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240207 22:52:45.385246 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240207 22:52:45.385270 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240207 22:52:45.385327 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240207 22:52:45.385365 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240207 22:52:45.385394 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240207 22:52:45.385427 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240207 22:52:45.385455 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240207 22:52:45.385486 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240207 22:52:45.385515 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240207 22:52:45.385552 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240207 22:52:45.385588 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240207 22:52:45.385622 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240207 22:52:45.385655 34646 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240207 22:52:45.385677 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240207 22:52:45.385701 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240207 22:52:45.385759 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240207 22:52:45.385789 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240207 22:52:45.385820 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240207 22:52:45.385854 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240207 22:52:45.385883 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240207 22:52:45.385910 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240207 22:52:45.385946 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240207 22:52:45.385973 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240207 22:52:45.386008 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240207 22:52:45.386047 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240207 22:52:45.386075 34646 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240207 22:52:45.386096 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240207 22:52:45.386128 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240207 22:52:45.386178 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240207 22:52:45.386207 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240207 22:52:45.386245 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240207 22:52:45.386273 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240207 22:52:45.386302 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240207 22:52:45.386332 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240207 22:52:45.386358 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240207 22:52:45.386391 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240207 22:52:45.386421 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240207 22:52:45.386451 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240207 22:52:45.386484 34646 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240207 22:52:45.386507 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240207 22:52:45.386534 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240207 22:52:45.386588 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240207 22:52:45.386618 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240207 22:52:45.386652 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240207 22:52:45.386682 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240207 22:52:45.386721 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240207 22:52:45.386757 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240207 22:52:45.386788 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240207 22:52:45.386816 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240207 22:52:45.386854 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240207 22:52:45.386895 34646 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240207 22:52:45.386924 34646 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240207 22:52:45.386947 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240207 22:52:45.386977 34646 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240207 22:52:45.833032 34646 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000216be000 128.2 GB
W20240207 23:01:22.250747 34646 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020302f6000 328.3 MB
{0: Graph(num_nodes=15380073, num_edges=42467395,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=16359015, num_edges=65830196,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16649310, num_edges=43584356,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=13918614, num_edges=50952482,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14713191, num_edges=52450022,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14150782, num_edges=58077216,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=21311359, num_edges=64967677,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 15380073 N 42467395 E
MertisPartition: part 1 has 16359015 N 65830196 E
MertisPartition: part 2 has 16649310 N 43584356 E
MertisPartition: part 3 has 13918614 N 50952482 E
MertisPartition: part 4 has 14713191 N 52450022 E
MertisPartition: part 5 has 14150782 N 58077216 E
MertisPartition: part 6 has 21311359 N 64967677 E
Rank0: cached key size 614672
Rank1: cached key size 614672
Rank2: cached key size 614672
Rank3: cached key size 614672
Rank4: cached key size 614672
Rank5: cached key size 614672
Rank6: cached key size 614672
Before renumbering graph:  {'_ID': tensor([     239,      240,      329,  ..., 86019793, 84488282, 82976992]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4311363,  4311418,  4314581,  ..., 81351360, 38403627, 68211582]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2184.607 seconds
[Rank1] pid = 35732
[Rank2] pid = 35829
[Rank3] pid = 35896
[Rank4] pid = 35963
[Rank5] pid = 36030
INFO [34646 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [35732 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [35829 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [35896 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [36099 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [35963 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [36030 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [35896 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [34646 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [35829 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [36099 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [35963 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [36030 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [35732 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
W20240207 23:09:59.389196 35897 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240207 23:09:59.392411 36100 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240207 23:09:59.392699 36031 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240207 23:09:59.392832 36164 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240207 23:09:59.393077 35964 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240207 23:09:59.393110 35830 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240207 23:09:59.393352 35733 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240207 23:09:59.456228 35964 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102044b47000 7.629 MB
W20240207 23:09:59.456459 35964 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1020452ea000 7.629 MB
W20240207 23:09:59.456532 35964 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x102045a8d000 1.49 GB
W20240207 23:09:59.456580 35964 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1020a5070000 1.49 GB
W20240207 23:09:59.456636 35964 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240207 23:09:59.475468 36100 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102104655000 7.629 MB
W20240207 23:09:59.475498 36164 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x102104df8000 7.629 MB
W20240207 23:09:59.475515 35830 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10210559b000 7.629 MB
W20240207 23:09:59.475523 36031 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102105d3e000 7.629 MB
W20240207 23:09:59.475531 35897 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1021064e1000 7.629 MB
W20240207 23:09:59.475836 35964 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240207 23:09:59.475917 36100 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x102106c88000 7.629 MB
W20240207 23:09:59.475976 35830 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10210742b000 7.629 MB
W20240207 23:09:59.476019 36031 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102107bce000 7.629 MB
W20240207 23:09:59.476154 35733 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102108371000 7.629 MB
W20240207 23:09:59.477530 36031 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x102108b14000 1.49 GB
W20240207 23:09:59.477586 35733 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1021680f7000 7.629 MB
W20240207 23:09:59.477639 36100 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10216889a000 1.49 GB
W20240207 23:09:59.477682 36100 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102227462000 1.49 GB
W20240207 23:09:59.477681 36031 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1021c7e7f000 1.49 GB
W20240207 23:09:59.477708 36164 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x102286a45000 7.629 MB
W20240207 23:09:59.477728 35830 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1022871e8000 1.49 GB
W20240207 23:09:59.477751 35897 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1022e67cb000 7.629 MB
W20240207 23:09:59.477777 36100 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 23:09:59.477782 36164 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x102346551000 1.49 GB
W20240207 23:09:59.477777 35733 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1022e6f6e000 1.49 GB
W20240207 23:09:59.477830 36164 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1023a5b34000 1.49 GB
W20240207 23:09:59.477841 35830 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102405117000 1.49 GB
W20240207 23:09:59.477865 36031 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240207 23:09:59.477880 35897 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1024646fa000 1.49 GB
W20240207 23:09:59.477890 35733 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1024c3cdd000 1.49 GB
W20240207 23:09:59.477900 36164 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240207 23:09:59.477952 35830 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 23:09:59.477972 35897 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1025232c0000 1.49 GB
W20240207 23:09:59.477988 35733 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 23:09:59.478050 35897 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240207 23:09:59.493726 36100 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 23:09:59.493762 35830 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 23:09:59.493773 35733 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 23:09:59.493777 36164 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240207 23:09:59.493782 36031 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240207 23:09:59.493788 35897 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x1000216be000
6: KnownLocalCachedEmbedding init done
WARNING [36099 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
4: KnownLocalCachedEmbedding init done
WARNING [35963 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
5: KnownLocalCachedEmbedding init done
WARNING [36030 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
2: KnownLocalCachedEmbedding init done
WARNING [35829 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
1: KnownLocalCachedEmbedding init done
WARNING [35732 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x1000216be000
3: KnownLocalCachedEmbedding init done
WARNING [35896 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank6] pid = 36099
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949)]
cudaHostRegister 0x1000216be000
0: KnownLocalCachedEmbedding init done
WARNING [34646 DistTensor.py:59] The tensor name already exists in the kvstore
I20240207 23:10:44.937181 36100 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240207 23:10:44.937238 35897 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 23:10:44.937347 35733 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 23:10:44.937476 36164 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 23:10:44.937628 35830 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 23:10:44.937748 36031 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240207 23:10:44.938091 35964 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
W20240207 23:10:44.939446 36100 grad_base.h:55] KGCacheController, config={
        "num_gpus": 7,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240207 23:10:44.939563 36100 grad_base.h:184] Init GradProcessingBase done
I20240207 23:10:57.649734 36100 grad_async_v1.h:203] Use main thread to update emb.
W20240207 23:10:57.649868 36100 kg_controller.h:75] after init GradAsyncProcessing
I20240207 23:10:57.649878 36100 kg_controller.h:84] Construct KGCacheController done
E20240207 23:10:59.292125 35897 recstore.cc:66] init folly done
E20240207 23:10:59.292210 35733 recstore.cc:66] init folly done
E20240207 23:10:59.292261 36100 recstore.cc:66] init folly done
E20240207 23:10:59.292306 35964 recstore.cc:66] init folly done
E20240207 23:10:59.292310 36031 recstore.cc:66] init folly done
E20240207 23:10:59.292343 35830 recstore.cc:66] init folly done
E20240207 23:10:59.292349 36164 recstore.cc:66] init folly done
I20240207 23:10:59.293329 36100 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240207 23:11:18.884589 36100 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240207 23:11:19.091651 35830 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 23:11:20.129541 35897 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 23:11:20.698632 35964 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 23:11:21.329543 36031 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 23:11:22.315922 35733 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240207 23:11:22.845203 36164 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 249.185 ms                | 286.813 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:24.707103 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.116 ms                 | 19.116 ms                 |
| Forward                   | 499.493 ms                | 499.493 ms                |
| Backward                  | 193.906 ms                | 193.906 ms                |
| Optimize                  | 46.391 ms                 | 46.391 ms                 |
| BarrierTimeBeforeRank0    | 5.042 ms                  | 5.042 ms                  |
| AfterBackward             | 1.096 s                   | 1.096 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:25.707005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240207 23:11:26.707008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
W20240207 23:11:27.707007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240207 23:11:28.707008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.171 ms                  | 286.813 ms                |
| ProcessBack:UpdateCache   | 7.666 ms                  | 551.057 ms                |
| ProcessBack:UpsertPq      | 32.291 ms                 | 40.344 ms                 |
| ProcessOneStep            | 51.709 ms                 | 1.095 s                   |
| BlockToStepN              | 74.404 us                 | 693.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:29.756233 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.521 ms                  | 88.999 ms                 |
| Forward                   | 5.866 ms                  | 499.493 ms                |
| Backward                  | 10.128 ms                 | 193.906 ms                |
| Optimize                  | 2.607 ms                  | 46.391 ms                 |
| BarrierTimeBeforeRank0    | 1.881 ms                  | 50.248 ms                 |
| AfterBackward             | 54.424 ms                 | 1.096 s                   |
| BlockToStepN              | 137.672 us                | 693.479 ms                |
| OneStep                   | 169.029 ms                | 2.549 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:30.940841 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240207 23:11:31.940007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240207 23:11:32.940007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240207 23:11:33.940007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.715 ms                  | 286.813 ms                |
| ProcessBack:UpdateCache   | 7.688 ms                  | 551.057 ms                |
| ProcessBack:UpsertPq      | 32.556 ms                 | 68.408 ms                 |
| ProcessOneStep            | 54.604 ms                 | 1.095 s                   |
| BlockToStepN              | 74.404 us                 | 693.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:34.940006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.315 ms                  | 88.999 ms                 |
| Forward                   | 5.528 ms                  | 499.493 ms                |
| Backward                  | 10.197 ms                 | 193.906 ms                |
| Optimize                  | 2.709 ms                  | 46.391 ms                 |
| BarrierTimeBeforeRank0    | 2.112 ms                  | 50.248 ms                 |
| AfterBackward             | 54.633 ms                 | 1.096 s                   |
| BlockToStepN              | 137.672 us                | 693.479 ms                |
| OneStep                   | 184.057 ms                | 2.549 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:36.152606 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240207 23:11:37.152005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240207 23:11:38.152020 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240207 23:11:39.152009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.732 ms                  | 249.185 ms                |
| ProcessBack:UpdateCache   | 7.814 ms                  | 550.008 ms                |
| ProcessBack:UpsertPq      | 35.702 ms                 | 78.326 ms                 |
| ProcessOneStep            | 58.851 ms                 | 1.095 s                   |
| BlockToStepN              | 74.404 us                 | 693.408 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.575 ms                  | 88.999 ms                 |
| Forward                   | 5.591 ms                  | 499.493 ms                |
| Backward                  | 10.275 ms                 | 193.906 ms                |
| Optimize                  | 2.709 ms                  | 46.391 ms                 |
| BarrierTimeBeforeRank0    | 3.898 ms                  | 50.248 ms                 |
| AfterBackward             | 56.796 ms                 | 1.096 s                   |
| BlockToStepN              | 137.672 us                | 693.479 ms                |
| OneStep                   | 184.057 ms                | 2.549 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:40.152007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240207 23:11:41.152007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240207 23:11:42.152006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240207 23:11:43.152006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240207 23:11:44.152006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.715 ms                  | 249.185 ms                |
| ProcessBack:UpdateCache   | 7.736 ms                  | 550.008 ms                |
| ProcessBack:UpsertPq      | 33.664 ms                 | 78.326 ms                 |
| ProcessOneStep            | 54.383 ms                 | 1.095 s                   |
| BlockToStepN              | 417.573 us                | 693.408 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.221 ms                  | 98.529 ms                 |
| Forward                   | 5.324 ms                  | 499.493 ms                |
| Backward                  | 10.227 ms                 | 193.906 ms                |
| Optimize                  | 2.692 ms                  | 46.391 ms                 |
| BarrierTimeBeforeRank0    | 3.898 ms                  | 50.248 ms                 |
| AfterBackward             | 51.742 ms                 | 1.096 s                   |
| BlockToStepN              | 677.667 us                | 693.479 ms                |
| OneStep                   | 184.057 ms                | 2.549 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:45.152009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240207 23:11:46.152009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240207 23:11:47.442785 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240207 23:11:48.442006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.571 ms                  | 249.185 ms                |
| ProcessBack:UpdateCache   | 7.778 ms                  | 550.008 ms                |
| ProcessBack:UpsertPq      | 32.836 ms                 | 78.326 ms                 |
| ProcessOneStep            | 50.968 ms                 | 97.164 ms                 |
| BlockToStepN              | 13.195 ms                 | 686.647 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:49.446136 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.035 ms                  | 96.084 ms                 |
| Forward                   | 5.230 ms                  | 11.036 ms                 |
| Backward                  | 10.197 ms                 | 12.951 ms                 |
| Optimize                  | 2.685 ms                  | 10.768 ms                 |
| BarrierTimeBeforeRank0    | 3.591 ms                  | 50.248 ms                 |
| AfterBackward             | 51.002 ms                 | 97.198 ms                 |
| BlockToStepN              | 339.787 ms                | 688.329 ms                |
| OneStep                   | 444.051 ms                | 956.180 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:50.446008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240207 23:11:51.446009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240207 23:11:52.484313 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=66, pq.top=66
W20240207 23:11:53.484009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.571 ms                  | 249.185 ms                |
| ProcessBack:UpdateCache   | 7.688 ms                  | 550.008 ms                |
| ProcessBack:UpsertPq      | 32.277 ms                 | 78.326 ms                 |
| ProcessOneStep            | 49.661 ms                 | 97.164 ms                 |
| BlockToStepN              | 13.195 ms                 | 693.408 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:54.484005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.744 ms                  | 96.084 ms                 |
| Forward                   | 5.179 ms                  | 11.036 ms                 |
| Backward                  | 10.170 ms                 | 12.951 ms                 |
| Optimize                  | 2.629 ms                  | 10.768 ms                 |
| BarrierTimeBeforeRank0    | 3.535 ms                  | 122.745 ms                |
| AfterBackward             | 49.972 ms                 | 97.198 ms                 |
| BlockToStepN              | 13.237 ms                 | 693.479 ms                |
| OneStep                   | 184.057 ms                | 956.180 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:55.484006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240207 23:11:56.484007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240207 23:11:57.484009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240207 23:11:58.484006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.422 ms                  | 29.019 ms                 |
| ProcessBack:UpdateCache   | 7.836 ms                  | 25.598 ms                 |
| ProcessBack:UpsertPq      | 31.934 ms                 | 78.326 ms                 |
| ProcessOneStep            | 49.661 ms                 | 109.838 ms                |
| BlockToStepN              | 13.195 ms                 | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:11:59.484004 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.521 ms                  | 96.084 ms                 |
| Forward                   | 5.140 ms                  | 17.775 ms                 |
| Backward                  | 10.171 ms                 | 16.565 ms                 |
| Optimize                  | 2.629 ms                  | 10.768 ms                 |
| BarrierTimeBeforeRank0    | 4.029 ms                  | 122.745 ms                |
| AfterBackward             | 49.709 ms                 | 109.875 ms                |
| BlockToStepN              | 13.237 ms                 | 695.843 ms                |
| OneStep                   | 184.057 ms                | 995.046 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:00.688570 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240207 23:12:01.747519 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
W20240207 23:12:02.747018 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240207 23:12:03.747006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.438 ms                  | 29.019 ms                 |
| ProcessBack:UpdateCache   | 7.829 ms                  | 25.598 ms                 |
| ProcessBack:UpsertPq      | 32.556 ms                 | 81.285 ms                 |
| ProcessOneStep            | 50.777 ms                 | 109.838 ms                |
| BlockToStepN              | 339.718 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:04.747007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.643 ms                  | 98.529 ms                 |
| Forward                   | 5.156 ms                  | 17.775 ms                 |
| Backward                  | 10.207 ms                 | 16.565 ms                 |
| Optimize                  | 2.675 ms                  | 10.768 ms                 |
| BarrierTimeBeforeRank0    | 4.029 ms                  | 132.303 ms                |
| AfterBackward             | 50.970 ms                 | 109.875 ms                |
| BlockToStepN              | 13.237 ms                 | 695.843 ms                |
| OneStep                   | 193.744 ms                | 995.046 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:05.747006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240207 23:12:06.747009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 48.566, sample: 1.255, forward: 1.029, backward: 1.167, update: 0.284
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 46.959, sample: 1.510, forward: 0.950, backward: 1.336, update: 0.309
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 44.813, sample: 2.152, forward: 0.999, backward: 1.286, update: 0.298
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 47.528, sample: 1.464, forward: 0.939, backward: 1.323, update: 0.304
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 45.342, sample: 1.551, forward: 1.005, backward: 1.331, update: 0.323
train_sampler.Prefill()
-------Step 0-------
tensor([ 4314623,   582661,   187107,   582677,   276411,   276443, 25493647,
          369776,   276463,  4426086]) tensor([10884079, 32955844, 78855984, 60023334, 72470406, 42504881, 36319879,
        45678741, 84991377, 41682243])
-------Step 1-------
tensor([ 4314623,   582661,   187107,   582677,   276411,   276443, 25493647,
          369776,   276463,  4426086]) tensor([48650315, 18213966, 22940944, 15711784, 57040993, 37129686, 75453438,
        21548842, 20731657, 37411279])
-------Step 2-------
tensor([  332077,   193793,   332095,   332112,   332142, 25494030,   332162,
          332183,   332212,   332236]) tensor([33706528,  7865704, 83778690,  1400683, 60831262, 19604148, 75420291,
           13366, 39751832, 78721809])
-------Step 3-------
tensor([  332077,   193793,   332095,   332112,   332142, 25494030,   332162,
          332183,   332212,   332236]) tensor([45161749, 12101852, 27566479,   613251, 51108276, 57223796, 60177643,
        70186429, 53035456, 71028504])
-------Step 4-------
tensor([  395186,   200170,   388261,   395211, 25493647,   220348,   200188,
          200212,   395228,  4815018]) tensor([84543384, 62524589, 47215281, 10352501, 51801865, 33933129, 14445380,
        51950380, 71498088, 33151634])
-------Step 5-------
tensor([  395186,   200170,   388261,   395211, 25493647,   220348,   200188,
          200212,   395228,  4815018]) tensor([39847639, 28991636,  9918846, 66173636, 65659141, 63990309,  7821704,
        81878396, 78190398, 77445911])
-------Step 6-------
tensor([ 347153, 4314623,  445093,  445119,   83200,     814,  445151,  445166,
         445194,  445226]) tensor([49507908, 22681503, 70257420, 48135551, 77713086, 42729060, 43698455,
        50331204, 11575589, 59446574])
-------Step 7-------
tensor([ 347153, 4314623,  445093,  445119,   83200,     814,  445151,  445166,
         445194,  445226]) tensor([42583053,  5390309, 70183500, 44419654, 82336291, 49048512,  6540371,
        16051828, 31012830,  4657820])
-------Step 8-------
tensor([  462654,    76330,    76361,    76395, 70842439,  4314623,    76438,
         4794911,    76468,    76511]) tensor([66425234, 11704070, 51780335, 82572541, 38098573, 52334957,  4917869,
        28458526, 30053602,  5850464])
-------Step 9-------
tensor([  462654,    76330,    76361,    76395, 70842439,  4314623,    76438,
         4794911,    76468,    76511]) tensor([22133852, 20684512, 82904253, 45129794, 36721136, 14829664, 45794429,
        17460921, 55051849, 64381636])
before start barrier
start train
[proc 0] 100 steps, total: 48.773, sample: 1.569, forward: 1.039, backward: 1.225, update: 0.367
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 46.328, sample: 1.630, forward: 0.981, backward: 1.192, update: 0.316
W20240207 23:12:07.747709 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240207 23:12:08.782135 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.438 ms                  | 29.019 ms                 |
| ProcessBack:UpdateCache   | 7.778 ms                  | 25.598 ms                 |
| ProcessBack:UpsertPq      | 33.018 ms                 | 81.285 ms                 |
| ProcessOneStep            | 50.968 ms                 | 109.838 ms                |
| BlockToStepN              | 13.195 ms                 | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:09.782006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.765 ms                  | 98.529 ms                 |
| Forward                   | 5.138 ms                  | 17.775 ms                 |
| Backward                  | 10.255 ms                 | 16.565 ms                 |
| Optimize                  | 2.629 ms                  | 10.768 ms                 |
| BarrierTimeBeforeRank0    | 4.029 ms                  | 136.139 ms                |
| AfterBackward             | 50.970 ms                 | 109.875 ms                |
| BlockToStepN              | 13.237 ms                 | 695.843 ms                |
| OneStep                   | 193.744 ms                | 995.046 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:10.782007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240207 23:12:11.782007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240207 23:12:12.782006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240207 23:12:13.782006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.428 ms                  | 29.019 ms                 |
| ProcessBack:UpdateCache   | 7.695 ms                  | 25.598 ms                 |
| ProcessBack:UpsertPq      | 32.432 ms                 | 81.285 ms                 |
| ProcessOneStep            | 50.100 ms                 | 109.838 ms                |
| BlockToStepN              | 13.195 ms                 | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:14.782006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.700 ms                  | 98.529 ms                 |
| Forward                   | 5.140 ms                  | 17.775 ms                 |
| Backward                  | 10.281 ms                 | 16.565 ms                 |
| Optimize                  | 2.601 ms                  | 10.768 ms                 |
| BarrierTimeBeforeRank0    | 4.139 ms                  | 136.139 ms                |
| AfterBackward             | 50.134 ms                 | 109.875 ms                |
| BlockToStepN              | 13.237 ms                 | 695.843 ms                |
| OneStep                   | 193.744 ms                | 995.046 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:15.782006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240207 23:12:16.782006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240207 23:12:17.782007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240207 23:12:18.782006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.455 ms                  | 29.019 ms                 |
| ProcessBack:UpdateCache   | 7.694 ms                  | 20.174 ms                 |
| ProcessBack:UpsertPq      | 31.970 ms                 | 79.711 ms                 |
| ProcessOneStep            | 49.679 ms                 | 109.838 ms                |
| BlockToStepN              | 13.195 ms                 | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:19.909515 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.643 ms                  | 98.529 ms                 |
| Forward                   | 5.138 ms                  | 17.775 ms                 |
| Backward                  | 10.334 ms                 | 16.565 ms                 |
| Optimize                  | 2.607 ms                  | 10.768 ms                 |
| BarrierTimeBeforeRank0    | 4.457 ms                  | 183.540 ms                |
| AfterBackward             | 49.709 ms                 | 109.875 ms                |
| BlockToStepN              | 13.237 ms                 | 695.843 ms                |
| OneStep                   | 193.744 ms                | 995.046 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:20.909006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240207 23:12:21.909005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240207 23:12:22.909005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240207 23:12:23.909008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.458 ms                  | 29.019 ms                 |
| ProcessBack:UpdateCache   | 7.694 ms                  | 20.174 ms                 |
| ProcessBack:UpsertPq      | 32.000 ms                 | 79.711 ms                 |
| ProcessOneStep            | 49.780 ms                 | 109.838 ms                |
| BlockToStepN              | 339.718 ms                | 701.454 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:24.909008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.575 ms                  | 98.529 ms                 |
| Forward                   | 5.138 ms                  | 17.775 ms                 |
| Backward                  | 10.362 ms                 | 16.565 ms                 |
| Optimize                  | 2.612 ms                  | 10.768 ms                 |
| BarrierTimeBeforeRank0    | 4.457 ms                  | 183.540 ms                |
| AfterBackward             | 49.972 ms                 | 109.875 ms                |
| BlockToStepN              | 13.237 ms                 | 701.538 ms                |
| OneStep                   | 193.744 ms                | 995.046 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:25.909006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240207 23:12:26.909008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240207 23:12:27.909008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240207 23:12:28.909008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.548 ms                  | 29.019 ms                 |
| ProcessBack:UpdateCache   | 7.720 ms                  | 20.174 ms                 |
| ProcessBack:UpsertPq      | 32.493 ms                 | 102.514 ms                |
| ProcessOneStep            | 50.334 ms                 | 162.891 ms                |
| BlockToStepN              | 13.195 ms                 | 701.454 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.582 ms                  | 98.529 ms                 |
| Forward                   | 5.132 ms                  | 17.775 ms                 |
| Backward                  | 10.393 ms                 | 30.300 ms                 |
| Optimize                  | 2.637 ms                  | 10.768 ms                 |
| BarrierTimeBeforeRank0    | 4.139 ms                  | 183.540 ms                |
| AfterBackward             | 50.370 ms                 | 162.976 ms                |
| BlockToStepN              | 13.237 ms                 | 701.538 ms                |
| OneStep                   | 202.634 ms                | 995.046 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:30.163765 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240207 23:12:31.163007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240207 23:12:32.163007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240207 23:12:33.163009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240207 23:12:34.163008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.571 ms                  | 29.019 ms                 |
| ProcessBack:UpdateCache   | 7.695 ms                  | 20.174 ms                 |
| ProcessBack:UpsertPq      | 32.556 ms                 | 102.514 ms                |
| ProcessOneStep            | 50.883 ms                 | 140.828 ms                |
| BlockToStepN              | 339.718 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.699 ms                  | 97.833 ms                 |
| Forward                   | 5.132 ms                  | 15.194 ms                 |
| Backward                  | 10.421 ms                 | 16.565 ms                 |
| Optimize                  | 2.631 ms                  | 10.374 ms                 |
| BarrierTimeBeforeRank0    | 3.591 ms                  | 136.139 ms                |
| AfterBackward             | 50.814 ms                 | 140.879 ms                |
| BlockToStepN              | 13.237 ms                 | 695.843 ms                |
| OneStep                   | 202.634 ms                | 986.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:35.214524 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240207 23:12:36.214008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240207 23:12:37.214006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240207 23:12:38.214006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240207 23:12:39.214008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.577 ms                  | 29.019 ms                 |
| ProcessBack:UpdateCache   | 7.666 ms                  | 20.174 ms                 |
| ProcessBack:UpsertPq      | 32.372 ms                 | 102.514 ms                |
| ProcessOneStep            | 50.142 ms                 | 140.828 ms                |
| BlockToStepN              | 32.026 ms                 | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.696 ms                  | 97.833 ms                 |
| Forward                   | 5.118 ms                  | 15.194 ms                 |
| Backward                  | 10.453 ms                 | 16.565 ms                 |
| Optimize                  | 2.627 ms                  | 10.374 ms                 |
| BarrierTimeBeforeRank0    | 4.029 ms                  | 178.665 ms                |
| AfterBackward             | 50.134 ms                 | 140.879 ms                |
| BlockToStepN              | 32.073 ms                 | 695.843 ms                |
| OneStep                   | 202.634 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:40.214007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240207 23:12:41.244841 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
W20240207 23:12:42.244007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240207 23:12:43.244007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240207 23:12:44.244007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.587 ms                  | 27.611 ms                 |
| ProcessBack:UpdateCache   | 7.609 ms                  | 19.673 ms                 |
| ProcessBack:UpsertPq      | 31.934 ms                 | 94.282 ms                 |
| ProcessOneStep            | 49.661 ms                 | 140.828 ms                |
| BlockToStepN              | 80.848 ms                 | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.694 ms                  | 97.833 ms                 |
| Forward                   | 5.114 ms                  | 15.194 ms                 |
| Backward                  | 10.451 ms                 | 16.565 ms                 |
| Optimize                  | 2.607 ms                  | 10.374 ms                 |
| BarrierTimeBeforeRank0    | 4.029 ms                  | 178.665 ms                |
| AfterBackward             | 49.692 ms                 | 140.879 ms                |
| BlockToStepN              | 339.787 ms                | 695.843 ms                |
| OneStep                   | 444.051 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:45.244007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240207 23:12:46.244007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240207 23:12:47.244007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240207 23:12:48.244009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240207 23:12:49.284700 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.577 ms                  | 27.611 ms                 |
| ProcessBack:UpdateCache   | 7.594 ms                  | 19.673 ms                 |
| ProcessBack:UpsertPq      | 31.520 ms                 | 94.282 ms                 |
| ProcessOneStep            | 49.316 ms                 | 140.828 ms                |
| BlockToStepN              | 339.718 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.582 ms                  | 97.833 ms                 |
| Forward                   | 5.103 ms                  | 15.194 ms                 |
| Backward                  | 10.444 ms                 | 16.565 ms                 |
| Optimize                  | 2.629 ms                  | 10.374 ms                 |
| BarrierTimeBeforeRank0    | 4.029 ms                  | 178.665 ms                |
| AfterBackward             | 49.353 ms                 | 140.879 ms                |
| BlockToStepN              | 84.021 ms                 | 695.843 ms                |
| OneStep                   | 202.634 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:50.373703 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240207 23:12:51.480437 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 1] 200 steps, total: 44.669, sample: 1.617, forward: 0.506, backward: 1.135, update: 0.265
[proc 6] 200 steps, total: 44.670, sample: 2.573, forward: 0.483, backward: 1.138, update: 0.266
[proc 0] 200 steps, total: 44.669, sample: 1.474, forward: 0.539, backward: 1.092, update: 0.297
[proc 2] 200 steps, total: 44.670, sample: 1.242, forward: 0.514, backward: 1.030, update: 0.249
[proc 5] 200 steps, total: 44.669, sample: 1.451, forward: 0.490, backward: 1.061, update: 0.246
[proc 4] 200 steps, total: 44.670, sample: 1.553, forward: 0.474, backward: 1.160, update: 0.256
[proc 3] 200 steps, total: 44.670, sample: 1.480, forward: 0.486, backward: 1.120, update: 0.262
W20240207 23:12:52.480011 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240207 23:12:53.480010 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.577 ms                  | 27.611 ms                 |
| ProcessBack:UpdateCache   | 7.587 ms                  | 19.673 ms                 |
| ProcessBack:UpsertPq      | 31.341 ms                 | 94.282 ms                 |
| ProcessOneStep            | 49.245 ms                 | 140.828 ms                |
| BlockToStepN              | 91.812 ms                 | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:54.480005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.517 ms                  | 97.833 ms                 |
| Forward                   | 5.128 ms                  | 15.194 ms                 |
| Backward                  | 10.411 ms                 | 16.565 ms                 |
| Optimize                  | 2.629 ms                  | 10.374 ms                 |
| BarrierTimeBeforeRank0    | 4.213 ms                  | 178.665 ms                |
| AfterBackward             | 49.213 ms                 | 140.879 ms                |
| BlockToStepN              | 91.871 ms                 | 695.843 ms                |
| OneStep                   | 202.634 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:55.480008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240207 23:12:56.480012 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240207 23:12:57.494908 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=212, pq.top=212
W20240207 23:12:58.494009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.573 ms                  | 27.611 ms                 |
| ProcessBack:UpdateCache   | 7.594 ms                  | 19.673 ms                 |
| ProcessBack:UpsertPq      | 30.743 ms                 | 94.282 ms                 |
| ProcessOneStep            | 49.113 ms                 | 140.828 ms                |
| BlockToStepN              | 102.221 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:12:59.612282 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=216, pq.top=216
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.517 ms                  | 97.833 ms                 |
| Forward                   | 5.130 ms                  | 15.194 ms                 |
| Backward                  | 10.397 ms                 | 16.565 ms                 |
| Optimize                  | 2.622 ms                  | 10.374 ms                 |
| BarrierTimeBeforeRank0    | 4.280 ms                  | 178.665 ms                |
| AfterBackward             | 49.135 ms                 | 140.879 ms                |
| BlockToStepN              | 102.270 ms                | 695.843 ms                |
| OneStep                   | 202.634 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:00.612008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240207 23:13:01.612010 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240207 23:13:02.612010 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240207 23:13:03.612010 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.573 ms                  | 23.672 ms                 |
| ProcessBack:UpdateCache   | 7.594 ms                  | 19.239 ms                 |
| ProcessBack:UpsertPq      | 30.743 ms                 | 88.505 ms                 |
| ProcessOneStep            | 49.163 ms                 | 140.828 ms                |
| BlockToStepN              | 120.646 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:04.612005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.454 ms                  | 97.833 ms                 |
| Forward                   | 5.136 ms                  | 15.194 ms                 |
| Backward                  | 10.386 ms                 | 16.565 ms                 |
| Optimize                  | 2.631 ms                  | 10.374 ms                 |
| BarrierTimeBeforeRank0    | 4.233 ms                  | 178.665 ms                |
| AfterBackward             | 49.213 ms                 | 140.879 ms                |
| BlockToStepN              | 339.787 ms                | 695.843 ms                |
| OneStep                   | 444.051 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:05.612010 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240207 23:13:06.612008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240207 23:13:07.612010 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240207 23:13:08.612010 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.573 ms                  | 23.672 ms                 |
| ProcessBack:UpdateCache   | 7.594 ms                  | 19.239 ms                 |
| ProcessBack:UpsertPq      | 31.017 ms                 | 88.505 ms                 |
| ProcessOneStep            | 49.250 ms                 | 140.828 ms                |
| BlockToStepN              | 120.646 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:09.624712 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.498 ms                  | 97.833 ms                 |
| Forward                   | 5.140 ms                  | 15.194 ms                 |
| Backward                  | 10.376 ms                 | 16.565 ms                 |
| Optimize                  | 2.629 ms                  | 10.374 ms                 |
| BarrierTimeBeforeRank0    | 4.213 ms                  | 178.665 ms                |
| AfterBackward             | 49.348 ms                 | 140.879 ms                |
| BlockToStepN              | 120.709 ms                | 695.843 ms                |
| OneStep                   | 230.789 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:10.624008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
W20240207 23:13:11.624008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240207 23:13:12.669250 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240207 23:13:13.814893 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.573 ms                  | 23.672 ms                 |
| ProcessBack:UpdateCache   | 7.594 ms                  | 19.239 ms                 |
| ProcessBack:UpsertPq      | 30.760 ms                 | 88.505 ms                 |
| ProcessOneStep            | 49.446 ms                 | 140.828 ms                |
| BlockToStepN              | 129.799 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:14.814009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.575 ms                  | 97.833 ms                 |
| Forward                   | 5.179 ms                  | 15.194 ms                 |
| Backward                  | 10.362 ms                 | 16.565 ms                 |
| Optimize                  | 2.627 ms                  | 10.374 ms                 |
| BarrierTimeBeforeRank0    | 4.139 ms                  | 178.665 ms                |
| AfterBackward             | 49.465 ms                 | 140.879 ms                |
| BlockToStepN              | 129.853 ms                | 695.843 ms                |
| OneStep                   | 230.789 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:15.814007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240207 23:13:16.814009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240207 23:13:17.814010 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240207 23:13:18.814009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.586 ms                  | 23.672 ms                 |
| ProcessBack:UpdateCache   | 7.587 ms                  | 19.239 ms                 |
| ProcessBack:UpsertPq      | 30.625 ms                 | 88.505 ms                 |
| ProcessOneStep            | 49.316 ms                 | 126.741 ms                |
| BlockToStepN              | 134.138 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:19.814007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.630 ms                  | 96.084 ms                 |
| Forward                   | 5.202 ms                  | 12.813 ms                 |
| Backward                  | 10.353 ms                 | 16.565 ms                 |
| Optimize                  | 2.629 ms                  | 8.488 ms                  |
| BarrierTimeBeforeRank0    | 4.221 ms                  | 148.829 ms                |
| AfterBackward             | 49.348 ms                 | 126.792 ms                |
| BlockToStepN              | 134.217 ms                | 695.843 ms                |
| OneStep                   | 230.789 ms                | 986.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:20.814009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240207 23:13:21.814007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240207 23:13:22.814007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240207 23:13:23.849488 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=268, pq.top=268
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.571 ms                  | 23.672 ms                 |
| ProcessBack:UpdateCache   | 7.559 ms                  | 19.239 ms                 |
| ProcessBack:UpsertPq      | 30.257 ms                 | 88.505 ms                 |
| ProcessOneStep            | 49.147 ms                 | 126.741 ms                |
| BlockToStepN              | 147.319 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:24.849005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.582 ms                  | 96.084 ms                 |
| Forward                   | 5.201 ms                  | 12.813 ms                 |
| Backward                  | 10.334 ms                 | 16.565 ms                 |
| Optimize                  | 2.622 ms                  | 8.488 ms                  |
| BarrierTimeBeforeRank0    | 4.280 ms                  | 148.829 ms                |
| AfterBackward             | 49.143 ms                 | 126.792 ms                |
| BlockToStepN              | 147.365 ms                | 695.843 ms                |
| OneStep                   | 444.051 ms                | 986.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:25.849006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240207 23:13:26.849007 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240207 23:13:27.901886 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240207 23:13:29.054911 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.515 ms                  | 19.364 ms                 |
| ProcessBack:UpdateCache   | 7.542 ms                  | 17.392 ms                 |
| ProcessBack:UpsertPq      | 29.965 ms                 | 88.035 ms                 |
| ProcessOneStep            | 49.067 ms                 | 126.741 ms                |
| BlockToStepN              | 158.160 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.585 ms                  | 96.084 ms                 |
| Forward                   | 5.178 ms                  | 12.813 ms                 |
| Backward                  | 10.320 ms                 | 16.565 ms                 |
| Optimize                  | 2.607 ms                  | 8.488 ms                  |
| BarrierTimeBeforeRank0    | 4.428 ms                  | 148.829 ms                |
| AfterBackward             | 49.062 ms                 | 126.792 ms                |
| BlockToStepN              | 158.198 ms                | 695.843 ms                |
| OneStep                   | 230.789 ms                | 986.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:30.054006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240207 23:13:31.054008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240207 23:13:32.054008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240207 23:13:33.054009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240207 23:13:34.054008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.487 ms                  | 19.364 ms                 |
| ProcessBack:UpdateCache   | 7.504 ms                  | 17.392 ms                 |
| ProcessBack:UpsertPq      | 29.498 ms                 | 88.035 ms                 |
| ProcessOneStep            | 48.769 ms                 | 126.741 ms                |
| BlockToStepN              | 158.160 ms                | 695.743 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.582 ms                  | 96.084 ms                 |
| Forward                   | 5.152 ms                  | 12.813 ms                 |
| Backward                  | 10.311 ms                 | 16.565 ms                 |
| Optimize                  | 2.607 ms                  | 8.488 ms                  |
| BarrierTimeBeforeRank0    | 4.415 ms                  | 148.829 ms                |
| AfterBackward             | 48.788 ms                 | 126.792 ms                |
| BlockToStepN              | 158.198 ms                | 695.843 ms                |
| OneStep                   | 237.839 ms                | 986.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:35.054005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240207 23:13:36.054008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240207 23:13:37.054006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240207 23:13:38.054008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
W20240207 23:13:39.054008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.476 ms                  | 19.364 ms                 |
| ProcessBack:UpdateCache   | 7.474 ms                  | 17.392 ms                 |
| ProcessBack:UpsertPq      | 29.426 ms                 | 88.035 ms                 |
| ProcessOneStep            | 48.712 ms                 | 126.741 ms                |
| BlockToStepN              | 171.615 ms                | 696.814 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 47.555, sample: 1.188, forward: 0.529, backward: 1.029, update: 0.292
[proc 6] 300 steps, total: 47.555, sample: 2.085, forward: 0.490, backward: 1.144, update: 0.260
[proc 1] 300 steps, total: 47.555, sample: 1.234, forward: 0.515, backward: 1.186, update: 0.278
[proc 3] 300 steps, total: 47.555, sample: 1.311, forward: 0.520, backward: 1.123, update: 0.273
[proc 4] 300 steps, total: 47.555, sample: 1.211, forward: 0.517, backward: 1.133, update: 0.274
[proc 2] 300 steps, total: 47.555, sample: 1.108, forward: 0.509, backward: 1.062, update: 0.289
[proc 5] 300 steps, total: 47.555, sample: 1.259, forward: 0.490, backward: 1.065, update: 0.253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.585 ms                  | 96.084 ms                 |
| Forward                   | 5.134 ms                  | 12.813 ms                 |
| Backward                  | 10.303 ms                 | 16.565 ms                 |
| Optimize                  | 2.606 ms                  | 8.488 ms                  |
| BarrierTimeBeforeRank0    | 4.415 ms                  | 148.829 ms                |
| AfterBackward             | 48.688 ms                 | 126.792 ms                |
| BlockToStepN              | 192.450 ms                | 701.538 ms                |
| OneStep                   | 266.126 ms                | 986.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:40.054004 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240207 23:13:41.133373 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240207 23:13:42.133008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=304, pq.top=304
W20240207 23:13:43.205149 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=306, pq.top=306
W20240207 23:13:44.205008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=307, pq.top=307
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.480 ms                  | 19.364 ms                 |
| ProcessBack:UpdateCache   | 7.423 ms                  | 17.392 ms                 |
| ProcessBack:UpsertPq      | 29.733 ms                 | 88.035 ms                 |
| ProcessOneStep            | 48.755 ms                 | 126.741 ms                |
| BlockToStepN              | 339.718 ms                | 811.923 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.588 ms                  | 96.084 ms                 |
| Forward                   | 5.132 ms                  | 12.813 ms                 |
| Backward                  | 10.301 ms                 | 16.565 ms                 |
| Optimize                  | 2.601 ms                  | 8.488 ms                  |
| BarrierTimeBeforeRank0    | 4.415 ms                  | 148.829 ms                |
| AfterBackward             | 48.806 ms                 | 126.792 ms                |
| BlockToStepN              | 205.199 ms                | 812.005 ms                |
| OneStep                   | 290.210 ms                | 986.630 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:45.205008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240207 23:13:46.205009 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240207 23:13:47.205016 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240207 23:13:48.205011 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240207 23:13:49.205008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=316, pq.top=316
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.506 ms                  | 19.364 ms                 |
| ProcessBack:UpdateCache   | 7.410 ms                  | 17.392 ms                 |
| ProcessBack:UpsertPq      | 29.838 ms                 | 88.035 ms                 |
| ProcessOneStep            | 48.841 ms                 | 126.741 ms                |
| BlockToStepN              | 205.144 ms                | 812.157 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.665 ms                  | 97.833 ms                 |
| Forward                   | 5.132 ms                  | 12.813 ms                 |
| Backward                  | 10.295 ms                 | 16.565 ms                 |
| Optimize                  | 2.595 ms                  | 8.488 ms                  |
| BarrierTimeBeforeRank0    | 4.280 ms                  | 148.829 ms                |
| AfterBackward             | 48.961 ms                 | 126.792 ms                |
| BlockToStepN              | 205.199 ms                | 812.236 ms                |
| OneStep                   | 298.354 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:50.309413 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
W20240207 23:13:51.309008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240207 23:13:52.309010 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240207 23:13:53.309008 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240207 23:13:54.309005 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 6.508 ms                  | 19.364 ms                 |
| ProcessBack:UpdateCache   | 7.377 ms                  | 17.392 ms                 |
| ProcessBack:UpsertPq      | 29.848 ms                 | 88.035 ms                 |
| ProcessOneStep            | 49.025 ms                 | 126.741 ms                |
| BlockToStepN              | 225.999 ms                | 812.598 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.699 ms                  | 97.833 ms                 |
| Forward                   | 5.118 ms                  | 12.813 ms                 |
| Backward                  | 10.283 ms                 | 16.565 ms                 |
| Optimize                  | 2.581 ms                  | 8.488 ms                  |
| BarrierTimeBeforeRank0    | 4.221 ms                  | 148.829 ms                |
| AfterBackward             | 49.062 ms                 | 126.792 ms                |
| BlockToStepN              | 339.787 ms                | 812.679 ms                |
| OneStep                   | 444.051 ms                | 992.470 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 23:13:55.452116 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240207 23:13:56.461311 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=329, pq.top=329
W20240207 23:13:57.461006 36100 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
Successfully xmh. training takes 158.64681935310364 seconds
before call kg_cache_controller.StopThreads()
W20240207 23:13:57.531493 36100 grad_async_v1.h:243] call StopThreads. PID = 34646
W20240207 23:13:57.531512 36100 grad_base.h:212] before processOneStepNegThread_.join();
W20240207 23:13:57.537566 36100 grad_base.h:214] after processOneStepNegThread_.join();
W20240207 23:13:57.537602 36100 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
