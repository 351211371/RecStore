WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 15:00:38.884474 39892 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_91', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [39892 sampler.py:454] Start PreSampling
WARNING [39892 sampler.py:532] Before construct renumbering_dict
WARNING [39892 sampler.py:555] PreSampling done
W20240202 15:00:43.643826 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 15:00:43.644136 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 15:00:43.644186 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 15:00:43.644238 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 15:00:43.644280 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 15:00:43.644320 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 15:00:43.644358 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 15:00:43.644397 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 15:00:43.644451 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 15:00:43.644491 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 15:00:43.644527 39892 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 15:00:43.644556 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 15:00:43.644605 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 15:00:43.644763 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 15:00:43.644814 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 15:00:43.644845 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 15:00:43.644901 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 15:00:43.644953 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 15:00:43.644994 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 15:00:43.645031 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 15:00:43.645061 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 15:00:43.645100 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 15:00:43.645130 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 15:00:43.645169 39892 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 15:00:43.645195 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 15:00:43.645218 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 15:00:43.645277 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 15:00:43.645313 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 15:00:43.645340 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 15:00:43.645370 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 15:00:43.645397 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 15:00:43.645437 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 15:00:43.645468 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 15:00:43.645498 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 15:00:43.645525 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 15:00:43.645565 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 15:00:43.645596 39892 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 15:00:43.645622 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 15:00:43.645653 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 15:00:43.645709 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 15:00:43.645745 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 15:00:43.645772 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 15:00:43.645809 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 15:00:43.645841 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 15:00:43.645874 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 15:00:43.645912 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 15:00:43.645944 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 15:00:43.645972 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 15:00:43.646003 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 15:00:43.646039 39892 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 15:00:43.646064 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 15:00:43.646091 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 15:00:43.646153 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240202 15:00:43.646204 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240202 15:00:43.646241 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240202 15:00:43.646270 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240202 15:00:43.646306 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240202 15:00:43.646344 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240202 15:00:43.646389 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240202 15:00:43.646423 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240202 15:00:43.646451 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240202 15:00:43.646507 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240202 15:00:43.646536 39892 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240202 15:00:43.646565 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240202 15:00:43.646589 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240202 15:00:43.646649 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240202 15:00:43.646680 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240202 15:00:43.646716 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240202 15:00:43.646765 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240202 15:00:43.646816 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240202 15:00:43.646850 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240202 15:00:43.646890 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240202 15:00:43.646941 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240202 15:00:43.646975 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240202 15:00:43.647023 39892 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240202 15:00:43.647058 39892 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240202 15:00:43.647083 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240202 15:00:43.647115 39892 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240202 15:00:43.915056 39892 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10001ca5a000 22.81 MB
W20240202 15:00:44.010733 39892 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10001e12c000 58.4 kB
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  963,  1270,  1500,  ...,  3151,  2730, 11969]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.228 seconds
[Rank1] pid = 40313
[Rank2] pid = 40336
[Rank3] pid = 40441
[Rank4] pid = 40469
INFO [39892 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [40313 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [40336 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [40469 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [40441 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [40507 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [40441 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [40507 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [40313 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [39892 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [40336 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [40469 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240202 15:00:46.266522 40442 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240202 15:00:46.266636 40508 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240202 15:00:46.267508 40634 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240202 15:00:46.268100 40314 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240202 15:00:46.268100 40378 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240202 15:00:46.268914 40506 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240202 15:00:46.300005 40442 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10001e148000 7.629 MB
W20240202 15:00:46.300117 40508 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10001e8eb000 7.629 MB
W20240202 15:00:46.300148 40506 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10001f08e000 7.629 MB
W20240202 15:00:46.300168 40378 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10001f831000 7.629 MB
W20240202 15:00:46.300172 40634 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10001ffd4000 7.629 MB
W20240202 15:00:46.300200 40314 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100020777000 7.629 MB
W20240202 15:00:46.300253 40442 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100020f1a000 7.629 MB
W20240202 15:00:46.300284 40508 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000216bd000 7.629 MB
W20240202 15:00:46.300355 40634 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100021e60000 7.629 MB
W20240202 15:00:46.300359 40508 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100022603000 1.49 GB
W20240202 15:00:46.300367 40314 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100081be6000 7.629 MB
W20240202 15:00:46.300376 40442 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100082389000 1.49 GB
W20240202 15:00:46.300393 40378 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1000e196c000 7.629 MB
W20240202 15:00:46.300412 40506 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000e210f000 7.629 MB
W20240202 15:00:46.300428 40508 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1000e28b2000 1.49 GB
W20240202 15:00:46.300484 40508 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 15:00:46.300494 40442 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100141e95000 1.49 GB
W20240202 15:00:46.300542 40314 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1001a1478000 1.49 GB
W20240202 15:00:46.300566 40442 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 15:00:46.300573 40506 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x100200a5b000 1.49 GB
W20240202 15:00:46.300624 40314 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10026003e000 1.49 GB
W20240202 15:00:46.300632 40506 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1002bf621000 1.49 GB
W20240202 15:00:46.300698 40314 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 15:00:46.302150 40506 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 15:00:46.302274 40378 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10031ec04000 1.49 GB
W20240202 15:00:46.302315 40634 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10037e1e7000 1.49 GB
W20240202 15:00:46.302346 40378 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1003dd7ca000 1.49 GB
W20240202 15:00:46.302377 40634 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10043cdad000 1.49 GB
W20240202 15:00:46.302408 40378 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 15:00:46.302428 40634 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 15:00:46.309993 40508 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 15:00:46.310259 40314 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 15:00:46.310281 40506 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 15:00:46.310299 40442 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 15:00:46.311650 40378 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 15:00:46.311663 40634 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x10001ca5a000
1: KnownLocalCachedEmbedding init done
WARNING [40313 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
2: KnownLocalCachedEmbedding init done
WARNING [40336 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
5: KnownLocalCachedEmbedding init done
WARNING [40507 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
3: KnownLocalCachedEmbedding init done
WARNING [40441 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
4: KnownLocalCachedEmbedding init done
WARNING [40469 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank5] pid = 40507
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
cudaHostRegister 0x10001ca5a000
0: KnownLocalCachedEmbedding init done
WARNING [39892 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 15:00:48.264444 40508 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240202 15:00:48.264778 40634 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240202 15:00:48.265444 40378 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240202 15:00:48.265578 40506 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240202 15:00:48.265691 40442 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240202 15:00:48.265775 40314 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
W20240202 15:00:48.268513 40508 grad_base.h:55] KGCacheController, config={
        "num_gpus": 6,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240202 15:00:48.268638 40508 grad_base.h:184] Init GradProcessingBase done
I20240202 15:00:48.270988 40508 grad_async_v1.h:203] Use main thread to update emb.
W20240202 15:00:48.271026 40508 kg_controller.h:75] after init GradAsyncProcessing
I20240202 15:00:48.271034 40508 kg_controller.h:84] Construct KGCacheController done
E20240202 15:00:48.874728 40508 recstore.cc:66] init folly done
E20240202 15:00:48.874900 40378 recstore.cc:66] init folly done
E20240202 15:00:48.874924 40442 recstore.cc:66] init folly done
E20240202 15:00:48.875164 40634 recstore.cc:66] init folly done
E20240202 15:00:48.875583 40314 recstore.cc:66] init folly done
E20240202 15:00:48.875672 40506 recstore.cc:66] init folly done
I20240202 15:00:48.876780 40508 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240202 15:00:49.492290 40506 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240202 15:00:49.499626 40378 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240202 15:00:49.501749 40314 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240202 15:00:49.510236 40508 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240202 15:00:49.510800 40634 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240202 15:00:49.513057 40442 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
W20240202 15:00:51.393251 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=0
E20240202 15:00:51.555385 41113 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=1, sample_step_cpp_seen_[rank]=0
W20240202 15:00:53.012046 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.093 ms                  | 25.909 ms                 |
| Forward                   | 5.785 ms                  | 615.727 ms                |
| Backward                  | 9.207 ms                  | 206.698 ms                |
| Optimize                  | 3.188 ms                  | 6.213 ms                  |
| BarrierTimeBeforeRank0    | 69.421 us                 | 8.931 ms                  |
| AfterBackward             | 19.903 ms                 | 1.050 s                   |
| BlockToStepN              | 328.792 us                | 113.036 ms                |
| OneStep                   | 53.226 ms                 | 1.994 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.977 ms                  | 266.795 ms                |
| ProcessBack:UpdateCache   | 5.616 ms                  | 582.327 ms                |
| ProcessBack:UpsertPq      | 8.919 ms                  | 36.460 ms                 |
| ProcessOneStep            | 19.922 ms                 | 1.049 s                   |
| BlockToStepN              | 714.524 us                | 299.605 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:00:54.012017 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240202 15:00:55.012020 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240202 15:00:56.012007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=34, pq.top=34
W20240202 15:00:57.015231 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240202 15:00:58.015007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.368 ms                  | 27.547 ms                 |
| Forward                   | 5.711 ms                  | 615.727 ms                |
| Backward                  | 9.180 ms                  | 206.698 ms                |
| Optimize                  | 2.583 ms                  | 6.213 ms                  |
| BarrierTimeBeforeRank0    | 41.522 us                 | 8.931 ms                  |
| AfterBackward             | 22.506 ms                 | 1.050 s                   |
| BlockToStepN              | 92.985 ms                 | 299.765 ms                |
| OneStep                   | 137.310 ms                | 1.994 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.117 ms                  | 232.144 ms                |
| ProcessBack:UpdateCache   | 5.360 ms                  | 579.706 ms                |
| ProcessBack:UpsertPq      | 10.788 ms                 | 36.113 ms                 |
| ProcessOneStep            | 22.290 ms                 | 751.913 ms                |
| BlockToStepN              | 94.424 ms                 | 168.274 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:00:59.027084 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=54, pq.top=54
W20240202 15:01:00.027006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240202 15:01:01.027022 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240202 15:01:02.027007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
W20240202 15:01:03.027005 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.379 ms                  | 27.355 ms                 |
| Forward                   | 5.625 ms                  | 12.073 ms                 |
| Backward                  | 9.182 ms                  | 13.391 ms                 |
| Optimize                  | 2.561 ms                  | 5.684 ms                  |
| BarrierTimeBeforeRank0    | 40.079 us                 | 8.574 ms                  |
| AfterBackward             | 22.506 ms                 | 752.130 ms                |
| BlockToStepN              | 106.793 ms                | 168.340 ms                |
| OneStep                   | 153.319 ms                | 882.296 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.049 ms                  | 11.418 ms                 |
| ProcessBack:UpdateCache   | 5.332 ms                  | 8.230 ms                  |
| ProcessBack:UpsertPq      | 10.975 ms                 | 20.453 ms                 |
| ProcessOneStep            | 22.418 ms                 | 751.913 ms                |
| BlockToStepN              | 108.832 ms                | 168.274 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:04.068709 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240202 15:01:05.068012 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=86, pq.top=86
W20240202 15:01:06.068006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240202 15:01:07.068006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=96, pq.top=96
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 18.530, sample: 0.404, forward: 1.008, backward: 1.129, update: 0.229
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 18.522, sample: 0.420, forward: 1.106, backward: 0.616, update: 0.247
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 18.511, sample: 0.407, forward: 1.075, backward: 1.143, update: 0.259
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 18.520, sample: 0.403, forward: 1.116, backward: 0.643, update: 0.253
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 18.509, sample: 0.401, forward: 1.101, backward: 1.153, update: 0.261
train_sampler.Prefill()
-------Step 0-------
tensor([   80,  4544, 11053,   952, 13561,  4555,    68,  9924, 10970,  3311]) tensor([ 1500,    53,  5970,  7716,    55, 11492, 13321, 14930,  1242, 11558])
-------Step 1-------
tensor([   80,  4544, 11053,   952, 13561,  4555,    68,  9924, 10970,  3311]) tensor([ 4293,  4102,   374,  9306,  6999,  9571,  1763, 12679, 14801, 11410])
-------Step 2-------
tensor([ 1859,  2466, 13561,  3789,  5684, 12853,    81,  7543, 10645,  4924]) tensor([ 8065, 12319,  6395, 13551,  9179,  9896,  3883,  3935,  2267, 13435])
-------Step 3-------
tensor([ 1859,  2466, 13561,  3789,  5684, 12853,    81,  7543, 10645,  4924]) tensor([7948, 2256, 2700, 7280, 5639,  469, 8453, 6150,  218, 3836])
-------Step 4-------
tensor([   89,  5980,  5423, 10716,  6665,  3803, 13561,  6555,  5080, 10493]) tensor([ 3435,  2537,  2946,  1678,  9104, 13526,  9816, 12836, 12807,  3373])
-------Step 5-------
tensor([   89,  5980,  5423, 10716,  6665,  3803, 13561,  6555,  5080, 10493]) tensor([ 7552,  6467,   541, 12929,  5368,  9461, 14528,   512, 10918,  1403])
-------Step 6-------
tensor([ 4818,  9109, 12331,  3096,  5592,   126,    65,  7551,    89,    51]) tensor([13081,  6552,  3409,  9976,  1074,   445,  3020, 13886,  2134,  2583])
-------Step 7-------
tensor([ 4818,  9109, 12331,  3096,  5592,   126,    65,  7551,    89,    51]) tensor([13221,   252, 10204,  5500, 14950, 10157,  5780,  4100,  7904,  3796])
-------Step 8-------
tensor([ 4897,  4689,  1038,   736,  4770,  1646,  4049,    46, 11712,    65]) tensor([ 7189,  2453,  2315, 11482, 13108,  7008, 11172,  8154,  5696, 12744])
-------Step 9-------
tensor([ 4897,  4689,  1038,   736,  4770,  1646,  4049,    46, 11712,    65]) tensor([11580, 13888, 11206,  5331,  2663, 10469,   454,  8511,  6446,  1816])
before start barrier
start train
[proc 0] 100 steps, total: 18.512, sample: 0.431, forward: 1.171, backward: 1.017, update: 0.274
W20240202 15:01:08.068017 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.371 ms                  | 27.355 ms                 |
| Forward                   | 5.496 ms                  | 12.073 ms                 |
| Backward                  | 9.124 ms                  | 13.391 ms                 |
| Optimize                  | 2.555 ms                  | 5.684 ms                  |
| BarrierTimeBeforeRank0    | 261.532 us                | 23.066 ms                 |
| AfterBackward             | 22.429 ms                 | 752.130 ms                |
| BlockToStepN              | 122.412 ms                | 193.557 ms                |
| OneStep                   | 170.561 ms                | 882.296 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.957 ms                  | 11.418 ms                 |
| ProcessBack:UpdateCache   | 5.410 ms                  | 8.230 ms                  |
| ProcessBack:UpsertPq      | 11.078 ms                 | 20.453 ms                 |
| ProcessOneStep            | 22.353 ms                 | 751.913 ms                |
| BlockToStepN              | 123.485 ms                | 193.515 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:09.068007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240202 15:01:10.105711 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=110, pq.top=110
W20240202 15:01:11.105006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=114, pq.top=114
W20240202 15:01:12.141989 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240202 15:01:13.141009 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.371 ms                  | 31.445 ms                 |
| Forward                   | 5.510 ms                  | 12.073 ms                 |
| Backward                  | 9.071 ms                  | 13.391 ms                 |
| Optimize                  | 2.501 ms                  | 5.684 ms                  |
| BarrierTimeBeforeRank0    | 999.213 us                | 26.754 ms                 |
| AfterBackward             | 22.385 ms                 | 752.130 ms                |
| BlockToStepN              | 129.636 ms                | 274.613 ms                |
| OneStep                   | 179.267 ms                | 882.296 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.884 ms                  | 8.160 ms                  |
| ProcessBack:UpdateCache   | 5.424 ms                  | 7.384 ms                  |
| ProcessBack:UpsertPq      | 11.202 ms                 | 19.966 ms                 |
| ProcessOneStep            | 22.353 ms                 | 751.913 ms                |
| BlockToStepN              | 132.733 ms                | 274.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:14.141006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240202 15:01:15.141006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=132, pq.top=132
W20240202 15:01:16.141018 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=136, pq.top=136
W20240202 15:01:17.141011 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240202 15:01:18.141008 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=144, pq.top=144
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.403 ms                  | 31.445 ms                 |
| Forward                   | 5.509 ms                  | 12.073 ms                 |
| Backward                  | 9.039 ms                  | 13.391 ms                 |
| Optimize                  | 2.449 ms                  | 5.684 ms                  |
| BarrierTimeBeforeRank0    | 1.982 ms                  | 28.871 ms                 |
| AfterBackward             | 22.475 ms                 | 752.130 ms                |
| BlockToStepN              | 139.698 ms                | 274.613 ms                |
| OneStep                   | 189.481 ms                | 882.296 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.812 ms                  | 8.160 ms                  |
| ProcessBack:UpdateCache   | 5.531 ms                  | 7.384 ms                  |
| ProcessBack:UpsertPq      | 11.295 ms                 | 19.966 ms                 |
| ProcessOneStep            | 22.447 ms                 | 751.913 ms                |
| BlockToStepN              | 140.679 ms                | 274.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:19.166324 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240202 15:01:20.166020 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240202 15:01:21.166005 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
W20240202 15:01:22.166007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240202 15:01:23.166015 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.409 ms                  | 27.547 ms                 |
| Forward                   | 5.472 ms                  | 11.635 ms                 |
| Backward                  | 4.967 ms                  | 10.576 ms                 |
| Optimize                  | 2.421 ms                  | 5.547 ms                  |
| BarrierTimeBeforeRank0    | 2.614 ms                  | 30.255 ms                 |
| AfterBackward             | 22.429 ms                 | 76.032 ms                 |
| BlockToStepN              | 148.251 ms                | 222.615 ms                |
| OneStep                   | 200.588 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.775 ms                  | 8.160 ms                  |
| ProcessBack:UpdateCache   | 5.551 ms                  | 7.384 ms                  |
| ProcessBack:UpsertPq      | 11.328 ms                 | 19.966 ms                 |
| ProcessOneStep            | 22.401 ms                 | 75.981 ms                 |
| BlockToStepN              | 148.345 ms                | 225.786 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:24.166007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240202 15:01:25.166007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240202 15:01:26.166007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240202 15:01:27.166018 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240202 15:01:28.166011 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.421 ms                  | 27.547 ms                 |
| Forward                   | 5.447 ms                  | 11.635 ms                 |
| Backward                  | 4.614 ms                  | 10.576 ms                 |
| Optimize                  | 2.403 ms                  | 5.547 ms                  |
| BarrierTimeBeforeRank0    | 3.640 ms                  | 30.255 ms                 |
| AfterBackward             | 22.407 ms                 | 76.032 ms                 |
| BlockToStepN              | 156.650 ms                | 243.347 ms                |
| OneStep                   | 205.041 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.732 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.555 ms                  | 6.808 ms                  |
| ProcessBack:UpsertPq      | 11.368 ms                 | 19.966 ms                 |
| ProcessOneStep            | 22.379 ms                 | 75.981 ms                 |
| BlockToStepN              | 157.569 ms                | 243.292 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:29.166007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240202 15:01:30.166007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240202 15:01:31.166011 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240202 15:01:32.166015 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=200, pq.top=200
[proc 3] 200 steps, total: 24.344, sample: 0.404, forward: 0.470, backward: 0.907, update: 0.238
[proc 5] 200 steps, total: 24.344, sample: 0.428, forward: 0.467, backward: 0.915, update: 0.243
[proc 4] 200 steps, total: 24.344, sample: 0.412, forward: 0.449, backward: 0.942, update: 0.221
[proc 2] 200 steps, total: 24.344, sample: 0.406, forward: 0.486, backward: 0.408, update: 0.236
[proc 1] 200 steps, total: 24.344, sample: 0.423, forward: 0.494, backward: 0.444, update: 0.247
[proc 0] 200 steps, total: 24.344, sample: 0.518, forward: 0.530, backward: 0.414, update: 0.247
W20240202 15:01:33.166005 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.422 ms                  | 28.486 ms                 |
| Forward                   | 5.454 ms                  | 11.635 ms                 |
| Backward                  | 4.527 ms                  | 10.576 ms                 |
| Optimize                  | 2.399 ms                  | 5.684 ms                  |
| BarrierTimeBeforeRank0    | 4.008 ms                  | 31.349 ms                 |
| AfterBackward             | 22.399 ms                 | 76.032 ms                 |
| BlockToStepN              | 160.962 ms                | 274.613 ms                |
| OneStep                   | 211.705 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.722 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.556 ms                  | 6.808 ms                  |
| ProcessBack:UpsertPq      | 11.398 ms                 | 20.083 ms                 |
| ProcessOneStep            | 22.357 ms                 | 75.981 ms                 |
| BlockToStepN              | 161.231 ms                | 274.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:34.166007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240202 15:01:35.192126 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240202 15:01:36.192020 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
W20240202 15:01:37.192013 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
W20240202 15:01:38.192008 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.422 ms                  | 28.486 ms                 |
| Forward                   | 5.472 ms                  | 11.635 ms                 |
| Backward                  | 4.475 ms                  | 10.576 ms                 |
| Optimize                  | 2.399 ms                  | 5.684 ms                  |
| BarrierTimeBeforeRank0    | 4.150 ms                  | 31.349 ms                 |
| AfterBackward             | 22.444 ms                 | 76.032 ms                 |
| BlockToStepN              | 163.755 ms                | 274.613 ms                |
| OneStep                   | 215.755 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.708 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.560 ms                  | 6.808 ms                  |
| ProcessBack:UpsertPq      | 11.429 ms                 | 20.083 ms                 |
| ProcessOneStep            | 22.418 ms                 | 75.981 ms                 |
| BlockToStepN              | 163.764 ms                | 274.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:39.192006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240202 15:01:40.192013 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240202 15:01:41.232540 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240202 15:01:42.232007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
W20240202 15:01:43.232005 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=240, pq.top=240
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.431 ms                  | 31.394 ms                 |
| Forward                   | 5.496 ms                  | 11.635 ms                 |
| Backward                  | 4.444 ms                  | 10.576 ms                 |
| Optimize                  | 2.396 ms                  | 5.684 ms                  |
| BarrierTimeBeforeRank0    | 4.212 ms                  | 31.349 ms                 |
| AfterBackward             | 22.475 ms                 | 76.032 ms                 |
| BlockToStepN              | 166.608 ms                | 274.613 ms                |
| OneStep                   | 220.354 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.701 ms                  | 6.688 ms                  |
| ProcessBack:UpdateCache   | 5.562 ms                  | 6.584 ms                  |
| ProcessBack:UpsertPq      | 11.480 ms                 | 19.972 ms                 |
| ProcessOneStep            | 22.447 ms                 | 75.981 ms                 |
| BlockToStepN              | 167.535 ms                | 274.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:44.232010 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240202 15:01:45.232018 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=248, pq.top=248
W20240202 15:01:46.232007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240202 15:01:47.242046 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240202 15:01:48.242022 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.437 ms                  | 30.745 ms                 |
| Forward                   | 5.507 ms                  | 9.665 ms                  |
| Backward                  | 4.410 ms                  | 10.301 ms                 |
| Optimize                  | 2.395 ms                  | 5.547 ms                  |
| BarrierTimeBeforeRank0    | 4.417 ms                  | 30.800 ms                 |
| AfterBackward             | 22.475 ms                 | 35.232 ms                 |
| BlockToStepN              | 170.207 ms                | 274.613 ms                |
| OneStep                   | 224.220 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.681 ms                  | 6.688 ms                  |
| ProcessBack:UpdateCache   | 5.559 ms                  | 6.584 ms                  |
| ProcessBack:UpsertPq      | 11.556 ms                 | 20.083 ms                 |
| ProcessOneStep            | 22.477 ms                 | 35.200 ms                 |
| BlockToStepN              | 170.933 ms                | 274.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:49.242007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
W20240202 15:01:50.242007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=266, pq.top=266
W20240202 15:01:51.242015 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240202 15:01:52.242018 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.441 ms                  | 30.745 ms                 |
| Forward                   | 5.510 ms                  | 9.665 ms                  |
| Backward                  | 4.405 ms                  | 10.576 ms                 |
| Optimize                  | 2.372 ms                  | 5.547 ms                  |
| BarrierTimeBeforeRank0    | 4.638 ms                  | 30.800 ms                 |
| AfterBackward             | 22.520 ms                 | 35.232 ms                 |
| BlockToStepN              | 175.945 ms                | 274.613 ms                |
| OneStep                   | 231.457 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:53.298624 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.677 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.560 ms                  | 6.579 ms                  |
| ProcessBack:UpsertPq      | 11.560 ms                 | 20.083 ms                 |
| ProcessOneStep            | 22.490 ms                 | 35.339 ms                 |
| BlockToStepN              | 176.159 ms                | 286.082 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:54.298007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=280, pq.top=280
W20240202 15:01:55.298012 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240202 15:01:56.298017 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240202 15:01:57.321856 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.452 ms                  | 30.745 ms                 |
| Forward                   | 5.507 ms                  | 11.635 ms                 |
| Backward                  | 4.427 ms                  | 10.576 ms                 |
| Optimize                  | 2.357 ms                  | 5.547 ms                  |
| BarrierTimeBeforeRank0    | 4.512 ms                  | 30.800 ms                 |
| AfterBackward             | 22.521 ms                 | 35.367 ms                 |
| BlockToStepN              | 179.085 ms                | 286.160 ms                |
| OneStep                   | 236.186 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:58.321005 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=294, pq.top=294
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.699 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.560 ms                  | 6.579 ms                  |
| ProcessBack:UpsertPq      | 11.574 ms                 | 20.453 ms                 |
| ProcessOneStep            | 22.491 ms                 | 35.339 ms                 |
| BlockToStepN              | 179.151 ms                | 286.082 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:01:59.382336 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=298, pq.top=298
[proc 5] 300 steps, total: 27.838, sample: 0.429, forward: 0.468, backward: 0.936, update: 0.256
[proc 4] 300 steps, total: 27.838, sample: 0.408, forward: 0.478, backward: 0.966, update: 0.231
[proc 1] 300 steps, total: 27.837, sample: 0.416, forward: 0.513, backward: 0.805, update: 0.260
[proc 0] 300 steps, total: 27.837, sample: 0.490, forward: 0.565, backward: 0.493, update: 0.247
[proc 2] 300 steps, total: 27.838, sample: 0.411, forward: 0.501, backward: 0.790, update: 0.251
[proc 3] 300 steps, total: 27.838, sample: 0.467, forward: 0.490, backward: 0.973, update: 0.258
W20240202 15:02:00.382018 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=301, pq.top=301
W20240202 15:02:01.382006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240202 15:02:02.382007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.452 ms                  | 30.745 ms                 |
| Forward                   | 5.511 ms                  | 11.635 ms                 |
| Backward                  | 4.514 ms                  | 10.576 ms                 |
| Optimize                  | 2.347 ms                  | 5.547 ms                  |
| BarrierTimeBeforeRank0    | 4.468 ms                  | 30.800 ms                 |
| AfterBackward             | 22.568 ms                 | 35.367 ms                 |
| BlockToStepN              | 182.367 ms                | 286.160 ms                |
| OneStep                   | 237.796 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:03.382011 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=312, pq.top=312
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.701 ms                  | 6.859 ms                  |
| ProcessBack:UpdateCache   | 5.557 ms                  | 6.579 ms                  |
| ProcessBack:UpsertPq      | 11.574 ms                 | 21.036 ms                 |
| ProcessOneStep            | 22.554 ms                 | 35.339 ms                 |
| BlockToStepN              | 182.519 ms                | 286.082 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:04.382017 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240202 15:02:05.382006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240202 15:02:06.382006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=322, pq.top=322
W20240202 15:02:07.382010 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=326, pq.top=326
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.452 ms                  | 30.745 ms                 |
| Forward                   | 5.528 ms                  | 11.635 ms                 |
| Backward                  | 4.537 ms                  | 10.576 ms                 |
| Optimize                  | 2.353 ms                  | 5.547 ms                  |
| BarrierTimeBeforeRank0    | 4.512 ms                  | 30.800 ms                 |
| AfterBackward             | 22.568 ms                 | 35.367 ms                 |
| BlockToStepN              | 187.423 ms                | 286.160 ms                |
| OneStep                   | 240.610 ms                | 360.102 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:08.382011 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=329, pq.top=329
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.692 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.545 ms                  | 6.573 ms                  |
| ProcessBack:UpsertPq      | 11.541 ms                 | 21.036 ms                 |
| ProcessOneStep            | 22.542 ms                 | 35.339 ms                 |
| BlockToStepN              | 187.366 ms                | 286.082 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:09.382006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=332, pq.top=332
W20240202 15:02:10.382006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=336, pq.top=336
W20240202 15:02:11.382011 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240202 15:02:12.382022 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=342, pq.top=342
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.452 ms                  | 30.745 ms                 |
| Forward                   | 5.554 ms                  | 11.635 ms                 |
| Backward                  | 4.620 ms                  | 10.829 ms                 |
| Optimize                  | 2.367 ms                  | 5.547 ms                  |
| BarrierTimeBeforeRank0    | 4.520 ms                  | 30.800 ms                 |
| AfterBackward             | 22.599 ms                 | 38.642 ms                 |
| BlockToStepN              | 190.827 ms                | 291.351 ms                |
| OneStep                   | 245.548 ms                | 374.145 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:13.427284 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=346, pq.top=346
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.687 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.542 ms                  | 6.579 ms                  |
| ProcessBack:UpsertPq      | 11.570 ms                 | 22.664 ms                 |
| ProcessOneStep            | 22.563 ms                 | 38.612 ms                 |
| BlockToStepN              | 191.330 ms                | 291.294 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:14.427006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=349, pq.top=349
W20240202 15:02:15.427018 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=352, pq.top=352
W20240202 15:02:16.427006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=356, pq.top=356
W20240202 15:02:17.427011 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.466 ms                  | 30.238 ms                 |
| Forward                   | 5.537 ms                  | 10.273 ms                 |
| Backward                  | 4.752 ms                  | 10.576 ms                 |
| Optimize                  | 2.369 ms                  | 5.283 ms                  |
| BarrierTimeBeforeRank0    | 4.520 ms                  | 30.255 ms                 |
| AfterBackward             | 22.599 ms                 | 38.642 ms                 |
| BlockToStepN              | 193.557 ms                | 299.967 ms                |
| OneStep                   | 248.563 ms                | 390.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:18.427006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=362, pq.top=362
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.701 ms                  | 6.859 ms                  |
| ProcessBack:UpdateCache   | 5.539 ms                  | 6.579 ms                  |
| ProcessBack:UpsertPq      | 11.557 ms                 | 23.588 ms                 |
| ProcessOneStep            | 22.572 ms                 | 38.612 ms                 |
| BlockToStepN              | 193.933 ms                | 299.898 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:19.427021 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240202 15:02:20.427007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240202 15:02:21.427006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240202 15:02:22.427007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.467 ms                  | 30.745 ms                 |
| Forward                   | 5.537 ms                  | 10.273 ms                 |
| Backward                  | 4.944 ms                  | 10.576 ms                 |
| Optimize                  | 2.374 ms                  | 5.283 ms                  |
| BarrierTimeBeforeRank0    | 4.468 ms                  | 30.255 ms                 |
| AfterBackward             | 22.643 ms                 | 39.341 ms                 |
| BlockToStepN              | 194.851 ms                | 307.988 ms                |
| OneStep                   | 252.704 ms                | 390.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:23.427009 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=378, pq.top=378
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.704 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.536 ms                  | 6.584 ms                  |
| ProcessBack:UpsertPq      | 11.574 ms                 | 25.008 ms                 |
| ProcessOneStep            | 22.616 ms                 | 39.312 ms                 |
| BlockToStepN              | 194.769 ms                | 307.876 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:24.427014 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240202 15:02:25.445889 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=386, pq.top=386
W20240202 15:02:26.445008 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=389, pq.top=389
W20240202 15:02:27.445006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=392, pq.top=392
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.470 ms                  | 30.745 ms                 |
| Forward                   | 5.534 ms                  | 10.273 ms                 |
| Backward                  | 5.350 ms                  | 10.576 ms                 |
| Optimize                  | 2.381 ms                  | 5.283 ms                  |
| BarrierTimeBeforeRank0    | 4.468 ms                  | 30.255 ms                 |
| AfterBackward             | 22.647 ms                 | 39.701 ms                 |
| BlockToStepN              | 195.732 ms                | 307.988 ms                |
| OneStep                   | 253.557 ms                | 390.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:28.445016 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=396, pq.top=396
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.708 ms                  | 6.859 ms                  |
| ProcessBack:UpdateCache   | 5.515 ms                  | 6.584 ms                  |
| ProcessBack:UpsertPq      | 11.584 ms                 | 25.203 ms                 |
| ProcessOneStep            | 22.629 ms                 | 39.668 ms                 |
| BlockToStepN              | 196.354 ms                | 307.876 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:29.445008 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 2] 400 steps, total: 29.718, sample: 0.410, forward: 0.490, backward: 0.887, update: 0.260
[proc 5] 400 steps, total: 29.719, sample: 0.384, forward: 0.471, backward: 0.921, update: 0.262
[proc 4] 400 steps, total: 29.719, sample: 0.423, forward: 0.461, backward: 0.945, update: 0.239
[proc 3] 400 steps, total: 29.718, sample: 0.409, forward: 0.485, backward: 0.964, update: 0.262
[proc 0] 400 steps, total: 29.719, sample: 0.526, forward: 0.566, backward: 0.837, update: 0.255
[proc 1] 400 steps, total: 29.719, sample: 0.414, forward: 0.504, backward: 0.934, update: 0.266
W20240202 15:02:30.445006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=402, pq.top=402
W20240202 15:02:31.445006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=406, pq.top=406
W20240202 15:02:32.445012 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=409, pq.top=409
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.476 ms                  | 30.745 ms                 |
| Forward                   | 5.539 ms                  | 11.635 ms                 |
| Backward                  | 6.097 ms                  | 10.576 ms                 |
| Optimize                  | 2.388 ms                  | 5.283 ms                  |
| BarrierTimeBeforeRank0    | 4.452 ms                  | 30.255 ms                 |
| AfterBackward             | 22.665 ms                 | 39.701 ms                 |
| BlockToStepN              | 199.645 ms                | 307.988 ms                |
| OneStep                   | 256.530 ms                | 390.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:33.445015 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=412, pq.top=412
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.712 ms                  | 6.859 ms                  |
| ProcessBack:UpdateCache   | 5.512 ms                  | 6.584 ms                  |
| ProcessBack:UpsertPq      | 11.597 ms                 | 26.002 ms                 |
| ProcessOneStep            | 22.638 ms                 | 39.668 ms                 |
| BlockToStepN              | 201.272 ms                | 307.876 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:34.445006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=415, pq.top=415
W20240202 15:02:35.445008 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=418, pq.top=418
W20240202 15:02:36.445008 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240202 15:02:37.445013 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=424, pq.top=424
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.483 ms                  | 30.745 ms                 |
| Forward                   | 5.537 ms                  | 11.635 ms                 |
| Backward                  | 6.173 ms                  | 10.576 ms                 |
| Optimize                  | 2.395 ms                  | 5.283 ms                  |
| BarrierTimeBeforeRank0    | 4.468 ms                  | 30.255 ms                 |
| AfterBackward             | 22.680 ms                 | 41.511 ms                 |
| BlockToStepN              | 202.878 ms                | 307.988 ms                |
| OneStep                   | 257.768 ms                | 390.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:38.445013 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=427, pq.top=427
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.720 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.514 ms                  | 6.584 ms                  |
| ProcessBack:UpsertPq      | 11.624 ms                 | 27.032 ms                 |
| ProcessOneStep            | 22.638 ms                 | 41.482 ms                 |
| BlockToStepN              | 203.211 ms                | 307.876 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:39.445012 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=430, pq.top=430
W20240202 15:02:40.445008 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=433, pq.top=433
W20240202 15:02:41.445008 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=436, pq.top=436
W20240202 15:02:42.446889 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=440, pq.top=440
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.493 ms                  | 30.745 ms                 |
| Forward                   | 5.528 ms                  | 11.635 ms                 |
| Backward                  | 6.268 ms                  | 10.576 ms                 |
| Optimize                  | 2.399 ms                  | 5.283 ms                  |
| BarrierTimeBeforeRank0    | 4.468 ms                  | 30.255 ms                 |
| AfterBackward             | 22.687 ms                 | 41.511 ms                 |
| BlockToStepN              | 205.522 ms                | 309.148 ms                |
| OneStep                   | 260.442 ms                | 390.824 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:43.446012 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.720 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.509 ms                  | 6.614 ms                  |
| ProcessBack:UpsertPq      | 11.629 ms                 | 27.032 ms                 |
| ProcessOneStep            | 22.655 ms                 | 41.482 ms                 |
| BlockToStepN              | 206.072 ms                | 309.089 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:44.446012 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=446, pq.top=446
W20240202 15:02:45.446007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240202 15:02:46.446007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240202 15:02:47.446012 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.494 ms                  | 30.575 ms                 |
| Forward                   | 5.523 ms                  | 10.273 ms                 |
| Backward                  | 6.436 ms                  | 10.301 ms                 |
| Optimize                  | 2.403 ms                  | 5.166 ms                  |
| BarrierTimeBeforeRank0    | 4.517 ms                  | 29.701 ms                 |
| AfterBackward             | 22.717 ms                 | 39.701 ms                 |
| BlockToStepN              | 208.789 ms                | 326.071 ms                |
| OneStep                   | 262.767 ms                | 394.409 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:48.446012 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=458, pq.top=458
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.722 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.510 ms                  | 6.614 ms                  |
| ProcessBack:UpsertPq      | 11.643 ms                 | 27.032 ms                 |
| ProcessOneStep            | 22.692 ms                 | 39.668 ms                 |
| BlockToStepN              | 208.744 ms                | 325.909 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:49.446007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240202 15:02:50.466732 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=465, pq.top=465
W20240202 15:02:51.466007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=468, pq.top=468
W20240202 15:02:52.466020 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.506 ms                  | 30.575 ms                 |
| Forward                   | 5.520 ms                  | 10.273 ms                 |
| Backward                  | 7.368 ms                  | 10.829 ms                 |
| Optimize                  | 2.409 ms                  | 5.166 ms                  |
| BarrierTimeBeforeRank0    | 4.609 ms                  | 29.701 ms                 |
| AfterBackward             | 22.761 ms                 | 41.511 ms                 |
| BlockToStepN              | 209.368 ms                | 332.277 ms                |
| OneStep                   | 264.533 ms                | 399.822 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:53.466007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=474, pq.top=474
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.723 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.508 ms                  | 6.634 ms                  |
| ProcessBack:UpsertPq      | 11.659 ms                 | 28.230 ms                 |
| ProcessOneStep            | 22.735 ms                 | 41.482 ms                 |
| BlockToStepN              | 209.920 ms                | 332.212 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:54.466006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240202 15:02:55.466007 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240202 15:02:56.485978 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=484, pq.top=484
W20240202 15:02:57.527208 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=487, pq.top=487
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.513 ms                  | 30.575 ms                 |
| Forward                   | 5.511 ms                  | 10.273 ms                 |
| Backward                  | 8.939 ms                  | 10.829 ms                 |
| Optimize                  | 2.412 ms                  | 5.166 ms                  |
| BarrierTimeBeforeRank0    | 4.517 ms                  | 29.701 ms                 |
| AfterBackward             | 22.763 ms                 | 41.511 ms                 |
| BlockToStepN              | 211.079 ms                | 332.277 ms                |
| OneStep                   | 265.388 ms                | 399.822 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:58.527010 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=490, pq.top=490
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.727 ms                  | 6.824 ms                  |
| ProcessBack:UpdateCache   | 5.504 ms                  | 6.634 ms                  |
| ProcessBack:UpsertPq      | 11.648 ms                 | 27.622 ms                 |
| ProcessOneStep            | 22.735 ms                 | 41.482 ms                 |
| BlockToStepN              | 211.476 ms                | 333.387 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 15:02:59.527006 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240202 15:03:00.528846 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=496, pq.top=496
W20240202 15:03:01.528015 40508 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=499, pq.top=499
[proc 5] 500 steps, total: 32.093, sample: 0.399, forward: 0.479, backward: 0.921, update: 0.267
[proc 1] 500 steps, total: 32.093, sample: 0.415, forward: 0.504, backward: 0.948, update: 0.267
[proc 3] 500 steps, total: 32.093, sample: 0.382, forward: 0.472, backward: 0.976, update: 0.262
[proc 4] 500 steps, total: 32.093, sample: 0.413, forward: 0.456, backward: 0.962, update: 0.241
[proc 2] 500 steps, total: 32.093, sample: 0.361, forward: 0.492, backward: 0.898, update: 0.262
[proc 0] 500 steps, total: 32.093, sample: 0.493, forward: 0.534, backward: 0.895, update: 0.259
Successfully xmh. training takes 132.50676918029785 seconds
before call kg_cache_controller.StopThreads()
W20240202 15:03:02.017087 40508 grad_async_v1.h:243] call StopThreads. PID = 39892
W20240202 15:03:02.017112 40508 grad_base.h:212] before processOneStepNegThread_.join();
W20240202 15:03:02.025678 40508 grad_base.h:214] after processOneStepNegThread_.join();
W20240202 15:03:02.025709 40508 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240202 15:03:02.063719 40508 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f7059593bd0>
