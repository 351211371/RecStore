WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 17:51:13.294327 11537 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_9', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='None', use_my_emb=False, cache_ratio=0.05, shuffle=False, backwardMode='CppSync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [11537 sampler.py:454] Start PreSampling
WARNING [11537 sampler.py:532] Before construct renumbering_dict
WARNING [11537 sampler.py:555] PreSampling done
W20240206 18:11:06.114843 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 18:11:06.115031 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 18:11:06.115073 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 18:11:06.115099 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 18:11:06.115128 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 18:11:06.115159 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 18:11:06.115196 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 18:11:06.115239 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 18:11:06.115274 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 18:11:06.115303 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 18:11:06.115341 11537 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 18:11:06.115367 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 18:11:06.115394 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 18:11:06.115540 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 18:11:06.115577 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 18:11:06.115602 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 18:11:06.115653 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 18:11:06.115685 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 18:11:06.115720 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 18:11:06.115757 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 18:11:06.115794 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 18:11:06.115823 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 18:11:06.115859 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 18:11:06.115885 11537 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 18:11:06.115911 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 18:11:06.115934 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 18:11:06.115991 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 18:11:06.116024 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 18:11:06.116062 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 18:11:06.116102 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 18:11:06.116128 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 18:11:06.116160 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 18:11:06.116189 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 18:11:06.116220 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 18:11:06.116254 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 18:11:06.116289 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 18:11:06.116317 11537 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 18:11:06.116341 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 18:11:06.116364 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 18:11:06.116425 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 18:11:06.116457 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 18:11:06.116485 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 18:11:06.116515 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 18:11:06.116550 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 18:11:06.116586 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 18:11:06.116616 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 18:11:06.116647 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 18:11:06.116679 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 18:11:06.116712 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 18:11:06.116741 11537 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 18:11:06.116765 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 18:11:06.116791 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 18:11:06.116849 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 18:11:06.116886 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 18:11:06.116917 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 18:11:06.116947 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 18:11:06.116981 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 18:11:06.117013 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 18:11:06.117044 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 18:11:06.117075 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 18:11:06.117115 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 18:11:06.117146 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 18:11:06.117177 11537 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 18:11:06.117202 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 18:11:06.117224 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 18:11:06.117271 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 18:11:06.117303 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 18:11:06.117333 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 18:11:06.117363 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 18:11:06.117398 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 18:11:06.117424 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 18:11:06.117453 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 18:11:06.117482 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 18:11:06.117511 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 18:11:06.117538 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 18:11:06.117565 11537 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 18:11:06.117587 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 18:11:06.117609 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 18:11:06.117663 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 18:11:06.117693 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 18:11:06.117720 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 18:11:06.117748 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 18:11:06.117781 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 18:11:06.117810 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 18:11:06.117838 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 18:11:06.117866 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 18:11:06.117898 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 18:11:06.117928 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 18:11:06.117962 11537 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 18:11:06.117985 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 18:11:06.118007 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 18:11:06.118060 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240206 18:11:06.118089 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240206 18:11:06.118117 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240206 18:11:06.118155 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240206 18:11:06.118185 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240206 18:11:06.118218 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240206 18:11:06.118253 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240206 18:11:06.118288 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240206 18:11:06.118317 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240206 18:11:06.118355 11537 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240206 18:11:06.118386 11537 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240206 18:11:06.118408 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240206 18:11:06.118431 11537 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302704,  4302717,    89833,  ..., 57038709, 54280692,  5298365]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1796.632 seconds
[Rank1] pid = 12468
[Rank2] pid = 12562
[Rank3] pid = 12629
[Rank4] pid = 12696
[Rank5] pid = 12765
[Rank6] pid = 12832
INFO [11537 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [12468 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [12562 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [12629 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [12696 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [12765 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [12899 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [12832 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [11537 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12562 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12765 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12899 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12832 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12629 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12468 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12696 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240206 18:21:21.159963 12697 recstore.cc:66] init folly done
E20240206 18:21:21.160074 12900 recstore.cc:66] init folly done
E20240206 18:21:21.160073 12833 recstore.cc:66] init folly done
E20240206 18:21:21.160074 12469 recstore.cc:66] init folly done
E20240206 18:21:21.160209 12563 recstore.cc:66] init folly done
E20240206 18:21:21.160260 12766 recstore.cc:66] init folly done
E20240206 18:21:21.160319 12630 recstore.cc:66] init folly done
E20240206 18:21:21.160415 12963 recstore.cc:66] init folly done
I20240206 18:21:26.802619 12900 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240206 18:21:27.182073 12697 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 18:21:27.450875 12766 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 18:21:28.423136 12563 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 18:21:28.846468 12469 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 18:21:28.949445 12630 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 18:21:29.282159 12963 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 18:21:30.879926 12833 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.108 ms                  | 9.108 ms                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.285 ms                  | 100.775 ms                |
| Forward                   | 11.405 ms                 | 23.433 ms                 |
| Backward                  | 7.006 ms                  | 7.124 ms                  |
| Optimize                  | 11.800 ms                 | 24.713 ms                 |
| OneStep                   | 55.779 ms                 | 211.074 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 9.678, sample: 1.580, forward: 2.519, backward: 0.811, update: 1.217
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 9.151, sample: 1.351, forward: 2.498, backward: 0.841, update: 1.256
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 10.650, sample: 1.317, forward: 2.516, backward: 0.831, update: 1.215
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 9.254, sample: 1.070, forward: 2.497, backward: 0.830, update: 1.264
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 10.919, sample: 1.544, forward: 2.498, backward: 0.859, update: 1.220
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 11.298, sample: 1.192, forward: 2.397, backward: 0.854, update: 1.158
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 7.221, sample: 1.121, forward: 2.480, backward: 0.575, update: 1.113
[Rank7] pid = 12899
train_sampler.Prefill()
-------Step 0-------
tensor([   56048,    56086,    56132,    56159,  5852272,   136389, 52094155,
        17388020, 22351911,    56203]) tensor([ 5285922, 13865832, 66219187, 81842036, 18680145, 30104063, 38063261,
        71504492, 72034358, 31321691])
-------Step 1-------
tensor([   56048,    56086,    56132,    56159,  5852272,   136389, 52094155,
        17388020, 22351911,    56203]) tensor([62786009, 25187749, 10032083, 81587757, 85229363, 37178940, 79401259,
        48525520, 36044010, 12986067])
-------Step 2-------
tensor([  142836,   142877,   142920,    26172,   142946,   142990,   143018,
        26343803,   143056,   143081]) tensor([78813119, 23304107, 81237393, 53552000, 39613211, 29415804, 63078334,
        36456266, 14201593, 36423872])
-------Step 3-------
tensor([  142836,   142877,   142920,    26172,   142946,   142990,   143018,
        26343803,   143056,   143081]) tensor([46211961, 85882694, 37210519, 36370065, 70016652, 56982735, 37006805,
        16100136, 28165067,   706072])
-------Step 4-------
tensor([  229644, 45778601,   229672,   171829,   229700,   171857,   229720,
        37935142,   229752,   229783]) tensor([84748106,  9873212, 84861803, 16460396, 65233397, 46552572, 65145347,
        35707942, 74316625, 55245419])
-------Step 5-------
tensor([  229644, 45778601,   229672,   171829,   229700,   171857,   229720,
        37935142,   229752,   229783]) tensor([36118977, 70027415,   223623, 78398971, 60554806, 48963301, 14916014,
         9779578, 78269440, 36581385])
-------Step 6-------
tensor([  313560,    51000,   313588,   313627,    51021, 75189331,   313663,
          313698,   189560, 34681542]) tensor([11985499, 40960466, 35676315, 72380462, 34618869, 38115737, 25659243,
         6808765, 74840145, 72537752])
-------Step 7-------
tensor([  313560,    51000,   313588,   313627,    51021, 75189331,   313663,
          313698,   189560, 34681542]) tensor([24128850, 46582617, 75829904, 54313060, 76299507, 52019488, 48461827,
        52432915, 38107090, 33622881])
-------Step 8-------
tensor([  396015, 23563244,   396044,   206286,   396076,    63152,   396114,
          396149,   396199,   396245]) tensor([41205252, 21805464, 33198900,  1960357, 44165072, 72892130, 14650816,
        66244813,  1483068, 66627231])
-------Step 9-------
tensor([  396015, 23563244,   396044,   206286,   396076,    63152,   396114,
          396149,   396199,   396245]) tensor([50885091, 36611528, 14795161, 55179502,  8998700, 41785095, 23793891,
        35325800, 75287902, 63800511])
before start barrier
start train
[proc 0] 100 steps, total: 8.819, sample: 1.394, forward: 1.593, backward: 0.886, update: 1.245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.791 ms                  | 86.417 ms                 |
| Forward                   | 11.707 ms                 | 23.433 ms                 |
| Backward                  | 7.012 ms                  | 8.127 ms                  |
| Optimize                  | 11.890 ms                 | 24.713 ms                 |
| OneStep                   | 54.380 ms                 | 191.885 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 200 steps, total: 5.772, sample: 0.785, forward: 1.831, backward: 0.688, update: 1.075
[proc 2] 200 steps, total: 5.772, sample: 1.217, forward: 1.875, backward: 0.694, update: 1.085
[proc 4] 200 steps, total: 5.772, sample: 0.923, forward: 1.965, backward: 0.685, update: 1.155
[proc 0] 200 steps, total: 5.771, sample: 0.974, forward: 1.162, backward: 0.710, update: 1.216
[proc 6] 200 steps, total: 5.772, sample: 0.877, forward: 1.954, backward: 0.402, update: 1.013
[proc 3] 200 steps, total: 5.772, sample: 0.923, forward: 1.979, backward: 0.693, update: 1.152
[proc 1] 200 steps, total: 5.772, sample: 1.083, forward: 1.962, backward: 0.691, update: 1.127
[proc 5] 200 steps, total: 5.772, sample: 0.990, forward: 1.869, backward: 0.700, update: 1.112
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.500 ms                  | 86.417 ms                 |
| Forward                   | 11.900 ms                 | 27.901 ms                 |
| Backward                  | 7.044 ms                  | 26.341 ms                 |
| Optimize                  | 12.048 ms                 | 24.713 ms                 |
| OneStep                   | 51.641 ms                 | 191.885 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 300 steps, total: 5.670, sample: 0.627, forward: 1.867, backward: 0.710, update: 1.099
[proc 3] 300 steps, total: 5.670, sample: 0.622, forward: 2.053, backward: 0.681, update: 1.208
[proc 2] 300 steps, total: 5.670, sample: 0.705, forward: 2.130, backward: 0.700, update: 1.168
[proc 4] 300 steps, total: 5.670, sample: 0.631, forward: 2.073, backward: 0.683, update: 1.210
[proc 6] 300 steps, total: 5.670, sample: 0.653, forward: 2.067, backward: 0.628, update: 1.161
[proc 5] 300 steps, total: 5.670, sample: 0.663, forward: 2.023, backward: 0.691, update: 1.130
[proc 0] 300 steps, total: 5.670, sample: 0.737, forward: 1.249, backward: 0.693, update: 1.242
[proc 1] 300 steps, total: 5.670, sample: 0.735, forward: 2.035, backward: 0.675, update: 1.197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.099 ms                  | 81.122 ms                 |
| Forward                   | 12.047 ms                 | 28.281 ms                 |
| Backward                  | 7.058 ms                  | 11.102 ms                 |
| Optimize                  | 12.193 ms                 | 24.376 ms                 |
| OneStep                   | 52.819 ms                 | 182.952 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 5.545, sample: 0.652, forward: 1.891, backward: 0.691, update: 1.216
[proc 3] 400 steps, total: 5.545, sample: 0.670, forward: 1.856, backward: 0.701, update: 1.246
[proc 6] 400 steps, total: 5.545, sample: 0.731, forward: 2.013, backward: 0.483, update: 1.179
[proc 5] 400 steps, total: 5.545, sample: 0.634, forward: 2.061, backward: 0.662, update: 1.170
[proc 2] 400 steps, total: 5.545, sample: 0.672, forward: 2.034, backward: 0.677, update: 1.180
[proc 4] 400 steps, total: 5.545, sample: 0.634, forward: 2.076, backward: 0.694, update: 1.186
[proc 0] 400 steps, total: 5.545, sample: 0.699, forward: 1.220, backward: 0.773, update: 1.265
[proc 7] 400 steps, total: 5.545, sample: 0.720, forward: 1.858, backward: 0.651, update: 1.120
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.930 ms                  | 76.223 ms                 |
| Forward                   | 12.009 ms                 | 28.281 ms                 |
| Backward                  | 7.071 ms                  | 12.906 ms                 |
| Optimize                  | 12.274 ms                 | 24.376 ms                 |
| OneStep                   | 51.186 ms                 | 172.216 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 5.655, sample: 0.866, forward: 1.957, backward: 0.689, update: 1.140
[proc 0] 500 steps, total: 5.655, sample: 0.691, forward: 1.177, backward: 0.701, update: 1.262
[proc 2] 500 steps, total: 5.655, sample: 0.716, forward: 1.860, backward: 0.686, update: 1.188
[proc 3] 500 steps, total: 5.655, sample: 0.703, forward: 1.779, backward: 0.699, update: 1.188
[proc 1] 500 steps, total: 5.655, sample: 0.620, forward: 1.817, backward: 0.665, update: 1.180
[proc 6] 500 steps, total: 5.655, sample: 1.023, forward: 1.857, backward: 0.416, update: 1.139
[proc 7] 500 steps, total: 5.655, sample: 0.653, forward: 1.752, backward: 0.529, update: 1.159
[proc 5] 500 steps, total: 5.655, sample: 0.980, forward: 1.862, backward: 0.699, update: 1.141
Successfully xmh. training takes 31.460190057754517 seconds
before call kg_cache_controller.StopThreads()
