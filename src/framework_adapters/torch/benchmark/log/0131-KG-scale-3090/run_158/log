WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 21:44:06.473254 22032 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_44', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=5, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=5, gpu=[0, 1, 2, 3, 4], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [22032 sampler.py:454] Start PreSampling
WARNING [22032 sampler.py:532] Before construct renumbering_dict
WARNING [22032 sampler.py:555] PreSampling done
W20240205 21:44:11.201262 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 21:44:11.201426 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 21:44:11.201468 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 21:44:11.201499 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 21:44:11.201534 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 21:44:11.201565 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 21:44:11.201596 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 21:44:11.201627 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 21:44:11.201664 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 21:44:11.201690 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 21:44:11.201722 22032 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 21:44:11.201748 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 21:44:11.201772 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 21:44:11.201884 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 21:44:11.201917 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 21:44:11.201958 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 21:44:11.201999 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 21:44:11.202029 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 21:44:11.202056 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 21:44:11.202082 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 21:44:11.202116 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 21:44:11.202147 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 21:44:11.202173 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 21:44:11.202198 22032 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 21:44:11.202221 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 21:44:11.202250 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 21:44:11.202303 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 21:44:11.202334 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 21:44:11.202361 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 21:44:11.202389 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 21:44:11.202414 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 21:44:11.202456 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 21:44:11.202486 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 21:44:11.202512 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 21:44:11.202541 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 21:44:11.202574 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 21:44:11.202605 22032 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 21:44:11.202628 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 21:44:11.202656 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 21:44:11.202704 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 21:44:11.202744 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 21:44:11.202777 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 21:44:11.202803 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 21:44:11.202839 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 21:44:11.202867 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 21:44:11.202906 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 21:44:11.202944 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 21:44:11.202987 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 21:44:11.203020 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 21:44:11.203048 22032 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 21:44:11.203071 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 21:44:11.203100 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 21:44:11.203155 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 21:44:11.203193 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 21:44:11.203228 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 21:44:11.203258 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 21:44:11.203285 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 21:44:11.203312 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 21:44:11.203344 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 21:44:11.203372 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 21:44:11.203401 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 21:44:11.203431 22032 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 21:44:11.203459 22032 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 21:44:11.203481 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 21:44:11.203505 22032 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 21:44:11.457938 22032 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100017df6000 22.81 MB
W20240205 21:44:11.545838 22032 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000194c8000 58.4 kB
{0: Graph(num_nodes=10222, num_edges=137205,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=7861, num_edges=113516,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10587, num_edges=145765,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9264, num_edges=181068,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10248, num_edges=191956,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10222 N 137205 E
MertisPartition: part 1 has 7861 N 113516 E
MertisPartition: part 2 has 10587 N 145765 E
MertisPartition: part 3 has 9264 N 181068 E
MertisPartition: part 4 has 10248 N 191956 E
Rank0: cached key size 149
Rank1: cached key size 149
Rank2: cached key size 149
Rank3: cached key size 149
Rank4: cached key size 149
Before renumbering graph:  {'_ID': tensor([    7,    16,    18,  ..., 13890,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  888,  1050,  1084,  ..., 11160,  2131, 10519]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=10222, num_edges=137205,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10222, num_edges=137205,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.170 seconds
[Rank1] pid = 22235
[Rank2] pid = 22256
[Rank3] pid = 22334
INFO [22032 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [22235 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [22256 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [22366 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [22334 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [22334 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [22256 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [22366 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
W20240205 21:44:13.646745 22422 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240205 21:44:13.646864 22301 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240205 21:44:13.646862 22367 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
INFO [22032 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [22235 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
W20240205 21:44:13.649299 22454 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240205 21:44:13.650801 22236 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240205 21:44:13.675675 22301 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000194dc000 7.629 MB
W20240205 21:44:13.675698 22422 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100019c7f000 7.629 MB
W20240205 21:44:13.675860 22301 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10001a422000 7.629 MB
W20240205 21:44:13.675868 22422 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10001abc5000 7.629 MB
W20240205 21:44:13.675946 22301 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10001b368000 1.49 GB
W20240205 21:44:13.675963 22422 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10007a94b000 1.49 GB
W20240205 21:44:13.676028 22301 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1000d9f2e000 1.49 GB
W20240205 21:44:13.676038 22422 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x100139511000 1.49 GB
W20240205 21:44:13.676118 22301 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 21:44:13.676131 22422 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 21:44:13.676292 22367 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100198af6000 7.629 MB
W20240205 21:44:13.676484 22367 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100199299000 7.629 MB
W20240205 21:44:13.676569 22367 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100199a3c000 1.49 GB
W20240205 21:44:13.676640 22367 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1001f901f000 1.49 GB
W20240205 21:44:13.676703 22367 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 21:44:13.683015 22301 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240205 21:44:13.683128 22367 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240205 21:44:13.683135 22422 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240205 21:44:13.683245 22454 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10025860a000 7.629 MB
W20240205 21:44:13.683360 22454 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100258dad000 7.629 MB
W20240205 21:44:13.683413 22454 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100259550000 1.49 GB
W20240205 21:44:13.683454 22454 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1002b8b33000 1.49 GB
W20240205 21:44:13.683498 22454 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 21:44:13.684935 22236 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100318118000 7.629 MB
W20240205 21:44:13.685091 22236 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1003188bb000 7.629 MB
W20240205 21:44:13.685169 22236 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10031905e000 1.49 GB
W20240205 21:44:13.685233 22236 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x100378641000 1.49 GB
W20240205 21:44:13.685292 22236 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240205 21:44:13.692024 22454 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240205 21:44:13.692098 22236 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100017df6000
3: KnownLocalCachedEmbedding init done
WARNING [22334 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
1: KnownLocalCachedEmbedding init done
WARNING [22235 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
4: KnownLocalCachedEmbedding init done
WARNING [22366 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank4] pid = 22366
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735)]
cudaHostRegister 0x100017df6000
0: KnownLocalCachedEmbedding init done
WARNING [22032 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
2: KnownLocalCachedEmbedding init done
WARNING [22256 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 21:44:16.626850 22301 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 5
I20240205 21:44:16.627128 22236 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240205 21:44:16.627557 22422 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240205 21:44:16.627682 22367 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240205 21:44:16.627954 22454 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
W20240205 21:44:16.631289 22454 grad_base.h:55] KGCacheController, config={
        "num_gpus": 5,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240205 21:44:16.631614 22454 grad_base.h:184] Init GradProcessingBase done
I20240205 21:44:16.638492 22454 grad_async_v1.h:203] Use main thread to update emb.
W20240205 21:44:16.638585 22454 kg_controller.h:75] after init GradAsyncProcessing
I20240205 21:44:16.638612 22454 kg_controller.h:84] Construct KGCacheController done
E20240205 21:44:18.221365 22422 recstore.cc:66] init folly done
E20240205 21:44:18.221402 22236 recstore.cc:66] init folly done
E20240205 21:44:18.221411 22367 recstore.cc:66] init folly done
E20240205 21:44:18.222172 22454 recstore.cc:66] init folly done
E20240205 21:44:18.222326 22301 recstore.cc:66] init folly done
I20240205 21:44:18.223532 22454 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240205 21:44:18.695209 22236 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 5
I20240205 21:44:18.709394 22301 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240205 21:44:18.710314 22367 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240205 21:44:18.715142 22454 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240205 21:44:18.719950 22422 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
W20240205 21:44:20.165943 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=0
E20240205 21:44:20.206817 22627 grad_async_v1.h:533] Stalled in ProcessBackward: rank=1, step_no=1, sample_step_cpp_seen_[rank]=0
W20240205 21:44:21.624228 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.201 ms                  | 25.255 ms                 |
| Forward                   | 5.602 ms                  | 397.539 ms                |
| Backward                  | 4.877 ms                  | 202.404 ms                |
| Optimize                  | 2.495 ms                  | 47.253 ms                 |
| BarrierTimeBeforeRank0    | 3.883 ms                  | 17.339 ms                 |
| AfterBackward             | 21.843 ms                 | 779.517 ms                |
| BlockToStepN              | 47.607 us                 | 74.252 ms                 |
| OneStep                   | 45.472 ms                 | 1.450 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:22.624019 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.569 ms                  | 208.382 ms                |
| ProcessBack:UpdateCache   | 4.154 ms                  | 418.770 ms                |
| ProcessBack:UpsertPq      | 11.893 ms                 | 35.682 ms                 |
| ProcessOneStep            | 21.189 ms                 | 778.894 ms                |
| BlockToStepN              | 146.846 us                | 393.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:23.626199 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240205 21:44:24.626019 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=36, pq.top=36
W20240205 21:44:25.626016 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240205 21:44:26.626008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=50, pq.top=50
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.166 ms                  | 25.255 ms                 |
| Forward                   | 5.267 ms                  | 397.539 ms                |
| Backward                  | 9.721 ms                  | 202.404 ms                |
| Optimize                  | 2.275 ms                  | 47.253 ms                 |
| BarrierTimeBeforeRank0    | 1.502 ms                  | 17.339 ms                 |
| AfterBackward             | 17.964 ms                 | 779.517 ms                |
| BlockToStepN              | 89.750 ms                 | 393.437 ms                |
| OneStep                   | 131.734 ms                | 1.450 s                   |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:27.626016 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.283 ms                  | 172.921 ms                |
| ProcessBack:UpdateCache   | 3.662 ms                  | 418.178 ms                |
| ProcessBack:UpsertPq      | 9.826 ms                  | 34.475 ms                 |
| ProcessOneStep            | 17.013 ms                 | 533.185 ms                |
| BlockToStepN              | 95.050 ms                 | 180.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:28.626011 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=62, pq.top=62
W20240205 21:44:29.626015 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=68, pq.top=68
W20240205 21:44:30.626006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240205 21:44:31.626017 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.233 ms                  | 25.255 ms                 |
| Forward                   | 5.322 ms                  | 11.185 ms                 |
| Backward                  | 9.656 ms                  | 15.606 ms                 |
| Optimize                  | 2.282 ms                  | 5.652 ms                  |
| BarrierTimeBeforeRank0    | 1.622 ms                  | 17.339 ms                 |
| AfterBackward             | 17.368 ms                 | 533.315 ms                |
| BlockToStepN              | 105.702 ms                | 180.121 ms                |
| OneStep                   | 147.344 ms                | 578.460 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:32.626008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=84, pq.top=84
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.381 ms                  | 7.588 ms                  |
| ProcessBack:UpdateCache   | 3.626 ms                  | 8.729 ms                  |
| ProcessBack:UpsertPq      | 9.753 ms                  | 21.817 ms                 |
| ProcessOneStep            | 17.365 ms                 | 533.185 ms                |
| BlockToStepN              | 110.218 ms                | 180.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:33.626019 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240205 21:44:34.626008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=94, pq.top=94
W20240205 21:44:35.626006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 17.165, sample: 0.397, forward: 0.919, backward: 1.010, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 17.166, sample: 0.398, forward: 0.886, backward: 1.130, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 17.180, sample: 0.371, forward: 0.868, backward: 1.074, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 17.155, sample: 0.402, forward: 0.895, backward: 1.191, update: 0.314
train_sampler.Prefill()
-------Step 0-------
tensor([11659,    29, 11245,  7239,    78,    47,  8941, 14725,  3535, 12675]) tensor([ 1084,  1659,    46,  3879,  4129,  6053,   477,  3330,  5572, 14179])
-------Step 1-------
tensor([11659,    29, 11245,  7239,    78,    47,  8941, 14725,  3535, 12675]) tensor([  196,  9817,  3409, 13417, 13219, 12888,  4022,  8308,  9183,  4891])
-------Step 2-------
tensor([   97,  7196,  9823, 13826,  8146, 12520, 13338, 11922,  5502,   109]) tensor([ 9460,  5415,  6657, 14897,  6765,   957,  2491,   724, 11077,  1583])
-------Step 3-------
tensor([   97,  7196,  9823, 13826,  8146, 12520, 13338, 11922,  5502,   109]) tensor([14100,  2783,  6993,  7387, 14125,   424, 12498, 14732,   379,  2243])
-------Step 4-------
tensor([10200, 10197, 13573,  9375,  1902,  7536,  7930,  4822,  7607,  2308]) tensor([  456,  2901,   981,  6899,  5971, 14061, 12504, 12609,  8336,   504])
-------Step 5-------
tensor([10200, 10197, 13573,  9375,  1902,  7536,  7930,  4822,  7607,  2308]) tensor([12337, 13158,  6875,  7896,  4255,  1120,  3606,  4774,  4503, 13743])
-------Step 6-------
tensor([  894,   311,  9040,  3095,   116, 12338, 13826,    72,   778, 11259]) tensor([14326, 12183, 13052,  9122,  9186,  2571,  3022, 13060, 12279,  7077])
-------Step 7-------
tensor([  894,   311,  9040,  3095,   116, 12338, 13826,    72,   778, 11259]) tensor([ 5290,  5078,  2429, 14500,   237, 11777, 11733, 12729,  5836,  9230])
-------Step 8-------
tensor([ 8648, 10529,   788,  6881,  4276,    76, 13602,  6738,  4597,  3292]) tensor([ 1511,   963,  5750, 10711,  7418, 13699,  3918, 12495, 14450,   999])
-------Step 9-------
tensor([ 8648, 10529,   788,  6881,  4276,    76, 13602,  6738,  4597,  3292]) tensor([ 7945,  3630, 12542,  5803, 13565, 11924,  4655, 14517,  7347,   646])
before start barrier
start train
[proc 0] 100 steps, total: 17.160, sample: 0.392, forward: 0.933, backward: 1.075, update: 0.318
W20240205 21:44:36.643561 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=104, pq.top=104
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.288 ms                  | 25.255 ms                 |
| Forward                   | 5.267 ms                  | 11.185 ms                 |
| Backward                  | 9.701 ms                  | 15.606 ms                 |
| Optimize                  | 2.350 ms                  | 8.860 ms                  |
| BarrierTimeBeforeRank0    | 1.264 ms                  | 17.339 ms                 |
| AfterBackward             | 17.561 ms                 | 533.315 ms                |
| BlockToStepN              | 120.555 ms                | 203.504 ms                |
| OneStep                   | 162.985 ms                | 578.460 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:37.643008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=108, pq.top=108
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.456 ms                  | 7.588 ms                  |
| ProcessBack:UpdateCache   | 3.660 ms                  | 8.729 ms                  |
| ProcessBack:UpsertPq      | 9.796 ms                  | 21.817 ms                 |
| ProcessOneStep            | 17.566 ms                 | 533.185 ms                |
| BlockToStepN              | 125.009 ms                | 221.934 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:38.643007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=112, pq.top=112
W20240205 21:44:39.643019 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240205 21:44:40.661516 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=122, pq.top=122
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.318 ms                  | 25.255 ms                 |
| Forward                   | 5.342 ms                  | 11.185 ms                 |
| Backward                  | 9.692 ms                  | 15.606 ms                 |
| Optimize                  | 2.335 ms                  | 8.860 ms                  |
| BarrierTimeBeforeRank0    | 586.638 us                | 17.339 ms                 |
| AfterBackward             | 17.593 ms                 | 533.315 ms                |
| BlockToStepN              | 130.431 ms                | 222.088 ms                |
| OneStep                   | 177.340 ms                | 578.460 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:41.661008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=126, pq.top=126
W20240205 21:44:42.661018 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=130, pq.top=130
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.504 ms                  | 6.502 ms                  |
| ProcessBack:UpdateCache   | 3.680 ms                  | 8.075 ms                  |
| ProcessBack:UpsertPq      | 9.763 ms                  | 19.754 ms                 |
| ProcessOneStep            | 17.674 ms                 | 533.185 ms                |
| BlockToStepN              | 135.604 ms                | 235.229 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:43.670562 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240205 21:44:44.670006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240205 21:44:45.670013 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.329 ms                  | 30.556 ms                 |
| Forward                   | 5.323 ms                  | 11.185 ms                 |
| Backward                  | 9.689 ms                  | 15.606 ms                 |
| Optimize                  | 2.335 ms                  | 8.860 ms                  |
| BarrierTimeBeforeRank0    | 471.149 us                | 22.387 ms                 |
| AfterBackward             | 17.750 ms                 | 533.315 ms                |
| BlockToStepN              | 141.708 ms                | 235.298 ms                |
| OneStep                   | 184.568 ms                | 578.460 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:46.670008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240205 21:44:47.670006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.510 ms                  | 6.502 ms                  |
| ProcessBack:UpdateCache   | 3.662 ms                  | 8.075 ms                  |
| ProcessBack:UpsertPq      | 9.714 ms                  | 19.754 ms                 |
| ProcessOneStep            | 17.678 ms                 | 78.340 ms                 |
| BlockToStepN              | 143.281 ms                | 221.934 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:48.670011 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
W20240205 21:44:49.670010 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240205 21:44:50.670007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.355 ms                  | 27.009 ms                 |
| Forward                   | 5.323 ms                  | 10.854 ms                 |
| Backward                  | 9.692 ms                  | 12.645 ms                 |
| Optimize                  | 2.357 ms                  | 5.652 ms                  |
| BarrierTimeBeforeRank0    | 355.166 us                | 22.832 ms                 |
| AfterBackward             | 17.699 ms                 | 78.372 ms                 |
| BlockToStepN              | 149.829 ms                | 231.037 ms                |
| OneStep                   | 195.906 ms                | 438.772 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:51.670010 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=168, pq.top=168
W20240205 21:44:52.670020 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=172, pq.top=172
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.524 ms                  | 6.502 ms                  |
| ProcessBack:UpdateCache   | 3.673 ms                  | 8.075 ms                  |
| ProcessBack:UpsertPq      | 9.702 ms                  | 19.754 ms                 |
| ProcessOneStep            | 17.674 ms                 | 78.340 ms                 |
| BlockToStepN              | 152.845 ms                | 235.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:53.670008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
W20240205 21:44:54.670006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240205 21:44:55.670014 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.355 ms                  | 27.118 ms                 |
| Forward                   | 5.358 ms                  | 10.854 ms                 |
| Backward                  | 9.689 ms                  | 12.645 ms                 |
| Optimize                  | 2.357 ms                  | 5.652 ms                  |
| BarrierTimeBeforeRank0    | 417.123 us                | 25.221 ms                 |
| AfterBackward             | 17.645 ms                 | 78.372 ms                 |
| BlockToStepN              | 159.324 ms                | 235.298 ms                |
| OneStep                   | 203.596 ms                | 438.772 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:56.670008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240205 21:44:57.670006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.524 ms                  | 6.056 ms                  |
| ProcessBack:UpdateCache   | 3.662 ms                  | 8.027 ms                  |
| ProcessBack:UpsertPq      | 9.658 ms                  | 19.617 ms                 |
| ProcessOneStep            | 17.621 ms                 | 78.340 ms                 |
| BlockToStepN              | 160.006 ms                | 249.665 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:44:58.670014 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240205 21:44:59.670015 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 1] 200 steps, total: 24.059, sample: 0.406, forward: 0.458, backward: 1.013, update: 0.246
[proc 0] 200 steps, total: 24.059, sample: 0.483, forward: 0.526, backward: 0.965, update: 0.245
[proc 3] 200 steps, total: 24.059, sample: 0.415, forward: 0.479, backward: 0.454, update: 0.232
[proc 2] 200 steps, total: 24.059, sample: 0.375, forward: 0.457, backward: 0.981, update: 0.211
[proc 4] 200 steps, total: 24.059, sample: 0.443, forward: 0.464, backward: 0.968, update: 0.252
W20240205 21:45:00.670007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.365 ms                  | 27.118 ms                 |
| Forward                   | 5.342 ms                  | 10.854 ms                 |
| Backward                  | 9.689 ms                  | 12.645 ms                 |
| Optimize                  | 2.366 ms                  | 5.652 ms                  |
| BarrierTimeBeforeRank0    | 423.619 us                | 25.221 ms                 |
| AfterBackward             | 17.659 ms                 | 78.372 ms                 |
| BlockToStepN              | 165.076 ms                | 249.707 ms                |
| OneStep                   | 211.850 ms                | 438.772 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:01.670004 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240205 21:45:02.670018 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.515 ms                  | 6.056 ms                  |
| ProcessBack:UpdateCache   | 3.642 ms                  | 8.027 ms                  |
| ProcessBack:UpsertPq      | 9.648 ms                  | 19.617 ms                 |
| ProcessOneStep            | 17.621 ms                 | 78.340 ms                 |
| BlockToStepN              | 167.427 ms                | 249.665 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:03.670007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240205 21:45:04.670007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240205 21:45:05.670017 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.376 ms                  | 27.118 ms                 |
| Forward                   | 5.324 ms                  | 10.854 ms                 |
| Backward                  | 9.683 ms                  | 12.645 ms                 |
| Optimize                  | 2.358 ms                  | 5.652 ms                  |
| BarrierTimeBeforeRank0    | 417.123 us                | 25.849 ms                 |
| AfterBackward             | 17.645 ms                 | 78.372 ms                 |
| BlockToStepN              | 175.608 ms                | 253.542 ms                |
| OneStep                   | 218.070 ms                | 438.772 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:06.690109 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240205 21:45:07.690006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.513 ms                  | 5.993 ms                  |
| ProcessBack:UpdateCache   | 3.634 ms                  | 5.477 ms                  |
| ProcessBack:UpsertPq      | 9.641 ms                  | 19.170 ms                 |
| ProcessOneStep            | 17.616 ms                 | 78.340 ms                 |
| BlockToStepN              | 176.912 ms                | 253.484 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:08.708927 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240205 21:45:09.765666 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240205 21:45:10.765008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.381 ms                  | 27.336 ms                 |
| Forward                   | 5.290 ms                  | 10.854 ms                 |
| Backward                  | 9.683 ms                  | 12.645 ms                 |
| Optimize                  | 2.357 ms                  | 5.652 ms                  |
| BarrierTimeBeforeRank0    | 355.166 us                | 25.849 ms                 |
| AfterBackward             | 17.645 ms                 | 78.372 ms                 |
| BlockToStepN              | 180.121 ms                | 280.009 ms                |
| OneStep                   | 221.238 ms                | 438.772 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:11.765012 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=246, pq.top=246
W20240205 21:45:12.765014 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=250, pq.top=250
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.504 ms                  | 5.993 ms                  |
| ProcessBack:UpdateCache   | 3.619 ms                  | 5.477 ms                  |
| ProcessBack:UpsertPq      | 9.635 ms                  | 19.170 ms                 |
| ProcessOneStep            | 17.596 ms                 | 28.787 ms                 |
| BlockToStepN              | 180.763 ms                | 253.484 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:13.765007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=254, pq.top=254
W20240205 21:45:14.784005 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240205 21:45:15.783018 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.387 ms                  | 29.874 ms                 |
| Forward                   | 5.270 ms                  | 9.511 ms                  |
| Backward                  | 9.676 ms                  | 10.856 ms                 |
| Optimize                  | 2.344 ms                  | 5.199 ms                  |
| BarrierTimeBeforeRank0    | 417.123 us                | 25.221 ms                 |
| AfterBackward             | 17.625 ms                 | 28.864 ms                 |
| BlockToStepN              | 183.071 ms                | 253.542 ms                |
| OneStep                   | 225.888 ms                | 331.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:16.783006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240205 21:45:17.783006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.504 ms                  | 5.993 ms                  |
| ProcessBack:UpdateCache   | 3.609 ms                  | 5.477 ms                  |
| ProcessBack:UpsertPq      | 9.635 ms                  | 19.170 ms                 |
| ProcessOneStep            | 17.616 ms                 | 28.787 ms                 |
| BlockToStepN              | 183.626 ms                | 253.484 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:18.783015 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240205 21:45:19.783013 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=276, pq.top=276
W20240205 21:45:20.783005 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=280, pq.top=280
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.390 ms                  | 29.874 ms                 |
| Forward                   | 5.270 ms                  | 9.511 ms                  |
| Backward                  | 9.683 ms                  | 10.856 ms                 |
| Optimize                  | 2.330 ms                  | 5.199 ms                  |
| BarrierTimeBeforeRank0    | 417.123 us                | 25.221 ms                 |
| AfterBackward             | 17.649 ms                 | 28.864 ms                 |
| BlockToStepN              | 185.028 ms                | 264.610 ms                |
| OneStep                   | 228.889 ms                | 331.166 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:21.792176 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240205 21:45:22.792019 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.513 ms                  | 5.494 ms                  |
| ProcessBack:UpdateCache   | 3.607 ms                  | 5.384 ms                  |
| ProcessBack:UpsertPq      | 9.635 ms                  | 16.220 ms                 |
| ProcessOneStep            | 17.635 ms                 | 28.787 ms                 |
| BlockToStepN              | 187.290 ms                | 279.928 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:23.792006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240205 21:45:24.795811 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240205 21:45:25.795014 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 4] 300 steps, total: 26.399, sample: 0.371, forward: 0.453, backward: 0.985, update: 0.244
[proc 1] 300 steps, total: 26.399, sample: 0.363, forward: 0.455, backward: 1.012, update: 0.243
[proc 0] 300 steps, total: 26.399, sample: 0.498, forward: 0.513, backward: 0.965, update: 0.241
[proc 3] 300 steps, total: 26.399, sample: 0.419, forward: 0.468, backward: 0.448, update: 0.218
[proc 2] 300 steps, total: 26.399, sample: 0.421, forward: 0.494, backward: 0.635, update: 0.238
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.398 ms                  | 30.556 ms                 |
| Forward                   | 5.270 ms                  | 9.511 ms                  |
| Backward                  | 9.683 ms                  | 11.930 ms                 |
| Optimize                  | 2.344 ms                  | 5.382 ms                  |
| BarrierTimeBeforeRank0    | 417.123 us                | 25.221 ms                 |
| AfterBackward             | 17.706 ms                 | 28.864 ms                 |
| BlockToStepN              | 189.512 ms                | 280.009 ms                |
| OneStep                   | 231.360 ms                | 356.850 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:26.795006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
W20240205 21:45:27.795008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.517 ms                  | 5.494 ms                  |
| ProcessBack:UpdateCache   | 3.609 ms                  | 5.384 ms                  |
| ProcessBack:UpsertPq      | 9.671 ms                  | 17.117 ms                 |
| ProcessOneStep            | 17.724 ms                 | 28.787 ms                 |
| BlockToStepN              | 190.484 ms                | 294.765 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:28.795013 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240205 21:45:29.795009 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240205 21:45:30.839939 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=316, pq.top=316
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.411 ms                  | 30.556 ms                 |
| Forward                   | 5.275 ms                  | 9.511 ms                  |
| Backward                  | 9.683 ms                  | 11.930 ms                 |
| Optimize                  | 2.350 ms                  | 5.382 ms                  |
| BarrierTimeBeforeRank0    | 355.166 us                | 25.221 ms                 |
| AfterBackward             | 17.750 ms                 | 28.864 ms                 |
| BlockToStepN              | 191.866 ms                | 294.900 ms                |
| OneStep                   | 237.523 ms                | 356.850 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:31.865820 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240205 21:45:32.865017 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.518 ms                  | 5.494 ms                  |
| ProcessBack:UpdateCache   | 3.609 ms                  | 5.384 ms                  |
| ProcessBack:UpsertPq      | 9.685 ms                  | 17.117 ms                 |
| ProcessOneStep            | 17.719 ms                 | 28.787 ms                 |
| BlockToStepN              | 192.602 ms                | 294.839 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:33.876999 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240205 21:45:34.876006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240205 21:45:35.876016 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=334, pq.top=334
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.411 ms                  | 30.556 ms                 |
| Forward                   | 5.295 ms                  | 9.511 ms                  |
| Backward                  | 9.683 ms                  | 12.645 ms                 |
| Optimize                  | 2.350 ms                  | 5.382 ms                  |
| BarrierTimeBeforeRank0    | 348.191 us                | 25.221 ms                 |
| AfterBackward             | 17.770 ms                 | 28.864 ms                 |
| BlockToStepN              | 194.675 ms                | 294.900 ms                |
| OneStep                   | 239.302 ms                | 356.850 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:36.906327 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=338, pq.top=338
W20240205 21:45:37.906006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=341, pq.top=341
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.525 ms                  | 5.229 ms                  |
| ProcessBack:UpdateCache   | 3.601 ms                  | 5.298 ms                  |
| ProcessBack:UpsertPq      | 9.692 ms                  | 16.630 ms                 |
| ProcessOneStep            | 17.782 ms                 | 28.787 ms                 |
| BlockToStepN              | 195.748 ms                | 294.839 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:38.906014 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=344, pq.top=344
W20240205 21:45:39.906013 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=348, pq.top=348
W20240205 21:45:40.948226 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=352, pq.top=352
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.416 ms                  | 29.874 ms                 |
| Forward                   | 5.299 ms                  | 8.556 ms                  |
| Backward                  | 9.684 ms                  | 11.930 ms                 |
| Optimize                  | 2.362 ms                  | 5.199 ms                  |
| BarrierTimeBeforeRank0    | 415.871 us                | 25.221 ms                 |
| AfterBackward             | 17.813 ms                 | 28.643 ms                 |
| BlockToStepN              | 196.450 ms                | 294.822 ms                |
| OneStep                   | 241.561 ms                | 349.864 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:41.948014 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240205 21:45:42.979792 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=359, pq.top=359
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.528 ms                  | 5.229 ms                  |
| ProcessBack:UpdateCache   | 3.580 ms                  | 5.298 ms                  |
| ProcessBack:UpsertPq      | 9.705 ms                  | 16.630 ms                 |
| ProcessOneStep            | 17.784 ms                 | 28.597 ms                 |
| BlockToStepN              | 197.133 ms                | 294.839 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:43.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=362, pq.top=362
W20240205 21:45:44.979008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240205 21:45:45.979015 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.423 ms                  | 29.874 ms                 |
| Forward                   | 5.303 ms                  | 8.556 ms                  |
| Backward                  | 9.684 ms                  | 11.930 ms                 |
| Optimize                  | 2.366 ms                  | 5.199 ms                  |
| BarrierTimeBeforeRank0    | 431.137 us                | 25.849 ms                 |
| AfterBackward             | 17.813 ms                 | 28.643 ms                 |
| BlockToStepN              | 198.843 ms                | 300.649 ms                |
| OneStep                   | 243.957 ms                | 349.864 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:46.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240205 21:45:47.979008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.529 ms                  | 4.872 ms                  |
| ProcessBack:UpdateCache   | 3.584 ms                  | 5.231 ms                  |
| ProcessBack:UpsertPq      | 9.720 ms                  | 16.630 ms                 |
| ProcessOneStep            | 17.788 ms                 | 28.597 ms                 |
| BlockToStepN              | 199.593 ms                | 301.889 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:48.979012 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240205 21:45:49.979012 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240205 21:45:50.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.434 ms                  | 29.874 ms                 |
| Forward                   | 5.311 ms                  | 8.556 ms                  |
| Backward                  | 9.692 ms                  | 11.930 ms                 |
| Optimize                  | 2.368 ms                  | 5.199 ms                  |
| BarrierTimeBeforeRank0    | 464.539 us                | 26.038 ms                 |
| AfterBackward             | 17.867 ms                 | 28.643 ms                 |
| BlockToStepN              | 200.865 ms                | 303.801 ms                |
| OneStep                   | 246.787 ms                | 364.195 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:51.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=388, pq.top=388
W20240205 21:45:52.979022 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=391, pq.top=391
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.533 ms                  | 5.229 ms                  |
| ProcessBack:UpdateCache   | 3.601 ms                  | 5.231 ms                  |
| ProcessBack:UpsertPq      | 9.752 ms                  | 18.891 ms                 |
| ProcessOneStep            | 17.844 ms                 | 28.597 ms                 |
| BlockToStepN              | 200.897 ms                | 305.471 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:53.979009 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=394, pq.top=394
W20240205 21:45:54.979008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=397, pq.top=397
[proc 3] 400 steps, total: 29.589, sample: 0.382, forward: 0.456, backward: 0.902, update: 0.232
[proc 4] 400 steps, total: 29.589, sample: 0.394, forward: 0.451, backward: 0.957, update: 0.254
[proc 2] 400 steps, total: 29.589, sample: 0.436, forward: 0.520, backward: 1.010, update: 0.269
[proc 1] 400 steps, total: 29.589, sample: 0.368, forward: 0.465, backward: 1.023, update: 0.257
[proc 0] 400 steps, total: 29.589, sample: 0.507, forward: 0.535, backward: 0.973, update: 0.252
W20240205 21:45:55.979013 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=401, pq.top=401
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.443 ms                  | 30.604 ms                 |
| Forward                   | 5.312 ms                  | 8.652 ms                  |
| Backward                  | 9.693 ms                  | 11.930 ms                 |
| Optimize                  | 2.368 ms                  | 5.199 ms                  |
| BarrierTimeBeforeRank0    | 439.347 us                | 26.038 ms                 |
| AfterBackward             | 17.931 ms                 | 28.643 ms                 |
| BlockToStepN              | 202.090 ms                | 325.481 ms                |
| OneStep                   | 247.747 ms                | 390.086 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:56.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=404, pq.top=404
W20240205 21:45:57.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=407, pq.top=407
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.534 ms                  | 5.229 ms                  |
| ProcessBack:UpdateCache   | 3.601 ms                  | 5.231 ms                  |
| ProcessBack:UpsertPq      | 9.758 ms                  | 18.891 ms                 |
| ProcessOneStep            | 17.897 ms                 | 28.597 ms                 |
| BlockToStepN              | 202.723 ms                | 325.389 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:45:58.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=410, pq.top=410
W20240205 21:45:59.979020 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240205 21:46:00.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.450 ms                  | 30.604 ms                 |
| Forward                   | 5.322 ms                  | 8.652 ms                  |
| Backward                  | 9.693 ms                  | 11.930 ms                 |
| Optimize                  | 2.377 ms                  | 5.199 ms                  |
| BarrierTimeBeforeRank0    | 431.137 us                | 26.038 ms                 |
| AfterBackward             | 17.961 ms                 | 28.643 ms                 |
| BlockToStepN              | 203.504 ms                | 325.481 ms                |
| OneStep                   | 250.213 ms                | 390.086 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:01.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=420, pq.top=420
W20240205 21:46:02.979015 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=424, pq.top=424
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.539 ms                  | 5.494 ms                  |
| ProcessBack:UpdateCache   | 3.599 ms                  | 5.298 ms                  |
| ProcessBack:UpsertPq      | 9.763 ms                  | 19.256 ms                 |
| ProcessOneStep            | 17.934 ms                 | 28.597 ms                 |
| BlockToStepN              | 204.003 ms                | 325.389 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:03.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240205 21:46:04.979007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=431, pq.top=431
W20240205 21:46:05.979008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=433, pq.top=433
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.450 ms                  | 30.604 ms                 |
| Forward                   | 5.321 ms                  | 8.652 ms                  |
| Backward                  | 9.695 ms                  | 11.930 ms                 |
| Optimize                  | 2.377 ms                  | 5.199 ms                  |
| BarrierTimeBeforeRank0    | 423.619 us                | 27.759 ms                 |
| AfterBackward             | 17.977 ms                 | 28.864 ms                 |
| BlockToStepN              | 206.509 ms                | 330.404 ms                |
| OneStep                   | 254.083 ms                | 390.086 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:06.985412 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240205 21:46:07.985011 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=439, pq.top=439
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.543 ms                  | 5.229 ms                  |
| ProcessBack:UpdateCache   | 3.599 ms                  | 5.231 ms                  |
| ProcessBack:UpsertPq      | 9.767 ms                  | 19.341 ms                 |
| ProcessOneStep            | 17.959 ms                 | 28.939 ms                 |
| BlockToStepN              | 207.690 ms                | 332.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:09.002630 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
W20240205 21:46:10.002007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=446, pq.top=446
W20240205 21:46:11.002019 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=449, pq.top=449
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.458 ms                  | 30.556 ms                 |
| Forward                   | 5.321 ms                  | 8.556 ms                  |
| Backward                  | 9.696 ms                  | 11.756 ms                 |
| Optimize                  | 2.381 ms                  | 4.989 ms                  |
| BarrierTimeBeforeRank0    | 430.284 us                | 26.536 ms                 |
| AfterBackward             | 18.016 ms                 | 28.966 ms                 |
| BlockToStepN              | 208.523 ms                | 350.903 ms                |
| OneStep                   | 255.169 ms                | 408.548 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:12.002008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240205 21:46:13.002008 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.545 ms                  | 5.229 ms                  |
| ProcessBack:UpdateCache   | 3.599 ms                  | 5.231 ms                  |
| ProcessBack:UpsertPq      | 9.776 ms                  | 19.617 ms                 |
| ProcessOneStep            | 18.052 ms                 | 28.939 ms                 |
| BlockToStepN              | 208.823 ms                | 334.123 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:14.002007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=458, pq.top=458
W20240205 21:46:15.002013 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240205 21:46:16.002012 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=465, pq.top=465
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.459 ms                  | 30.556 ms                 |
| Forward                   | 5.314 ms                  | 8.556 ms                  |
| Backward                  | 9.695 ms                  | 11.756 ms                 |
| Optimize                  | 2.382 ms                  | 4.989 ms                  |
| BarrierTimeBeforeRank0    | 430.284 us                | 26.536 ms                 |
| AfterBackward             | 18.096 ms                 | 29.041 ms                 |
| BlockToStepN              | 209.509 ms                | 334.179 ms                |
| OneStep                   | 257.824 ms                | 407.432 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:17.002007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=468, pq.top=468
W20240205 21:46:18.006316 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.546 ms                  | 5.229 ms                  |
| ProcessBack:UpdateCache   | 3.601 ms                  | 5.231 ms                  |
| ProcessBack:UpsertPq      | 9.793 ms                  | 19.754 ms                 |
| ProcessOneStep            | 18.070 ms                 | 28.996 ms                 |
| BlockToStepN              | 209.990 ms                | 350.797 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:19.006013 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=474, pq.top=474
W20240205 21:46:20.006011 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240205 21:46:21.006007 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=480, pq.top=480
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.471 ms                  | 30.556 ms                 |
| Forward                   | 5.312 ms                  | 8.556 ms                  |
| Backward                  | 9.701 ms                  | 11.756 ms                 |
| Optimize                  | 2.385 ms                  | 4.989 ms                  |
| BarrierTimeBeforeRank0    | 417.123 us                | 26.536 ms                 |
| AfterBackward             | 18.087 ms                 | 29.041 ms                 |
| BlockToStepN              | 211.485 ms                | 357.870 ms                |
| OneStep                   | 258.780 ms                | 412.528 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:22.017310 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=484, pq.top=484
W20240205 21:46:23.017014 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=487, pq.top=487
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.547 ms                  | 4.872 ms                  |
| ProcessBack:UpdateCache   | 3.599 ms                  | 5.224 ms                  |
| ProcessBack:UpsertPq      | 9.796 ms                  | 19.754 ms                 |
| ProcessOneStep            | 18.070 ms                 | 28.996 ms                 |
| BlockToStepN              | 211.675 ms                | 357.819 ms                |
+---------------------------+---------------------------+---------------------------+
W20240205 21:46:24.017006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=490, pq.top=490
W20240205 21:46:25.017006 22454 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=495, pq.top=495
[proc 4] 500 steps, total: 29.907, sample: 0.420, forward: 0.450, backward: 0.966, update: 0.252
[proc 2] 500 steps, total: 29.907, sample: 0.354, forward: 0.483, backward: 0.992, update: 0.240
[proc 1] 500 steps, total: 29.907, sample: 0.364, forward: 0.468, backward: 1.020, update: 0.253
[proc 0] 500 steps, total: 29.907, sample: 0.467, forward: 0.516, backward: 0.971, update: 0.252
[proc 3] 500 steps, total: 29.907, sample: 0.368, forward: 0.473, backward: 1.033, update: 0.240
Successfully xmh. training takes 127.11490201950073 seconds
before call kg_cache_controller.StopThreads()
W20240205 21:46:25.830040 22454 grad_async_v1.h:243] call StopThreads. PID = 22032
W20240205 21:46:25.830065 22454 grad_base.h:212] before processOneStepNegThread_.join();
W20240205 21:46:25.841776 22454 grad_base.h:214] after processOneStepNegThread_.join();
W20240205 21:46:25.841802 22454 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240205 21:46:25.868690 22454 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f1fc6510110>
