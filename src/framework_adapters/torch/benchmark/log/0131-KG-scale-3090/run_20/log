WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 14:28:02.470471 40832 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_73', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [40832 sampler.py:454] Start PreSampling
WARNING [40832 sampler.py:532] Before construct renumbering_dict
WARNING [40832 sampler.py:555] PreSampling done
W20240202 14:28:08.149796 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 14:28:08.150024 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 14:28:08.150076 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 14:28:08.150136 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 14:28:08.150193 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 14:28:08.150233 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 14:28:08.150279 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 14:28:08.150359 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 14:28:08.150411 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 14:28:08.150452 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 14:28:08.150493 40832 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 14:28:08.150534 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 14:28:08.150588 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 14:28:08.150744 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 14:28:08.150791 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 14:28:08.150830 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 14:28:08.150892 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 14:28:08.150938 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 14:28:08.150983 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 14:28:08.151031 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 14:28:08.151085 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 14:28:08.151132 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 14:28:08.151186 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 14:28:08.151225 40832 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 14:28:08.151259 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 14:28:08.151293 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 14:28:08.151366 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 14:28:08.151425 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 14:28:08.151465 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 14:28:08.151511 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 14:28:08.151549 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 14:28:08.151599 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 14:28:08.151638 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 14:28:08.151687 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 14:28:08.151733 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 14:28:08.151775 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 14:28:08.151821 40832 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 14:28:08.151855 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 14:28:08.151890 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 14:28:08.151958 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 14:28:08.152007 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 14:28:08.152076 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 14:28:08.152127 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 14:28:08.152176 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 14:28:08.152230 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 14:28:08.152272 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 14:28:08.152312 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 14:28:08.152360 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 14:28:08.152415 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 14:28:08.152464 40832 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 14:28:08.152498 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 14:28:08.152535 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 14:28:08.152613 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240202 14:28:08.152662 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240202 14:28:08.152724 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240202 14:28:08.152765 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240202 14:28:08.152804 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240202 14:28:08.152856 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240202 14:28:08.152900 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240202 14:28:08.152949 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240202 14:28:08.153002 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240202 14:28:08.153041 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240202 14:28:08.153088 40832 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240202 14:28:08.153122 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240202 14:28:08.153156 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240202 14:28:08.153227 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240202 14:28:08.153277 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240202 14:28:08.153318 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240202 14:28:08.153358 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240202 14:28:08.153404 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240202 14:28:08.153471 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240202 14:28:08.153520 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240202 14:28:08.153573 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240202 14:28:08.153613 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240202 14:28:08.153659 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240202 14:28:08.153707 40832 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240202 14:28:08.153741 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240202 14:28:08.153774 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240202 14:28:08.153854 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240202 14:28:08.153898 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240202 14:28:08.153949 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240202 14:28:08.153995 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240202 14:28:08.154042 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240202 14:28:08.154091 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240202 14:28:08.154145 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240202 14:28:08.154193 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240202 14:28:08.154242 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240202 14:28:08.154290 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240202 14:28:08.154336 40832 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240202 14:28:08.154371 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240202 14:28:08.154405 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240202 14:28:08.154477 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240202 14:28:08.154541 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240202 14:28:08.154590 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240202 14:28:08.154632 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240202 14:28:08.154673 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240202 14:28:08.154722 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240202 14:28:08.154764 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240202 14:28:08.154808 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240202 14:28:08.154850 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240202 14:28:08.154902 40832 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240202 14:28:08.154943 40832 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240202 14:28:08.154978 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240202 14:28:08.155012 40832 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240202 14:28:08.391007 40832 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240202 14:28:08.481310 40832 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Rank4: cached key size 186
Rank5: cached key size 186
Rank6: cached key size 186
Rank7: cached key size 186
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 1488,  1818,  2273,  ...,  9140, 10516,  6942]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 6.109 seconds
[Rank1] pid = 41265
[Rank2] pid = 41296
[Rank3] pid = 41332
[Rank4] pid = 41427
[Rank5] pid = 41460
[Rank6] pid = 41588
INFO [40832 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [41265 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [41296 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [41332 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [41460 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [41588 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [41427 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [41652 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [41460 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41588 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41427 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41652 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41296 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41332 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40832 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [41265 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240202 14:28:11.133185 41653 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240202 14:28:11.133958 41589 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1495, 400]; dev=6; size=2.281 MB
W20240202 14:28:11.134030 41524 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1495, 400]; dev=5; size=2.281 MB
W20240202 14:28:11.134032 41396 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240202 14:28:11.134022 41331 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240202 14:28:11.134038 41461 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1495, 400]; dev=4; size=2.281 MB
W20240202 14:28:11.134022 41656 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1495, 400]; dev=7; size=2.281 MB
W20240202 14:28:11.135751 41266 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240202 14:28:11.161890 41589 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100027a08000 7.629 MB
W20240202 14:28:11.161895 41524 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x1000281ab000 7.629 MB
W20240202 14:28:11.162106 41524 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10002894e000 7.629 MB
W20240202 14:28:11.162147 41589 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x1000290f1000 7.629 MB
W20240202 14:28:11.162231 41524 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x100029894000 1.49 GB
W20240202 14:28:11.162258 41589 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x100088e79000 1.49 GB
W20240202 14:28:11.162297 41524 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1000e845c000 1.49 GB
W20240202 14:28:11.162339 41589 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x100147a3f000 1.49 GB
W20240202 14:28:11.162379 41524 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 14:28:11.162406 41589 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240202 14:28:11.162510 41656 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1001a7022000 7.629 MB
W20240202 14:28:11.162719 41656 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1001a77c5000 7.629 MB
W20240202 14:28:11.162804 41656 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1001a7f68000 1.49 GB
W20240202 14:28:11.162864 41656 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10020754b000 1.49 GB
W20240202 14:28:11.162925 41656 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240202 14:28:11.168162 41524 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 14:28:11.168226 41589 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240202 14:28:11.168241 41656 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240202 14:28:11.168344 41461 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100266b36000 7.629 MB
W20240202 14:28:11.168491 41461 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1002672d9000 7.629 MB
W20240202 14:28:11.168560 41461 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x100267a7c000 1.49 GB
W20240202 14:28:11.168605 41461 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1002c705f000 1.49 GB
W20240202 14:28:11.168656 41461 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 14:28:11.174937 41653 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100326646000 7.629 MB
W20240202 14:28:11.175089 41653 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100326df3000 7.629 MB
W20240202 14:28:11.175139 41653 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100327596000 1.49 GB
W20240202 14:28:11.175165 41461 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 14:28:11.175189 41653 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10038731c000 1.49 GB
W20240202 14:28:11.175179 41331 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100386b79000 7.629 MB
W20240202 14:28:11.175251 41653 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 14:28:11.175339 41396 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1003e68ff000 7.629 MB
W20240202 14:28:11.175365 41331 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1003e70a2000 7.629 MB
W20240202 14:28:11.175443 41331 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1003e7845000 1.49 GB
W20240202 14:28:11.175495 41331 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x100446e28000 1.49 GB
W20240202 14:28:11.175519 41396 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1004a640b000 7.629 MB
W20240202 14:28:11.175561 41331 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 14:28:11.175597 41396 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1004a6bae000 1.49 GB
W20240202 14:28:11.175657 41396 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100506191000 1.49 GB
W20240202 14:28:11.175721 41396 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:28:11.183097 41653 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 14:28:11.183328 41331 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 14:28:11.183328 41396 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:28:11.192622 41266 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100565784000 7.629 MB
W20240202 14:28:11.192747 41266 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100565f27000 7.629 MB
W20240202 14:28:11.192806 41266 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1005666ca000 1.49 GB
W20240202 14:28:11.192855 41266 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1005c5cad000 1.49 GB
W20240202 14:28:11.192903 41266 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 14:28:11.195914 41266 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [41265 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [41652 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [41588 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [41296 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [41427 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [41332 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 41652
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980), (5980, 7475), (7475, 8970), (8970, 10465), (10465, 11960)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [40832 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [41460 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 14:28:13.405854 41524 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240202 14:28:13.406081 41266 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:28:13.406548 41396 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:28:13.406648 41653 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:28:13.406936 41656 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:28:13.407052 41461 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:28:13.407155 41589 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:28:13.407541 41331 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240202 14:28:13.412509 41653 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240202 14:28:13.412838 41653 grad_base.h:184] Init GradProcessingBase done
I20240202 14:28:13.419661 41653 grad_async_v1.h:203] Use main thread to update emb.
W20240202 14:28:13.419806 41653 kg_controller.h:75] after init GradAsyncProcessing
I20240202 14:28:13.419832 41653 kg_controller.h:84] Construct KGCacheController done
E20240202 14:28:15.198495 41524 recstore.cc:66] init folly done
E20240202 14:28:15.199028 41266 recstore.cc:66] init folly done
E20240202 14:28:15.199113 41461 recstore.cc:66] init folly done
E20240202 14:28:15.199194 41653 recstore.cc:66] init folly done
E20240202 14:28:15.199241 41331 recstore.cc:66] init folly done
E20240202 14:28:15.199201 41589 recstore.cc:66] init folly done
E20240202 14:28:15.199203 41396 recstore.cc:66] init folly done
E20240202 14:28:15.199226 41656 recstore.cc:66] init folly done
I20240202 14:28:15.200606 41653 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240202 14:28:16.015058 41266 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240202 14:28:16.026904 41589 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:28:16.028838 41653 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:28:16.029347 41524 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:28:16.034783 41656 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:28:16.043766 41396 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:28:16.045948 41331 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:28:16.046188 41461 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240202 14:28:18.329381 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 916.272 us                | 11.529 ms                 |
| Forward                   | 10.060 ms                 | 669.012 ms                |
| Backward                  | 11.755 ms                 | 210.796 ms                |
| Optimize                  | 2.953 ms                  | 5.390 ms                  |
| BarrierTimeBeforeRank0    | 27.443 us                 | 112.280 us                |
| AfterBackward             | 1.395 s                   | 1.395 s                   |
| BlockToStepN              | 21.907 ms                 | 21.907 ms                 |
| OneStep                   | 2.308 s                   | 2.308 s                   |
+---------------------------+---------------------------+---------------------------+
E20240202 14:28:19.099828 42091 grad_async_v1.h:533] Stalled in ProcessBackward: rank=0, step_no=14, sample_step_cpp_seen_[rank]=13
W20240202 14:28:19.646315 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.448 ms                  | 365.669 ms                |
| ProcessBack:UpdateCache   | 8.958 ms                  | 750.439 ms                |
| ProcessBack:UpsertPq      | 7.487 ms                  | 24.908 ms                 |
| ProcessOneStep            | 27.337 ms                 | 1.395 s                   |
| BlockToStepN              | 4.574 ms                  | 162.093 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:20.646013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240202 14:28:21.646015 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=28, pq.top=28
W20240202 14:28:22.661458 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=36, pq.top=36
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.369 ms                  | 26.318 ms                 |
| Forward                   | 4.435 ms                  | 669.012 ms                |
| Backward                  | 9.064 ms                  | 210.796 ms                |
| Optimize                  | 1.958 ms                  | 6.678 ms                  |
| BarrierTimeBeforeRank0    | 41.388 us                 | 13.482 ms                 |
| AfterBackward             | 27.687 ms                 | 1.395 s                   |
| BlockToStepN              | 81.883 ms                 | 162.269 ms                |
| OneStep                   | 133.274 ms                | 2.308 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:23.661023 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=42, pq.top=42
W20240202 14:28:24.661007 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=48, pq.top=48
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.448 ms                  | 325.121 ms                |
| ProcessBack:UpdateCache   | 8.842 ms                  | 749.693 ms                |
| ProcessBack:UpsertPq      | 9.102 ms                  | 24.008 ms                 |
| ProcessOneStep            | 27.932 ms                 | 561.919 ms                |
| BlockToStepN              | 87.670 ms                 | 137.155 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:25.688583 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240202 14:28:26.688006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=60, pq.top=60
W20240202 14:28:27.755802 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=66, pq.top=66
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.452 ms                  | 23.213 ms                 |
| Forward                   | 4.752 ms                  | 14.280 ms                 |
| Backward                  | 9.064 ms                  | 24.221 ms                 |
| Optimize                  | 1.981 ms                  | 6.249 ms                  |
| BarrierTimeBeforeRank0    | 112.280 us                | 13.482 ms                 |
| AfterBackward             | 28.308 ms                 | 562.035 ms                |
| BlockToStepN              | 91.682 ms                 | 161.245 ms                |
| OneStep                   | 149.580 ms                | 596.676 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:28.755017 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240202 14:28:29.755007 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=76, pq.top=76
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.387 ms                  | 36.008 ms                 |
| ProcessBack:UpdateCache   | 8.963 ms                  | 12.409 ms                 |
| ProcessBack:UpsertPq      | 9.472 ms                  | 19.791 ms                 |
| ProcessOneStep            | 28.281 ms                 | 561.919 ms                |
| BlockToStepN              | 100.576 ms                | 161.171 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:30.755018 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240202 14:28:31.755009 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=86, pq.top=86
W20240202 14:28:32.765491 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.481 ms                  | 23.213 ms                 |
| Forward                   | 4.773 ms                  | 20.819 ms                 |
| Backward                  | 9.013 ms                  | 24.221 ms                 |
| Optimize                  | 1.928 ms                  | 6.249 ms                  |
| BarrierTimeBeforeRank0    | 151.141 us                | 13.482 ms                 |
| AfterBackward             | 28.342 ms                 | 562.035 ms                |
| BlockToStepN              | 110.838 ms                | 184.130 ms                |
| OneStep                   | 167.357 ms                | 596.676 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:33.785257 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=96, pq.top=96
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 18.725, sample: 0.349, forward: 1.040, backward: 1.057, update: 0.175
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 18.744, sample: 0.344, forward: 1.098, backward: 1.087, update: 0.181
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 18.714, sample: 0.391, forward: 1.061, backward: 1.065, update: 0.172
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 18.713, sample: 0.352, forward: 1.034, backward: 0.575, update: 0.167
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 18.733, sample: 0.344, forward: 1.051, backward: 1.026, update: 0.193
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 18.730, sample: 0.344, forward: 1.068, backward: 1.042, update: 0.185
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 18.716, sample: 0.359, forward: 1.081, backward: 1.071, update: 0.205
train_sampler.Prefill()
-------Step 0-------
tensor([  140,   151,  4321,    47, 12223, 11904,  1888,  8870, 13287, 10647]) tensor([ 2273,  9769,  6072, 11309,    33,  1772,  1300,  5529,  1066, 12897])
-------Step 1-------
tensor([  140,   151,  4321,    47, 12223, 11904,  1888,  8870, 13287, 10647]) tensor([  935,   224, 12965,  2138,  1713,  7131, 13279,  9043,  5401, 11703])
-------Step 2-------
tensor([ 7008, 10009,  6301,  4448,    85,  8899, 11918,  4802,  9949,  1632]) tensor([ 3813,  6026,  4063,  7993,   360,  9031, 13420,  9829, 12484, 11242])
-------Step 3-------
tensor([ 7008, 10009,  6301,  4448,    85,  8899, 11918,  4802,  9949,  1632]) tensor([ 8125,  6439,  7198, 10182,  8141,  1397,   588,  2745, 14065,  3055])
-------Step 4-------
tensor([  151, 10817, 10836,  5846,  5548,  3891,    15,  8272,   135,  1764]) tensor([1217, 1881,  575, 4362, 3438, 3032, 8870, 6911, 6623, 2698])
-------Step 5-------
tensor([  151, 10817, 10836,  5846,  5548,  3891,    15,  8272,   135,  1764]) tensor([11452,  5140,   521,  2295,  3769,  1562,  1553,  1983,  6568,  7012])
-------Step 6-------
tensor([ 2519,  8493,    35,   102,  7542,  3600,  9496, 13273, 14142,    89]) tensor([10009,  3601,  7016,  4678,  8567,  8611,  4463,  9701, 10061, 11943])
-------Step 7-------
tensor([ 2519,  8493,    35,   102,  7542,  3600,  9496, 13273, 14142,    89]) tensor([14309,   816,  4559,  6336,  1999,  1472,  8353,  3831,  7648,  1415])
-------Step 8-------
tensor([ 3810,  7034,  5290, 14106,    61,    11,  9053, 11404,    12,  2931]) tensor([ 5783,  6053,  5852,  7161,  3228, 14722,  8816,  2220,  8672,  4233])
-------Step 9-------
tensor([ 3810,  7034,  5290, 14106,    61,    11,  9053, 11404,    12,  2931]) tensor([12364,  4439, 13245,  7469, 14936,   799, 14689,  9043,  1421, 14340])
before start barrier
start train
[proc 0] 100 steps, total: 18.731, sample: 0.427, forward: 1.195, backward: 1.096, update: 0.217
W20240202 14:28:34.804993 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.326 ms                  | 36.008 ms                 |
| ProcessBack:UpdateCache   | 8.977 ms                  | 12.409 ms                 |
| ProcessBack:UpsertPq      | 9.600 ms                  | 19.791 ms                 |
| ProcessOneStep            | 28.290 ms                 | 561.919 ms                |
| BlockToStepN              | 116.547 ms                | 185.204 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:35.804014 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
W20240202 14:28:36.845531 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240202 14:28:37.845016 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.620 ms                  | 23.213 ms                 |
| Forward                   | 4.772 ms                  | 20.819 ms                 |
| Backward                  | 9.025 ms                  | 24.221 ms                 |
| Optimize                  | 1.906 ms                  | 6.249 ms                  |
| BarrierTimeBeforeRank0    | 368.856 us                | 15.479 ms                 |
| AfterBackward             | 28.424 ms                 | 562.035 ms                |
| BlockToStepN              | 124.471 ms                | 187.478 ms                |
| OneStep                   | 182.476 ms                | 596.676 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:38.845005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240202 14:28:39.845013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.326 ms                  | 36.008 ms                 |
| ProcessBack:UpdateCache   | 8.977 ms                  | 12.409 ms                 |
| ProcessBack:UpsertPq      | 9.616 ms                  | 19.791 ms                 |
| ProcessOneStep            | 28.480 ms                 | 561.919 ms                |
| BlockToStepN              | 127.374 ms                | 205.479 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:40.845006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240202 14:28:41.845006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240202 14:28:42.845005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.620 ms                  | 25.177 ms                 |
| Forward                   | 4.679 ms                  | 20.819 ms                 |
| Backward                  | 8.999 ms                  | 24.221 ms                 |
| Optimize                  | 1.906 ms                  | 6.249 ms                  |
| BarrierTimeBeforeRank0    | 151.141 us                | 15.479 ms                 |
| AfterBackward             | 28.619 ms                 | 562.035 ms                |
| BlockToStepN              | 136.264 ms                | 222.483 ms                |
| OneStep                   | 188.057 ms                | 596.676 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:43.845019 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240202 14:28:44.845006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.271 ms                  | 26.937 ms                 |
| ProcessBack:UpdateCache   | 9.065 ms                  | 12.409 ms                 |
| ProcessBack:UpsertPq      | 9.752 ms                  | 18.553 ms                 |
| ProcessOneStep            | 28.603 ms                 | 561.919 ms                |
| BlockToStepN              | 137.328 ms                | 225.264 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:45.855325 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240202 14:28:46.855005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240202 14:28:47.855013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.711 ms                  | 23.213 ms                 |
| Forward                   | 4.712 ms                  | 14.280 ms                 |
| Backward                  | 8.930 ms                  | 20.851 ms                 |
| Optimize                  | 1.893 ms                  | 5.823 ms                  |
| BarrierTimeBeforeRank0    | 1.080 ms                  | 18.424 ms                 |
| AfterBackward             | 28.723 ms                 | 59.036 ms                 |
| BlockToStepN              | 141.458 ms                | 225.307 ms                |
| OneStep                   | 197.404 ms                | 289.822 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:48.913848 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240202 14:28:49.913009 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.154 ms                  | 26.937 ms                 |
| ProcessBack:UpdateCache   | 9.244 ms                  | 12.409 ms                 |
| ProcessBack:UpsertPq      | 9.878 ms                  | 18.553 ms                 |
| ProcessOneStep            | 28.744 ms                 | 58.723 ms                 |
| BlockToStepN              | 142.808 ms                | 235.123 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:50.913013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240202 14:28:51.913005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=170, pq.top=170
W20240202 14:28:52.929091 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=174, pq.top=174
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.701 ms                  | 23.213 ms                 |
| Forward                   | 4.714 ms                  | 14.280 ms                 |
| Backward                  | 8.888 ms                  | 20.851 ms                 |
| Optimize                  | 1.875 ms                  | 5.823 ms                  |
| BarrierTimeBeforeRank0    | 1.767 ms                  | 23.938 ms                 |
| AfterBackward             | 28.786 ms                 | 59.036 ms                 |
| BlockToStepN              | 148.647 ms                | 243.184 ms                |
| OneStep                   | 204.783 ms                | 322.090 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:53.929013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240202 14:28:54.929011 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.077 ms                  | 20.538 ms                 |
| ProcessBack:UpdateCache   | 9.596 ms                  | 12.576 ms                 |
| ProcessBack:UpsertPq      | 9.881 ms                  | 18.213 ms                 |
| ProcessOneStep            | 28.744 ms                 | 58.723 ms                 |
| BlockToStepN              | 150.641 ms                | 242.911 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:55.969769 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
W20240202 14:28:56.969003 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=188, pq.top=188
W20240202 14:28:57.969015 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=192, pq.top=192
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.620 ms                  | 23.213 ms                 |
| Forward                   | 4.715 ms                  | 14.280 ms                 |
| Backward                  | 8.856 ms                  | 20.851 ms                 |
| Optimize                  | 1.882 ms                  | 5.923 ms                  |
| BarrierTimeBeforeRank0    | 2.352 ms                  | 24.067 ms                 |
| AfterBackward             | 28.831 ms                 | 59.036 ms                 |
| BlockToStepN              | 159.168 ms                | 256.768 ms                |
| OneStep                   | 216.994 ms                | 322.090 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:28:58.969005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
W20240202 14:28:59.969069 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.025 ms                  | 20.538 ms                 |
| ProcessBack:UpdateCache   | 9.828 ms                  | 12.576 ms                 |
| ProcessBack:UpsertPq      | 9.911 ms                  | 18.213 ms                 |
| ProcessOneStep            | 28.804 ms                 | 58.723 ms                 |
| BlockToStepN              | 162.093 ms                | 271.708 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 7] 200 steps, total: 25.494, sample: 0.380, forward: 0.435, backward: 0.492, update: 0.169
[proc 4] 200 steps, total: 25.494, sample: 0.372, forward: 0.417, backward: 0.841, update: 0.172
[proc 3] 200 steps, total: 25.494, sample: 0.412, forward: 0.464, backward: 0.901, update: 0.194
[proc 6] 200 steps, total: 25.494, sample: 0.414, forward: 0.460, backward: 0.618, update: 0.186
[proc 5] 200 steps, total: 25.494, sample: 0.372, forward: 0.458, backward: 0.731, update: 0.179
[proc 1] 200 steps, total: 25.494, sample: 0.352, forward: 0.461, backward: 0.918, update: 0.176
[proc 2] 200 steps, total: 25.494, sample: 0.354, forward: 0.419, backward: 0.784, update: 0.163
[proc 0] 200 steps, total: 25.494, sample: 0.479, forward: 0.481, backward: 0.608, update: 0.192
W20240202 14:29:00.969005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240202 14:29:01.969007 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240202 14:29:02.998169 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.614 ms                  | 25.177 ms                 |
| Forward                   | 4.712 ms                  | 14.280 ms                 |
| Backward                  | 8.834 ms                  | 20.851 ms                 |
| Optimize                  | 1.845 ms                  | 5.923 ms                  |
| BarrierTimeBeforeRank0    | 2.568 ms                  | 24.067 ms                 |
| AfterBackward             | 28.831 ms                 | 59.036 ms                 |
| BlockToStepN              | 168.906 ms                | 271.762 ms                |
| OneStep                   | 225.663 ms                | 322.090 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:04.046447 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240202 14:29:05.046005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.980 ms                  | 20.538 ms                 |
| ProcessBack:UpdateCache   | 9.984 ms                  | 16.872 ms                 |
| ProcessBack:UpsertPq      | 9.966 ms                  | 18.213 ms                 |
| ProcessOneStep            | 28.848 ms                 | 58.723 ms                 |
| BlockToStepN              | 169.668 ms                | 271.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:06.052798 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240202 14:29:07.052006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240202 14:29:08.052006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.547 ms                  | 25.177 ms                 |
| Forward                   | 4.710 ms                  | 14.280 ms                 |
| Backward                  | 8.835 ms                  | 20.851 ms                 |
| Optimize                  | 1.845 ms                  | 5.923 ms                  |
| BarrierTimeBeforeRank0    | 3.099 ms                  | 24.067 ms                 |
| AfterBackward             | 28.876 ms                 | 59.036 ms                 |
| BlockToStepN              | 173.446 ms                | 274.939 ms                |
| OneStep                   | 230.815 ms                | 340.581 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:09.052016 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=232, pq.top=232
W20240202 14:29:10.052006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.005 ms                  | 20.231 ms                 |
| ProcessBack:UpdateCache   | 10.043 ms                 | 14.746 ms                 |
| ProcessBack:UpsertPq      | 9.945 ms                  | 17.943 ms                 |
| ProcessOneStep            | 28.849 ms                 | 58.723 ms                 |
| BlockToStepN              | 177.566 ms                | 274.878 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:11.078126 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
W20240202 14:29:12.078006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240202 14:29:13.078006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=246, pq.top=246
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.523 ms                  | 25.177 ms                 |
| Forward                   | 4.715 ms                  | 14.280 ms                 |
| Backward                  | 8.850 ms                  | 20.851 ms                 |
| Optimize                  | 1.845 ms                  | 5.923 ms                  |
| BarrierTimeBeforeRank0    | 3.229 ms                  | 24.067 ms                 |
| AfterBackward             | 28.893 ms                 | 59.036 ms                 |
| BlockToStepN              | 183.281 ms                | 274.939 ms                |
| OneStep                   | 235.616 ms                | 340.581 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:14.078014 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240202 14:29:15.078013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.014 ms                  | 20.231 ms                 |
| ProcessBack:UpdateCache   | 10.020 ms                 | 14.746 ms                 |
| ProcessBack:UpsertPq      | 9.959 ms                  | 17.943 ms                 |
| ProcessOneStep            | 28.864 ms                 | 48.218 ms                 |
| BlockToStepN              | 184.817 ms                | 274.878 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:16.079470 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=256, pq.top=256
W20240202 14:29:17.079006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240202 14:29:18.079005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=262, pq.top=262
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.513 ms                  | 23.213 ms                 |
| Forward                   | 4.714 ms                  | 12.925 ms                 |
| Backward                  | 8.865 ms                  | 18.527 ms                 |
| Optimize                  | 1.855 ms                  | 5.823 ms                  |
| BarrierTimeBeforeRank0    | 3.368 ms                  | 23.938 ms                 |
| AfterBackward             | 28.927 ms                 | 48.344 ms                 |
| BlockToStepN              | 185.910 ms                | 278.245 ms                |
| OneStep                   | 241.966 ms                | 350.568 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:19.079015 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240202 14:29:20.079011 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=268, pq.top=268
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.022 ms                  | 20.231 ms                 |
| ProcessBack:UpdateCache   | 10.020 ms                 | 14.746 ms                 |
| ProcessBack:UpsertPq      | 9.959 ms                  | 18.049 ms                 |
| ProcessOneStep            | 28.900 ms                 | 48.218 ms                 |
| BlockToStepN              | 187.081 ms                | 283.394 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:21.079006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240202 14:29:22.079005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240202 14:29:23.121217 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.522 ms                  | 24.331 ms                 |
| Forward                   | 4.704 ms                  | 12.925 ms                 |
| Backward                  | 8.867 ms                  | 18.527 ms                 |
| Optimize                  | 1.855 ms                  | 5.823 ms                  |
| BarrierTimeBeforeRank0    | 3.368 ms                  | 24.067 ms                 |
| AfterBackward             | 28.933 ms                 | 48.344 ms                 |
| BlockToStepN              | 188.893 ms                | 288.776 ms                |
| OneStep                   | 248.299 ms                | 353.576 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:24.121004 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=282, pq.top=282
W20240202 14:29:25.121016 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.022 ms                  | 16.273 ms                 |
| ProcessBack:UpdateCache   | 10.020 ms                 | 14.668 ms                 |
| ProcessBack:UpsertPq      | 9.959 ms                  | 18.049 ms                 |
| ProcessOneStep            | 28.923 ms                 | 48.218 ms                 |
| BlockToStepN              | 189.275 ms                | 289.377 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:26.121007 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
W20240202 14:29:27.179895 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=292, pq.top=292
W20240202 14:29:28.179005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.523 ms                  | 24.331 ms                 |
| Forward                   | 4.698 ms                  | 12.925 ms                 |
| Backward                  | 8.871 ms                  | 18.527 ms                 |
| Optimize                  | 1.844 ms                  | 5.823 ms                  |
| BarrierTimeBeforeRank0    | 3.368 ms                  | 24.067 ms                 |
| AfterBackward             | 28.933 ms                 | 48.344 ms                 |
| BlockToStepN              | 191.366 ms                | 290.321 ms                |
| OneStep                   | 250.360 ms                | 371.029 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:29.221725 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 7] 300 steps, total: 29.514, sample: 0.335, forward: 0.427, backward: 0.575, update: 0.162
[proc 6] 300 steps, total: 29.514, sample: 0.316, forward: 0.430, backward: 0.754, update: 0.178
[proc 5] 300 steps, total: 29.514, sample: 0.319, forward: 0.425, backward: 0.904, update: 0.176
[proc 1] 300 steps, total: 29.514, sample: 0.328, forward: 0.443, backward: 0.641, update: 0.173
[proc 4] 300 steps, total: 29.514, sample: 0.303, forward: 0.414, backward: 0.830, update: 0.170
[proc 3] 300 steps, total: 29.514, sample: 0.328, forward: 0.410, backward: 0.726, update: 0.186
[proc 2] 300 steps, total: 29.514, sample: 0.339, forward: 0.416, backward: 0.651, update: 0.159
[proc 0] 300 steps, total: 29.514, sample: 0.416, forward: 0.478, backward: 0.834, update: 0.191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.025 ms                  | 16.273 ms                 |
| ProcessBack:UpdateCache   | 9.992 ms                  | 14.668 ms                 |
| ProcessBack:UpsertPq      | 9.937 ms                  | 18.213 ms                 |
| ProcessOneStep            | 28.906 ms                 | 48.218 ms                 |
| BlockToStepN              | 191.655 ms                | 290.209 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:30.221012 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
W20240202 14:29:31.221011 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240202 14:29:32.221005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240202 14:29:33.221005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.523 ms                  | 24.331 ms                 |
| Forward                   | 4.688 ms                  | 14.280 ms                 |
| Backward                  | 8.878 ms                  | 18.527 ms                 |
| Optimize                  | 1.842 ms                  | 5.823 ms                  |
| BarrierTimeBeforeRank0    | 3.548 ms                  | 24.067 ms                 |
| AfterBackward             | 29.007 ms                 | 48.344 ms                 |
| BlockToStepN              | 193.427 ms                | 295.719 ms                |
| OneStep                   | 252.134 ms                | 371.029 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:34.271605 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.025 ms                  | 16.273 ms                 |
| ProcessBack:UpdateCache   | 10.045 ms                 | 14.668 ms                 |
| ProcessBack:UpsertPq      | 9.942 ms                  | 18.553 ms                 |
| ProcessOneStep            | 28.970 ms                 | 48.218 ms                 |
| BlockToStepN              | 197.533 ms                | 295.662 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:35.271003 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
W20240202 14:29:36.271015 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240202 14:29:37.271011 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=324, pq.top=324
W20240202 14:29:38.324570 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=328, pq.top=328
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.524 ms                  | 24.331 ms                 |
| Forward                   | 4.695 ms                  | 14.280 ms                 |
| Backward                  | 8.882 ms                  | 18.527 ms                 |
| Optimize                  | 1.842 ms                  | 5.823 ms                  |
| BarrierTimeBeforeRank0    | 3.609 ms                  | 24.067 ms                 |
| AfterBackward             | 29.007 ms                 | 48.344 ms                 |
| BlockToStepN              | 200.281 ms                | 302.622 ms                |
| OneStep                   | 255.922 ms                | 374.799 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:39.324004 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=331, pq.top=331
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.015 ms                  | 12.714 ms                 |
| ProcessBack:UpdateCache   | 10.058 ms                 | 12.576 ms                 |
| ProcessBack:UpsertPq      | 9.959 ms                  | 19.071 ms                 |
| ProcessOneStep            | 28.984 ms                 | 50.041 ms                 |
| BlockToStepN              | 202.369 ms                | 314.497 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:40.324004 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=334, pq.top=334
W20240202 14:29:41.324005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=337, pq.top=337
W20240202 14:29:42.324013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
W20240202 14:29:43.324012 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.524 ms                  | 24.331 ms                 |
| Forward                   | 4.680 ms                  | 14.280 ms                 |
| Backward                  | 8.882 ms                  | 18.527 ms                 |
| Optimize                  | 1.841 ms                  | 5.823 ms                  |
| BarrierTimeBeforeRank0    | 3.619 ms                  | 24.067 ms                 |
| AfterBackward             | 29.007 ms                 | 50.068 ms                 |
| BlockToStepN              | 203.741 ms                | 316.090 ms                |
| OneStep                   | 262.948 ms                | 384.486 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:44.390151 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.005 ms                  | 12.714 ms                 |
| ProcessBack:UpdateCache   | 10.054 ms                 | 12.576 ms                 |
| ProcessBack:UpsertPq      | 9.945 ms                  | 19.071 ms                 |
| ProcessOneStep            | 28.981 ms                 | 50.041 ms                 |
| BlockToStepN              | 203.757 ms                | 324.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:45.390007 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=350, pq.top=350
W20240202 14:29:46.390004 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240202 14:29:47.390005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=356, pq.top=356
W20240202 14:29:48.390013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=360, pq.top=360
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.538 ms                  | 23.213 ms                 |
| Forward                   | 4.670 ms                  | 12.925 ms                 |
| Backward                  | 8.879 ms                  | 16.787 ms                 |
| Optimize                  | 1.841 ms                  | 5.390 ms                  |
| BarrierTimeBeforeRank0    | 3.739 ms                  | 23.938 ms                 |
| AfterBackward             | 28.995 ms                 | 48.344 ms                 |
| BlockToStepN              | 204.626 ms                | 316.090 ms                |
| OneStep                   | 266.757 ms                | 384.486 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:49.390005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=363, pq.top=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.981 ms                  | 12.714 ms                 |
| ProcessBack:UpdateCache   | 10.074 ms                 | 12.576 ms                 |
| ProcessBack:UpsertPq      | 9.959 ms                  | 20.136 ms                 |
| ProcessOneStep            | 28.984 ms                 | 48.218 ms                 |
| BlockToStepN              | 204.831 ms                | 324.157 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:50.390005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=366, pq.top=366
W20240202 14:29:51.390005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240202 14:29:52.390005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240202 14:29:53.390005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.547 ms                  | 23.213 ms                 |
| Forward                   | 4.660 ms                  | 14.280 ms                 |
| Backward                  | 8.865 ms                  | 16.787 ms                 |
| Optimize                  | 1.838 ms                  | 5.390 ms                  |
| BarrierTimeBeforeRank0    | 3.973 ms                  | 23.938 ms                 |
| AfterBackward             | 29.012 ms                 | 48.344 ms                 |
| BlockToStepN              | 207.353 ms                | 324.782 ms                |
| OneStep                   | 267.501 ms                | 394.910 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:54.390012 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=378, pq.top=378
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.971 ms                  | 11.980 ms                 |
| ProcessBack:UpdateCache   | 10.109 ms                 | 12.409 ms                 |
| ProcessBack:UpsertPq      | 9.966 ms                  | 19.953 ms                 |
| ProcessOneStep            | 29.002 ms                 | 48.218 ms                 |
| BlockToStepN              | 207.601 ms                | 324.678 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:55.390004 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240202 14:29:56.425796 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
W20240202 14:29:57.425005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.547 ms                  | 23.213 ms                 |
| Forward                   | 4.639 ms                  | 14.280 ms                 |
| Backward                  | 8.864 ms                  | 18.527 ms                 |
| Optimize                  | 1.841 ms                  | 5.390 ms                  |
| BarrierTimeBeforeRank0    | 4.007 ms                  | 24.067 ms                 |
| AfterBackward             | 29.075 ms                 | 48.344 ms                 |
| BlockToStepN              | 209.387 ms                | 325.634 ms                |
| OneStep                   | 270.629 ms                | 399.380 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:29:58.487655 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240202 14:29:59.487005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.971 ms                  | 11.980 ms                 |
| ProcessBack:UpdateCache   | 10.096 ms                 | 12.409 ms                 |
| ProcessBack:UpsertPq      | 9.967 ms                  | 20.435 ms                 |
| ProcessOneStep            | 29.053 ms                 | 48.218 ms                 |
| BlockToStepN              | 211.233 ms                | 325.572 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:00.487015 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=396, pq.top=396
W20240202 14:30:01.487011 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=400, pq.top=400
[proc 7] 400 steps, total: 31.897, sample: 0.333, forward: 0.442, backward: 0.876, update: 0.175
[proc 0] 400 steps, total: 31.897, sample: 0.421, forward: 0.503, backward: 0.801, update: 0.194
[proc 6] 400 steps, total: 31.897, sample: 0.345, forward: 0.422, backward: 0.866, update: 0.182
[proc 4] 400 steps, total: 31.897, sample: 0.371, forward: 0.424, backward: 0.815, update: 0.173
[proc 5] 400 steps, total: 31.897, sample: 0.364, forward: 0.440, backward: 0.827, update: 0.185
[proc 3] 400 steps, total: 31.897, sample: 0.325, forward: 0.417, backward: 0.945, update: 0.191
[proc 1] 400 steps, total: 31.897, sample: 0.341, forward: 0.437, backward: 0.605, update: 0.171
[proc 2] 400 steps, total: 31.897, sample: 0.367, forward: 0.429, backward: 0.492, update: 0.163
W20240202 14:30:02.487006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=403, pq.top=403
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.547 ms                  | 23.213 ms                 |
| Forward                   | 4.636 ms                  | 14.280 ms                 |
| Backward                  | 8.865 ms                  | 18.527 ms                 |
| Optimize                  | 1.841 ms                  | 5.390 ms                  |
| BarrierTimeBeforeRank0    | 4.007 ms                  | 24.067 ms                 |
| AfterBackward             | 29.082 ms                 | 48.344 ms                 |
| BlockToStepN              | 212.413 ms                | 325.634 ms                |
| OneStep                   | 272.688 ms                | 399.380 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:03.487002 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=406, pq.top=406
W20240202 14:30:04.487006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=409, pq.top=409
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.974 ms                  | 12.714 ms                 |
| ProcessBack:UpdateCache   | 10.107 ms                 | 12.409 ms                 |
| ProcessBack:UpsertPq      | 9.966 ms                  | 20.435 ms                 |
| ProcessOneStep            | 29.055 ms                 | 48.218 ms                 |
| BlockToStepN              | 213.386 ms                | 329.591 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:05.487005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=412, pq.top=412
W20240202 14:30:06.487015 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240202 14:30:07.487011 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.549 ms                  | 23.213 ms                 |
| Forward                   | 4.636 ms                  | 19.832 ms                 |
| Backward                  | 8.853 ms                  | 18.527 ms                 |
| Optimize                  | 1.839 ms                  | 5.390 ms                  |
| BarrierTimeBeforeRank0    | 4.007 ms                  | 24.067 ms                 |
| AfterBackward             | 29.089 ms                 | 48.344 ms                 |
| BlockToStepN              | 215.327 ms                | 345.179 ms                |
| OneStep                   | 274.424 ms                | 419.391 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:08.487004 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=420, pq.top=420
W20240202 14:30:09.487005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=423, pq.top=423
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.967 ms                  | 11.980 ms                 |
| ProcessBack:UpdateCache   | 10.114 ms                 | 11.911 ms                 |
| ProcessBack:UpsertPq      | 9.971 ms                  | 20.136 ms                 |
| ProcessOneStep            | 29.078 ms                 | 48.218 ms                 |
| BlockToStepN              | 215.671 ms                | 345.094 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:10.545953 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240202 14:30:11.545006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=429, pq.top=429
W20240202 14:30:12.545017 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=432, pq.top=432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.565 ms                  | 23.542 ms                 |
| Forward                   | 4.634 ms                  | 19.832 ms                 |
| Backward                  | 8.838 ms                  | 18.527 ms                 |
| Optimize                  | 1.832 ms                  | 5.390 ms                  |
| BarrierTimeBeforeRank0    | 4.010 ms                  | 24.067 ms                 |
| AfterBackward             | 29.105 ms                 | 48.344 ms                 |
| BlockToStepN              | 218.000 ms                | 346.419 ms                |
| OneStep                   | 276.078 ms                | 420.225 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:13.545007 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240202 14:30:14.545006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=438, pq.top=438
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.963 ms                  | 11.980 ms                 |
| ProcessBack:UpdateCache   | 10.114 ms                 | 11.911 ms                 |
| ProcessBack:UpsertPq      | 9.999 ms                  | 20.136 ms                 |
| ProcessOneStep            | 29.078 ms                 | 48.218 ms                 |
| BlockToStepN              | 219.025 ms                | 347.958 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:15.545006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240202 14:30:16.590497 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=444, pq.top=444
W20240202 14:30:17.590006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.570 ms                  | 23.542 ms                 |
| Forward                   | 4.633 ms                  | 19.832 ms                 |
| Backward                  | 8.834 ms                  | 18.527 ms                 |
| Optimize                  | 1.832 ms                  | 5.390 ms                  |
| BarrierTimeBeforeRank0    | 4.154 ms                  | 24.067 ms                 |
| AfterBackward             | 29.105 ms                 | 48.344 ms                 |
| BlockToStepN              | 220.781 ms                | 348.144 ms                |
| OneStep                   | 279.804 ms                | 422.467 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:18.590023 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=450, pq.top=450
W20240202 14:30:19.590013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=452, pq.top=452
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.961 ms                  | 11.980 ms                 |
| ProcessBack:UpdateCache   | 10.117 ms                 | 11.911 ms                 |
| ProcessBack:UpsertPq      | 10.004 ms                 | 20.435 ms                 |
| ProcessOneStep            | 29.078 ms                 | 44.739 ms                 |
| BlockToStepN              | 221.933 ms                | 346.351 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:20.590006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240202 14:30:21.590006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=458, pq.top=458
W20240202 14:30:22.590006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=461, pq.top=461
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.570 ms                  | 23.213 ms                 |
| Forward                   | 4.627 ms                  | 14.280 ms                 |
| Backward                  | 8.824 ms                  | 16.787 ms                 |
| Optimize                  | 1.831 ms                  | 3.983 ms                  |
| BarrierTimeBeforeRank0    | 4.154 ms                  | 24.038 ms                 |
| AfterBackward             | 29.105 ms                 | 44.766 ms                 |
| BlockToStepN              | 223.232 ms                | 351.868 ms                |
| OneStep                   | 281.318 ms                | 420.225 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:23.590011 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=463, pq.top=463
W20240202 14:30:24.590021 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=466, pq.top=466
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.959 ms                  | 11.980 ms                 |
| ProcessBack:UpdateCache   | 10.124 ms                 | 11.911 ms                 |
| ProcessBack:UpsertPq      | 10.006 ms                 | 21.572 ms                 |
| ProcessOneStep            | 29.058 ms                 | 44.739 ms                 |
| BlockToStepN              | 224.943 ms                | 356.131 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:25.590008 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240202 14:30:26.590005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=472, pq.top=472
W20240202 14:30:27.590006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=475, pq.top=475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.570 ms                  | 23.213 ms                 |
| Forward                   | 4.624 ms                  | 14.280 ms                 |
| Backward                  | 8.806 ms                  | 16.787 ms                 |
| Optimize                  | 1.831 ms                  | 3.983 ms                  |
| BarrierTimeBeforeRank0    | 4.097 ms                  | 24.038 ms                 |
| AfterBackward             | 29.089 ms                 | 44.766 ms                 |
| BlockToStepN              | 225.602 ms                | 357.476 ms                |
| OneStep                   | 283.297 ms                | 422.467 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:28.590005 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=478, pq.top=478
W20240202 14:30:29.590013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=481, pq.top=481
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.961 ms                  | 11.800 ms                 |
| ProcessBack:UpdateCache   | 10.127 ms                 | 11.865 ms                 |
| ProcessBack:UpsertPq      | 10.013 ms                 | 21.572 ms                 |
| ProcessOneStep            | 29.089 ms                 | 44.739 ms                 |
| BlockToStepN              | 226.195 ms                | 357.826 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:30.590013 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240202 14:30:31.590008 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=486, pq.top=486
W20240202 14:30:32.590008 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=489, pq.top=489
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.578 ms                  | 23.213 ms                 |
| Forward                   | 4.627 ms                  | 14.280 ms                 |
| Backward                  | 8.800 ms                  | 16.787 ms                 |
| Optimize                  | 1.831 ms                  | 5.390 ms                  |
| BarrierTimeBeforeRank0    | 4.176 ms                  | 24.038 ms                 |
| AfterBackward             | 29.133 ms                 | 44.766 ms                 |
| BlockToStepN              | 227.526 ms                | 358.704 ms                |
| OneStep                   | 285.930 ms                | 425.020 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:33.590006 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240202 14:30:34.634555 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=495, pq.top=495
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.960 ms                  | 11.800 ms                 |
| ProcessBack:UpdateCache   | 10.133 ms                 | 11.865 ms                 |
| ProcessBack:UpsertPq      | 10.021 ms                 | 22.407 ms                 |
| ProcessOneStep            | 29.106 ms                 | 44.739 ms                 |
| BlockToStepN              | 227.747 ms                | 358.612 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:30:35.634009 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=498, pq.top=498
W20240202 14:30:36.634017 41653 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 6] 500 steps, total: 34.980, sample: 0.297, forward: 0.418, backward: 0.897, update: 0.182
[proc 3] 500 steps, total: 34.980, sample: 0.336, forward: 0.413, backward: 0.915, update: 0.184
[proc 2] 500 steps, total: 34.980, sample: 0.331, forward: 0.407, backward: 0.802, update: 0.165
[proc 4] 500 steps, total: 34.980, sample: 0.302, forward: 0.404, backward: 0.795, update: 0.168
[proc 5] 500 steps, total: 34.980, sample: 0.324, forward: 0.467, backward: 0.848, update: 0.186
[proc 7] 500 steps, total: 34.980, sample: 0.335, forward: 0.427, backward: 0.590, update: 0.164
[proc 1] 500 steps, total: 34.980, sample: 0.329, forward: 0.430, backward: 0.859, update: 0.178
[proc 0] 500 steps, total: 34.980, sample: 0.417, forward: 0.481, backward: 0.503, update: 0.185
Successfully xmh. training takes 140.6175661087036 seconds
before call kg_cache_controller.StopThreads()
W20240202 14:30:36.646438 41653 grad_async_v1.h:243] call StopThreads. PID = 40832
W20240202 14:30:36.646453 41653 grad_base.h:212] before processOneStepNegThread_.join();
W20240202 14:30:36.652375 41653 grad_base.h:214] after processOneStepNegThread_.join();
W20240202 14:30:36.652397 41653 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240202 14:30:36.677219 41653 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f7fed1274d0>
