WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 16:41:40.129443 50007 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_44', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [50007 sampler.py:454] Start PreSampling
WARNING [50007 sampler.py:532] Before construct renumbering_dict
WARNING [50007 sampler.py:555] PreSampling done
W20240202 17:01:02.454093 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 17:01:02.454284 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 17:01:02.454324 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 17:01:02.454360 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 17:01:02.454397 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 17:01:02.454432 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 17:01:02.454468 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 17:01:02.454524 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 17:01:02.454560 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 17:01:02.454595 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 17:01:02.454633 50007 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 17:01:02.454667 50007 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 17:01:02.454703 50007 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 17:01:02.454876 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 17:01:02.454914 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 17:01:02.454946 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 17:01:02.454998 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 17:01:02.455031 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 17:01:02.455071 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 17:01:02.455103 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 17:01:02.455138 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 17:01:02.455178 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 17:01:02.455214 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 17:01:02.455246 50007 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 17:01:02.455272 50007 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 17:01:02.455298 50007 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 17:01:02.455365 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 17:01:02.455406 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 17:01:02.455448 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 17:01:02.455480 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 17:01:02.455510 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 17:01:02.455554 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 17:01:02.455590 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 17:01:02.455623 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 17:01:02.455654 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 17:01:02.455695 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 17:01:02.455725 50007 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 17:01:02.455750 50007 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 17:01:02.455783 50007 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 17:01:02.455847 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 17:01:02.455879 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 17:01:02.455910 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 17:01:02.455947 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 17:01:02.455984 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 17:01:02.456015 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 17:01:02.456064 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 17:01:02.456105 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 17:01:02.456140 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 17:01:02.456182 50007 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 17:01:02.456218 50007 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 17:01:02.456243 50007 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 17:01:02.456272 50007 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 17:01:02.877790 50007 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240202 17:09:46.563446 50007 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4302704,  4302734,   129097,  ..., 54914910, 15632390,  2472123]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2199.099 seconds
[Rank1] pid = 13630
[Rank2] pid = 13725
INFO [50007 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [13630 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [13794 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [13725 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [50007 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [13630 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [13794 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [13725 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240202 17:18:24.742719 13860 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240202 17:18:24.743710 13631 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240202 17:18:24.743853 13726 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240202 17:18:24.743856 13797 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240202 17:18:24.798048 13860 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102036619000 7.629 MB
W20240202 17:18:24.798082 13726 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102036dbc000 7.629 MB
W20240202 17:18:24.798085 13631 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10203755f000 7.629 MB
W20240202 17:18:24.798141 13797 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102037d02000 7.629 MB
W20240202 17:18:24.798202 13860 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020384a5000 7.629 MB
W20240202 17:18:24.798249 13726 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102038c48000 7.629 MB
W20240202 17:18:24.798254 13631 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1020393eb000 7.629 MB
W20240202 17:18:24.798269 13860 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102039b8e000 1.49 GB
W20240202 17:18:24.798285 13797 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x102099171000 7.629 MB
W20240202 17:18:24.798313 13726 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102099914000 1.49 GB
W20240202 17:18:24.798316 13860 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020f8ef7000 1.49 GB
W20240202 17:18:24.798337 13631 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1021584da000 1.49 GB
W20240202 17:18:24.798352 13797 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1021b7abd000 1.49 GB
W20240202 17:18:24.798357 13860 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 17:18:24.798377 13726 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022170a0000 1.49 GB
W20240202 17:18:24.798398 13631 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x102276683000 1.49 GB
W20240202 17:18:24.798404 13797 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1022d5c66000 1.49 GB
W20240202 17:18:24.798436 13726 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 17:18:24.798455 13797 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 17:18:24.798462 13631 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 17:18:24.804663 13860 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 17:18:24.804675 13726 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 17:18:24.804698 13797 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 17:18:24.804723 13631 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [13725 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank3] pid = 13794
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [50007 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [13630 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [13794 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 17:18:57.773595 13860 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240202 17:18:57.773660 13797 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240202 17:18:57.774099 13631 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240202 17:18:57.774243 13726 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240202 17:18:57.775588 13860 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240202 17:18:57.775713 13860 grad_base.h:184] Init GradProcessingBase done
I20240202 17:19:10.512378 13860 grad_async_v1.h:203] Use main thread to update emb.
W20240202 17:19:10.512602 13860 kg_controller.h:75] after init GradAsyncProcessing
I20240202 17:19:10.512640 13860 kg_controller.h:84] Construct KGCacheController done
E20240202 17:19:10.932512 13797 recstore.cc:66] init folly done
E20240202 17:19:10.932543 13860 recstore.cc:66] init folly done
E20240202 17:19:10.932560 13631 recstore.cc:66] init folly done
E20240202 17:19:10.932565 13726 recstore.cc:66] init folly done
I20240202 17:19:10.933708 13860 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240202 17:19:28.446987 13797 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240202 17:19:31.421288 13726 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240202 17:19:31.837344 13631 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240202 17:19:32.855067 13860 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240202 17:19:34.347157 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240202 17:19:35.347008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.826 ms                  | 187.976 ms                |
| ProcessBack:UpdateCache   | 3.019 ms                  | 280.583 ms                |
| ProcessBack:UpsertPq      | 19.631 ms                 | 28.097 ms                 |
| ProcessOneStep            | 27.521 ms                 | 583.208 ms                |
| BlockToStepN              | 633.000 ns                | 368.199 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:19:36.351670 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240202 17:19:37.351011 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.839 ms                  | 94.109 ms                 |
| Forward                   | 5.011 ms                  | 690.919 ms                |
| Backward                  | 10.635 ms                 | 201.832 ms                |
| Optimize                  | 2.290 ms                  | 6.419 ms                  |
| BarrierTimeBeforeRank0    | 4.699 ms                  | 31.819 ms                 |
| AfterBackward             | 27.326 ms                 | 583.387 ms                |
| BlockToStepN              | 2.392 ms                  | 369.031 ms                |
| OneStep                   | 121.083 ms                | 1.861 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 17:19:38.351009 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240202 17:19:39.351007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240202 17:19:40.351008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.524 ms                  | 154.710 ms                |
| ProcessBack:UpdateCache   | 2.893 ms                  | 280.039 ms                |
| ProcessBack:UpsertPq      | 19.316 ms                 | 25.536 ms                 |
| ProcessOneStep            | 26.613 ms                 | 583.208 ms                |
| BlockToStepN              | 2.355 ms                  | 368.199 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:19:41.351008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240202 17:19:42.351007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.561 ms                  | 94.109 ms                 |
| Forward                   | 4.786 ms                  | 690.919 ms                |
| Backward                  | 10.515 ms                 | 201.832 ms                |
| Optimize                  | 2.419 ms                  | 6.419 ms                  |
| BarrierTimeBeforeRank0    | 672.016 us                | 44.601 ms                 |
| AfterBackward             | 27.059 ms                 | 583.387 ms                |
| BlockToStepN              | 3.470 ms                  | 369.031 ms                |
| OneStep                   | 133.555 ms                | 1.861 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 17:19:43.351007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240202 17:19:44.351007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240202 17:19:45.351008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.503 ms                  | 154.710 ms                |
| ProcessBack:UpdateCache   | 2.978 ms                  | 280.039 ms                |
| ProcessBack:UpsertPq      | 19.316 ms                 | 37.742 ms                 |
| ProcessOneStep            | 26.740 ms                 | 583.208 ms                |
| BlockToStepN              | 3.436 ms                  | 368.199 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:19:46.352605 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=52, pq.top=52
W20240202 17:19:47.431638 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=56, pq.top=56
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.539 ms                  | 94.109 ms                 |
| Forward                   | 4.745 ms                  | 25.825 ms                 |
| Backward                  | 10.516 ms                 | 11.488 ms                 |
| Optimize                  | 2.383 ms                  | 5.807 ms                  |
| BarrierTimeBeforeRank0    | 2.266 ms                  | 31.819 ms                 |
| AfterBackward             | 27.126 ms                 | 44.270 ms                 |
| BlockToStepN              | 3.470 ms                  | 357.378 ms                |
| OneStep                   | 133.555 ms                | 501.741 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:19:48.523972 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240202 17:19:49.534543 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240202 17:19:50.534008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.539 ms                  | 154.710 ms                |
| ProcessBack:UpdateCache   | 3.015 ms                  | 280.039 ms                |
| ProcessBack:UpsertPq      | 20.169 ms                 | 58.159 ms                 |
| ProcessOneStep            | 27.521 ms                 | 86.550 ms                 |
| BlockToStepN              | 3.436 ms                  | 357.233 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:19:51.632607 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=72, pq.top=72
W20240202 17:19:52.632059 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.671 ms                  | 124.663 ms                |
| Forward                   | 4.777 ms                  | 25.825 ms                 |
| Backward                  | 10.634 ms                 | 14.718 ms                 |
| Optimize                  | 2.419 ms                  | 5.807 ms                  |
| BarrierTimeBeforeRank0    | 1.228 ms                  | 31.819 ms                 |
| AfterBackward             | 27.653 ms                 | 86.586 ms                 |
| BlockToStepN              | 3.470 ms                  | 357.378 ms                |
| OneStep                   | 260.215 ms                | 501.741 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:19:53.632007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240202 17:19:54.632006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240202 17:19:55.632009 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.545 ms                  | 15.412 ms                 |
| ProcessBack:UpdateCache   | 2.979 ms                  | 11.608 ms                 |
| ProcessBack:UpsertPq      | 19.672 ms                 | 51.439 ms                 |
| ProcessOneStep            | 27.276 ms                 | 86.550 ms                 |
| BlockToStepN              | 3.436 ms                  | 357.233 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:19:56.632010 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240202 17:19:57.664609 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=98, pq.top=98
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.839 ms                  | 150.860 ms                |
| Forward                   | 4.750 ms                  | 25.825 ms                 |
| Backward                  | 10.658 ms                 | 14.718 ms                 |
| Optimize                  | 2.441 ms                  | 5.807 ms                  |
| BarrierTimeBeforeRank0    | 502.416 us                | 31.819 ms                 |
| AfterBackward             | 27.126 ms                 | 86.586 ms                 |
| BlockToStepN              | 3.470 ms                  | 357.378 ms                |
| OneStep                   | 260.215 ms                | 514.175 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 29.634, sample: 1.638, forward: 1.056, backward: 1.126, update: 0.228
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 26.243, sample: 1.385, forward: 1.058, backward: 1.128, update: 0.231
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 26.659, sample: 1.474, forward: 1.099, backward: 1.186, update: 0.235
train_sampler.Prefill()
-------Step 0-------
tensor([   68232,   430758, 39624158,   612143,   546444,   430781,   430801,
          262082,    68264,    68300]) tensor([ 4972479, 23968694, 19761096, 55482944, 59104036, 29902892, 84476177,
        78699513, 54172235, 82217413])
-------Step 1-------
tensor([   68232,   430758, 39624158,   612143,   546444,   430781,   430801,
          262082,    68264,    68300]) tensor([32277390, 65921421, 70392149, 11344294, 62314972,  9063817, 84636538,
        70424621, 15857068, 34788667])
-------Step 2-------
tensor([  496323,    83804, 77352926,    83844,   496342,   496367,   496389,
        44721869,   496410,   496450]) tensor([32098412,  4995075, 52355550, 11058426, 16943450, 11384531, 64578615,
         8778593, 51639300, 29374824])
-------Step 3-------
tensor([  496323,    83804, 77352926,    83844,   496342,   496367,   496389,
        44721869,   496410,   496450]) tensor([16485003, 40260105, 80409437, 33491122, 15333205, 73744628, 67766497,
        67011726, 19981287, 67442880])
-------Step 4-------
tensor([562366, 100080, 562389, 562423, 100120, 562449, 100166, 562487, 100211,
        562515]) tensor([60085562, 34406222, 18843017, 15285358, 48958039, 48780332, 70935757,
        42356405, 60120956,  8721022])
-------Step 5-------
tensor([562366, 100080, 562389, 562423, 100120, 562449, 100166, 562487, 100211,
        562515]) tensor([37529941, 49529621, 83706843, 10234565, 33162172, 26146452, 39480861,
        62485722, 85186769,   329835])
-------Step 6-------
tensor([66026611,   629434,   629476,   629499,  4309637,   629511,   629535,
          629573,   629599,   268626]) tensor([24174663, 39141999, 22626760, 18484984, 79604890, 60092985, 37632569,
        15700516, 71644604,  8930811])
-------Step 7-------
tensor([66026611,   629434,   629476,   629499,  4309637,   629511,   629535,
          629573,   629599,   268626]) tensor([33873218, 77873802, 55809314, 61650165, 61430515,  1762776, 19136686,
        52081552, 21869953, 13748100])
-------Step 8-------
tensor([  697468,   133702,   697491, 29687917,   647765,   697521,   697544,
          697568,   270605,   647809]) tensor([26211793, 48634260, 41140098, 78891819, 74250611, 55590858, 52795088,
        71407596, 11567623,  3242137])
-------Step 9-------
tensor([  697468,   133702,   697491, 29687917,   647765,   697521,   697544,
          697568,   270605,   647809]) tensor([64488200, 68400343, 26794370, 36707288, 10597063,  1060178, 22587559,
        15625954, 71097715, 44366080])
before start barrier
start train
[proc 0] 100 steps, total: 25.226, sample: 1.668, forward: 1.189, backward: 1.274, update: 0.281
W20240202 17:19:58.705267 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240202 17:19:59.705008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240202 17:20:00.705008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.534 ms                  | 15.412 ms                 |
| ProcessBack:UpdateCache   | 2.819 ms                  | 11.608 ms                 |
| ProcessBack:UpsertPq      | 18.342 ms                 | 51.439 ms                 |
| ProcessOneStep            | 26.258 ms                 | 86.550 ms                 |
| BlockToStepN              | 3.436 ms                  | 357.233 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:01.726938 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240202 17:20:02.738656 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.951 ms                  | 150.860 ms                |
| Forward                   | 4.726 ms                  | 25.825 ms                 |
| Backward                  | 10.634 ms                 | 14.718 ms                 |
| Optimize                  | 2.457 ms                  | 6.419 ms                  |
| BarrierTimeBeforeRank0    | 58.638 us                 | 31.819 ms                 |
| AfterBackward             | 25.684 ms                 | 86.586 ms                 |
| BlockToStepN              | 3.470 ms                  | 357.378 ms                |
| OneStep                   | 260.215 ms                | 514.175 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:03.738006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240202 17:20:04.738008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240202 17:20:05.738010 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.507 ms                  | 13.442 ms                 |
| ProcessBack:UpdateCache   | 2.733 ms                  | 7.155 ms                  |
| ProcessBack:UpsertPq      | 17.877 ms                 | 49.777 ms                 |
| ProcessOneStep            | 24.817 ms                 | 86.550 ms                 |
| BlockToStepN              | 3.436 ms                  | 361.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:06.738008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240202 17:20:07.738006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.382 ms                  | 150.860 ms                |
| Forward                   | 4.726 ms                  | 25.825 ms                 |
| Backward                  | 10.523 ms                 | 32.969 ms                 |
| Optimize                  | 2.510 ms                  | 6.419 ms                  |
| BarrierTimeBeforeRank0    | 65.611 us                 | 31.819 ms                 |
| AfterBackward             | 24.706 ms                 | 86.586 ms                 |
| BlockToStepN              | 3.470 ms                  | 361.662 ms                |
| OneStep                   | 260.215 ms                | 514.175 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:08.738008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240202 17:20:09.738008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240202 17:20:10.738009 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.497 ms                  | 13.442 ms                 |
| ProcessBack:UpdateCache   | 2.713 ms                  | 7.155 ms                  |
| ProcessBack:UpsertPq      | 17.776 ms                 | 49.777 ms                 |
| ProcessOneStep            | 24.571 ms                 | 62.983 ms                 |
| BlockToStepN              | 5.140 ms                  | 360.781 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:11.844516 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.631 ms                  | 150.860 ms                |
| Forward                   | 4.683 ms                  | 10.024 ms                 |
| Backward                  | 10.451 ms                 | 14.718 ms                 |
| Optimize                  | 2.516 ms                  | 6.419 ms                  |
| BarrierTimeBeforeRank0    | 51.669 us                 | 31.665 ms                 |
| AfterBackward             | 25.126 ms                 | 63.019 ms                 |
| BlockToStepN              | 5.195 ms                  | 360.889 ms                |
| OneStep                   | 260.215 ms                | 513.661 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:12.844005 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240202 17:20:13.844007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240202 17:20:14.844007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240202 17:20:15.930176 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=178, pq.top=178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.469 ms                  | 8.505 ms                  |
| ProcessBack:UpdateCache   | 2.713 ms                  | 6.761 ms                  |
| ProcessBack:UpsertPq      | 17.868 ms                 | 49.425 ms                 |
| ProcessOneStep            | 24.883 ms                 | 62.983 ms                 |
| BlockToStepN              | 5.140 ms                  | 361.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:17.115257 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.488 ms                  | 152.783 ms                |
| Forward                   | 4.697 ms                  | 10.024 ms                 |
| Backward                  | 10.430 ms                 | 14.718 ms                 |
| Optimize                  | 2.494 ms                  | 6.419 ms                  |
| BarrierTimeBeforeRank0    | 51.669 us                 | 31.819 ms                 |
| AfterBackward             | 25.126 ms                 | 63.019 ms                 |
| BlockToStepN              | 5.195 ms                  | 361.662 ms                |
| OneStep                   | 260.215 ms                | 514.175 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:18.115007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240202 17:20:19.115010 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240202 17:20:20.152859 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=196, pq.top=196
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.470 ms                  | 8.505 ms                  |
| ProcessBack:UpdateCache   | 2.708 ms                  | 6.761 ms                  |
| ProcessBack:UpsertPq      | 17.831 ms                 | 49.425 ms                 |
| ProcessOneStep            | 24.883 ms                 | 62.983 ms                 |
| BlockToStepN              | 5.140 ms                  | 361.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:21.152004 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 3] 200 steps, total: 23.216, sample: 1.380, forward: 0.451, backward: 0.943, update: 0.226
[proc 2] 200 steps, total: 23.216, sample: 1.216, forward: 0.472, backward: 1.003, update: 0.228
[proc 1] 200 steps, total: 23.216, sample: 1.149, forward: 0.498, backward: 0.933, update: 0.229
[proc 0] 200 steps, total: 23.215, sample: 2.096, forward: 0.477, backward: 0.906, update: 0.291
W20240202 17:20:22.152007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.527 ms                  | 212.829 ms                |
| Forward                   | 4.687 ms                  | 10.024 ms                 |
| Backward                  | 10.496 ms                 | 14.718 ms                 |
| Optimize                  | 2.462 ms                  | 6.419 ms                  |
| BarrierTimeBeforeRank0    | 41.426 us                 | 31.819 ms                 |
| AfterBackward             | 24.576 ms                 | 63.019 ms                 |
| BlockToStepN              | 5.195 ms                  | 361.662 ms                |
| OneStep                   | 260.215 ms                | 598.585 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:23.157070 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240202 17:20:24.157007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240202 17:20:25.157006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.483 ms                  | 8.505 ms                  |
| ProcessBack:UpdateCache   | 2.702 ms                  | 6.761 ms                  |
| ProcessBack:UpsertPq      | 17.536 ms                 | 49.425 ms                 |
| ProcessOneStep            | 24.380 ms                 | 62.983 ms                 |
| BlockToStepN              | 313.772 ms                | 361.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:26.157008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240202 17:20:27.157007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.868 ms                  | 220.684 ms                |
| Forward                   | 4.687 ms                  | 10.024 ms                 |
| Backward                  | 10.523 ms                 | 14.718 ms                 |
| Optimize                  | 2.489 ms                  | 6.419 ms                  |
| BarrierTimeBeforeRank0    | 33.560 us                 | 31.819 ms                 |
| AfterBackward             | 24.384 ms                 | 63.019 ms                 |
| BlockToStepN              | 5.195 ms                  | 361.662 ms                |
| OneStep                   | 260.215 ms                | 604.546 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:28.365680 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240202 17:20:29.365010 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240202 17:20:30.365010 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.484 ms                  | 7.634 ms                  |
| ProcessBack:UpdateCache   | 2.696 ms                  | 6.253 ms                  |
| ProcessBack:UpsertPq      | 17.286 ms                 | 43.020 ms                 |
| ProcessOneStep            | 24.352 ms                 | 62.983 ms                 |
| BlockToStepN              | 5.140 ms                  | 364.198 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:31.365008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240202 17:20:32.365010 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.210 ms                  | 220.684 ms                |
| Forward                   | 4.683 ms                  | 17.768 ms                 |
| Backward                  | 10.573 ms                 | 14.718 ms                 |
| Optimize                  | 2.458 ms                  | 6.419 ms                  |
| BarrierTimeBeforeRank0    | 30.675 us                 | 31.819 ms                 |
| AfterBackward             | 24.384 ms                 | 63.019 ms                 |
| BlockToStepN              | 5.195 ms                  | 364.293 ms                |
| OneStep                   | 260.215 ms                | 604.546 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:33.389741 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
W20240202 17:20:34.389007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240202 17:20:35.389010 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.494 ms                  | 7.634 ms                  |
| ProcessBack:UpdateCache   | 2.696 ms                  | 6.253 ms                  |
| ProcessBack:UpsertPq      | 17.170 ms                 | 43.020 ms                 |
| ProcessOneStep            | 24.352 ms                 | 57.433 ms                 |
| BlockToStepN              | 5.140 ms                  | 361.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:36.389014 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240202 17:20:37.389011 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.467 ms                  | 212.829 ms                |
| Forward                   | 4.664 ms                  | 10.024 ms                 |
| Backward                  | 10.588 ms                 | 14.389 ms                 |
| Optimize                  | 2.458 ms                  | 5.807 ms                  |
| BarrierTimeBeforeRank0    | 29.503 us                 | 31.665 ms                 |
| AfterBackward             | 24.355 ms                 | 57.464 ms                 |
| BlockToStepN              | 5.195 ms                  | 362.708 ms                |
| OneStep                   | 260.215 ms                | 598.585 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:38.389008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240202 17:20:39.616451 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240202 17:20:40.727201 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.495 ms                  | 6.902 ms                  |
| ProcessBack:UpdateCache   | 2.696 ms                  | 6.185 ms                  |
| ProcessBack:UpsertPq      | 17.204 ms                 | 51.439 ms                 |
| ProcessOneStep            | 24.375 ms                 | 65.668 ms                 |
| BlockToStepN              | 5.140 ms                  | 362.609 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:41.727007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240202 17:20:42.727007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.483 ms                  | 212.829 ms                |
| Forward                   | 4.665 ms                  | 10.024 ms                 |
| Backward                  | 10.619 ms                 | 14.389 ms                 |
| Optimize                  | 2.457 ms                  | 5.807 ms                  |
| BarrierTimeBeforeRank0    | 28.936 us                 | 31.665 ms                 |
| AfterBackward             | 24.444 ms                 | 65.705 ms                 |
| BlockToStepN              | 5.195 ms                  | 362.708 ms                |
| OneStep                   | 260.215 ms                | 598.585 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:43.727007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240202 17:20:44.727007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 0] 300 steps, total: 23.652, sample: 2.085, forward: 0.479, backward: 1.102, update: 0.267
[proc 1] 300 steps, total: 23.652, sample: 1.138, forward: 0.486, backward: 0.925, update: 0.224
[proc 2] 300 steps, total: 23.652, sample: 1.139, forward: 0.479, backward: 0.940, update: 0.225
[proc 3] 300 steps, total: 23.652, sample: 1.081, forward: 0.467, backward: 1.055, update: 0.228
W20240202 17:20:45.727015 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.501 ms                  | 6.902 ms                  |
| ProcessBack:UpdateCache   | 2.695 ms                  | 6.185 ms                  |
| ProcessBack:UpsertPq      | 17.218 ms                 | 51.439 ms                 |
| ProcessOneStep            | 24.417 ms                 | 65.668 ms                 |
| BlockToStepN              | 5.140 ms                  | 362.609 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:46.754366 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.565 ms                  | 212.829 ms                |
| Forward                   | 4.687 ms                  | 10.024 ms                 |
| Backward                  | 10.635 ms                 | 14.389 ms                 |
| Optimize                  | 2.462 ms                  | 5.807 ms                  |
| BarrierTimeBeforeRank0    | 28.263 us                 | 31.665 ms                 |
| AfterBackward             | 24.485 ms                 | 65.705 ms                 |
| BlockToStepN              | 313.824 ms                | 362.708 ms                |
| OneStep                   | 363.615 ms                | 598.585 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:47.788635 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240202 17:20:48.788007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240202 17:20:49.788007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
W20240202 17:20:50.808784 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=326, pq.top=326
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.503 ms                  | 6.354 ms                  |
| ProcessBack:UpdateCache   | 2.693 ms                  | 5.746 ms                  |
| ProcessBack:UpsertPq      | 17.190 ms                 | 49.777 ms                 |
| ProcessOneStep            | 24.410 ms                 | 65.668 ms                 |
| BlockToStepN              | 5.140 ms                  | 362.609 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:51.814977 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=330, pq.top=330
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.657 ms                  | 212.829 ms                |
| Forward                   | 4.665 ms                  | 10.024 ms                 |
| Backward                  | 10.643 ms                 | 14.389 ms                 |
| Optimize                  | 2.457 ms                  | 5.807 ms                  |
| BarrierTimeBeforeRank0    | 28.073 us                 | 31.665 ms                 |
| AfterBackward             | 24.394 ms                 | 65.705 ms                 |
| BlockToStepN              | 5.195 ms                  | 362.708 ms                |
| OneStep                   | 260.215 ms                | 598.585 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:52.814006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240202 17:20:53.814007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=339, pq.top=339
W20240202 17:20:54.814006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240202 17:20:55.854781 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=348, pq.top=348
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.497 ms                  | 6.354 ms                  |
| ProcessBack:UpdateCache   | 2.681 ms                  | 5.746 ms                  |
| ProcessBack:UpsertPq      | 17.056 ms                 | 49.777 ms                 |
| ProcessOneStep            | 24.280 ms                 | 65.668 ms                 |
| BlockToStepN              | 5.140 ms                  | 362.609 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:56.854007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=353, pq.top=353
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.660 ms                  | 192.116 ms                |
| Forward                   | 4.662 ms                  | 9.616 ms                  |
| Backward                  | 10.635 ms                 | 13.936 ms                 |
| Optimize                  | 2.454 ms                  | 5.347 ms                  |
| BarrierTimeBeforeRank0    | 27.878 us                 | 26.390 ms                 |
| AfterBackward             | 24.245 ms                 | 63.019 ms                 |
| BlockToStepN              | 5.195 ms                  | 361.662 ms                |
| OneStep                   | 260.215 ms                | 574.677 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:20:57.854007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240202 17:20:58.854007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=361, pq.top=361
W20240202 17:20:59.868952 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=366, pq.top=366
W20240202 17:21:00.868006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.494 ms                  | 6.354 ms                  |
| ProcessBack:UpdateCache   | 2.673 ms                  | 5.746 ms                  |
| ProcessBack:UpsertPq      | 16.835 ms                 | 49.777 ms                 |
| ProcessOneStep            | 24.152 ms                 | 62.983 ms                 |
| BlockToStepN              | 5.140 ms                  | 361.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:01.868007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.626 ms                  | 192.116 ms                |
| Forward                   | 4.657 ms                  | 9.616 ms                  |
| Backward                  | 10.634 ms                 | 13.936 ms                 |
| Optimize                  | 2.444 ms                  | 5.347 ms                  |
| BarrierTimeBeforeRank0    | 27.648 us                 | 27.014 ms                 |
| AfterBackward             | 24.128 ms                 | 63.019 ms                 |
| BlockToStepN              | 5.195 ms                  | 361.662 ms                |
| OneStep                   | 260.215 ms                | 574.677 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:02.868006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240202 17:21:03.868009 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=383, pq.top=383
W20240202 17:21:04.868007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=389, pq.top=389
W20240202 17:21:05.896793 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.494 ms                  | 6.354 ms                  |
| ProcessBack:UpdateCache   | 2.667 ms                  | 5.746 ms                  |
| ProcessBack:UpsertPq      | 16.743 ms                 | 49.425 ms                 |
| ProcessOneStep            | 24.097 ms                 | 62.983 ms                 |
| BlockToStepN              | 5.140 ms                  | 361.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:06.896008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=397, pq.top=397
[proc 0] 400 steps, total: 22.634, sample: 1.520, forward: 0.463, backward: 1.052, update: 0.259
[proc 1] 400 steps, total: 22.634, sample: 1.133, forward: 0.484, backward: 0.938, update: 0.232
[proc 2] 400 steps, total: 22.634, sample: 1.148, forward: 0.485, backward: 0.952, update: 0.243
[proc 3] 400 steps, total: 22.634, sample: 1.076, forward: 0.480, backward: 0.902, update: 0.234
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.467 ms                  | 192.116 ms                |
| Forward                   | 4.662 ms                  | 9.616 ms                  |
| Backward                  | 10.630 ms                 | 13.936 ms                 |
| Optimize                  | 2.433 ms                  | 5.347 ms                  |
| BarrierTimeBeforeRank0    | 27.274 us                 | 27.014 ms                 |
| AfterBackward             | 24.044 ms                 | 63.019 ms                 |
| BlockToStepN              | 5.195 ms                  | 361.662 ms                |
| OneStep                   | 260.215 ms                | 574.677 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:07.896005 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=401, pq.top=401
W20240202 17:21:08.915423 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=406, pq.top=406
W20240202 17:21:09.916641 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=410, pq.top=410
W20240202 17:21:10.916008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=415, pq.top=415
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.494 ms                  | 6.354 ms                  |
| ProcessBack:UpdateCache   | 2.664 ms                  | 5.746 ms                  |
| ProcessBack:UpsertPq      | 16.674 ms                 | 49.425 ms                 |
| ProcessOneStep            | 23.987 ms                 | 62.983 ms                 |
| BlockToStepN              | 36.445 ms                 | 361.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:11.916007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.911 ms                  | 192.116 ms                |
| Forward                   | 4.656 ms                  | 9.616 ms                  |
| Backward                  | 10.620 ms                 | 13.936 ms                 |
| Optimize                  | 2.429 ms                  | 5.347 ms                  |
| BarrierTimeBeforeRank0    | 26.820 us                 | 27.014 ms                 |
| AfterBackward             | 24.006 ms                 | 63.019 ms                 |
| BlockToStepN              | 41.169 ms                 | 361.662 ms                |
| OneStep                   | 260.215 ms                | 574.677 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:12.916007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240202 17:21:13.916008 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240202 17:21:14.929340 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=432, pq.top=432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.494 ms                  | 6.354 ms                  |
| ProcessBack:UpdateCache   | 2.662 ms                  | 4.968 ms                  |
| ProcessBack:UpsertPq      | 16.596 ms                 | 48.819 ms                 |
| ProcessOneStep            | 23.972 ms                 | 62.983 ms                 |
| BlockToStepN              | 41.130 ms                 | 361.544 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:15.963037 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240202 17:21:16.971418 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=440, pq.top=440
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.848 ms                  | 192.116 ms                |
| Forward                   | 4.653 ms                  | 9.616 ms                  |
| Backward                  | 10.617 ms                 | 13.936 ms                 |
| Optimize                  | 2.429 ms                  | 5.347 ms                  |
| BarrierTimeBeforeRank0    | 26.773 us                 | 27.014 ms                 |
| AfterBackward             | 23.983 ms                 | 63.019 ms                 |
| BlockToStepN              | 313.824 ms                | 361.662 ms                |
| OneStep                   | 363.615 ms                | 574.677 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:17.971006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240202 17:21:18.971006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240202 17:21:19.971006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=453, pq.top=453
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.494 ms                  | 6.354 ms                  |
| ProcessBack:UpdateCache   | 2.662 ms                  | 4.968 ms                  |
| ProcessBack:UpsertPq      | 16.637 ms                 | 49.425 ms                 |
| ProcessOneStep            | 23.980 ms                 | 62.983 ms                 |
| BlockToStepN              | 44.321 ms                 | 360.781 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:20.971005 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240202 17:21:21.971007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=461, pq.top=461
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.607 ms                  | 189.090 ms                |
| Forward                   | 4.649 ms                  | 8.962 ms                  |
| Backward                  | 10.611 ms                 | 13.548 ms                 |
| Optimize                  | 2.429 ms                  | 5.229 ms                  |
| BarrierTimeBeforeRank0    | 26.773 us                 | 26.390 ms                 |
| AfterBackward             | 24.002 ms                 | 63.019 ms                 |
| BlockToStepN              | 44.356 ms                 | 360.889 ms                |
| OneStep                   | 260.215 ms                | 560.129 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:22.983594 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=466, pq.top=466
W20240202 17:21:24.091995 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240202 17:21:25.091006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=475, pq.top=475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.495 ms                  | 6.354 ms                  |
| ProcessBack:UpdateCache   | 2.660 ms                  | 4.951 ms                  |
| ProcessBack:UpsertPq      | 16.554 ms                 | 48.819 ms                 |
| ProcessOneStep            | 23.959 ms                 | 62.983 ms                 |
| BlockToStepN              | 48.161 ms                 | 360.781 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:26.091006 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=479, pq.top=479
W20240202 17:21:27.091007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.371 ms                  | 189.090 ms                |
| Forward                   | 4.654 ms                  | 8.962 ms                  |
| Backward                  | 10.609 ms                 | 13.548 ms                 |
| Optimize                  | 2.433 ms                  | 5.229 ms                  |
| BarrierTimeBeforeRank0    | 26.598 us                 | 26.390 ms                 |
| AfterBackward             | 23.973 ms                 | 63.019 ms                 |
| BlockToStepN              | 51.969 ms                 | 360.889 ms                |
| OneStep                   | 260.215 ms                | 560.129 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:28.091014 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240202 17:21:29.091007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=491, pq.top=491
W20240202 17:21:30.091007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=496, pq.top=496
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.497 ms                  | 6.354 ms                  |
| ProcessBack:UpdateCache   | 2.660 ms                  | 4.951 ms                  |
| ProcessBack:UpsertPq      | 16.554 ms                 | 48.819 ms                 |
| ProcessOneStep            | 23.974 ms                 | 62.983 ms                 |
| BlockToStepN              | 54.282 ms                 | 360.781 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 17:21:31.091007 13860 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 2] 500 steps, total: 23.529, sample: 1.016, forward: 0.498, backward: 1.010, update: 0.249
[proc 1] 500 steps, total: 23.529, sample: 1.014, forward: 0.492, backward: 0.998, update: 0.239
[proc 3] 500 steps, total: 23.529, sample: 0.996, forward: 0.484, backward: 0.900, update: 0.227
[proc 0] 500 steps, total: 23.529, sample: 1.396, forward: 0.457, backward: 1.048, update: 0.258
Successfully xmh. training takes 118.25712418556213 seconds
before call kg_cache_controller.StopThreads()
W20240202 17:21:31.112195 13860 grad_async_v1.h:243] call StopThreads. PID = 50007
W20240202 17:21:31.112207 13860 grad_base.h:212] before processOneStepNegThread_.join();
W20240202 17:21:31.117597 13860 grad_base.h:214] after processOneStepNegThread_.join();
W20240202 17:21:31.117619 13860 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240202 17:21:31.149881 13860 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.380 ms                  | 189.090 ms                |
| Forward                   | 4.654 ms                  | 8.962 ms                  |
| Backward                  | 10.611 ms                 | 13.548 ms                 |
| Optimize                  | 2.427 ms                  | 5.229 ms                  |
| BarrierTimeBeforeRank0    | 26.563 us                 | 26.390 ms                 |
| AfterBackward             | 23.999 ms                 | 63.019 ms                 |
| BlockToStepN              | 55.864 ms                 | 360.889 ms                |
| OneStep                   | 260.215 ms                | 560.129 ms                |
+---------------------------+---------------------------+---------------------------+
