WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 16:24:57.136216 63305 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_8', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [63305 sampler.py:454] Start PreSampling
WARNING [63305 sampler.py:532] Before construct renumbering_dict
WARNING [63305 sampler.py:555] PreSampling done
W20240206 16:45:44.315601 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 16:45:44.315814 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 16:45:44.315863 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 16:45:44.315898 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 16:45:44.315933 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 16:45:44.315968 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 16:45:44.316000 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 16:45:44.316047 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 16:45:44.316097 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 16:45:44.316128 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 16:45:44.316174 63305 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 16:45:44.316205 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 16:45:44.316231 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 16:45:44.316397 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 16:45:44.316438 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 16:45:44.316474 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 16:45:44.316519 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 16:45:44.316545 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 16:45:44.316577 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 16:45:44.316612 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 16:45:44.316644 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 16:45:44.316677 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 16:45:44.316715 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 16:45:44.316743 63305 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 16:45:44.316767 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 16:45:44.316792 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 16:45:44.316852 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 16:45:44.316884 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 16:45:44.316920 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 16:45:44.316951 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 16:45:44.316979 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 16:45:44.317008 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 16:45:44.317036 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 16:45:44.317075 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 16:45:44.317103 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 16:45:44.317142 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 16:45:44.317178 63305 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 16:45:44.317202 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 16:45:44.317231 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 16:45:44.317291 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 16:45:44.317332 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 16:45:44.317368 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 16:45:44.317400 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 16:45:44.317428 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 16:45:44.317466 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 16:45:44.317494 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 16:45:44.317521 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 16:45:44.317549 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 16:45:44.317577 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 16:45:44.317605 63305 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 16:45:44.317628 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 16:45:44.317657 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 16:45:44.317718 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 16:45:44.317754 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 16:45:44.317783 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 16:45:44.317816 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 16:45:44.317847 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 16:45:44.317881 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 16:45:44.317916 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 16:45:44.317951 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 16:45:44.317987 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 16:45:44.318020 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 16:45:44.318053 63305 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 16:45:44.318076 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 16:45:44.318100 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 16:45:44.318157 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 16:45:44.318189 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 16:45:44.318218 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 16:45:44.318253 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 16:45:44.318286 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 16:45:44.318317 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 16:45:44.318353 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 16:45:44.318389 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 16:45:44.318420 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 16:45:44.318451 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 16:45:44.318480 63305 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 16:45:44.318503 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 16:45:44.318527 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 16:45:44.318581 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 16:45:44.318617 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 16:45:44.318648 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 16:45:44.318677 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 16:45:44.318710 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 16:45:44.318740 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 16:45:44.318773 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 16:45:44.318802 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 16:45:44.318831 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 16:45:44.318864 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 16:45:44.318897 63305 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 16:45:44.318921 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 16:45:44.318951 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 16:45:44.319010 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240206 16:45:44.319043 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240206 16:45:44.319073 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240206 16:45:44.319104 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240206 16:45:44.319134 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240206 16:45:44.319171 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240206 16:45:44.319208 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240206 16:45:44.319249 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240206 16:45:44.319286 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240206 16:45:44.319322 63305 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240206 16:45:44.319351 63305 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240206 16:45:44.319375 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240206 16:45:44.319404 63305 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240206 16:45:44.753041 63305 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240206 16:54:24.875208 63305 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302709,  4302738,    84839,  ..., 57085915, 60564191,  4918782]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2274.100 seconds
[Rank1] pid = 64435
[Rank2] pid = 64530
[Rank3] pid = 64597
[Rank4] pid = 64666
[Rank5] pid = 64733
[Rank6] pid = 64800
INFO [63305 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [64435 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [64530 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [64597 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [64666 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [64733 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [64869 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [64800 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [64869 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64800 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64597 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64666 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64733 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240206 17:03:03.040242 64913 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240206 17:03:03.040530 64598 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240206 17:03:03.040539 64801 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240206 17:03:03.041191 64667 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240206 17:03:03.042476 64734 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
INFO [63305 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64435 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64530 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240206 17:03:03.044418 64870 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240206 17:03:03.045855 64531 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240206 17:03:03.045948 64436 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240206 17:03:03.117722 64801 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1020497a9000 7.629 MB
W20240206 17:03:03.117870 64913 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204a6f7000 7.629 MB
W20240206 17:03:03.117867 64870 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102049f54000 7.629 MB
W20240206 17:03:03.117875 64598 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204ae9a000 7.629 MB
W20240206 17:03:03.117893 64667 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204b63d000 7.629 MB
W20240206 17:03:03.117928 64801 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204cd26000 7.629 MB
W20240206 17:03:03.117921 64436 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204bde0000 7.629 MB
W20240206 17:03:03.117926 64734 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204c583000 7.629 MB
W20240206 17:03:03.117935 64531 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10204d4c9000 7.629 MB
W20240206 17:03:03.118007 64801 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10204dc6c000 1.49 GB
W20240206 17:03:03.118017 64870 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020ad24f000 7.629 MB
W20240206 17:03:03.118044 64913 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x1020ad9f2000 7.629 MB
W20240206 17:03:03.118057 64801 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1020ae195000 1.49 GB
W20240206 17:03:03.118074 64598 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10210d778000 7.629 MB
W20240206 17:03:03.118083 64870 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210df1b000 1.49 GB
W20240206 17:03:03.118091 64667 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10216d4fe000 7.629 MB
W20240206 17:03:03.118129 64436 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10216dca1000 7.629 MB
W20240206 17:03:03.118134 64734 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10216e444000 7.629 MB
W20240206 17:03:03.118139 64531 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10216ebe7000 7.629 MB
W20240206 17:03:03.118145 64870 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10216f38a000 1.49 GB
W20240206 17:03:03.118157 64801 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240206 17:03:03.118165 64913 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1021ce96d000 1.49 GB
W20240206 17:03:03.118181 64598 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10222df50000 1.49 GB
W20240206 17:03:03.118196 64870 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 17:03:03.118201 64667 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10228d533000 1.49 GB
W20240206 17:03:03.118221 64913 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1022ecb16000 1.49 GB
W20240206 17:03:03.118234 64598 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10234c0f9000 1.49 GB
W20240206 17:03:03.118242 64436 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1023ab6dc000 1.49 GB
W20240206 17:03:03.118247 64734 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10240acbf000 1.49 GB
W20240206 17:03:03.118263 64531 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10246a2a2000 1.49 GB
W20240206 17:03:03.118286 64667 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1024c9885000 1.49 GB
W20240206 17:03:03.118312 64913 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240206 17:03:03.118314 64598 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 17:03:03.118320 64531 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102528e68000 1.49 GB
W20240206 17:03:03.118326 64734 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10258844b000 1.49 GB
W20240206 17:03:03.118340 64436 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240206 17:03:03.118356 64667 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 17:03:03.118376 64531 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 17:03:03.118382 64436 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 17:03:03.118389 64734 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240206 17:03:03.131067 64870 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 17:03:03.131090 64667 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 17:03:03.131093 64598 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 17:03:03.131119 64913 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240206 17:03:03.131121 64531 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 17:03:03.131127 64734 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240206 17:03:03.131134 64436 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 17:03:03.131148 64801 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [64733 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [64530 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [64597 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 64869
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [63305 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [64800 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [64435 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [64666 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [64869 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 17:03:53.787204 64913 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240206 17:03:53.787319 64436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 17:03:53.787398 64801 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 17:03:53.787544 64598 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 17:03:53.787719 64870 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 17:03:53.788094 64667 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 17:03:53.788246 64531 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240206 17:03:53.788671 64734 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240206 17:03:53.792028 64870 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240206 17:03:53.792589 64870 grad_base.h:184] Init GradProcessingBase done
I20240206 17:04:06.190608 64870 grad_async_v1.h:203] Use main thread to update emb.
W20240206 17:04:06.190757 64870 kg_controller.h:75] after init GradAsyncProcessing
I20240206 17:04:06.190766 64870 kg_controller.h:84] Construct KGCacheController done
E20240206 17:04:07.997095 64913 recstore.cc:66] init folly done
E20240206 17:04:07.997414 64667 recstore.cc:66] init folly done
E20240206 17:04:07.997488 64734 recstore.cc:66] init folly done
E20240206 17:04:07.997881 64870 recstore.cc:66] init folly done
E20240206 17:04:07.997947 64531 recstore.cc:66] init folly done
E20240206 17:04:07.998016 64801 recstore.cc:66] init folly done
E20240206 17:04:07.998030 64598 recstore.cc:66] init folly done
E20240206 17:04:07.998613 64436 recstore.cc:66] init folly done
I20240206 17:04:07.999503 64870 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240206 17:04:28.925792 64734 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240206 17:04:29.309648 64913 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 17:04:29.860504 64667 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 17:04:30.969048 64531 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 17:04:31.532123 64436 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 17:04:31.914256 64598 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 17:04:31.929749 64870 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240206 17:04:32.515096 64801 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 25.392 ms                 | 25.392 ms                 |
| Forward                   | 518.444 ms                | 518.444 ms                |
| Backward                  | 202.473 ms                | 202.473 ms                |
| Optimize                  | 43.649 ms                 | 43.649 ms                 |
| BarrierTimeBeforeRank0    | 22.691 ms                 | 22.691 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:34.575160 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240206 17:04:35.640082 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240206 17:04:36.677686 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.395 ms                 | 325.722 ms                |
| ProcessBack:UpdateCache   | 9.814 ms                  | 658.704 ms                |
| ProcessBack:UpsertPq      | 39.189 ms                 | 41.228 ms                 |
| ProcessOneStep            | 61.681 ms                 | 1.246 s                   |
| BlockToStepN              | 9.581 ms                  | 834.088 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:38.116815 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 22.962 ms                 | 100.751 ms                |
| Forward                   | 5.375 ms                  | 518.444 ms                |
| Backward                  | 11.978 ms                 | 202.473 ms                |
| Optimize                  | 4.466 ms                  | 43.649 ms                 |
| BarrierTimeBeforeRank0    | 935.125 us                | 302.053 ms                |
| AfterBackward             | 61.884 ms                 | 1.246 s                   |
| BlockToStepN              | 9.625 ms                  | 836.129 ms                |
| OneStep                   | 114.551 ms                | 2.897 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:39.149190 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=8, pq.top=8
W20240206 17:04:40.169682 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=10, pq.top=10
W20240206 17:04:41.342696 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240206 17:04:42.432307 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.168 ms                  | 325.722 ms                |
| ProcessBack:UpdateCache   | 10.003 ms                 | 658.704 ms                |
| ProcessBack:UpsertPq      | 40.864 ms                 | 96.334 ms                 |
| ProcessOneStep            | 67.037 ms                 | 1.246 s                   |
| BlockToStepN              | 9.581 ms                  | 834.088 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:43.464288 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.122 ms                 | 113.775 ms                |
| Forward                   | 5.413 ms                  | 518.444 ms                |
| Backward                  | 11.978 ms                 | 202.473 ms                |
| Optimize                  | 2.582 ms                  | 43.649 ms                 |
| BarrierTimeBeforeRank0    | 935.125 us                | 302.053 ms                |
| AfterBackward             | 70.731 ms                 | 1.246 s                   |
| BlockToStepN              | 9.625 ms                  | 836.129 ms                |
| OneStep                   | 208.894 ms                | 2.897 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:44.475731 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240206 17:04:45.488535 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240206 17:04:46.826471 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240206 17:04:47.923040 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.941 ms                  | 325.722 ms                |
| ProcessBack:UpdateCache   | 10.724 ms                 | 658.704 ms                |
| ProcessBack:UpsertPq      | 41.228 ms                 | 96.334 ms                 |
| ProcessOneStep            | 69.690 ms                 | 1.246 s                   |
| BlockToStepN              | 9.581 ms                  | 834.088 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.131 ms                 | 125.176 ms                |
| Forward                   | 5.244 ms                  | 518.444 ms                |
| Backward                  | 11.924 ms                 | 202.473 ms                |
| Optimize                  | 2.794 ms                  | 43.649 ms                 |
| BarrierTimeBeforeRank0    | 981.495 us                | 302.053 ms                |
| AfterBackward             | 67.071 ms                 | 1.246 s                   |
| BlockToStepN              | 751.152 ms                | 836.129 ms                |
| OneStep                   | 887.226 ms                | 2.897 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:48.923007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240206 17:04:49.923005 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240206 17:04:50.983467 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240206 17:04:52.050861 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.819 ms                  | 293.795 ms                |
| ProcessBack:UpdateCache   | 10.238 ms                 | 657.337 ms                |
| ProcessBack:UpsertPq      | 37.075 ms                 | 96.032 ms                 |
| ProcessOneStep            | 61.681 ms                 | 1.246 s                   |
| BlockToStepN              | 9.581 ms                  | 834.088 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:53.050004 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.799 ms                  | 125.176 ms                |
| Forward                   | 5.051 ms                  | 518.444 ms                |
| Backward                  | 11.520 ms                 | 202.473 ms                |
| Optimize                  | 2.643 ms                  | 43.649 ms                 |
| BarrierTimeBeforeRank0    | 6.168 ms                  | 302.053 ms                |
| AfterBackward             | 61.468 ms                 | 1.246 s                   |
| BlockToStepN              | 9.625 ms                  | 836.129 ms                |
| OneStep                   | 208.894 ms                | 2.897 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:54.050010 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240206 17:04:55.050009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240206 17:04:56.050009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240206 17:04:57.050009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.668 ms                  | 293.795 ms                |
| ProcessBack:UpdateCache   | 10.003 ms                 | 657.337 ms                |
| ProcessBack:UpsertPq      | 35.644 ms                 | 96.032 ms                 |
| ProcessOneStep            | 60.869 ms                 | 1.246 s                   |
| BlockToStepN              | 9.581 ms                  | 834.088 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:58.050005 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 113.775 ms                |
| Forward                   | 5.028 ms                  | 9.294 ms                  |
| Backward                  | 11.208 ms                 | 36.041 ms                 |
| Optimize                  | 2.821 ms                  | 5.933 ms                  |
| BarrierTimeBeforeRank0    | 5.431 ms                  | 223.962 ms                |
| AfterBackward             | 60.485 ms                 | 119.266 ms                |
| BlockToStepN              | 9.992 ms                  | 836.129 ms                |
| OneStep                   | 208.894 ms                | 2.897 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:04:59.050012 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240206 17:05:00.050009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240206 17:05:01.050006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240206 17:05:02.085196 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.668 ms                  | 293.795 ms                |
| ProcessBack:UpdateCache   | 9.841 ms                  | 657.337 ms                |
| ProcessBack:UpsertPq      | 36.593 ms                 | 96.032 ms                 |
| ProcessOneStep            | 60.869 ms                 | 119.226 ms                |
| BlockToStepN              | 9.937 ms                  | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:03.085004 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.879 ms                  | 113.775 ms                |
| Forward                   | 5.057 ms                  | 9.294 ms                  |
| Backward                  | 11.208 ms                 | 36.041 ms                 |
| Optimize                  | 2.821 ms                  | 5.933 ms                  |
| BarrierTimeBeforeRank0    | 4.061 ms                  | 242.857 ms                |
| AfterBackward             | 61.094 ms                 | 119.266 ms                |
| BlockToStepN              | 9.992 ms                  | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:04.085007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240206 17:05:05.085016 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240206 17:05:06.104574 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
W20240206 17:05:07.104007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.645 ms                  | 293.795 ms                |
| ProcessBack:UpdateCache   | 9.849 ms                  | 657.337 ms                |
| ProcessBack:UpsertPq      | 36.602 ms                 | 96.032 ms                 |
| ProcessOneStep            | 61.060 ms                 | 119.226 ms                |
| BlockToStepN              | 9.937 ms                  | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:08.104005 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.900 ms                  | 113.775 ms                |
| Forward                   | 5.113 ms                  | 12.286 ms                 |
| Backward                  | 11.205 ms                 | 36.041 ms                 |
| Optimize                  | 2.821 ms                  | 7.678 ms                  |
| BarrierTimeBeforeRank0    | 4.968 ms                  | 242.857 ms                |
| AfterBackward             | 61.094 ms                 | 119.266 ms                |
| BlockToStepN              | 9.992 ms                  | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:09.359870 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240206 17:05:10.400133 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240206 17:05:11.400005 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240206 17:05:12.400007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.645 ms                  | 42.334 ms                 |
| ProcessBack:UpdateCache   | 9.851 ms                  | 20.081 ms                 |
| ProcessBack:UpsertPq      | 35.910 ms                 | 87.673 ms                 |
| ProcessOneStep            | 59.653 ms                 | 119.226 ms                |
| BlockToStepN              | 9.937 ms                  | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:13.400007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.200 ms                  | 119.500 ms                |
| Forward                   | 5.071 ms                  | 12.286 ms                 |
| Backward                  | 11.160 ms                 | 36.041 ms                 |
| Optimize                  | 2.824 ms                  | 7.678 ms                  |
| BarrierTimeBeforeRank0    | 4.317 ms                  | 242.857 ms                |
| AfterBackward             | 59.576 ms                 | 119.266 ms                |
| BlockToStepN              | 9.992 ms                  | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:14.400007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240206 17:05:15.400007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240206 17:05:16.400008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240206 17:05:17.400007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.615 ms                  | 42.334 ms                 |
| ProcessBack:UpdateCache   | 9.814 ms                  | 20.081 ms                 |
| ProcessBack:UpsertPq      | 35.121 ms                 | 87.673 ms                 |
| ProcessOneStep            | 58.876 ms                 | 119.226 ms                |
| BlockToStepN              | 9.947 ms                  | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:18.450107 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.801 ms                  | 119.500 ms                |
| Forward                   | 5.057 ms                  | 12.286 ms                 |
| Backward                  | 11.152 ms                 | 36.041 ms                 |
| Optimize                  | 2.824 ms                  | 7.678 ms                  |
| BarrierTimeBeforeRank0    | 4.061 ms                  | 242.857 ms                |
| AfterBackward             | 58.913 ms                 | 119.266 ms                |
| BlockToStepN              | 9.998 ms                  | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:19.450006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240206 17:05:20.450006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240206 17:05:21.450008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240206 17:05:22.450008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.462 ms                  | 42.334 ms                 |
| ProcessBack:UpdateCache   | 9.788 ms                  | 20.081 ms                 |
| ProcessBack:UpsertPq      | 34.553 ms                 | 87.673 ms                 |
| ProcessOneStep            | 57.835 ms                 | 119.226 ms                |
| BlockToStepN              | 10.694 ms                 | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:23.450007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 119.500 ms                |
| Forward                   | 5.051 ms                  | 12.286 ms                 |
| Backward                  | 11.152 ms                 | 36.041 ms                 |
| Optimize                  | 2.821 ms                  | 7.678 ms                  |
| BarrierTimeBeforeRank0    | 4.061 ms                  | 242.857 ms                |
| AfterBackward             | 57.599 ms                 | 119.266 ms                |
| BlockToStepN              | 10.736 ms                 | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 52.312, sample: 1.667, forward: 1.042, backward: 1.285, update: 0.307
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 51.711, sample: 1.516, forward: 1.074, backward: 1.088, update: 0.305
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 54.916, sample: 1.355, forward: 1.018, backward: 1.327, update: 0.329
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 55.301, sample: 2.623, forward: 1.133, backward: 1.305, update: 0.325
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 52.694, sample: 2.558, forward: 1.061, backward: 1.219, update: 0.312
train_sampler.Prefill()
-------Step 0-------
tensor([   45431,    45453,    45486,    45509,  5987120,    98904, 58784957,
        19207243, 22008766,    45529]) tensor([ 5278580, 14761521, 54975984, 81363402, 18673777, 33727101, 40203269,
        72297703, 64939888, 26724557])
-------Step 1-------
tensor([   45431,    45453,    45486,    45509,  5987120,    98904, 58784957,
        19207243, 22008766,    45529]) tensor([75532177, 26314452, 10018135, 74823256, 76131371, 46319532, 66989948,
        47046457, 35066629, 14166539])
-------Step 2-------
tensor([  114387,   114412,   114444,    30432,   114465,   114497,   114530,
        26176761,   114558,   114581]) tensor([77615356, 21578417, 74753562, 44801291, 45603710, 29914879, 75851125,
        37430872, 15331133, 45368850])
-------Step 3-------
tensor([  114387,   114412,   114444,    30432,   114465,   114497,   114530,
        26176761,   114558,   114581]) tensor([45774123, 84058927, 32348256, 40965172, 57684857, 58388893, 38677912,
        17696566, 24277945,   759651])
-------Step 4-------
tensor([  181665, 40659100,   181694,   124167,   181713,   124200,   181747,
        42757027,   181772,   181805]) tensor([82328683, 10605674, 85319533, 16672716, 65669841, 39275192, 71508534,
        40174381, 77632981, 47748698])
-------Step 5-------
tensor([  181665, 40659100,   181694,   124167,   181713,   124200,   181747,
        42757027,   181772,   181805]) tensor([37800757, 76667499,   295747, 84334965, 52718811, 59593696, 16020652,
         9474823, 65192987, 43995412])
-------Step 6-------
tensor([  248944,    64055,   248972,   248984,    64094, 80532753,   249022,
          249048,   136587, 38996954]) tensor([12202317, 35503030, 32915368, 74653347, 35870230, 40251688, 25369543,
         6785427, 73714322, 75457780])
-------Step 7-------
tensor([  248944,    64055,   248972,   248984,    64094, 80532753,   249022,
          249048,   136587, 38996954]) tensor([22317190, 47485500, 64289213, 64124634, 83865874, 54449311, 51295076,
        52293268, 33100600, 32366000])
-------Step 8-------
tensor([  314431, 26385325,   314458,   148363,   314485,    80316,   314522,
          314544,   314575,   314601]) tensor([48192110, 23129796, 31994707,  1904820, 44976616, 60658049, 16494376,
        66553082,  1487986, 57531666])
-------Step 9-------
tensor([  314431, 26385325,   314458,   148363,   314485,    80316,   314522,
          314544,   314575,   314601]) tensor([57543763, 33403177, 14542067, 50432274,  8569869, 37774732, 24992221,
        35004359, 81179725, 72702137])
before start barrier
start train
[proc 0] 100 steps, total: 52.296, sample: 1.783, forward: 1.046, backward: 1.303, update: 0.373
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 53.257, sample: 2.262, forward: 0.997, backward: 1.226, update: 0.303
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 54.366, sample: 1.960, forward: 1.058, backward: 1.250, update: 0.300
W20240206 17:05:24.450006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240206 17:05:25.625700 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240206 17:05:26.696477 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240206 17:05:27.696007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.362 ms                  | 42.334 ms                 |
| ProcessBack:UpdateCache   | 9.716 ms                  | 20.081 ms                 |
| ProcessBack:UpsertPq      | 34.924 ms                 | 87.673 ms                 |
| ProcessOneStep            | 58.876 ms                 | 119.226 ms                |
| BlockToStepN              | 10.694 ms                 | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:28.696007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.801 ms                  | 119.500 ms                |
| Forward                   | 5.029 ms                  | 12.286 ms                 |
| Backward                  | 11.160 ms                 | 36.041 ms                 |
| Optimize                  | 2.794 ms                  | 7.678 ms                  |
| BarrierTimeBeforeRank0    | 4.968 ms                  | 242.857 ms                |
| AfterBackward             | 58.855 ms                 | 119.266 ms                |
| BlockToStepN              | 10.736 ms                 | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:29.696007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240206 17:05:30.696017 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240206 17:05:31.696007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240206 17:05:32.696007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.330 ms                  | 42.334 ms                 |
| ProcessBack:UpdateCache   | 9.705 ms                  | 20.081 ms                 |
| ProcessBack:UpsertPq      | 34.797 ms                 | 87.673 ms                 |
| ProcessOneStep            | 58.273 ms                 | 119.226 ms                |
| BlockToStepN              | 10.694 ms                 | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:33.705252 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.940 ms                  | 119.500 ms                |
| Forward                   | 5.029 ms                  | 12.286 ms                 |
| Backward                  | 11.160 ms                 | 36.041 ms                 |
| Optimize                  | 2.794 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 4.068 ms                  | 242.857 ms                |
| AfterBackward             | 58.278 ms                 | 119.266 ms                |
| BlockToStepN              | 10.736 ms                 | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:34.706112 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240206 17:05:35.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240206 17:05:36.706008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240206 17:05:37.706008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.330 ms                  | 36.793 ms                 |
| ProcessBack:UpdateCache   | 9.694 ms                  | 15.438 ms                 |
| ProcessBack:UpsertPq      | 34.735 ms                 | 84.641 ms                 |
| ProcessOneStep            | 57.252 ms                 | 119.226 ms                |
| BlockToStepN              | 10.694 ms                 | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:38.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.474 ms                  | 119.500 ms                |
| Forward                   | 5.002 ms                  | 12.286 ms                 |
| Backward                  | 11.153 ms                 | 36.041 ms                 |
| Optimize                  | 2.794 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 3.707 ms                  | 242.857 ms                |
| AfterBackward             | 57.267 ms                 | 119.266 ms                |
| BlockToStepN              | 11.304 ms                 | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:39.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240206 17:05:40.706008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240206 17:05:41.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240206 17:05:42.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.330 ms                  | 36.793 ms                 |
| ProcessBack:UpdateCache   | 9.606 ms                  | 15.438 ms                 |
| ProcessBack:UpsertPq      | 34.217 ms                 | 84.641 ms                 |
| ProcessOneStep            | 56.451 ms                 | 119.226 ms                |
| BlockToStepN              | 24.643 ms                 | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:43.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.405 ms                  | 119.500 ms                |
| Forward                   | 4.997 ms                  | 12.286 ms                 |
| Backward                  | 11.152 ms                 | 36.041 ms                 |
| Optimize                  | 2.794 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 3.707 ms                  | 242.857 ms                |
| AfterBackward             | 56.446 ms                 | 119.266 ms                |
| BlockToStepN              | 24.691 ms                 | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:44.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240206 17:05:45.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240206 17:05:46.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240206 17:05:47.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.362 ms                  | 36.793 ms                 |
| ProcessBack:UpdateCache   | 9.580 ms                  | 15.438 ms                 |
| ProcessBack:UpsertPq      | 33.911 ms                 | 84.641 ms                 |
| ProcessOneStep            | 56.253 ms                 | 119.226 ms                |
| BlockToStepN              | 78.124 ms                 | 828.913 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:48.706007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.435 ms                  | 119.500 ms                |
| Forward                   | 5.005 ms                  | 12.286 ms                 |
| Backward                  | 11.146 ms                 | 36.041 ms                 |
| Optimize                  | 2.821 ms                  | 11.458 ms                 |
| BarrierTimeBeforeRank0    | 4.317 ms                  | 242.857 ms                |
| AfterBackward             | 56.284 ms                 | 119.266 ms                |
| BlockToStepN              | 78.177 ms                 | 829.029 ms                |
| OneStep                   | 223.516 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:49.947315 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240206 17:05:50.947006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240206 17:05:51.947006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240206 17:05:52.947006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.295 ms                  | 36.793 ms                 |
| ProcessBack:UpdateCache   | 9.695 ms                  | 15.438 ms                 |
| ProcessBack:UpsertPq      | 33.724 ms                 | 84.641 ms                 |
| ProcessOneStep            | 55.889 ms                 | 116.800 ms                |
| BlockToStepN              | 89.265 ms                 | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.340 ms                  | 113.775 ms                |
| Forward                   | 5.005 ms                  | 11.260 ms                 |
| Backward                  | 11.114 ms                 | 16.614 ms                 |
| Optimize                  | 2.769 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 4.788 ms                  | 223.962 ms                |
| AfterBackward             | 55.661 ms                 | 116.837 ms                |
| BlockToStepN              | 364.959 ms                | 828.151 ms                |
| OneStep                   | 451.715 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:53.947005 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240206 17:05:54.947008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240206 17:05:56.033308 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240206 17:05:57.053583 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.240 ms                  | 36.793 ms                 |
| ProcessBack:UpdateCache   | 9.760 ms                  | 15.438 ms                 |
| ProcessBack:UpsertPq      | 33.878 ms                 | 84.641 ms                 |
| ProcessOneStep            | 56.197 ms                 | 116.800 ms                |
| BlockToStepN              | 364.908 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:58.282491 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.082 ms                  | 113.775 ms                |
| Forward                   | 4.997 ms                  | 11.260 ms                 |
| Backward                  | 11.100 ms                 | 16.614 ms                 |
| Optimize                  | 2.769 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 5.236 ms                  | 223.962 ms                |
| AfterBackward             | 56.274 ms                 | 116.837 ms                |
| BlockToStepN              | 103.847 ms                | 828.151 ms                |
| OneStep                   | 223.516 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:05:59.304597 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240206 17:06:00.304006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240206 17:06:01.364753 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240206 17:06:02.396262 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.225 ms                  | 36.793 ms                 |
| ProcessBack:UpdateCache   | 9.841 ms                  | 15.438 ms                 |
| ProcessBack:UpsertPq      | 33.943 ms                 | 84.641 ms                 |
| ProcessOneStep            | 56.253 ms                 | 116.800 ms                |
| BlockToStepN              | 103.796 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:03.432793 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.082 ms                  | 113.775 ms                |
| Forward                   | 4.997 ms                  | 11.697 ms                 |
| Backward                  | 11.081 ms                 | 16.614 ms                 |
| Optimize                  | 2.765 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 5.514 ms                  | 223.962 ms                |
| AfterBackward             | 56.284 ms                 | 116.837 ms                |
| BlockToStepN              | 103.847 ms                | 828.151 ms                |
| OneStep                   | 223.516 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:04.524808 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240206 17:06:05.524008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240206 17:06:06.524008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=182, pq.top=182
W20240206 17:06:07.524008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.237 ms                  | 33.822 ms                 |
| ProcessBack:UpdateCache   | 9.925 ms                  | 14.925 ms                 |
| ProcessBack:UpsertPq      | 34.075 ms                 | 82.983 ms                 |
| ProcessOneStep            | 56.451 ms                 | 116.800 ms                |
| BlockToStepN              | 117.063 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:08.524005 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.340 ms                  | 113.775 ms                |
| Forward                   | 5.005 ms                  | 11.697 ms                 |
| Backward                  | 11.051 ms                 | 16.614 ms                 |
| Optimize                  | 2.730 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 5.836 ms                  | 223.962 ms                |
| AfterBackward             | 56.486 ms                 | 116.837 ms                |
| BlockToStepN              | 117.113 ms                | 828.151 ms                |
| OneStep                   | 230.819 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:09.524008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240206 17:06:10.524008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240206 17:06:11.524008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240206 17:06:12.524010 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.261 ms                  | 33.822 ms                 |
| ProcessBack:UpdateCache   | 10.003 ms                 | 14.925 ms                 |
| ProcessBack:UpsertPq      | 34.269 ms                 | 82.983 ms                 |
| ProcessOneStep            | 56.651 ms                 | 116.800 ms                |
| BlockToStepN              | 364.908 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:13.524009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 113.775 ms                |
| Forward                   | 5.002 ms                  | 11.697 ms                 |
| Backward                  | 11.007 ms                 | 16.614 ms                 |
| Optimize                  | 2.733 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 5.836 ms                  | 223.962 ms                |
| AfterBackward             | 56.686 ms                 | 116.837 ms                |
| BlockToStepN              | 132.681 ms                | 828.151 ms                |
| OneStep                   | 230.819 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:14.524009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240206 17:06:15.524008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 2] 200 steps, total: 52.171, sample: 2.233, forward: 0.458, backward: 1.065, update: 0.230
[proc 3] 200 steps, total: 52.171, sample: 1.752, forward: 0.550, backward: 1.114, update: 0.285
[proc 5] 200 steps, total: 52.171, sample: 1.816, forward: 0.591, backward: 1.022, update: 0.267
[proc 7] 200 steps, total: 52.171, sample: 1.229, forward: 0.543, backward: 1.169, update: 0.268
[proc 6] 200 steps, total: 52.171, sample: 1.574, forward: 0.575, backward: 1.163, update: 0.282
[proc 4] 200 steps, total: 52.171, sample: 1.816, forward: 0.626, backward: 1.076, update: 0.266
[proc 1] 200 steps, total: 52.171, sample: 2.527, forward: 0.520, backward: 1.111, update: 0.260
[proc 0] 200 steps, total: 52.171, sample: 1.685, forward: 0.542, backward: 0.810, update: 0.324
W20240206 17:06:16.524008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240206 17:06:17.524008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.261 ms                  | 33.822 ms                 |
| ProcessBack:UpdateCache   | 10.189 ms                 | 14.925 ms                 |
| ProcessBack:UpsertPq      | 34.172 ms                 | 82.983 ms                 |
| ProcessOneStep            | 56.451 ms                 | 116.800 ms                |
| BlockToStepN              | 141.174 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:18.563123 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.376 ms                  | 113.775 ms                |
| Forward                   | 4.997 ms                  | 11.697 ms                 |
| Backward                  | 10.993 ms                 | 16.614 ms                 |
| Optimize                  | 2.733 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 5.836 ms                  | 223.962 ms                |
| AfterBackward             | 56.486 ms                 | 116.837 ms                |
| BlockToStepN              | 151.176 ms                | 828.151 ms                |
| OneStep                   | 230.819 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:19.563009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240206 17:06:20.563007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
W20240206 17:06:21.635661 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240206 17:06:22.635010 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.263 ms                  | 33.822 ms                 |
| ProcessBack:UpdateCache   | 10.280 ms                 | 14.925 ms                 |
| ProcessBack:UpsertPq      | 34.217 ms                 | 82.983 ms                 |
| ProcessOneStep            | 56.679 ms                 | 116.800 ms                |
| BlockToStepN              | 151.127 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:23.635006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.355 ms                  | 113.775 ms                |
| Forward                   | 4.997 ms                  | 11.697 ms                 |
| Backward                  | 10.974 ms                 | 16.614 ms                 |
| Optimize                  | 2.730 ms                  | 9.231 ms                  |
| BarrierTimeBeforeRank0    | 5.655 ms                  | 223.962 ms                |
| AfterBackward             | 56.712 ms                 | 116.837 ms                |
| BlockToStepN              | 364.959 ms                | 828.151 ms                |
| OneStep                   | 451.715 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:24.635008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240206 17:06:25.635008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240206 17:06:26.635007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
W20240206 17:06:27.635007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.269 ms                  | 33.822 ms                 |
| ProcessBack:UpdateCache   | 10.403 ms                 | 14.925 ms                 |
| ProcessBack:UpsertPq      | 34.217 ms                 | 82.983 ms                 |
| ProcessOneStep            | 56.885 ms                 | 116.800 ms                |
| BlockToStepN              | 151.127 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:28.635008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.355 ms                  | 113.775 ms                |
| Forward                   | 5.005 ms                  | 11.697 ms                 |
| Backward                  | 10.953 ms                 | 16.614 ms                 |
| Optimize                  | 2.730 ms                  | 9.342 ms                  |
| BarrierTimeBeforeRank0    | 6.168 ms                  | 223.962 ms                |
| AfterBackward             | 57.164 ms                 | 116.837 ms                |
| BlockToStepN              | 151.176 ms                | 828.151 ms                |
| OneStep                   | 238.558 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:29.697060 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240206 17:06:30.697008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=226, pq.top=226
W20240206 17:06:31.743710 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240206 17:06:32.743009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.289 ms                  | 33.196 ms                 |
| ProcessBack:UpdateCache   | 10.542 ms                 | 14.783 ms                 |
| ProcessBack:UpsertPq      | 34.415 ms                 | 82.983 ms                 |
| ProcessOneStep            | 57.252 ms                 | 116.800 ms                |
| BlockToStepN              | 364.908 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:33.743009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.340 ms                  | 113.775 ms                |
| Forward                   | 4.997 ms                  | 11.697 ms                 |
| Backward                  | 10.926 ms                 | 16.614 ms                 |
| Optimize                  | 2.733 ms                  | 9.342 ms                  |
| BarrierTimeBeforeRank0    | 6.053 ms                  | 223.962 ms                |
| AfterBackward             | 57.599 ms                 | 116.837 ms                |
| BlockToStepN              | 153.370 ms                | 828.151 ms                |
| OneStep                   | 271.884 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:34.743009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240206 17:06:35.743009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240206 17:06:36.743009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240206 17:06:37.743007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.305 ms                  | 33.196 ms                 |
| ProcessBack:UpdateCache   | 10.594 ms                 | 14.783 ms                 |
| ProcessBack:UpsertPq      | 34.553 ms                 | 82.983 ms                 |
| ProcessOneStep            | 57.742 ms                 | 116.800 ms                |
| BlockToStepN              | 160.306 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:38.806435 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.355 ms                  | 113.775 ms                |
| Forward                   | 5.003 ms                  | 11.697 ms                 |
| Backward                  | 10.844 ms                 | 16.614 ms                 |
| Optimize                  | 2.730 ms                  | 9.393 ms                  |
| BarrierTimeBeforeRank0    | 5.928 ms                  | 223.962 ms                |
| AfterBackward             | 57.828 ms                 | 116.837 ms                |
| BlockToStepN              | 160.363 ms                | 828.151 ms                |
| OneStep                   | 271.884 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:39.806008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240206 17:06:40.877880 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=244, pq.top=244
W20240206 17:06:41.877009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240206 17:06:42.877010 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.306 ms                  | 33.196 ms                 |
| ProcessBack:UpdateCache   | 10.473 ms                 | 14.783 ms                 |
| ProcessBack:UpsertPq      | 34.589 ms                 | 82.983 ms                 |
| ProcessOneStep            | 57.835 ms                 | 116.800 ms                |
| BlockToStepN              | 172.326 ms                | 828.048 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.404 ms                  | 113.775 ms                |
| Forward                   | 5.028 ms                  | 11.697 ms                 |
| Backward                  | 10.926 ms                 | 16.614 ms                 |
| Optimize                  | 2.725 ms                  | 9.393 ms                  |
| BarrierTimeBeforeRank0    | 5.655 ms                  | 223.962 ms                |
| AfterBackward             | 58.150 ms                 | 116.837 ms                |
| BlockToStepN              | 172.381 ms                | 828.151 ms                |
| OneStep                   | 274.435 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:43.877005 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240206 17:06:44.877008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240206 17:06:45.877007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
W20240206 17:06:46.946718 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240206 17:06:47.946008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=256, pq.top=256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.315 ms                  | 33.196 ms                 |
| ProcessBack:UpdateCache   | 10.473 ms                 | 14.783 ms                 |
| ProcessBack:UpsertPq      | 34.735 ms                 | 82.983 ms                 |
| ProcessOneStep            | 58.300 ms                 | 105.782 ms                |
| BlockToStepN              | 172.326 ms                | 827.278 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.435 ms                  | 109.822 ms                |
| Forward                   | 5.036 ms                  | 11.261 ms                 |
| Backward                  | 10.953 ms                 | 16.614 ms                 |
| Optimize                  | 2.725 ms                  | 9.342 ms                  |
| BarrierTimeBeforeRank0    | 5.836 ms                  | 213.454 ms                |
| AfterBackward             | 58.332 ms                 | 105.816 ms                |
| BlockToStepN              | 172.381 ms                | 827.414 ms                |
| OneStep                   | 274.435 ms                | 1.203 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:48.946007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240206 17:06:49.946007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240206 17:06:50.946009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240206 17:06:51.946008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240206 17:06:52.946012 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.320 ms                  | 33.196 ms                 |
| ProcessBack:UpdateCache   | 10.352 ms                 | 14.783 ms                 |
| ProcessBack:UpsertPq      | 34.735 ms                 | 82.983 ms                 |
| ProcessOneStep            | 58.300 ms                 | 105.782 ms                |
| BlockToStepN              | 177.481 ms                | 827.278 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.435 ms                  | 109.822 ms                |
| Forward                   | 5.036 ms                  | 11.261 ms                 |
| Backward                  | 10.974 ms                 | 16.614 ms                 |
| Optimize                  | 2.662 ms                  | 9.342 ms                  |
| BarrierTimeBeforeRank0    | 5.514 ms                  | 213.454 ms                |
| AfterBackward             | 58.332 ms                 | 105.816 ms                |
| BlockToStepN              | 180.217 ms                | 827.414 ms                |
| OneStep                   | 274.435 ms                | 1.203 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:53.946009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240206 17:06:54.946008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240206 17:06:55.949005 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
W20240206 17:06:56.948009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=272, pq.top=272
W20240206 17:06:57.948010 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.326 ms                  | 33.196 ms                 |
| ProcessBack:UpdateCache   | 10.254 ms                 | 14.783 ms                 |
| ProcessBack:UpsertPq      | 34.735 ms                 | 82.983 ms                 |
| ProcessOneStep            | 58.300 ms                 | 105.782 ms                |
| BlockToStepN              | 364.908 ms                | 827.278 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.469 ms                  | 109.822 ms                |
| Forward                   | 5.005 ms                  | 11.261 ms                 |
| Backward                  | 10.980 ms                 | 16.614 ms                 |
| Optimize                  | 2.662 ms                  | 9.342 ms                  |
| BarrierTimeBeforeRank0    | 5.236 ms                  | 213.454 ms                |
| AfterBackward             | 58.339 ms                 | 105.816 ms                |
| BlockToStepN              | 200.654 ms                | 827.414 ms                |
| OneStep                   | 283.665 ms                | 1.203 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:06:58.948006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240206 17:06:59.948009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240206 17:07:00.948007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240206 17:07:01.948009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240206 17:07:02.948007 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.326 ms                  | 28.181 ms                 |
| ProcessBack:UpdateCache   | 10.228 ms                 | 14.226 ms                 |
| ProcessBack:UpsertPq      | 34.735 ms                 | 76.985 ms                 |
| ProcessOneStep            | 58.353 ms                 | 105.782 ms                |
| BlockToStepN              | 200.559 ms                | 827.278 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.469 ms                  | 109.822 ms                |
| Forward                   | 5.005 ms                  | 11.261 ms                 |
| Backward                  | 10.997 ms                 | 16.614 ms                 |
| Optimize                  | 2.662 ms                  | 9.342 ms                  |
| BarrierTimeBeforeRank0    | 4.994 ms                  | 213.454 ms                |
| AfterBackward             | 58.388 ms                 | 105.816 ms                |
| BlockToStepN              | 364.959 ms                | 827.414 ms                |
| OneStep                   | 451.715 ms                | 1.203 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 17:07:03.948006 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
W20240206 17:07:05.054447 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
W20240206 17:07:06.054009 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240206 17:07:07.054008 64870 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
Successfully xmh. training takes 155.6412341594696 seconds
before call kg_cache_controller.StopThreads()
W20240206 17:07:07.571082 64870 grad_async_v1.h:243] call StopThreads. PID = 63305
W20240206 17:07:07.571108 64870 grad_base.h:212] before processOneStepNegThread_.join();
W20240206 17:07:07.575330 64870 grad_base.h:214] after processOneStepNegThread_.join();
W20240206 17:07:07.575340 64870 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240206 17:07:07.587404 64870 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.327 ms                  | 28.181 ms                 |
| ProcessBack:UpdateCache   | 10.067 ms                 | 14.226 ms                 |
| ProcessBack:UpsertPq      | 34.797 ms                 | 76.985 ms                 |
| ProcessOneStep            | 58.541 ms                 | 105.782 ms                |
| BlockToStepN              | 200.559 ms                | 827.278 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.474 ms                  | 109.822 ms                |
| Forward                   | 5.029 ms                  | 11.261 ms                 |
| Backward                  | 11.003 ms                 | 16.614 ms                 |
| Optimize                  | 2.662 ms                  | 9.342 ms                  |
| BarrierTimeBeforeRank0    | 5.087 ms                  | 213.454 ms                |
| AfterBackward             | 58.585 ms                 | 105.816 ms                |
| BlockToStepN              | 200.654 ms                | 827.414 ms                |
| OneStep                   | 302.728 ms                | 1.203 s                   |
+---------------------------+---------------------------+---------------------------+
