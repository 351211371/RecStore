WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 09:01:02.933429 43900 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_140', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [43900 sampler.py:454] Start PreSampling
WARNING [43900 sampler.py:532] Before construct renumbering_dict
WARNING [43900 sampler.py:555] PreSampling done
W20240206 09:20:26.940033 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 09:20:26.940230 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 09:20:26.940274 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 09:20:26.940308 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 09:20:26.940342 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 09:20:26.940385 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 09:20:26.940419 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 09:20:26.940466 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 09:20:26.940495 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 09:20:26.940531 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 09:20:26.940569 43900 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 09:20:26.940598 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 09:20:26.940626 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 09:20:26.940778 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 09:20:26.940819 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 09:20:26.940855 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 09:20:26.940904 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 09:20:26.940938 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 09:20:26.940975 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 09:20:26.941009 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 09:20:26.941049 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 09:20:26.941085 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 09:20:26.941113 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 09:20:26.941143 43900 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 09:20:26.941165 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 09:20:26.941195 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 09:20:26.941258 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 09:20:26.941290 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 09:20:26.941324 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 09:20:26.941350 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 09:20:26.941382 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 09:20:26.941416 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 09:20:26.941447 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 09:20:26.941478 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 09:20:26.941504 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 09:20:26.941537 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 09:20:26.941565 43900 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 09:20:26.941587 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 09:20:26.941609 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 09:20:26.941673 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 09:20:26.941709 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 09:20:26.941743 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 09:20:26.941772 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 09:20:26.941808 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 09:20:26.941836 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 09:20:26.941864 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 09:20:26.941898 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 09:20:26.941932 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 09:20:26.941959 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 09:20:26.941988 43900 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 09:20:26.942010 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 09:20:26.942040 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 09:20:26.942098 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 09:20:26.942138 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 09:20:26.942169 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 09:20:26.942196 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 09:20:26.942224 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 09:20:26.942257 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 09:20:26.942292 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 09:20:26.942332 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 09:20:26.942359 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 09:20:26.942394 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 09:20:26.942428 43900 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 09:20:26.942451 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 09:20:26.942474 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 09:20:26.942528 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 09:20:26.942560 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 09:20:26.942588 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 09:20:26.942623 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 09:20:26.942651 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 09:20:26.942682 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 09:20:26.942718 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 09:20:26.942747 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 09:20:26.942780 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 09:20:26.942821 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 09:20:26.942853 43900 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 09:20:26.942878 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 09:20:26.942901 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 09:20:26.942948 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 09:20:26.942982 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 09:20:26.943010 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 09:20:26.943045 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 09:20:26.943073 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 09:20:26.943105 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 09:20:26.943141 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 09:20:26.943172 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 09:20:26.943207 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 09:20:26.943240 43900 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 09:20:26.943274 43900 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 09:20:26.943298 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 09:20:26.943327 43900 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 09:20:27.406059 43900 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000216be000 128.2 GB
W20240206 09:29:03.080595 43900 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020302f6000 328.3 MB
{0: Graph(num_nodes=15380073, num_edges=42467395,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=16359015, num_edges=65830196,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16649310, num_edges=43584356,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=13918614, num_edges=50952482,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14713191, num_edges=52450022,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14150782, num_edges=58077216,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=21311359, num_edges=64967677,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 15380073 N 42467395 E
MertisPartition: part 1 has 16359015 N 65830196 E
MertisPartition: part 2 has 16649310 N 43584356 E
MertisPartition: part 3 has 13918614 N 50952482 E
MertisPartition: part 4 has 14713191 N 52450022 E
MertisPartition: part 5 has 14150782 N 58077216 E
MertisPartition: part 6 has 21311359 N 64967677 E
Rank0: cached key size 614672
Rank1: cached key size 614672
Rank2: cached key size 614672
Rank3: cached key size 614672
Rank4: cached key size 614672
Rank5: cached key size 614672
Rank6: cached key size 614672
Before renumbering graph:  {'_ID': tensor([     239,      240,      329,  ..., 86019793, 84488282, 82976992]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4310254,  4310288,  4313452,  ..., 78531109, 37560468, 69535134]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2185.151 seconds
[Rank1] pid = 45006
[Rank2] pid = 45100
[Rank3] pid = 45169
[Rank4] pid = 45236
[Rank5] pid = 45304
INFO [43900 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [45006 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [45100 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [45169 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [45236 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [45371 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [45304 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [45371 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [45304 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [45169 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [45236 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [45100 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [45006 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
WARNING [45371 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [45304 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [45236 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [45100 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [45169 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [43900 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
WARNING [45006 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [43900 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 09:37:37.571151 45372 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240206 09:37:37.571321 45101 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 09:37:37.571481 45435 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 09:37:37.571647 45007 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 09:37:37.571806 45170 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 09:37:37.571959 45237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 09:37:37.572125 45305 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
E20240206 09:37:38.277104 45435 recstore.cc:66] init folly done
E20240206 09:37:38.277125 45007 recstore.cc:66] init folly done
E20240206 09:37:38.277143 45170 recstore.cc:66] init folly done
E20240206 09:37:38.277151 45237 recstore.cc:66] init folly done
E20240206 09:37:38.277161 45101 recstore.cc:66] init folly done
E20240206 09:37:38.277161 45305 recstore.cc:66] init folly done
E20240206 09:37:38.277181 45372 recstore.cc:66] init folly done
I20240206 09:37:44.630550 45372 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240206 09:37:44.799521 45101 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 09:37:46.139885 45237 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 09:37:46.306354 45170 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 09:37:46.464646 45305 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 09:37:47.955848 45435 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 09:37:48.043231 45007 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.350 ms                  | 104.324 ms                |
| Forward                   | 10.698 ms                 | 606.545 ms                |
| Backward                  | 212.180 ms                | 389.812 ms                |
| Optimize                  | 2.527 ms                  | 4.455 ms                  |
| BarrierTimeBeforeRank0    | 79.158 ms                 | 209.858 ms                |
| BlockToStepN              | 25.158 us                 | 4.068 ms                  |
| OneStep                   | 306.576 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.380 ms                  | 104.324 ms                |
| Forward                   | 10.606 ms                 | 606.545 ms                |
| Backward                  | 209.549 ms                | 389.812 ms                |
| Optimize                  | 2.374 ms                  | 5.228 ms                  |
| BarrierTimeBeforeRank0    | 68.636 ms                 | 209.858 ms                |
| BlockToStepN              | 27.885 us                 | 19.723 ms                 |
| OneStep                   | 298.747 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.983 ms                  | 104.324 ms                |
| Forward                   | 10.325 ms                 | 606.545 ms                |
| Backward                  | 211.467 ms                | 389.812 ms                |
| Optimize                  | 2.322 ms                  | 5.228 ms                  |
| BarrierTimeBeforeRank0    | 46.299 ms                 | 209.858 ms                |
| BlockToStepN              | 27.897 us                 | 19.723 ms                 |
| OneStep                   | 283.770 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.029 ms                  | 103.873 ms                |
| Forward                   | 10.325 ms                 | 32.872 ms                 |
| Backward                  | 209.751 ms                | 236.109 ms                |
| Optimize                  | 2.329 ms                  | 4.455 ms                  |
| BarrierTimeBeforeRank0    | 39.268 ms                 | 209.858 ms                |
| BlockToStepN              | 29.469 us                 | 7.897 ms                  |
| OneStep                   | 280.300 ms                | 549.189 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.611 ms                  | 103.873 ms                |
| Forward                   | 10.325 ms                 | 32.872 ms                 |
| Backward                  | 209.751 ms                | 389.812 ms                |
| Optimize                  | 2.367 ms                  | 5.228 ms                  |
| BarrierTimeBeforeRank0    | 37.946 ms                 | 209.858 ms                |
| BlockToStepN              | 30.738 us                 | 7.897 ms                  |
| OneStep                   | 277.703 ms                | 549.189 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.580 ms                  | 103.873 ms                |
| Forward                   | 10.325 ms                 | 32.872 ms                 |
| Backward                  | 209.549 ms                | 389.812 ms                |
| Optimize                  | 2.479 ms                  | 7.531 ms                  |
| BarrierTimeBeforeRank0    | 39.960 ms                 | 209.858 ms                |
| BlockToStepN              | 30.738 us                 | 7.897 ms                  |
| OneStep                   | 279.113 ms                | 549.189 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 32.093, sample: 1.650, forward: 2.720, backward: 22.291, update: 0.402
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 30.189, sample: 1.355, forward: 2.740, backward: 22.655, update: 0.418
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 33.433, sample: 1.126, forward: 2.728, backward: 22.497, update: 0.341
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 31.926, sample: 1.461, forward: 2.596, backward: 21.942, update: 0.351
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 30.277, sample: 1.241, forward: 2.623, backward: 19.858, update: 0.396
[Rank6] pid = 45371
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 4313485,   309992,   310037,   310066,   334110,   400854, 26698484,
          334131,   334160,    33949]) tensor([12243976, 31772947, 72433890, 58219306, 63170917, 42541347, 38564378,
        41289356, 76629718, 47319276])
-------Step 1-------
tensor([ 4313485,   309992,   310037,   310066,   334110,   400854, 26698484,
          334131,   334160,    33949]) tensor([43636568, 17410858, 21691978, 12903637, 55192478, 37948155, 72791781,
        19960501, 19074320, 35285462])
-------Step 2-------
tensor([  390825,   321867,   390845,   390870,   390899, 26698952,   413081,
          390918,   413101,   390945]) tensor([33661678,  6537058, 72358632,  1572521, 69591038, 17895723, 72907467,
           23504, 43374908, 76121144])
-------Step 3-------
tensor([  390825,   321867,   390845,   390870,   390899, 26698952,   413081,
          390918,   413101,   390945]) tensor([40858029, 12946749, 26850029,     6284, 53230157, 66063388, 69884669,
        74521347, 53112524, 67928037])
-------Step 4-------
tensor([  425467,   333280,   449552,   425490, 26698484,   255193,   333322,
        37457865,   449573,  4750192]) tensor([83799655, 63374336, 42355256, 12678276, 52003289, 35682346, 11751772,
        57868099, 75249724, 31688010])
-------Step 5-------
tensor([  425467,   333280,   449552,   425490, 26698484,   255193,   333322,
        37457865,   449573,  4750192]) tensor([43496869, 29074341,  9841932, 56058747, 67029447, 53974406,  9618052,
        84390243, 80673216, 79254550])
-------Step 6-------
tensor([ 516670, 4313485,    3936,    3989,   96263,  342952,    4026,    4068,
           4120,    4183]) tensor([49057230, 21811685, 67214287, 49501042, 77849777, 44070580, 39675927,
        49924727, 13803854, 68930692])
-------Step 7-------
tensor([ 516670, 4313485,    3936,    3989,   96263,  342952,    4026,    4068,
           4120,    4183]) tensor([42148366,  5053662, 81319630, 49900490, 84764900, 55800219,  5693435,
        15218927, 29411491,  4617272])
-------Step 8-------
tensor([  517504,   100979,   101025,   101062, 68310703,  4313485,   101111,
         4731330,   451325,   101154]) tensor([70393252, 11903666, 59692776, 82251300, 41240114, 59872680,  4961345,
        27608402, 30787554,   251981])
-------Step 9-------
tensor([  517504,   100979,   101025,   101062, 68310703,  4313485,   101111,
         4731330,   451325,   101154]) tensor([22662689, 18865612, 75438469, 40832731, 37088395, 16496273, 45628429,
        15049135, 57462518, 61463269])
before start barrier
start train
[proc 0] 100 steps, total: 33.602, sample: 1.299, forward: 1.682, backward: 21.593, update: 0.284
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 31.768, sample: 1.880, forward: 2.924, backward: 23.750, update: 0.361
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.611 ms                  | 103.873 ms                |
| Forward                   | 10.250 ms                 | 32.872 ms                 |
| Backward                  | 211.459 ms                | 389.812 ms                |
| Optimize                  | 2.532 ms                  | 7.531 ms                  |
| BarrierTimeBeforeRank0    | 46.299 ms                 | 209.858 ms                |
| BlockToStepN              | 31.424 us                 | 7.897 ms                  |
| OneStep                   | 281.525 ms                | 549.189 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.656 ms                  | 103.873 ms                |
| Forward                   | 10.239 ms                 | 32.872 ms                 |
| Backward                  | 212.090 ms                | 389.812 ms                |
| Optimize                  | 2.622 ms                  | 7.531 ms                  |
| BarrierTimeBeforeRank0    | 52.905 ms                 | 209.858 ms                |
| BlockToStepN              | 30.738 us                 | 7.897 ms                  |
| OneStep                   | 286.692 ms                | 549.189 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.276 ms                  | 103.873 ms                |
| Forward                   | 10.238 ms                 | 32.872 ms                 |
| Backward                  | 212.620 ms                | 389.812 ms                |
| Optimize                  | 3.320 ms                  | 7.531 ms                  |
| BarrierTimeBeforeRank0    | 57.211 ms                 | 235.235 ms                |
| BlockToStepN              | 30.736 us                 | 19.040 ms                 |
| OneStep                   | 293.208 ms                | 549.189 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.258 ms                  | 93.388 ms                 |
| Forward                   | 10.239 ms                 | 22.547 ms                 |
| Backward                  | 213.521 ms                | 382.256 ms                |
| Optimize                  | 3.782 ms                  | 7.531 ms                  |
| BarrierTimeBeforeRank0    | 60.204 ms                 | 209.858 ms                |
| BlockToStepN              | 30.707 us                 | 19.040 ms                 |
| OneStep                   | 297.040 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.323 ms                  | 93.388 ms                 |
| Forward                   | 10.239 ms                 | 22.547 ms                 |
| Backward                  | 213.995 ms                | 382.256 ms                |
| Optimize                  | 3.844 ms                  | 7.531 ms                  |
| BarrierTimeBeforeRank0    | 62.361 ms                 | 209.858 ms                |
| BlockToStepN              | 30.738 us                 | 19.040 ms                 |
| OneStep                   | 299.068 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.258 ms                  | 93.388 ms                 |
| Forward                   | 10.220 ms                 | 22.547 ms                 |
| Backward                  | 214.692 ms                | 382.256 ms                |
| Optimize                  | 3.845 ms                  | 7.531 ms                  |
| BarrierTimeBeforeRank0    | 63.774 ms                 | 235.235 ms                |
| BlockToStepN              | 30.900 us                 | 19.040 ms                 |
| OneStep                   | 300.077 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 200 steps, total: 32.557, sample: 1.222, forward: 1.734, backward: 24.731, update: 0.390
[proc 6] 200 steps, total: 32.557, sample: 1.159, forward: 1.739, backward: 23.880, update: 0.399
[proc 5] 200 steps, total: 32.557, sample: 1.764, forward: 1.962, backward: 24.993, update: 0.345
[proc 3] 200 steps, total: 32.557, sample: 1.182, forward: 1.688, backward: 23.348, update: 0.389
[proc 0] 200 steps, total: 32.557, sample: 1.160, forward: 1.019, backward: 22.458, update: 0.396
[proc 2] 200 steps, total: 32.557, sample: 1.162, forward: 1.879, backward: 24.085, update: 0.356
[proc 1] 200 steps, total: 32.557, sample: 1.668, forward: 2.046, backward: 26.793, update: 0.446
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.107 ms                  | 93.388 ms                 |
| Forward                   | 10.218 ms                 | 22.547 ms                 |
| Backward                  | 216.919 ms                | 389.812 ms                |
| Optimize                  | 4.211 ms                  | 7.577 ms                  |
| BarrierTimeBeforeRank0    | 62.361 ms                 | 235.235 ms                |
| BlockToStepN              | 30.981 us                 | 19.040 ms                 |
| OneStep                   | 302.206 ms                | 535.220 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.134 ms                  | 93.388 ms                 |
| Forward                   | 10.226 ms                 | 22.547 ms                 |
| Backward                  | 217.518 ms                | 389.812 ms                |
| Optimize                  | 4.241 ms                  | 7.783 ms                  |
| BarrierTimeBeforeRank0    | 59.137 ms                 | 235.235 ms                |
| BlockToStepN              | 30.907 us                 | 19.040 ms                 |
| OneStep                   | 299.068 ms                | 535.220 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.174 ms                  | 93.388 ms                 |
| Forward                   | 10.216 ms                 | 22.547 ms                 |
| Backward                  | 217.518 ms                | 389.812 ms                |
| Optimize                  | 4.211 ms                  | 7.783 ms                  |
| BarrierTimeBeforeRank0    | 56.025 ms                 | 235.235 ms                |
| BlockToStepN              | 30.926 us                 | 19.040 ms                 |
| OneStep                   | 297.190 ms                | 535.220 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.107 ms                  | 90.432 ms                 |
| Forward                   | 10.226 ms                 | 18.637 ms                 |
| Backward                  | 219.319 ms                | 382.256 ms                |
| Optimize                  | 4.208 ms                  | 7.577 ms                  |
| BarrierTimeBeforeRank0    | 59.710 ms                 | 209.858 ms                |
| BlockToStepN              | 30.907 us                 | 7.897 ms                  |
| OneStep                   | 299.371 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.055 ms                  | 90.432 ms                 |
| Forward                   | 10.230 ms                 | 18.637 ms                 |
| Backward                  | 219.731 ms                | 382.256 ms                |
| Optimize                  | 4.233 ms                  | 7.577 ms                  |
| BarrierTimeBeforeRank0    | 60.237 ms                 | 209.858 ms                |
| BlockToStepN              | 30.905 us                 | 19.040 ms                 |
| OneStep                   | 302.206 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.984 ms                  | 90.432 ms                 |
| Forward                   | 10.226 ms                 | 18.637 ms                 |
| Backward                  | 220.876 ms                | 382.256 ms                |
| Optimize                  | 4.248 ms                  | 7.577 ms                  |
| BarrierTimeBeforeRank0    | 61.195 ms                 | 209.858 ms                |
| BlockToStepN              | 30.926 us                 | 19.723 ms                 |
| OneStep                   | 304.534 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 300 steps, total: 31.760, sample: 1.323, forward: 2.256, backward: 26.877, update: 0.292
[proc 4] 300 steps, total: 31.761, sample: 1.050, forward: 1.719, backward: 24.187, update: 0.404
[proc 1] 300 steps, total: 31.760, sample: 1.001, forward: 1.736, backward: 22.485, update: 0.413
[proc 2] 300 steps, total: 31.760, sample: 0.911, forward: 1.752, backward: 22.948, update: 0.418
[proc 6] 300 steps, total: 31.761, sample: 1.062, forward: 1.644, backward: 23.380, update: 0.372
[proc 3] 300 steps, total: 31.761, sample: 0.944, forward: 1.673, backward: 22.468, update: 0.397
[proc 0] 300 steps, total: 31.761, sample: 1.042, forward: 1.038, backward: 22.976, update: 0.390
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.031 ms                  | 90.432 ms                 |
| Forward                   | 10.220 ms                 | 18.637 ms                 |
| Backward                  | 222.064 ms                | 382.256 ms                |
| Optimize                  | 4.261 ms                  | 7.577 ms                  |
| BarrierTimeBeforeRank0    | 63.672 ms                 | 234.333 ms                |
| BlockToStepN              | 30.843 us                 | 19.723 ms                 |
| OneStep                   | 305.680 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.984 ms                  | 90.432 ms                 |
| Forward                   | 10.218 ms                 | 18.637 ms                 |
| Backward                  | 222.749 ms                | 382.256 ms                |
| Optimize                  | 4.278 ms                  | 7.577 ms                  |
| BarrierTimeBeforeRank0    | 64.595 ms                 | 234.333 ms                |
| BlockToStepN              | 30.785 us                 | 19.723 ms                 |
| OneStep                   | 306.974 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.904 ms                  | 90.432 ms                 |
| Forward                   | 10.216 ms                 | 18.637 ms                 |
| Backward                  | 222.162 ms                | 382.256 ms                |
| Optimize                  | 4.284 ms                  | 7.783 ms                  |
| BarrierTimeBeforeRank0    | 64.818 ms                 | 234.333 ms                |
| BlockToStepN              | 30.785 us                 | 19.723 ms                 |
| OneStep                   | 307.361 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.839 ms                  | 93.388 ms                 |
| Forward                   | 10.220 ms                 | 18.637 ms                 |
| Backward                  | 222.976 ms                | 389.812 ms                |
| Optimize                  | 4.292 ms                  | 7.806 ms                  |
| BarrierTimeBeforeRank0    | 65.229 ms                 | 234.333 ms                |
| BlockToStepN              | 30.759 us                 | 19.723 ms                 |
| OneStep                   | 308.495 ms                | 519.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.860 ms                  | 90.432 ms                 |
| Forward                   | 10.237 ms                 | 16.028 ms                 |
| Backward                  | 222.155 ms                | 382.256 ms                |
| Optimize                  | 4.296 ms                  | 7.783 ms                  |
| BarrierTimeBeforeRank0    | 64.115 ms                 | 217.120 ms                |
| BlockToStepN              | 30.905 us                 | 19.040 ms                 |
| OneStep                   | 307.361 ms                | 505.389 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.851 ms                  | 90.432 ms                 |
| Forward                   | 10.238 ms                 | 16.028 ms                 |
| Backward                  | 222.155 ms                | 382.256 ms                |
| Optimize                  | 4.303 ms                  | 7.783 ms                  |
| BarrierTimeBeforeRank0    | 62.145 ms                 | 217.120 ms                |
| BlockToStepN              | 30.981 us                 | 19.040 ms                 |
| OneStep                   | 305.927 ms                | 505.389 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.766 ms                  | 90.432 ms                 |
| Forward                   | 10.239 ms                 | 18.637 ms                 |
| Backward                  | 222.976 ms                | 389.812 ms                |
| Optimize                  | 4.305 ms                  | 7.783 ms                  |
| BarrierTimeBeforeRank0    | 61.195 ms                 | 217.120 ms                |
| BlockToStepN              | 31.058 us                 | 19.723 ms                 |
| OneStep                   | 305.927 ms                | 505.389 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 400 steps, total: 31.325, sample: 1.054, forward: 1.881, backward: 24.407, update: 0.299
[proc 3] 400 steps, total: 31.325, sample: 0.954, forward: 1.812, backward: 22.251, update: 0.376
[proc 2] 400 steps, total: 31.325, sample: 1.065, forward: 1.864, backward: 23.897, update: 0.398
[proc 5] 400 steps, total: 31.325, sample: 1.272, forward: 2.159, backward: 25.517, update: 0.336
[proc 1] 400 steps, total: 31.325, sample: 1.089, forward: 1.913, backward: 23.451, update: 0.379
[proc 6] 400 steps, total: 31.325, sample: 1.039, forward: 1.911, backward: 23.703, update: 0.368
[proc 0] 400 steps, total: 31.325, sample: 1.002, forward: 1.080, backward: 22.712, update: 0.432
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.760 ms                  | 90.432 ms                 |
| Forward                   | 10.249 ms                 | 18.637 ms                 |
| Backward                  | 223.333 ms                | 389.812 ms                |
| Optimize                  | 4.313 ms                  | 7.806 ms                  |
| BarrierTimeBeforeRank0    | 59.710 ms                 | 217.120 ms                |
| BlockToStepN              | 31.294 us                 | 19.723 ms                 |
| OneStep                   | 304.534 ms                | 505.389 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.766 ms                  | 90.432 ms                 |
| Forward                   | 10.255 ms                 | 18.637 ms                 |
| Backward                  | 222.749 ms                | 389.812 ms                |
| Optimize                  | 4.317 ms                  | 7.806 ms                  |
| BarrierTimeBeforeRank0    | 58.311 ms                 | 217.120 ms                |
| BlockToStepN              | 31.533 us                 | 19.723 ms                 |
| OneStep                   | 303.722 ms                | 505.389 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.753 ms                  | 90.432 ms                 |
| Forward                   | 10.272 ms                 | 18.637 ms                 |
| Backward                  | 222.749 ms                | 389.812 ms                |
| Optimize                  | 4.322 ms                  | 7.806 ms                  |
| BarrierTimeBeforeRank0    | 57.211 ms                 | 217.120 ms                |
| BlockToStepN              | 31.572 us                 | 19.723 ms                 |
| OneStep                   | 300.751 ms                | 505.389 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.722 ms                  | 89.301 ms                 |
| Forward                   | 10.283 ms                 | 16.028 ms                 |
| Backward                  | 223.197 ms                | 382.256 ms                |
| Optimize                  | 4.323 ms                  | 7.783 ms                  |
| BarrierTimeBeforeRank0    | 57.525 ms                 | 209.858 ms                |
| BlockToStepN              | 31.510 us                 | 19.040 ms                 |
| OneStep                   | 303.315 ms                | 494.203 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.718 ms                  | 89.301 ms                 |
| Forward                   | 10.305 ms                 | 16.028 ms                 |
| Backward                  | 223.386 ms                | 382.256 ms                |
| Optimize                  | 4.328 ms                  | 7.783 ms                  |
| BarrierTimeBeforeRank0    | 58.311 ms                 | 209.858 ms                |
| BlockToStepN              | 31.425 us                 | 19.040 ms                 |
| OneStep                   | 304.473 ms                | 494.203 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 153.71419024467468 seconds
before call kg_cache_controller.StopThreads()
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
INFO [43900 controller_process.py:421] call rank0 to StopThreads
