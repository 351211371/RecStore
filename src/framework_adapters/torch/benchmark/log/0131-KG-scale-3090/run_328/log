WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240213 00:52:00.356753 49020 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_131', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='None', use_my_emb=False, cache_ratio=0.05, shuffle=False, backwardMode='CppSync', L=10, nr_background_threads=32, update_cache_use_omp=1, update_pq_use_omp=2, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [49020 sampler.py:454] Start PreSampling
WARNING [49020 sampler.py:532] Before construct renumbering_dict
WARNING [49020 sampler.py:555] PreSampling done
W20240213 00:52:05.696297 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240213 00:52:05.696477 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240213 00:52:05.696516 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240213 00:52:05.696553 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240213 00:52:05.696588 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240213 00:52:05.696620 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240213 00:52:05.696668 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240213 00:52:05.696712 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240213 00:52:05.696746 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240213 00:52:05.696777 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240213 00:52:05.696820 49020 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240213 00:52:05.696851 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240213 00:52:05.696884 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240213 00:52:05.697000 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240213 00:52:05.697041 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240213 00:52:05.697077 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240213 00:52:05.697132 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240213 00:52:05.697170 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240213 00:52:05.697216 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240213 00:52:05.697258 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240213 00:52:05.697288 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240213 00:52:05.697322 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240213 00:52:05.697360 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240213 00:52:05.697396 49020 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240213 00:52:05.697420 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240213 00:52:05.697446 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240213 00:52:05.697507 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240213 00:52:05.697546 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240213 00:52:05.697575 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240213 00:52:05.697609 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240213 00:52:05.697644 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240213 00:52:05.697683 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240213 00:52:05.697718 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240213 00:52:05.697753 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240213 00:52:05.697782 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240213 00:52:05.697821 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240213 00:52:05.697850 49020 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240213 00:52:05.697876 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240213 00:52:05.697901 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240213 00:52:05.697959 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240213 00:52:05.697995 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240213 00:52:05.698032 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240213 00:52:05.698062 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240213 00:52:05.698091 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240213 00:52:05.698129 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240213 00:52:05.698164 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240213 00:52:05.698194 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240213 00:52:05.698227 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240213 00:52:05.698261 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240213 00:52:05.698295 49020 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240213 00:52:05.698321 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240213 00:52:05.698347 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240213 00:52:05.698405 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240213 00:52:05.698436 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240213 00:52:05.698474 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240213 00:52:05.698504 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240213 00:52:05.698534 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240213 00:52:05.698576 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240213 00:52:05.698608 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240213 00:52:05.698649 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240213 00:52:05.698680 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240213 00:52:05.698715 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240213 00:52:05.698750 49020 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240213 00:52:05.698776 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240213 00:52:05.698801 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240213 00:52:05.698860 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240213 00:52:05.698900 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240213 00:52:05.698935 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240213 00:52:05.698976 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240213 00:52:05.699007 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240213 00:52:05.699043 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240213 00:52:05.699080 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240213 00:52:05.699116 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240213 00:52:05.699151 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240213 00:52:05.699185 49020 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240213 00:52:05.699219 49020 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240213 00:52:05.699244 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240213 00:52:05.699270 49020 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  830,   938,  1018,  ...,  2893,  2077, 10256]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.753 seconds
[Rank1] pid = 49225
[Rank2] pid = 49251
[Rank3] pid = 49347
[Rank4] pid = 49355
INFO [49020 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [49225 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [49355 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [49251 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [49020 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [49417 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [49347 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [49225 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [49347 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [49417 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [49251 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [49355 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
E20240213 00:52:08.424252 49483 recstore.cc:66] init folly done
E20240213 00:52:08.424396 49290 recstore.cc:66] init folly done
E20240213 00:52:08.424396 49419 recstore.cc:66] init folly done
E20240213 00:52:08.424422 49226 recstore.cc:66] init folly done
E20240213 00:52:08.424468 49354 recstore.cc:66] init folly done
E20240213 00:52:08.424489 49437 recstore.cc:66] init folly done
I20240213 00:52:08.493798 49483 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240213 00:52:08.496892 49354 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 00:52:08.498281 49226 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 00:52:08.498558 49290 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 00:52:08.501338 49419 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 00:52:08.503314 49437 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 3.491, sample: 0.415, forward: 1.192, backward: 0.852, update: 0.658
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 3.496, sample: 0.413, forward: 1.091, backward: 0.911, update: 0.722
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 3.488, sample: 0.407, forward: 1.127, backward: 0.831, update: 0.693
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 3.491, sample: 0.408, forward: 1.171, backward: 0.857, update: 0.666
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 3.493, sample: 0.411, forward: 1.097, backward: 0.836, update: 0.680
[Rank5] pid = 49417
train_sampler.Prefill()
-------Step 0-------
tensor([    9,  7086,  8994,   905, 11652,  7138,   120,  7549,  4550,  1662]) tensor([ 1018,   107,  5546,  6786,    20,  4847, 12075, 14811,  1590,  9614])
-------Step 1-------
tensor([    9,  7086,  8994,   905, 11652,  7138,   120,  7549,  4550,  1662]) tensor([ 5349,  1649,  9113,  2189,  2850,  7093, 13378,  7250, 13116, 14576])
-------Step 2-------
tensor([6080,   83,   58,    8, 8924, 3598, 9706, 8651, 5693, 2828]) tensor([ 6987,  2332,  1257,  6074,  4404,  9287, 12288,  7148,  7581,  7920])
-------Step 3-------
tensor([6080,   83,   58,    8, 8924, 3598, 9706, 8651, 5693, 2828]) tensor([11478, 10616,  5949,  6279, 10179,  8682, 14844,  7778,  9883, 14336])
-------Step 4-------
tensor([14615, 10017,  8716, 14063, 11214,  8275,    98,  9966, 11652,  9459]) tensor([10784,  2286,  7874,  1347,  2115,  2096, 14452, 13076,  6803,  3872])
-------Step 5-------
tensor([14615, 10017,  8716, 14063, 11214,  8275,    98,  9966, 11652,  9459]) tensor([ 3812, 14138,  9328,  9414, 13986,  4724,  3228, 11239, 14467,  7441])
-------Step 6-------
tensor([13546,  3619, 13660,   771, 10993, 11121,  8913, 14390,    84,  8436]) tensor([ 1368,  2131,  6836, 11737,  5232,  4207, 10926, 11526,  9126,  9020])
-------Step 7-------
tensor([13546,  3619, 13660,   771, 10993, 11121,  8913, 14390,    84,  8436]) tensor([ 9376,  1777,  6041, 12626,  5192,  9617,  6111,  8695,  2402, 11604])
-------Step 8-------
tensor([ 3832, 10923, 14358,  7789,  7836,  7625, 13004, 13055,  2117, 10357]) tensor([ 4358,  2923,  5876,  2995,  7763,  4798,  8099,  6171, 10605,  1925])
-------Step 9-------
tensor([ 3832, 10923, 14358,  7789,  7836,  7625, 13004, 13055,  2117, 10357]) tensor([ 1757,  7299,  8499,  7956,  5914, 12928,  1489,  1377, 13116,  5971])
before start barrier
start train
[proc 0] 100 steps, total: 3.486, sample: 0.404, forward: 1.155, backward: 0.676, update: 0.678
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.560 ms                  | 26.504 ms                 |
| Forward                   | 7.489 ms                  | 14.602 ms                 |
| Backward                  | 6.698 ms                  | 11.787 ms                 |
| Optimize                  | 6.430 ms                  | 15.016 ms                 |
| OneStep                   | 26.409 ms                 | 68.306 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 5] 200 steps, total: 3.227, sample: 0.476, forward: 0.750, backward: 0.599, update: 0.718
[proc 4] 200 steps, total: 3.227, sample: 0.464, forward: 0.782, backward: 0.508, update: 0.689
[proc 3] 200 steps, total: 3.227, sample: 0.476, forward: 0.748, backward: 0.683, update: 0.710
[proc 0] 200 steps, total: 3.227, sample: 0.485, forward: 0.800, backward: 0.692, update: 0.714
[proc 2] 200 steps, total: 3.227, sample: 0.519, forward: 0.774, backward: 0.673, update: 0.663
[proc 1] 200 steps, total: 3.227, sample: 0.484, forward: 0.822, backward: 0.683, update: 0.715
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.773 ms                  | 26.504 ms                 |
| Forward                   | 7.872 ms                  | 14.910 ms                 |
| Backward                  | 6.916 ms                  | 11.579 ms                 |
| Optimize                  | 6.753 ms                  | 15.170 ms                 |
| OneStep                   | 28.346 ms                 | 55.812 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 3.561, sample: 0.535, forward: 0.819, backward: 0.689, update: 0.729
[proc 4] 300 steps, total: 3.561, sample: 0.407, forward: 0.815, backward: 0.481, update: 0.670
[proc 5] 300 steps, total: 3.561, sample: 0.482, forward: 0.769, backward: 0.697, update: 0.734
[proc 3] 300 steps, total: 3.561, sample: 0.427, forward: 0.813, backward: 0.680, update: 0.739
[proc 0] 300 steps, total: 3.561, sample: 0.441, forward: 0.835, backward: 0.701, update: 0.743
[proc 2] 300 steps, total: 3.561, sample: 0.482, forward: 0.770, backward: 0.673, update: 0.720
[proc 3] 400 steps, total: 3.475, sample: 0.424, forward: 0.775, backward: 0.635, update: 0.729
[proc 1] 400 steps, total: 3.475, sample: 0.491, forward: 0.821, backward: 0.684, update: 0.726
[proc 4] 400 steps, total: 3.476, sample: 0.357, forward: 0.758, backward: 0.532, update: 0.607
[proc 2] 400 steps, total: 3.475, sample: 0.495, forward: 0.771, backward: 0.673, update: 0.707
[proc 0] 400 steps, total: 3.475, sample: 0.408, forward: 0.826, backward: 0.659, update: 0.711
[proc 5] 400 steps, total: 3.475, sample: 0.467, forward: 0.765, backward: 0.664, update: 0.733
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.832 ms                  | 27.215 ms                 |
| Forward                   | 7.967 ms                  | 15.640 ms                 |
| Backward                  | 6.912 ms                  | 11.546 ms                 |
| Optimize                  | 6.814 ms                  | 15.240 ms                 |
| OneStep                   | 29.689 ms                 | 55.812 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 5] 500 steps, total: 3.681, sample: 0.481, forward: 0.790, backward: 0.680, update: 0.748
[proc 4] 500 steps, total: 3.682, sample: 0.437, forward: 0.743, backward: 0.433, update: 0.598
[proc 1] 500 steps, total: 3.682, sample: 0.489, forward: 0.867, backward: 0.685, update: 0.728
[proc 3] 500 steps, total: 3.682, sample: 0.534, forward: 0.790, backward: 0.669, update: 0.763
[proc 0] 500 steps, total: 3.681, sample: 0.449, forward: 0.869, backward: 0.645, update: 0.724
[proc 2] 500 steps, total: 3.682, sample: 0.448, forward: 0.787, backward: 0.672, update: 0.718
Successfully xmh. training takes 17.431714057922363 seconds
before call kg_cache_controller.StopThreads()
KGCacheControllerWrapperDummy.StopThreads
