WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240213 03:08:02.141530 21063 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_69', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=1, update_pq_use_omp=2, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [21063 sampler.py:454] Start PreSampling
WARNING [21063 sampler.py:532] Before construct renumbering_dict
WARNING [21063 sampler.py:555] PreSampling done
W20240213 03:27:46.920500 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240213 03:27:46.920694 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240213 03:27:46.920733 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240213 03:27:46.920761 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240213 03:27:46.920797 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240213 03:27:46.920823 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240213 03:27:46.920857 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240213 03:27:46.920903 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240213 03:27:46.920941 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240213 03:27:46.920969 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240213 03:27:46.921003 21063 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240213 03:27:46.921031 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240213 03:27:46.921059 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240213 03:27:46.921205 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240213 03:27:46.921249 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240213 03:27:46.921275 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240213 03:27:46.921315 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240213 03:27:46.921348 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240213 03:27:46.921375 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240213 03:27:46.921406 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240213 03:27:46.921433 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240213 03:27:46.921468 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240213 03:27:46.921494 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240213 03:27:46.921519 21063 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240213 03:27:46.921542 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240213 03:27:46.921571 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240213 03:27:46.921625 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240213 03:27:46.921655 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240213 03:27:46.921681 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240213 03:27:46.921718 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240213 03:27:46.921746 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240213 03:27:46.921780 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240213 03:27:46.921808 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240213 03:27:46.921840 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240213 03:27:46.921869 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240213 03:27:46.921905 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240213 03:27:46.921931 21063 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240213 03:27:46.921954 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240213 03:27:46.921977 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240213 03:27:46.922030 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240213 03:27:46.922057 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240213 03:27:46.922089 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240213 03:27:46.922122 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240213 03:27:46.922150 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240213 03:27:46.922179 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240213 03:27:46.922206 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240213 03:27:46.922237 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240213 03:27:46.922263 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240213 03:27:46.922294 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240213 03:27:46.922322 21063 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240213 03:27:46.922344 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240213 03:27:46.922366 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240213 03:27:46.922417 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240213 03:27:46.922448 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240213 03:27:46.922477 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240213 03:27:46.922515 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240213 03:27:46.922542 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240213 03:27:46.922569 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240213 03:27:46.922600 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240213 03:27:46.922636 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240213 03:27:46.922668 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240213 03:27:46.922698 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240213 03:27:46.922734 21063 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240213 03:27:46.922756 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240213 03:27:46.922787 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240213 03:27:46.922842 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240213 03:27:46.922875 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240213 03:27:46.922904 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240213 03:27:46.922935 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240213 03:27:46.922961 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240213 03:27:46.922999 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240213 03:27:46.923028 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240213 03:27:46.923067 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240213 03:27:46.923105 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240213 03:27:46.923134 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240213 03:27:46.923166 21063 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240213 03:27:46.923188 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240213 03:27:46.923211 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240213 03:27:46.923260 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240213 03:27:46.923295 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240213 03:27:46.923323 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240213 03:27:46.923359 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240213 03:27:46.923388 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240213 03:27:46.923419 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240213 03:27:46.923455 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240213 03:27:46.923482 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240213 03:27:46.923509 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240213 03:27:46.923547 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240213 03:27:46.923578 21063 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240213 03:27:46.923599 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240213 03:27:46.923622 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240213 03:27:46.923676 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240213 03:27:46.923705 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240213 03:27:46.923740 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240213 03:27:46.923768 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240213 03:27:46.923795 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240213 03:27:46.923830 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240213 03:27:46.923861 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240213 03:27:46.923892 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240213 03:27:46.923931 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240213 03:27:46.923967 21063 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240213 03:27:46.923998 21063 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240213 03:27:46.924021 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240213 03:27:46.924057 21063 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240213 03:27:47.380010 21063 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240213 03:36:19.379070 21063 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605428,  8605464,    68285,  ..., 57256101, 54573527,  9186168]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2198.341 seconds
[Rank1] pid = 22159
[Rank2] pid = 22253
[Rank3] pid = 22321
[Rank4] pid = 22390
[Rank5] pid = 22457
[Rank6] pid = 22524
INFO [21063 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [22159 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [22253 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [22321 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [22390 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [22457 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [22159 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22524 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [22593 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [22524 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22593 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [21063 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22390 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22321 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22253 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [22457 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
WARNING [21063 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22253 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22593 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22524 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22159 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22390 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22321 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [22457 DistTensor.py:59] The tensor name already exists in the kvstore
I20240213 03:45:26.018607 22458 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240213 03:45:26.019243 22254 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 03:45:26.019568 22594 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 03:45:26.019855 22322 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 03:45:26.020128 22391 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 03:45:26.020337 22160 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 03:45:26.020570 22640 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240213 03:45:26.020787 22525 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240213 03:45:27.794147 22640 recstore.cc:66] init folly done
E20240213 03:45:27.794167 22594 recstore.cc:66] init folly done
E20240213 03:45:27.794286 22525 recstore.cc:66] init folly done
E20240213 03:45:27.794446 22254 recstore.cc:66] init folly done
E20240213 03:45:27.794544 22391 recstore.cc:66] init folly done
E20240213 03:45:27.795251 22458 recstore.cc:66] init folly done
E20240213 03:45:27.796298 22160 recstore.cc:66] init folly done
E20240213 03:45:27.796434 22322 recstore.cc:66] init folly done
I20240213 03:45:33.261749 22458 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240213 03:45:33.710870 22594 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 03:45:33.952243 22391 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 03:45:34.981709 22254 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 03:45:35.838352 22322 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 03:45:36.002960 22160 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 03:45:36.326841 22640 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240213 03:45:36.888965 22525 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.699 ms                 | 19.699 ms                 |
| bucket keys               | 118.030 ms                | 118.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.419 ms                 | 19.699 ms                 |
| bucket keys               | 3.157 ms                  | 118.030 ms                |
| forward: a2a keys         | 18.728 ms                 | 51.784 s                  |
| forward: search cache     | 491.858 us                | 39.467 ms                 |
| forward: a2a values       | 6.657 ms                  | 14.196 ms                 |
| forward: software         | 464.678 us                | 735.521 us                |
| forward: join             | 1.682 ms                  | 2.126 ms                  |
| Forward                   | 56.971 ms                 | 52.486 s                  |
| back: aggr dram keys      | 21.761 ms                 | 1.006 s                   |
| back: set dram grad       | 8.061 ms                  | 9.530 ms                  |
| back: a2a grad            | 22.608 ms                 | 28.260 ms                 |
| back: grad sum & grad cache  | 9.283 ms                  | 135.290 ms                |
| Backward                  | 1.417 s                   | 1.417 s                   |
| Optimize                  | 49.401 ms                 | 49.401 ms                 |
| BarrierTimeBeforeRank0    | 84.416 us                 | 84.416 us                 |
| BlockToStepN              | 110.316 us                | 110.316 us                |
| OneStep                   | 53.974 s                  | 53.974 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.882 ms                 | 114.327 ms                |
| bucket keys               | 3.157 ms                  | 118.030 ms                |
| forward: a2a keys         | 5.340 ms                  | 51.784 s                  |
| forward: search cache     | 488.997 us                | 39.467 ms                 |
| forward: a2a values       | 7.971 ms                  | 36.557 ms                 |
| forward: software         | 444.651 us                | 735.521 us                |
| forward: join             | 1.620 ms                  | 2.126 ms                  |
| Forward                   | 56.544 ms                 | 52.486 s                  |
| back: aggr dram keys      | 39.974 ms                 | 1.006 s                   |
| back: set dram grad       | 2.792 ms                  | 11.581 ms                 |
| back: a2a grad            | 19.475 ms                 | 43.627 ms                 |
| back: grad sum & grad cache  | 11.670 ms                 | 152.035 ms                |
| Backward                  | 223.008 ms                | 1.417 s                   |
| Optimize                  | 15.670 ms                 | 49.401 ms                 |
| BarrierTimeBeforeRank0    | 67.851 us                 | 148.596 us                |
| BlockToStepN              | 31.534 us                 | 12.717 ms                 |
| OneStep                   | 299.247 ms                | 53.974 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.886 ms                  | 114.433 ms                |
| bucket keys               | 3.157 ms                  | 10.330 ms                 |
| forward: a2a keys         | 4.713 ms                  | 115.704 ms                |
| forward: search cache     | 491.858 us                | 1.704 ms                  |
| forward: a2a values       | 12.510 ms                 | 28.508 ms                 |
| forward: software         | 444.651 us                | 724.316 us                |
| forward: join             | 1.620 ms                  | 2.409 ms                  |
| Forward                   | 46.065 ms                 | 52.486 s                  |
| back: aggr dram keys      | 39.611 ms                 | 73.245 ms                 |
| back: set dram grad       | 2.755 ms                  | 11.581 ms                 |
| back: a2a grad            | 19.269 ms                 | 35.225 ms                 |
| back: grad sum & grad cache  | 11.670 ms                 | 135.290 ms                |
| Backward                  | 225.488 ms                | 1.417 s                   |
| Optimize                  | 15.595 ms                 | 49.401 ms                 |
| BarrierTimeBeforeRank0    | 57.844 us                 | 148.596 us                |
| BlockToStepN              | 31.534 us                 | 12.717 ms                 |
| OneStep                   | 297.886 ms                | 53.974 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.915 ms                  | 114.433 ms                |
| bucket keys               | 2.885 ms                  | 10.330 ms                 |
| forward: a2a keys         | 4.713 ms                  | 115.704 ms                |
| forward: search cache     | 491.619 us                | 1.704 ms                  |
| forward: a2a values       | 12.341 ms                 | 28.508 ms                 |
| forward: software         | 420.332 us                | 724.316 us                |
| forward: join             | 1.575 ms                  | 2.436 ms                  |
| Forward                   | 46.065 ms                 | 52.486 s                  |
| back: aggr dram keys      | 39.598 ms                 | 73.245 ms                 |
| back: set dram grad       | 2.792 ms                  | 11.581 ms                 |
| back: a2a grad            | 18.646 ms                 | 43.627 ms                 |
| back: grad sum & grad cache  | 12.360 ms                 | 135.290 ms                |
| Backward                  | 218.315 ms                | 1.417 s                   |
| Optimize                  | 15.687 ms                 | 49.401 ms                 |
| BarrierTimeBeforeRank0    | 57.395 us                 | 148.596 us                |
| BlockToStepN              | 45.067 us                 | 30.453 ms                 |
| OneStep                   | 294.223 ms                | 53.974 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.141 ms                  | 114.433 ms                |
| bucket keys               | 2.885 ms                  | 10.330 ms                 |
| forward: a2a keys         | 4.764 ms                  | 115.704 ms                |
| forward: search cache     | 491.619 us                | 1.704 ms                  |
| forward: a2a values       | 11.919 ms                 | 28.508 ms                 |
| forward: software         | 420.332 us                | 724.316 us                |
| forward: join             | 1.575 ms                  | 2.436 ms                  |
| Forward                   | 46.134 ms                 | 164.360 ms                |
| back: aggr dram keys      | 39.309 ms                 | 73.245 ms                 |
| back: set dram grad       | 2.828 ms                  | 13.389 ms                 |
| back: a2a grad            | 18.646 ms                 | 45.056 ms                 |
| back: grad sum & grad cache  | 12.360 ms                 | 135.290 ms                |
| Backward                  | 215.175 ms                | 274.874 ms                |
| Optimize                  | 15.687 ms                 | 21.413 ms                 |
| BarrierTimeBeforeRank0    | 57.844 us                 | 95.617 us                 |
| BlockToStepN              | 46.742 us                 | 12.717 ms                 |
| OneStep                   | 292.409 ms                | 550.355 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.180 ms                  | 125.022 ms                |
| bucket keys               | 3.157 ms                  | 7.144 ms                  |
| forward: a2a keys         | 4.948 ms                  | 114.024 ms                |
| forward: search cache     | 490.189 us                | 1.318 ms                  |
| forward: a2a values       | 11.928 ms                 | 28.508 ms                 |
| forward: software         | 434.399 us                | 589.132 us                |
| forward: join             | 1.620 ms                  | 2.409 ms                  |
| Forward                   | 47.358 ms                 | 164.360 ms                |
| back: aggr dram keys      | 38.661 ms                 | 73.245 ms                 |
| back: set dram grad       | 2.828 ms                  | 11.581 ms                 |
| back: a2a grad            | 18.676 ms                 | 43.627 ms                 |
| back: grad sum & grad cache  | 12.360 ms                 | 134.834 ms                |
| Backward                  | 210.805 ms                | 284.969 ms                |
| Optimize                  | 15.640 ms                 | 21.413 ms                 |
| BarrierTimeBeforeRank0    | 57.054 us                 | 95.617 us                 |
| BlockToStepN              | 45.271 us                 | 12.717 ms                 |
| OneStep                   | 291.404 ms                | 565.748 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.044 ms                  | 147.268 ms                |
| bucket keys               | 2.943 ms                  | 7.144 ms                  |
| forward: a2a keys         | 5.104 ms                  | 115.704 ms                |
| forward: search cache     | 491.619 us                | 1.318 ms                  |
| forward: a2a values       | 12.105 ms                 | 31.797 ms                 |
| forward: software         | 436.306 us                | 589.132 us                |
| forward: join             | 1.620 ms                  | 2.436 ms                  |
| Forward                   | 47.955 ms                 | 244.477 ms                |
| back: aggr dram keys      | 38.889 ms                 | 73.245 ms                 |
| back: set dram grad       | 2.832 ms                  | 11.581 ms                 |
| back: a2a grad            | 18.646 ms                 | 45.056 ms                 |
| back: grad sum & grad cache  | 12.360 ms                 | 134.834 ms                |
| Backward                  | 212.710 ms                | 284.969 ms                |
| Optimize                  | 15.449 ms                 | 21.413 ms                 |
| BarrierTimeBeforeRank0    | 55.907 us                 | 95.617 us                 |
| BlockToStepN              | 45.271 us                 | 13.378 ms                 |
| OneStep                   | 291.404 ms                | 565.748 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 88.494, sample: 2.103, forward: 58.408, backward: 13.608, update: 0.530
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 84.867, sample: 1.884, forward: 58.629, backward: 13.586, update: 0.526
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 87.804, sample: 1.292, forward: 59.197, backward: 13.670, update: 0.551
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 86.774, sample: 1.253, forward: 59.300, backward: 13.814, update: 0.540
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 88.045, sample: 2.403, forward: 58.107, backward: 13.783, update: 0.395
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 85.753, sample: 1.601, forward: 58.966, backward: 14.409, update: 0.435
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 85.918, sample: 1.354, forward: 59.160, backward: 13.827, update: 0.493
[Rank7] pid = 22593
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
train_sampler.Prefill()
-------Step 0-------
tensor([  160479,   160511,   160541,   160565, 10005505,   803351, 60644238,
        22763150, 26101775,   160586]) tensor([ 9430877, 20208124, 63382324, 70280433, 25158958, 36553758, 41990873,
        82660259, 76778317, 34137763])
-------Step 1-------
tensor([  160479,   160511,   160541,   160565, 10005505,   803351, 60644238,
        22763150, 26101775,   160586]) tensor([ 3674034, 32536398, 15466971, 83751344, 78497144, 47987399, 69999612,
        53902688, 37238068, 17958812])
-------Step 2-------
tensor([  225652,   225675,   225697,   271573,   225719,   225742, 85591211,
        27170426,   225762,   225800]) tensor([68310525, 25731555, 82703749, 52104437, 41093064, 33535144, 75744437,
        45634398, 17183938, 47111989])
-------Step 3-------
tensor([  225652,   225675,   225697,   271573,   225719,   225742, 85591211,
        27170426,   225762,   225800]) tensor([47312249, 79522903, 37532246, 43412445, 70595531, 69789534, 37186884,
        21344228, 31181051,  1771987])
-------Step 4-------
tensor([  286847, 41519374,   286866,   825125,   286889,   825149,   286910,
        45124284,   286938,   286972]) tensor([76137941, 14582736, 85819044, 22864039, 65443147, 43863271, 60489113,
        42647265, 84559074, 49868724])
-------Step 5-------
tensor([  286847, 41519374,   286866,   825125,   286889,   825149,   286910,
        45124284,   286938,   286972]) tensor([39766351,  1352346,   933112, 85238149, 55130986, 51981203, 17754069,
        13922722, 74561404, 40126162])
-------Step 6-------
tensor([  347378,   300139, 39073366,   347405, 28483673, 68400144,   347428,
          347456, 50080357, 41521422]) tensor([17915969, 40899158, 35426680, 83544302, 37962345, 42036911, 26436708,
        10459879, 65001737, 83757040])
-------Step 7-------
tensor([  347378,   300139, 39073366,   347405, 28483673, 68400144,   347428,
          347456, 50080357, 41521422]) tensor([26399616, 57350990, 63261851, 55997466, 78587898, 55287979, 59708195,
        53087511, 38311145,  1006645])
-------Step 8-------
tensor([  405028, 29480890,   405046,   843837,   405079,   313541,   405104,
          405126,   405151,   405176]) tensor([49997555, 29214537, 34427078,  3476521, 54566116,   126199, 19790009,
          548864,  3067075, 58817983])
-------Step 9-------
tensor([  405028, 29480890,   405046,   843837,   405079,   313541,   405104,
          405126,   405151,   405176]) tensor([49524396,  1852199, 16732096, 59303804, 12646973, 40012150,   538643,
        43164433, 85705742, 73602286])
before start barrier
start train
[proc 0] 100 steps, total: 85.429, sample: 1.754, forward: 58.631, backward: 22.726, update: 1.551
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.492 ms                  | 147.268 ms                |
| bucket keys               | 2.943 ms                  | 7.144 ms                  |
| forward: a2a keys         | 5.017 ms                  | 124.498 ms                |
| forward: search cache     | 491.142 us                | 1.318 ms                  |
| forward: a2a values       | 12.312 ms                 | 32.701 ms                 |
| forward: software         | 436.306 us                | 637.293 us                |
| forward: join             | 1.629 ms                  | 2.507 ms                  |
| Forward                   | 48.031 ms                 | 244.477 ms                |
| back: aggr dram keys      | 38.478 ms                 | 73.245 ms                 |
| back: set dram grad       | 2.828 ms                  | 11.581 ms                 |
| back: a2a grad            | 18.517 ms                 | 45.056 ms                 |
| back: grad sum & grad cache  | 12.360 ms                 | 134.834 ms                |
| Backward                  | 211.637 ms                | 284.969 ms                |
| Optimize                  | 15.530 ms                 | 21.413 ms                 |
| BarrierTimeBeforeRank0    | 54.922 us                 | 95.617 us                 |
| BlockToStepN              | 44.391 us                 | 16.581 ms                 |
| OneStep                   | 291.350 ms                | 565.748 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 91.74770593643188 seconds
before call kg_cache_controller.StopThreads()
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
INFO [21063 controller_process.py:421] call rank0 to StopThreads
