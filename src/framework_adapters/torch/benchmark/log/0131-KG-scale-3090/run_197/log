WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 09:40:54.957448 48059 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_141', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=7, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=7, gpu=[0, 1, 2, 3, 4, 5, 6], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [48059 sampler.py:454] Start PreSampling
WARNING [48059 sampler.py:532] Before construct renumbering_dict
WARNING [48059 sampler.py:555] PreSampling done
W20240206 10:00:27.565655 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 10:00:27.565865 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 10:00:27.565898 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 10:00:27.565933 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 10:00:27.565959 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 10:00:27.565997 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 10:00:27.566025 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 10:00:27.566066 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 10:00:27.566097 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 10:00:27.566131 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 10:00:27.566167 48059 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 10:00:27.566192 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 10:00:27.566220 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 10:00:27.566376 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 10:00:27.566409 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 10:00:27.566443 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 10:00:27.566491 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 10:00:27.566517 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 10:00:27.566560 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 10:00:27.566591 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 10:00:27.566625 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 10:00:27.566658 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 10:00:27.566687 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 10:00:27.566720 48059 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 10:00:27.566741 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 10:00:27.566771 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 10:00:27.566824 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 10:00:27.566860 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 10:00:27.566888 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 10:00:27.566917 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 10:00:27.566944 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 10:00:27.566974 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 10:00:27.567015 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 10:00:27.567049 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 10:00:27.567081 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 10:00:27.567118 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 10:00:27.567145 48059 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 10:00:27.567167 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 10:00:27.567189 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 10:00:27.567250 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 10:00:27.567286 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 10:00:27.567317 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 10:00:27.567344 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 10:00:27.567373 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 10:00:27.567399 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 10:00:27.567437 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 10:00:27.567466 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 10:00:27.567494 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 10:00:27.567528 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 10:00:27.567556 48059 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 10:00:27.567579 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 10:00:27.567601 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 10:00:27.567662 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 10:00:27.567689 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 10:00:27.567716 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 10:00:27.567759 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 10:00:27.567785 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 10:00:27.567813 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 10:00:27.567840 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 10:00:27.567874 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 10:00:27.567906 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 10:00:27.567940 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 10:00:27.567968 48059 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 10:00:27.567991 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 10:00:27.568017 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 10:00:27.568076 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240206 10:00:27.568111 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240206 10:00:27.568141 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240206 10:00:27.568171 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240206 10:00:27.568198 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240206 10:00:27.568228 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240206 10:00:27.568264 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240206 10:00:27.568293 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240206 10:00:27.568322 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240206 10:00:27.568352 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240206 10:00:27.568385 48059 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240206 10:00:27.568408 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240206 10:00:27.568434 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240206 10:00:27.568482 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240206 10:00:27.568514 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240206 10:00:27.568547 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240206 10:00:27.568576 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240206 10:00:27.568609 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240206 10:00:27.568643 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240206 10:00:27.568675 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240206 10:00:27.568709 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240206 10:00:27.568742 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240206 10:00:27.568774 48059 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240206 10:00:27.568805 48059 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240206 10:00:27.568828 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240206 10:00:27.568850 48059 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240206 10:00:27.998337 48059 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x1000216be000 128.2 GB
W20240206 10:09:06.721758 48059 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020302f6000 328.3 MB
{0: Graph(num_nodes=15380073, num_edges=42467395,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=16359015, num_edges=65830196,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16649310, num_edges=43584356,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=13918614, num_edges=50952482,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14713191, num_edges=52450022,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14150782, num_edges=58077216,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=21311359, num_edges=64967677,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 15380073 N 42467395 E
MertisPartition: part 1 has 16359015 N 65830196 E
MertisPartition: part 2 has 16649310 N 43584356 E
MertisPartition: part 3 has 13918614 N 50952482 E
MertisPartition: part 4 has 14713191 N 52450022 E
MertisPartition: part 5 has 14150782 N 58077216 E
MertisPartition: part 6 has 21311359 N 64967677 E
Rank0: cached key size 614672
Rank1: cached key size 614672
Rank2: cached key size 614672
Rank3: cached key size 614672
Rank4: cached key size 614672
Rank5: cached key size 614672
Rank6: cached key size 614672
Before renumbering graph:  {'_ID': tensor([     239,      240,      329,  ..., 86019793, 84488282, 82976992]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4311499,  4311543,  4316064,  ..., 76734905, 35618592, 81122536]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 3, 2, 2])}
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=15380073, num_edges=42467395,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2196.748 seconds
[Rank1] pid = 49155
[Rank2] pid = 49250
[Rank3] pid = 49317
[Rank4] pid = 49384
[Rank5] pid = 49453
INFO [48059 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [49155 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [49250 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [49317 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [49384 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [49520 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [49453 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [49453 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [49520 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [49384 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [48059 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [49155 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [49250 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
INFO [49317 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 7 nodes.
WARNING [49384 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [49520 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [49453 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [49250 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [48059 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [49155 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [49317 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 10:17:48.911738 49318 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 7
I20240206 10:17:48.912220 49521 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 10:17:48.912801 49385 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 10:17:48.912966 49156 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 10:17:48.913169 49454 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 10:17:48.913400 49584 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
I20240206 10:17:48.913664 49251 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 7
E20240206 10:17:50.574481 49385 recstore.cc:66] init folly done
E20240206 10:17:50.574496 49584 recstore.cc:66] init folly done
E20240206 10:17:50.574541 49318 recstore.cc:66] init folly done
E20240206 10:17:50.574855 49251 recstore.cc:66] init folly done
E20240206 10:17:50.574851 49521 recstore.cc:66] init folly done
E20240206 10:17:50.575629 49454 recstore.cc:66] init folly done
E20240206 10:17:50.575629 49156 recstore.cc:66] init folly done
I20240206 10:17:56.998401 49521 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 7
I20240206 10:17:57.147320 49251 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 10:17:58.149282 49318 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 10:17:58.827466 49385 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 10:18:00.255158 49454 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 10:18:00.733433 49156 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
I20240206 10:18:01.301169 49584 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.810 ms                 | 14.810 ms                 |
| bucket keys               | 2.710 ms                  | 128.221 ms                |
| forward: a2a keys         | 35.643 ms                 | 1.257 s                   |
| forward: search cache     | 426.116 us                | 23.656 ms                 |
| forward: a2a values       | 6.353 ms                  | 49.752 ms                 |
| forward: join             | 1.642 ms                  | 2.859 ms                  |
| Forward                   | 1.978 s                   | 1.978 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.673 ms                  | 101.216 ms                |
| bucket keys               | 2.719 ms                  | 128.221 ms                |
| forward: a2a keys         | 5.826 ms                  | 1.257 s                   |
| forward: search cache     | 422.511 us                | 23.656 ms                 |
| forward: a2a values       | 6.353 ms                  | 49.752 ms                 |
| forward: join             | 1.642 ms                  | 2.927 ms                  |
| Forward                   | 48.791 ms                 | 1.978 s                   |
| back: aggr dram keys      | 30.240 ms                 | 814.487 ms                |
| back: set dram grad       | 1.974 ms                  | 10.727 ms                 |
| back: a2a grad            | 10.188 ms                 | 45.818 ms                 |
| back: grad sum & grad cache  | 4.577 ms                  | 103.960 ms                |
| Backward                  | 192.201 ms                | 1.188 s                   |
| Optimize                  | 25.977 ms                 | 39.187 ms                 |
| BarrierTimeBeforeRank0    | 52.293 us                 | 88.609 us                 |
| BlockToStepN              | 48.720 us                 | 70.406 us                 |
| OneStep                   | 282.882 ms                | 3.221 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.301 ms                  | 101.216 ms                |
| bucket keys               | 3.243 ms                  | 4.050 ms                  |
| forward: a2a keys         | 5.987 ms                  | 70.620 ms                 |
| forward: search cache     | 422.278 us                | 581.108 us                |
| forward: a2a values       | 6.353 ms                  | 42.081 ms                 |
| forward: join             | 1.642 ms                  | 2.927 ms                  |
| Forward                   | 51.841 ms                 | 1.978 s                   |
| back: aggr dram keys      | 36.974 ms                 | 88.145 ms                 |
| back: set dram grad       | 1.974 ms                  | 5.008 ms                  |
| back: a2a grad            | 17.968 ms                 | 45.818 ms                 |
| back: grad sum & grad cache  | 4.577 ms                  | 96.636 ms                 |
| Backward                  | 192.891 ms                | 1.188 s                   |
| Optimize                  | 25.728 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 49.847 us                 | 88.609 us                 |
| BlockToStepN              | 47.274 us                 | 11.075 ms                 |
| OneStep                   | 281.826 ms                | 3.221 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.251 ms                  | 101.216 ms                |
| bucket keys               | 3.096 ms                  | 4.085 ms                  |
| forward: a2a keys         | 6.509 ms                  | 164.463 ms                |
| forward: search cache     | 423.065 us                | 581.108 us                |
| forward: a2a values       | 6.353 ms                  | 42.081 ms                 |
| forward: join             | 1.696 ms                  | 3.475 ms                  |
| Forward                   | 57.122 ms                 | 1.978 s                   |
| back: aggr dram keys      | 43.088 ms                 | 89.786 ms                 |
| back: set dram grad       | 2.035 ms                  | 8.717 ms                  |
| back: a2a grad            | 20.036 ms                 | 47.031 ms                 |
| back: grad sum & grad cache  | 5.329 ms                  | 96.636 ms                 |
| Backward                  | 195.862 ms                | 1.188 s                   |
| Optimize                  | 25.877 ms                 | 53.276 ms                 |
| BarrierTimeBeforeRank0    | 47.585 us                 | 88.609 us                 |
| BlockToStepN              | 48.720 us                 | 15.633 ms                 |
| OneStep                   | 294.215 ms                | 3.221 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.421 ms                  | 96.778 ms                 |
| bucket keys               | 3.096 ms                  | 4.153 ms                  |
| forward: a2a keys         | 6.793 ms                  | 164.463 ms                |
| forward: search cache     | 424.154 us                | 581.108 us                |
| forward: a2a values       | 6.353 ms                  | 42.081 ms                 |
| forward: join             | 1.696 ms                  | 3.821 ms                  |
| Forward                   | 57.736 ms                 | 209.044 ms                |
| back: aggr dram keys      | 43.088 ms                 | 89.786 ms                 |
| back: set dram grad       | 3.498 ms                  | 10.727 ms                 |
| back: a2a grad            | 20.036 ms                 | 47.031 ms                 |
| back: grad sum & grad cache  | 5.329 ms                  | 96.636 ms                 |
| Backward                  | 198.259 ms                | 281.520 ms                |
| Optimize                  | 25.728 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 47.323 us                 | 120.484 us                |
| BlockToStepN              | 49.343 us                 | 11.075 ms                 |
| OneStep                   | 294.215 ms                | 481.616 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.539 ms                  | 96.778 ms                 |
| bucket keys               | 3.174 ms                  | 4.153 ms                  |
| forward: a2a keys         | 7.118 ms                  | 120.195 ms                |
| forward: search cache     | 422.769 us                | 581.108 us                |
| forward: a2a values       | 6.353 ms                  | 29.384 ms                 |
| forward: join             | 1.697 ms                  | 3.475 ms                  |
| Forward                   | 57.865 ms                 | 209.044 ms                |
| back: aggr dram keys      | 43.088 ms                 | 88.145 ms                 |
| back: set dram grad       | 3.498 ms                  | 8.717 ms                  |
| back: a2a grad            | 20.091 ms                 | 45.818 ms                 |
| back: grad sum & grad cache  | 5.329 ms                  | 93.743 ms                 |
| Backward                  | 196.489 ms                | 281.520 ms                |
| Optimize                  | 25.703 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 47.585 us                 | 120.484 us                |
| BlockToStepN              | 50.383 us                 | 11.075 ms                 |
| OneStep                   | 293.933 ms                | 481.616 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.306 ms                  | 100.120 ms                |
| bucket keys               | 3.174 ms                  | 4.153 ms                  |
| forward: a2a keys         | 6.832 ms                  | 120.195 ms                |
| forward: search cache     | 421.983 us                | 581.108 us                |
| forward: a2a values       | 6.353 ms                  | 35.504 ms                 |
| forward: join             | 1.697 ms                  | 3.475 ms                  |
| Forward                   | 56.208 ms                 | 209.044 ms                |
| back: aggr dram keys      | 43.088 ms                 | 88.145 ms                 |
| back: set dram grad       | 3.498 ms                  | 8.717 ms                  |
| back: a2a grad            | 20.091 ms                 | 47.492 ms                 |
| back: grad sum & grad cache  | 5.329 ms                  | 93.743 ms                 |
| Backward                  | 196.218 ms                | 281.520 ms                |
| Optimize                  | 25.646 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 46.568 us                 | 120.484 us                |
| BlockToStepN              | 50.383 us                 | 12.915 ms                 |
| OneStep                   | 292.922 ms                | 481.616 ms                |
+---------------------------+---------------------------+---------------------------+
[Rank6] pid = 49520
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 4316097,   311233,   311288,   311329,   495400,   540674, 23344937,
          495415,   495431,    36005]) tensor([10418900, 35876560, 82678755, 55210334, 75445442, 38817600, 33771439,
        49623163, 84909263, 51514904])
-------Step 1-------
tensor([ 4316097,   311233,   311288,   311329,   495400,   540674, 23344937,
          495415,   495431,    36005]) tensor([52892035, 17941765, 21600214, 15014724, 67797604, 33506048, 83837982,
        20360422, 19189386, 41083514])
-------Step 2-------
tensor([  536370,   323302,   536389,   536409,   536423, 23345283,   551028,
          536441,   551050,   536460]) tensor([36557847,  6750450, 85513477,  1624053, 56568929, 19864471, 64367125,
           25037, 36152739, 72360018])
-------Step 3-------
tensor([  536370,   323302,   536389,   536409,   536423, 23345283,   551028,
          536441,   551050,   536460]) tensor([48410038, 11445225, 29326903,     4221, 55307962, 50952650, 53269535,
        76106925, 51951599, 66942001])
-------Step 4-------
tensor([  561450,   334901,   574883,   561468, 23344937,   277274,   334938,
        34974586,   574897,  4651709]) tensor([83580882, 67329683, 39118828, 11885751, 56094923, 31495285, 13849004,
        48241345, 73087317, 34463741])
-------Step 5-------
tensor([  561450,   334901,   574883,   561468, 23344937,   277274,   334938,
        34974586,   574897,  4651709]) tensor([36229875, 32792190, 10878818, 54201499, 70945210, 72616910,  9225769,
        84741172, 80851506, 78667822])
-------Step 6-------
tensor([ 532030, 4316097,    3718,    3760,  104880,  345019,    3814,    3850,
           3897,    3938]) tensor([52554718, 23890323, 59224480, 52238446, 78519709, 46321824, 47394512,
        53452056, 12457394, 52706723])
-------Step 7-------
tensor([ 532030, 4316097,    3718,    3760,  104880,  345019,    3814,    3850,
           3897,    3938]) tensor([50028066,  5084434, 80350488, 40465254, 85038182, 44027036,  6690442,
        18448317, 28040646,  4918822])
-------Step 8-------
tensor([  532829,    96297,    96344,    96379, 65967079,  4316097,    96425,
         4638584,   582452,    96472]) tensor([68368161, 10817177, 64642243, 70167986, 34826907, 46651935,  4959988,
        25103198, 27995422,   156183])
-------Step 9-------
tensor([  532829,    96297,    96344,    96379, 65967079,  4316097,    96425,
         4638584,   582452,    96472]) tensor([23643043, 19585831, 71500201, 48370202, 35723478, 15056557, 42392689,
        16647671, 57566554, 60593969])
before start barrier
start train
[proc 0] 100 steps, total: 37.566, sample: 1.258, forward: 8.212, backward: 20.995, update: 2.622
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 34.309, sample: 1.144, forward: 9.023, backward: 13.052, update: 0.422
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 33.831, sample: 1.366, forward: 8.773, backward: 13.826, update: 0.350
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 33.263, sample: 2.119, forward: 7.973, backward: 13.331, update: 0.453
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 37.417, sample: 1.295, forward: 8.824, backward: 13.396, update: 0.388
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 36.415, sample: 1.044, forward: 9.093, backward: 13.319, update: 0.451
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 35.737, sample: 1.537, forward: 8.630, backward: 13.055, update: 0.403
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.995 ms                  | 100.120 ms                |
| bucket keys               | 3.174 ms                  | 4.186 ms                  |
| forward: a2a keys         | 6.736 ms                  | 120.195 ms                |
| forward: search cache     | 420.817 us                | 581.108 us                |
| forward: a2a values       | 6.353 ms                  | 35.504 ms                 |
| forward: join             | 1.697 ms                  | 3.821 ms                  |
| Forward                   | 55.862 ms                 | 209.044 ms                |
| back: aggr dram keys      | 43.088 ms                 | 88.145 ms                 |
| back: set dram grad       | 3.498 ms                  | 10.727 ms                 |
| back: a2a grad            | 20.273 ms                 | 50.307 ms                 |
| back: grad sum & grad cache  | 5.329 ms                  | 96.636 ms                 |
| Backward                  | 196.489 ms                | 281.520 ms                |
| Optimize                  | 25.614 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 46.001 us                 | 120.484 us                |
| BlockToStepN              | 50.653 us                 | 15.900 ms                 |
| OneStep                   | 292.922 ms                | 481.616 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.234 ms                  | 100.120 ms                |
| bucket keys               | 3.174 ms                  | 6.344 ms                  |
| forward: a2a keys         | 6.793 ms                  | 120.195 ms                |
| forward: search cache     | 420.400 us                | 581.108 us                |
| forward: a2a values       | 6.353 ms                  | 39.549 ms                 |
| forward: join             | 2.496 ms                  | 3.475 ms                  |
| Forward                   | 57.448 ms                 | 283.281 ms                |
| back: aggr dram keys      | 44.657 ms                 | 84.985 ms                 |
| back: set dram grad       | 3.498 ms                  | 8.717 ms                  |
| back: a2a grad            | 20.361 ms                 | 49.519 ms                 |
| back: grad sum & grad cache  | 6.846 ms                  | 93.757 ms                 |
| Backward                  | 197.562 ms                | 281.520 ms                |
| Optimize                  | 25.405 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 45.918 us                 | 120.484 us                |
| BlockToStepN              | 49.855 us                 | 15.900 ms                 |
| OneStep                   | 294.215 ms                | 578.533 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.251 ms                  | 100.120 ms                |
| bucket keys               | 3.174 ms                  | 6.344 ms                  |
| forward: a2a keys         | 6.851 ms                  | 158.615 ms                |
| forward: search cache     | 420.814 us                | 762.381 us                |
| forward: a2a values       | 6.353 ms                  | 39.549 ms                 |
| forward: join             | 2.496 ms                  | 3.475 ms                  |
| Forward                   | 57.664 ms                 | 283.281 ms                |
| back: aggr dram keys      | 44.657 ms                 | 84.985 ms                 |
| back: set dram grad       | 3.498 ms                  | 8.717 ms                  |
| back: a2a grad            | 20.361 ms                 | 49.519 ms                 |
| back: grad sum & grad cache  | 6.846 ms                  | 93.757 ms                 |
| Backward                  | 196.489 ms                | 281.520 ms                |
| Optimize                  | 25.336 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 45.428 us                 | 120.484 us                |
| BlockToStepN              | 49.855 us                 | 15.900 ms                 |
| OneStep                   | 292.981 ms                | 578.533 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.254 ms                  | 96.778 ms                 |
| bucket keys               | 3.138 ms                  | 6.344 ms                  |
| forward: a2a keys         | 6.932 ms                  | 158.615 ms                |
| forward: search cache     | 420.817 us                | 762.381 us                |
| forward: a2a values       | 14.710 ms                 | 39.549 ms                 |
| forward: join             | 2.496 ms                  | 3.821 ms                  |
| Forward                   | 57.287 ms                 | 209.044 ms                |
| back: aggr dram keys      | 44.572 ms                 | 84.985 ms                 |
| back: set dram grad       | 3.498 ms                  | 8.717 ms                  |
| back: a2a grad            | 20.361 ms                 | 49.519 ms                 |
| back: grad sum & grad cache  | 6.846 ms                  | 93.757 ms                 |
| Backward                  | 194.520 ms                | 271.884 ms                |
| Optimize                  | 25.405 ms                 | 43.952 ms                 |
| BarrierTimeBeforeRank0    | 45.209 us                 | 91.021 us                 |
| BlockToStepN              | 48.720 us                 | 15.633 ms                 |
| OneStep                   | 289.519 ms                | 511.310 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.063 ms                  | 96.778 ms                 |
| bucket keys               | 3.091 ms                  | 5.827 ms                  |
| forward: a2a keys         | 6.793 ms                  | 134.920 ms                |
| forward: search cache     | 420.694 us                | 581.108 us                |
| forward: a2a values       | 14.712 ms                 | 35.504 ms                 |
| forward: join             | 2.496 ms                  | 3.475 ms                  |
| Forward                   | 56.208 ms                 | 209.044 ms                |
| back: aggr dram keys      | 44.572 ms                 | 82.275 ms                 |
| back: set dram grad       | 3.498 ms                  | 8.717 ms                  |
| back: a2a grad            | 20.361 ms                 | 47.492 ms                 |
| back: grad sum & grad cache  | 6.846 ms                  | 93.757 ms                 |
| Backward                  | 193.366 ms                | 271.884 ms                |
| Optimize                  | 25.326 ms                 | 43.952 ms                 |
| BarrierTimeBeforeRank0    | 44.095 us                 | 91.021 us                 |
| BlockToStepN              | 47.485 us                 | 15.633 ms                 |
| OneStep                   | 287.542 ms                | 511.310 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.063 ms                  | 96.778 ms                 |
| bucket keys               | 3.045 ms                  | 6.344 ms                  |
| forward: a2a keys         | 6.702 ms                  | 136.132 ms                |
| forward: search cache     | 421.155 us                | 581.108 us                |
| forward: a2a values       | 14.712 ms                 | 35.504 ms                 |
| forward: join             | 2.496 ms                  | 3.821 ms                  |
| Forward                   | 55.146 ms                 | 209.044 ms                |
| back: aggr dram keys      | 44.572 ms                 | 82.275 ms                 |
| back: set dram grad       | 3.498 ms                  | 8.717 ms                  |
| back: a2a grad            | 20.304 ms                 | 47.994 ms                 |
| back: grad sum & grad cache  | 6.846 ms                  | 93.757 ms                 |
| Backward                  | 193.358 ms                | 271.884 ms                |
| Optimize                  | 25.329 ms                 | 43.952 ms                 |
| BarrierTimeBeforeRank0    | 44.999 us                 | 120.484 us                |
| BlockToStepN              | 47.353 us                 | 15.633 ms                 |
| OneStep                   | 285.752 ms                | 511.310 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 6] 200 steps, total: 30.215, sample: 2.456, forward: 5.896, backward: 12.321, update: 0.456
[proc 5] 200 steps, total: 30.215, sample: 1.497, forward: 6.932, backward: 12.050, update: 0.394
[proc 3] 200 steps, total: 30.215, sample: 1.070, forward: 7.326, backward: 12.299, update: 0.438
[proc 1] 200 steps, total: 30.215, sample: 1.312, forward: 7.077, backward: 12.715, update: 0.371
[proc 0] 200 steps, total: 30.215, sample: 1.205, forward: 6.675, backward: 19.663, update: 2.515
[proc 2] 200 steps, total: 30.215, sample: 1.063, forward: 7.338, backward: 12.363, update: 0.453
[proc 4] 200 steps, total: 30.215, sample: 1.678, forward: 6.780, backward: 12.020, update: 0.440
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.230 ms                  | 100.120 ms                |
| bucket keys               | 2.913 ms                  | 6.344 ms                  |
| forward: a2a keys         | 6.665 ms                  | 155.525 ms                |
| forward: search cache     | 421.529 us                | 604.460 us                |
| forward: a2a values       | 14.710 ms                 | 35.504 ms                 |
| forward: join             | 2.496 ms                  | 3.821 ms                  |
| Forward                   | 54.516 ms                 | 209.044 ms                |
| back: aggr dram keys      | 45.364 ms                 | 82.275 ms                 |
| back: set dram grad       | 3.662 ms                  | 8.717 ms                  |
| back: a2a grad            | 20.423 ms                 | 47.994 ms                 |
| back: grad sum & grad cache  | 6.846 ms                  | 93.757 ms                 |
| Backward                  | 192.859 ms                | 271.884 ms                |
| Optimize                  | 25.264 ms                 | 43.952 ms                 |
| BarrierTimeBeforeRank0    | 43.696 us                 | 120.484 us                |
| BlockToStepN              | 47.316 us                 | 15.633 ms                 |
| OneStep                   | 284.852 ms                | 562.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.230 ms                  | 100.120 ms                |
| bucket keys               | 2.953 ms                  | 6.273 ms                  |
| forward: a2a keys         | 6.753 ms                  | 136.132 ms                |
| forward: search cache     | 421.679 us                | 762.381 us                |
| forward: a2a values       | 14.521 ms                 | 35.504 ms                 |
| forward: join             | 2.466 ms                  | 3.821 ms                  |
| Forward                   | 55.128 ms                 | 209.044 ms                |
| back: aggr dram keys      | 44.657 ms                 | 79.968 ms                 |
| back: set dram grad       | 3.733 ms                  | 5.496 ms                  |
| back: a2a grad            | 20.428 ms                 | 47.492 ms                 |
| back: grad sum & grad cache  | 6.846 ms                  | 93.757 ms                 |
| Backward                  | 193.386 ms                | 271.884 ms                |
| Optimize                  | 25.264 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 43.699 us                 | 120.484 us                |
| BlockToStepN              | 47.251 us                 | 15.633 ms                 |
| OneStep                   | 286.742 ms                | 562.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.932 ms                  | 100.120 ms                |
| bucket keys               | 2.986 ms                  | 6.273 ms                  |
| forward: a2a keys         | 6.736 ms                  | 136.132 ms                |
| forward: search cache     | 421.533 us                | 1.100 ms                  |
| forward: a2a values       | 14.494 ms                 | 35.504 ms                 |
| forward: join             | 2.438 ms                  | 3.821 ms                  |
| Forward                   | 55.108 ms                 | 209.044 ms                |
| back: aggr dram keys      | 44.657 ms                 | 79.968 ms                 |
| back: set dram grad       | 3.719 ms                  | 9.154 ms                  |
| back: a2a grad            | 20.361 ms                 | 47.492 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 93.757 ms                 |
| Backward                  | 193.806 ms                | 271.884 ms                |
| Optimize                  | 25.186 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 43.665 us                 | 120.484 us                |
| BlockToStepN              | 46.814 us                 | 15.633 ms                 |
| OneStep                   | 285.752 ms                | 562.832 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.891 ms                  | 96.778 ms                 |
| bucket keys               | 2.953 ms                  | 6.273 ms                  |
| forward: a2a keys         | 6.753 ms                  | 136.132 ms                |
| forward: search cache     | 421.529 us                | 1.100 ms                  |
| forward: a2a values       | 14.086 ms                 | 35.504 ms                 |
| forward: join             | 2.369 ms                  | 3.821 ms                  |
| Forward                   | 55.108 ms                 | 203.048 ms                |
| back: aggr dram keys      | 44.657 ms                 | 79.968 ms                 |
| back: set dram grad       | 3.719 ms                  | 9.154 ms                  |
| back: a2a grad            | 19.660 ms                 | 47.994 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 96.214 ms                 |
| Backward                  | 192.859 ms                | 265.986 ms                |
| Optimize                  | 25.303 ms                 | 43.952 ms                 |
| BarrierTimeBeforeRank0    | 43.232 us                 | 91.021 us                 |
| BlockToStepN              | 46.137 us                 | 14.969 ms                 |
| OneStep                   | 284.852 ms                | 511.310 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.928 ms                  | 96.778 ms                 |
| bucket keys               | 2.953 ms                  | 5.827 ms                  |
| forward: a2a keys         | 6.719 ms                  | 135.189 ms                |
| forward: search cache     | 421.396 us                | 1.095 ms                  |
| forward: a2a values       | 14.086 ms                 | 35.302 ms                 |
| forward: join             | 2.369 ms                  | 3.552 ms                  |
| Forward                   | 54.451 ms                 | 203.048 ms                |
| back: aggr dram keys      | 44.657 ms                 | 79.857 ms                 |
| back: set dram grad       | 3.719 ms                  | 8.934 ms                  |
| back: a2a grad            | 19.281 ms                 | 47.492 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 93.757 ms                 |
| Backward                  | 192.047 ms                | 265.986 ms                |
| Optimize                  | 25.424 ms                 | 43.952 ms                 |
| BarrierTimeBeforeRank0    | 43.171 us                 | 91.021 us                 |
| BlockToStepN              | 46.050 us                 | 14.969 ms                 |
| OneStep                   | 283.212 ms                | 511.310 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 28.860, sample: 1.014, forward: 6.039, backward: 19.078, update: 2.608
[proc 6] 300 steps, total: 28.860, sample: 1.882, forward: 5.555, backward: 12.461, update: 0.460
[proc 5] 300 steps, total: 28.860, sample: 1.095, forward: 6.415, backward: 12.243, update: 0.441
[proc 2] 300 steps, total: 28.860, sample: 0.897, forward: 6.615, backward: 12.484, update: 0.386
[proc 4] 300 steps, total: 28.860, sample: 1.301, forward: 6.231, backward: 12.203, update: 0.439
[proc 3] 300 steps, total: 28.860, sample: 0.909, forward: 6.612, backward: 12.459, update: 0.411
[proc 1] 300 steps, total: 28.860, sample: 1.173, forward: 6.357, backward: 12.784, update: 0.385
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.918 ms                  | 96.778 ms                 |
| bucket keys               | 2.968 ms                  | 5.827 ms                  |
| forward: a2a keys         | 6.702 ms                  | 135.189 ms                |
| forward: search cache     | 421.371 us                | 1.095 ms                  |
| forward: a2a values       | 10.852 ms                 | 35.302 ms                 |
| forward: join             | 2.369 ms                  | 3.554 ms                  |
| Forward                   | 53.843 ms                 | 203.048 ms                |
| back: aggr dram keys      | 44.657 ms                 | 79.857 ms                 |
| back: set dram grad       | 3.719 ms                  | 8.934 ms                  |
| back: a2a grad            | 18.589 ms                 | 47.492 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 93.757 ms                 |
| Backward                  | 191.473 ms                | 265.986 ms                |
| Optimize                  | 25.595 ms                 | 43.952 ms                 |
| BarrierTimeBeforeRank0    | 42.799 us                 | 91.021 us                 |
| BlockToStepN              | 45.961 us                 | 14.969 ms                 |
| OneStep                   | 282.077 ms                | 511.310 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.829 ms                  | 96.778 ms                 |
| bucket keys               | 2.986 ms                  | 6.273 ms                  |
| forward: a2a keys         | 6.721 ms                  | 135.189 ms                |
| forward: search cache     | 421.048 us                | 1.095 ms                  |
| forward: a2a values       | 9.452 ms                  | 35.504 ms                 |
| forward: join             | 2.369 ms                  | 3.584 ms                  |
| Forward                   | 53.767 ms                 | 203.048 ms                |
| back: aggr dram keys      | 44.657 ms                 | 79.968 ms                 |
| back: set dram grad       | 3.797 ms                  | 8.934 ms                  |
| back: a2a grad            | 15.863 ms                 | 47.492 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 93.757 ms                 |
| Backward                  | 190.575 ms                | 265.986 ms                |
| Optimize                  | 25.728 ms                 | 47.111 ms                 |
| BarrierTimeBeforeRank0    | 41.802 us                 | 91.021 us                 |
| BlockToStepN              | 46.946 us                 | 14.969 ms                 |
| OneStep                   | 282.037 ms                | 511.310 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.803 ms                  | 96.778 ms                 |
| bucket keys               | 2.953 ms                  | 5.827 ms                  |
| forward: a2a keys         | 6.736 ms                  | 134.920 ms                |
| forward: search cache     | 421.208 us                | 762.381 us                |
| forward: a2a values       | 8.214 ms                  | 35.302 ms                 |
| forward: join             | 2.369 ms                  | 3.554 ms                  |
| Forward                   | 53.604 ms                 | 203.048 ms                |
| back: aggr dram keys      | 45.364 ms                 | 79.968 ms                 |
| back: set dram grad       | 3.830 ms                  | 8.717 ms                  |
| back: a2a grad            | 14.305 ms                 | 47.031 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 93.743 ms                 |
| Backward                  | 189.833 ms                | 265.986 ms                |
| Optimize                  | 25.754 ms                 | 47.111 ms                 |
| BarrierTimeBeforeRank0    | 41.185 us                 | 91.021 us                 |
| BlockToStepN              | 46.814 us                 | 16.067 ms                 |
| OneStep                   | 281.449 ms                | 511.310 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.821 ms                  | 96.778 ms                 |
| bucket keys               | 2.968 ms                  | 5.827 ms                  |
| forward: a2a keys         | 6.669 ms                  | 134.920 ms                |
| forward: search cache     | 421.208 us                | 762.381 us                |
| forward: a2a values       | 7.800 ms                  | 35.302 ms                 |
| forward: join             | 2.605 ms                  | 3.821 ms                  |
| Forward                   | 53.238 ms                 | 201.474 ms                |
| back: aggr dram keys      | 48.603 ms                 | 79.968 ms                 |
| back: set dram grad       | 3.866 ms                  | 8.717 ms                  |
| back: a2a grad            | 13.284 ms                 | 47.031 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 93.743 ms                 |
| Backward                  | 189.131 ms                | 255.092 ms                |
| Optimize                  | 25.808 ms                 | 49.795 ms                 |
| BarrierTimeBeforeRank0    | 41.177 us                 | 88.609 us                 |
| BlockToStepN              | 46.587 us                 | 15.900 ms                 |
| OneStep                   | 279.475 ms                | 505.991 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.821 ms                  | 96.778 ms                 |
| bucket keys               | 2.986 ms                  | 5.792 ms                  |
| forward: a2a keys         | 6.702 ms                  | 120.195 ms                |
| forward: search cache     | 421.155 us                | 744.009 us                |
| forward: a2a values       | 7.047 ms                  | 34.876 ms                 |
| forward: join             | 2.629 ms                  | 3.911 ms                  |
| Forward                   | 52.385 ms                 | 201.474 ms                |
| back: aggr dram keys      | 52.028 ms                 | 79.857 ms                 |
| back: set dram grad       | 3.902 ms                  | 8.533 ms                  |
| back: a2a grad            | 12.486 ms                 | 45.818 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 92.247 ms                 |
| Backward                  | 188.331 ms                | 255.092 ms                |
| Optimize                  | 25.940 ms                 | 50.209 ms                 |
| BarrierTimeBeforeRank0    | 40.987 us                 | 88.609 us                 |
| BlockToStepN              | 45.853 us                 | 15.900 ms                 |
| OneStep                   | 278.863 ms                | 505.991 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.748 ms                  | 96.778 ms                 |
| bucket keys               | 2.986 ms                  | 5.792 ms                  |
| forward: a2a keys         | 6.633 ms                  | 120.195 ms                |
| forward: search cache     | 420.504 us                | 744.009 us                |
| forward: a2a values       | 6.817 ms                  | 34.876 ms                 |
| forward: join             | 2.647 ms                  | 3.911 ms                  |
| Forward                   | 52.070 ms                 | 201.474 ms                |
| back: aggr dram keys      | 52.302 ms                 | 79.968 ms                 |
| back: set dram grad       | 3.978 ms                  | 8.533 ms                  |
| back: a2a grad            | 11.864 ms                 | 45.818 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 92.247 ms                 |
| Backward                  | 187.778 ms                | 255.092 ms                |
| Optimize                  | 26.019 ms                 | 53.121 ms                 |
| BarrierTimeBeforeRank0    | 40.706 us                 | 88.609 us                 |
| BlockToStepN              | 45.233 us                 | 15.900 ms                 |
| OneStep                   | 277.557 ms                | 505.991 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 400 steps, total: 26.408, sample: 1.000, forward: 5.438, backward: 13.301, update: 0.473
[proc 6] 400 steps, total: 26.408, sample: 1.576, forward: 4.834, backward: 13.408, update: 0.463
[proc 3] 400 steps, total: 26.408, sample: 0.918, forward: 5.523, backward: 13.430, update: 0.312
[proc 0] 400 steps, total: 26.408, sample: 0.956, forward: 5.107, backward: 16.383, update: 3.705
[proc 2] 400 steps, total: 26.408, sample: 0.893, forward: 5.576, backward: 13.497, update: 0.451
[proc 4] 400 steps, total: 26.408, sample: 1.260, forward: 5.199, backward: 13.281, update: 0.498
[proc 1] 400 steps, total: 26.408, sample: 1.146, forward: 5.329, backward: 13.634, update: 0.405
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.669 ms                  | 96.778 ms                 |
| bucket keys               | 3.002 ms                  | 5.792 ms                  |
| forward: a2a keys         | 6.656 ms                  | 120.195 ms                |
| forward: search cache     | 420.970 us                | 744.009 us                |
| forward: a2a values       | 6.821 ms                  | 34.876 ms                 |
| forward: join             | 2.668 ms                  | 4.468 ms                  |
| Forward                   | 52.062 ms                 | 201.474 ms                |
| back: aggr dram keys      | 52.771 ms                 | 82.275 ms                 |
| back: set dram grad       | 4.006 ms                  | 8.533 ms                  |
| back: a2a grad            | 11.657 ms                 | 47.031 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 92.247 ms                 |
| Backward                  | 187.504 ms                | 255.092 ms                |
| Optimize                  | 26.081 ms                 | 53.276 ms                 |
| BarrierTimeBeforeRank0    | 40.482 us                 | 88.609 us                 |
| BlockToStepN              | 46.137 us                 | 15.900 ms                 |
| OneStep                   | 275.571 ms                | 505.991 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.707 ms                  | 96.778 ms                 |
| bucket keys               | 3.024 ms                  | 5.437 ms                  |
| forward: a2a keys         | 6.584 ms                  | 119.631 ms                |
| forward: search cache     | 421.112 us                | 736.424 us                |
| forward: a2a values       | 6.821 ms                  | 34.553 ms                 |
| forward: join             | 2.701 ms                  | 4.537 ms                  |
| Forward                   | 51.841 ms                 | 201.474 ms                |
| back: aggr dram keys      | 52.962 ms                 | 82.271 ms                 |
| back: set dram grad       | 4.082 ms                  | 8.533 ms                  |
| back: a2a grad            | 11.536 ms                 | 45.818 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 91.272 ms                 |
| Backward                  | 186.960 ms                | 255.092 ms                |
| Optimize                  | 26.224 ms                 | 55.160 ms                 |
| BarrierTimeBeforeRank0    | 40.337 us                 | 88.609 us                 |
| BlockToStepN              | 45.433 us                 | 15.900 ms                 |
| OneStep                   | 274.884 ms                | 505.991 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.678 ms                  | 96.523 ms                 |
| bucket keys               | 3.002 ms                  | 5.647 ms                  |
| forward: a2a keys         | 6.549 ms                  | 119.631 ms                |
| forward: search cache     | 421.048 us                | 736.424 us                |
| forward: a2a values       | 6.821 ms                  | 34.876 ms                 |
| forward: join             | 2.738 ms                  | 4.814 ms                  |
| Forward                   | 51.571 ms                 | 191.230 ms                |
| back: aggr dram keys      | 52.771 ms                 | 82.271 ms                 |
| back: set dram grad       | 4.134 ms                  | 8.533 ms                  |
| back: a2a grad            | 11.463 ms                 | 45.818 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 91.272 ms                 |
| Backward                  | 186.404 ms                | 251.553 ms                |
| Optimize                  | 26.433 ms                 | 53.276 ms                 |
| BarrierTimeBeforeRank0    | 39.939 us                 | 84.748 us                 |
| BlockToStepN              | 44.943 us                 | 15.900 ms                 |
| OneStep                   | 273.379 ms                | 498.637 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.619 ms                  | 96.523 ms                 |
| bucket keys               | 3.002 ms                  | 5.647 ms                  |
| forward: a2a keys         | 6.603 ms                  | 119.631 ms                |
| forward: search cache     | 420.923 us                | 736.424 us                |
| forward: a2a values       | 6.837 ms                  | 35.302 ms                 |
| forward: join             | 2.758 ms                  | 4.814 ms                  |
| Forward                   | 51.326 ms                 | 191.230 ms                |
| back: aggr dram keys      | 53.122 ms                 | 82.271 ms                 |
| back: set dram grad       | 4.130 ms                  | 8.533 ms                  |
| back: a2a grad            | 11.399 ms                 | 45.818 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 91.272 ms                 |
| Backward                  | 185.877 ms                | 251.553 ms                |
| Optimize                  | 26.711 ms                 | 53.276 ms                 |
| BarrierTimeBeforeRank0    | 39.685 us                 | 84.748 us                 |
| BlockToStepN              | 44.657 us                 | 15.900 ms                 |
| OneStep                   | 272.152 ms                | 498.637 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.501 ms                  | 96.523 ms                 |
| bucket keys               | 3.015 ms                  | 5.647 ms                  |
| forward: a2a keys         | 6.549 ms                  | 117.925 ms                |
| forward: search cache     | 420.814 us                | 692.632 us                |
| forward: a2a values       | 6.837 ms                  | 35.302 ms                 |
| forward: join             | 2.771 ms                  | 4.814 ms                  |
| Forward                   | 50.848 ms                 | 191.230 ms                |
| back: aggr dram keys      | 53.166 ms                 | 79.968 ms                 |
| back: set dram grad       | 4.131 ms                  | 8.533 ms                  |
| back: a2a grad            | 11.327 ms                 | 43.553 ms                 |
| back: grad sum & grad cache  | 12.293 ms                 | 91.032 ms                 |
| Backward                  | 185.468 ms                | 251.553 ms                |
| Optimize                  | 27.139 ms                 | 53.276 ms                 |
| BarrierTimeBeforeRank0    | 39.519 us                 | 84.748 us                 |
| BlockToStepN              | 44.943 us                 | 15.900 ms                 |
| OneStep                   | 271.572 ms                | 498.637 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 25.641, sample: 0.872, forward: 5.361, backward: 14.183, update: 0.409
[proc 6] 500 steps, total: 25.641, sample: 1.318, forward: 4.871, backward: 14.150, update: 0.457
[proc 4] 500 steps, total: 25.641, sample: 1.042, forward: 5.232, backward: 14.021, update: 0.475
[proc 5] 500 steps, total: 25.641, sample: 0.995, forward: 5.220, backward: 14.123, update: 0.478
[proc 2] 500 steps, total: 25.641, sample: 0.887, forward: 5.398, backward: 14.148, update: 0.451
[proc 0] 500 steps, total: 25.641, sample: 0.898, forward: 5.000, backward: 16.025, update: 3.577
[proc 1] 500 steps, total: 25.641, sample: 1.075, forward: 5.180, backward: 14.348, update: 0.429
Successfully xmh. training takes 148.69001698493958 seconds
before call kg_cache_controller.StopThreads()
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
INFO [48059 controller_process.py:421] call rank0 to StopThreads
