WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240213 06:16:50.001938  9309 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_74', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=1, update_pq_use_omp=2, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [9309 sampler.py:454] Start PreSampling
WARNING [9309 sampler.py:532] Before construct renumbering_dict
WARNING [9309 sampler.py:555] PreSampling done
W20240213 06:34:16.441001  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240213 06:34:16.441208  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240213 06:34:16.441243  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240213 06:34:16.441280  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240213 06:34:16.441318  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240213 06:34:16.441366  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240213 06:34:16.441404  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240213 06:34:16.441442  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240213 06:34:16.441484  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240213 06:34:16.441524  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240213 06:34:16.441560  9309 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240213 06:34:16.441594  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240213 06:34:16.441630  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240213 06:34:16.441784  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240213 06:34:16.441823  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240213 06:34:16.441852  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240213 06:34:16.441895  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240213 06:34:16.441924  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240213 06:34:16.441962  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240213 06:34:16.442008  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240213 06:34:16.442045  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240213 06:34:16.442077  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240213 06:34:16.442112  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240213 06:34:16.442143  9309 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240213 06:34:16.442168  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240213 06:34:16.442196  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240213 06:34:16.442260  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240213 06:34:16.442291  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240213 06:34:16.442322  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240213 06:34:16.442353  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240213 06:34:16.442389  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240213 06:34:16.442425  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240213 06:34:16.442457  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240213 06:34:16.442489  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240213 06:34:16.442523  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240213 06:34:16.442566  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240213 06:34:16.442610  9309 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240213 06:34:16.442636  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240213 06:34:16.442668  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240213 06:34:16.442739  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240213 06:34:16.442780  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240213 06:34:16.442816  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240213 06:34:16.442850  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240213 06:34:16.442883  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240213 06:34:16.442912  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240213 06:34:16.442952  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240213 06:34:16.442981  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240213 06:34:16.443020  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240213 06:34:16.443050  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240213 06:34:16.443081  9309 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240213 06:34:16.443107  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240213 06:34:16.443141  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240213 06:34:16.443218  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240213 06:34:16.443259  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240213 06:34:16.443289  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240213 06:34:16.443322  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240213 06:34:16.443352  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240213 06:34:16.443392  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240213 06:34:16.443428  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240213 06:34:16.443464  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240213 06:34:16.443499  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240213 06:34:16.443536  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240213 06:34:16.443570  9309 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240213 06:34:16.443596  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240213 06:34:16.443625  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240213 06:34:16.443686  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240213 06:34:16.443725  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240213 06:34:16.443758  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240213 06:34:16.443794  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240213 06:34:16.443827  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240213 06:34:16.443863  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240213 06:34:16.443894  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240213 06:34:16.443925  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240213 06:34:16.443964  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240213 06:34:16.444002  9309 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240213 06:34:16.444033  9309 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240213 06:34:16.444083  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240213 06:34:16.444111  9309 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240213 06:34:17.000977  9309 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x10001ca5a000 128.2 GB
W20240213 06:42:55.131202  9309 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10202b692000 328.3 MB
{0: Graph(num_nodes=16391033, num_edges=60554486,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=22850318, num_edges=74912573,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=16459669, num_edges=67428404,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=17554345, num_edges=53272616,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=17824082, num_edges=71836124,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=18730250, num_edges=46391216,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 16391033 N 60554486 E
MertisPartition: part 1 has 22850318 N 74912573 E
MertisPartition: part 2 has 16459669 N 67428404 E
MertisPartition: part 3 has 17554345 N 53272616 E
MertisPartition: part 4 has 17824082 N 71836124 E
MertisPartition: part 5 has 18730250 N 46391216 E
Rank0: cached key size 717117
Rank1: cached key size 717117
Rank2: cached key size 717117
Rank3: cached key size 717117
Rank4: cached key size 717117
Rank5: cached key size 717117
Before renumbering graph:  {'_ID': tensor([       4,        5,       14,  ..., 12367661, 70093925, 61280605]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 4302846,  4302866,   564655,  ..., 52759156, 10323957, 60553302]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=16391033, num_edges=60554486,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=16391033, num_edges=60554486,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2070.882 seconds
[Rank1] pid = 10452
[Rank2] pid = 10549
[Rank3] pid = 10630
[Rank4] pid = 10697
INFO [10452 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [9309 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [10549 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [10630 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [10697 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [10766 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [10697 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [10766 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [10549 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [10630 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [10452 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [9309 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
W20240213 06:51:30.253839 10767 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240213 06:51:30.254444 10698 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240213 06:51:30.254585 10865 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240213 06:51:30.254588 10631 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240213 06:51:30.254586 10550 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240213 06:51:30.254627 10453 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240213 06:51:30.328006 10631 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10203fee5000 7.629 MB
W20240213 06:51:30.328013 10698 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x102040e2b000 7.629 MB
W20240213 06:51:30.328011 10865 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102040688000 7.629 MB
W20240213 06:51:30.328033 10767 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1020415ce000 7.629 MB
W20240213 06:51:30.328040 10550 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102041d71000 7.629 MB
W20240213 06:51:30.328058 10453 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102042514000 7.629 MB
W20240213 06:51:30.328462 10453 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102042cb7000 7.629 MB
W20240213 06:51:30.328511 10550 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10204345a000 7.629 MB
W20240213 06:51:30.328516 10865 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102043bfd000 7.629 MB
W20240213 06:51:30.328539 10767 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020443a0000 7.629 MB
W20240213 06:51:30.328557 10453 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x102044b43000 1.49 GB
W20240213 06:51:30.328569 10698 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1020a4126000 7.629 MB
W20240213 06:51:30.328588 10631 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020a48c9000 7.629 MB
W20240213 06:51:30.328598 10550 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1020a506c000 1.49 GB
W20240213 06:51:30.328610 10453 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10210464f000 1.49 GB
W20240213 06:51:30.328626 10767 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x102163c32000 1.49 GB
W20240213 06:51:30.328653 10550 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1021c3215000 1.49 GB
W20240213 06:51:30.328661 10698 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1022227f8000 1.49 GB
W20240213 06:51:30.328665 10767 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x102281ddb000 1.49 GB
W20240213 06:51:30.328687 10865 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x1022e13be000 1.49 GB
W20240213 06:51:30.328703 10631 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1023409a1000 1.49 GB
W20240213 06:51:30.328738 10453 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240213 06:51:30.328747 10865 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10239ff84000 1.49 GB
W20240213 06:51:30.328763 10767 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240213 06:51:30.328766 10550 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240213 06:51:30.328770 10698 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1023ff567000 1.49 GB
W20240213 06:51:30.328778 10631 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10245eb4a000 1.49 GB
W20240213 06:51:30.328825 10631 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240213 06:51:30.328826 10698 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240213 06:51:30.328830 10865 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240213 06:51:30.338384 10453 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240213 06:51:30.338411 10550 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240213 06:51:30.338413 10767 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240213 06:51:30.338443 10865 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240213 06:51:30.341392 10698 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240213 06:51:30.341392 10631 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x10001ca5a000
4: KnownLocalCachedEmbedding init done
WARNING [10697 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
5: KnownLocalCachedEmbedding init done
WARNING [10766 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
1: KnownLocalCachedEmbedding init done
WARNING [10452 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
3: KnownLocalCachedEmbedding init done
WARNING [10630 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank5] pid = 10766
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242)]
cudaHostRegister 0x10001ca5a000
0: KnownLocalCachedEmbedding init done
WARNING [9309 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10001ca5a000
2: KnownLocalCachedEmbedding init done
WARNING [10549 DistTensor.py:59] The tensor name already exists in the kvstore
I20240213 06:52:11.837111 10550 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240213 06:52:11.837232 10767 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240213 06:52:11.837761 10631 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240213 06:52:11.837930 10453 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240213 06:52:11.838063 10865 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240213 06:52:11.838178 10698 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
E20240213 06:52:12.459131 10698 recstore.cc:66] init folly done
E20240213 06:52:12.459182 10865 recstore.cc:66] init folly done
E20240213 06:52:12.459249 10550 recstore.cc:66] init folly done
E20240213 06:52:12.459776 10767 recstore.cc:66] init folly done
E20240213 06:52:12.459808 10453 recstore.cc:66] init folly done
E20240213 06:52:12.459808 10631 recstore.cc:66] init folly done
I20240213 06:52:19.706156 10865 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240213 06:52:20.520148 10631 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 06:52:22.140455 10767 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 06:52:22.764550 10550 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 06:52:23.689076 10698 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240213 06:52:23.784209 10453 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.037 ms                  | 9.037 ms                  |
| Forward                   | 410.709 ms                | 410.709 ms                |
| back: bucket keys         | 61.552 ms                 | 61.552 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.037 ms                  | 9.037 ms                  |
| Forward                   | 410.709 ms                | 410.709 ms                |
| back: bucket keys         | 61.552 ms                 | 61.552 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.037 ms                  | 9.037 ms                  |
| Forward                   | 410.709 ms                | 410.709 ms                |
| back: bucket keys         | 61.552 ms                 | 61.552 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.037 ms                  | 9.037 ms                  |
| Forward                   | 410.709 ms                | 410.709 ms                |
| back: bucket keys         | 61.552 ms                 | 61.552 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.037 ms                  | 9.037 ms                  |
| Forward                   | 410.709 ms                | 410.709 ms                |
| back: bucket keys         | 61.552 ms                 | 61.552 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.037 ms                  | 9.037 ms                  |
| Forward                   | 410.709 ms                | 410.709 ms                |
| back: bucket keys         | 61.552 ms                 | 61.552 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.037 ms                  | 9.037 ms                  |
| Forward                   | 410.709 ms                | 410.709 ms                |
| back: bucket keys         | 61.552 ms                 | 61.552 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.037 ms                  | 9.037 ms                  |
| Forward                   | 410.709 ms                | 410.709 ms                |
| back: bucket keys         | 61.552 ms                 | 61.552 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.037 ms                  | 9.037 ms                  |
| Forward                   | 410.709 ms                | 410.709 ms                |
| back: bucket keys         | 61.552 ms                 | 61.552 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.303 ms                 | 32.223 ms                 |
| Forward                   | 6.207 ms                  | 410.709 ms                |
| back: bucket keys         | 562.906 us                | 61.552 ms                 |
| back: a2a                 | 22.472 ms                 | 45.267 s                  |
| back: cache               | 10.900 ms                 | 180.809 ms                |
| back: aggr dram keys      | 90.008 ms                 | 858.679 ms                |
| back: set dram grad       | 17.267 ms                 | 64.122 ms                 |
| Backward                  | 545.568 ms                | 46.648 s                  |
| Optimize                  | 87.338 ms                 | 135.721 ms                |
| BarrierTimeBeforeRank0    | 58.674 us                 | 100.325 us                |
| BlockToStepN              | 42.709 us                 | 97.744 us                 |
| OneStep                   | 671.737 ms                | 47.205 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.693 ms                  | 107.957 ms                |
| Forward                   | 5.346 ms                  | 410.709 ms                |
| back: bucket keys         | 620.127 us                | 61.552 ms                 |
| back: a2a                 | 14.908 ms                 | 45.267 s                  |
| back: cache               | 10.900 ms                 | 180.809 ms                |
| back: aggr dram keys      | 60.508 ms                 | 858.679 ms                |
| back: set dram grad       | 7.624 ms                  | 64.122 ms                 |
| Backward                  | 259.731 ms                | 46.648 s                  |
| Optimize                  | 55.568 ms                 | 135.721 ms                |
| BarrierTimeBeforeRank0    | 56.890 us                 | 103.678 us                |
| BlockToStepN              | 49.004 us                 | 12.307 ms                 |
| OneStep                   | 342.540 ms                | 47.205 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.542 ms                  | 126.214 ms                |
| Forward                   | 4.970 ms                  | 410.709 ms                |
| back: bucket keys         | 732.660 us                | 1.316 ms                  |
| back: a2a                 | 14.908 ms                 | 314.937 ms                |
| back: cache               | 10.900 ms                 | 93.868 ms                 |
| back: aggr dram keys      | 49.388 ms                 | 131.620 ms                |
| back: set dram grad       | 6.864 ms                  | 35.485 ms                 |
| Backward                  | 230.835 ms                | 46.648 s                  |
| Optimize                  | 75.561 ms                 | 135.721 ms                |
| BarrierTimeBeforeRank0    | 53.918 us                 | 103.678 us                |
| BlockToStepN              | 48.256 us                 | 12.307 ms                 |
| OneStep                   | 326.265 ms                | 47.205 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.693 ms                  | 161.562 ms                |
| Forward                   | 5.002 ms                  | 410.709 ms                |
| back: bucket keys         | 732.660 us                | 1.316 ms                  |
| back: a2a                 | 14.501 ms                 | 314.937 ms                |
| back: cache               | 10.900 ms                 | 93.868 ms                 |
| back: aggr dram keys      | 49.036 ms                 | 131.620 ms                |
| back: set dram grad       | 6.846 ms                  | 35.485 ms                 |
| Backward                  | 211.336 ms                | 46.648 s                  |
| Optimize                  | 87.338 ms                 | 135.721 ms                |
| BarrierTimeBeforeRank0    | 49.743 us                 | 103.678 us                |
| BlockToStepN              | 42.734 us                 | 12.307 ms                 |
| OneStep                   | 305.315 ms                | 47.205 s                  |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.695 ms                  | 145.800 ms                |
| Forward                   | 5.005 ms                  | 6.805 ms                  |
| back: bucket keys         | 732.660 us                | 1.316 ms                  |
| back: a2a                 | 14.567 ms                 | 314.937 ms                |
| back: cache               | 10.900 ms                 | 93.868 ms                 |
| back: aggr dram keys      | 48.834 ms                 | 131.620 ms                |
| back: set dram grad       | 6.796 ms                  | 35.485 ms                 |
| Backward                  | 208.743 ms                | 569.050 ms                |
| Optimize                  | 87.666 ms                 | 120.561 ms                |
| BarrierTimeBeforeRank0    | 42.816 us                 | 100.325 us                |
| BlockToStepN              | 43.976 us                 | 12.307 ms                 |
| OneStep                   | 305.009 ms                | 730.608 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.542 ms                  | 145.800 ms                |
| Forward                   | 5.022 ms                  | 6.805 ms                  |
| back: bucket keys         | 766.277 us                | 1.316 ms                  |
| back: a2a                 | 14.606 ms                 | 176.018 ms                |
| back: cache               | 10.900 ms                 | 83.965 ms                 |
| back: aggr dram keys      | 48.834 ms                 | 96.467 ms                 |
| back: set dram grad       | 6.718 ms                  | 25.562 ms                 |
| Backward                  | 202.956 ms                | 569.050 ms                |
| Optimize                  | 87.666 ms                 | 123.649 ms                |
| BarrierTimeBeforeRank0    | 40.095 us                 | 100.325 us                |
| BlockToStepN              | 46.658 us                 | 12.747 ms                 |
| OneStep                   | 304.637 ms                | 730.608 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.294 ms                  | 161.562 ms                |
| Forward                   | 5.005 ms                  | 6.805 ms                  |
| back: bucket keys         | 509.262 us                | 1.325 ms                  |
| back: a2a                 | 14.847 ms                 | 176.018 ms                |
| back: cache               | 10.900 ms                 | 83.965 ms                 |
| back: aggr dram keys      | 49.036 ms                 | 96.467 ms                 |
| back: set dram grad       | 6.783 ms                  | 25.562 ms                 |
| Backward                  | 201.051 ms                | 569.050 ms                |
| Optimize                  | 87.282 ms                 | 123.649 ms                |
| BarrierTimeBeforeRank0    | 39.844 us                 | 100.325 us                |
| BlockToStepN              | 48.761 us                 | 12.747 ms                 |
| OneStep                   | 300.615 ms                | 730.608 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 82.728, sample: 2.614, forward: 0.896, backward: 61.468, update: 0.460
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 83.542, sample: 2.194, forward: 0.917, backward: 61.865, update: 0.365
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 79.559, sample: 1.513, forward: 0.881, backward: 62.619, update: 0.497
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 79.464, sample: 2.478, forward: 0.882, backward: 61.596, update: 0.515
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 80.484, sample: 2.093, forward: 0.937, backward: 61.981, update: 0.519
train_sampler.Prefill()
-------Step 0-------
tensor([24039304,   500739,   499385,   500753,   500783,   500810,  5019170,
          500832,   500851,   334227]) tensor([  185212, 41078790, 38857368,  5549603, 72976661, 27300993, 48994120,
        18135916, 78796379,  3731997])
-------Step 1-------
tensor([24039304,   500739,   499385,   500753,   500783,   500810,  5019170,
          500832,   500851,   334227]) tensor([81554820, 85401648,  4580247,  1418958, 66098859, 48797769, 30215123,
        58351473, 64509334, 28719678])
-------Step 2-------
tensor([   13985,    14006,    14029,    27215, 31666039,    14049, 27272300,
           14076, 24039304, 83223579]) tensor([ 8317545, 41228788, 17686511, 57068007, 66001558, 43223963, 48689616,
        35841079,  6820247, 18562347])
-------Step 3-------
tensor([   13985,    14006,    14029,    27215, 31666039,    14049, 27272300,
           14076, 24039304, 83223579]) tensor([22905773, 25294564,  9096790, 68850864,  9522948, 12126671, 12754311,
        86023770, 83031086, 82692199])
-------Step 4-------
tensor([ 601482,   24002,   74538, 9501335,   74561,  338624,   74580, 4438398,
          74611,  601499]) tensor([50978473, 77084476, 13250872, 26879157, 45175843, 57283118, 68209370,
        23839814, 31508038, 83272800])
-------Step 5-------
tensor([ 601482,   24002,   74538, 9501335,   74561,  338624,   74580, 4438398,
          74611,  601499]) tensor([ 4081806,    94873,  7284803, 75649842, 72505434, 46466086, 71260460,
        53384945, 59308752, 20287616])
-------Step 6-------
tensor([  134773,   134802, 24039304,   134819,    32992,   134840,   508250,
          508292, 39101960,  4431154]) tensor([39134549, 43512129, 32655947, 85499266, 59980451,  1103416, 13519125,
         4967396, 54081292, 22133543])
-------Step 7-------
tensor([  134773,   134802, 24039304,   134819,    32992,   134840,   508250,
          508292, 39101960,  4431154]) tensor([24951279, 25837004, 51544914, 60085467, 67023881, 12111458,  2135493,
        49537744, 50118687, 21018436])
-------Step 8-------
tensor([  205390,   193360,   193388,  5290395,  4309043,    76963,    44029,
           44046,   193414, 34693731]) tensor([82417600, 29231096, 78169374, 68889601,  6809730, 16186549, 27821550,
        26214017, 83173849, 28075598])
-------Step 9-------
tensor([  205390,   193360,   193388,  5290395,  4309043,    76963,    44029,
           44046,   193414, 34693731]) tensor([  625174, 43111802, 74316878, 28302923, 85341990, 58415027, 57688088,
        27165941, 62212887, 13752024])
before start barrier
start train
[proc 0] 100 steps, total: 81.108, sample: 1.702, forward: 0.901, backward: 68.433, update: 8.279
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.693 ms                  | 189.972 ms                |
| Forward                   | 5.005 ms                  | 6.805 ms                  |
| back: bucket keys         | 493.288 us                | 1.325 ms                  |
| back: a2a                 | 14.847 ms                 | 176.018 ms                |
| back: cache               | 10.900 ms                 | 83.965 ms                 |
| back: aggr dram keys      | 48.962 ms                 | 96.467 ms                 |
| back: set dram grad       | 6.723 ms                  | 25.562 ms                 |
| Backward                  | 196.289 ms                | 569.050 ms                |
| Optimize                  | 85.799 ms                 | 123.649 ms                |
| BarrierTimeBeforeRank0    | 39.791 us                 | 100.325 us                |
| BlockToStepN              | 47.908 us                 | 12.747 ms                 |
| OneStep                   | 296.012 ms                | 730.608 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.693 ms                  | 198.598 ms                |
| Forward                   | 4.999 ms                  | 6.805 ms                  |
| back: bucket keys         | 485.897 us                | 1.316 ms                  |
| back: a2a                 | 14.830 ms                 | 96.569 ms                 |
| back: cache               | 10.900 ms                 | 79.197 ms                 |
| back: aggr dram keys      | 48.953 ms                 | 90.008 ms                 |
| back: set dram grad       | 6.718 ms                  | 22.658 ms                 |
| Backward                  | 196.189 ms                | 569.050 ms                |
| Optimize                  | 80.354 ms                 | 123.649 ms                |
| BarrierTimeBeforeRank0    | 39.798 us                 | 100.325 us                |
| BlockToStepN              | 48.256 us                 | 14.627 ms                 |
| OneStep                   | 294.532 ms                | 730.608 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 93.26577472686768 seconds
before call kg_cache_controller.StopThreads()
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
INFO [9309 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.695 ms                  | 198.598 ms                |
| Forward                   | 4.987 ms                  | 6.805 ms                  |
| back: bucket keys         | 483.751 us                | 1.316 ms                  |
| back: a2a                 | 14.833 ms                 | 104.764 ms                |
| back: cache               | 10.900 ms                 | 79.197 ms                 |
| back: aggr dram keys      | 48.962 ms                 | 96.467 ms                 |
| back: set dram grad       | 6.718 ms                  | 22.658 ms                 |
| Backward                  | 196.816 ms                | 569.050 ms                |
| Optimize                  | 79.582 ms                 | 123.649 ms                |
| BarrierTimeBeforeRank0    | 39.791 us                 | 100.325 us                |
| BlockToStepN              | 48.609 us                 | 14.627 ms                 |
| OneStep                   | 294.665 ms                | 730.608 ms                |
+---------------------------+---------------------------+---------------------------+
