WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240205 22:02:22.835812 41078 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_53', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=6, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=6, gpu=[0, 1, 2, 3, 4, 5], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownShardedCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [41078 sampler.py:454] Start PreSampling
WARNING [41078 sampler.py:532] Before construct renumbering_dict
WARNING [41078 sampler.py:555] PreSampling done
W20240205 22:02:27.542843 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240205 22:02:27.543035 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240205 22:02:27.543087 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240205 22:02:27.543139 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240205 22:02:27.543185 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240205 22:02:27.543229 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240205 22:02:27.543289 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240205 22:02:27.543361 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240205 22:02:27.543414 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240205 22:02:27.543459 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240205 22:02:27.543514 41078 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240205 22:02:27.543555 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240205 22:02:27.543601 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240205 22:02:27.543769 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240205 22:02:27.543838 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240205 22:02:27.543880 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240205 22:02:27.543933 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240205 22:02:27.543977 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240205 22:02:27.544025 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240205 22:02:27.544076 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240205 22:02:27.544132 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240205 22:02:27.544178 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240205 22:02:27.544220 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240205 22:02:27.544261 41078 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240205 22:02:27.544296 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240205 22:02:27.544333 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240205 22:02:27.544412 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240205 22:02:27.544461 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240205 22:02:27.544502 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240205 22:02:27.544551 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240205 22:02:27.544600 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240205 22:02:27.544644 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240205 22:02:27.544690 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240205 22:02:27.544735 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240205 22:02:27.544786 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240205 22:02:27.544826 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240205 22:02:27.544872 41078 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240205 22:02:27.544906 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240205 22:02:27.544945 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240205 22:02:27.545034 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240205 22:02:27.545076 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240205 22:02:27.545120 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240205 22:02:27.545162 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240205 22:02:27.545212 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240205 22:02:27.545258 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240205 22:02:27.545320 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240205 22:02:27.545359 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240205 22:02:27.545399 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240205 22:02:27.545455 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240205 22:02:27.545506 41078 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240205 22:02:27.545539 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240205 22:02:27.545572 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240205 22:02:27.545657 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240205 22:02:27.545708 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240205 22:02:27.545753 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240205 22:02:27.545794 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240205 22:02:27.545836 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240205 22:02:27.545883 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240205 22:02:27.545936 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240205 22:02:27.545982 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240205 22:02:27.546037 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240205 22:02:27.546080 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240205 22:02:27.546129 41078 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240205 22:02:27.546164 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240205 22:02:27.546207 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240205 22:02:27.546284 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240205 22:02:27.546342 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240205 22:02:27.546396 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240205 22:02:27.546442 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240205 22:02:27.546504 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240205 22:02:27.546546 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240205 22:02:27.546592 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240205 22:02:27.546644 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240205 22:02:27.546691 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240205 22:02:27.546754 41078 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240205 22:02:27.546795 41078 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240205 22:02:27.546831 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240205 22:02:27.546865 41078 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240205 22:02:27.818938 41078 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10001ca5a000 22.81 MB
W20240205 22:02:27.912693 41078 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10001e12c000 58.4 kB
{0: Graph(num_nodes=9651, num_edges=125221,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10501, num_edges=116771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=7364, num_edges=103565,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=9587, num_edges=131823,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=8718, num_edges=169929,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=9639, num_edges=154972,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9651 N 125221 E
MertisPartition: part 1 has 10501 N 116771 E
MertisPartition: part 2 has 7364 N 103565 E
MertisPartition: part 3 has 9587 N 131823 E
MertisPartition: part 4 has 8718 N 169929 E
MertisPartition: part 5 has 9639 N 154972 E
Rank0: cached key size 124
Rank1: cached key size 124
Rank2: cached key size 124
Rank3: cached key size 124
Rank4: cached key size 124
Rank5: cached key size 124
Before renumbering graph:  {'_ID': tensor([    7,    16,    24,  ..., 10345,  3788,  5916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
After renumbering graph:  {'_ID': tensor([  955,  1178,  1388,  ...,  2419,  2007, 10034]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 4, 2])}
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9651, num_edges=125221,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.174 seconds
[Rank1] pid = 41283
[Rank2] pid = 41326
[Rank3] pid = 41412
[Rank4] pid = 41413
INFO [41078 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [41283 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [41412 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [41326 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [41413 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [41540 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [41540 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41412 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41413 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41326 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41078 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [41283 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
WARNING [41540 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [41413 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [41412 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [41326 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [41078 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [41283 DistTensor.py:59] The tensor name already exists in the kvstore
I20240205 22:02:30.189724 41284 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 6
I20240205 22:02:30.189812 41414 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240205 22:02:30.189905 41604 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240205 22:02:30.189971 41451 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240205 22:02:30.190052 41348 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
I20240205 22:02:30.190133 41541 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 6
E20240205 22:02:30.778441 41604 recstore.cc:66] init folly done
E20240205 22:02:30.778461 41451 recstore.cc:66] init folly done
E20240205 22:02:30.778695 41284 recstore.cc:66] init folly done
E20240205 22:02:30.778723 41414 recstore.cc:66] init folly done
E20240205 22:02:30.779209 41348 recstore.cc:66] init folly done
E20240205 22:02:30.779222 41541 recstore.cc:66] init folly done
I20240205 22:02:30.865550 41604 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 6
I20240205 22:02:30.865722 41284 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240205 22:02:30.865846 41348 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240205 22:02:30.875502 41414 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240205 22:02:30.876641 41541 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
I20240205 22:02:30.879477 41451 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.238 ms                  | 26.058 ms                 |
| bucket keys               | 2.322 ms                  | 133.444 ms                |
| forward: a2a keys         | 2.340 ms                  | 1.084 s                   |
| forward: search cache     | 341.415 us                | 22.709 ms                 |
| forward: a2a values       | 3.148 ms                  | 7.338 ms                  |
| forward: join             | 2.913 ms                  | 3.748 ms                  |
| Forward                   | 30.085 ms                 | 1.564 s                   |
| back: aggr dram keys      | 41.434 ms                 | 646.911 ms                |
| back: set dram grad       | 3.466 ms                  | 8.660 ms                  |
| back: a2a grad            | 6.499 ms                  | 15.636 ms                 |
| back: grad sum & grad cache  | 4.474 ms                  | 10.830 ms                 |
| Backward                  | 118.335 ms                | 960.734 ms                |
| Optimize                  | 29.951 ms                 | 60.993 ms                 |
| BarrierTimeBeforeRank0    | 77.601 us                 | 213.439 us                |
| BlockToStepN              | 24.626 us                 | 202.482 us                |
| OneStep                   | 178.514 ms                | 2.589 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.812 ms                  | 26.058 ms                 |
| bucket keys               | 2.273 ms                  | 3.132 ms                  |
| forward: a2a keys         | 1.917 ms                  | 11.347 ms                 |
| forward: search cache     | 335.771 us                | 2.536 ms                  |
| forward: a2a values       | 2.998 ms                  | 4.689 ms                  |
| forward: join             | 2.838 ms                  | 3.578 ms                  |
| Forward                   | 29.261 ms                 | 1.564 s                   |
| back: aggr dram keys      | 40.911 ms                 | 62.542 ms                 |
| back: set dram grad       | 3.463 ms                  | 8.635 ms                  |
| back: a2a grad            | 6.288 ms                  | 10.980 ms                 |
| back: grad sum & grad cache  | 4.493 ms                  | 10.064 ms                 |
| Backward                  | 113.913 ms                | 960.734 ms                |
| Optimize                  | 32.041 ms                 | 60.993 ms                 |
| BarrierTimeBeforeRank0    | 69.280 us                 | 285.613 us                |
| BlockToStepN              | 16.318 us                 | 202.482 us                |
| OneStep                   | 181.870 ms                | 2.589 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.996 ms                  | 26.958 ms                 |
| bucket keys               | 2.295 ms                  | 6.763 ms                  |
| forward: a2a keys         | 1.890 ms                  | 11.347 ms                 |
| forward: search cache     | 337.402 us                | 2.536 ms                  |
| forward: a2a values       | 2.973 ms                  | 4.689 ms                  |
| forward: join             | 2.833 ms                  | 3.748 ms                  |
| Forward                   | 29.081 ms                 | 41.355 ms                 |
| back: aggr dram keys      | 41.061 ms                 | 62.542 ms                 |
| back: set dram grad       | 3.415 ms                  | 8.660 ms                  |
| back: a2a grad            | 6.244 ms                  | 10.980 ms                 |
| back: grad sum & grad cache  | 4.390 ms                  | 10.064 ms                 |
| Backward                  | 112.661 ms                | 149.631 ms                |
| Optimize                  | 30.668 ms                 | 50.336 ms                 |
| BarrierTimeBeforeRank0    | 55.082 us                 | 278.867 us                |
| BlockToStepN              | 17.732 us                 | 662.526 us                |
| OneStep                   | 180.701 ms                | 261.178 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.812 ms                  | 27.216 ms                 |
| bucket keys               | 2.305 ms                  | 6.763 ms                  |
| forward: a2a keys         | 1.875 ms                  | 13.275 ms                 |
| forward: search cache     | 338.140 us                | 2.536 ms                  |
| forward: a2a values       | 2.973 ms                  | 4.591 ms                  |
| forward: join             | 2.833 ms                  | 3.748 ms                  |
| Forward                   | 29.061 ms                 | 52.663 ms                 |
| back: aggr dram keys      | 40.619 ms                 | 57.751 ms                 |
| back: set dram grad       | 3.431 ms                  | 8.635 ms                  |
| back: a2a grad            | 6.227 ms                  | 10.555 ms                 |
| back: grad sum & grad cache  | 4.407 ms                  | 8.694 ms                  |
| Backward                  | 112.137 ms                | 149.631 ms                |
| Optimize                  | 30.231 ms                 | 50.336 ms                 |
| BarrierTimeBeforeRank0    | 50.541 us                 | 278.867 us                |
| BlockToStepN              | 17.701 us                 | 662.526 us                |
| OneStep                   | 180.477 ms                | 261.178 ms                |
+---------------------------+---------------------------+---------------------------+
[Rank5] pid = 41540
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownShardedCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482)]
train_sampler.Prefill()
-------Step 0-------
tensor([   96,  7517,  8340,   906, 14154,  6481,   121,  7486,  9727,  2790]) tensor([ 1388,    23,  4497,  6068,    44, 10652,  9581, 13501,  1590, 10609])
-------Step 1-------
tensor([   96,  7517,  8340,   906, 14154,  6481,   121,  7486,  9727,  2790]) tensor([ 5633,  3115,   375,  6970,  6130, 14471,  2570, 11932, 11633,  8983])
-------Step 2-------
tensor([ 1426,  3295, 14154,  5320,  8238, 10771,    57, 12856,  8628,  5053]) tensor([ 5618, 10598,  5339, 14190,  7612,  7452,  6333,  5983,  1983, 11369])
-------Step 3-------
tensor([ 1426,  3295, 14154,  5320,  8238, 10771,    57, 12856,  8628,  5053]) tensor([ 6269,  2808,  4023, 12215,  9407,   458,  7834,  4203,   225,  3015])
-------Step 4-------
tensor([   91,  3472,  9838, 10306,  9636,  2668, 14154, 10437,  8180,  8435]) tensor([ 3136,  4282,  2530,  1827, 14126, 13547,  7842, 10623, 10724,  3160])
-------Step 5-------
tensor([   91,  3472,  9838, 10306,  9636,  2668, 14154, 10437,  8180,  8435]) tensor([ 6275, 11880,   580, 10873,  8971,  7632, 12895,   519, 10183,  2099])
-------Step 6-------
tensor([ 7399, 14412, 10184,  2639,  4612,   130,     4, 12683,    91,    56]) tensor([10925,  6042,  2796,  8236,  1304,   434,  4540, 12092,  1973,  3258])
-------Step 7-------
tensor([ 7399, 14412, 10184,  2639,  4612,   130,     4, 12683,    91,    56]) tensor([14505,   253,  8596,  5616, 14845,  9682,  7747,  5365,  6230,  6005])
-------Step 8-------
tensor([3749, 3357, 1280,  734, 3613, 2292, 5705,  114, 9211,    4]) tensor([10479,  3647,  1963,  9065, 11449, 11242,  8644,  6739,  3902, 11417])
-------Step 9-------
tensor([3749, 3357, 1280,  734, 3613, 2292, 5705,  114, 9211,    4]) tensor([ 9110, 13722,  8970,  8847,  2078,  7770,   447,  5840,  3730,  2613])
before start barrier
start train
[proc 0] 100 steps, total: 20.626, sample: 0.489, forward: 4.554, backward: 12.284, update: 3.171
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 20.637, sample: 0.407, forward: 4.583, backward: 12.123, update: 0.545
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 20.628, sample: 0.449, forward: 4.544, backward: 12.134, update: 0.546
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 20.623, sample: 0.449, forward: 4.543, backward: 12.129, update: 0.554
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 20.637, sample: 0.444, forward: 4.555, backward: 12.082, update: 0.517
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 20.637, sample: 0.461, forward: 4.544, backward: 12.130, update: 0.539
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.812 ms                  | 27.982 ms                 |
| bucket keys               | 2.301 ms                  | 6.763 ms                  |
| forward: a2a keys         | 1.814 ms                  | 27.358 ms                 |
| forward: search cache     | 337.531 us                | 2.536 ms                  |
| forward: a2a values       | 2.956 ms                  | 4.591 ms                  |
| forward: join             | 2.840 ms                  | 3.772 ms                  |
| Forward                   | 29.002 ms                 | 54.805 ms                 |
| back: aggr dram keys      | 40.738 ms                 | 57.751 ms                 |
| back: set dram grad       | 3.415 ms                  | 8.635 ms                  |
| back: a2a grad            | 6.207 ms                  | 10.555 ms                 |
| back: grad sum & grad cache  | 4.401 ms                  | 8.694 ms                  |
| Backward                  | 112.137 ms                | 149.631 ms                |
| Optimize                  | 30.310 ms                 | 50.336 ms                 |
| BarrierTimeBeforeRank0    | 49.921 us                 | 278.867 us                |
| BlockToStepN              | 17.224 us                 | 662.526 us                |
| OneStep                   | 181.813 ms                | 261.178 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.727 ms                  | 27.982 ms                 |
| bucket keys               | 2.296 ms                  | 6.763 ms                  |
| forward: a2a keys         | 1.814 ms                  | 27.511 ms                 |
| forward: search cache     | 337.548 us                | 2.536 ms                  |
| forward: a2a values       | 2.955 ms                  | 4.591 ms                  |
| forward: join             | 2.840 ms                  | 3.748 ms                  |
| Forward                   | 29.182 ms                 | 55.055 ms                 |
| back: aggr dram keys      | 40.659 ms                 | 57.148 ms                 |
| back: set dram grad       | 3.408 ms                  | 8.570 ms                  |
| back: a2a grad            | 6.207 ms                  | 10.370 ms                 |
| back: grad sum & grad cache  | 4.394 ms                  | 7.774 ms                  |
| Backward                  | 111.679 ms                | 149.631 ms                |
| Optimize                  | 30.310 ms                 | 50.336 ms                 |
| BarrierTimeBeforeRank0    | 49.889 us                 | 278.867 us                |
| BlockToStepN              | 17.237 us                 | 662.526 us                |
| OneStep                   | 182.663 ms                | 261.178 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.674 ms                  | 27.266 ms                 |
| bucket keys               | 2.296 ms                  | 6.763 ms                  |
| forward: a2a keys         | 1.817 ms                  | 28.194 ms                 |
| forward: search cache     | 336.769 us                | 2.536 ms                  |
| forward: a2a values       | 2.962 ms                  | 4.591 ms                  |
| forward: join             | 2.833 ms                  | 3.748 ms                  |
| Forward                   | 29.417 ms                 | 55.055 ms                 |
| back: aggr dram keys      | 40.659 ms                 | 57.148 ms                 |
| back: set dram grad       | 3.400 ms                  | 8.570 ms                  |
| back: a2a grad            | 6.209 ms                  | 10.370 ms                 |
| back: grad sum & grad cache  | 4.359 ms                  | 8.005 ms                  |
| Backward                  | 111.792 ms                | 136.675 ms                |
| Optimize                  | 30.083 ms                 | 47.467 ms                 |
| BarrierTimeBeforeRank0    | 48.752 us                 | 213.439 us                |
| BlockToStepN              | 17.009 us                 | 202.482 us                |
| OneStep                   | 183.301 ms                | 232.532 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.674 ms                  | 27.266 ms                 |
| bucket keys               | 2.293 ms                  | 6.763 ms                  |
| forward: a2a keys         | 1.828 ms                  | 28.065 ms                 |
| forward: search cache     | 336.549 us                | 607.883 us                |
| forward: a2a values       | 2.981 ms                  | 5.426 ms                  |
| forward: join             | 2.828 ms                  | 3.578 ms                  |
| Forward                   | 29.682 ms                 | 56.327 ms                 |
| back: aggr dram keys      | 40.619 ms                 | 54.910 ms                 |
| back: set dram grad       | 3.371 ms                  | 8.513 ms                  |
| back: a2a grad            | 6.173 ms                  | 10.272 ms                 |
| back: grad sum & grad cache  | 4.313 ms                  | 8.472 ms                  |
| Backward                  | 111.545 ms                | 136.675 ms                |
| Optimize                  | 30.231 ms                 | 47.467 ms                 |
| BarrierTimeBeforeRank0    | 46.951 us                 | 213.439 us                |
| BlockToStepN              | 16.665 us                 | 583.010 us                |
| OneStep                   | 183.976 ms                | 232.532 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 18.881, sample: 0.494, forward: 4.032, backward: 11.209, update: 3.029
[proc 1] 200 steps, total: 18.880, sample: 0.421, forward: 4.070, backward: 11.005, update: 0.455
[proc 5] 200 steps, total: 18.881, sample: 0.443, forward: 4.054, backward: 11.045, update: 0.507
[proc 3] 200 steps, total: 18.881, sample: 0.438, forward: 4.051, backward: 11.057, update: 0.498
[proc 4] 200 steps, total: 18.880, sample: 0.444, forward: 4.035, backward: 11.055, update: 0.418
[proc 2] 200 steps, total: 18.880, sample: 0.410, forward: 4.088, backward: 11.045, update: 0.475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.669 ms                  | 27.266 ms                 |
| bucket keys               | 2.295 ms                  | 4.034 ms                  |
| forward: a2a keys         | 1.823 ms                  | 27.890 ms                 |
| forward: search cache     | 336.596 us                | 582.344 us                |
| forward: a2a values       | 2.998 ms                  | 4.689 ms                  |
| forward: join             | 2.816 ms                  | 3.570 ms                  |
| Forward                   | 29.804 ms                 | 56.327 ms                 |
| back: aggr dram keys      | 40.614 ms                 | 54.910 ms                 |
| back: set dram grad       | 3.366 ms                  | 8.513 ms                  |
| back: a2a grad            | 6.170 ms                  | 10.272 ms                 |
| back: grad sum & grad cache  | 4.297 ms                  | 8.694 ms                  |
| Backward                  | 111.679 ms                | 136.675 ms                |
| Optimize                  | 30.083 ms                 | 47.467 ms                 |
| BarrierTimeBeforeRank0    | 47.347 us                 | 273.098 us                |
| BlockToStepN              | 16.571 us                 | 583.010 us                |
| OneStep                   | 184.412 ms                | 232.532 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.669 ms                  | 27.982 ms                 |
| bucket keys               | 2.304 ms                  | 4.034 ms                  |
| forward: a2a keys         | 1.814 ms                  | 27.890 ms                 |
| forward: search cache     | 337.315 us                | 582.344 us                |
| forward: a2a values       | 3.002 ms                  | 5.426 ms                  |
| forward: join             | 2.818 ms                  | 3.578 ms                  |
| Forward                   | 29.804 ms                 | 56.171 ms                 |
| back: aggr dram keys      | 40.519 ms                 | 54.910 ms                 |
| back: set dram grad       | 3.358 ms                  | 8.570 ms                  |
| back: a2a grad            | 6.138 ms                  | 10.265 ms                 |
| back: grad sum & grad cache  | 4.276 ms                  | 8.472 ms                  |
| Backward                  | 111.237 ms                | 135.490 ms                |
| Optimize                  | 29.960 ms                 | 45.494 ms                 |
| BarrierTimeBeforeRank0    | 47.293 us                 | 213.439 us                |
| BlockToStepN              | 16.455 us                 | 306.151 us                |
| OneStep                   | 183.806 ms                | 220.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.642 ms                  | 27.982 ms                 |
| bucket keys               | 2.310 ms                  | 3.908 ms                  |
| forward: a2a keys         | 1.814 ms                  | 27.518 ms                 |
| forward: search cache     | 337.445 us                | 521.177 us                |
| forward: a2a values       | 3.003 ms                  | 5.426 ms                  |
| forward: join             | 2.812 ms                  | 3.570 ms                  |
| Forward                   | 29.804 ms                 | 56.171 ms                 |
| back: aggr dram keys      | 40.423 ms                 | 54.350 ms                 |
| back: set dram grad       | 3.347 ms                  | 8.513 ms                  |
| back: a2a grad            | 6.126 ms                  | 10.207 ms                 |
| back: grad sum & grad cache  | 4.258 ms                  | 8.005 ms                  |
| Backward                  | 111.039 ms                | 135.490 ms                |
| Optimize                  | 29.326 ms                 | 45.494 ms                 |
| BarrierTimeBeforeRank0    | 47.156 us                 | 213.439 us                |
| BlockToStepN              | 16.453 us                 | 306.151 us                |
| OneStep                   | 183.674 ms                | 220.218 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 5] 300 steps, total: 18.463, sample: 0.427, forward: 3.774, backward: 11.037, update: 0.370
[proc 0] 300 steps, total: 18.463, sample: 0.447, forward: 3.804, backward: 11.185, update: 2.912
[proc 4] 300 steps, total: 18.463, sample: 0.374, forward: 3.812, backward: 11.048, update: 0.267
[proc 1] 300 steps, total: 18.463, sample: 0.414, forward: 3.785, backward: 11.002, update: 0.446
[proc 3] 300 steps, total: 18.463, sample: 0.472, forward: 3.717, backward: 11.068, update: 0.467
[proc 2] 300 steps, total: 18.463, sample: 0.416, forward: 3.782, backward: 11.053, update: 0.461
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.630 ms                  | 27.982 ms                 |
| bucket keys               | 2.316 ms                  | 3.908 ms                  |
| forward: a2a keys         | 1.807 ms                  | 27.890 ms                 |
| forward: search cache     | 337.548 us                | 526.131 us                |
| forward: a2a values       | 3.008 ms                  | 5.426 ms                  |
| forward: join             | 2.810 ms                  | 3.570 ms                  |
| Forward                   | 29.693 ms                 | 56.171 ms                 |
| back: aggr dram keys      | 40.481 ms                 | 54.910 ms                 |
| back: set dram grad       | 3.344 ms                  | 8.513 ms                  |
| back: a2a grad            | 6.108 ms                  | 10.207 ms                 |
| back: grad sum & grad cache  | 4.256 ms                  | 8.005 ms                  |
| Backward                  | 110.871 ms                | 135.490 ms                |
| Optimize                  | 29.124 ms                 | 45.494 ms                 |
| BarrierTimeBeforeRank0    | 47.271 us                 | 213.439 us                |
| BlockToStepN              | 16.538 us                 | 583.010 us                |
| OneStep                   | 183.674 ms                | 220.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.630 ms                  | 27.982 ms                 |
| bucket keys               | 2.322 ms                  | 3.908 ms                  |
| forward: a2a keys         | 1.780 ms                  | 28.065 ms                 |
| forward: search cache     | 337.664 us                | 526.131 us                |
| forward: a2a values       | 3.010 ms                  | 5.426 ms                  |
| forward: join             | 2.810 ms                  | 3.526 ms                  |
| Forward                   | 29.693 ms                 | 56.327 ms                 |
| back: aggr dram keys      | 40.494 ms                 | 54.910 ms                 |
| back: set dram grad       | 3.349 ms                  | 8.513 ms                  |
| back: a2a grad            | 6.108 ms                  | 9.834 ms                  |
| back: grad sum & grad cache  | 4.275 ms                  | 7.774 ms                  |
| Backward                  | 110.871 ms                | 135.490 ms                |
| Optimize                  | 29.305 ms                 | 45.494 ms                 |
| BarrierTimeBeforeRank0    | 47.364 us                 | 213.439 us                |
| BlockToStepN              | 16.453 us                 | 583.010 us                |
| OneStep                   | 183.674 ms                | 220.218 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.624 ms                  | 27.266 ms                 |
| bucket keys               | 2.327 ms                  | 4.034 ms                  |
| forward: a2a keys         | 1.750 ms                  | 28.065 ms                 |
| forward: search cache     | 337.468 us                | 526.131 us                |
| forward: a2a values       | 3.003 ms                  | 5.501 ms                  |
| forward: join             | 2.808 ms                  | 3.526 ms                  |
| Forward                   | 29.797 ms                 | 56.289 ms                 |
| back: aggr dram keys      | 40.476 ms                 | 54.910 ms                 |
| back: set dram grad       | 3.353 ms                  | 8.570 ms                  |
| back: a2a grad            | 6.116 ms                  | 9.834 ms                  |
| back: grad sum & grad cache  | 4.280 ms                  | 7.774 ms                  |
| Backward                  | 110.824 ms                | 135.140 ms                |
| Optimize                  | 29.250 ms                 | 45.208 ms                 |
| BarrierTimeBeforeRank0    | 47.364 us                 | 230.118 us                |
| BlockToStepN              | 16.455 us                 | 503.197 us                |
| OneStep                   | 183.976 ms                | 218.150 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.628 ms                  | 28.308 ms                 |
| bucket keys               | 2.328 ms                  | 3.908 ms                  |
| forward: a2a keys         | 1.743 ms                  | 28.065 ms                 |
| forward: search cache     | 337.908 us                | 521.177 us                |
| forward: a2a values       | 3.008 ms                  | 5.426 ms                  |
| forward: join             | 2.816 ms                  | 3.494 ms                  |
| Forward                   | 29.813 ms                 | 56.289 ms                 |
| back: aggr dram keys      | 40.481 ms                 | 54.910 ms                 |
| back: set dram grad       | 3.353 ms                  | 8.513 ms                  |
| back: a2a grad            | 6.118 ms                  | 9.754 ms                  |
| back: grad sum & grad cache  | 4.291 ms                  | 8.005 ms                  |
| Backward                  | 110.752 ms                | 135.140 ms                |
| Optimize                  | 29.025 ms                 | 45.208 ms                 |
| BarrierTimeBeforeRank0    | 47.347 us                 | 230.118 us                |
| BlockToStepN              | 16.453 us                 | 503.197 us                |
| OneStep                   | 183.976 ms                | 218.150 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 18.548, sample: 0.417, forward: 3.800, backward: 11.071, update: 0.476
[proc 4] 400 steps, total: 18.549, sample: 0.443, forward: 3.754, backward: 11.091, update: 0.458
[proc 0] 400 steps, total: 18.549, sample: 0.500, forward: 3.759, backward: 11.223, update: 2.951
[proc 1] 400 steps, total: 18.548, sample: 0.414, forward: 3.795, backward: 11.019, update: 0.448
[proc 3] 400 steps, total: 18.548, sample: 0.421, forward: 3.782, backward: 11.086, update: 0.477
[proc 5] 400 steps, total: 18.549, sample: 0.401, forward: 3.817, backward: 11.069, update: 0.472
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.630 ms                  | 28.308 ms                 |
| bucket keys               | 2.330 ms                  | 3.908 ms                  |
| forward: a2a keys         | 1.750 ms                  | 28.065 ms                 |
| forward: search cache     | 338.067 us                | 521.177 us                |
| forward: a2a values       | 3.008 ms                  | 5.426 ms                  |
| forward: join             | 2.818 ms                  | 3.526 ms                  |
| Forward                   | 30.003 ms                 | 56.327 ms                 |
| back: aggr dram keys      | 40.476 ms                 | 54.910 ms                 |
| back: set dram grad       | 3.353 ms                  | 8.513 ms                  |
| back: a2a grad            | 6.093 ms                  | 9.754 ms                  |
| back: grad sum & grad cache  | 4.278 ms                  | 8.005 ms                  |
| Backward                  | 110.752 ms                | 135.140 ms                |
| Optimize                  | 29.177 ms                 | 45.208 ms                 |
| BarrierTimeBeforeRank0    | 47.364 us                 | 230.118 us                |
| BlockToStepN              | 16.533 us                 | 503.197 us                |
| OneStep                   | 184.655 ms                | 218.150 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.634 ms                  | 28.308 ms                 |
| bucket keys               | 2.330 ms                  | 3.908 ms                  |
| forward: a2a keys         | 1.756 ms                  | 27.890 ms                 |
| forward: search cache     | 338.140 us                | 521.177 us                |
| forward: a2a values       | 3.012 ms                  | 4.689 ms                  |
| forward: join             | 2.818 ms                  | 3.526 ms                  |
| Forward                   | 30.001 ms                 | 59.039 ms                 |
| back: aggr dram keys      | 40.481 ms                 | 54.671 ms                 |
| back: set dram grad       | 3.351 ms                  | 8.471 ms                  |
| back: a2a grad            | 6.086 ms                  | 9.754 ms                  |
| back: grad sum & grad cache  | 4.269 ms                  | 7.774 ms                  |
| Backward                  | 110.752 ms                | 135.140 ms                |
| Optimize                  | 29.177 ms                 | 45.208 ms                 |
| BarrierTimeBeforeRank0    | 47.364 us                 | 245.327 us                |
| BlockToStepN              | 16.538 us                 | 503.197 us                |
| OneStep                   | 184.499 ms                | 218.150 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.644 ms                  | 27.982 ms                 |
| bucket keys               | 2.330 ms                  | 3.908 ms                  |
| forward: a2a keys         | 1.752 ms                  | 28.167 ms                 |
| forward: search cache     | 338.098 us                | 521.177 us                |
| forward: a2a values       | 3.010 ms                  | 4.689 ms                  |
| forward: join             | 2.818 ms                  | 3.570 ms                  |
| Forward                   | 30.085 ms                 | 58.975 ms                 |
| back: aggr dram keys      | 40.481 ms                 | 54.671 ms                 |
| back: set dram grad       | 3.343 ms                  | 8.471 ms                  |
| back: a2a grad            | 6.087 ms                  | 10.128 ms                 |
| back: grad sum & grad cache  | 4.265 ms                  | 7.774 ms                  |
| Backward                  | 110.752 ms                | 132.139 ms                |
| Optimize                  | 29.289 ms                 | 44.755 ms                 |
| BarrierTimeBeforeRank0    | 47.602 us                 | 230.118 us                |
| BlockToStepN              | 16.533 us                 | 306.151 us                |
| OneStep                   | 184.757 ms                | 217.677 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.645 ms                  | 28.308 ms                 |
| bucket keys               | 2.330 ms                  | 3.908 ms                  |
| forward: a2a keys         | 1.750 ms                  | 28.065 ms                 |
| forward: search cache     | 338.098 us                | 512.968 us                |
| forward: a2a values       | 3.011 ms                  | 5.501 ms                  |
| forward: join             | 2.819 ms                  | 3.578 ms                  |
| Forward                   | 30.177 ms                 | 59.039 ms                 |
| back: aggr dram keys      | 40.481 ms                 | 54.350 ms                 |
| back: set dram grad       | 3.341 ms                  | 8.471 ms                  |
| back: a2a grad            | 6.070 ms                  | 10.128 ms                 |
| back: grad sum & grad cache  | 4.258 ms                  | 7.685 ms                  |
| Backward                  | 110.730 ms                | 132.139 ms                |
| Optimize                  | 29.305 ms                 | 44.755 ms                 |
| BarrierTimeBeforeRank0    | 47.388 us                 | 230.118 us                |
| BlockToStepN              | 16.455 us                 | 306.151 us                |
| OneStep                   | 185.170 ms                | 217.677 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 4] 500 steps, total: 18.600, sample: 0.421, forward: 3.866, backward: 11.007, update: 0.447
[proc 2] 500 steps, total: 18.600, sample: 0.366, forward: 3.939, backward: 11.011, update: 0.492
[proc 3] 500 steps, total: 18.600, sample: 0.397, forward: 3.896, backward: 11.020, update: 0.482
[proc 0] 500 steps, total: 18.600, sample: 0.459, forward: 3.888, backward: 11.146, update: 2.986
[proc 1] 500 steps, total: 18.600, sample: 0.411, forward: 3.890, backward: 10.958, update: 0.462
Successfully xmh. training takes 95.11990332603455 seconds
[proc 5] 500 steps, total: 18.600, sample: 0.399, forward: 3.917, backward: 10.991, update: 0.504
before call kg_cache_controller.StopThreads()
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
INFO [41078 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
