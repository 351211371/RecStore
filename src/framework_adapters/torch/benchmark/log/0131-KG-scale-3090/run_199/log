WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 10:59:40.717842 59813 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_1', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [59813 sampler.py:454] Start PreSampling
WARNING [59813 sampler.py:532] Before construct renumbering_dict
WARNING [59813 sampler.py:555] PreSampling done
W20240206 11:18:42.667292 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 11:18:42.667502 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 11:18:42.667546 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 11:18:42.667584 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 11:18:42.667618 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 11:18:42.667649 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 11:18:42.667686 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 11:18:42.667726 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 11:18:42.667759 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 11:18:42.667788 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 11:18:42.667824 59813 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 11:18:42.667850 59813 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 11:18:42.667876 59813 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 11:18:42.668042 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 11:18:42.668100 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 11:18:42.668128 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 11:18:42.668179 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 11:18:42.668211 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 11:18:42.668241 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 11:18:42.668277 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 11:18:42.668313 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 11:18:42.668339 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 11:18:42.668382 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 11:18:42.668412 59813 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 11:18:42.668438 59813 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 11:18:42.668462 59813 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 11:18:42.668529 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 11:18:42.668566 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 11:18:42.668594 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 11:18:42.668627 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 11:18:42.668663 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 11:18:42.668696 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 11:18:42.668730 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 11:18:42.668757 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 11:18:42.668792 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 11:18:42.668824 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 11:18:42.668853 59813 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 11:18:42.668875 59813 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 11:18:42.668898 59813 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 11:18:42.668960 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 11:18:42.668990 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 11:18:42.669023 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 11:18:42.669054 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 11:18:42.669086 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 11:18:42.669121 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 11:18:42.669158 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 11:18:42.669193 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 11:18:42.669221 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 11:18:42.669252 59813 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 11:18:42.669281 59813 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 11:18:42.669302 59813 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 11:18:42.669325 59813 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 11:18:43.103309 59813 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240206 11:27:16.439956 59813 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 4302705,  4302735,   104194,  ..., 70131594, 16370986,  2471385]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2158.642 seconds
[Rank1] pid = 60886
[Rank2] pid = 60981
INFO [59813 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [60981 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [61050 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [60886 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [60886 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [61050 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [59813 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [60981 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240206 11:35:45.508468 60887 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240206 11:35:45.508507 61114 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240206 11:35:45.508702 61051 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240206 11:35:45.512789 60982 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240206 11:35:45.549688 61114 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102036615000 7.629 MB
W20240206 11:35:45.549754 60887 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x102036db8000 7.629 MB
W20240206 11:35:45.549855 61114 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10203755b000 7.629 MB
W20240206 11:35:45.549901 60887 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102037cfe000 7.629 MB
W20240206 11:35:45.549911 61114 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1020384a1000 1.49 GB
W20240206 11:35:45.549961 61114 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102097a84000 1.49 GB
W20240206 11:35:45.549966 60887 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1020f7067000 1.49 GB
W20240206 11:35:45.550014 61114 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 11:35:45.550025 60887 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10215664a000 1.49 GB
W20240206 11:35:45.550072 60887 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 11:35:45.563483 61114 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 11:35:45.563508 60887 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 11:35:45.563647 61051 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1021b5c33000 7.629 MB
W20240206 11:35:45.563877 61051 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1021b63d6000 7.629 MB
W20240206 11:35:45.563959 61051 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1021b6b79000 1.49 GB
W20240206 11:35:45.564028 61051 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10221615c000 1.49 GB
W20240206 11:35:45.564123 61051 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 11:35:45.568656 61051 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 11:35:45.586333 60982 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102275749000 7.629 MB
W20240206 11:35:45.586652 60982 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102275eec000 7.629 MB
W20240206 11:35:45.586714 60982 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10227668f000 1.49 GB
W20240206 11:35:45.586771 60982 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022d5c72000 1.49 GB
W20240206 11:35:45.586867 60982 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 11:35:45.588707 60982 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [60886 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [60981 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank3] pid = 61050
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [59813 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [61050 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 11:36:18.698467 61114 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240206 11:36:18.698668 61051 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240206 11:36:18.698710 60982 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240206 11:36:18.698818 60887 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240206 11:36:19.136718 61114 recstore.cc:66] init folly done
E20240206 11:36:19.136775 60887 recstore.cc:66] init folly done
E20240206 11:36:19.136771 61051 recstore.cc:66] init folly done
E20240206 11:36:19.136775 60982 recstore.cc:66] init folly done
I20240206 11:36:30.418138 61114 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240206 11:36:32.980280 60887 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240206 11:36:33.883314 60982 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240206 11:36:34.876344 61051 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.143 ms                  | 93.517 ms                 |
| Forward                   | 4.714 ms                  | 402.583 ms                |
| back: bucket keys         | 307.411 us                | 18.773 ms                 |
| back: a2a                 | 12.526 ms                 | 854.947 ms                |
| back: cache               | 8.851 ms                  | 41.559 ms                 |
| back: aggr dram keys      | 37.699 ms                 | 474.558 ms                |
| back: set dram grad       | 4.212 ms                  | 13.961 ms                 |
| Backward                  | 162.680 ms                | 1.692 s                   |
| Optimize                  | 40.353 ms                 | 84.864 ms                 |
| BarrierTimeBeforeRank0    | 66.122 us                 | 89.116 us                 |
| BlockToStepN              | 21.819 us                 | 30.040 ms                 |
| OneStep                   | 221.894 ms                | 2.192 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.387 ms                  | 106.847 ms                |
| Forward                   | 4.714 ms                  | 402.583 ms                |
| back: bucket keys         | 321.422 us                | 868.182 us                |
| back: a2a                 | 12.468 ms                 | 136.686 ms                |
| back: cache               | 8.851 ms                  | 40.084 ms                 |
| back: aggr dram keys      | 35.170 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.198 ms                  | 14.331 ms                 |
| Backward                  | 140.577 ms                | 1.692 s                   |
| Optimize                  | 39.773 ms                 | 84.864 ms                 |
| BarrierTimeBeforeRank0    | 46.691 us                 | 89.116 us                 |
| BlockToStepN              | 30.227 us                 | 30.040 ms                 |
| OneStep                   | 193.381 ms                | 2.192 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.105 ms                  | 106.847 ms                |
| Forward                   | 4.686 ms                  | 8.784 ms                  |
| back: bucket keys         | 322.367 us                | 868.182 us                |
| back: a2a                 | 12.353 ms                 | 136.686 ms                |
| back: cache               | 8.851 ms                  | 40.084 ms                 |
| back: aggr dram keys      | 34.448 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.362 ms                 |
| Backward                  | 134.970 ms                | 267.962 ms                |
| Optimize                  | 39.316 ms                 | 57.150 ms                 |
| BarrierTimeBeforeRank0    | 43.319 us                 | 68.063 us                 |
| BlockToStepN              | 22.006 us                 | 5.522 ms                  |
| OneStep                   | 188.237 ms                | 414.264 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.260 ms                  | 106.847 ms                |
| Forward                   | 4.668 ms                  | 8.784 ms                  |
| back: bucket keys         | 322.367 us                | 845.242 us                |
| back: a2a                 | 12.353 ms                 | 129.002 ms                |
| back: cache               | 8.851 ms                  | 31.526 ms                 |
| back: aggr dram keys      | 34.686 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.331 ms                 |
| Backward                  | 135.673 ms                | 267.962 ms                |
| Optimize                  | 39.454 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 36.753 us                 | 68.063 us                 |
| BlockToStepN              | 22.928 us                 | 21.255 ms                 |
| OneStep                   | 188.396 ms                | 414.264 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 23.288, sample: 1.253, forward: 0.845, backward: 11.258, update: 0.425
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 26.753, sample: 1.058, forward: 0.853, backward: 11.504, update: 0.485
train_sampler.Prefill()
-------Step 0-------
tensor([   54456,   546531, 38508362,   966729,   454634,   546559,   546591,
          214783,    54488,    54519]) tensor([ 5034452, 31347847, 19560272, 59429869, 62776179, 29736043, 70762239,
        76798407, 56195458, 68604302])
-------Step 1-------
tensor([   54456,   546531, 38508362,   966729,   454634,   546559,   546591,
          214783,    54488,    54519]) tensor([34407497, 63686054, 81294543, 11455778, 49584688,  9564642, 84675645,
        68110490, 14924477, 33546995])
-------Step 2-------
tensor([  623359,    66944, 78892425,    66980,   623379,   623406,   623432,
        43871832,   623456,   623480]) tensor([41431834,  5067652, 68192607, 11947980, 17688738, 14252452, 68610797,
         8546282, 48290145, 27769525])
-------Step 3-------
tensor([  623359,    66944, 78892425,    66980,   623379,   623406,   623432,
        43871832,   623456,   623480]) tensor([15849093, 51828438, 80465131, 45525250, 12848872, 76790821, 59001196,
        67685318, 19290654, 65551589])
-------Step 4-------
tensor([698595,  80192, 698616, 698638,  80226, 698658,  80264, 698687,  80303,
        698713]) tensor([75325145, 33667069, 20741529, 11952979, 63287356, 37310629, 68584999,
        40603603, 46665985, 10371135])
-------Step 5-------
tensor([698595,  80192, 698616, 698638,  80226, 698658,  80264, 698687,  80303,
        698713]) tensor([40104970, 37925451, 83868922, 10309543, 42762452, 26109919, 41616082,
        77585676, 83964991,   546771])
-------Step 6-------
tensor([63630606,   774419,   774444,   774475,  4309557,   774503,   774529,
          774554,   774584,   220263]) tensor([32271249, 36275525, 21348441, 16919755, 80616642, 46643404, 48558373,
        13111655, 74819700,  9259525])
-------Step 7-------
tensor([63630606,   774419,   774444,   774475,  4309557,   774503,   774529,
          774554,   774584,   220263]) tensor([32044779, 86007514, 44270896, 59623962, 57731173,  1674680, 21030601,
        51645949, 17099084, 13249118])
-------Step 8-------
tensor([  852278,   107558,   852308, 40664450,   992930,   852328,   852345,
          852380,   221915,   992949]) tensor([26843509, 46264805, 53262422, 85768257, 69186773, 53519751, 50077165,
        81923916, 11691032,  3240626])
-------Step 9-------
tensor([  852278,   107558,   852308, 40664450,   992930,   852328,   852345,
          852380,   221915,   992949]) tensor([62311359, 53415489, 20841089, 48749543, 10348688,  1069994, 17227518,
        15913422, 68716622, 47210339])
before start barrier
start train
[proc 0] 100 steps, total: 22.294, sample: 1.302, forward: 0.875, backward: 15.935, update: 4.023
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 24.191, sample: 1.960, forward: 0.881, backward: 10.970, update: 0.440
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.834 ms                  | 106.847 ms                |
| Forward                   | 4.714 ms                  | 8.784 ms                  |
| back: bucket keys         | 354.746 us                | 845.242 us                |
| back: a2a                 | 12.318 ms                 | 129.002 ms                |
| back: cache               | 8.851 ms                  | 40.084 ms                 |
| back: aggr dram keys      | 34.448 ms                 | 62.192 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.331 ms                 |
| Backward                  | 137.197 ms                | 267.962 ms                |
| Optimize                  | 39.577 ms                 | 63.653 ms                 |
| BarrierTimeBeforeRank0    | 35.933 us                 | 68.063 us                 |
| BlockToStepN              | 22.866 us                 | 21.255 ms                 |
| OneStep                   | 188.749 ms                | 414.264 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.769 ms                  | 107.355 ms                |
| Forward                   | 4.647 ms                  | 14.175 ms                 |
| back: bucket keys         | 357.379 us                | 845.242 us                |
| back: a2a                 | 12.308 ms                 | 105.808 ms                |
| back: cache               | 8.851 ms                  | 35.467 ms                 |
| back: aggr dram keys      | 34.279 ms                 | 62.192 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.280 ms                 |
| Backward                  | 137.197 ms                | 267.962 ms                |
| Optimize                  | 39.454 ms                 | 63.653 ms                 |
| BarrierTimeBeforeRank0    | 35.933 us                 | 68.063 us                 |
| BlockToStepN              | 23.376 us                 | 21.255 ms                 |
| OneStep                   | 188.749 ms                | 414.264 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.862 ms                  | 119.776 ms                |
| Forward                   | 4.638 ms                  | 9.195 ms                  |
| back: bucket keys         | 354.746 us                | 845.242 us                |
| back: a2a                 | 12.203 ms                 | 105.808 ms                |
| back: cache               | 22.336 ms                 | 35.467 ms                 |
| back: aggr dram keys      | 34.304 ms                 | 62.192 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.362 ms                 |
| Backward                  | 136.295 ms                | 250.191 ms                |
| Optimize                  | 39.464 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 35.822 us                 | 67.514 us                 |
| BlockToStepN              | 22.915 us                 | 13.995 ms                 |
| OneStep                   | 188.749 ms                | 405.827 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.917 ms                  | 158.739 ms                |
| Forward                   | 4.681 ms                  | 9.195 ms                  |
| back: bucket keys         | 354.746 us                | 844.657 us                |
| back: a2a                 | 12.179 ms                 | 86.046 ms                 |
| back: cache               | 22.336 ms                 | 35.467 ms                 |
| back: aggr dram keys      | 34.439 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.346 ms                 |
| Backward                  | 135.673 ms                | 250.191 ms                |
| Optimize                  | 39.516 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 35.752 us                 | 67.514 us                 |
| BlockToStepN              | 22.455 us                 | 13.995 ms                 |
| OneStep                   | 187.736 ms                | 405.827 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 20.224, sample: 2.094, forward: 0.451, backward: 8.871, update: 0.375
[proc 3] 200 steps, total: 20.224, sample: 1.527, forward: 0.474, backward: 9.452, update: 0.427
[proc 0] 200 steps, total: 20.224, sample: 1.844, forward: 0.477, backward: 13.933, update: 3.887
[proc 1] 200 steps, total: 20.224, sample: 1.581, forward: 0.487, backward: 9.680, update: 0.373
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.977 ms                  | 158.739 ms                |
| Forward                   | 4.672 ms                  | 14.175 ms                 |
| back: bucket keys         | 357.379 us                | 846.205 us                |
| back: a2a                 | 12.130 ms                 | 92.449 ms                 |
| back: cache               | 22.336 ms                 | 40.084 ms                 |
| back: aggr dram keys      | 34.531 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.362 ms                 |
| Backward                  | 135.988 ms                | 250.191 ms                |
| Optimize                  | 39.456 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 35.663 us                 | 67.514 us                 |
| BlockToStepN              | 22.778 us                 | 13.995 ms                 |
| OneStep                   | 188.260 ms                | 413.555 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.008 ms                  | 163.764 ms                |
| Forward                   | 4.657 ms                  | 14.175 ms                 |
| back: bucket keys         | 357.379 us                | 845.242 us                |
| back: a2a                 | 12.101 ms                 | 86.046 ms                 |
| back: cache               | 22.336 ms                 | 40.084 ms                 |
| back: aggr dram keys      | 34.492 ms                 | 60.734 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.362 ms                 |
| Backward                  | 135.988 ms                | 250.191 ms                |
| Optimize                  | 39.464 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 35.584 us                 | 67.514 us                 |
| BlockToStepN              | 22.928 us                 | 14.499 ms                 |
| OneStep                   | 188.260 ms                | 413.555 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.283 ms                  | 163.764 ms                |
| Forward                   | 4.654 ms                  | 14.175 ms                 |
| back: bucket keys         | 353.650 us                | 846.205 us                |
| back: a2a                 | 12.075 ms                 | 86.046 ms                 |
| back: cache               | 22.336 ms                 | 40.084 ms                 |
| back: aggr dram keys      | 34.448 ms                 | 60.734 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.362 ms                 |
| Backward                  | 135.824 ms                | 228.185 ms                |
| Optimize                  | 39.456 ms                 | 57.150 ms                 |
| BarrierTimeBeforeRank0    | 35.584 us                 | 66.122 us                 |
| BlockToStepN              | 22.455 us                 | 14.499 ms                 |
| OneStep                   | 188.396 ms                | 410.294 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.426 ms                  | 169.239 ms                |
| Forward                   | 4.647 ms                  | 14.175 ms                 |
| back: bucket keys         | 353.650 us                | 845.242 us                |
| back: a2a                 | 12.073 ms                 | 84.399 ms                 |
| back: cache               | 22.336 ms                 | 38.107 ms                 |
| back: aggr dram keys      | 34.448 ms                 | 57.230 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.346 ms                 |
| Backward                  | 136.295 ms                | 228.185 ms                |
| Optimize                  | 39.430 ms                 | 57.150 ms                 |
| BarrierTimeBeforeRank0    | 35.553 us                 | 66.122 us                 |
| BlockToStepN              | 22.229 us                 | 14.849 ms                 |
| OneStep                   | 188.746 ms                | 410.294 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 20.472, sample: 1.025, forward: 0.458, backward: 9.831, update: 0.408
[proc 2] 300 steps, total: 20.472, sample: 2.005, forward: 0.496, backward: 8.783, update: 0.367
[proc 1] 300 steps, total: 20.472, sample: 1.169, forward: 0.448, backward: 10.028, update: 0.312
[proc 0] 300 steps, total: 20.472, sample: 1.854, forward: 0.494, backward: 14.005, update: 3.953
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.445 ms                  | 169.640 ms                |
| Forward                   | 4.641 ms                  | 14.175 ms                 |
| back: bucket keys         | 353.650 us                | 845.242 us                |
| back: a2a                 | 12.073 ms                 | 84.399 ms                 |
| back: cache               | 22.336 ms                 | 38.107 ms                 |
| back: aggr dram keys      | 34.439 ms                 | 60.734 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.346 ms                 |
| Backward                  | 136.295 ms                | 228.185 ms                |
| Optimize                  | 39.477 ms                 | 57.150 ms                 |
| BarrierTimeBeforeRank0    | 35.388 us                 | 66.122 us                 |
| BlockToStepN              | 22.407 us                 | 15.392 ms                 |
| OneStep                   | 188.602 ms                | 410.294 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.528 ms                  | 169.640 ms                |
| Forward                   | 4.638 ms                  | 14.175 ms                 |
| back: bucket keys         | 349.549 us                | 845.242 us                |
| back: a2a                 | 12.073 ms                 | 84.399 ms                 |
| back: cache               | 22.336 ms                 | 38.107 ms                 |
| back: aggr dram keys      | 34.461 ms                 | 60.734 ms                 |
| back: set dram grad       | 4.155 ms                  | 14.346 ms                 |
| Backward                  | 136.605 ms                | 234.115 ms                |
| Optimize                  | 39.484 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 35.302 us                 | 66.122 us                 |
| BlockToStepN              | 22.554 us                 | 15.392 ms                 |
| OneStep                   | 189.731 ms                | 410.294 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.426 ms                  | 169.640 ms                |
| Forward                   | 4.664 ms                  | 9.195 ms                  |
| back: bucket keys         | 353.650 us                | 849.600 us                |
| back: a2a                 | 12.032 ms                 | 84.399 ms                 |
| back: cache               | 22.336 ms                 | 40.084 ms                 |
| back: aggr dram keys      | 34.447 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.136 ms                  | 14.362 ms                 |
| Backward                  | 136.353 ms                | 228.185 ms                |
| Optimize                  | 39.491 ms                 | 57.150 ms                 |
| BarrierTimeBeforeRank0    | 35.279 us                 | 66.110 us                 |
| BlockToStepN              | 23.361 us                 | 14.849 ms                 |
| OneStep                   | 188.780 ms                | 409.137 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.450 ms                  | 169.640 ms                |
| Forward                   | 4.654 ms                  | 9.195 ms                  |
| back: bucket keys         | 353.650 us                | 849.575 us                |
| back: a2a                 | 12.022 ms                 | 72.509 ms                 |
| back: cache               | 22.336 ms                 | 38.107 ms                 |
| back: aggr dram keys      | 34.421 ms                 | 60.734 ms                 |
| back: set dram grad       | 4.136 ms                  | 14.349 ms                 |
| Backward                  | 135.824 ms                | 228.185 ms                |
| Optimize                  | 39.515 ms                 | 57.150 ms                 |
| BarrierTimeBeforeRank0    | 35.194 us                 | 66.122 us                 |
| BlockToStepN              | 23.909 us                 | 16.475 ms                 |
| OneStep                   | 188.749 ms                | 409.137 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 20.195, sample: 1.601, forward: 0.462, backward: 13.986, update: 3.964
[proc 3] 400 steps, total: 20.195, sample: 0.982, forward: 0.433, backward: 9.661, update: 0.401
[proc 1] 400 steps, total: 20.195, sample: 1.125, forward: 0.484, backward: 9.849, update: 0.441
[proc 2] 400 steps, total: 20.195, sample: 1.346, forward: 0.486, backward: 9.201, update: 0.358
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.450 ms                  | 169.719 ms                |
| Forward                   | 4.654 ms                  | 9.195 ms                  |
| back: bucket keys         | 353.650 us                | 849.600 us                |
| back: a2a                 | 12.016 ms                 | 72.509 ms                 |
| back: cache               | 22.336 ms                 | 38.107 ms                 |
| back: aggr dram keys      | 34.427 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.135 ms                  | 14.409 ms                 |
| Backward                  | 135.988 ms                | 228.185 ms                |
| Optimize                  | 39.491 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 35.074 us                 | 66.122 us                 |
| BlockToStepN              | 24.454 us                 | 20.189 ms                 |
| OneStep                   | 188.746 ms                | 409.137 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.615 ms                  | 169.719 ms                |
| Forward                   | 4.622 ms                  | 9.195 ms                  |
| back: bucket keys         | 353.650 us                | 849.588 us                |
| back: a2a                 | 12.017 ms                 | 71.910 ms                 |
| back: cache               | 22.414 ms                 | 36.232 ms                 |
| back: aggr dram keys      | 34.448 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.135 ms                  | 14.437 ms                 |
| Backward                  | 135.988 ms                | 228.185 ms                |
| Optimize                  | 39.515 ms                 | 58.977 ms                 |
| BarrierTimeBeforeRank0    | 34.979 us                 | 66.122 us                 |
| BlockToStepN              | 25.458 us                 | 20.189 ms                 |
| OneStep                   | 188.749 ms                | 409.137 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.657 ms                  | 169.640 ms                |
| Forward                   | 4.624 ms                  | 8.784 ms                  |
| back: bucket keys         | 354.746 us                | 849.588 us                |
| back: a2a                 | 11.989 ms                 | 71.910 ms                 |
| back: cache               | 22.414 ms                 | 36.232 ms                 |
| back: aggr dram keys      | 34.498 ms                 | 61.712 ms                 |
| back: set dram grad       | 4.135 ms                  | 14.485 ms                 |
| Backward                  | 136.046 ms                | 227.889 ms                |
| Optimize                  | 39.484 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 34.877 us                 | 66.122 us                 |
| BlockToStepN              | 25.838 us                 | 16.563 ms                 |
| OneStep                   | 188.749 ms                | 405.827 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.874 ms                  | 169.640 ms                |
| Forward                   | 4.622 ms                  | 8.784 ms                  |
| back: bucket keys         | 349.549 us                | 849.575 us                |
| back: a2a                 | 11.984 ms                 | 70.812 ms                 |
| back: cache               | 22.414 ms                 | 36.061 ms                 |
| back: aggr dram keys      | 34.530 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.113 ms                  | 14.485 ms                 |
| Backward                  | 135.778 ms                | 227.889 ms                |
| Optimize                  | 39.477 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 34.844 us                 | 66.122 us                 |
| BlockToStepN              | 26.090 us                 | 16.563 ms                 |
| OneStep                   | 188.569 ms                | 405.827 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 19.958, sample: 1.176, forward: 0.533, backward: 9.581, update: 0.367
[proc 3] 500 steps, total: 19.958, sample: 0.947, forward: 0.441, backward: 9.566, update: 0.407
[proc 0] 500 steps, total: 19.958, sample: 1.696, forward: 0.454, backward: 13.808, update: 3.920
[proc 2] 500 steps, total: 19.958, sample: 1.610, forward: 0.480, backward: 8.842, update: 0.389
Successfully xmh. training takes 103.14438939094543 seconds
before call kg_cache_controller.StopThreads()
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
INFO [59813 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.874 ms                  | 169.640 ms                |
| Forward                   | 4.622 ms                  | 8.784 ms                  |
| back: bucket keys         | 353.650 us                | 849.575 us                |
| back: a2a                 | 11.984 ms                 | 70.812 ms                 |
| back: cache               | 22.444 ms                 | 36.061 ms                 |
| back: aggr dram keys      | 34.518 ms                 | 61.598 ms                 |
| back: set dram grad       | 4.113 ms                  | 14.692 ms                 |
| Backward                  | 135.835 ms                | 227.889 ms                |
| Optimize                  | 39.505 ms                 | 57.680 ms                 |
| BarrierTimeBeforeRank0    | 34.656 us                 | 66.122 us                 |
| BlockToStepN              | 26.023 us                 | 16.563 ms                 |
| OneStep                   | 188.724 ms                | 405.827 ms                |
+---------------------------+---------------------------+---------------------------+
