WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240207 00:34:23.443599 16317 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_20', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [16317 sampler.py:454] Start PreSampling
WARNING [16317 sampler.py:532] Before construct renumbering_dict
WARNING [16317 sampler.py:555] PreSampling done
W20240207 00:54:31.985378 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240207 00:54:31.985574 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240207 00:54:31.985620 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240207 00:54:31.985662 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240207 00:54:31.985695 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240207 00:54:31.985730 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240207 00:54:31.985770 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240207 00:54:31.985803 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240207 00:54:31.985831 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240207 00:54:31.985859 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240207 00:54:31.985891 16317 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240207 00:54:31.985919 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240207 00:54:31.985949 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240207 00:54:31.986122 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240207 00:54:31.986162 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240207 00:54:31.986196 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240207 00:54:31.986238 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240207 00:54:31.986270 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240207 00:54:31.986299 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240207 00:54:31.986332 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240207 00:54:31.986368 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240207 00:54:31.986402 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240207 00:54:31.986433 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240207 00:54:31.986459 16317 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240207 00:54:31.986483 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240207 00:54:31.986511 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240207 00:54:31.986565 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240207 00:54:31.986600 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240207 00:54:31.986625 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240207 00:54:31.986662 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240207 00:54:31.986688 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240207 00:54:31.986724 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240207 00:54:31.986763 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240207 00:54:31.986795 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240207 00:54:31.986821 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240207 00:54:31.986855 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240207 00:54:31.986886 16317 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240207 00:54:31.986910 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240207 00:54:31.986932 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240207 00:54:31.986995 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240207 00:54:31.987027 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240207 00:54:31.987053 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240207 00:54:31.987083 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240207 00:54:31.987109 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240207 00:54:31.987145 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240207 00:54:31.987176 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240207 00:54:31.987208 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240207 00:54:31.987238 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240207 00:54:31.987269 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240207 00:54:31.987301 16317 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240207 00:54:31.987323 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240207 00:54:31.987346 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240207 00:54:31.987397 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240207 00:54:31.987432 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240207 00:54:31.987457 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240207 00:54:31.987484 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240207 00:54:31.987517 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240207 00:54:31.987547 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240207 00:54:31.987586 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240207 00:54:31.987612 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240207 00:54:31.987644 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240207 00:54:31.987671 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240207 00:54:31.987704 16317 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240207 00:54:31.987726 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240207 00:54:31.987748 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240207 00:54:31.987795 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240207 00:54:31.987824 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240207 00:54:31.987861 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240207 00:54:31.987890 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240207 00:54:31.987923 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240207 00:54:31.987952 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240207 00:54:31.987983 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240207 00:54:31.988010 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240207 00:54:31.988044 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240207 00:54:31.988087 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240207 00:54:31.988121 16317 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240207 00:54:31.988143 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240207 00:54:31.988171 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240207 00:54:31.988224 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240207 00:54:31.988253 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240207 00:54:31.988288 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240207 00:54:31.988315 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240207 00:54:31.988343 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240207 00:54:31.988377 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240207 00:54:31.988411 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240207 00:54:31.988440 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240207 00:54:31.988469 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240207 00:54:31.988510 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240207 00:54:31.988538 16317 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240207 00:54:31.988560 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240207 00:54:31.988582 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240207 00:54:31.988632 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240207 00:54:31.988662 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240207 00:54:31.988694 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240207 00:54:31.988729 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240207 00:54:31.988759 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240207 00:54:31.988794 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240207 00:54:31.988824 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240207 00:54:31.988858 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240207 00:54:31.988891 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240207 00:54:31.988922 16317 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240207 00:54:31.988951 16317 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240207 00:54:31.988974 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240207 00:54:31.988996 16317 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240207 00:54:32.416231 16317 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240207 01:03:04.485946 16317 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 1075676
Rank1: cached key size 1075676
Rank2: cached key size 1075676
Rank3: cached key size 1075676
Rank4: cached key size 1075676
Rank5: cached key size 1075676
Rank6: cached key size 1075676
Rank7: cached key size 1075676
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 8605439,  8605470,    60886,  ..., 58165600, 53812676,  9219831]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2224.454 seconds
[Rank1] pid = 17497
[Rank2] pid = 17593
[Rank3] pid = 17664
[Rank4] pid = 17731
[Rank5] pid = 17798
[Rank6] pid = 17866
INFO [16317 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [17497 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [17664 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [17593 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [17798 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [17731 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [17866 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [17935 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [16317 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17866 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17798 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17935 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17731 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17497 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17593 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [17664 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240207 01:11:38.681041 17999 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
W20240207 01:11:38.682731 17936 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [8605415, 400]; dev=7; size=12.82 GB
W20240207 01:11:38.682864 17799 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [8605415, 400]; dev=5; size=12.82 GB
W20240207 01:11:38.682869 17867 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [8605415, 400]; dev=6; size=12.82 GB
W20240207 01:11:38.682871 17732 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [8605415, 400]; dev=4; size=12.82 GB
W20240207 01:11:38.683279 17498 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240207 01:11:38.684700 17665 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
W20240207 01:11:38.684700 17594 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240207 01:11:38.830559 17936 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1020497a9000 7.629 MB
W20240207 01:11:38.830572 17867 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x102049f4e000 7.629 MB
W20240207 01:11:38.830641 17999 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204a6f1000 7.629 MB
W20240207 01:11:38.830708 17732 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204ae94000 7.629 MB
W20240207 01:11:38.830725 17498 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204b637000 7.629 MB
W20240207 01:11:38.830835 17999 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10204bdda000 7.629 MB
W20240207 01:11:38.830861 17732 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10204c57d000 7.629 MB
W20240207 01:11:38.830865 17498 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10204cd20000 7.629 MB
W20240207 01:11:38.830883 17936 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10204d4c3000 7.629 MB
W20240207 01:11:38.830885 17867 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10204dc66000 7.629 MB
W20240207 01:11:38.830890 17999 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10204e409000 1.49 GB
W20240207 01:11:38.830926 17999 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1020ad9ec000 1.49 GB
W20240207 01:11:38.830942 17732 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10210cfcf000 1.49 GB
W20240207 01:11:38.830953 17498 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10216c5b2000 1.49 GB
W20240207 01:11:38.830960 17936 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1021cbb95000 1.49 GB
W20240207 01:11:38.830972 17999 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 01:11:38.830988 17867 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10222b17a000 1.49 GB
W20240207 01:11:38.830996 17732 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10228a75d000 1.49 GB
W20240207 01:11:38.831007 17498 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1022e9d40000 1.49 GB
W20240207 01:11:38.831024 17936 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x102349323000 1.49 GB
W20240207 01:11:38.831048 17867 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1023a8906000 1.49 GB
W20240207 01:11:38.831056 17732 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240207 01:11:38.831058 17498 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 01:11:38.831074 17936 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240207 01:11:38.831092 17867 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240207 01:11:38.831240 17665 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102407ee9000 7.629 MB
W20240207 01:11:38.831413 17665 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10240868e000 7.629 MB
W20240207 01:11:38.831488 17665 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x102408e31000 1.49 GB
W20240207 01:11:38.831519 17594 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102468414000 7.629 MB
W20240207 01:11:38.831559 17665 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x102468bb7000 1.49 GB
W20240207 01:11:38.831627 17665 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240207 01:11:38.831673 17594 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1024c819a000 7.629 MB
W20240207 01:11:38.831733 17594 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1024c893d000 1.49 GB
W20240207 01:11:38.831768 17594 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102527f20000 1.49 GB
W20240207 01:11:38.831804 17594 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 01:11:38.843644 17799 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102587505000 7.629 MB
W20240207 01:11:38.843771 17999 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 01:11:38.843816 17498 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 01:11:38.843844 17732 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240207 01:11:38.843844 17799 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x102587cb6000 7.629 MB
W20240207 01:11:38.843850 17665 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240207 01:11:38.843852 17867 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240207 01:11:38.843854 17594 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240207 01:11:38.843868 17936 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240207 01:11:38.843945 17799 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x102588459000 1.49 GB
W20240207 01:11:38.844029 17799 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x1025e7a3c000 1.49 GB
W20240207 01:11:38.844128 17799 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240207 01:11:38.857507 17799 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [17731 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 17935
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660), (34421660, 43027075), (43027075, 51632490), (51632490, 60237905), (60237905, 68843320)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [16317 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [17935 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [17798 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [17866 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [17664 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [17593 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [17497 DistTensor.py:59] The tensor name already exists in the kvstore
I20240207 01:12:31.578563 17498 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240207 01:12:31.578991 17936 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240207 01:12:31.579111 17732 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240207 01:12:31.579231 17999 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240207 01:12:31.579336 17665 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240207 01:12:31.579432 17799 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240207 01:12:31.579540 17867 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240207 01:12:31.579785 17594 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240207 01:12:31.582060 17999 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240207 01:12:31.582376 17999 grad_base.h:184] Init GradProcessingBase done
I20240207 01:12:43.816068 17999 grad_async_v1.h:203] Use main thread to update emb.
W20240207 01:12:43.816196 17999 kg_controller.h:75] after init GradAsyncProcessing
I20240207 01:12:43.816205 17999 kg_controller.h:84] Construct KGCacheController done
E20240207 01:12:44.617288 17732 recstore.cc:66] init folly done
E20240207 01:12:44.618492 17594 recstore.cc:66] init folly done
E20240207 01:12:44.618507 17665 recstore.cc:66] init folly done
E20240207 01:12:44.618525 17867 recstore.cc:66] init folly done
E20240207 01:12:44.618549 17936 recstore.cc:66] init folly done
E20240207 01:12:44.618758 17999 recstore.cc:66] init folly done
E20240207 01:12:44.618759 17799 recstore.cc:66] init folly done
E20240207 01:12:44.618764 17498 recstore.cc:66] init folly done
I20240207 01:12:44.619956 17999 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240207 01:13:06.435875 17799 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240207 01:13:06.549090 17936 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240207 01:13:06.688170 17732 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240207 01:13:07.557334 17594 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240207 01:13:08.606705 17665 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240207 01:13:08.622499 17498 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240207 01:13:09.514174 17999 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240207 01:13:09.741948 17867 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.982 ms                  | 7.982 ms                  |
| Forward                   | 537.682 ms                | 537.682 ms                |
| Backward                  | 213.647 ms                | 213.647 ms                |
| Optimize                  | 46.600 ms                 | 46.600 ms                 |
| BarrierTimeBeforeRank0    | 76.769 us                 | 76.769 us                 |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:11.860281 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240207 01:13:12.908624 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240207 01:13:13.954499 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.542 ms                  | 345.981 ms                |
| ProcessBack:UpdateCache   | 10.593 ms                 | 677.097 ms                |
| ProcessBack:UpsertPq      | 40.224 ms                 | 49.458 ms                 |
| ProcessOneStep            | 63.871 ms                 | 1.311 s                   |
| BlockToStepN              | 9.536 ms                  | 843.945 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:15.109390 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240207 01:13:16.113096 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=8, pq.top=8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.698 ms                  | 88.983 ms                 |
| Forward                   | 5.869 ms                  | 537.682 ms                |
| Backward                  | 10.354 ms                 | 213.647 ms                |
| Optimize                  | 3.760 ms                  | 46.600 ms                 |
| BarrierTimeBeforeRank0    | 7.401 ms                  | 41.579 ms                 |
| AfterBackward             | 65.840 ms                 | 1.311 s                   |
| BlockToStepN              | 9.615 ms                  | 846.008 ms                |
| OneStep                   | 188.138 ms                | 2.965 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:17.115151 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=10, pq.top=10
W20240207 01:13:18.128031 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=12, pq.top=12
W20240207 01:13:19.188113 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=14, pq.top=14
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.913 ms                  | 345.981 ms                |
| ProcessBack:UpdateCache   | 10.314 ms                 | 677.097 ms                |
| ProcessBack:UpsertPq      | 40.943 ms                 | 49.458 ms                 |
| ProcessOneStep            | 66.579 ms                 | 1.311 s                   |
| BlockToStepN              | 9.536 ms                  | 843.945 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:20.258016 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=16, pq.top=16
W20240207 01:13:21.534534 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.982 ms                  | 88.983 ms                 |
| Forward                   | 5.413 ms                  | 537.682 ms                |
| Backward                  | 10.475 ms                 | 213.647 ms                |
| Optimize                  | 2.580 ms                  | 46.600 ms                 |
| BarrierTimeBeforeRank0    | 104.228 us                | 41.579 ms                 |
| AfterBackward             | 68.907 ms                 | 1.311 s                   |
| BlockToStepN              | 9.615 ms                  | 846.008 ms                |
| OneStep                   | 188.138 ms                | 2.965 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:22.587639 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240207 01:13:24.060330 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.403 ms                  | 345.981 ms                |
| ProcessBack:UpdateCache   | 9.654 ms                  | 677.097 ms                |
| ProcessBack:UpsertPq      | 44.167 ms                 | 117.072 ms                |
| ProcessOneStep            | 76.936 ms                 | 1.311 s                   |
| BlockToStepN              | 9.536 ms                  | 843.945 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:25.338023 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
W20240207 01:13:26.374742 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.983 ms                  | 430.674 ms                |
| Forward                   | 5.413 ms                  | 537.682 ms                |
| Backward                  | 10.475 ms                 | 213.647 ms                |
| Optimize                  | 2.802 ms                  | 46.600 ms                 |
| BarrierTimeBeforeRank0    | 436.704 us                | 76.438 ms                 |
| AfterBackward             | 83.688 ms                 | 1.311 s                   |
| BlockToStepN              | 9.615 ms                  | 846.008 ms                |
| OneStep                   | 316.684 ms                | 2.965 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:27.476056 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240207 01:13:28.483043 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=30, pq.top=30
W20240207 01:13:29.483008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.214 ms                  | 314.089 ms                |
| ProcessBack:UpdateCache   | 9.859 ms                  | 673.096 ms                |
| ProcessBack:UpsertPq      | 45.402 ms                 | 109.448 ms                |
| ProcessOneStep            | 70.416 ms                 | 1.311 s                   |
| BlockToStepN              | 9.536 ms                  | 905.191 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:30.483007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240207 01:13:31.483011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.188 ms                 | 430.674 ms                |
| Forward                   | 5.388 ms                  | 537.682 ms                |
| Backward                  | 10.451 ms                 | 213.647 ms                |
| Optimize                  | 2.754 ms                  | 46.600 ms                 |
| BarrierTimeBeforeRank0    | 76.769 us                 | 76.438 ms                 |
| AfterBackward             | 69.467 ms                 | 1.311 s                   |
| BlockToStepN              | 9.615 ms                  | 905.259 ms                |
| OneStep                   | 316.684 ms                | 2.965 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:32.483011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
W20240207 01:13:33.483009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240207 01:13:34.483008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.205 ms                  | 314.089 ms                |
| ProcessBack:UpdateCache   | 9.633 ms                  | 673.096 ms                |
| ProcessBack:UpsertPq      | 44.167 ms                 | 109.448 ms                |
| ProcessOneStep            | 69.237 ms                 | 1.311 s                   |
| BlockToStepN              | 9.536 ms                  | 905.191 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:35.483008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.216 ms                 | 430.674 ms                |
| Forward                   | 5.319 ms                  | 537.682 ms                |
| Backward                  | 10.490 ms                 | 213.647 ms                |
| Optimize                  | 2.754 ms                  | 46.600 ms                 |
| BarrierTimeBeforeRank0    | 42.973 us                 | 76.438 ms                 |
| AfterBackward             | 67.801 ms                 | 1.311 s                   |
| BlockToStepN              | 9.615 ms                  | 905.259 ms                |
| OneStep                   | 316.684 ms                | 2.965 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:36.637334 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
W20240207 01:13:37.794948 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240207 01:13:39.047000 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.083 ms                  | 314.089 ms                |
| ProcessBack:UpdateCache   | 9.596 ms                  | 673.096 ms                |
| ProcessBack:UpsertPq      | 42.673 ms                 | 109.448 ms                |
| ProcessOneStep            | 67.636 ms                 | 134.884 ms                |
| BlockToStepN              | 9.536 ms                  | 901.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:40.046008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
W20240207 01:13:41.046010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.585 ms                 | 220.175 ms                |
| Forward                   | 5.388 ms                  | 18.126 ms                 |
| Backward                  | 10.466 ms                 | 14.859 ms                 |
| Optimize                  | 2.634 ms                  | 27.571 ms                 |
| BarrierTimeBeforeRank0    | 46.660 us                 | 41.579 ms                 |
| AfterBackward             | 67.419 ms                 | 134.921 ms                |
| BlockToStepN              | 9.615 ms                  | 901.747 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:42.046010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240207 01:13:43.046010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240207 01:13:44.046006 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.073 ms                  | 314.089 ms                |
| ProcessBack:UpdateCache   | 9.560 ms                  | 673.096 ms                |
| ProcessBack:UpsertPq      | 40.943 ms                 | 109.448 ms                |
| ProcessOneStep            | 67.381 ms                 | 134.884 ms                |
| BlockToStepN              | 9.536 ms                  | 901.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:45.046007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240207 01:13:46.046006 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.188 ms                 | 224.305 ms                |
| Forward                   | 5.413 ms                  | 18.126 ms                 |
| Backward                  | 10.466 ms                 | 14.859 ms                 |
| Optimize                  | 2.656 ms                  | 27.571 ms                 |
| BarrierTimeBeforeRank0    | 46.660 us                 | 41.579 ms                 |
| AfterBackward             | 67.665 ms                 | 134.921 ms                |
| BlockToStepN              | 9.615 ms                  | 901.747 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:47.046005 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240207 01:13:48.046008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
W20240207 01:13:49.046008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.083 ms                  | 41.307 ms                 |
| ProcessBack:UpdateCache   | 9.562 ms                  | 32.604 ms                 |
| ProcessBack:UpsertPq      | 40.811 ms                 | 97.251 ms                 |
| ProcessOneStep            | 67.773 ms                 | 134.884 ms                |
| BlockToStepN              | 9.536 ms                  | 901.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:50.046006 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240207 01:13:51.046007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.530 ms                  | 224.305 ms                |
| Forward                   | 5.337 ms                  | 18.126 ms                 |
| Backward                  | 10.466 ms                 | 14.859 ms                 |
| Optimize                  | 2.713 ms                  | 27.571 ms                 |
| BarrierTimeBeforeRank0    | 50.853 us                 | 41.579 ms                 |
| AfterBackward             | 68.270 ms                 | 134.921 ms                |
| BlockToStepN              | 9.615 ms                  | 901.747 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:52.046010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240207 01:13:53.046010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240207 01:13:54.224153 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.073 ms                  | 41.307 ms                 |
| ProcessBack:UpdateCache   | 9.705 ms                  | 32.604 ms                 |
| ProcessBack:UpsertPq      | 41.952 ms                 | 99.431 ms                 |
| ProcessOneStep            | 68.871 ms                 | 134.884 ms                |
| BlockToStepN              | 9.536 ms                  | 901.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:55.260834 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240207 01:13:56.260007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.032 ms                  | 263.783 ms                |
| Forward                   | 5.380 ms                  | 18.126 ms                 |
| Backward                  | 10.348 ms                 | 14.859 ms                 |
| Optimize                  | 2.713 ms                  | 27.571 ms                 |
| BarrierTimeBeforeRank0    | 104.228 us                | 54.458 ms                 |
| AfterBackward             | 68.907 ms                 | 134.921 ms                |
| BlockToStepN              | 9.615 ms                  | 901.747 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:13:57.260007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240207 01:13:58.260007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
W20240207 01:13:59.260006 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.033 ms                  | 41.307 ms                 |
| ProcessBack:UpdateCache   | 9.788 ms                  | 32.604 ms                 |
| ProcessBack:UpsertPq      | 41.936 ms                 | 99.431 ms                 |
| ProcessOneStep            | 69.437 ms                 | 134.884 ms                |
| BlockToStepN              | 9.536 ms                  | 901.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:00.260010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 54.537, sample: 1.323, forward: 0.988, backward: 1.256, update: 0.332
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 53.415, sample: 1.503, forward: 1.018, backward: 1.308, update: 0.283
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 51.231, sample: 1.409, forward: 1.035, backward: 1.256, update: 0.308
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 54.423, sample: 1.183, forward: 1.058, backward: 0.870, update: 0.285
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 54.285, sample: 1.406, forward: 1.074, backward: 1.129, update: 0.296
train_sampler.Prefill()
-------Step 0-------
tensor([  167902,   167933,   167956,   167985, 10010017,   841046, 59379497,
        22777929, 23339177,   168014]) tensor([ 9437466, 20576993, 55784882, 62379617, 22135338, 35680083, 42375425,
        82247956, 77518489, 34773408])
-------Step 1-------
tensor([  167902,   167933,   167956,   167985, 10010017,   841046, 59379497,
        22777929, 23339177,   168014]) tensor([ 3843617, 32066878, 13956235, 82797342, 77530781, 48793588, 78724423,
        47274100, 37173160, 17949047])
-------Step 2-------
tensor([  232570,   232594,   232626,   283399,   232647,   232670, 84648255,
        27181065,   232698,   232729]) tensor([76250327, 25520477, 75220558, 45917267, 48265992, 29382665, 74918642,
        45138677, 16955769, 47911306])
-------Step 3-------
tensor([  232570,   232594,   232626,   283399,   232647,   232670, 84648255,
        27181065,   232698,   232729]) tensor([47326832, 84312968, 33625490, 42235067, 70709690, 69622150, 37283617,
        21337167, 31734919,  1783099])
-------Step 4-------
tensor([  297900, 43875492,   297927,   862055,   297954,   862084,   297984,
        43918286,   298002,   298036]) tensor([82922729, 14682171, 85490615, 20205174, 66564179, 47432924, 60164220,
        41495481, 84833541, 58815186])
-------Step 5-------
tensor([  297900, 43875492,   297927,   862055,   297954,   862084,   297984,
        43918286,   298002,   298036]) tensor([34654278,  1466134,   671502, 84207206, 64186129, 51941964, 17530189,
        12982346, 65472603, 39652252])
-------Step 6-------
tensor([  361529,   314219, 38980097,   361557, 28454943, 67936809,   361578,
          361611, 44375653, 40415062]) tensor([15960817, 36237658, 35805154, 83648724, 33364370, 42423345, 26482524,
        10932679, 72999463, 83783695])
-------Step 7-------
tensor([  361529,   314219, 38980097,   361557, 28454943, 67936809,   361578,
          361611, 44375653, 40415062]) tensor([26292006, 57139118, 66811051, 66060775, 73859847, 47200122, 51197857,
        53573070, 34217263,   999380])
-------Step 8-------
tensor([  422955, 29579144,   422980,   881916,   423005,   328722,   423026,
          423046,   423077,   423101]) tensor([49552932, 28702095, 34300812,  3509191, 54225958,   184891, 20017503,
          526698,  2903455, 59376173])
-------Step 9-------
tensor([  422955, 29579144,   422980,   881916,   423005,   328722,   423026,
          423046,   423077,   423101]) tensor([49206338,  1856276, 17385354, 51454028, 12418928, 40412586,   797703,
        43797547, 77011961, 66030608])
before start barrier
start train
[proc 0] 100 steps, total: 51.458, sample: 2.692, forward: 1.124, backward: 1.092, update: 0.390
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 52.366, sample: 1.352, forward: 1.011, backward: 1.220, update: 0.307
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 52.350, sample: 1.597, forward: 1.006, backward: 1.081, update: 0.296
W20240207 01:14:01.260010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.492 ms                  | 263.783 ms                |
| Forward                   | 5.380 ms                  | 18.126 ms                 |
| Backward                  | 10.329 ms                 | 14.859 ms                 |
| Optimize                  | 2.716 ms                  | 27.571 ms                 |
| BarrierTimeBeforeRank0    | 373.430 us                | 54.458 ms                 |
| AfterBackward             | 68.945 ms                 | 134.921 ms                |
| BlockToStepN              | 9.615 ms                  | 901.747 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:02.260008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240207 01:14:03.302812 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240207 01:14:04.374053 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.066 ms                  | 41.307 ms                 |
| ProcessBack:UpdateCache   | 9.745 ms                  | 32.604 ms                 |
| ProcessBack:UpsertPq      | 41.048 ms                 | 99.431 ms                 |
| ProcessOneStep            | 69.237 ms                 | 134.884 ms                |
| BlockToStepN              | 9.536 ms                  | 901.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:05.447872 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=110, pq.top=110
W20240207 01:14:06.527618 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=112, pq.top=112
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.983 ms                  | 263.783 ms                |
| Forward                   | 5.413 ms                  | 18.126 ms                 |
| Backward                  | 10.329 ms                 | 14.859 ms                 |
| Optimize                  | 2.704 ms                  | 27.571 ms                 |
| BarrierTimeBeforeRank0    | 53.226 us                 | 54.458 ms                 |
| AfterBackward             | 69.265 ms                 | 134.921 ms                |
| BlockToStepN              | 9.615 ms                  | 901.747 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:07.606115 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240207 01:14:08.606007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240207 01:14:09.606007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.033 ms                  | 41.307 ms                 |
| ProcessBack:UpdateCache   | 9.628 ms                  | 32.604 ms                 |
| ProcessBack:UpsertPq      | 40.975 ms                 | 99.431 ms                 |
| ProcessOneStep            | 68.871 ms                 | 134.884 ms                |
| BlockToStepN              | 9.536 ms                  | 901.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:10.606006 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.494 ms                  | 263.783 ms                |
| Forward                   | 5.441 ms                  | 18.126 ms                 |
| Backward                  | 10.103 ms                 | 14.859 ms                 |
| Optimize                  | 2.716 ms                  | 27.571 ms                 |
| BarrierTimeBeforeRank0    | 51.038 us                 | 54.458 ms                 |
| AfterBackward             | 68.890 ms                 | 134.921 ms                |
| BlockToStepN              | 9.615 ms                  | 901.747 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:11.606009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240207 01:14:12.606009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240207 01:14:13.606010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
W20240207 01:14:14.606009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.998 ms                  | 39.500 ms                 |
| ProcessBack:UpdateCache   | 9.520 ms                  | 26.631 ms                 |
| ProcessBack:UpsertPq      | 40.943 ms                 | 97.251 ms                 |
| ProcessOneStep            | 68.060 ms                 | 134.884 ms                |
| BlockToStepN              | 9.831 ms                  | 901.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:15.606011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.983 ms                  | 263.783 ms                |
| Forward                   | 5.413 ms                  | 18.126 ms                 |
| Backward                  | 8.902 ms                  | 14.859 ms                 |
| Optimize                  | 2.713 ms                  | 27.571 ms                 |
| BarrierTimeBeforeRank0    | 52.290 us                 | 54.458 ms                 |
| AfterBackward             | 67.849 ms                 | 134.921 ms                |
| BlockToStepN              | 9.884 ms                  | 901.747 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:16.606007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240207 01:14:17.606007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240207 01:14:18.606009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240207 01:14:19.606007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.969 ms                  | 39.500 ms                 |
| ProcessBack:UpdateCache   | 9.364 ms                  | 26.631 ms                 |
| ProcessBack:UpsertPq      | 40.224 ms                 | 97.251 ms                 |
| ProcessOneStep            | 67.636 ms                 | 134.884 ms                |
| BlockToStepN              | 18.653 ms                 | 901.652 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:20.606009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.032 ms                  | 263.783 ms                |
| Forward                   | 5.380 ms                  | 18.126 ms                 |
| Backward                  | 8.902 ms                  | 14.859 ms                 |
| Optimize                  | 2.718 ms                  | 27.571 ms                 |
| BarrierTimeBeforeRank0    | 56.640 us                 | 54.458 ms                 |
| AfterBackward             | 67.387 ms                 | 134.921 ms                |
| BlockToStepN              | 18.701 ms                 | 908.920 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:21.606006 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240207 01:14:22.606009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
W20240207 01:14:23.606009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240207 01:14:24.606005 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.943 ms                  | 39.500 ms                 |
| ProcessBack:UpdateCache   | 9.282 ms                  | 26.631 ms                 |
| ProcessBack:UpsertPq      | 39.777 ms                 | 97.251 ms                 |
| ProcessOneStep            | 67.250 ms                 | 134.884 ms                |
| BlockToStepN              | 120.913 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:25.805876 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.032 ms                  | 224.305 ms                |
| Forward                   | 5.380 ms                  | 13.623 ms                 |
| Backward                  | 8.711 ms                  | 13.254 ms                 |
| Optimize                  | 2.716 ms                  | 8.238 ms                  |
| BarrierTimeBeforeRank0    | 64.356 us                 | 41.579 ms                 |
| AfterBackward             | 67.097 ms                 | 127.492 ms                |
| BlockToStepN              | 120.991 ms                | 908.920 ms                |
| OneStep                   | 316.684 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:26.864852 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=152
W20240207 01:14:27.864012 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240207 01:14:28.864009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.941 ms                  | 39.500 ms                 |
| ProcessBack:UpdateCache   | 9.265 ms                  | 26.631 ms                 |
| ProcessBack:UpsertPq      | 39.341 ms                 | 97.251 ms                 |
| ProcessOneStep            | 66.781 ms                 | 127.450 ms                |
| BlockToStepN              | 120.913 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:29.864008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=158, pq.top=158
W20240207 01:14:30.864009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.983 ms                  | 224.305 ms                |
| Forward                   | 5.380 ms                  | 13.623 ms                 |
| Backward                  | 8.553 ms                  | 13.254 ms                 |
| Optimize                  | 2.728 ms                  | 8.238 ms                  |
| BarrierTimeBeforeRank0    | 76.769 us                 | 41.579 ms                 |
| AfterBackward             | 66.811 ms                 | 127.492 ms                |
| BlockToStepN              | 120.991 ms                | 915.607 ms                |
| OneStep                   | 316.684 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:31.920838 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=162, pq.top=162
W20240207 01:14:32.938112 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=164, pq.top=164
W20240207 01:14:33.947716 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.918 ms                  | 39.500 ms                 |
| ProcessBack:UpdateCache   | 9.250 ms                  | 26.631 ms                 |
| ProcessBack:UpsertPq      | 39.213 ms                 | 97.251 ms                 |
| ProcessOneStep            | 66.779 ms                 | 127.450 ms                |
| BlockToStepN              | 120.913 ms                | 915.529 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:34.947005 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240207 01:14:35.947010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.690 ms                  | 224.305 ms                |
| Forward                   | 5.374 ms                  | 13.623 ms                 |
| Backward                  | 8.711 ms                  | 13.254 ms                 |
| Optimize                  | 2.728 ms                  | 8.238 ms                  |
| BarrierTimeBeforeRank0    | 76.769 us                 | 41.579 ms                 |
| AfterBackward             | 66.648 ms                 | 127.492 ms                |
| BlockToStepN              | 120.991 ms                | 915.607 ms                |
| OneStep                   | 316.684 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:36.947005 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
W20240207 01:14:37.947008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240207 01:14:38.947010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.879 ms                  | 23.621 ms                 |
| ProcessBack:UpdateCache   | 9.220 ms                  | 26.631 ms                 |
| ProcessBack:UpsertPq      | 39.285 ms                 | 96.227 ms                 |
| ProcessOneStep            | 66.779 ms                 | 127.450 ms                |
| BlockToStepN              | 120.913 ms                | 915.529 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:39.947006 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240207 01:14:40.989681 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.553 ms                  | 224.305 ms                |
| Forward                   | 5.388 ms                  | 13.623 ms                 |
| Backward                  | 8.902 ms                  | 13.254 ms                 |
| Optimize                  | 2.718 ms                  | 8.238 ms                  |
| BarrierTimeBeforeRank0    | 122.921 us                | 41.579 ms                 |
| AfterBackward             | 66.782 ms                 | 127.492 ms                |
| BlockToStepN              | 120.991 ms                | 915.607 ms                |
| OneStep                   | 316.684 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:42.065930 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=186, pq.top=186
W20240207 01:14:43.065008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240207 01:14:44.065008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.913 ms                  | 23.621 ms                 |
| ProcessBack:UpdateCache   | 9.193 ms                  | 26.631 ms                 |
| ProcessBack:UpsertPq      | 39.213 ms                 | 96.227 ms                 |
| ProcessOneStep            | 66.621 ms                 | 127.450 ms                |
| BlockToStepN              | 120.913 ms                | 915.529 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:45.065011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240207 01:14:46.065011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.492 ms                  | 224.305 ms                |
| Forward                   | 5.386 ms                  | 13.623 ms                 |
| Backward                  | 10.090 ms                 | 13.254 ms                 |
| Optimize                  | 2.730 ms                  | 8.238 ms                  |
| BarrierTimeBeforeRank0    | 64.356 us                 | 41.579 ms                 |
| AfterBackward             | 66.636 ms                 | 127.492 ms                |
| BlockToStepN              | 120.991 ms                | 915.607 ms                |
| OneStep                   | 316.684 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:47.065011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240207 01:14:48.065011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 4] 200 steps, total: 47.296, sample: 1.206, forward: 0.509, backward: 1.084, update: 0.240
[proc 6] 200 steps, total: 47.296, sample: 1.339, forward: 0.512, backward: 0.860, update: 0.260
[proc 2] 200 steps, total: 47.296, sample: 1.353, forward: 0.489, backward: 0.865, update: 0.243
[proc 7] 200 steps, total: 47.296, sample: 1.214, forward: 0.516, backward: 0.693, update: 0.245
[proc 3] 200 steps, total: 47.296, sample: 1.325, forward: 0.519, backward: 0.739, update: 0.248
[proc 5] 200 steps, total: 47.296, sample: 1.442, forward: 0.518, backward: 1.082, update: 0.260
[proc 1] 200 steps, total: 47.296, sample: 1.313, forward: 0.489, backward: 1.010, update: 0.249
[proc 0] 200 steps, total: 47.296, sample: 2.128, forward: 0.579, backward: 0.884, update: 0.319
W20240207 01:14:49.065011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.841 ms                  | 23.621 ms                 |
| ProcessBack:UpdateCache   | 9.145 ms                  | 26.631 ms                 |
| ProcessBack:UpsertPq      | 38.284 ms                 | 96.227 ms                 |
| ProcessOneStep            | 66.579 ms                 | 127.450 ms                |
| BlockToStepN              | 120.913 ms                | 915.529 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:50.065009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
W20240207 01:14:51.065024 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.366 ms                  | 224.305 ms                |
| Forward                   | 5.380 ms                  | 13.623 ms                 |
| Backward                  | 9.890 ms                  | 13.254 ms                 |
| Optimize                  | 2.730 ms                  | 8.238 ms                  |
| BarrierTimeBeforeRank0    | 64.356 us                 | 41.579 ms                 |
| AfterBackward             | 66.354 ms                 | 127.492 ms                |
| BlockToStepN              | 362.829 ms                | 915.607 ms                |
| OneStep                   | 450.936 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:52.065011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=207, pq.top=207
W20240207 01:14:53.065011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240207 01:14:54.065011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.861 ms                  | 23.621 ms                 |
| ProcessBack:UpdateCache   | 9.170 ms                  | 26.631 ms                 |
| ProcessBack:UpsertPq      | 39.213 ms                 | 96.227 ms                 |
| ProcessOneStep            | 66.621 ms                 | 127.450 ms                |
| BlockToStepN              | 124.899 ms                | 915.529 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:55.160002 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240207 01:14:56.159009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.349 ms                  | 224.305 ms                |
| Forward                   | 5.380 ms                  | 13.623 ms                 |
| Backward                  | 10.105 ms                 | 13.254 ms                 |
| Optimize                  | 2.754 ms                  | 8.238 ms                  |
| BarrierTimeBeforeRank0    | 64.356 us                 | 41.579 ms                 |
| AfterBackward             | 66.811 ms                 | 127.492 ms                |
| BlockToStepN              | 124.997 ms                | 915.607 ms                |
| OneStep                   | 316.684 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:14:57.159009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240207 01:14:58.159009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240207 01:14:59.217604 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.913 ms                  | 21.970 ms                 |
| ProcessBack:UpdateCache   | 9.209 ms                  | 19.923 ms                 |
| ProcessBack:UpsertPq      | 38.923 ms                 | 93.267 ms                 |
| ProcessOneStep            | 66.752 ms                 | 127.450 ms                |
| BlockToStepN              | 326.946 ms                | 915.529 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:00.217010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240207 01:15:01.217007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.179 ms                  | 224.305 ms                |
| Forward                   | 5.380 ms                  | 13.623 ms                 |
| Backward                  | 10.315 ms                 | 13.254 ms                 |
| Optimize                  | 2.757 ms                  | 8.238 ms                  |
| BarrierTimeBeforeRank0    | 122.921 us                | 41.579 ms                 |
| AfterBackward             | 66.782 ms                 | 127.492 ms                |
| BlockToStepN              | 124.997 ms                | 915.607 ms                |
| OneStep                   | 316.684 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:02.217010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
W20240207 01:15:03.217008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240207 01:15:04.217026 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.879 ms                  | 21.970 ms                 |
| ProcessBack:UpdateCache   | 9.195 ms                  | 19.923 ms                 |
| ProcessBack:UpsertPq      | 38.515 ms                 | 93.267 ms                 |
| ProcessOneStep            | 66.621 ms                 | 127.450 ms                |
| BlockToStepN              | 326.946 ms                | 915.529 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:05.217010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240207 01:15:06.217011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.288 ms                  | 224.305 ms                |
| Forward                   | 5.380 ms                  | 13.623 ms                 |
| Backward                  | 10.329 ms                 | 13.254 ms                 |
| Optimize                  | 2.730 ms                  | 8.238 ms                  |
| BarrierTimeBeforeRank0    | 65.722 us                 | 41.579 ms                 |
| AfterBackward             | 66.782 ms                 | 127.492 ms                |
| BlockToStepN              | 124.997 ms                | 915.607 ms                |
| OneStep                   | 316.684 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:07.217006 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240207 01:15:08.217008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240207 01:15:09.222815 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.918 ms                  | 21.970 ms                 |
| ProcessBack:UpdateCache   | 9.217 ms                  | 19.923 ms                 |
| ProcessBack:UpsertPq      | 39.199 ms                 | 93.267 ms                 |
| ProcessOneStep            | 66.887 ms                 | 122.147 ms                |
| BlockToStepN              | 326.946 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:10.417235 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240207 01:15:11.417012 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.492 ms                  | 220.175 ms                |
| Forward                   | 5.412 ms                  | 13.486 ms                 |
| Backward                  | 10.427 ms                 | 13.254 ms                 |
| Optimize                  | 2.730 ms                  | 8.131 ms                  |
| BarrierTimeBeforeRank0    | 58.524 us                 | 39.266 ms                 |
| AfterBackward             | 66.913 ms                 | 122.188 ms                |
| BlockToStepN              | 124.997 ms                | 908.920 ms                |
| OneStep                   | 316.684 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:12.417011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240207 01:15:13.417009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240207 01:15:14.478353 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.919 ms                  | 21.970 ms                 |
| ProcessBack:UpdateCache   | 9.220 ms                  | 19.923 ms                 |
| ProcessBack:UpsertPq      | 38.986 ms                 | 93.267 ms                 |
| ProcessOneStep            | 66.992 ms                 | 122.147 ms                |
| BlockToStepN              | 175.381 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:15.478008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240207 01:15:16.478008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.609 ms                  | 220.175 ms                |
| Forward                   | 5.412 ms                  | 13.486 ms                 |
| Backward                  | 10.490 ms                 | 13.254 ms                 |
| Optimize                  | 2.734 ms                  | 8.131 ms                  |
| BarrierTimeBeforeRank0    | 58.524 us                 | 39.266 ms                 |
| AfterBackward             | 67.023 ms                 | 122.188 ms                |
| BlockToStepN              | 175.495 ms                | 908.920 ms                |
| OneStep                   | 316.684 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:17.560667 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240207 01:15:18.560007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240207 01:15:19.560009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.941 ms                  | 19.952 ms                 |
| ProcessBack:UpdateCache   | 9.245 ms                  | 19.882 ms                 |
| ProcessBack:UpsertPq      | 38.923 ms                 | 91.885 ms                 |
| ProcessOneStep            | 66.992 ms                 | 122.147 ms                |
| BlockToStepN              | 175.381 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:20.560006 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240207 01:15:21.560009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.690 ms                  | 220.175 ms                |
| Forward                   | 5.434 ms                  | 13.486 ms                 |
| Backward                  | 10.666 ms                 | 13.254 ms                 |
| Optimize                  | 2.757 ms                  | 8.131 ms                  |
| BarrierTimeBeforeRank0    | 52.290 us                 | 39.266 ms                 |
| AfterBackward             | 67.084 ms                 | 122.188 ms                |
| BlockToStepN              | 175.495 ms                | 908.920 ms                |
| OneStep                   | 316.684 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:22.560009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
W20240207 01:15:23.560007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.943 ms                  | 19.952 ms                 |
| ProcessBack:UpdateCache   | 9.257 ms                  | 19.882 ms                 |
| ProcessBack:UpsertPq      | 38.740 ms                 | 91.885 ms                 |
| ProcessOneStep            | 67.055 ms                 | 122.147 ms                |
| BlockToStepN              | 188.856 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:24.649082 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240207 01:15:25.649011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=288, pq.top=288
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.690 ms                  | 220.175 ms                |
| Forward                   | 5.441 ms                  | 13.486 ms                 |
| Backward                  | 10.979 ms                 | 13.254 ms                 |
| Optimize                  | 2.762 ms                  | 8.131 ms                  |
| BarrierTimeBeforeRank0    | 51.038 us                 | 39.266 ms                 |
| AfterBackward             | 67.097 ms                 | 122.188 ms                |
| BlockToStepN              | 327.035 ms                | 908.920 ms                |
| OneStep                   | 449.984 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:26.678931 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=290, pq.top=290
W20240207 01:15:27.678009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240207 01:15:28.678009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.952 ms                  | 19.952 ms                 |
| ProcessBack:UpdateCache   | 9.270 ms                  | 19.882 ms                 |
| ProcessBack:UpsertPq      | 38.740 ms                 | 91.885 ms                 |
| ProcessOneStep            | 67.250 ms                 | 122.147 ms                |
| BlockToStepN              | 201.492 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:29.678005 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240207 01:15:30.678009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=297, pq.top=297
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.975 ms                  | 220.175 ms                |
| Forward                   | 5.443 ms                  | 13.486 ms                 |
| Backward                  | 11.059 ms                 | 14.025 ms                 |
| Optimize                  | 2.734 ms                  | 8.131 ms                  |
| BarrierTimeBeforeRank0    | 51.038 us                 | 39.266 ms                 |
| AfterBackward             | 67.196 ms                 | 122.188 ms                |
| BlockToStepN              | 327.035 ms                | 908.920 ms                |
| OneStep                   | 449.984 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:31.707582 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
W20240207 01:15:32.707011 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=300, pq.top=300
[proc 6] 300 steps, total: 44.504, sample: 1.139, forward: 0.539, backward: 0.724, update: 0.241
[proc 1] 300 steps, total: 44.504, sample: 1.059, forward: 0.483, backward: 1.012, update: 0.249
[proc 2] 300 steps, total: 44.504, sample: 1.060, forward: 0.498, backward: 0.988, update: 0.236
[proc 0] 300 steps, total: 44.504, sample: 1.987, forward: 0.554, backward: 1.078, update: 0.306
[proc 7] 300 steps, total: 44.504, sample: 1.007, forward: 0.506, backward: 0.560, update: 0.230
[proc 3] 300 steps, total: 44.504, sample: 1.093, forward: 0.521, backward: 0.712, update: 0.261
[proc 5] 300 steps, total: 44.504, sample: 1.120, forward: 0.575, backward: 1.048, update: 0.262
[proc 4] 300 steps, total: 44.504, sample: 1.103, forward: 0.529, backward: 0.624, update: 0.242
W20240207 01:15:33.742506 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.968 ms                  | 19.952 ms                 |
| ProcessBack:UpdateCache   | 9.273 ms                  | 19.882 ms                 |
| ProcessBack:UpsertPq      | 38.284 ms                 | 91.885 ms                 |
| ProcessOneStep            | 67.055 ms                 | 122.147 ms                |
| BlockToStepN              | 203.235 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:34.742007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240207 01:15:35.742008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.811 ms                  | 220.175 ms                |
| Forward                   | 5.441 ms                  | 13.486 ms                 |
| Backward                  | 11.097 ms                 | 14.025 ms                 |
| Optimize                  | 2.730 ms                  | 8.131 ms                  |
| BarrierTimeBeforeRank0    | 50.853 us                 | 39.266 ms                 |
| AfterBackward             | 66.913 ms                 | 122.188 ms                |
| BlockToStepN              | 230.699 ms                | 908.920 ms                |
| OneStep                   | 316.684 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:36.742008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=307, pq.top=307
W20240207 01:15:37.742008 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240207 01:15:38.847740 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.969 ms                  | 19.952 ms                 |
| ProcessBack:UpdateCache   | 9.283 ms                  | 19.882 ms                 |
| ProcessBack:UpsertPq      | 38.222 ms                 | 91.885 ms                 |
| ProcessOneStep            | 67.055 ms                 | 122.147 ms                |
| BlockToStepN              | 230.629 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:39.847007 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=312, pq.top=312
W20240207 01:15:40.882314 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=314, pq.top=314
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.975 ms                  | 220.175 ms                |
| Forward                   | 5.449 ms                  | 13.486 ms                 |
| Backward                  | 11.138 ms                 | 14.025 ms                 |
| Optimize                  | 2.750 ms                  | 8.131 ms                  |
| BarrierTimeBeforeRank0    | 49.921 us                 | 39.266 ms                 |
| AfterBackward             | 67.196 ms                 | 122.188 ms                |
| BlockToStepN              | 230.699 ms                | 908.920 ms                |
| OneStep                   | 316.684 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
W20240207 01:15:41.882009 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240207 01:15:42.882010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
W20240207 01:15:43.882010 17999 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.969 ms                  | 19.952 ms                 |
| ProcessBack:UpdateCache   | 9.287 ms                  | 19.882 ms                 |
| ProcessBack:UpsertPq      | 38.740 ms                 | 91.885 ms                 |
| ProcessOneStep            | 67.224 ms                 | 122.147 ms                |
| BlockToStepN              | 326.946 ms                | 908.838 ms                |
+---------------------------+---------------------------+---------------------------+
Successfully xmh. training takes 155.24940752983093 seconds
before call kg_cache_controller.StopThreads()
W20240207 01:15:44.763824 17999 grad_async_v1.h:243] call StopThreads. PID = 16317
W20240207 01:15:44.763888 17999 grad_base.h:212] before processOneStepNegThread_.join();
W20240207 01:15:44.769270 17999 grad_base.h:214] after processOneStepNegThread_.join();
W20240207 01:15:44.769326 17999 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240207 01:15:44.916693 17999 grad_async_v1.h:264] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.983 ms                  | 220.175 ms                |
| Forward                   | 5.462 ms                  | 13.486 ms                 |
| Backward                  | 11.156 ms                 | 14.025 ms                 |
| Optimize                  | 2.750 ms                  | 8.131 ms                  |
| BarrierTimeBeforeRank0    | 48.502 us                 | 39.266 ms                 |
| AfterBackward             | 67.267 ms                 | 122.188 ms                |
| BlockToStepN              | 230.699 ms                | 908.920 ms                |
| OneStep                   | 343.207 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
