WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 20:25:37.200433 32648 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_Freebase_13', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [32648 sampler.py:454] Start PreSampling
WARNING [32648 sampler.py:532] Before construct renumbering_dict
WARNING [32648 sampler.py:555] PreSampling done
W20240206 20:45:21.828685 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 20:45:21.828881 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 20:45:21.828925 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 20:45:21.828965 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 20:45:21.829002 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 20:45:21.829039 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 20:45:21.829072 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 20:45:21.829108 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 20:45:21.829142 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 20:45:21.829174 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 20:45:21.829210 32648 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 20:45:21.829237 32648 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 20:45:21.829267 32648 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 20:45:21.829432 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 20:45:21.829474 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 20:45:21.829504 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 20:45:21.829542 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 20:45:21.829571 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 20:45:21.829608 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 20:45:21.829643 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 20:45:21.829674 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 20:45:21.829707 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 20:45:21.829742 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 20:45:21.829772 32648 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 20:45:21.829795 32648 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 20:45:21.829821 32648 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 20:45:21.829883 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 20:45:21.829919 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 20:45:21.829955 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 20:45:21.829981 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 20:45:21.830008 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 20:45:21.830039 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 20:45:21.830065 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 20:45:21.830091 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 20:45:21.830123 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 20:45:21.830149 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 20:45:21.830178 32648 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 20:45:21.830200 32648 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 20:45:21.830224 32648 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 20:45:21.830281 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 20:45:21.830317 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 20:45:21.830350 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 20:45:21.830381 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 20:45:21.830412 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 20:45:21.830451 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 20:45:21.830483 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 20:45:21.830521 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 20:45:21.830554 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 20:45:21.830585 32648 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 20:45:21.830614 32648 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 20:45:21.830637 32648 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 20:45:21.830667 32648 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 20:45:22.253142 32648 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100013192000 128.2 GB
W20240206 20:53:55.840750 32648 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102021dca000 328.3 MB
{0: Graph(num_nodes=27225865, num_edges=100970380,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=23781260, num_edges=94780459,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=24473167, num_edges=94766529,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=27322260, num_edges=74213630,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 27225865 N 100970380 E
MertisPartition: part 1 has 23781260 N 94780459 E
MertisPartition: part 2 has 24473167 N 94766529 E
MertisPartition: part 3 has 27322260 N 74213630 E
Rank0: cached key size 2151353
Rank1: cached key size 2151353
Rank2: cached key size 2151353
Rank3: cached key size 2151353
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 82487883, 64859130, 64482679]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 8605419,  8605445,   111716,  ..., 70678139, 16456522,  4675921]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 2, 2])}
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=27225865, num_edges=100970380,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2202.249 seconds
[Rank1] pid = 33737
[Rank2] pid = 33842
INFO [32648 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [32648 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [33909 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [33737 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [33842 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
W20240206 21:02:25.183125 33975 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [8605415, 400]; dev=0; size=12.82 GB
INFO [33909 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [33737 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [33842 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240206 21:02:25.189131 33843 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [8605415, 400]; dev=2; size=12.82 GB
W20240206 21:02:25.189249 33738 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [8605415, 400]; dev=1; size=12.82 GB
W20240206 21:02:25.189256 33910 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [8605415, 400]; dev=3; size=12.82 GB
W20240206 21:02:25.263540 33910 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x102036619000 7.629 MB
W20240206 21:02:25.263561 33843 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x102036dbc000 7.629 MB
W20240206 21:02:25.263573 33738 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10203755f000 7.629 MB
W20240206 21:02:25.263593 33975 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x102037d02000 7.629 MB
W20240206 21:02:25.263794 33975 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1020384a5000 7.629 MB
W20240206 21:02:25.263806 33910 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x102038c48000 7.629 MB
W20240206 21:02:25.263819 33738 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1020393eb000 7.629 MB
W20240206 21:02:25.263829 33843 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102039b8e000 7.629 MB
W20240206 21:02:25.263892 33738 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10203a331000 1.49 GB
W20240206 21:02:25.263900 33843 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x102099914000 1.49 GB
W20240206 21:02:25.264001 33910 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1020f8ef7000 1.49 GB
W20240206 21:02:25.264014 33975 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1021584da000 1.49 GB
W20240206 21:02:25.264097 33910 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1021b7abd000 1.49 GB
W20240206 21:02:25.264101 33975 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1022170a0000 1.49 GB
W20240206 21:02:25.264119 33738 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x102276683000 1.49 GB
W20240206 21:02:25.264125 33843 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022d5c66000 1.49 GB
W20240206 21:02:25.264159 33975 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 21:02:25.264171 33910 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 21:02:25.264176 33738 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 21:02:25.264225 33843 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 21:02:25.270787 33910 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 21:02:25.270795 33738 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 21:02:25.270802 33843 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 21:02:25.270807 33975 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [33842 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank3] pid = 33909
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 8605415), (8605415, 17210830), (17210830, 25816245), (25816245, 34421660)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [32648 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [33909 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [33737 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 21:03:00.798943 33738 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240206 21:03:00.799271 33975 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240206 21:03:00.799348 33910 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240206 21:03:00.799438 33843 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240206 21:03:02.252744 33910 recstore.cc:66] init folly done
E20240206 21:03:02.252775 33738 recstore.cc:66] init folly done
E20240206 21:03:02.252820 33843 recstore.cc:66] init folly done
E20240206 21:03:02.252835 33975 recstore.cc:66] init folly done
I20240206 21:03:12.571460 33910 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240206 21:03:15.772135 33843 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240206 21:03:15.888581 33738 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240206 21:03:16.661527 33975 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.575 ms                  | 83.317 ms                 |
| Forward                   | 5.055 ms                  | 416.320 ms                |
| back: bucket keys         | 469.803 us                | 19.074 ms                 |
| back: a2a                 | 10.988 ms                 | 863.590 ms                |
| back: cache               | 8.455 ms                  | 64.379 ms                 |
| back: aggr dram keys      | 33.231 ms                 | 439.649 ms                |
| back: set dram grad       | 4.232 ms                  | 14.232 ms                 |
| Backward                  | 175.312 ms                | 1.609 s                   |
| Optimize                  | 40.618 ms                 | 85.435 ms                 |
| BarrierTimeBeforeRank0    | 44.518 us                 | 66.044 us                 |
| BlockToStepN              | 23.513 us                 | 9.073 ms                  |
| OneStep                   | 240.640 ms                | 2.119 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.276 ms                  | 86.039 ms                 |
| Forward                   | 4.622 ms                  | 416.320 ms                |
| back: bucket keys         | 355.137 us                | 19.074 ms                 |
| back: a2a                 | 10.917 ms                 | 134.259 ms                |
| back: cache               | 8.755 ms                  | 63.852 ms                 |
| back: aggr dram keys      | 33.239 ms                 | 72.137 ms                 |
| back: set dram grad       | 4.197 ms                  | 18.813 ms                 |
| Backward                  | 163.637 ms                | 1.609 s                   |
| Optimize                  | 39.596 ms                 | 85.435 ms                 |
| BarrierTimeBeforeRank0    | 43.308 us                 | 66.044 us                 |
| BlockToStepN              | 24.464 us                 | 9.073 ms                  |
| OneStep                   | 216.089 ms                | 2.119 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.739 ms                  | 86.039 ms                 |
| Forward                   | 4.666 ms                  | 6.110 ms                  |
| back: bucket keys         | 355.137 us                | 19.074 ms                 |
| back: a2a                 | 10.911 ms                 | 134.259 ms                |
| back: cache               | 12.183 ms                 | 63.852 ms                 |
| back: aggr dram keys      | 33.239 ms                 | 72.137 ms                 |
| back: set dram grad       | 4.197 ms                  | 18.813 ms                 |
| Backward                  | 145.825 ms                | 292.044 ms                |
| Optimize                  | 39.591 ms                 | 62.713 ms                 |
| BarrierTimeBeforeRank0    | 36.358 us                 | 66.044 us                 |
| BlockToStepN              | 21.790 us                 | 144.878 us                |
| OneStep                   | 204.105 ms                | 420.915 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.863 ms                  | 86.039 ms                 |
| Forward                   | 4.650 ms                  | 6.110 ms                  |
| back: bucket keys         | 343.271 us                | 837.644 us                |
| back: a2a                 | 10.911 ms                 | 74.522 ms                 |
| back: cache               | 12.763 ms                 | 53.387 ms                 |
| back: aggr dram keys      | 33.639 ms                 | 71.736 ms                 |
| back: set dram grad       | 4.197 ms                  | 15.526 ms                 |
| Backward                  | 141.143 ms                | 292.044 ms                |
| Optimize                  | 39.358 ms                 | 62.713 ms                 |
| BarrierTimeBeforeRank0    | 35.481 us                 | 68.597 us                 |
| BlockToStepN              | 22.060 us                 | 403.836 us                |
| OneStep                   | 198.446 ms                | 420.915 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 23.807, sample: 1.074, forward: 0.890, backward: 11.240, update: 0.396
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 23.923, sample: 1.058, forward: 0.855, backward: 10.965, update: 0.329
train_sampler.Prefill()
-------Step 0-------
tensor([ 1412593,   749520, 47597752,  2055785,   477743,   749557,   749595,
          227173,  1412631,  1412661]) tensor([ 9146052, 27704255,  1070703, 59847397, 49205898,  1667884, 78058551,
        81629451, 61116011, 84119500])
-------Step 1-------
tensor([ 1412593,   749520, 47597752,  2055785,   477743,   749557,   749595,
          227173,  1412631,  1412661]) tensor([35697743, 75267461, 68756343, 13738199, 68579959, 12179750, 77791767,
        76324344, 23126761, 31488113])
-------Step 2-------
tensor([  857633,  1426683, 63208395,  1426729,   857674,   857715,   857754,
        39052495,   857804,   857840]) tensor([34040545,  9140530, 58819964, 13551595, 17836085, 15363512, 57957915,
        14347782, 51730164, 38070720])
-------Step 3-------
tensor([  857633,  1426683, 63208395,  1426729,   857674,   857715,   857754,
        39052495,   857804,   857840]) tensor([  362447, 41399715,  1229502, 37927597, 20002381, 64907275, 79889320,
        71075350, 29143456, 82349997])
-------Step 4-------
tensor([ 960852, 1441525,  960892,  960926, 1441566,  960961, 1441615,  960997,
        1441654,  961038]) tensor([ 4130715, 37565981, 19059157,  1485055, 50582712, 53443682, 83322181,
        56229678, 50829710, 12774668])
-------Step 5-------
tensor([ 960852, 1441525,  960892,  960926, 1441566,  960961, 1441615,  960997,
        1441654,  961038]) tensor([32797031, 54233140, 76558844, 12937311, 34989208,   758892, 34334926,
        67799280, 74710974,  1850799])
-------Step 6-------
tensor([72665181,  1063992,  1064042,  1064079,  8611010,  1064119,  1064153,
         1064200,  1064249,   232835]) tensor([33708047, 40309185, 31755190, 21434622, 65400129, 50810344, 39137102,
        20363009, 67160249, 12887685])
-------Step 7-------
tensor([72665181,  1063992,  1064042,  1064079,  8611010,  1064119,  1064153,
         1064200,  1064249,   232835]) tensor([46058369, 75988932, 61739861, 71285227, 60364552,  2526523, 19261671,
        46688714, 26079857, 17058575])
-------Step 8-------
tensor([ 1169518,  1472151,  1169567, 33356518,  2079425,  1169601,  1169634,
         1169669,   234515,  2079440]) tensor([25301115, 54583580, 43421809, 76172593, 69459578, 62661194, 58908220,
        69630566, 13904191,  7637149])
-------Step 9-------
tensor([ 1169518,  1472151,  1169567, 33356518,  2079425,  1169601,  1169634,
         1169669,   234515,  2079440]) tensor([74259013, 56381298, 31179726, 44461583, 14280755,  1781309, 20844037,
        16830580, 83378979, 51556316])
before start barrier
start train
[proc 0] 100 steps, total: 23.034, sample: 1.177, forward: 0.879, backward: 16.911, update: 3.960
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.124, sample: 1.787, forward: 0.831, backward: 10.359, update: 0.384
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.026 ms                  | 86.039 ms                 |
| Forward                   | 4.666 ms                  | 6.110 ms                  |
| back: bucket keys         | 350.432 us                | 837.644 us                |
| back: a2a                 | 10.944 ms                 | 134.259 ms                |
| back: cache               | 12.763 ms                 | 63.852 ms                 |
| back: aggr dram keys      | 34.019 ms                 | 71.736 ms                 |
| back: set dram grad       | 4.197 ms                  | 18.813 ms                 |
| Backward                  | 155.308 ms                | 296.261 ms                |
| Optimize                  | 39.354 ms                 | 62.713 ms                 |
| BarrierTimeBeforeRank0    | 35.162 us                 | 68.597 us                 |
| BlockToStepN              | 22.708 us                 | 11.976 ms                 |
| OneStep                   | 207.740 ms                | 420.915 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.933 ms                  | 86.039 ms                 |
| Forward                   | 4.675 ms                  | 20.470 ms                 |
| back: bucket keys         | 352.940 us                | 1.002 ms                  |
| back: a2a                 | 11.005 ms                 | 113.366 ms                |
| back: cache               | 12.763 ms                 | 57.920 ms                 |
| back: aggr dram keys      | 34.019 ms                 | 71.736 ms                 |
| back: set dram grad       | 4.202 ms                  | 15.526 ms                 |
| Backward                  | 156.369 ms                | 296.261 ms                |
| Optimize                  | 39.591 ms                 | 62.713 ms                 |
| BarrierTimeBeforeRank0    | 35.078 us                 | 68.597 us                 |
| BlockToStepN              | 23.513 us                 | 14.577 ms                 |
| OneStep                   | 211.036 ms                | 420.915 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.077 ms                  | 86.039 ms                 |
| Forward                   | 4.666 ms                  | 6.110 ms                  |
| back: bucket keys         | 368.123 us                | 1.007 ms                  |
| back: a2a                 | 11.006 ms                 | 113.366 ms                |
| back: cache               | 12.763 ms                 | 57.920 ms                 |
| back: aggr dram keys      | 34.327 ms                 | 71.736 ms                 |
| back: set dram grad       | 4.215 ms                  | 18.338 ms                 |
| Backward                  | 157.682 ms                | 296.261 ms                |
| Optimize                  | 39.661 ms                 | 62.713 ms                 |
| BarrierTimeBeforeRank0    | 34.969 us                 | 94.540 us                 |
| BlockToStepN              | 24.406 us                 | 14.577 ms                 |
| OneStep                   | 211.036 ms                | 420.915 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.215 ms                  | 86.039 ms                 |
| Forward                   | 4.650 ms                  | 6.110 ms                  |
| back: bucket keys         | 369.609 us                | 1.007 ms                  |
| back: a2a                 | 11.011 ms                 | 113.366 ms                |
| back: cache               | 12.763 ms                 | 57.920 ms                 |
| back: aggr dram keys      | 34.338 ms                 | 71.736 ms                 |
| back: set dram grad       | 4.213 ms                  | 18.338 ms                 |
| Backward                  | 156.369 ms                | 292.044 ms                |
| Optimize                  | 39.875 ms                 | 57.661 ms                 |
| BarrierTimeBeforeRank0    | 34.719 us                 | 72.104 us                 |
| BlockToStepN              | 24.586 us                 | 13.809 ms                 |
| OneStep                   | 209.577 ms                | 413.191 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.033 ms                  | 86.039 ms                 |
| Forward                   | 4.666 ms                  | 6.110 ms                  |
| back: bucket keys         | 369.609 us                | 1.007 ms                  |
| back: a2a                 | 11.017 ms                 | 113.366 ms                |
| back: cache               | 12.763 ms                 | 53.387 ms                 |
| back: aggr dram keys      | 34.467 ms                 | 59.910 ms                 |
| back: set dram grad       | 4.200 ms                  | 18.338 ms                 |
| Backward                  | 152.579 ms                | 292.044 ms                |
| Optimize                  | 39.873 ms                 | 58.226 ms                 |
| BarrierTimeBeforeRank0    | 34.683 us                 | 72.104 us                 |
| BlockToStepN              | 24.680 us                 | 14.577 ms                 |
| OneStep                   | 205.062 ms                | 413.191 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 21.323, sample: 1.107, forward: 0.460, backward: 9.777, update: 0.268
[proc 3] 200 steps, total: 21.323, sample: 2.000, forward: 0.412, backward: 8.919, update: 0.351
[proc 0] 200 steps, total: 21.323, sample: 1.153, forward: 0.477, backward: 15.537, update: 3.981
[proc 1] 200 steps, total: 21.323, sample: 1.082, forward: 0.454, backward: 10.154, update: 0.407
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.033 ms                  | 86.039 ms                 |
| Forward                   | 4.654 ms                  | 6.110 ms                  |
| back: bucket keys         | 372.847 us                | 1.007 ms                  |
| back: a2a                 | 11.065 ms                 | 113.366 ms                |
| back: cache               | 12.763 ms                 | 53.387 ms                 |
| back: aggr dram keys      | 34.649 ms                 | 59.910 ms                 |
| back: set dram grad       | 4.199 ms                  | 18.338 ms                 |
| Backward                  | 151.441 ms                | 292.044 ms                |
| Optimize                  | 40.046 ms                 | 58.226 ms                 |
| BarrierTimeBeforeRank0    | 34.549 us                 | 72.104 us                 |
| BlockToStepN              | 24.855 us                 | 14.577 ms                 |
| OneStep                   | 205.222 ms                | 413.191 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.087 ms                  | 92.865 ms                 |
| Forward                   | 4.622 ms                  | 6.110 ms                  |
| back: bucket keys         | 372.847 us                | 1.007 ms                  |
| back: a2a                 | 11.070 ms                 | 101.880 ms                |
| back: cache               | 12.763 ms                 | 52.748 ms                 |
| back: aggr dram keys      | 34.588 ms                 | 59.753 ms                 |
| back: set dram grad       | 4.199 ms                  | 15.526 ms                 |
| Backward                  | 146.437 ms                | 292.044 ms                |
| Optimize                  | 40.087 ms                 | 59.612 ms                 |
| BarrierTimeBeforeRank0    | 34.549 us                 | 72.104 us                 |
| BlockToStepN              | 24.406 us                 | 14.577 ms                 |
| OneStep                   | 200.486 ms                | 413.191 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.099 ms                  | 86.039 ms                 |
| Forward                   | 4.622 ms                  | 5.592 ms                  |
| back: bucket keys         | 375.092 us                | 1.011 ms                  |
| back: a2a                 | 11.079 ms                 | 101.880 ms                |
| back: cache               | 12.763 ms                 | 52.748 ms                 |
| back: aggr dram keys      | 34.656 ms                 | 59.753 ms                 |
| back: set dram grad       | 4.191 ms                  | 16.619 ms                 |
| Backward                  | 144.942 ms                | 269.239 ms                |
| Optimize                  | 40.104 ms                 | 58.226 ms                 |
| BarrierTimeBeforeRank0    | 34.447 us                 | 68.597 us                 |
| BlockToStepN              | 24.133 us                 | 13.809 ms                 |
| OneStep                   | 197.328 ms                | 392.765 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.033 ms                  | 86.039 ms                 |
| Forward                   | 4.654 ms                  | 5.592 ms                  |
| back: bucket keys         | 377.909 us                | 1.011 ms                  |
| back: a2a                 | 11.084 ms                 | 101.880 ms                |
| back: cache               | 12.763 ms                 | 52.072 ms                 |
| back: aggr dram keys      | 34.674 ms                 | 58.285 ms                 |
| back: set dram grad       | 4.191 ms                  | 16.619 ms                 |
| Backward                  | 145.874 ms                | 290.351 ms                |
| Optimize                  | 40.138 ms                 | 59.612 ms                 |
| BarrierTimeBeforeRank0    | 34.422 us                 | 68.597 us                 |
| BlockToStepN              | 24.464 us                 | 18.401 ms                 |
| OneStep                   | 198.446 ms                | 413.191 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 20.509, sample: 1.642, forward: 0.420, backward: 8.989, update: 0.372
[proc 1] 300 steps, total: 20.509, sample: 0.967, forward: 0.452, backward: 9.992, update: 0.442
[proc 0] 300 steps, total: 20.509, sample: 1.091, forward: 0.463, backward: 14.744, update: 4.062
[proc 2] 300 steps, total: 20.510, sample: 0.993, forward: 0.453, backward: 9.583, update: 0.367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.933 ms                  | 86.039 ms                 |
| Forward                   | 4.654 ms                  | 5.592 ms                  |
| back: bucket keys         | 377.082 us                | 1.012 ms                  |
| back: a2a                 | 11.099 ms                 | 101.880 ms                |
| back: cache               | 12.763 ms                 | 52.072 ms                 |
| back: aggr dram keys      | 34.705 ms                 | 58.285 ms                 |
| back: set dram grad       | 4.176 ms                  | 18.338 ms                 |
| Backward                  | 145.874 ms                | 290.351 ms                |
| Optimize                  | 40.207 ms                 | 60.197 ms                 |
| BarrierTimeBeforeRank0    | 34.447 us                 | 68.597 us                 |
| BlockToStepN              | 24.464 us                 | 18.401 ms                 |
| OneStep                   | 197.905 ms                | 413.191 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.019 ms                  | 91.120 ms                 |
| Forward                   | 4.654 ms                  | 5.592 ms                  |
| back: bucket keys         | 375.725 us                | 1.011 ms                  |
| back: a2a                 | 11.064 ms                 | 97.996 ms                 |
| back: cache               | 12.763 ms                 | 51.321 ms                 |
| back: aggr dram keys      | 34.656 ms                 | 57.155 ms                 |
| back: set dram grad       | 4.176 ms                  | 16.619 ms                 |
| Backward                  | 141.574 ms                | 290.351 ms                |
| Optimize                  | 40.207 ms                 | 62.713 ms                 |
| BarrierTimeBeforeRank0    | 34.427 us                 | 68.597 us                 |
| BlockToStepN              | 22.979 us                 | 19.751 ms                 |
| OneStep                   | 196.431 ms                | 413.191 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.019 ms                  | 86.039 ms                 |
| Forward                   | 4.667 ms                  | 5.524 ms                  |
| back: bucket keys         | 377.082 us                | 1.011 ms                  |
| back: a2a                 | 11.015 ms                 | 97.996 ms                 |
| back: cache               | 12.763 ms                 | 51.321 ms                 |
| back: aggr dram keys      | 34.671 ms                 | 58.285 ms                 |
| back: set dram grad       | 4.173 ms                  | 16.619 ms                 |
| Backward                  | 141.574 ms                | 271.406 ms                |
| Optimize                  | 40.201 ms                 | 60.197 ms                 |
| BarrierTimeBeforeRank0    | 34.404 us                 | 66.044 us                 |
| BlockToStepN              | 23.218 us                 | 18.401 ms                 |
| OneStep                   | 195.389 ms                | 392.765 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.911 ms                  | 86.713 ms                 |
| Forward                   | 4.678 ms                  | 5.524 ms                  |
| back: bucket keys         | 377.082 us                | 1.010 ms                  |
| back: a2a                 | 11.008 ms                 | 84.176 ms                 |
| back: cache               | 12.763 ms                 | 51.239 ms                 |
| back: aggr dram keys      | 34.659 ms                 | 57.155 ms                 |
| back: set dram grad       | 4.173 ms                  | 18.338 ms                 |
| Backward                  | 140.800 ms                | 271.406 ms                |
| Optimize                  | 40.202 ms                 | 62.713 ms                 |
| BarrierTimeBeforeRank0    | 34.422 us                 | 66.044 us                 |
| BlockToStepN              | 23.652 us                 | 18.401 ms                 |
| OneStep                   | 193.786 ms                | 392.765 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 20.121, sample: 1.009, forward: 0.465, backward: 14.409, update: 4.102
[proc 3] 400 steps, total: 20.121, sample: 1.563, forward: 0.419, backward: 8.854, update: 0.384
[proc 1] 400 steps, total: 20.121, sample: 1.008, forward: 0.449, backward: 9.745, update: 0.386
[proc 2] 400 steps, total: 20.121, sample: 0.969, forward: 0.447, backward: 9.460, update: 0.389
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.875 ms                  | 86.713 ms                 |
| Forward                   | 4.688 ms                  | 5.585 ms                  |
| back: bucket keys         | 377.082 us                | 1.010 ms                  |
| back: a2a                 | 10.997 ms                 | 84.176 ms                 |
| back: cache               | 23.790 ms                 | 51.239 ms                 |
| back: aggr dram keys      | 34.674 ms                 | 58.285 ms                 |
| back: set dram grad       | 4.168 ms                  | 18.338 ms                 |
| Backward                  | 140.800 ms                | 271.406 ms                |
| Optimize                  | 40.263 ms                 | 62.713 ms                 |
| BarrierTimeBeforeRank0    | 34.508 us                 | 66.044 us                 |
| BlockToStepN              | 23.652 us                 | 18.401 ms                 |
| OneStep                   | 192.939 ms                | 392.765 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.896 ms                  | 91.120 ms                 |
| Forward                   | 4.699 ms                  | 5.928 ms                  |
| back: bucket keys         | 377.909 us                | 1.007 ms                  |
| back: a2a                 | 10.997 ms                 | 83.704 ms                 |
| back: cache               | 23.790 ms                 | 50.994 ms                 |
| back: aggr dram keys      | 34.606 ms                 | 57.155 ms                 |
| back: set dram grad       | 4.168 ms                  | 16.619 ms                 |
| Backward                  | 139.134 ms                | 271.406 ms                |
| Optimize                  | 40.284 ms                 | 62.713 ms                 |
| BarrierTimeBeforeRank0    | 34.600 us                 | 66.044 us                 |
| BlockToStepN              | 23.169 us                 | 18.401 ms                 |
| OneStep                   | 192.483 ms                | 392.765 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.896 ms                  | 86.713 ms                 |
| Forward                   | 4.708 ms                  | 5.592 ms                  |
| back: bucket keys         | 377.082 us                | 1.007 ms                  |
| back: a2a                 | 11.013 ms                 | 83.704 ms                 |
| back: cache               | 23.790 ms                 | 50.994 ms                 |
| back: aggr dram keys      | 34.588 ms                 | 57.410 ms                 |
| back: set dram grad       | 4.165 ms                  | 16.619 ms                 |
| Backward                  | 138.952 ms                | 269.239 ms                |
| Optimize                  | 40.296 ms                 | 60.197 ms                 |
| BarrierTimeBeforeRank0    | 34.669 us                 | 61.791 us                 |
| BlockToStepN              | 23.169 us                 | 15.535 ms                 |
| OneStep                   | 191.792 ms                | 386.382 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.801 ms                  | 86.713 ms                 |
| Forward                   | 4.721 ms                  | 5.592 ms                  |
| back: bucket keys         | 374.045 us                | 1.005 ms                  |
| back: a2a                 | 11.013 ms                 | 80.812 ms                 |
| back: cache               | 23.790 ms                 | 49.880 ms                 |
| back: aggr dram keys      | 34.571 ms                 | 57.155 ms                 |
| back: set dram grad       | 4.156 ms                  | 15.909 ms                 |
| Backward                  | 138.804 ms                | 269.239 ms                |
| Optimize                  | 40.350 ms                 | 62.918 ms                 |
| BarrierTimeBeforeRank0    | 34.719 us                 | 61.791 us                 |
| BlockToStepN              | 23.945 us                 | 19.164 ms                 |
| OneStep                   | 192.402 ms                | 386.382 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 19.753, sample: 1.358, forward: 0.424, backward: 8.863, update: 0.383
[proc 2] 500 steps, total: 19.753, sample: 0.979, forward: 0.447, backward: 9.089, update: 0.391
[proc 0] 500 steps, total: 19.753, sample: 1.019, forward: 0.476, backward: 13.959, update: 4.147
[proc 1] 500 steps, total: 19.753, sample: 0.990, forward: 0.470, backward: 9.385, update: 0.399
Successfully xmh. training takes 104.7401032447815 seconds
before call kg_cache_controller.StopThreads()
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
INFO [32648 controller_process.py:421] call rank0 to StopThreads
