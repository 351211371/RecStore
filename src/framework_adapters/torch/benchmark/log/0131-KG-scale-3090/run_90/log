WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 01:57:49.376993 19315 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_84', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [19315 sampler.py:454] Start PreSampling
WARNING [19315 sampler.py:532] Before construct renumbering_dict
WARNING [19315 sampler.py:555] PreSampling done
W20240204 02:18:02.298034 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 02:18:02.298238 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 02:18:02.298277 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 02:18:02.298310 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 02:18:02.298344 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 02:18:02.298389 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 02:18:02.298425 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 02:18:02.298481 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 02:18:02.298513 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 02:18:02.298549 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 02:18:02.298590 19315 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 02:18:02.298621 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 02:18:02.298645 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 02:18:02.298812 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 02:18:02.298848 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 02:18:02.298883 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 02:18:02.298929 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 02:18:02.298962 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 02:18:02.298991 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 02:18:02.299026 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 02:18:02.299058 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 02:18:02.299088 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 02:18:02.299130 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 02:18:02.299165 19315 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 02:18:02.299189 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 02:18:02.299216 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 02:18:02.299275 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 02:18:02.299305 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 02:18:02.299331 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 02:18:02.299362 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 02:18:02.299392 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 02:18:02.299425 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 02:18:02.299454 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 02:18:02.299484 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 02:18:02.299517 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 02:18:02.299544 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 02:18:02.299580 19315 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 02:18:02.299603 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 02:18:02.299633 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 02:18:02.299705 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 02:18:02.299742 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 02:18:02.299777 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 02:18:02.299806 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 02:18:02.299835 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 02:18:02.299878 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 02:18:02.299919 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 02:18:02.299952 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 02:18:02.299981 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 02:18:02.300014 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 02:18:02.300043 19315 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 02:18:02.300081 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 02:18:02.300105 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 02:18:02.300169 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 02:18:02.300208 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 02:18:02.300242 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 02:18:02.300271 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 02:18:02.300303 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 02:18:02.300336 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 02:18:02.300369 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 02:18:02.300397 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 02:18:02.300426 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 02:18:02.300459 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 02:18:02.300491 19315 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 02:18:02.300515 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 02:18:02.300539 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 02:18:02.300596 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 02:18:02.300633 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 02:18:02.300666 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 02:18:02.300694 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 02:18:02.300722 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 02:18:02.300750 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 02:18:02.300794 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 02:18:02.300825 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 02:18:02.300860 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 02:18:02.300896 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 02:18:02.300931 19315 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 02:18:02.300954 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 02:18:02.300985 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 02:18:02.301051 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 02:18:02.301084 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 02:18:02.301116 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 02:18:02.301149 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 02:18:02.301183 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 02:18:02.301213 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 02:18:02.301244 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 02:18:02.301275 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 02:18:02.301306 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 02:18:02.301338 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 02:18:02.301379 19315 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 02:18:02.301404 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 02:18:02.301434 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 02:18:02.301489 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 02:18:02.301524 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 02:18:02.301558 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 02:18:02.301587 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 02:18:02.301621 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 02:18:02.301659 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 02:18:02.301694 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 02:18:02.301725 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 02:18:02.301754 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 02:18:02.301792 19315 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 02:18:02.301826 19315 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 02:18:02.301859 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 02:18:02.301890 19315 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 02:18:02.723109 19315 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240204 02:26:38.724531 19315 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302711,  4302723,    95813,  ..., 65802742, 61960741,  4809745]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2238.801 seconds
[Rank1] pid = 48551
[Rank2] pid = 48645
[Rank3] pid = 48714
[Rank4] pid = 48783
[Rank5] pid = 48913
[Rank6] pid = 49117
INFO [19315 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [48551 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [48645 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [48714 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [48783 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [49117 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [19315 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48551 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49294 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [48913 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [49117 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48645 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48913 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48783 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [49294 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [48714 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 02:35:18.282886 48552 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240204 02:35:18.283149 49295 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240204 02:35:18.284461 48914 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240204 02:35:18.284515 49358 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240204 02:35:18.284540 48646 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240204 02:35:18.284564 48784 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240204 02:35:18.284602 48715 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240204 02:35:18.285301 49118 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240204 02:35:18.364086 48552 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1020497a3000 7.629 MB
W20240204 02:35:18.364281 48552 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x102049f46000 7.629 MB
W20240204 02:35:18.364342 48552 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10204a6e9000 1.49 GB
W20240204 02:35:18.364400 48552 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1020a9ccc000 1.49 GB
W20240204 02:35:18.364459 48552 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 02:35:18.364884 49358 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1021092b9000 7.629 MB
W20240204 02:35:18.364887 48914 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x102109a5c000 7.629 MB
W20240204 02:35:18.364900 48646 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10210a1ff000 7.629 MB
W20240204 02:35:18.364914 48784 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10210a9a2000 7.629 MB
W20240204 02:35:18.364928 48715 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10210b145000 7.629 MB
W20240204 02:35:18.365052 49358 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10210b8e8000 7.629 MB
W20240204 02:35:18.365067 48646 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10210c08b000 7.629 MB
W20240204 02:35:18.365072 48784 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10210c82e000 7.629 MB
W20240204 02:35:18.365085 48715 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10210cfd1000 7.629 MB
W20240204 02:35:18.365089 48914 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10210d774000 7.629 MB
W20240204 02:35:18.365151 49358 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x10210df17000 1.49 GB
W20240204 02:35:18.365180 48784 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x10216d4fa000 1.49 GB
W20240204 02:35:18.365186 48715 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1021ccadd000 1.49 GB
W20240204 02:35:18.365193 48646 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10222c0c0000 1.49 GB
W20240204 02:35:18.365208 48914 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10228b6a3000 1.49 GB
W20240204 02:35:18.365229 49358 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1022eac86000 1.49 GB
W20240204 02:35:18.365244 48784 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10234a269000 1.49 GB
W20240204 02:35:18.365259 48715 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1023a984c000 1.49 GB
W20240204 02:35:18.365267 48646 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x102408e2f000 1.49 GB
W20240204 02:35:18.365283 48914 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x102468412000 1.49 GB
W20240204 02:35:18.365299 49358 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 02:35:18.365311 48784 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 02:35:18.365320 48715 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 02:35:18.365327 48646 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 02:35:18.365332 48914 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 02:35:18.366520 49295 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1024c79f9000 7.629 MB
W20240204 02:35:18.366678 49295 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1024c893f000 7.629 MB
W20240204 02:35:18.366670 49118 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1024c819c000 7.629 MB
W20240204 02:35:18.366746 49295 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1024c90e2000 1.49 GB
W20240204 02:35:18.366801 49295 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1025286c5000 1.49 GB
W20240204 02:35:18.366839 49118 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x102587ca8000 7.629 MB
W20240204 02:35:18.366878 49295 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 02:35:18.366930 49118 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10258844b000 1.49 GB
W20240204 02:35:18.366988 49118 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1025e7a2e000 1.49 GB
W20240204 02:35:18.367041 49118 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 02:35:18.379329 48552 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 02:35:18.379372 49358 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 02:35:18.379377 48784 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 02:35:18.379381 49295 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 02:35:18.379382 48646 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 02:35:18.379386 49118 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 02:35:18.379390 48715 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 02:35:18.379400 48914 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [48645 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [49117 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [48551 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 49294
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [19315 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [48913 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [48714 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [48783 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [49294 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 02:36:08.608130 49358 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 02:36:08.608211 48914 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 02:36:08.608757 48715 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 02:36:08.608800 49295 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 02:36:08.608852 48784 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 02:36:08.608891 49118 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 02:36:08.608960 48646 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 02:36:08.609036 48552 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 02:36:08.611701 49295 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 02:36:08.611943 49295 grad_base.h:184] Init GradProcessingBase done
I20240204 02:36:21.151598 49295 grad_async_v2.h:42] Use main thread to update emb.
W20240204 02:36:21.151803 49295 kg_controller.h:78] after init GradAsyncProcessingV2
I20240204 02:36:21.151813 49295 kg_controller.h:84] Construct KGCacheController done
E20240204 02:36:21.920614 49358 recstore.cc:66] init folly done
E20240204 02:36:21.921051 48715 recstore.cc:66] init folly done
E20240204 02:36:21.921056 48784 recstore.cc:66] init folly done
E20240204 02:36:21.921129 48914 recstore.cc:66] init folly done
E20240204 02:36:21.921511 48646 recstore.cc:66] init folly done
E20240204 02:36:21.921519 49295 recstore.cc:66] init folly done
E20240204 02:36:21.921651 48552 recstore.cc:66] init folly done
E20240204 02:36:21.921653 49118 recstore.cc:66] init folly done
I20240204 02:36:21.922585 49295 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240204 02:36:40.995507 53992 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 02:36:40.996141 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 165.801 us                | 318.186 us                |
+---------------------------+---------------------------+---------------------------+
W20240204 02:36:42.129470 53992 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 02:36:42.129603 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:36:43.250577 53992 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240204 02:36:43.250721 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:36:44.334772 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 02:36:44.350011 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 02:36:44.513305 49358 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 02:36:44.546648 48914 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 02:36:44.563861 48784 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 02:36:45.346755 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 02:36:45.357890 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 02:36:45.467304 48646 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 02:36:46.357019 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 02:36:46.481429 48715 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 02:36:46.516152 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 151.359 us                | 271.112 us                |
+---------------------------+---------------------------+---------------------------+
I20240204 02:36:46.966264 48552 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 02:36:47.357040 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=15
W20240204 02:36:47.700649 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240204 02:36:47.753249 49295 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240204 02:36:49.111462 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 02:36:49.127516 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240204 02:36:49.276890 49118 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240204 02:36:51.711112 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 02:36:51.874645 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240204 02:36:51.898993 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 158.116 us                | 4.241 ms                  |
| ProcessBack:Shuffle       | 250.410 ms                | 289.057 ms                |
| ProcessBack:UpdateCache   | 696.706 ms                | 697.338 ms                |
| ProcessBack:UpsertPq      | 65.814 ms                 | 162.008 ms                |
| ProcessOneStep            | 1.439 s                   | 1.439 s                   |
| BlockToStepN              | 13.655 ms                 | 13.655 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 02:36:52.711014 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
W20240204 02:36:52.884841 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240204 02:36:53.070406 53992 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.541 ms                  | 109.025 ms                |
| Forward                   | 5.727 ms                  | 737.593 ms                |
| Backward                  | 7.765 ms                  | 256.459 ms                |
| Optimize                  | 3.142 ms                  | 10.332 ms                 |
| BarrierTimeBeforeRank0    | 9.959 ms                  | 149.459 ms                |
| AfterBackward             | 100.332 ms                | 1.439 s                   |
| BlockToStepN              | 999.738 us                | 15.377 ms                 |
| OneStep                   | 145.065 ms                | 2.618 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:36:53.705973 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=13, sample_step_cpp_seen_[rank]=12
E20240204 02:36:53.711628 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240204 02:36:54.306650 53992 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240204 02:36:54.711014 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=169
W20240204 02:36:55.308308 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=14, pq.top=14
W20240204 02:36:55.315448 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 02:36:55.711012 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=881
W20240204 02:36:56.352264 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240204 02:36:56.484021 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240204 02:36:56.711010 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=39
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 389.720 us                | 5.865 ms                  |
| ProcessBack:Shuffle       | 8.228 ms                  | 289.057 ms                |
| ProcessBack:UpdateCache   | 10.461 ms                 | 697.338 ms                |
| ProcessBack:UpsertPq      | 36.564 ms                 | 194.393 ms                |
| ProcessOneStep            | 112.352 ms                | 1.619 s                   |
| BlockToStepN              | 958.961 us                | 14.919 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:36:57.492137 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=27, pq.top=27
E20240204 02:36:57.711016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:36:57.776492 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.136 ms                  | 120.176 ms                |
| Forward                   | 6.072 ms                  | 737.593 ms                |
| Backward                  | 5.708 ms                  | 256.459 ms                |
| Optimize                  | 2.819 ms                  | 10.332 ms                 |
| BarrierTimeBeforeRank0    | 4.926 ms                  | 149.459 ms                |
| AfterBackward             | 112.405 ms                | 1.619 s                   |
| BlockToStepN              | 1.045 ms                  | 15.377 ms                 |
| OneStep                   | 151.388 ms                | 2.618 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:36:58.705006 49295 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=27, sample_step_cpp_seen_[rank]=26
E20240204 02:36:58.711006 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=263
W20240204 02:36:58.834954 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
W20240204 02:36:59.138134 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=29, pq.top=29
E20240204 02:36:59.712394 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:36:59.854678 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
W20240204 02:37:00.208290 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=38, pq.top=38
E20240204 02:37:00.713999 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:37:01.041420 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
E20240204 02:37:01.722352 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 361.193 us                | 3.425 ms                  |
| ProcessBack:Shuffle       | 8.476 ms                  | 250.410 ms                |
| ProcessBack:UpdateCache   | 10.569 ms                 | 696.706 ms                |
| ProcessBack:UpsertPq      | 35.507 ms                 | 164.306 ms                |
| ProcessOneStep            | 112.018 ms                | 1.619 s                   |
| BlockToStepN              | 926.990 us                | 14.919 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:02.048799 53992 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
E20240204 02:37:02.722369 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:37:03.083103 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240204 02:37:03.202647 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.572 ms                  | 120.176 ms                |
| Forward                   | 6.072 ms                  | 10.282 ms                 |
| Backward                  | 5.959 ms                  | 35.759 ms                 |
| Optimize                  | 2.819 ms                  | 6.012 ms                  |
| BarrierTimeBeforeRank0    | 3.616 ms                  | 86.351 ms                 |
| AfterBackward             | 111.713 ms                | 1.474 s                   |
| BlockToStepN              | 798.008 us                | 15.015 ms                 |
| OneStep                   | 145.065 ms                | 1.651 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:37:03.722010 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=6099
E20240204 02:37:03.774121 49295 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=56, sample_step_cpp_seen_[rank]=55
W20240204 02:37:04.323372 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
E20240204 02:37:04.722119 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:37:05.037858 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240204 02:37:05.370659 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
E20240204 02:37:05.722047 54222 parallel_pq_v2.h:79] insert failed, size(hashtable)=17439
W20240204 02:37:06.037243 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240204 02:37:06.488031 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 02:37:06.727578 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 495.169 us                | 6.425 ms                  |
| ProcessBack:Shuffle       | 8.621 ms                  | 250.410 ms                |
| ProcessBack:UpdateCache   | 10.813 ms                 | 696.706 ms                |
| ProcessBack:UpsertPq      | 36.564 ms                 | 164.306 ms                |
| ProcessOneStep            | 111.575 ms                | 1.474 s                   |
| BlockToStepN              | 958.961 us                | 14.919 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:07.037132 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=72, pq.top=72
W20240204 02:37:07.496714 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240204 02:37:07.727010 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=602
W20240204 02:37:08.550099 53992 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.541 ms                  | 124.183 ms                |
| Forward                   | 5.792 ms                  | 10.282 ms                 |
| Backward                  | 5.905 ms                  | 35.759 ms                 |
| Optimize                  | 2.886 ms                  | 7.617 ms                  |
| BarrierTimeBeforeRank0    | 4.329 ms                  | 86.351 ms                 |
| AfterBackward             | 110.899 ms                | 1.474 s                   |
| BlockToStepN              | 873.450 us                | 15.377 ms                 |
| OneStep                   | 142.634 ms                | 1.651 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:37:08.730489 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:37:09.398025 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240204 02:37:09.563103 53992 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240204 02:37:09.654764 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=85, sample_step_cpp_seen_[rank]=84
E20240204 02:37:09.730010 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=6724
W20240204 02:37:10.643492 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240204 02:37:10.730005 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240204 02:37:10.906358 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=86, pq.top=86
W20240204 02:37:11.664554 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
E20240204 02:37:11.730013 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=3056
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 419.059 us                | 7.736 ms                  |
| ProcessBack:Shuffle       | 8.485 ms                  | 27.624 ms                 |
| ProcessBack:UpdateCache   | 10.813 ms                 | 62.958 ms                 |
| ProcessBack:UpsertPq      | 31.404 ms                 | 162.513 ms                |
| ProcessOneStep            | 108.754 ms                | 1.474 s                   |
| BlockToStepN              | 779.350 us                | 14.919 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:11.946979 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=94, pq.top=94
W20240204 02:37:12.723927 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 02:37:12.730468 54241 parallel_pq_v2.h:79] insert failed, size(hashtable)=96
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.686 ms                  | 124.183 ms                |
| Forward                   | 5.644 ms                  | 10.282 ms                 |
| Backward                  | 5.647 ms                  | 35.759 ms                 |
| Optimize                  | 2.857 ms                  | 7.617 ms                  |
| BarrierTimeBeforeRank0    | 3.616 ms                  | 97.062 ms                 |
| AfterBackward             | 105.050 ms                | 1.474 s                   |
| BlockToStepN              | 999.738 us                | 15.377 ms                 |
| OneStep                   | 136.052 ms                | 1.651 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:37:13.730018 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=588
W20240204 02:37:13.738098 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 28.322, sample: 1.430, forward: 1.471, backward: 0.818, update: 0.275
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 24.512, sample: 1.340, forward: 1.318, backward: 0.894, update: 0.252
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 29.225, sample: 1.568, forward: 1.287, backward: 0.758, update: 0.254
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 29.243, sample: 1.343, forward: 1.328, backward: 0.850, update: 0.257
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 29.276, sample: 1.688, forward: 1.274, backward: 0.823, update: 0.242
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 27.308, sample: 1.615, forward: 1.231, backward: 0.903, update: 0.238
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 26.823, sample: 1.360, forward: 1.290, backward: 0.802, update: 0.248
train_sampler.Prefill()
-------Step 0-------
tensor([   70239,    70284,    70340,    70382,  5946752,    83960, 55553410,
        19553463, 23286166,    70424]) tensor([ 5283509, 14719166, 66594205, 68397118, 21234683, 30504696, 41030760,
        71668874, 64374765, 32095191])
-------Step 1-------
tensor([   70239,    70284,    70340,    70382,  5946752,    83960, 55553410,
        19553463, 23286166,    70424]) tensor([74889728, 24854138, 11493055, 74580816, 75321094, 47034396, 78191905,
        53363234, 40385311, 14320174])
-------Step 2-------
tensor([  174535,   174589,   174625,    33323,   174660,   174708,   174753,
        27915317,   174793,   174840]) tensor([72132448, 22021884, 84272754, 54581763, 36596196, 31328244, 75247427,
        36063549, 15456933, 46185991])
-------Step 3-------
tensor([  174535,   174589,   174625,    33323,   174660,   174708,   174753,
        27915317,   174793,   174840]) tensor([52698786, 77612801, 38950205, 37872429, 69447631, 70133038, 40902729,
        18005189, 28981131,   759830])
-------Step 4-------
tensor([  276698, 40407808,   276741,   105820,   276774,   105853,   276828,
        39673213,   276860,   276919]) tensor([73859878, 10654127, 84748137, 18873184, 75806141, 47049721, 59470540,
        37049947, 75993180, 45745239])
-------Step 5-------
tensor([  276698, 40407808,   276741,   105820,   276774,   105853,   276828,
        39673213,   276860,   276919]) tensor([31058269, 81689499,   192303, 82808664, 54879574, 58971852, 16196613,
        10329559, 78506538, 44574420])
-------Step 6-------
tensor([  381584,    69797,   381623,   381666,    69828, 68003190,   381715,
          381759,   116510, 35862861]) tensor([13915795, 42718587, 31594384, 83644910, 29514547, 41084333, 27004094,
         7009342, 68620697, 74104011])
-------Step 7-------
tensor([  381584,    69797,   381623,   381666,    69828, 68003190,   381715,
          381759,   116510, 35862861]) tensor([22801045, 57540108, 65084116, 52073083, 84325223, 44641630, 57470287,
        60187724, 39849510, 35564079])
-------Step 8-------
tensor([  446189, 23407896,   446211,   126681,   446230,    87452,   446248,
          446261,   446285,   446302]) tensor([48405002, 27705854, 36709139,  1980892, 54631926, 71069164, 16735241,
        76830920,  1523732, 56058457])
-------Step 9-------
tensor([  446189, 23407896,   446211,   126681,   446230,    87452,   446248,
          446261,   446285,   446302]) tensor([47147153, 35229841, 15096708, 59947797,  9050876, 36221181, 24892103,
        34477448, 85125421, 72991062])
before start barrier
start train
[proc 0] 100 steps, total: 26.036, sample: 1.748, forward: 1.308, backward: 0.911, update: 0.325
W20240204 02:37:14.014392 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=102, pq.top=102
E20240204 02:37:14.733492 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:37:14.866238 53992 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
W20240204 02:37:15.068312 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=109, pq.top=109
E20240204 02:37:15.618861 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=114, sample_step_cpp_seen_[rank]=113
E20240204 02:37:15.733006 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=396
W20240204 02:37:15.945443 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
W20240204 02:37:16.693847 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=115, pq.top=115
E20240204 02:37:16.736557 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1889
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 324.530 us                | 3.551 ms                  |
| ProcessBack:Shuffle       | 8.429 ms                  | 27.624 ms                 |
| ProcessBack:UpdateCache   | 10.953 ms                 | 62.958 ms                 |
| ProcessBack:UpsertPq      | 28.740 ms                 | 162.513 ms                |
| ProcessOneStep            | 105.022 ms                | 1.474 s                   |
| BlockToStepN              | 859.923 us                | 14.919 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:16.966487 53992 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240204 02:37:17.721964 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=121, pq.top=121
E20240204 02:37:17.736006 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=45472
W20240204 02:37:17.977391 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.238 ms                  | 124.183 ms                |
| Forward                   | 5.583 ms                  | 16.986 ms                 |
| Backward                  | 5.507 ms                  | 35.759 ms                 |
| Optimize                  | 2.819 ms                  | 10.332 ms                 |
| BarrierTimeBeforeRank0    | 3.135 ms                  | 149.459 ms                |
| AfterBackward             | 105.063 ms                | 1.474 s                   |
| BlockToStepN              | 1.072 ms                  | 26.917 ms                 |
| OneStep                   | 134.833 ms                | 1.651 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:37:18.736011 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=8424
W20240204 02:37:18.764892 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240204 02:37:19.072252 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240204 02:37:19.736013 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=7360
W20240204 02:37:19.929426 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240204 02:37:20.083585 53992 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240204 02:37:20.736011 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=2103
W20240204 02:37:21.118975 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
W20240204 02:37:21.181391 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=139, pq.top=138
E20240204 02:37:21.736017 54245 parallel_pq_v2.h:79] insert failed, size(hashtable)=42705
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 434.946 us                | 15.838 ms                 |
| ProcessBack:Shuffle       | 8.375 ms                  | 27.619 ms                 |
| ProcessBack:UpdateCache   | 10.701 ms                 | 62.402 ms                 |
| ProcessBack:UpsertPq      | 28.456 ms                 | 162.008 ms                |
| ProcessOneStep            | 105.022 ms                | 1.474 s                   |
| BlockToStepN              | 1.087 ms                  | 54.976 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:22.263248 53992 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240204 02:37:22.398003 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=149, sample_step_cpp_seen_[rank]=148
E20240204 02:37:22.736021 54241 parallel_pq_v2.h:79] insert failed, size(hashtable)=2473
W20240204 02:37:23.280668 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.095 ms                  | 120.176 ms                |
| Forward                   | 5.466 ms                  | 10.282 ms                 |
| Backward                  | 5.545 ms                  | 17.706 ms                 |
| Optimize                  | 2.739 ms                  | 7.617 ms                  |
| BarrierTimeBeforeRank0    | 3.358 ms                  | 149.459 ms                |
| AfterBackward             | 105.050 ms                | 1.474 s                   |
| BlockToStepN              | 1.072 ms                  | 55.085 ms                 |
| OneStep                   | 134.833 ms                | 1.651 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:23.726671 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=151, pq.top=151
E20240204 02:37:23.736155 54247 parallel_pq_v2.h:79] insert failed, size(hashtable)=70190
W20240204 02:37:24.291013 53992 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end6
W20240204 02:37:24.726125 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=159, pq.top=159
E20240204 02:37:24.736018 54230 parallel_pq_v2.h:79] insert failed, size(hashtable)=32130
W20240204 02:37:25.400914 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 02:37:25.736011 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=134
W20240204 02:37:26.450948 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240204 02:37:26.736011 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=150
W20240204 02:37:26.780069 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 316.339 us                | 4.535 ms                  |
| ProcessBack:Shuffle       | 8.341 ms                  | 27.624 ms                 |
| ProcessBack:UpdateCache   | 10.569 ms                 | 62.402 ms                 |
| ProcessBack:UpsertPq      | 26.765 ms                 | 162.008 ms                |
| ProcessOneStep            | 104.250 ms                | 1.439 s                   |
| BlockToStepN              | 1.161 ms                  | 54.976 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:27.548987 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240204 02:37:27.736011 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=9
W20240204 02:37:27.942461 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=177, pq.top=177
E20240204 02:37:28.250439 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=179, sample_step_cpp_seen_[rank]=178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.892 ms                  | 120.176 ms                |
| Forward                   | 5.413 ms                  | 10.282 ms                 |
| Backward                  | 5.545 ms                  | 17.706 ms                 |
| Optimize                  | 2.704 ms                  | 7.617 ms                  |
| BarrierTimeBeforeRank0    | 4.290 ms                  | 128.598 ms                |
| AfterBackward             | 103.803 ms                | 1.439 s                   |
| BlockToStepN              | 1.267 ms                  | 55.085 ms                 |
| OneStep                   | 135.543 ms                | 1.495 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:28.631624 53992 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240204 02:37:28.736004 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=4144
W20240204 02:37:29.509889 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240204 02:37:29.646239 53992 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end2
E20240204 02:37:29.738579 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=12333
W20240204 02:37:30.607604 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240204 02:37:30.698136 53992 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240204 02:37:30.738014 54243 parallel_pq_v2.h:79] insert failed, size(hashtable)=15675
E20240204 02:37:31.738126 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:37:31.760851 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 367.720 us                | 9.915 ms                  |
| ProcessBack:Shuffle       | 8.314 ms                  | 27.619 ms                 |
| ProcessBack:UpdateCache   | 10.411 ms                 | 17.229 ms                 |
| ProcessBack:UpsertPq      | 26.272 ms                 | 155.481 ms                |
| ProcessOneStep            | 103.756 ms                | 1.439 s                   |
| BlockToStepN              | 1.191 ms                  | 56.211 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:32.361317 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=195, pq.top=195
E20240204 02:37:32.748253 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:37:32.763088 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
[proc 0] 200 steps, total: 19.301, sample: 1.112, forward: 0.551, backward: 0.551, update: 0.299
[proc 4] 200 steps, total: 19.302, sample: 1.418, forward: 0.599, backward: 0.561, update: 0.234
[proc 5] 200 steps, total: 19.302, sample: 1.435, forward: 0.544, backward: 0.557, update: 0.236
[proc 6] 200 steps, total: 19.302, sample: 1.211, forward: 0.569, backward: 0.591, update: 0.239
[proc 7] 200 steps, total: 19.301, sample: 1.654, forward: 0.606, backward: 0.512, update: 0.243
[proc 2] 200 steps, total: 19.302, sample: 1.160, forward: 0.518, backward: 0.588, update: 0.262
[proc 3] 200 steps, total: 19.301, sample: 1.483, forward: 0.548, backward: 0.671, update: 0.236
[proc 1] 200 steps, total: 19.301, sample: 1.316, forward: 0.542, backward: 0.582, update: 0.228
W20240204 02:37:33.397300 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=203, pq.top=202
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.746 ms                  | 124.183 ms                |
| Forward                   | 5.443 ms                  | 10.282 ms                 |
| Backward                  | 5.507 ms                  | 17.706 ms                 |
| Optimize                  | 2.646 ms                  | 7.617 ms                  |
| BarrierTimeBeforeRank0    | 4.380 ms                  | 128.598 ms                |
| AfterBackward             | 102.754 ms                | 1.439 s                   |
| BlockToStepN              | 1.433 ms                  | 56.356 ms                 |
| OneStep                   | 136.370 ms                | 1.495 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:37:33.748586 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=8228
W20240204 02:37:33.935074 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240204 02:37:34.008172 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=208, sample_step_cpp_seen_[rank]=207
E20240204 02:37:34.748167 54248 parallel_pq_v2.h:79] insert failed, size(hashtable)=12037
W20240204 02:37:34.946400 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240204 02:37:35.043538 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=209, pq.top=209
E20240204 02:37:35.748014 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=57753
W20240204 02:37:36.030786 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end5
W20240204 02:37:36.249650 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=217, pq.top=217
E20240204 02:37:36.748016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=3046
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 503.916 us                | 19.632 ms                 |
| ProcessBack:Shuffle       | 8.302 ms                  | 27.619 ms                 |
| ProcessBack:UpdateCache   | 10.355 ms                 | 17.229 ms                 |
| ProcessBack:UpsertPq      | 26.272 ms                 | 155.481 ms                |
| ProcessOneStep            | 102.169 ms                | 1.439 s                   |
| BlockToStepN              | 1.446 ms                  | 56.435 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:37.220343 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end5
E20240204 02:37:37.748013 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1389
W20240204 02:37:37.914811 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240204 02:37:38.258246 53992 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.495 ms                  | 124.183 ms                |
| Forward                   | 5.471 ms                  | 10.282 ms                 |
| Backward                  | 5.501 ms                  | 17.706 ms                 |
| Optimize                  | 2.718 ms                  | 7.617 ms                  |
| BarrierTimeBeforeRank0    | 4.290 ms                  | 128.598 ms                |
| AfterBackward             | 101.786 ms                | 1.439 s                   |
| BlockToStepN              | 1.504 ms                  | 56.561 ms                 |
| OneStep                   | 135.543 ms                | 1.495 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:37:38.748011 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=315
W20240204 02:37:38.993311 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240204 02:37:39.304526 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end6
E20240204 02:37:39.748015 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=39464
E20240204 02:37:39.770864 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=239, sample_step_cpp_seen_[rank]=238
W20240204 02:37:40.744329 53992 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240204 02:37:40.748772 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240204 02:37:41.754824 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:37:41.803834 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 341.973 us                | 2.872 ms                  |
| ProcessBack:Shuffle       | 8.318 ms                  | 25.554 ms                 |
| ProcessBack:UpdateCache   | 10.284 ms                 | 16.264 ms                 |
| ProcessBack:UpsertPq      | 26.470 ms                 | 139.123 ms                |
| ProcessOneStep            | 101.725 ms                | 1.439 s                   |
| BlockToStepN              | 1.532 ms                  | 56.435 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:42.090557 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=241, pq.top=241
E20240204 02:37:42.754009 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=3539
W20240204 02:37:42.905005 53992 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
W20240204 02:37:43.218657 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=249, pq.top=249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.298 ms                  | 120.176 ms                |
| Forward                   | 5.486 ms                  | 10.282 ms                 |
| Backward                  | 5.422 ms                  | 12.539 ms                 |
| Optimize                  | 2.680 ms                  | 7.580 ms                  |
| BarrierTimeBeforeRank0    | 3.891 ms                  | 127.612 ms                |
| AfterBackward             | 101.786 ms                | 1.439 s                   |
| BlockToStepN              | 1.646 ms                  | 56.356 ms                 |
| OneStep                   | 135.893 ms                | 1.495 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:37:43.754017 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=50793
W20240204 02:37:44.112205 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240204 02:37:44.754016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=85
E20240204 02:37:44.770031 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=255, sample_step_cpp_seen_[rank]=254
W20240204 02:37:45.138411 53992 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240204 02:37:45.755168 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=707
W20240204 02:37:45.903251 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=262, pq.top=262
W20240204 02:37:46.271441 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
E20240204 02:37:46.755012 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=2960
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 547.744 us                | 14.228 ms                 |
| ProcessBack:Shuffle       | 8.294 ms                  | 25.554 ms                 |
| ProcessBack:UpdateCache   | 10.280 ms                 | 16.264 ms                 |
| ProcessBack:UpsertPq      | 26.547 ms                 | 139.123 ms                |
| ProcessOneStep            | 101.725 ms                | 1.439 s                   |
| BlockToStepN              | 1.575 ms                  | 57.732 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:47.100502 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=269, pq.top=269
W20240204 02:37:47.394094 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240204 02:37:47.755010 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1080
W20240204 02:37:48.468358 53992 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.063 ms                  | 120.176 ms                |
| Forward                   | 5.477 ms                  | 10.282 ms                 |
| Backward                  | 5.388 ms                  | 12.539 ms                 |
| Optimize                  | 2.704 ms                  | 7.580 ms                  |
| BarrierTimeBeforeRank0    | 4.380 ms                  | 128.598 ms                |
| AfterBackward             | 102.219 ms                | 1.439 s                   |
| BlockToStepN              | 1.681 ms                  | 57.859 ms                 |
| OneStep                   | 136.370 ms                | 1.495 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:48.669150 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=273, pq.top=273
E20240204 02:37:48.756732 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=389
W20240204 02:37:49.587570 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end9
E20240204 02:37:49.756016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=504
W20240204 02:37:49.870705 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240204 02:37:50.596210 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240204 02:37:50.678817 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=6, step_no=288, sample_step_cpp_seen_[rank]=287
E20240204 02:37:50.756028 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=3908
W20240204 02:37:51.625600 53992 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240204 02:37:51.756011 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=568
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 411.063 us                | 5.707 ms                  |
| ProcessBack:Shuffle       | 8.302 ms                  | 23.736 ms                 |
| ProcessBack:UpdateCache   | 10.198 ms                 | 16.156 ms                 |
| ProcessBack:UpsertPq      | 26.495 ms                 | 134.157 ms                |
| ProcessOneStep            | 100.715 ms                | 1.439 s                   |
| BlockToStepN              | 1.636 ms                  | 57.732 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:52.076774 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240204 02:37:52.732785 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240204 02:37:52.756016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=12520
W20240204 02:37:53.117375 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 7] 300 steps, total: 20.164, sample: 1.504, forward: 0.566, backward: 0.581, update: 0.237
[proc 3] 300 steps, total: 20.163, sample: 1.334, forward: 0.557, backward: 0.624, update: 0.234
[proc 1] 300 steps, total: 20.163, sample: 1.212, forward: 0.525, backward: 0.638, update: 0.222
[proc 4] 300 steps, total: 20.164, sample: 1.222, forward: 0.561, backward: 0.592, update: 0.232
[proc 6] 300 steps, total: 20.164, sample: 1.327, forward: 0.547, backward: 0.620, update: 0.232
[proc 0] 300 steps, total: 20.164, sample: 1.074, forward: 0.551, backward: 0.627, update: 0.294
[proc 5] 300 steps, total: 20.164, sample: 1.094, forward: 0.583, backward: 0.617, update: 0.237
[proc 2] 300 steps, total: 20.164, sample: 1.067, forward: 0.527, backward: 0.581, update: 0.233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.188 ms                  | 120.176 ms                |
| Forward                   | 5.471 ms                  | 11.021 ms                 |
| Backward                  | 5.501 ms                  | 17.706 ms                 |
| Optimize                  | 2.634 ms                  | 7.617 ms                  |
| BarrierTimeBeforeRank0    | 4.513 ms                  | 128.598 ms                |
| AfterBackward             | 100.777 ms                | 1.439 s                   |
| BlockToStepN              | 1.806 ms                  | 57.859 ms                 |
| OneStep                   | 136.052 ms                | 1.495 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:37:53.756009 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=5743
W20240204 02:37:53.957877 53992 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240204 02:37:54.756016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=10585
W20240204 02:37:54.936077 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240204 02:37:54.972260 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240204 02:37:55.756014 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=6437
W20240204 02:37:55.995903 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end2
W20240204 02:37:56.079236 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=312, pq.top=312
E20240204 02:37:56.756016 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=861
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 554.354 us                | 17.105 ms                 |
| ProcessBack:Shuffle       | 8.375 ms                  | 23.736 ms                 |
| ProcessBack:UpdateCache   | 10.197 ms                 | 16.156 ms                 |
| ProcessBack:UpsertPq      | 26.722 ms                 | 144.229 ms                |
| ProcessOneStep            | 100.298 ms                | 1.439 s                   |
| BlockToStepN              | 1.761 ms                  | 57.732 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:57.084738 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
W20240204 02:37:57.270486 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240204 02:37:57.321053 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=5, step_no=321, sample_step_cpp_seen_[rank]=320
E20240204 02:37:57.756016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=6371
W20240204 02:37:58.240350 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.495 ms                  | 120.176 ms                |
| Forward                   | 5.471 ms                  | 11.021 ms                 |
| Backward                  | 5.571 ms                  | 17.706 ms                 |
| Optimize                  | 2.634 ms                  | 10.332 ms                 |
| BarrierTimeBeforeRank0    | 4.429 ms                  | 128.598 ms                |
| AfterBackward             | 101.786 ms                | 1.439 s                   |
| BlockToStepN              | 1.849 ms                  | 57.859 ms                 |
| OneStep                   | 137.232 ms                | 1.495 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 02:37:58.673451 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=324, pq.top=324
E20240204 02:37:58.756011 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=630
W20240204 02:37:59.252485 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
W20240204 02:37:59.725651 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=331, pq.top=331
E20240204 02:37:59.756016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=46019
W20240204 02:38:00.416965 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
W20240204 02:38:00.725481 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240204 02:38:00.757671 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=31091
W20240204 02:38:01.555681 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240204 02:38:01.757014 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1466
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 616.835 us                | 24.736 ms                 |
| ProcessBack:Shuffle       | 8.389 ms                  | 22.699 ms                 |
| ProcessBack:UpdateCache   | 10.119 ms                 | 15.413 ms                 |
| ProcessBack:UpsertPq      | 26.722 ms                 | 139.123 ms                |
| ProcessOneStep            | 100.715 ms                | 1.439 s                   |
| BlockToStepN              | 1.815 ms                  | 64.270 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:38:02.119702 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=341, pq.top=341
W20240204 02:38:02.586877 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
E20240204 02:38:02.757009 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=101
W20240204 02:38:03.182525 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=347, pq.top=347
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.734 ms                  | 120.176 ms                |
| Forward                   | 5.450 ms                  | 10.282 ms                 |
| Backward                  | 5.591 ms                  | 12.539 ms                 |
| Optimize                  | 2.622 ms                  | 8.313 ms                  |
| BarrierTimeBeforeRank0    | 4.542 ms                  | 127.612 ms                |
| AfterBackward             | 100.332 ms                | 1.439 s                   |
| BlockToStepN              | 2.017 ms                  | 64.407 ms                 |
| OneStep                   | 137.254 ms                | 1.495 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:38:03.757009 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=93580
W20240204 02:38:03.799253 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
E20240204 02:38:04.042178 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=354, sample_step_cpp_seen_[rank]=353
W20240204 02:38:04.258599 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=355, pq.top=354
E20240204 02:38:04.757016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=6702
W20240204 02:38:04.928454 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
W20240204 02:38:05.564657 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240204 02:38:05.757025 54231 parallel_pq_v2.h:79] insert failed, size(hashtable)=6953
W20240204 02:38:05.934087 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end9
W20240204 02:38:06.642889 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=365, pq.top=365
E20240204 02:38:06.757011 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=66641
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 497.309 us                | 10.058 ms                 |
| ProcessBack:Shuffle       | 8.424 ms                  | 22.699 ms                 |
| ProcessBack:UpdateCache   | 10.113 ms                 | 16.264 ms                 |
| ProcessBack:UpsertPq      | 27.164 ms                 | 144.229 ms                |
| ProcessOneStep            | 101.725 ms                | 1.268 s                   |
| BlockToStepN              | 1.966 ms                  | 64.270 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:38:07.067159 53992 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end9
E20240204 02:38:07.757016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=4661
W20240204 02:38:08.163221 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
W20240204 02:38:08.477634 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=371, pq.top=371
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.739 ms                  | 120.176 ms                |
| Forward                   | 5.446 ms                  | 10.282 ms                 |
| Backward                  | 5.618 ms                  | 12.539 ms                 |
| Optimize                  | 2.621 ms                  | 8.313 ms                  |
| BarrierTimeBeforeRank0    | 4.290 ms                  | 127.612 ms                |
| AfterBackward             | 100.777 ms                | 1.268 s                   |
| BlockToStepN              | 2.086 ms                  | 64.407 ms                 |
| OneStep                   | 137.667 ms                | 1.288 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:38:08.757012 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=41519
W20240204 02:38:09.172415 53992 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
E20240204 02:38:09.757020 54217 parallel_pq_v2.h:79] insert failed, size(hashtable)=24348
W20240204 02:38:09.818884 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=379, pq.top=379
W20240204 02:38:10.255929 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240204 02:38:10.757012 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=56320
E20240204 02:38:10.777683 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=7, step_no=385, sample_step_cpp_seen_[rank]=384
W20240204 02:38:11.320729 53992 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end6
E20240204 02:38:11.757014 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=399
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 499.397 us                | 5.856 ms                  |
| ProcessBack:Shuffle       | 8.446 ms                  | 23.015 ms                 |
| ProcessBack:UpdateCache   | 10.104 ms                 | 16.646 ms                 |
| ProcessBack:UpsertPq      | 27.319 ms                 | 144.268 ms                |
| ProcessOneStep            | 101.725 ms                | 1.268 s                   |
| BlockToStepN              | 2.019 ms                  | 64.270 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:38:12.164489 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=388, pq.top=387
W20240204 02:38:12.351713 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
E20240204 02:38:12.757012 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=1893
W20240204 02:38:13.338116 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=395, pq.top=395
W20240204 02:38:13.429186 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.773 ms                  | 120.176 ms                |
| Forward                   | 5.447 ms                  | 10.282 ms                 |
| Backward                  | 5.600 ms                  | 12.539 ms                 |
| Optimize                  | 2.634 ms                  | 8.313 ms                  |
| BarrierTimeBeforeRank0    | 4.476 ms                  | 128.598 ms                |
| AfterBackward             | 100.777 ms                | 1.268 s                   |
| BlockToStepN              | 2.160 ms                  | 64.407 ms                 |
| OneStep                   | 138.021 ms                | 1.288 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:38:13.757017 54246 parallel_pq_v2.h:79] insert failed, size(hashtable)=4808
[proc 0] 400 steps, total: 20.733, sample: 1.451, forward: 0.566, backward: 0.696, update: 0.310
[proc 4] 400 steps, total: 20.733, sample: 1.194, forward: 0.602, backward: 0.615, update: 0.249
[proc 6] 400 steps, total: 20.733, sample: 1.438, forward: 0.560, backward: 0.700, update: 0.258
[proc 1] 400 steps, total: 20.733, sample: 1.197, forward: 0.562, backward: 0.655, update: 0.244
[proc 7] 400 steps, total: 20.733, sample: 1.761, forward: 0.620, backward: 0.590, update: 0.263
[proc 2] 400 steps, total: 20.733, sample: 1.110, forward: 0.555, backward: 0.597, update: 0.249
[proc 5] 400 steps, total: 20.733, sample: 1.370, forward: 0.580, backward: 0.707, update: 0.243
[proc 3] 400 steps, total: 20.733, sample: 1.576, forward: 0.584, backward: 0.679, update: 0.259
W20240204 02:38:14.430984 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240204 02:38:14.663797 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240204 02:38:14.757011 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=16
W20240204 02:38:15.670547 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240204 02:38:15.757015 54220 parallel_pq_v2.h:79] insert failed, size(hashtable)=58031
W20240204 02:38:16.199661 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=407, pq.top=407
E20240204 02:38:16.757014 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=706
W20240204 02:38:16.769995 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 522.057 us                | 12.925 ms                 |
| ProcessBack:Shuffle       | 8.437 ms                  | 23.015 ms                 |
| ProcessBack:UpdateCache   | 10.039 ms                 | 16.646 ms                 |
| ProcessBack:UpsertPq      | 27.184 ms                 | 144.268 ms                |
| ProcessOneStep            | 101.725 ms                | 1.268 s                   |
| BlockToStepN              | 2.113 ms                  | 64.270 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:38:17.239058 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=415, pq.top=415
E20240204 02:38:17.757014 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=91529
W20240204 02:38:17.793120 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 02:38:17.838572 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=420, sample_step_cpp_seen_[rank]=419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.773 ms                  | 120.176 ms                |
| Forward                   | 5.447 ms                  | 10.282 ms                 |
| Backward                  | 5.647 ms                  | 17.706 ms                 |
| Optimize                  | 2.646 ms                  | 8.313 ms                  |
| BarrierTimeBeforeRank0    | 4.732 ms                  | 128.598 ms                |
| AfterBackward             | 100.777 ms                | 1.268 s                   |
| BlockToStepN              | 2.228 ms                  | 64.407 ms                 |
| OneStep                   | 138.614 ms                | 1.288 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:38:18.757016 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=10415
W20240204 02:38:18.854545 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240204 02:38:19.065940 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=421, pq.top=421
E20240204 02:38:19.757015 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=35869
W20240204 02:38:19.982721 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end7
W20240204 02:38:20.086717 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=428, pq.top=428
E20240204 02:38:20.757009 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=409
W20240204 02:38:21.173878 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240204 02:38:21.223109 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240204 02:38:21.766871 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 607.179 us                | 20.604 ms                 |
| ProcessBack:Shuffle       | 8.437 ms                  | 22.699 ms                 |
| ProcessBack:UpdateCache   | 10.014 ms                 | 16.264 ms                 |
| ProcessBack:UpsertPq      | 26.989 ms                 | 144.229 ms                |
| ProcessOneStep            | 102.169 ms                | 1.268 s                   |
| BlockToStepN              | 2.194 ms                  | 73.252 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:38:22.331825 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end9
W20240204 02:38:22.700135 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=439, pq.top=439
E20240204 02:38:22.772176 54219 parallel_pq_v2.h:79] insert failed, size(hashtable)=1720
W20240204 02:38:23.337049 53992 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.897 ms                  | 120.176 ms                |
| Forward                   | 5.486 ms                  | 10.282 ms                 |
| Backward                  | 5.726 ms                  | 17.706 ms                 |
| Optimize                  | 2.698 ms                  | 8.651 ms                  |
| BarrierTimeBeforeRank0    | 4.513 ms                  | 128.598 ms                |
| AfterBackward             | 102.219 ms                | 1.268 s                   |
| BlockToStepN              | 2.321 ms                  | 73.388 ms                 |
| OneStep                   | 139.476 ms                | 1.288 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 02:38:23.717684 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=447, pq.top=446
E20240204 02:38:23.772013 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=887
E20240204 02:38:24.475435 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=453, sample_step_cpp_seen_[rank]=452
W20240204 02:38:24.578147 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
E20240204 02:38:24.781256 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240204 02:38:25.598299 53992 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240204 02:38:25.737370 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=455, pq.top=455
E20240204 02:38:25.781272 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=4
W20240204 02:38:26.617831 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end2
W20240204 02:38:26.740247 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=463, pq.top=463
E20240204 02:38:26.781013 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=110770
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 619.381 us                | 11.658 ms                 |
| ProcessBack:Shuffle       | 8.441 ms                  | 22.699 ms                 |
| ProcessBack:UpdateCache   | 9.990 ms                  | 16.264 ms                 |
| ProcessBack:UpsertPq      | 26.905 ms                 | 144.229 ms                |
| ProcessOneStep            | 100.298 ms                | 1.266 s                   |
| BlockToStepN              | 2.279 ms                  | 64.270 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240204 02:38:27.781011 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=6190
W20240204 02:38:27.845535 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.773 ms                  | 118.149 ms                |
| Forward                   | 5.467 ms                  | 10.005 ms                 |
| Backward                  | 5.626 ms                  | 12.539 ms                 |
| Optimize                  | 2.704 ms                  | 8.313 ms                  |
| BarrierTimeBeforeRank0    | 4.380 ms                  | 128.598 ms                |
| AfterBackward             | 100.332 ms                | 1.266 s                   |
| BlockToStepN              | 2.462 ms                  | 73.388 ms                 |
| OneStep                   | 139.291 ms                | 1.285 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:38:28.781015 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=6780
W20240204 02:38:28.858742 53992 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
W20240204 02:38:29.351545 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=474, pq.top=473
E20240204 02:38:29.781015 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=31762
W20240204 02:38:29.966094 53992 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end9
W20240204 02:38:30.535815 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=483, pq.top=483
E20240204 02:38:30.698930 51819 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=484, sample_step_cpp_seen_[rank]=483
E20240204 02:38:30.781013 49295 parallel_pq_v2.h:79] insert failed, size(hashtable)=587
W20240204 02:38:30.999367 53992 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240204 02:38:31.781013 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=3761
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 595.951 us                | 34.524 ms                 |
| ProcessBack:Shuffle       | 8.454 ms                  | 21.350 ms                 |
| ProcessBack:UpdateCache   | 9.937 ms                  | 16.156 ms                 |
| ProcessBack:UpsertPq      | 26.805 ms                 | 139.123 ms                |
| ProcessOneStep            | 100.298 ms                | 1.266 s                   |
| BlockToStepN              | 2.395 ms                  | 73.252 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 02:38:32.083460 53992 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
W20240204 02:38:32.450910 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=487, pq.top=487
E20240204 02:38:32.781009 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=50248
W20240204 02:38:33.096771 53992 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end3
W20240204 02:38:33.450104 49295 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=495, pq.top=494
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.816 ms                  | 118.149 ms                |
| Forward                   | 5.477 ms                  | 10.005 ms                 |
| Backward                  | 5.626 ms                  | 12.539 ms                 |
| Optimize                  | 2.678 ms                  | 8.313 ms                  |
| BarrierTimeBeforeRank0    | 4.371 ms                  | 129.790 ms                |
| AfterBackward             | 100.253 ms                | 1.266 s                   |
| BlockToStepN              | 2.539 ms                  | 76.340 ms                 |
| OneStep                   | 139.476 ms                | 1.285 s                   |
+---------------------------+---------------------------+---------------------------+
E20240204 02:38:33.781014 54217 parallel_pq_v2.h:79] insert failed, size(hashtable)=18958
[proc 0] 500 steps, total: 20.149, sample: 1.101, forward: 0.549, backward: 0.651, update: 0.291
[proc 7] 500 steps, total: 20.149, sample: 1.670, forward: 0.574, backward: 0.639, update: 0.244
[proc 3] 500 steps, total: 20.148, sample: 1.398, forward: 0.563, backward: 0.712, update: 0.256
Successfully xmh. training takes 106.38392210006714 seconds
[proc 6] 500 steps, total: 20.149, sample: 1.310, forward: 0.595, backward: 0.607, update: 0.231
[proc 1] 500 steps, total: 20.149, sample: 1.527, forward: 0.573, backward: 0.594, update: 0.249
[proc 2] 500 steps, total: 20.148, sample: 1.068, forward: 0.597, backward: 0.548, update: 0.239
[proc 5] 500 steps, total: 20.148, sample: 1.389, forward: 0.558, backward: 0.578, update: 0.243
before call kg_cache_controller.StopThreads()
[proc 4] 500 steps, total: 20.149, sample: 1.158, forward: 0.546, backward: 0.578, update: 0.248
W20240204 02:38:34.137771 49295 grad_async_v2.h:84] call StopThreads. PID = 19315
W20240204 02:38:34.137810 49295 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 02:38:34.138140 49295 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 02:38:34.138150 49295 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240204 02:38:34.271304 53992 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end0
E20240204 02:38:34.781015 53992 parallel_pq_v2.h:79] insert failed, size(hashtable)=1478
W20240204 02:38:35.274448 53992 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
W20240204 02:38:35.561302 49295 grad_async_v2.h:105] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 624.958 us                | 13.623 ms                 |
| ProcessBack:Shuffle       | 8.454 ms                  | 22.699 ms                 |
| ProcessBack:UpdateCache   | 9.897 ms                  | 16.156 ms                 |
| ProcessBack:UpsertPq      | 26.738 ms                 | 139.123 ms                |
| ProcessOneStep            | 100.032 ms                | 1.266 s                   |
| BlockToStepN              | 2.453 ms                  | 77.177 ms                 |
+---------------------------+---------------------------+---------------------------+
