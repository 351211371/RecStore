WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 02:20:26.406477 34848 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_130', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=5, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=5, gpu=[0, 1, 2, 3, 4], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Partitoning with metis
[02:34:40] /home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 86054151 nodes and 421063214 edges into 5 parts and get 23167104 edge cuts
WARNING [34848 sampler.py:454] Start PreSampling
WARNING [34848 sampler.py:532] Before construct renumbering_dict
WARNING [34848 sampler.py:555] PreSampling done
W20240206 02:46:01.631552 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 02:46:01.631762 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 02:46:01.631801 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 02:46:01.631831 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 02:46:01.631866 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 02:46:01.631902 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 02:46:01.631938 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 02:46:01.631978 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 02:46:01.632017 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 02:46:01.632046 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 02:46:01.632097 34848 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 02:46:01.632125 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 02:46:01.632153 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 02:46:01.632302 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 02:46:01.632361 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 02:46:01.632398 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 02:46:01.632432 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 02:46:01.632467 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 02:46:01.632498 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 02:46:01.632539 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 02:46:01.632567 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 02:46:01.632602 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 02:46:01.632627 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 02:46:01.632660 34848 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 02:46:01.632683 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 02:46:01.632712 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 02:46:01.632769 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 02:46:01.632800 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 02:46:01.632827 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 02:46:01.632862 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 02:46:01.632894 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 02:46:01.632927 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 02:46:01.632958 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 02:46:01.632994 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 02:46:01.633020 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 02:46:01.633050 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 02:46:01.633077 34848 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 02:46:01.633100 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 02:46:01.633123 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 02:46:01.633177 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 02:46:01.633210 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 02:46:01.633239 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 02:46:01.633271 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 02:46:01.633303 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 02:46:01.633342 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 02:46:01.633369 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 02:46:01.633402 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 02:46:01.633442 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 02:46:01.633484 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 02:46:01.633520 34848 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 02:46:01.633899 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 02:46:01.633929 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 02:46:01.633987 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 02:46:01.634025 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 02:46:01.634056 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 02:46:01.634089 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 02:46:01.634124 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 02:46:01.634156 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 02:46:01.634186 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 02:46:01.634214 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 02:46:01.634243 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 02:46:01.634269 34848 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 02:46:01.634299 34848 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 02:46:01.634323 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 02:46:01.634347 34848 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 02:46:02.407266 34848 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100017df6000 128.2 GB
W20240206 02:54:39.349839 34848 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102026a2e000 328.3 MB
Convert a graph into a bidirected graph: 53.108 seconds, peak memory: 265.174 GB
Construct multi-constraint weights: 0.001 seconds, peak memory: 265.174 GB
Metis partitioning: 449.293 seconds, peak memory: 276.618 GB
Split the graph: 124.911 seconds
Construct subgraphs: 20.163 seconds
MertisPartition: part 0 has 20747160 N 52627628 E
MertisPartition: part 1 has 22453096 N 82686155 E
MertisPartition: part 2 has 19237572 N 68187033 E
MertisPartition: part 3 has 19123946 N 82521325 E
MertisPartition: part 4 has 24344931 N 85060575 E
Rank0: cached key size 860541
Rank1: cached key size 860541
Rank2: cached key size 860541
Rank3: cached key size 860541
Rank4: cached key size 860541
Before renumbering graph:  {'_ID': tensor([     239,      240,      265,  ..., 86036354,  5226631, 86047326]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 4310754,  4310794,   508393,  ...,  2162205, 81346451, 75043946]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 2])}
part_g: DGLGraph(num_nodes=20747160, num_edges=52627628,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=20747160, num_edges=52627628,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2558.354 seconds
[Rank1] pid = 63476
[Rank2] pid = 63570
[Rank3] pid = 63638
INFO [34848 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [63476 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [63570 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [63638 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [63707 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [63638 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [63570 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [63707 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [34848 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [63476 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
W20240206 03:03:11.698189 63639 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240206 03:03:11.700914 63771 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240206 03:03:11.701486 63708 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240206 03:03:11.701577 63477 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240206 03:03:11.701581 63571 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240206 03:03:11.765000 63771 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10203b27f000 7.629 MB
W20240206 03:03:11.765112 63477 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10203ba22000 7.629 MB
W20240206 03:03:11.765115 63708 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10203c1c5000 7.629 MB
W20240206 03:03:11.765158 63639 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10203c968000 7.629 MB
W20240206 03:03:11.765163 63571 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10203d10b000 7.629 MB
W20240206 03:03:11.765189 63771 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10203d8ae000 7.629 MB
W20240206 03:03:11.765352 63771 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10203e051000 1.49 GB
W20240206 03:03:11.765394 63771 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10209d634000 1.49 GB
W20240206 03:03:11.765470 63771 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 03:03:11.765667 63477 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1020fcc17000 7.629 MB
W20240206 03:03:11.765686 63708 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1020fd3ba000 7.629 MB
W20240206 03:03:11.765718 63571 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1020fdb5d000 7.629 MB
W20240206 03:03:11.765749 63708 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1020fe300000 1.49 GB
W20240206 03:03:11.765770 63477 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10215d8e3000 1.49 GB
W20240206 03:03:11.765790 63571 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1021bcec6000 1.49 GB
W20240206 03:03:11.765813 63708 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x10221c4a9000 1.49 GB
W20240206 03:03:11.765838 63477 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10227ba8c000 1.49 GB
W20240206 03:03:11.765877 63571 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1022db06f000 1.49 GB
W20240206 03:03:11.767022 63571 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 03:03:11.767036 63477 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 03:03:11.767052 63708 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 03:03:11.767136 63639 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10233a652000 7.629 MB
W20240206 03:03:11.767190 63639 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x10233adf5000 1.49 GB
W20240206 03:03:11.767244 63639 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10239a3d8000 1.49 GB
W20240206 03:03:11.767287 63639 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 03:03:11.775337 63771 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 03:03:11.777369 63477 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 03:03:11.777369 63571 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 03:03:11.777397 63708 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 03:03:11.777418 63639 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
cudaHostRegister 0x100017df6000
4: KnownLocalCachedEmbedding init done
WARNING [63707 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
3: KnownLocalCachedEmbedding init done
WARNING [63638 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank4] pid = 63707
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535)]
cudaHostRegister 0x100017df6000
0: KnownLocalCachedEmbedding init done
WARNING [34848 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
2: KnownLocalCachedEmbedding init done
WARNING [63570 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
1: KnownLocalCachedEmbedding init done
WARNING [63476 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 03:03:49.654798 63571 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 5
I20240206 03:03:49.655030 63477 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240206 03:03:49.655184 63708 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240206 03:03:49.655314 63771 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240206 03:03:49.655429 63639 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
W20240206 03:03:49.658056 63771 grad_base.h:55] KGCacheController, config={
        "num_gpus": 5,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240206 03:03:49.658855 63771 grad_base.h:184] Init GradProcessingBase done
I20240206 03:04:02.130360 63771 grad_async_v2.h:42] Use main thread to update emb.
W20240206 03:04:02.130460 63771 kg_controller.h:78] after init GradAsyncProcessingV2
I20240206 03:04:02.130468 63771 kg_controller.h:84] Construct KGCacheController done
E20240206 03:04:02.702340 63571 recstore.cc:66] init folly done
E20240206 03:04:02.702405 63477 recstore.cc:66] init folly done
E20240206 03:04:02.702630 63771 recstore.cc:66] init folly done
E20240206 03:04:02.702661 63639 recstore.cc:66] init folly done
E20240206 03:04:02.702886 63708 recstore.cc:66] init folly done
I20240206 03:04:02.703980 63771 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240206 03:04:15.116676  2619 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240206 03:04:15.117089  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 03:04:16.482045  2619 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240206 03:04:16.482183  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
E20240206 03:04:17.482017  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=12
W20240206 03:04:17.508853  2619 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 133.313 us                | 299.740 us                |
+---------------------------+---------------------------+---------------------------+
W20240206 03:04:19.170396  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 03:04:19.190191  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240206 03:04:19.384634 63771 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 5
W20240206 03:04:21.614013  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
I20240206 03:04:21.660056 63571 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
E20240206 03:04:21.661046  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.078 us                | 244.888 us                |
+---------------------------+---------------------------+---------------------------+
W20240206 03:04:23.578415  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 03:04:23.602456  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240206 03:04:23.692087 63639 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240206 03:04:23.936548 63708 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
W20240206 03:04:25.030499  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240206 03:04:25.050678  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
I20240206 03:04:25.138628 63477 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
E20240206 03:04:26.914184 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240206 03:04:27.073197 63771 grad_async_v2.h:257] pq is empty
W20240206 03:04:27.076963  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240206 03:04:27.168918 63771 grad_async_v2.h:257] pq is empty
W20240206 03:04:27.279069 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=3, pq.top=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 179.510 us                | 1.614 ms                  |
| ProcessBack:Shuffle       | 3.893 ms                  | 210.013 ms                |
| ProcessBack:UpdateCache   | 5.499 ms                  | 344.546 ms                |
| ProcessBack:UpsertPq      | 51.950 ms                 | 157.547 ms                |
| ProcessOneStep            | 65.739 ms                 | 837.106 ms                |
| BlockToStepN              | 70.364 us                 | 1.698 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240206 03:04:27.914016  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 03:04:28.235378  2619 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end3
W20240206 03:04:28.311211 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=13, pq.top=13
E20240206 03:04:28.456269 63771 grad_async_v2.h:404] Stalled in ProcessBackward: rank=4, step_no=15, sample_step_cpp_seen_[rank]=14
E20240206 03:04:28.914008  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240206 03:04:29.278759  2619 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.762 ms                 | 123.594 ms                |
| Forward                   | 5.631 ms                  | 651.090 ms                |
| Backward                  | 4.283 ms                  | 185.014 ms                |
| Optimize                  | 2.276 ms                  | 4.769 ms                  |
| BarrierTimeBeforeRank0    | 31.278 us                 | 230.116 ms                |
| AfterBackward             | 63.796 ms                 | 854.763 ms                |
| BlockToStepN              | 459.996 us                | 2.859 ms                  |
| OneStep                   | 95.017 ms                 | 1.935 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 03:04:29.914314   933 parallel_pq_v2.h:79] insert failed, size(hashtable)=45
W20240206 03:04:30.285360  2619 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
W20240206 03:04:30.902393 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=27, pq.top=27
E20240206 03:04:30.914013  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=177
W20240206 03:04:31.570358  2619 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
E20240206 03:04:31.929271  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 03:04:32.574096  2619 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 304.793 us                | 3.116 ms                  |
| ProcessBack:Shuffle       | 3.949 ms                  | 170.326 ms                |
| ProcessBack:UpdateCache   | 5.187 ms                  | 344.080 ms                |
| ProcessBack:UpsertPq      | 45.846 ms                 | 95.693 ms                 |
| ProcessOneStep            | 74.012 ms                 | 854.715 ms                |
| BlockToStepN              | 86.379 us                 | 2.782 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240206 03:04:32.929010 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=23936
W20240206 03:04:33.625612  2619 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end5
W20240206 03:04:33.643149 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=45, pq.top=45
E20240206 03:04:33.929008  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=562
E20240206 03:04:34.372505 63771 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=54, sample_step_cpp_seen_[rank]=53
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.095 ms                  | 100.328 ms                |
| Forward                   | 5.424 ms                  | 18.981 ms                 |
| Backward                  | 4.880 ms                  | 8.087 ms                  |
| Optimize                  | 2.389 ms                  | 13.906 ms                 |
| BarrierTimeBeforeRank0    | 31.708 us                 | 34.190 ms                 |
| AfterBackward             | 72.699 ms                 | 837.468 ms                |
| BlockToStepN              | 208.750 us                | 2.859 ms                  |
| OneStep                   | 97.894 ms                 | 879.093 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 03:04:34.726492  2619 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end5
E20240206 03:04:34.929010  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=306
W20240206 03:04:35.034174 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240206 03:04:35.827713  2619 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
E20240206 03:04:35.929013  2956 parallel_pq_v2.h:79] insert failed, size(hashtable)=12307
W20240206 03:04:36.058210 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=66, pq.top=66
W20240206 03:04:36.913833  2619 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end2
E20240206 03:04:36.929004  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1157
W20240206 03:04:37.377902 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 321.017 us                | 7.168 ms                  |
| ProcessBack:Shuffle       | 3.905 ms                  | 26.983 ms                 |
| ProcessBack:UpdateCache   | 5.187 ms                  | 21.058 ms                 |
| ProcessBack:UpsertPq      | 43.075 ms                 | 95.693 ms                 |
| ProcessOneStep            | 70.154 ms                 | 837.106 ms                |
| BlockToStepN              | 161.437 us                | 2.782 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240206 03:04:37.929010  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1003
W20240206 03:04:38.014115  2619 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
W20240206 03:04:38.418239 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=85, pq.top=85
E20240206 03:04:38.930459  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 03:04:39.034441  2619 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end7
E20240206 03:04:39.372009 63771 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=86, sample_step_cpp_seen_[rank]=85
W20240206 03:04:39.534747 63771 grad_async_v2.h:257] pq is empty
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.680 ms                  | 100.328 ms                |
| Forward                   | 5.449 ms                  | 18.981 ms                 |
| Backward                  | 4.928 ms                  | 8.734 ms                  |
| Optimize                  | 2.414 ms                  | 13.906 ms                 |
| BarrierTimeBeforeRank0    | 34.717 us                 | 49.319 ms                 |
| AfterBackward             | 70.498 ms                 | 854.763 ms                |
| BlockToStepN              | 346.500 us                | 2.859 ms                  |
| OneStep                   | 96.160 ms                 | 1.041 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 03:04:39.930009 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=238
W20240206 03:04:40.073566  2619 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end2
W20240206 03:04:40.163609 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=93, pq.top=93
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 15.632, sample: 1.285, forward: 1.172, backward: 0.718, update: 0.224
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 16.834, sample: 1.219, forward: 1.075, backward: 0.703, update: 0.225
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 19.111, sample: 1.070, forward: 1.201, backward: 0.935, update: 0.237
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 17.079, sample: 1.316, forward: 1.183, backward: 0.742, update: 0.208
train_sampler.Prefill()
-------Step 0-------
tensor([ 4313839,   284881,   717286,   284916,   284944,   284977,   717310,
          285018, 29743195,   717350]) tensor([ 7015751, 16769565,   648205, 76171186,   742779, 34067784, 65373345,
        32190409, 59501763, 68380516])
-------Step 1-------
tensor([ 4313839,   284881,   717286,   284916,   284944,   284977,   717310,
          285018, 29743195,   717350]) tensor([74065926, 62780777, 18023890, 50215514, 45513318,   182697, 35171850,
        72933966,  5869563, 36081876])
-------Step 2-------
tensor([  372936,   372987,   373025,   373054, 15620314, 71458272,   373083,
          373118,   373152,   373183]) tensor([50846741, 20221436, 11296640,  4324392, 43838553, 50416568, 59070536,
        71115746, 16906094, 72959166])
-------Step 3-------
tensor([  372936,   372987,   373025,   373054, 15620314, 71458272,   373083,
          373118,   373152,   373183]) tensor([ 9591487, 11174758, 57729409, 76722986, 23799671, 79306434, 22088266,
           23804, 59900827, 40611041])
-------Step 4-------
tensor([20306088,   459374,   459408,   459445,   459482,   459511,   459543,
          259546,   459572,   459610]) tensor([40184715, 38233188, 66107708, 18012114, 64045212, 56236364, 79311949,
        72730951, 57311134, 85244217])
-------Step 5-------
tensor([20306088,   459374,   459408,   459445,   459482,   459511,   459543,
          259546,   459572,   459610]) tensor([57064887, 45104814, 14832132, 52552714, 15989914, 28799587, 46845679,
        81760137, 80199332, 10020900])
-------Step 6-------
tensor([  546976, 13133804,   546998,   547041,   547061,   742110,   547093,
          742163,   547130,   547169]) tensor([12425570, 20077529, 73307392,   117494,  9413406, 31476463, 72301255,
        55119516, 75232522, 60215701])
-------Step 7-------
tensor([  546976, 13133804,   546998,   547041,   547061,   742110,   547093,
          742163,   547130,   547169]) tensor([ 3954227, 22750815, 70157367, 35313131, 21129421, 60864248, 28969577,
        30666471,  9801702,  6675124])
-------Step 8-------
tensor([ 4824510,   632590,  4313839,   632627,   632652,   632690,   632732,
          632765,   632799, 66366150]) tensor([15314118, 55140211, 72401757, 40361273, 54225770,  1596640, 59229000,
          345059, 56522529, 47235027])
-------Step 9-------
tensor([ 4824510,   632590,  4313839,   632627,   632652,   632690,   632732,
          632765,   632799, 66366150]) tensor([57209882, 66220438, 38964962, 84135736, 17545003, 47830581, 33861684,
        77101267, 78919767,   179636])
before start barrier
start train
[proc 0] 100 steps, total: 21.386, sample: 1.397, forward: 1.215, backward: 0.672, update: 0.301
E20240206 03:04:40.930011  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=256
W20240206 03:04:41.349555 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240206 03:04:41.364130  2619 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
E20240206 03:04:41.930019  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=263
W20240206 03:04:42.154989 63771 grad_async_v2.h:257] pq is empty
W20240206 03:04:42.417940  2619 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 294.586 us                | 3.672 ms                  |
| ProcessBack:Shuffle       | 3.863 ms                  | 26.983 ms                 |
| ProcessBack:UpdateCache   | 5.163 ms                  | 21.058 ms                 |
| ProcessBack:UpsertPq      | 44.982 ms                 | 101.839 ms                |
| ProcessOneStep            | 70.453 ms                 | 854.715 ms                |
| BlockToStepN              | 229.841 us                | 13.828 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 03:04:42.930011 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240206 03:04:43.238658 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240206 03:04:43.437959  2619 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end9
E20240206 03:04:43.930011 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=47
W20240206 03:04:44.275015 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=130, pq.top=130
E20240206 03:04:44.385520   933 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=131, sample_step_cpp_seen_[rank]=130
W20240206 03:04:44.440866  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.122 ms                  | 113.631 ms                |
| Forward                   | 5.333 ms                  | 18.981 ms                 |
| Backward                  | 4.951 ms                  | 8.734 ms                  |
| Optimize                  | 2.382 ms                  | 13.906 ms                 |
| BarrierTimeBeforeRank0    | 53.814 us                 | 49.319 ms                 |
| AfterBackward             | 68.496 ms                 | 854.763 ms                |
| BlockToStepN              | 346.500 us                | 13.901 ms                 |
| OneStep                   | 94.330 ms                 | 1.041 s                   |
+---------------------------+---------------------------+---------------------------+
E20240206 03:04:44.930009  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=686
W20240206 03:04:45.298846 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240206 03:04:45.440299  2619 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
E20240206 03:04:45.930008 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=663
W20240206 03:04:46.342577 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240206 03:04:46.567260  2619 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end6
E20240206 03:04:46.930011 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=6
W20240206 03:04:47.578954  2619 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 307.254 us                | 2.856 ms                  |
| ProcessBack:Shuffle       | 3.862 ms                  | 11.051 ms                 |
| ProcessBack:UpdateCache   | 5.109 ms                  | 7.599 ms                  |
| ProcessBack:UpsertPq      | 43.075 ms                 | 100.369 ms                |
| ProcessOneStep            | 67.766 ms                 | 854.715 ms                |
| BlockToStepN              | 304.712 us                | 15.390 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 03:04:47.848934 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=151, pq.top=151
E20240206 03:04:47.930007   933 parallel_pq_v2.h:79] insert failed, size(hashtable)=1215
W20240206 03:04:48.680312  2619 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end1
W20240206 03:04:48.919174 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=163, pq.top=163
E20240206 03:04:48.930008  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=44558
E20240206 03:04:49.482334   933 grad_async_v2.h:404] Stalled in ProcessBackward: rank=3, step_no=169, sample_step_cpp_seen_[rank]=168
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.955 ms                  | 100.328 ms                |
| Forward                   | 5.385 ms                  | 15.599 ms                 |
| Backward                  | 4.936 ms                  | 8.087 ms                  |
| Optimize                  | 2.428 ms                  | 12.578 ms                 |
| BarrierTimeBeforeRank0    | 173.118 us                | 49.108 ms                 |
| AfterBackward             | 65.875 ms                 | 837.468 ms                |
| BlockToStepN              | 509.496 us                | 15.470 ms                 |
| OneStep                   | 95.509 ms                 | 879.093 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 03:04:49.681185  2619 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end0
E20240206 03:04:49.930007  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=612
W20240206 03:04:50.429586 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240206 03:04:50.806432  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240206 03:04:50.930035  2958 parallel_pq_v2.h:79] insert failed, size(hashtable)=6120
W20240206 03:04:51.448642 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240206 03:04:51.882658  2619 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240206 03:04:51.935134  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 312.300 us                | 9.186 ms                  |
| ProcessBack:Shuffle       | 3.879 ms                  | 10.699 ms                 |
| ProcessBack:UpdateCache   | 5.097 ms                  | 7.483 ms                  |
| ProcessBack:UpsertPq      | 41.333 ms                 | 95.693 ms                 |
| ProcessOneStep            | 65.144 ms                 | 854.715 ms                |
| BlockToStepN              | 470.785 us                | 15.390 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 03:04:52.811364 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=193, pq.top=193
E20240206 03:04:52.935011 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=118
W20240206 03:04:53.133064  2619 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end7
E20240206 03:04:53.935026  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=3603
W20240206 03:04:54.099457 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=199, pq.top=199
W20240206 03:04:54.161473  2619 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end0
[proc 2] 200 steps, total: 13.422, sample: 1.160, forward: 0.504, backward: 0.600, update: 0.221
[proc 3] 200 steps, total: 13.422, sample: 1.070, forward: 0.512, backward: 0.573, update: 0.209
[proc 0] 200 steps, total: 13.421, sample: 1.328, forward: 0.532, backward: 0.506, update: 0.269
[proc 1] 200 steps, total: 13.422, sample: 1.120, forward: 0.522, backward: 0.632, update: 0.231
[proc 4] 200 steps, total: 13.422, sample: 1.299, forward: 0.461, backward: 0.469, update: 0.216
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.551 ms                  | 100.328 ms                |
| Forward                   | 5.408 ms                  | 15.599 ms                 |
| Backward                  | 5.015 ms                  | 8.734 ms                  |
| Optimize                  | 2.459 ms                  | 12.578 ms                 |
| BarrierTimeBeforeRank0    | 265.317 us                | 49.108 ms                 |
| AfterBackward             | 64.852 ms                 | 854.763 ms                |
| BlockToStepN              | 592.507 us                | 26.331 ms                 |
| OneStep                   | 92.459 ms                 | 879.093 ms                |
+---------------------------+---------------------------+---------------------------+
E20240206 03:04:54.935011  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=995
E20240206 03:04:55.076386 63771 grad_async_v2.h:404] Stalled in ProcessBackward: rank=2, step_no=211, sample_step_cpp_seen_[rank]=210
W20240206 03:04:55.356572  2619 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
W20240206 03:04:55.767417 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=213, pq.top=213
E20240206 03:04:55.935009  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=154
W20240206 03:04:56.478014  2619 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end1
W20240206 03:04:56.847551 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=225, pq.top=225
E20240206 03:04:56.935009 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=4971
W20240206 03:04:57.591140  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 347.040 us                | 6.669 ms                  |
| ProcessBack:Shuffle       | 3.874 ms                  | 10.362 ms                 |
| ProcessBack:UpdateCache   | 5.066 ms                  | 6.406 ms                  |
| ProcessBack:UpsertPq      | 36.390 ms                 | 89.866 ms                 |
| ProcessOneStep            | 64.825 ms                 | 854.715 ms                |
| BlockToStepN              | 787.011 us                | 32.264 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 03:04:57.935011  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=6419
W20240206 03:04:58.118469 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=229, pq.top=229
W20240206 03:04:58.602469  2619 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end4
E20240206 03:04:58.935019 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=91
W20240206 03:04:59.182536 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=241, pq.top=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.329 ms                  | 100.328 ms                |
| Forward                   | 5.385 ms                  | 15.599 ms                 |
| Backward                  | 5.001 ms                  | 8.734 ms                  |
| Optimize                  | 2.414 ms                  | 12.578 ms                 |
| BarrierTimeBeforeRank0    | 309.583 us                | 49.108 ms                 |
| AfterBackward             | 64.198 ms                 | 856.998 ms                |
| BlockToStepN              | 869.054 us                | 37.109 ms                 |
| OneStep                   | 92.050 ms                 | 1.015 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 03:04:59.771173  2619 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
E20240206 03:04:59.935014  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=4775
W20240206 03:05:00.220619 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240206 03:05:00.840580  2619 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
E20240206 03:05:00.935009  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=49486
W20240206 03:05:01.220322 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=256, pq.top=255
E20240206 03:05:01.632522   933 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=261, sample_step_cpp_seen_[rank]=260
W20240206 03:05:01.930243  2619 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end3
E20240206 03:05:01.935030  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=2
W20240206 03:05:02.336436 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=267, pq.top=266
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 429.845 us                | 15.087 ms                 |
| ProcessBack:Shuffle       | 3.880 ms                  | 15.231 ms                 |
| ProcessBack:UpdateCache   | 5.079 ms                  | 6.406 ms                  |
| ProcessBack:UpsertPq      | 30.158 ms                 | 95.693 ms                 |
| ProcessOneStep            | 63.759 ms                 | 854.715 ms                |
| BlockToStepN              | 816.277 us                | 32.264 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 03:05:02.935014  2955 parallel_pq_v2.h:79] insert failed, size(hashtable)=15557
W20240206 03:05:03.129776  2619 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end4
W20240206 03:05:03.503985 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=275, pq.top=275
E20240206 03:05:03.935014 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=845
W20240206 03:05:04.138896  2619 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end1
W20240206 03:05:04.514714 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.132 ms                  | 99.686 ms                 |
| Forward                   | 5.385 ms                  | 11.818 ms                 |
| Backward                  | 5.074 ms                  | 9.749 ms                  |
| Optimize                  | 2.377 ms                  | 8.168 ms                  |
| BarrierTimeBeforeRank0    | 369.132 us                | 49.319 ms                 |
| AfterBackward             | 62.857 ms                 | 854.763 ms                |
| BlockToStepN              | 938.549 us                | 37.109 ms                 |
| OneStep                   | 92.431 ms                 | 879.093 ms                |
+---------------------------+---------------------------+---------------------------+
E20240206 03:05:04.935011  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=42353
W20240206 03:05:05.283078  2619 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end4
W20240206 03:05:05.732702 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=295, pq.top=294
E20240206 03:05:05.935009 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=894
[proc 3] 300 steps, total: 12.026, sample: 1.173, forward: 0.598, backward: 0.578, update: 0.216
[proc 0] 300 steps, total: 12.026, sample: 0.951, forward: 0.530, backward: 0.596, update: 0.268
[proc 2] 300 steps, total: 12.026, sample: 0.997, forward: 0.516, backward: 0.575, update: 0.230
[proc 4] 300 steps, total: 12.026, sample: 1.241, forward: 0.521, backward: 0.574, update: 0.235
[proc 1] 300 steps, total: 12.026, sample: 0.946, forward: 0.517, backward: 0.568, update: 0.223
W20240206 03:05:06.309247  2619 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end1
W20240206 03:05:06.879519 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=307, pq.top=307
E20240206 03:05:06.935009  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=7117
E20240206 03:05:07.286571   933 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=311, sample_step_cpp_seen_[rank]=310
W20240206 03:05:07.421510  2619 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 358.575 us                | 17.272 ms                 |
| ProcessBack:Shuffle       | 3.898 ms                  | 15.224 ms                 |
| ProcessBack:UpdateCache   | 5.089 ms                  | 6.377 ms                  |
| ProcessBack:UpsertPq      | 30.158 ms                 | 89.866 ms                 |
| ProcessOneStep            | 62.787 ms                 | 854.715 ms                |
| BlockToStepN              | 944.605 us                | 36.984 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 03:05:07.935009 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=968
W20240206 03:05:07.961759 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=313, pq.top=313
W20240206 03:05:08.479743  2619 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end0
E20240206 03:05:08.935010  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=142
W20240206 03:05:08.999262 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=326, pq.top=326
W20240206 03:05:09.560421  2619 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.056 ms                  | 99.686 ms                 |
| Forward                   | 5.392 ms                  | 11.818 ms                 |
| Backward                  | 5.043 ms                  | 9.964 ms                  |
| Optimize                  | 2.377 ms                  | 9.271 ms                  |
| BarrierTimeBeforeRank0    | 432.586 us                | 57.994 ms                 |
| AfterBackward             | 62.833 ms                 | 854.763 ms                |
| BlockToStepN              | 1.072 ms                  | 37.109 ms                 |
| OneStep                   | 92.431 ms                 | 879.093 ms                |
+---------------------------+---------------------------+---------------------------+
E20240206 03:05:09.935009  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=45144
W20240206 03:05:10.137001 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240206 03:05:10.577908  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end6
E20240206 03:05:10.935009 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=541
W20240206 03:05:11.253945 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=343, pq.top=343
W20240206 03:05:11.671983  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end7
E20240206 03:05:11.935010  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=10751
W20240206 03:05:12.345469 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=351, pq.top=351
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 412.688 us                | 21.475 ms                 |
| ProcessBack:Shuffle       | 3.905 ms                  | 15.224 ms                 |
| ProcessBack:UpdateCache   | 5.089 ms                  | 6.377 ms                  |
| ProcessBack:UpsertPq      | 27.976 ms                 | 89.697 ms                 |
| ProcessOneStep            | 61.356 ms                 | 837.106 ms                |
| BlockToStepN              | 1.160 ms                  | 36.984 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 03:05:12.817034  2619 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240206 03:05:12.935014 63771 parallel_pq_v2.h:79] insert failed, size(hashtable)=219
E20240206 03:05:13.341451 63771 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=362, sample_step_cpp_seen_[rank]=361
W20240206 03:05:13.848145  2619 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end3
E20240206 03:05:13.935009  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=6430
W20240206 03:05:14.029420 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=363, pq.top=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.926 ms                  | 96.814 ms                 |
| Forward                   | 5.385 ms                  | 10.365 ms                 |
| Backward                  | 5.052 ms                  | 9.888 ms                  |
| Optimize                  | 2.363 ms                  | 8.168 ms                  |
| BarrierTimeBeforeRank0    | 1.054 ms                  | 57.994 ms                 |
| AfterBackward             | 62.326 ms                 | 837.468 ms                |
| BlockToStepN              | 1.346 ms                  | 40.956 ms                 |
| OneStep                   | 92.377 ms                 | 873.767 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 03:05:14.905337  2619 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end2
E20240206 03:05:14.935007  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=52857
W20240206 03:05:15.029060 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=373, pq.top=372
E20240206 03:05:15.935011  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1918
W20240206 03:05:16.012490  2619 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
W20240206 03:05:16.625078 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=382, pq.top=382
E20240206 03:05:16.935011  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=84158
W20240206 03:05:17.046701  2619 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 407.486 us                | 14.853 ms                 |
| ProcessBack:Shuffle       | 3.913 ms                  | 11.051 ms                 |
| ProcessBack:UpdateCache   | 5.118 ms                  | 6.377 ms                  |
| ProcessBack:UpsertPq      | 26.640 ms                 | 89.697 ms                 |
| ProcessOneStep            | 62.289 ms                 | 837.106 ms                |
| BlockToStepN              | 1.411 ms                  | 51.372 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 03:05:17.729501 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=395, pq.top=395
E20240206 03:05:17.949802  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
W20240206 03:05:18.105479  2619 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end7
E20240206 03:05:18.341009 63771 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=396, sample_step_cpp_seen_[rank]=395
E20240206 03:05:18.949018  2962 parallel_pq_v2.h:79] insert failed, size(hashtable)=32748
W20240206 03:05:18.951897 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=397, pq.top=397
W20240206 03:05:19.153290  2619 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end0
[proc 0] 400 steps, total: 12.971, sample: 0.943, forward: 0.532, backward: 0.507, update: 0.234
[proc 3] 400 steps, total: 12.971, sample: 1.031, forward: 0.507, backward: 0.517, update: 0.213
[proc 4] 400 steps, total: 12.971, sample: 1.026, forward: 0.509, backward: 0.608, update: 0.212
[proc 2] 400 steps, total: 12.971, sample: 0.942, forward: 0.527, backward: 0.545, update: 0.231
[proc 1] 400 steps, total: 12.971, sample: 0.988, forward: 0.519, backward: 0.581, update: 0.221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.898 ms                  | 96.814 ms                 |
| Forward                   | 5.374 ms                  | 10.365 ms                 |
| Backward                  | 5.046 ms                  | 9.964 ms                  |
| Optimize                  | 2.337 ms                  | 8.168 ms                  |
| BarrierTimeBeforeRank0    | 1.024 ms                  | 57.994 ms                 |
| AfterBackward             | 62.326 ms                 | 854.763 ms                |
| BlockToStepN              | 1.491 ms                  | 51.507 ms                 |
| OneStep                   | 92.050 ms                 | 879.093 ms                |
+---------------------------+---------------------------+---------------------------+
E20240206 03:05:19.949013  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=7339
W20240206 03:05:20.003196 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240206 03:05:20.205473  2619 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end1
E20240206 03:05:20.949831  2981 parallel_pq_v2.h:79] insert failed, size(hashtable)=4095
W20240206 03:05:21.053438 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=413, pq.top=413
W20240206 03:05:21.369406  2619 grad_async_v2.h:137] Detect new sample comes, old_end2, new_end7
E20240206 03:05:21.949012  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=60601
W20240206 03:05:22.376399  2619 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 387.243 us                | 17.188 ms                 |
| ProcessBack:Shuffle       | 3.919 ms                  | 12.713 ms                 |
| ProcessBack:UpdateCache   | 5.131 ms                  | 6.377 ms                  |
| ProcessBack:UpsertPq      | 26.640 ms                 | 89.866 ms                 |
| ProcessOneStep            | 62.412 ms                 | 854.715 ms                |
| BlockToStepN              | 1.416 ms                  | 51.372 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 03:05:22.949013  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=650
W20240206 03:05:23.397485  2619 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end8
W20240206 03:05:23.663365 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=431, pq.top=431
E20240206 03:05:23.949015  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=230
W20240206 03:05:24.418221  2619 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end8
E20240206 03:05:24.543849 63771 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=438, sample_step_cpp_seen_[rank]=437
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.874 ms                  | 96.814 ms                 |
| Forward                   | 5.394 ms                  | 10.365 ms                 |
| Backward                  | 5.030 ms                  | 10.323 ms                 |
| Optimize                  | 2.351 ms                  | 8.168 ms                  |
| BarrierTimeBeforeRank0    | 1.082 ms                  | 57.994 ms                 |
| AfterBackward             | 62.566 ms                 | 856.998 ms                |
| BlockToStepN              | 1.542 ms                  | 54.431 ms                 |
| OneStep                   | 92.634 ms                 | 927.121 ms                |
+---------------------------+---------------------------+---------------------------+
E20240206 03:05:24.949013  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=4388
W20240206 03:05:25.235488 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=439, pq.top=438
W20240206 03:05:25.427810  2619 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
E20240206 03:05:25.949018  2984 parallel_pq_v2.h:79] insert failed, size(hashtable)=127968
W20240206 03:05:26.245164 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=451, pq.top=451
W20240206 03:05:26.475739  2619 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end2
E20240206 03:05:26.949018  2967 parallel_pq_v2.h:79] insert failed, size(hashtable)=1292
W20240206 03:05:27.488880  2619 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end6
W20240206 03:05:27.648845 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=458, pq.top=458
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 403.666 us                | 15.405 ms                 |
| ProcessBack:Shuffle       | 3.927 ms                  | 11.477 ms                 |
| ProcessBack:UpdateCache   | 5.118 ms                  | 6.377 ms                  |
| ProcessBack:UpsertPq      | 25.753 ms                 | 89.697 ms                 |
| ProcessOneStep            | 62.512 ms                 | 854.715 ms                |
| BlockToStepN              | 1.517 ms                  | 55.452 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240206 03:05:27.949012  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=70186
W20240206 03:05:28.618119  2619 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end8
E20240206 03:05:28.949018  2964 parallel_pq_v2.h:79] insert failed, size(hashtable)=6741
W20240206 03:05:29.126655 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=468, pq.top=468
W20240206 03:05:29.627929  2619 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 3.927 ms                  | 97.481 ms                 |
| Forward                   | 5.394 ms                  | 8.760 ms                  |
| Backward                  | 5.040 ms                  | 9.964 ms                  |
| Optimize                  | 2.348 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 990.434 us                | 57.994 ms                 |
| AfterBackward             | 62.566 ms                 | 854.763 ms                |
| BlockToStepN              | 1.706 ms                  | 55.585 ms                 |
| OneStep                   | 93.307 ms                 | 879.981 ms                |
+---------------------------+---------------------------+---------------------------+
E20240206 03:05:29.950464  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=63985
W20240206 03:05:30.142844 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=477, pq.top=477
W20240206 03:05:30.686815  2619 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end4
E20240206 03:05:30.950034  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=3557
W20240206 03:05:31.179193 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=488, pq.top=488
E20240206 03:05:31.210916   933 grad_async_v2.h:404] Stalled in ProcessBackward: rank=0, step_no=488, sample_step_cpp_seen_[rank]=487
W20240206 03:05:31.782056  2619 grad_async_v2.h:137] Detect new sample comes, old_end6, new_end5
E20240206 03:05:31.950013  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=15857
W20240206 03:05:32.214936 63771 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=499, pq.top=499
[proc 2] 500 steps, total: 13.228, sample: 0.923, forward: 0.512, backward: 0.548, update: 0.228
[proc 3] 500 steps, total: 13.228, sample: 1.179, forward: 0.528, backward: 0.550, update: 0.219
[proc 1] 500 steps, total: 13.228, sample: 1.006, forward: 0.524, backward: 0.521, update: 0.227
[proc 4] 500 steps, total: 13.228, sample: 1.166, forward: 0.443, backward: 0.539, update: 0.209
[proc 0] 500 steps, total: 13.228, sample: 1.253, forward: 0.528, backward: 0.542, update: 0.233
Successfully xmh. training takes 73.03373193740845 seconds
before call kg_cache_controller.StopThreads()
W20240206 03:05:32.418362 63771 grad_async_v2.h:84] call StopThreads. PID = 34848
W20240206 03:05:32.418396 63771 grad_base.h:212] before processOneStepNegThread_.join();
W20240206 03:05:32.418838 63771 grad_base.h:214] after processOneStepNegThread_.join();
W20240206 03:05:32.418848 63771 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 471.636 us                | 25.221 ms                 |
| ProcessBack:Shuffle       | 3.915 ms                  | 11.071 ms                 |
| ProcessBack:UpdateCache   | 5.082 ms                  | 6.631 ms                  |
| ProcessBack:UpsertPq      | 25.108 ms                 | 89.400 ms                 |
| ProcessOneStep            | 62.106 ms                 | 854.715 ms                |
| BlockToStepN              | 1.752 ms                  | 81.638 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240206 03:05:32.890340  2619 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end0
E20240206 03:05:32.950014  2619 parallel_pq_v2.h:79] insert failed, size(hashtable)=5437
W20240206 03:05:33.067628 63771 grad_async_v2.h:105] StopThreads done.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.014 ms                  | 97.481 ms                 |
| Forward                   | 5.374 ms                  | 8.760 ms                  |
| Backward                  | 5.040 ms                  | 9.964 ms                  |
| Optimize                  | 2.332 ms                  | 7.379 ms                  |
| BarrierTimeBeforeRank0    | 693.557 us                | 59.359 ms                 |
| AfterBackward             | 62.162 ms                 | 854.763 ms                |
| BlockToStepN              | 1.862 ms                  | 81.762 ms                 |
| OneStep                   | 93.307 ms                 | 879.981 ms                |
+---------------------------+---------------------------+---------------------------+
