WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 14:17:18.704473 56086 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_67', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [56086 sampler.py:454] Start PreSampling
WARNING [56086 sampler.py:532] Before construct renumbering_dict
WARNING [56086 sampler.py:555] PreSampling done
W20240202 14:17:24.061033 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 14:17:24.061196 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 14:17:24.061244 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 14:17:24.061287 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 14:17:24.061329 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 14:17:24.061374 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 14:17:24.061409 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 14:17:24.061471 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 14:17:24.061509 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 14:17:24.061542 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 14:17:24.061584 56086 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 14:17:24.061616 56086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 14:17:24.061657 56086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 14:17:24.061815 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 14:17:24.061867 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 14:17:24.061908 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 14:17:24.061960 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 14:17:24.062001 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 14:17:24.062044 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 14:17:24.062091 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 14:17:24.062127 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 14:17:24.062175 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 14:17:24.062214 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 14:17:24.062255 56086 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 14:17:24.062284 56086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 14:17:24.062314 56086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 14:17:24.062377 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 14:17:24.062417 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 14:17:24.062461 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 14:17:24.062500 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 14:17:24.062532 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 14:17:24.062569 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 14:17:24.062615 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 14:17:24.062649 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 14:17:24.062685 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 14:17:24.062717 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 14:17:24.062749 56086 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 14:17:24.062778 56086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 14:17:24.062813 56086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 14:17:24.062880 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 14:17:24.062922 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 14:17:24.062963 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 14:17:24.062995 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 14:17:24.063037 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 14:17:24.063077 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 14:17:24.063113 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 14:17:24.063146 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 14:17:24.063187 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 14:17:24.063221 56086 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 14:17:24.063263 56086 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 14:17:24.063293 56086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 14:17:24.063329 56086 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 14:17:24.343851 56086 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240202 14:17:24.437515 56086 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=9703, num_edges=161860,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=11374, num_edges=168961,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=10715, num_edges=190828,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=11184, num_edges=240046,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 9703 N 161860 E
MertisPartition: part 1 has 11374 N 168961 E
MertisPartition: part 2 has 10715 N 190828 E
MertisPartition: part 3 has 11184 N 240046 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([   6,   10,   11,  ..., 5824, 6189, 2559]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
After renumbering graph:  {'_ID': tensor([1627, 1726, 1747,  ..., 8727, 5282, 8014]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 2])}
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=9703, num_edges=161860,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.838 seconds
[Rank1] pid = 56511
[Rank2] pid = 56540
INFO [56086 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [56086 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [56540 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [56511 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [56639 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [56540 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [56511 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [56639 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240202 14:17:26.440472 56640 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
W20240202 14:17:26.444243 56703 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240202 14:17:26.444242 56576 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240202 14:17:26.444247 56512 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240202 14:17:26.476495 56703 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10001487c000 7.629 MB
W20240202 14:17:26.476558 56640 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10001501f000 7.629 MB
W20240202 14:17:26.476572 56512 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000157c2000 7.629 MB
W20240202 14:17:26.476588 56576 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100015f65000 7.629 MB
W20240202 14:17:26.476753 56703 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100016708000 7.629 MB
W20240202 14:17:26.476814 56703 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100016eab000 1.49 GB
W20240202 14:17:26.476871 56703 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10007648e000 1.49 GB
W20240202 14:17:26.476923 56703 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:17:26.477007 56512 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000d5a71000 7.629 MB
W20240202 14:17:26.477036 56640 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000d6214000 7.629 MB
W20240202 14:17:26.477095 56512 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1000d69b7000 1.49 GB
W20240202 14:17:26.477113 56640 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x100135f9a000 1.49 GB
W20240202 14:17:26.477165 56512 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10019557d000 1.49 GB
W20240202 14:17:26.477167 56640 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1001f4b60000 1.49 GB
W20240202 14:17:26.478665 56576 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100254143000 7.629 MB
W20240202 14:17:26.478734 56576 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x1002548e6000 1.49 GB
W20240202 14:17:26.478806 56576 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1002b3ecb000 1.49 GB
W20240202 14:17:26.478816 56640 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 14:17:26.478847 56512 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 14:17:26.478853 56576 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 14:17:26.478927 56703 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:17:26.485558 56640 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 14:17:26.485599 56512 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 14:17:26.485613 56576 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [56639 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [56511 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [56540 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank3] pid = 56639
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [56086 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 14:17:29.071128 56640 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240202 14:17:29.071584 56512 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240202 14:17:29.072247 56703 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240202 14:17:29.072335 56576 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240202 14:17:29.074743 56640 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240202 14:17:29.074920 56640 grad_base.h:184] Init GradProcessingBase done
I20240202 14:17:29.077399 56640 grad_async_v1.h:203] Use main thread to update emb.
W20240202 14:17:29.077432 56640 kg_controller.h:75] after init GradAsyncProcessing
I20240202 14:17:29.077440 56640 kg_controller.h:84] Construct KGCacheController done
E20240202 14:17:29.553155 56703 recstore.cc:66] init folly done
E20240202 14:17:29.553233 56512 recstore.cc:66] init folly done
E20240202 14:17:29.553284 56640 recstore.cc:66] init folly done
E20240202 14:17:29.553287 56576 recstore.cc:66] init folly done
I20240202 14:17:29.554255 56640 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240202 14:17:29.961800 56640 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240202 14:17:29.970523 56576 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240202 14:17:29.974151 56703 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240202 14:17:29.982700 56512 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240202 14:17:31.409477 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240202 14:17:31.497895 57268 grad_async_v1.h:533] Stalled in ProcessBackward: rank=2, step_no=1, sample_step_cpp_seen_[rank]=0
W20240202 14:17:32.424839 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=20, pq.top=20
W20240202 14:17:33.424016 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.237 ms                  | 19.358 ms                 |
| Forward                   | 4.475 ms                  | 581.686 ms                |
| Backward                  | 9.843 ms                  | 238.180 ms                |
| Optimize                  | 1.694 ms                  | 4.388 ms                  |
| BarrierTimeBeforeRank0    | 32.121 us                 | 4.382 ms                  |
| AfterBackward             | 11.836 ms                 | 600.491 ms                |
| BlockToStepN              | 43.577 ms                 | 110.248 ms                |
| OneStep                   | 75.554 ms                 | 1.485 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:34.424013 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=38, pq.top=38
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.337 ms                  | 135.297 ms                |
| ProcessBack:UpdateCache   | 2.571 ms                  | 313.530 ms                |
| ProcessBack:UpsertPq      | 5.792 ms                  | 10.866 ms                 |
| ProcessOneStep            | 11.704 ms                 | 600.021 ms                |
| BlockToStepN              | 43.497 ms                 | 110.212 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:35.424019 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=44, pq.top=44
W20240202 14:17:36.441057 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=50, pq.top=50
W20240202 14:17:37.441005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
W20240202 14:17:38.441017 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=60, pq.top=60
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.371 ms                  | 19.327 ms                 |
| Forward                   | 4.461 ms                  | 8.707 ms                  |
| Backward                  | 9.172 ms                  | 19.946 ms                 |
| Optimize                  | 1.641 ms                  | 4.333 ms                  |
| BarrierTimeBeforeRank0    | 35.799 us                 | 4.382 ms                  |
| AfterBackward             | 11.746 ms                 | 26.581 ms                 |
| BlockToStepN              | 92.125 ms                 | 189.058 ms                |
| OneStep                   | 133.041 ms                | 223.090 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:39.441015 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.331 ms                  | 135.297 ms                |
| ProcessBack:UpdateCache   | 2.565 ms                  | 313.530 ms                |
| ProcessBack:UpsertPq      | 5.871 ms                  | 10.866 ms                 |
| ProcessOneStep            | 11.718 ms                 | 26.546 ms                 |
| BlockToStepN              | 96.386 ms                 | 188.999 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:40.452186 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=70, pq.top=70
W20240202 14:17:41.452013 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=74, pq.top=74
W20240202 14:17:42.452008 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240202 14:17:43.452005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.369 ms                  | 19.327 ms                 |
| Forward                   | 4.475 ms                  | 8.707 ms                  |
| Backward                  | 9.098 ms                  | 19.946 ms                 |
| Optimize                  | 1.630 ms                  | 4.333 ms                  |
| BarrierTimeBeforeRank0    | 32.121 us                 | 4.382 ms                  |
| AfterBackward             | 12.054 ms                 | 26.581 ms                 |
| BlockToStepN              | 140.386 ms                | 222.178 ms                |
| OneStep                   | 171.906 ms                | 260.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:44.452015 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.343 ms                  | 5.815 ms                  |
| ProcessBack:UpdateCache   | 2.565 ms                  | 4.467 ms                  |
| ProcessBack:UpsertPq      | 5.974 ms                  | 10.590 ms                 |
| ProcessOneStep            | 12.033 ms                 | 26.546 ms                 |
| BlockToStepN              | 141.775 ms                | 223.023 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:45.452005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=92, pq.top=92
W20240202 14:17:46.452013 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=96, pq.top=96
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 17.385, sample: 0.296, forward: 0.945, backward: 0.884, update: 0.163
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 17.373, sample: 0.277, forward: 0.918, backward: 1.045, update: 0.155
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 17.382, sample: 0.310, forward: 0.992, backward: 1.016, update: 0.179
train_sampler.Prefill()
-------Step 0-------
tensor([ 7090,  9039, 13781,  4914,    78,  6213, 10431,   318,   229, 11862]) tensor([ 1747,  9174,  2948, 13957,  2964,   290,  3692,  5964,  4170, 12075])
-------Step 1-------
tensor([ 7090,  9039, 13781,  4914,    78,  6213, 10431,   318,   229, 11862]) tensor([ 3928,  8312,   180,  9020,   501, 12659,  7823,  2966,  5295, 11047])
-------Step 2-------
tensor([13948, 10171,  9791,  4460,   266,  3631,   162,  8959,  4028,   217]) tensor([ 9904,  2745,  7664,  9038,  6989,   105, 14512,   888,  9865, 13196])
-------Step 3-------
tensor([13948, 10171,  9791,  4460,   266,  3631,   162,  8959,  4028,   217]) tensor([11346,  2350, 14788,  3564,  9531,  3961, 13137,  4641,  6147, 10065])
-------Step 4-------
tensor([12662,  8029,  6150,  2826,  7111, 11813, 10129, 14747,    93, 11772]) tensor([ 1426,  5167, 12814,  9332,   392,   357,  3550,   271, 12422,  7975])
-------Step 5-------
tensor([12662,  8029,  6150,  2826,  7111, 11813, 10129, 14747,    93, 11772]) tensor([ 6262,  7632,  4157, 14521, 13026, 12303,  6397, 12783,   119, 14778])
-------Step 6-------
tensor([ 2828,   139,  3486, 12302,  5744,   287, 13523,  4552,   359,  3830]) tensor([ 6900, 14209,  9821,  4888, 11014, 11017,  2826,  7489, 12665,  6685])
-------Step 7-------
tensor([ 2828,   139,  3486, 12302,  5744,   287, 13523,  4552,   359,  3830]) tensor([12017,  4439,   838,  8117,  2634,  1660,  2934,  4240,  5417,  3104])
-------Step 8-------
tensor([   50, 11427,   256, 10212,  6248, 13102, 13584,  4978,  4367,  3678]) tensor([ 7388,  3357,  2061,  8122,  1225, 12222,  2172,  6580,  7661, 13868])
-------Step 9-------
tensor([   50, 11427,   256, 10212,  6248, 13102, 13584,  4978,  4367,  3678]) tensor([ 6573,  6603, 10101,  3778, 12197,  2447, 12644,  2966,  5438,    72])
before start barrier
start train
[proc 0] 100 steps, total: 17.394, sample: 0.348, forward: 1.028, backward: 1.157, update: 0.177
W20240202 14:17:47.452008 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240202 14:17:48.452004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=106, pq.top=106
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.371 ms                  | 19.327 ms                 |
| Forward                   | 4.467 ms                  | 8.707 ms                  |
| Backward                  | 9.090 ms                  | 19.946 ms                 |
| Optimize                  | 1.632 ms                  | 4.333 ms                  |
| BarrierTimeBeforeRank0    | 31.542 us                 | 4.382 ms                  |
| AfterBackward             | 11.840 ms                 | 26.581 ms                 |
| BlockToStepN              | 156.008 ms                | 223.117 ms                |
| OneStep                   | 190.494 ms                | 260.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:49.452014 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=110, pq.top=110
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.366 ms                  | 8.587 ms                  |
| ProcessBack:UpdateCache   | 2.560 ms                  | 4.467 ms                  |
| ProcessBack:UpsertPq      | 5.899 ms                  | 10.590 ms                 |
| ProcessOneStep            | 11.805 ms                 | 26.546 ms                 |
| BlockToStepN              | 156.584 ms                | 223.023 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:50.452004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240202 14:17:51.452014 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240202 14:17:52.452010 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=124, pq.top=124
W20240202 14:17:53.452004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=128, pq.top=128
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.373 ms                  | 19.327 ms                 |
| Forward                   | 4.433 ms                  | 8.707 ms                  |
| Backward                  | 9.039 ms                  | 19.946 ms                 |
| Optimize                  | 1.638 ms                  | 4.333 ms                  |
| BarrierTimeBeforeRank0    | 33.007 us                 | 4.382 ms                  |
| AfterBackward             | 11.746 ms                 | 26.581 ms                 |
| BlockToStepN              | 168.513 ms                | 223.117 ms                |
| OneStep                   | 200.096 ms                | 260.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:54.462249 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.343 ms                  | 5.815 ms                  |
| ProcessBack:UpdateCache   | 2.560 ms                  | 4.450 ms                  |
| ProcessBack:UpsertPq      | 5.862 ms                  | 10.427 ms                 |
| ProcessOneStep            | 11.718 ms                 | 26.546 ms                 |
| BlockToStepN              | 168.488 ms                | 223.023 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:55.462010 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
W20240202 14:17:56.462006 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240202 14:17:57.471693 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=146, pq.top=146
W20240202 14:17:58.471004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=150, pq.top=150
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.408 ms                  | 19.107 ms                 |
| Forward                   | 4.433 ms                  | 7.798 ms                  |
| Backward                  | 9.032 ms                  | 13.586 ms                 |
| Optimize                  | 1.632 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 32.121 us                 | 3.906 ms                  |
| AfterBackward             | 11.746 ms                 | 19.081 ms                 |
| BlockToStepN              | 175.323 ms                | 223.102 ms                |
| OneStep                   | 208.147 ms                | 252.339 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:17:59.471021 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=154, pq.top=154
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.349 ms                  | 5.815 ms                  |
| ProcessBack:UpdateCache   | 2.559 ms                  | 4.450 ms                  |
| ProcessBack:UpsertPq      | 5.879 ms                  | 10.427 ms                 |
| ProcessOneStep            | 11.718 ms                 | 19.045 ms                 |
| BlockToStepN              | 176.241 ms                | 223.004 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:00.499462 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240202 14:18:01.499015 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240202 14:18:02.499014 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240202 14:18:03.499006 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.408 ms                  | 19.327 ms                 |
| Forward                   | 4.384 ms                  | 7.798 ms                  |
| Backward                  | 9.030 ms                  | 13.586 ms                 |
| Optimize                  | 1.632 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 31.064 us                 | 3.906 ms                  |
| AfterBackward             | 11.697 ms                 | 19.081 ms                 |
| BlockToStepN              | 180.496 ms                | 228.340 ms                |
| OneStep                   | 214.155 ms                | 264.821 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:04.499018 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=176, pq.top=176
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.343 ms                  | 3.391 ms                  |
| ProcessBack:UpdateCache   | 2.560 ms                  | 4.450 ms                  |
| ProcessBack:UpsertPq      | 5.852 ms                  | 9.627 ms                  |
| ProcessOneStep            | 11.660 ms                 | 19.045 ms                 |
| BlockToStepN              | 180.441 ms                | 228.967 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:05.499004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240202 14:18:06.499006 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
W20240202 14:18:07.515700 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240202 14:18:08.515007 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.416 ms                  | 19.327 ms                 |
| Forward                   | 4.384 ms                  | 8.707 ms                  |
| Backward                  | 9.020 ms                  | 13.586 ms                 |
| Optimize                  | 1.631 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 29.052 us                 | 3.906 ms                  |
| AfterBackward             | 11.697 ms                 | 19.081 ms                 |
| BlockToStepN              | 184.975 ms                | 234.278 ms                |
| OneStep                   | 215.977 ms                | 275.078 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:09.515022 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.343 ms                  | 3.391 ms                  |
| ProcessBack:UpdateCache   | 2.560 ms                  | 5.350 ms                  |
| ProcessBack:UpsertPq      | 5.840 ms                  | 9.627 ms                  |
| ProcessOneStep            | 11.660 ms                 | 19.045 ms                 |
| BlockToStepN              | 184.940 ms                | 234.196 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 23.066, sample: 0.390, forward: 0.429, backward: 0.889, update: 0.162
[proc 1] 200 steps, total: 23.067, sample: 0.315, forward: 0.384, backward: 0.856, update: 0.160
[proc 2] 200 steps, total: 23.067, sample: 0.319, forward: 0.396, backward: 0.899, update: 0.163
[proc 3] 200 steps, total: 23.066, sample: 0.320, forward: 0.401, backward: 0.914, update: 0.170
W20240202 14:18:10.515005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240202 14:18:11.515014 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240202 14:18:12.515008 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
W20240202 14:18:13.515005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=214, pq.top=214
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.438 ms                  | 19.327 ms                 |
| Forward                   | 4.346 ms                  | 8.707 ms                  |
| Backward                  | 8.995 ms                  | 13.586 ms                 |
| Optimize                  | 1.627 ms                  | 4.333 ms                  |
| BarrierTimeBeforeRank0    | 27.926 us                 | 3.906 ms                  |
| AfterBackward             | 11.575 ms                 | 19.081 ms                 |
| BlockToStepN              | 185.981 ms                | 245.581 ms                |
| OneStep                   | 217.748 ms                | 278.326 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:14.515017 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.341 ms                  | 3.391 ms                  |
| ProcessBack:UpdateCache   | 2.559 ms                  | 5.350 ms                  |
| ProcessBack:UpsertPq      | 5.798 ms                  | 9.627 ms                  |
| ProcessOneStep            | 11.551 ms                 | 19.045 ms                 |
| BlockToStepN              | 185.894 ms                | 245.487 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:15.515005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=222, pq.top=222
W20240202 14:18:16.515015 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=226, pq.top=226
W20240202 14:18:17.515012 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240202 14:18:18.515007 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.443 ms                  | 19.327 ms                 |
| Forward                   | 4.299 ms                  | 8.707 ms                  |
| Backward                  | 8.995 ms                  | 13.586 ms                 |
| Optimize                  | 1.629 ms                  | 4.333 ms                  |
| BarrierTimeBeforeRank0    | 27.926 us                 | 4.382 ms                  |
| AfterBackward             | 11.540 ms                 | 19.081 ms                 |
| BlockToStepN              | 187.249 ms                | 249.024 ms                |
| OneStep                   | 219.388 ms                | 280.606 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:19.515022 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.341 ms                  | 3.368 ms                  |
| ProcessBack:UpdateCache   | 2.554 ms                  | 4.467 ms                  |
| ProcessBack:UpsertPq      | 5.792 ms                  | 9.515 ms                  |
| ProcessOneStep            | 11.514 ms                 | 19.045 ms                 |
| BlockToStepN              | 187.772 ms                | 248.908 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:20.515005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240202 14:18:21.515005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240202 14:18:22.515022 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240202 14:18:23.515004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=256, pq.top=256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.454 ms                  | 19.107 ms                 |
| Forward                   | 4.291 ms                  | 7.798 ms                  |
| Backward                  | 8.984 ms                  | 13.354 ms                 |
| Optimize                  | 1.624 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 30.105 us                 | 5.441 ms                  |
| AfterBackward             | 11.492 ms                 | 18.614 ms                 |
| BlockToStepN              | 189.402 ms                | 249.656 ms                |
| OneStep                   | 222.467 ms                | 281.684 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:24.515004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.329 ms                  | 3.368 ms                  |
| ProcessBack:UpdateCache   | 2.526 ms                  | 4.467 ms                  |
| ProcessBack:UpsertPq      | 5.755 ms                  | 9.627 ms                  |
| ProcessOneStep            | 11.462 ms                 | 18.570 ms                 |
| BlockToStepN              | 190.402 ms                | 249.547 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:25.515018 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240202 14:18:26.515005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=268, pq.top=268
W20240202 14:18:27.515013 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240202 14:18:28.515012 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.464 ms                  | 19.358 ms                 |
| Forward                   | 4.290 ms                  | 7.798 ms                  |
| Backward                  | 8.958 ms                  | 13.354 ms                 |
| Optimize                  | 1.615 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 32.312 us                 | 19.495 ms                 |
| AfterBackward             | 11.444 ms                 | 18.614 ms                 |
| BlockToStepN              | 192.129 ms                | 249.656 ms                |
| OneStep                   | 223.326 ms                | 289.346 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:29.515015 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.316 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.481 ms                  | 4.450 ms                  |
| ProcessBack:UpsertPq      | 5.723 ms                  | 9.627 ms                  |
| ProcessOneStep            | 11.419 ms                 | 18.570 ms                 |
| BlockToStepN              | 192.076 ms                | 249.547 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:30.515005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240202 14:18:31.515013 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=290, pq.top=290
W20240202 14:18:32.515012 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=294, pq.top=294
W20240202 14:18:33.515015 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=298, pq.top=298
[proc 2] 300 steps, total: 23.660, sample: 0.280, forward: 0.390, backward: 0.942, update: 0.158
[proc 0] 300 steps, total: 23.660, sample: 0.363, forward: 0.415, backward: 0.617, update: 0.161
[proc 1] 300 steps, total: 23.660, sample: 0.273, forward: 0.373, backward: 0.850, update: 0.154
[proc 3] 300 steps, total: 23.660, sample: 0.286, forward: 0.397, backward: 0.908, update: 0.167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.471 ms                  | 19.358 ms                 |
| Forward                   | 4.290 ms                  | 7.798 ms                  |
| Backward                  | 8.923 ms                  | 13.354 ms                 |
| Optimize                  | 1.608 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 36.212 us                 | 20.066 ms                 |
| AfterBackward             | 11.356 ms                 | 19.033 ms                 |
| BlockToStepN              | 192.726 ms                | 249.656 ms                |
| OneStep                   | 225.163 ms                | 289.346 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:34.515008 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.300 ms                  | 3.368 ms                  |
| ProcessBack:UpdateCache   | 2.466 ms                  | 4.450 ms                  |
| ProcessBack:UpsertPq      | 5.674 ms                  | 10.590 ms                 |
| ProcessOneStep            | 11.323 ms                 | 19.006 ms                 |
| BlockToStepN              | 192.710 ms                | 249.547 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:35.515007 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=306, pq.top=306
W20240202 14:18:36.515022 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=310, pq.top=310
W20240202 14:18:37.515007 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=314, pq.top=314
W20240202 14:18:38.515013 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=318, pq.top=318
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.487 ms                  | 19.358 ms                 |
| Forward                   | 4.289 ms                  | 7.798 ms                  |
| Backward                  | 8.923 ms                  | 13.354 ms                 |
| Optimize                  | 1.612 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 40.702 us                 | 22.062 ms                 |
| AfterBackward             | 11.356 ms                 | 19.033 ms                 |
| BlockToStepN              | 194.782 ms                | 249.656 ms                |
| OneStep                   | 226.047 ms                | 289.346 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:39.515005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.300 ms                  | 3.368 ms                  |
| ProcessBack:UpdateCache   | 2.459 ms                  | 4.450 ms                  |
| ProcessBack:UpsertPq      | 5.652 ms                  | 10.590 ms                 |
| ProcessOneStep            | 11.323 ms                 | 19.006 ms                 |
| BlockToStepN              | 194.702 ms                | 249.547 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:40.515007 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240202 14:18:41.515020 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240202 14:18:42.515007 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240202 14:18:43.532301 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=340, pq.top=340
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.494 ms                  | 19.358 ms                 |
| Forward                   | 4.274 ms                  | 7.798 ms                  |
| Backward                  | 8.911 ms                  | 13.354 ms                 |
| Optimize                  | 1.609 ms                  | 3.181 ms                  |
| BarrierTimeBeforeRank0    | 42.129 us                 | 22.062 ms                 |
| AfterBackward             | 11.330 ms                 | 19.081 ms                 |
| BlockToStepN              | 195.242 ms                | 249.656 ms                |
| OneStep                   | 226.749 ms                | 289.346 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:44.532004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=344, pq.top=344
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.296 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.458 ms                  | 3.506 ms                  |
| ProcessBack:UpsertPq      | 5.637 ms                  | 10.866 ms                 |
| ProcessOneStep            | 11.273 ms                 | 19.045 ms                 |
| BlockToStepN              | 195.425 ms                | 249.547 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:45.532012 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
W20240202 14:18:46.532011 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=351, pq.top=351
W20240202 14:18:47.532014 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=355, pq.top=355
W20240202 14:18:48.532011 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=358, pq.top=358
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.529 ms                  | 19.327 ms                 |
| Forward                   | 4.280 ms                  | 7.693 ms                  |
| Backward                  | 8.911 ms                  | 13.152 ms                 |
| Optimize                  | 1.608 ms                  | 3.159 ms                  |
| BarrierTimeBeforeRank0    | 43.387 us                 | 20.066 ms                 |
| AfterBackward             | 11.347 ms                 | 19.081 ms                 |
| BlockToStepN              | 197.079 ms                | 254.625 ms                |
| OneStep                   | 227.937 ms                | 293.759 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:49.532012 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=362, pq.top=362
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.297 ms                  | 3.368 ms                  |
| ProcessBack:UpdateCache   | 2.458 ms                  | 3.506 ms                  |
| ProcessBack:UpsertPq      | 5.640 ms                  | 12.166 ms                 |
| ProcessOneStep            | 11.323 ms                 | 19.045 ms                 |
| BlockToStepN              | 197.035 ms                | 254.563 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:50.532012 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=366, pq.top=366
W20240202 14:18:51.532006 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240202 14:18:52.532014 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240202 14:18:53.558174 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=377, pq.top=377
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.540 ms                  | 19.327 ms                 |
| Forward                   | 4.290 ms                  | 7.798 ms                  |
| Backward                  | 8.914 ms                  | 13.152 ms                 |
| Optimize                  | 1.606 ms                  | 3.159 ms                  |
| BarrierTimeBeforeRank0    | 44.634 us                 | 20.066 ms                 |
| AfterBackward             | 11.385 ms                 | 19.081 ms                 |
| BlockToStepN              | 198.242 ms                | 272.085 ms                |
| OneStep                   | 229.746 ms                | 315.944 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:54.558004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=380, pq.top=380
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.301 ms                  | 3.368 ms                  |
| ProcessBack:UpdateCache   | 2.458 ms                  | 3.506 ms                  |
| ProcessBack:UpsertPq      | 5.657 ms                  | 12.166 ms                 |
| ProcessOneStep            | 11.386 ms                 | 19.045 ms                 |
| BlockToStepN              | 198.205 ms                | 272.019 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:55.558013 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=384, pq.top=384
W20240202 14:18:56.558014 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240202 14:18:57.558007 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240202 14:18:58.558014 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=395, pq.top=395
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.555 ms                  | 19.327 ms                 |
| Forward                   | 4.289 ms                  | 7.798 ms                  |
| Backward                  | 8.911 ms                  | 13.152 ms                 |
| Optimize                  | 1.606 ms                  | 3.159 ms                  |
| BarrierTimeBeforeRank0    | 43.145 us                 | 22.145 ms                 |
| AfterBackward             | 11.410 ms                 | 20.476 ms                 |
| BlockToStepN              | 198.901 ms                | 273.101 ms                |
| OneStep                   | 231.286 ms                | 315.944 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:18:59.558004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.302 ms                  | 3.368 ms                  |
| ProcessBack:UpdateCache   | 2.454 ms                  | 3.506 ms                  |
| ProcessBack:UpsertPq      | 5.657 ms                  | 12.494 ms                 |
| ProcessOneStep            | 11.360 ms                 | 20.416 ms                 |
| BlockToStepN              | 199.215 ms                | 273.064 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 25.942, sample: 0.374, forward: 0.423, backward: 0.888, update: 0.157
[proc 1] 400 steps, total: 25.942, sample: 0.311, forward: 0.375, backward: 0.862, update: 0.153
[proc 3] 400 steps, total: 25.942, sample: 0.301, forward: 0.388, backward: 0.901, update: 0.165
[proc 2] 400 steps, total: 25.942, sample: 0.297, forward: 0.382, backward: 0.908, update: 0.157
W20240202 14:19:00.558007 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=402, pq.top=402
W20240202 14:19:01.558017 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=406, pq.top=406
W20240202 14:19:02.558005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=410, pq.top=410
W20240202 14:19:03.558012 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.562 ms                  | 19.327 ms                 |
| Forward                   | 4.280 ms                  | 7.798 ms                  |
| Backward                  | 8.911 ms                  | 13.152 ms                 |
| Optimize                  | 1.605 ms                  | 3.159 ms                  |
| BarrierTimeBeforeRank0    | 43.145 us                 | 22.145 ms                 |
| AfterBackward             | 11.385 ms                 | 20.476 ms                 |
| BlockToStepN              | 200.140 ms                | 273.101 ms                |
| OneStep                   | 232.805 ms                | 315.944 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:19:04.571870 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=418, pq.top=418
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.305 ms                  | 3.368 ms                  |
| ProcessBack:UpdateCache   | 2.458 ms                  | 3.506 ms                  |
| ProcessBack:UpsertPq      | 5.652 ms                  | 12.494 ms                 |
| ProcessOneStep            | 11.363 ms                 | 20.416 ms                 |
| BlockToStepN              | 200.016 ms                | 273.064 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:19:05.571007 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240202 14:19:06.571023 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=425, pq.top=425
W20240202 14:19:07.587029 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=430, pq.top=430
W20240202 14:19:08.616955 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=434, pq.top=434
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.565 ms                  | 19.327 ms                 |
| Forward                   | 4.274 ms                  | 7.798 ms                  |
| Backward                  | 8.931 ms                  | 13.152 ms                 |
| Optimize                  | 1.605 ms                  | 3.159 ms                  |
| BarrierTimeBeforeRank0    | 42.129 us                 | 22.145 ms                 |
| AfterBackward             | 11.439 ms                 | 21.206 ms                 |
| BlockToStepN              | 201.376 ms                | 273.101 ms                |
| OneStep                   | 233.291 ms                | 315.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.307 ms                  | 3.344 ms                  |
| ProcessBack:UpdateCache   | 2.459 ms                  | 3.503 ms                  |
| ProcessBack:UpsertPq      | 5.655 ms                  | 13.116 ms                 |
| ProcessOneStep            | 11.401 ms                 | 21.184 ms                 |
| BlockToStepN              | 200.799 ms                | 273.064 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:19:09.616004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240202 14:19:10.616006 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=442, pq.top=442
W20240202 14:19:11.616021 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=446, pq.top=446
W20240202 14:19:12.616005 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=450, pq.top=450
W20240202 14:19:13.616004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=454, pq.top=454
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.569 ms                  | 19.187 ms                 |
| Forward                   | 4.270 ms                  | 7.693 ms                  |
| Backward                  | 8.949 ms                  | 11.175 ms                 |
| Optimize                  | 1.601 ms                  | 3.129 ms                  |
| BarrierTimeBeforeRank0    | 42.355 us                 | 22.062 ms                 |
| AfterBackward             | 11.467 ms                 | 21.206 ms                 |
| BlockToStepN              | 201.449 ms                | 272.085 ms                |
| OneStep                   | 233.850 ms                | 315.581 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.312 ms                  | 3.344 ms                  |
| ProcessBack:UpdateCache   | 2.466 ms                  | 3.506 ms                  |
| ProcessBack:UpsertPq      | 5.683 ms                  | 14.021 ms                 |
| ProcessOneStep            | 11.453 ms                 | 21.184 ms                 |
| BlockToStepN              | 201.247 ms                | 272.019 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:19:14.647117 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240202 14:19:15.647006 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=463, pq.top=463
W20240202 14:19:16.647012 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=467, pq.top=467
W20240202 14:19:17.647008 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240202 14:19:18.647006 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=475, pq.top=475
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.574 ms                  | 19.327 ms                 |
| Forward                   | 4.265 ms                  | 7.693 ms                  |
| Backward                  | 8.974 ms                  | 11.226 ms                 |
| Optimize                  | 1.599 ms                  | 3.159 ms                  |
| BarrierTimeBeforeRank0    | 40.702 us                 | 22.062 ms                 |
| AfterBackward             | 11.447 ms                 | 21.206 ms                 |
| BlockToStepN              | 201.451 ms                | 272.085 ms                |
| OneStep                   | 234.516 ms                | 315.581 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.311 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.462 ms                  | 3.503 ms                  |
| ProcessBack:UpsertPq      | 5.688 ms                  | 13.648 ms                 |
| ProcessOneStep            | 11.421 ms                 | 21.184 ms                 |
| BlockToStepN              | 201.555 ms                | 272.019 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:19:19.647013 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=479, pq.top=479
W20240202 14:19:20.647004 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240202 14:19:21.647018 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240202 14:19:22.647006 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=491, pq.top=491
W20240202 14:19:23.647015 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=495, pq.top=495
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.581 ms                  | 19.327 ms                 |
| Forward                   | 4.266 ms                  | 7.693 ms                  |
| Backward                  | 8.986 ms                  | 11.226 ms                 |
| Optimize                  | 1.601 ms                  | 3.159 ms                  |
| BarrierTimeBeforeRank0    | 39.474 us                 | 22.062 ms                 |
| AfterBackward             | 11.439 ms                 | 21.206 ms                 |
| BlockToStepN              | 201.376 ms                | 273.101 ms                |
| OneStep                   | 234.624 ms                | 315.944 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.313 ms                  | 3.254 ms                  |
| ProcessBack:UpdateCache   | 2.461 ms                  | 3.503 ms                  |
| ProcessBack:UpsertPq      | 5.676 ms                  | 13.648 ms                 |
| ProcessOneStep            | 11.401 ms                 | 21.184 ms                 |
| BlockToStepN              | 201.247 ms                | 273.064 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:19:24.680277 56640 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=500, pq.top=500
[proc 2] 500 steps, total: 24.902, sample: 0.283, forward: 0.385, backward: 0.878, update: 0.161
[proc 1] 500 steps, total: 24.902, sample: 0.280, forward: 0.378, backward: 0.855, update: 0.156
[proc 0] 500 steps, total: 24.902, sample: 0.405, forward: 0.413, backward: 0.953, update: 0.160
[proc 3] 500 steps, total: 24.902, sample: 0.285, forward: 0.392, backward: 0.910, update: 0.166
Successfully xmh. training takes 114.96480965614319 seconds
before call kg_cache_controller.StopThreads()
W20240202 14:19:24.926771 56640 grad_async_v1.h:243] call StopThreads. PID = 56086
W20240202 14:19:24.926788 56640 grad_base.h:212] before processOneStepNegThread_.join();
W20240202 14:19:24.929998 56640 grad_base.h:214] after processOneStepNegThread_.join();
W20240202 14:19:24.930007 56640 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240202 14:19:24.953981 56640 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7fe3a8cfa590>
