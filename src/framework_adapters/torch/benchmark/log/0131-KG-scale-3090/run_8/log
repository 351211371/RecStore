WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240202 14:06:11.084555  2205 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_61', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [2205 sampler.py:454] Start PreSampling
WARNING [2205 sampler.py:532] Before construct renumbering_dict
WARNING [2205 sampler.py:555] PreSampling done
W20240202 14:06:16.535434  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240202 14:06:16.535647  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240202 14:06:16.535696  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240202 14:06:16.535732  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240202 14:06:16.535777  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240202 14:06:16.535825  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240202 14:06:16.535876  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240202 14:06:16.535919  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240202 14:06:16.535959  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240202 14:06:16.536000  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240202 14:06:16.536041  2205 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240202 14:06:16.536080  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240202 14:06:16.536120  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240202 14:06:16.536295  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240202 14:06:16.536345  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240202 14:06:16.536386  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240202 14:06:16.536429  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240202 14:06:16.536458  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240202 14:06:16.536494  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240202 14:06:16.536526  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240202 14:06:16.536558  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240202 14:06:16.536585  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240202 14:06:16.536625  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240202 14:06:16.536653  2205 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240202 14:06:16.536679  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240202 14:06:16.536703  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240202 14:06:16.536758  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240202 14:06:16.536789  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240202 14:06:16.536821  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240202 14:06:16.536849  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240202 14:06:16.536877  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240202 14:06:16.536907  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240202 14:06:16.536952  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240202 14:06:16.536981  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240202 14:06:16.537019  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240202 14:06:16.537047  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240202 14:06:16.537076  2205 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240202 14:06:16.537101  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240202 14:06:16.537132  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240202 14:06:16.537190  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240202 14:06:16.537233  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240202 14:06:16.537261  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240202 14:06:16.537290  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240202 14:06:16.537320  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240202 14:06:16.537348  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240202 14:06:16.537380  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240202 14:06:16.537411  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240202 14:06:16.537443  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240202 14:06:16.537487  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240202 14:06:16.537514  2205 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240202 14:06:16.537539  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240202 14:06:16.537561  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240202 14:06:16.537626  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240202 14:06:16.537667  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240202 14:06:16.537698  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240202 14:06:16.537729  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240202 14:06:16.537765  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240202 14:06:16.537793  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240202 14:06:16.537835  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240202 14:06:16.537874  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240202 14:06:16.537902  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240202 14:06:16.537930  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240202 14:06:16.537957  2205 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240202 14:06:16.537981  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240202 14:06:16.538012  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240202 14:06:16.538071  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240202 14:06:16.538112  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240202 14:06:16.538143  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240202 14:06:16.538178  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240202 14:06:16.538210  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240202 14:06:16.538245  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240202 14:06:16.538291  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240202 14:06:16.538322  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240202 14:06:16.538359  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240202 14:06:16.538399  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240202 14:06:16.538427  2205 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240202 14:06:16.538451  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240202 14:06:16.538475  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240202 14:06:16.538533  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240202 14:06:16.538578  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240202 14:06:16.538607  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240202 14:06:16.538637  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240202 14:06:16.538667  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240202 14:06:16.538705  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240202 14:06:16.538738  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240202 14:06:16.538785  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240202 14:06:16.538818  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240202 14:06:16.538851  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240202 14:06:16.538892  2205 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240202 14:06:16.538916  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240202 14:06:16.538940  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240202 14:06:16.538993  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240202 14:06:16.539026  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240202 14:06:16.539054  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240202 14:06:16.539083  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240202 14:06:16.539117  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240202 14:06:16.539150  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240202 14:06:16.539194  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240202 14:06:16.539227  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240202 14:06:16.539270  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240202 14:06:16.539305  2205 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240202 14:06:16.539333  2205 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240202 14:06:16.539358  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240202 14:06:16.539387  2205 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240202 14:06:16.782611  2205 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x100026322000 22.81 MB
W20240202 14:06:16.872468  2205 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x1000279f4000 58.4 kB
{0: Graph(num_nodes=8499, num_edges=86694,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=6140, num_edges=88951,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=8646, num_edges=109741,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=8503, num_edges=86907,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=10597, num_edges=122217,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=8255, num_edges=102550,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=7422, num_edges=104094,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=7815, num_edges=137832,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 8499 N 86694 E
MertisPartition: part 1 has 6140 N 88951 E
MertisPartition: part 2 has 8646 N 109741 E
MertisPartition: part 3 has 8503 N 86907 E
MertisPartition: part 4 has 10597 N 122217 E
MertisPartition: part 5 has 8255 N 102550 E
MertisPartition: part 6 has 7422 N 104094 E
MertisPartition: part 7 has 7815 N 137832 E
Rank0: cached key size 93
Rank1: cached key size 93
Rank2: cached key size 93
Rank3: cached key size 93
Rank4: cached key size 93
Rank5: cached key size 93
Rank6: cached key size 93
Rank7: cached key size 93
Before renumbering graph:  {'_ID': tensor([    0,    15,    36,  ..., 11946,  9147, 13282]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
After renumbering graph:  {'_ID': tensor([ 761, 1141, 1549,  ..., 8870, 8987, 7039]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 3, 7])}
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=8499, num_edges=86694,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 5.885 seconds
[Rank1] pid = 2633
[Rank2] pid = 2654
[Rank3] pid = 2699
[Rank4] pid = 2806
[Rank5] pid = 2832
[Rank6] pid = 2897
INFO [2205 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [2633 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [2654 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [2699 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [2897 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [2806 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [2832 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [2960 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [2897 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2699 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2960 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2832 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2654 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2806 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2205 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [2633 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240202 14:06:19.411023  2967 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [747, 400]; dev=7; size=1.14 MB
W20240202 14:06:19.411111  2962 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240202 14:06:19.411911  2968 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [747, 400]; dev=6; size=1.14 MB
W20240202 14:06:19.411907  2768 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [747, 400]; dev=3; size=1.14 MB
W20240202 14:06:19.411891  2896 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [747, 400]; dev=5; size=1.14 MB
W20240202 14:06:19.411916  2833 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [747, 400]; dev=4; size=1.14 MB
W20240202 14:06:19.412205  2634 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240202 14:06:19.412245  2698 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240202 14:06:19.450793  2896 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x100027a0a000 7.629 MB
W20240202 14:06:19.451011  2968 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1000281ad000 7.629 MB
W20240202 14:06:19.451036  2967 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x100028952000 7.629 MB
W20240202 14:06:19.451067  2896 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x1000290f7000 7.629 MB
W20240202 14:06:19.451184  2896 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10002989c000 1.49 GB
W20240202 14:06:19.451200  2967 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x100088e7f000 7.629 MB
W20240202 14:06:19.451220  2968 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100089622000 7.629 MB
W20240202 14:06:19.451252  2896 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x100089dc5000 1.49 GB
W20240202 14:06:19.451292  2698 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1000e93aa000 7.629 MB
W20240202 14:06:19.451318  2968 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x1000ea2f0000 1.49 GB
W20240202 14:06:19.451311  2768 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000e9b4d000 7.629 MB
W20240202 14:06:19.451329  2896 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 14:06:19.451335  2967 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1001498d3000 1.49 GB
W20240202 14:06:19.451381  2968 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1001a8eb8000 1.49 GB
W20240202 14:06:19.451395  2967 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x10020849b000 1.49 GB
W20240202 14:06:19.451418  2962 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100267a7e000 7.629 MB
W20240202 14:06:19.451454  2968 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240202 14:06:19.451457  2967 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240202 14:06:19.451483  2833 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100268221000 7.629 MB
W20240202 14:06:19.451498  2698 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1002689c4000 7.629 MB
W20240202 14:06:19.451504  2768 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100269167000 7.629 MB
W20240202 14:06:19.451548  2962 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10026990a000 7.629 MB
W20240202 14:06:19.451602  2698 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10026a0ad000 1.49 GB
W20240202 14:06:19.451611  2962 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x1002c9690000 1.49 GB
W20240202 14:06:19.451620  2768 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x100328c73000 1.49 GB
W20240202 14:06:19.451665  2962 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x100388256000 1.49 GB
W20240202 14:06:19.451692  2698 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1003e7839000 1.49 GB
W20240202 14:06:19.451712  2833 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x100446e1c000 7.629 MB
W20240202 14:06:19.451720  2768 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x1004475bf000 1.49 GB
W20240202 14:06:19.451728  2962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 14:06:19.451752  2634 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1004a6ba2000 7.629 MB
W20240202 14:06:19.451779  2698 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 14:06:19.451797  2768 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:06:19.451812  2833 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1004a7345000 1.49 GB
W20240202 14:06:19.451869  2833 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x100506928000 1.49 GB
W20240202 14:06:19.451900  2634 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100565f0b000 7.629 MB
W20240202 14:06:19.451934  2833 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 14:06:19.451984  2634 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1005666ae000 1.49 GB
W20240202 14:06:19.452064  2634 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1005c5c91000 1.49 GB
W20240202 14:06:19.452128  2634 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240202 14:06:19.463407  2962 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240202 14:06:19.463472  2768 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240202 14:06:19.463493  2698 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240202 14:06:19.463516  2967 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240202 14:06:19.463526  2896 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240202 14:06:19.463554  2968 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240202 14:06:19.465055  2833 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240202 14:06:19.476310  2634 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [2832 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [2806 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [2960 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [2897 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 2960
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988), (2988, 3735), (3735, 4482), (4482, 5229), (5229, 5976)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [2205 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [2654 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [2699 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [2633 DistTensor.py:59] The tensor name already exists in the kvstore
I20240202 14:06:22.534426  2634 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240202 14:06:22.534919  2768 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:06:22.535086  2896 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:06:22.536161  2968 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:06:22.536389  2967 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:06:22.536505  2833 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:06:22.536625  2698 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240202 14:06:22.536733  2962 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240202 14:06:22.541428  2962 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240202 14:06:22.541745  2962 grad_base.h:184] Init GradProcessingBase done
I20240202 14:06:22.548528  2962 grad_async_v1.h:203] Use main thread to update emb.
W20240202 14:06:22.548661  2962 kg_controller.h:75] after init GradAsyncProcessing
I20240202 14:06:22.548691  2962 kg_controller.h:84] Construct KGCacheController done
E20240202 14:06:24.306782  2967 recstore.cc:66] init folly done
E20240202 14:06:24.306907  2833 recstore.cc:66] init folly done
E20240202 14:06:24.306911  2896 recstore.cc:66] init folly done
E20240202 14:06:24.306982  2768 recstore.cc:66] init folly done
E20240202 14:06:24.307049  2634 recstore.cc:66] init folly done
E20240202 14:06:24.307519  2962 recstore.cc:66] init folly done
E20240202 14:06:24.307713  2698 recstore.cc:66] init folly done
E20240202 14:06:24.308282  2968 recstore.cc:66] init folly done
I20240202 14:06:24.309423  2962 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240202 14:06:25.157114  2962 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240202 14:06:25.163403  2967 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:06:25.164848  2896 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:06:25.165524  2698 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:06:25.166116  2968 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:06:25.166450  2768 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:06:25.166646  2634 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240202 14:06:25.166679  2833 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 745.304 us                | 745.304 us                |
| Forward                   | 695.977 ms                | 695.977 ms                |
| Backward                  | 232.238 ms                | 232.238 ms                |
| Optimize                  | 5.906 ms                  | 5.906 ms                  |
| BarrierTimeBeforeRank0    | 102.935 us                | 102.935 us                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:27.594285  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=0
E20240202 14:06:27.694546  3470 grad_async_v1.h:533] Stalled in ProcessBackward: rank=2, step_no=1, sample_step_cpp_seen_[rank]=0
W20240202 14:06:29.047744  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.392 ms                  | 374.862 ms                |
| ProcessBack:UpdateCache   | 10.219 ms                 | 808.667 ms                |
| ProcessBack:UpsertPq      | 7.781 ms                  | 26.189 ms                 |
| ProcessOneStep            | 27.610 ms                 | 1.489 s                   |
| BlockToStepN              | 582.000 ns                | 161.251 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:30.047011  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240202 14:06:31.047040  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=28, pq.top=28
W20240202 14:06:32.047008  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.455 ms                  | 22.406 ms                 |
| Forward                   | 4.869 ms                  | 695.977 ms                |
| Backward                  | 6.252 ms                  | 232.238 ms                |
| Optimize                  | 1.841 ms                  | 7.443 ms                  |
| BarrierTimeBeforeRank0    | 3.515 ms                  | 11.030 ms                 |
| AfterBackward             | 30.323 ms                 | 1.490 s                   |
| BlockToStepN              | 85.758 ms                 | 161.461 ms                |
| OneStep                   | 139.826 ms                | 2.472 s                   |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:33.047016  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240202 14:06:34.047004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.990 ms                  | 341.792 ms                |
| ProcessBack:UpdateCache   | 10.198 ms                 | 807.919 ms                |
| ProcessBack:UpsertPq      | 11.682 ms                 | 25.318 ms                 |
| ProcessOneStep            | 31.477 ms                 | 1.489 s                   |
| BlockToStepN              | 93.660 ms                 | 161.251 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:35.047006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240202 14:06:36.047014  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=58, pq.top=58
W20240202 14:06:37.047005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.538 ms                  | 20.018 ms                 |
| Forward                   | 4.768 ms                  | 11.578 ms                 |
| Backward                  | 8.667 ms                  | 18.974 ms                 |
| Optimize                  | 1.828 ms                  | 5.906 ms                  |
| BarrierTimeBeforeRank0    | 2.533 ms                  | 11.030 ms                 |
| AfterBackward             | 31.420 ms                 | 652.716 ms                |
| BlockToStepN              | 101.352 ms                | 159.856 ms                |
| OneStep                   | 161.727 ms                | 675.537 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:38.047005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=68, pq.top=68
W20240202 14:06:39.047005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.994 ms                  | 341.792 ms                |
| ProcessBack:UpdateCache   | 9.947 ms                  | 807.919 ms                |
| ProcessBack:UpsertPq      | 10.657 ms                 | 25.318 ms                 |
| ProcessOneStep            | 30.433 ms                 | 652.511 ms                |
| BlockToStepN              | 109.558 ms                | 161.013 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:40.047006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=78, pq.top=78
W20240202 14:06:41.081450  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240202 14:06:42.081007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.619 ms                  | 22.406 ms                 |
| Forward                   | 4.768 ms                  | 11.578 ms                 |
| Backward                  | 8.840 ms                  | 22.356 ms                 |
| Optimize                  | 1.836 ms                  | 5.906 ms                  |
| BarrierTimeBeforeRank0    | 1.928 ms                  | 18.371 ms                 |
| AfterBackward             | 30.178 ms                 | 652.716 ms                |
| BlockToStepN              | 117.618 ms                | 184.930 ms                |
| OneStep                   | 172.676 ms                | 675.537 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:43.081007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240202 14:06:44.081007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=96, pq.top=96
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.083 ms                  | 15.948 ms                 |
| ProcessBack:UpdateCache   | 9.740 ms                  | 18.956 ms                 |
| ProcessBack:UpsertPq      | 10.476 ms                 | 18.703 ms                 |
| ProcessOneStep            | 30.107 ms                 | 652.511 ms                |
| BlockToStepN              | 124.459 ms                | 205.726 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 19.893, sample: 0.335, forward: 1.025, backward: 1.061, update: 0.176
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 19.893, sample: 0.367, forward: 1.108, backward: 0.844, update: 0.195
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 19.895, sample: 0.342, forward: 1.071, backward: 1.019, update: 0.182
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 19.894, sample: 0.402, forward: 1.114, backward: 0.822, update: 0.208
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 19.896, sample: 0.355, forward: 1.077, backward: 1.007, update: 0.183
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 19.893, sample: 0.354, forward: 1.081, backward: 1.068, update: 0.191
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 19.894, sample: 0.325, forward: 1.009, backward: 1.066, update: 0.181
train_sampler.Prefill()
-------Step 0-------
tensor([ 1990,    50,  3526,  3345, 12168, 13074,  1109,   434, 13765, 11823]) tensor([ 1549,  7318,  5758, 11040, 12325,  1027,   565,  4991,   514, 10241])
-------Step 1-------
tensor([ 1990,    50,  3526,  3345, 12168, 13074,  1109,   434, 13765, 11823]) tensor([ 3851, 10275, 14146,  1513,  1018,  7287, 14298,  9985,  5263, 11324])
-------Step 2-------
tensor([ 6315, 11060,  5978,  4008, 10061,  8986, 10323,    20, 10835,   932]) tensor([ 3322,  4983,  3277,  8486,  5418,  8621, 14523, 10087, 13460,  9617])
-------Step 3-------
tensor([ 6315, 11060,  5978,  4008, 10061,  8986, 10323,    20, 10835,   932]) tensor([ 8461,  6243,  7311, 11121,  7107,   714,  5707,  2178, 12443,  2148])
-------Step 4-------
tensor([   50, 11336,  8297,  4907,  5262,  3384,    66,  7097,  7356,   979]) tensor([ 594, 1126, 3465, 3278, 3066, 2555,  434, 6790, 5259, 1840])
-------Step 5-------
tensor([   50, 11336,  8297,  4907,  5262,  3384,    66,  7097,  7356,   979]) tensor([8848, 4666, 6037, 1728, 3265,  809,  818, 1312, 5963, 7187])
-------Step 6-------
tensor([ 1695,  8155,    44,    83,  7453,  2711,  9088, 11521, 14060, 13866]) tensor([11060,  3111,  7171,  3283,  9097,  9396,  3970,  8826,  9145, 11800])
-------Step 7-------
tensor([ 1695,  8155,    44,    83,  7453,  2711,  9088, 11521, 14060, 13866]) tensor([12872, 13313,  4371,  6145,  1303,  8637,  7314,  3355,   139, 12257])
-------Step 8-------
tensor([ 3019,  6918,  4825, 12511,    36,    85, 10147, 12031,     8,  2095]) tensor([ 5948,  5095,  4748,  7681,  2652, 13911,  9621,  1577,  8784,  3334])
-------Step 9-------
tensor([ 3019,  6918,  4825, 12511,    36,    85, 10147, 12031,     8,  2095]) tensor([12305,  3575, 13014,  7672, 14692, 13661, 13404,  9985,   654, 13459])
before start barrier
start train
[proc 0] 100 steps, total: 19.903, sample: 0.399, forward: 1.189, backward: 1.051, update: 0.205
W20240202 14:06:45.106372  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240202 14:06:46.106019  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
W20240202 14:06:47.106009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.520 ms                  | 22.406 ms                 |
| Forward                   | 4.861 ms                  | 13.040 ms                 |
| Backward                  | 8.872 ms                  | 22.356 ms                 |
| Optimize                  | 1.836 ms                  | 5.906 ms                  |
| BarrierTimeBeforeRank0    | 1.276 ms                  | 18.371 ms                 |
| AfterBackward             | 30.108 ms                 | 652.716 ms                |
| BlockToStepN              | 131.719 ms                | 205.797 ms                |
| OneStep                   | 188.329 ms                | 675.537 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:48.106009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240202 14:06:49.106005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.153 ms                  | 18.548 ms                 |
| ProcessBack:UpdateCache   | 9.653 ms                  | 18.956 ms                 |
| ProcessBack:UpsertPq      | 10.349 ms                 | 18.703 ms                 |
| ProcessOneStep            | 29.962 ms                 | 652.511 ms                |
| BlockToStepN              | 136.614 ms                | 205.726 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:50.106010  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240202 14:06:51.106014  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
W20240202 14:06:52.106007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.538 ms                  | 22.722 ms                 |
| Forward                   | 4.788 ms                  | 13.040 ms                 |
| Backward                  | 8.879 ms                  | 22.356 ms                 |
| Optimize                  | 1.844 ms                  | 5.906 ms                  |
| BarrierTimeBeforeRank0    | 1.508 ms                  | 18.371 ms                 |
| AfterBackward             | 29.764 ms                 | 652.716 ms                |
| BlockToStepN              | 145.559 ms                | 229.686 ms                |
| OneStep                   | 197.046 ms                | 675.537 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:53.106006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240202 14:06:54.106009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.109 ms                  | 15.948 ms                 |
| ProcessBack:UpdateCache   | 9.543 ms                  | 18.610 ms                 |
| ProcessBack:UpsertPq      | 10.188 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.694 ms                 | 652.511 ms                |
| BlockToStepN              | 147.009 ms                | 230.358 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:55.117934  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240202 14:06:56.117012  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=144, pq.top=144
W20240202 14:06:57.117007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=148, pq.top=148
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.532 ms                  | 25.404 ms                 |
| Forward                   | 4.768 ms                  | 13.040 ms                 |
| Backward                  | 8.872 ms                  | 22.356 ms                 |
| Optimize                  | 1.841 ms                  | 5.906 ms                  |
| BarrierTimeBeforeRank0    | 1.270 ms                  | 19.091 ms                 |
| AfterBackward             | 29.712 ms                 | 652.716 ms                |
| BlockToStepN              | 154.274 ms                | 272.000 ms                |
| OneStep                   | 207.975 ms                | 675.537 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:06:58.117007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=152, pq.top=152
W20240202 14:06:59.158790  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=156, pq.top=156
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.068 ms                  | 15.948 ms                 |
| ProcessBack:UpdateCache   | 9.493 ms                  | 18.610 ms                 |
| ProcessBack:UpsertPq      | 10.143 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.660 ms                 | 48.783 ms                 |
| BlockToStepN              | 156.845 ms                | 246.443 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:00.196187  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=160, pq.top=160
W20240202 14:07:01.196004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
W20240202 14:07:02.196007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=166, pq.top=166
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.532 ms                  | 22.722 ms                 |
| Forward                   | 4.788 ms                  | 12.438 ms                 |
| Backward                  | 8.840 ms                  | 18.974 ms                 |
| Optimize                  | 1.830 ms                  | 3.814 ms                  |
| BarrierTimeBeforeRank0    | 1.572 ms                  | 23.874 ms                 |
| AfterBackward             | 29.693 ms                 | 48.843 ms                 |
| BlockToStepN              | 158.984 ms                | 272.000 ms                |
| OneStep                   | 215.155 ms                | 347.785 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:03.196005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=170, pq.top=170
W20240202 14:07:04.196012  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.030 ms                  | 15.948 ms                 |
| ProcessBack:UpdateCache   | 9.616 ms                  | 18.610 ms                 |
| ProcessBack:UpsertPq      | 10.169 ms                 | 18.703 ms                 |
| ProcessOneStep            | 29.660 ms                 | 48.783 ms                 |
| BlockToStepN              | 161.013 ms                | 271.898 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:05.196013  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240202 14:07:06.196007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=180, pq.top=180
W20240202 14:07:07.196007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=184, pq.top=184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.520 ms                  | 22.722 ms                 |
| Forward                   | 4.791 ms                  | 12.438 ms                 |
| Backward                  | 8.806 ms                  | 18.974 ms                 |
| Optimize                  | 1.823 ms                  | 3.814 ms                  |
| BarrierTimeBeforeRank0    | 2.402 ms                  | 23.921 ms                 |
| AfterBackward             | 29.609 ms                 | 48.843 ms                 |
| BlockToStepN              | 166.503 ms                | 272.000 ms                |
| OneStep                   | 226.414 ms                | 347.785 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:08.196007  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240202 14:07:09.202026  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.970 ms                  | 13.451 ms                 |
| ProcessBack:UpdateCache   | 9.823 ms                  | 16.949 ms                 |
| ProcessBack:UpsertPq      | 10.118 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.546 ms                 | 48.783 ms                 |
| BlockToStepN              | 168.324 ms                | 275.534 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:10.202018  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=194, pq.top=194
W20240202 14:07:11.202005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=198, pq.top=198
[proc 5] 200 steps, total: 26.905, sample: 0.383, forward: 0.467, backward: 0.788, update: 0.175
[proc 4] 200 steps, total: 26.905, sample: 0.387, forward: 0.431, backward: 0.405, update: 0.168
[proc 2] 200 steps, total: 26.905, sample: 0.347, forward: 0.428, backward: 0.832, update: 0.167
[proc 1] 200 steps, total: 26.905, sample: 0.368, forward: 0.447, backward: 0.903, update: 0.180
[proc 3] 200 steps, total: 26.905, sample: 0.408, forward: 0.445, backward: 0.859, update: 0.175
[proc 7] 200 steps, total: 26.905, sample: 0.388, forward: 0.446, backward: 0.915, update: 0.185
[proc 6] 200 steps, total: 26.905, sample: 0.377, forward: 0.445, backward: 0.893, update: 0.191
[proc 0] 200 steps, total: 26.905, sample: 0.469, forward: 0.498, backward: 0.726, update: 0.188
W20240202 14:07:12.202008  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.512 ms                  | 22.722 ms                 |
| Forward                   | 4.808 ms                  | 12.438 ms                 |
| Backward                  | 8.814 ms                  | 18.974 ms                 |
| Optimize                  | 1.809 ms                  | 3.814 ms                  |
| BarrierTimeBeforeRank0    | 2.416 ms                  | 23.921 ms                 |
| AfterBackward             | 29.368 ms                 | 48.843 ms                 |
| BlockToStepN              | 177.502 ms                | 283.634 ms                |
| OneStep                   | 233.174 ms                | 347.785 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:13.202006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240202 14:07:14.202005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.946 ms                  | 13.451 ms                 |
| ProcessBack:UpdateCache   | 9.850 ms                  | 16.949 ms                 |
| ProcessBack:UpsertPq      | 10.070 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.337 ms                 | 48.783 ms                 |
| BlockToStepN              | 178.858 ms                | 283.558 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:15.202006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
W20240202 14:07:16.202011  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240202 14:07:17.202018  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=218, pq.top=218
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.520 ms                  | 23.617 ms                 |
| Forward                   | 4.825 ms                  | 13.040 ms                 |
| Backward                  | 8.802 ms                  | 18.974 ms                 |
| Optimize                  | 1.812 ms                  | 5.906 ms                  |
| BarrierTimeBeforeRank0    | 3.069 ms                  | 25.114 ms                 |
| AfterBackward             | 29.309 ms                 | 48.843 ms                 |
| BlockToStepN              | 183.964 ms                | 286.285 ms                |
| OneStep                   | 235.179 ms                | 353.555 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:18.202006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
W20240202 14:07:19.275238  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.898 ms                  | 13.451 ms                 |
| ProcessBack:UpdateCache   | 9.947 ms                  | 16.949 ms                 |
| ProcessBack:UpsertPq      | 10.048 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.256 ms                 | 48.783 ms                 |
| BlockToStepN              | 186.076 ms                | 286.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:20.275005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=228, pq.top=228
W20240202 14:07:21.275061  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240202 14:07:22.318272  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=235, pq.top=235
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.520 ms                  | 23.617 ms                 |
| Forward                   | 4.809 ms                  | 13.040 ms                 |
| Backward                  | 8.806 ms                  | 18.974 ms                 |
| Optimize                  | 1.809 ms                  | 5.906 ms                  |
| BarrierTimeBeforeRank0    | 3.172 ms                  | 28.093 ms                 |
| AfterBackward             | 29.213 ms                 | 48.843 ms                 |
| BlockToStepN              | 190.521 ms                | 286.285 ms                |
| OneStep                   | 241.661 ms                | 353.555 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:23.318006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.887 ms                  | 13.228 ms                 |
| ProcessBack:UpdateCache   | 9.938 ms                  | 16.268 ms                 |
| ProcessBack:UpsertPq      | 10.048 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.183 ms                 | 48.783 ms                 |
| BlockToStepN              | 191.390 ms                | 286.098 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:24.329519  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=242, pq.top=242
W20240202 14:07:25.329005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240202 14:07:26.329010  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=248, pq.top=248
W20240202 14:07:27.329012  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.518 ms                  | 22.722 ms                 |
| Forward                   | 4.825 ms                  | 12.641 ms                 |
| Backward                  | 8.827 ms                  | 17.822 ms                 |
| Optimize                  | 1.823 ms                  | 3.814 ms                  |
| BarrierTimeBeforeRank0    | 3.476 ms                  | 28.057 ms                 |
| AfterBackward             | 29.141 ms                 | 44.890 ms                 |
| BlockToStepN              | 193.712 ms                | 291.226 ms                |
| OneStep                   | 250.447 ms                | 354.711 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:28.351246  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.878 ms                  | 13.451 ms                 |
| ProcessBack:UpdateCache   | 9.935 ms                  | 16.268 ms                 |
| ProcessBack:UpsertPq      | 10.048 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.048 ms                 | 44.841 ms                 |
| BlockToStepN              | 194.612 ms                | 291.123 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:29.351003  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=258, pq.top=258
W20240202 14:07:30.351006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240202 14:07:31.351011  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=264, pq.top=264
W20240202 14:07:32.351011  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.529 ms                  | 22.738 ms                 |
| Forward                   | 4.817 ms                  | 12.641 ms                 |
| Backward                  | 8.831 ms                  | 18.974 ms                 |
| Optimize                  | 1.804 ms                  | 3.814 ms                  |
| BarrierTimeBeforeRank0    | 3.515 ms                  | 28.057 ms                 |
| AfterBackward             | 29.056 ms                 | 44.890 ms                 |
| BlockToStepN              | 198.951 ms                | 294.256 ms                |
| OneStep                   | 254.601 ms                | 375.007 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:33.351006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.842 ms                  | 13.451 ms                 |
| ProcessBack:UpdateCache   | 9.924 ms                  | 16.268 ms                 |
| ProcessBack:UpsertPq      | 10.048 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.048 ms                 | 44.841 ms                 |
| BlockToStepN              | 199.718 ms                | 294.195 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:34.351003  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240202 14:07:35.351006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240202 14:07:36.351004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=280, pq.top=280
W20240202 14:07:37.351009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=283, pq.top=283
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.529 ms                  | 24.181 ms                 |
| Forward                   | 4.799 ms                  | 12.641 ms                 |
| Backward                  | 8.834 ms                  | 18.974 ms                 |
| Optimize                  | 1.802 ms                  | 3.814 ms                  |
| BarrierTimeBeforeRank0    | 3.515 ms                  | 28.057 ms                 |
| AfterBackward             | 29.078 ms                 | 44.890 ms                 |
| BlockToStepN              | 203.525 ms                | 298.873 ms                |
| OneStep                   | 259.094 ms                | 382.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:38.351013  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=286, pq.top=286
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.828 ms                  | 13.228 ms                 |
| ProcessBack:UpdateCache   | 9.924 ms                  | 13.395 ms                 |
| ProcessBack:UpsertPq      | 10.056 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.125 ms                 | 44.841 ms                 |
| BlockToStepN              | 203.694 ms                | 308.338 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:39.351006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
W20240202 14:07:40.372421  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=293, pq.top=293
W20240202 14:07:41.372006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=296, pq.top=296
W20240202 14:07:42.372006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.532 ms                  | 24.181 ms                 |
| Forward                   | 4.799 ms                  | 12.641 ms                 |
| Backward                  | 8.831 ms                  | 18.974 ms                 |
| Optimize                  | 1.804 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.585 ms                  | 28.057 ms                 |
| AfterBackward             | 29.155 ms                 | 44.890 ms                 |
| BlockToStepN              | 205.797 ms                | 308.444 ms                |
| OneStep                   | 265.123 ms                | 382.494 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 30.911, sample: 0.350, forward: 0.445, backward: 0.830, update: 0.167
[proc 7] 300 steps, total: 30.911, sample: 0.353, forward: 0.412, backward: 0.981, update: 0.181
[proc 4] 300 steps, total: 30.911, sample: 0.369, forward: 0.446, backward: 0.385, update: 0.167
[proc 5] 300 steps, total: 30.911, sample: 0.345, forward: 0.452, backward: 0.802, update: 0.179
[proc 3] 300 steps, total: 30.911, sample: 0.336, forward: 0.421, backward: 0.789, update: 0.169
[proc 0] 300 steps, total: 30.911, sample: 0.446, forward: 0.497, backward: 0.833, update: 0.187
[proc 6] 300 steps, total: 30.911, sample: 0.334, forward: 0.444, backward: 0.790, update: 0.190
[proc 1] 300 steps, total: 30.911, sample: 0.389, forward: 0.457, backward: 0.680, update: 0.176
W20240202 14:07:43.372009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=302, pq.top=302
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.819 ms                  | 13.228 ms                 |
| ProcessBack:UpdateCache   | 9.935 ms                  | 13.395 ms                 |
| ProcessBack:UpsertPq      | 10.048 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.183 ms                 | 44.841 ms                 |
| BlockToStepN              | 205.954 ms                | 309.266 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:44.372004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
W20240202 14:07:45.372005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=308, pq.top=308
W20240202 14:07:46.372004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240202 14:07:47.372005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=314, pq.top=314
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.538 ms                  | 24.181 ms                 |
| Forward                   | 4.779 ms                  | 12.641 ms                 |
| Backward                  | 8.831 ms                  | 18.974 ms                 |
| Optimize                  | 1.796 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.771 ms                  | 28.057 ms                 |
| AfterBackward             | 29.155 ms                 | 44.890 ms                 |
| BlockToStepN              | 208.965 ms                | 311.594 ms                |
| OneStep                   | 269.704 ms                | 383.995 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:48.372006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=317, pq.top=317
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.809 ms                  | 13.228 ms                 |
| ProcessBack:UpdateCache   | 9.924 ms                  | 13.395 ms                 |
| ProcessBack:UpsertPq      | 10.043 ms                 | 18.367 ms                 |
| ProcessOneStep            | 29.048 ms                 | 44.841 ms                 |
| BlockToStepN              | 210.139 ms                | 313.024 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:49.372004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=320, pq.top=320
W20240202 14:07:50.372009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=323, pq.top=323
W20240202 14:07:51.372014  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=326, pq.top=326
W20240202 14:07:52.372006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=329, pq.top=329
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.548 ms                  | 24.802 ms                 |
| Forward                   | 4.770 ms                  | 12.641 ms                 |
| Backward                  | 8.831 ms                  | 18.974 ms                 |
| Optimize                  | 1.802 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.957 ms                  | 28.057 ms                 |
| AfterBackward             | 29.141 ms                 | 44.890 ms                 |
| BlockToStepN              | 211.823 ms                | 324.293 ms                |
| OneStep                   | 272.416 ms                | 383.995 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:53.372004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=332, pq.top=332
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.798 ms                  | 13.028 ms                 |
| ProcessBack:UpdateCache   | 9.922 ms                  | 12.881 ms                 |
| ProcessBack:UpsertPq      | 10.048 ms                 | 18.313 ms                 |
| ProcessOneStep            | 29.110 ms                 | 44.841 ms                 |
| BlockToStepN              | 211.936 ms                | 325.613 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:54.372004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240202 14:07:55.372009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=338, pq.top=338
W20240202 14:07:56.372009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=341, pq.top=341
W20240202 14:07:57.372004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=344, pq.top=344
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.591 ms                  | 24.802 ms                 |
| Forward                   | 4.768 ms                  | 12.641 ms                 |
| Backward                  | 8.834 ms                  | 18.974 ms                 |
| Optimize                  | 1.797 ms                  | 5.269 ms                  |
| BarrierTimeBeforeRank0    | 4.029 ms                  | 28.057 ms                 |
| AfterBackward             | 29.141 ms                 | 46.895 ms                 |
| BlockToStepN              | 213.227 ms                | 325.676 ms                |
| OneStep                   | 275.842 ms                | 386.590 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:58.372005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=347, pq.top=347
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.795 ms                  | 13.228 ms                 |
| ProcessBack:UpdateCache   | 9.935 ms                  | 12.881 ms                 |
| ProcessBack:UpsertPq      | 10.048 ms                 | 18.547 ms                 |
| ProcessOneStep            | 29.110 ms                 | 46.866 ms                 |
| BlockToStepN              | 215.039 ms                | 325.613 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:07:59.372009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=350, pq.top=350
W20240202 14:08:00.372011  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=353, pq.top=353
W20240202 14:08:01.407629  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=357, pq.top=357
W20240202 14:08:02.430131  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=360, pq.top=360
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.611 ms                  | 24.181 ms                 |
| Forward                   | 4.767 ms                  | 12.438 ms                 |
| Backward                  | 8.833 ms                  | 17.822 ms                 |
| Optimize                  | 1.793 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 4.051 ms                  | 25.114 ms                 |
| AfterBackward             | 29.283 ms                 | 45.797 ms                 |
| BlockToStepN              | 216.834 ms                | 325.152 ms                |
| OneStep                   | 278.119 ms                | 383.995 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:03.447016  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=363, pq.top=363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.790 ms                  | 13.228 ms                 |
| ProcessBack:UpdateCache   | 9.938 ms                  | 12.881 ms                 |
| ProcessBack:UpsertPq      | 10.057 ms                 | 21.062 ms                 |
| ProcessOneStep            | 29.183 ms                 | 45.767 ms                 |
| BlockToStepN              | 216.983 ms                | 325.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:04.447010  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=366, pq.top=366
W20240202 14:08:05.447010  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=369, pq.top=369
W20240202 14:08:06.490146  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=372, pq.top=372
W20240202 14:08:07.506150  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.617 ms                  | 24.181 ms                 |
| Forward                   | 4.764 ms                  | 12.438 ms                 |
| Backward                  | 8.833 ms                  | 17.822 ms                 |
| Optimize                  | 1.796 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 4.159 ms                  | 25.114 ms                 |
| AfterBackward             | 29.283 ms                 | 45.797 ms                 |
| BlockToStepN              | 220.433 ms                | 325.152 ms                |
| OneStep                   | 280.891 ms                | 383.995 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:08.506004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=378, pq.top=378
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.787 ms                  | 13.028 ms                 |
| ProcessBack:UpdateCache   | 9.939 ms                  | 12.718 ms                 |
| ProcessBack:UpsertPq      | 10.070 ms                 | 19.608 ms                 |
| ProcessOneStep            | 29.183 ms                 | 45.767 ms                 |
| BlockToStepN              | 221.042 ms                | 325.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:09.558113  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240202 14:08:10.571799  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=384, pq.top=384
W20240202 14:08:11.577136  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.617 ms                  | 24.181 ms                 |
| Forward                   | 4.751 ms                  | 12.438 ms                 |
| Backward                  | 8.831 ms                  | 17.822 ms                 |
| Optimize                  | 1.795 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 4.227 ms                  | 25.114 ms                 |
| AfterBackward             | 29.155 ms                 | 45.797 ms                 |
| BlockToStepN              | 222.951 ms                | 325.676 ms                |
| OneStep                   | 282.730 ms                | 384.833 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:12.606014  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=390, pq.top=390
W20240202 14:08:13.606004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=393, pq.top=393
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.783 ms                  | 13.028 ms                 |
| ProcessBack:UpdateCache   | 9.935 ms                  | 12.718 ms                 |
| ProcessBack:UpsertPq      | 10.068 ms                 | 19.608 ms                 |
| ProcessOneStep            | 29.110 ms                 | 45.767 ms                 |
| BlockToStepN              | 223.951 ms                | 325.613 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:14.640220  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=396, pq.top=396
W20240202 14:08:15.640015  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=399, pq.top=399
[proc 6] 400 steps, total: 33.276, sample: 0.369, forward: 0.461, backward: 0.803, update: 0.180
[proc 3] 400 steps, total: 33.277, sample: 0.308, forward: 0.424, backward: 0.520, update: 0.167
[proc 4] 400 steps, total: 33.277, sample: 0.352, forward: 0.418, backward: 0.666, update: 0.172
[proc 7] 400 steps, total: 33.277, sample: 0.306, forward: 0.408, backward: 0.441, update: 0.165
[proc 0] 400 steps, total: 33.276, sample: 0.408, forward: 0.457, backward: 0.858, update: 0.186
[proc 5] 400 steps, total: 33.277, sample: 0.351, forward: 0.444, backward: 0.824, update: 0.167
[proc 1] 400 steps, total: 33.276, sample: 0.342, forward: 0.421, backward: 0.685, update: 0.162
[proc 2] 400 steps, total: 33.277, sample: 0.321, forward: 0.422, backward: 0.843, update: 0.165
W20240202 14:08:16.640005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=402, pq.top=402
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 24.181 ms                 |
| Forward                   | 4.733 ms                  | 12.438 ms                 |
| Backward                  | 8.833 ms                  | 17.822 ms                 |
| Optimize                  | 1.795 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 4.051 ms                  | 25.114 ms                 |
| AfterBackward             | 29.141 ms                 | 45.797 ms                 |
| BlockToStepN              | 227.214 ms                | 331.106 ms                |
| OneStep                   | 284.833 ms                | 386.590 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:17.640004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240202 14:08:18.640005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=408, pq.top=408
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.779 ms                  | 13.028 ms                 |
| ProcessBack:UpdateCache   | 9.920 ms                  | 12.718 ms                 |
| ProcessBack:UpsertPq      | 10.075 ms                 | 19.903 ms                 |
| ProcessOneStep            | 29.032 ms                 | 45.767 ms                 |
| BlockToStepN              | 228.158 ms                | 331.531 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:19.640005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=411, pq.top=411
W20240202 14:08:20.640012  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=414, pq.top=414
W20240202 14:08:21.640010  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=416, pq.top=416
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 24.181 ms                 |
| Forward                   | 4.732 ms                  | 12.438 ms                 |
| Backward                  | 8.835 ms                  | 17.822 ms                 |
| Optimize                  | 1.794 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.957 ms                  | 25.114 ms                 |
| AfterBackward             | 29.063 ms                 | 45.797 ms                 |
| BlockToStepN              | 230.441 ms                | 333.518 ms                |
| OneStep                   | 287.422 ms                | 402.264 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:22.640004  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240202 14:08:23.640005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=422, pq.top=422
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.778 ms                  | 13.028 ms                 |
| ProcessBack:UpdateCache   | 9.915 ms                  | 12.718 ms                 |
| ProcessBack:UpsertPq      | 10.080 ms                 | 19.903 ms                 |
| ProcessOneStep            | 29.029 ms                 | 45.767 ms                 |
| BlockToStepN              | 231.491 ms                | 351.983 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:24.640005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=425, pq.top=425
W20240202 14:08:25.640012  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240202 14:08:26.640010  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=430, pq.top=430
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 24.802 ms                 |
| Forward                   | 4.735 ms                  | 12.438 ms                 |
| Backward                  | 8.835 ms                  | 17.822 ms                 |
| Optimize                  | 1.793 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.771 ms                  | 25.114 ms                 |
| AfterBackward             | 29.078 ms                 | 45.797 ms                 |
| BlockToStepN              | 232.937 ms                | 380.819 ms                |
| OneStep                   | 289.814 ms                | 444.792 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:27.640003  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=432, pq.top=432
W20240202 14:08:28.640005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=435, pq.top=435
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.780 ms                  | 12.188 ms                 |
| ProcessBack:UpdateCache   | 9.915 ms                  | 12.667 ms                 |
| ProcessBack:UpsertPq      | 10.107 ms                 | 19.636 ms                 |
| ProcessOneStep            | 29.048 ms                 | 45.767 ms                 |
| BlockToStepN              | 233.078 ms                | 380.597 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:29.640009  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240202 14:08:30.669165  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240202 14:08:31.669005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.623 ms                  | 24.802 ms                 |
| Forward                   | 4.739 ms                  | 12.438 ms                 |
| Backward                  | 8.843 ms                  | 18.974 ms                 |
| Optimize                  | 1.795 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.762 ms                  | 25.114 ms                 |
| AfterBackward             | 29.063 ms                 | 45.797 ms                 |
| BlockToStepN              | 234.202 ms                | 381.339 ms                |
| OneStep                   | 293.648 ms                | 444.792 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:32.669003  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=446, pq.top=446
W20240202 14:08:33.669006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=449, pq.top=449
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.780 ms                  | 12.188 ms                 |
| ProcessBack:UpdateCache   | 9.910 ms                  | 12.667 ms                 |
| ProcessBack:UpsertPq      | 10.098 ms                 | 21.062 ms                 |
| ProcessOneStep            | 29.032 ms                 | 44.841 ms                 |
| BlockToStepN              | 234.830 ms                | 394.212 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:34.669005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=452, pq.top=452
W20240202 14:08:35.671000  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240202 14:08:36.720060  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=458, pq.top=458
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.628 ms                  | 24.181 ms                 |
| Forward                   | 4.744 ms                  | 12.438 ms                 |
| Backward                  | 8.843 ms                  | 17.822 ms                 |
| Optimize                  | 1.793 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.656 ms                  | 24.787 ms                 |
| AfterBackward             | 29.056 ms                 | 44.890 ms                 |
| BlockToStepN              | 236.522 ms                | 384.338 ms                |
| OneStep                   | 295.123 ms                | 444.303 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:37.720005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=460, pq.top=460
W20240202 14:08:38.720005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=463, pq.top=463
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.780 ms                  | 12.188 ms                 |
| ProcessBack:UpdateCache   | 9.907 ms                  | 12.667 ms                 |
| ProcessBack:UpsertPq      | 10.098 ms                 | 21.062 ms                 |
| ProcessOneStep            | 29.029 ms                 | 44.841 ms                 |
| BlockToStepN              | 237.222 ms                | 384.267 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:39.720006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=466, pq.top=466
W20240202 14:08:40.720011  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240202 14:08:41.740460  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=472, pq.top=472
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.628 ms                  | 24.181 ms                 |
| Forward                   | 4.735 ms                  | 12.438 ms                 |
| Backward                  | 8.843 ms                  | 17.822 ms                 |
| Optimize                  | 1.792 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.585 ms                  | 24.787 ms                 |
| AfterBackward             | 29.046 ms                 | 44.890 ms                 |
| BlockToStepN              | 239.555 ms                | 384.338 ms                |
| OneStep                   | 297.528 ms                | 444.303 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:42.740005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=474, pq.top=474
W20240202 14:08:43.740006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=477, pq.top=477
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.784 ms                  | 12.071 ms                 |
| ProcessBack:UpdateCache   | 9.901 ms                  | 12.649 ms                 |
| ProcessBack:UpsertPq      | 10.107 ms                 | 19.903 ms                 |
| ProcessOneStep            | 29.032 ms                 | 44.841 ms                 |
| BlockToStepN              | 239.666 ms                | 384.267 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:44.740005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=480, pq.top=480
W20240202 14:08:45.740005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
W20240202 14:08:46.740015  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=485, pq.top=485
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.630 ms                  | 24.181 ms                 |
| Forward                   | 4.751 ms                  | 12.438 ms                 |
| Backward                  | 8.844 ms                  | 17.822 ms                 |
| Optimize                  | 1.794 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.656 ms                  | 24.787 ms                 |
| AfterBackward             | 29.063 ms                 | 44.890 ms                 |
| BlockToStepN              | 240.779 ms                | 396.227 ms                |
| OneStep                   | 299.544 ms                | 451.148 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:47.740006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240202 14:08:48.740005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=490, pq.top=490
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.784 ms                  | 12.071 ms                 |
| ProcessBack:UpdateCache   | 9.901 ms                  | 12.649 ms                 |
| ProcessBack:UpsertPq      | 10.107 ms                 | 19.903 ms                 |
| ProcessOneStep            | 29.017 ms                 | 44.841 ms                 |
| BlockToStepN              | 242.851 ms                | 396.094 ms                |
+---------------------------+---------------------------+---------------------------+
W20240202 14:08:49.740006  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=493, pq.top=493
W20240202 14:08:50.740005  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=496, pq.top=496
W20240202 14:08:51.770258  2962 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=499, pq.top=499
[proc 6] 500 steps, total: 36.309, sample: 0.321, forward: 0.484, backward: 0.890, update: 0.185
[proc 4] 500 steps, total: 36.309, sample: 0.317, forward: 0.431, backward: 0.874, update: 0.180
[proc 3] 500 steps, total: 36.309, sample: 0.338, forward: 0.425, backward: 0.865, update: 0.174
[proc 7] 500 steps, total: 36.309, sample: 0.326, forward: 0.411, backward: 0.535, update: 0.170
[proc 5] 500 steps, total: 36.309, sample: 0.308, forward: 0.444, backward: 0.767, update: 0.174
[proc 2] 500 steps, total: 36.309, sample: 0.406, forward: 0.449, backward: 0.867, update: 0.173
[proc 1] 500 steps, total: 36.309, sample: 0.330, forward: 0.428, backward: 0.589, update: 0.169
[proc 0] 500 steps, total: 36.309, sample: 0.431, forward: 0.491, backward: 0.889, update: 0.186
Successfully xmh. training takes 147.30542635917664 seconds
before call kg_cache_controller.StopThreads()
W20240202 14:08:52.462570  2962 grad_async_v1.h:243] call StopThreads. PID = 2205
W20240202 14:08:52.462592  2962 grad_base.h:212] before processOneStepNegThread_.join();
W20240202 14:08:52.468429  2962 grad_base.h:214] after processOneStepNegThread_.join();
W20240202 14:08:52.468447  2962 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240202 14:08:52.509282  2962 grad_async_v1.h:264] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.629 ms                  | 24.181 ms                 |
| Forward                   | 4.744 ms                  | 12.438 ms                 |
| Backward                  | 8.845 ms                  | 17.822 ms                 |
| Optimize                  | 1.790 ms                  | 3.854 ms                  |
| BarrierTimeBeforeRank0    | 3.621 ms                  | 24.787 ms                 |
| AfterBackward             | 29.063 ms                 | 45.797 ms                 |
| BlockToStepN              | 244.182 ms                | 396.227 ms                |
| OneStep                   | 301.545 ms                | 451.148 ms                |
+---------------------------+---------------------------+---------------------------+
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
On rank0, prepare to call self.controller.StopThreads(), self=<python.controller_process.KGCacheControllerWrapper object at 0x7f3625056950>
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.785 ms                  | 12.071 ms                 |
| ProcessBack:UpdateCache   | 9.901 ms                  | 12.649 ms                 |
| ProcessBack:UpsertPq      | 10.110 ms                 | 21.062 ms                 |
| ProcessOneStep            | 29.032 ms                 | 45.767 ms                 |
| BlockToStepN              | 244.133 ms                | 396.094 ms                |
+---------------------------+---------------------------+---------------------------+
