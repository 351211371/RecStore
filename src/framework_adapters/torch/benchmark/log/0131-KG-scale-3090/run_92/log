WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240204 03:22:22.185204 64334 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_86', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [64334 sampler.py:454] Start PreSampling
WARNING [64334 sampler.py:532] Before construct renumbering_dict
WARNING [64334 sampler.py:555] PreSampling done
W20240204 03:42:52.705915 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240204 03:42:52.706111 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240204 03:42:52.706156 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240204 03:42:52.706195 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240204 03:42:52.706241 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240204 03:42:52.706274 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240204 03:42:52.706310 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240204 03:42:52.706348 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240204 03:42:52.706382 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240204 03:42:52.706414 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240204 03:42:52.706457 64334 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240204 03:42:52.706490 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240204 03:42:52.706522 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240204 03:42:52.706688 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240204 03:42:52.706732 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240204 03:42:52.706761 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240204 03:42:52.706802 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240204 03:42:52.706833 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240204 03:42:52.706866 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240204 03:42:52.706900 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240204 03:42:52.706936 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240204 03:42:52.706970 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240204 03:42:52.707005 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240204 03:42:52.707037 64334 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240204 03:42:52.707062 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240204 03:42:52.707085 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240204 03:42:52.707150 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240204 03:42:52.707185 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240204 03:42:52.707212 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240204 03:42:52.707244 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240204 03:42:52.707273 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240204 03:42:52.707307 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240204 03:42:52.707340 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240204 03:42:52.707373 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240204 03:42:52.707408 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240204 03:42:52.707435 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240204 03:42:52.707463 64334 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240204 03:42:52.707485 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240204 03:42:52.707515 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240204 03:42:52.707580 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240204 03:42:52.707620 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240204 03:42:52.707657 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240204 03:42:52.707696 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240204 03:42:52.707734 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240204 03:42:52.707767 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240204 03:42:52.707803 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240204 03:42:52.707839 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240204 03:42:52.707870 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240204 03:42:52.707903 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240204 03:42:52.707938 64334 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240204 03:42:52.707962 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240204 03:42:52.707994 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240204 03:42:52.708088 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240204 03:42:52.708122 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240204 03:42:52.708151 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240204 03:42:52.708180 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240204 03:42:52.708214 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240204 03:42:52.708247 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240204 03:42:52.708276 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240204 03:42:52.708305 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240204 03:42:52.708339 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240204 03:42:52.708376 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240204 03:42:52.708410 64334 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240204 03:42:52.708434 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240204 03:42:52.708458 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240204 03:42:52.708510 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100017df6000 7.629 MB
W20240204 03:42:52.708541 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x100018599000 7.629 MB
W20240204 03:42:52.708576 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x100018d3c000 7.629 MB
W20240204 03:42:52.708607 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000194df000 7.629 MB
W20240204 03:42:52.708645 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x100019c82000 7.629 MB
W20240204 03:42:52.708678 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x10001a425000 7.629 MB
W20240204 03:42:52.708712 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10001abc8000 7.629 MB
W20240204 03:42:52.708750 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x10001b36b000 7.629 MB
W20240204 03:42:52.708786 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x10001bb0e000 7.629 MB
W20240204 03:42:52.708815 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x10001c2b1000 7.629 MB
W20240204 03:42:52.708848 64334 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x10001ca54000 80 B 
W20240204 03:42:52.708873 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x10001ca56000 8 B 
W20240204 03:42:52.708897 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10001ca58000 8 B 
W20240204 03:42:52.708953 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10001ca5a000 7.629 MB
W20240204 03:42:52.708995 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10001d1fd000 7.629 MB
W20240204 03:42:52.709025 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10001d9a0000 7.629 MB
W20240204 03:42:52.709056 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10001e143000 7.629 MB
W20240204 03:42:52.709086 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10001e8e6000 7.629 MB
W20240204 03:42:52.709120 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10001f089000 7.629 MB
W20240204 03:42:52.709151 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10001f82c000 7.629 MB
W20240204 03:42:52.709184 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10001ffcf000 7.629 MB
W20240204 03:42:52.709220 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x100020772000 7.629 MB
W20240204 03:42:52.709254 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x100020f15000 7.629 MB
W20240204 03:42:52.709293 64334 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000216b8000 80 B 
W20240204 03:42:52.709328 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000216ba000 8 B 
W20240204 03:42:52.709352 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000216bc000 8 B 
W20240204 03:42:52.709405 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000216be000 7.629 MB
W20240204 03:42:52.709444 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x100021e61000 7.629 MB
W20240204 03:42:52.709479 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x100022604000 7.629 MB
W20240204 03:42:52.709508 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x100022da7000 7.629 MB
W20240204 03:42:52.709542 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10002354a000 7.629 MB
W20240204 03:42:52.709573 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x100023ced000 7.629 MB
W20240204 03:42:52.709614 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x100024490000 7.629 MB
W20240204 03:42:52.709652 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100024c33000 7.629 MB
W20240204 03:42:52.709684 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000253d6000 7.629 MB
W20240204 03:42:52.709725 64334 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x100025b79000 7.629 MB
W20240204 03:42:52.709757 64334 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x10002631c000 80 B 
W20240204 03:42:52.709781 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x10002631e000 8 B 
W20240204 03:42:52.709811 64334 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100026320000 8 B 
W20240204 03:42:53.140887 64334 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100026322000 128.2 GB
W20240204 03:51:31.184495 64334 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102034f5a000 328.3 MB
{0: Graph(num_nodes=18863774, num_edges=55186826,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13493829, num_edges=51786811,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12506959, num_edges=45797296,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12605014, num_edges=52067933,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=14435508, num_edges=39101576,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=13252778, num_edges=37365728,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=14444909, num_edges=60122064,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=14493336, num_edges=37760331,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18863774 N 55186826 E
MertisPartition: part 1 has 13493829 N 51786811 E
MertisPartition: part 2 has 12506959 N 45797296 E
MertisPartition: part 3 has 12605014 N 52067933 E
MertisPartition: part 4 has 14435508 N 39101576 E
MertisPartition: part 5 has 13252778 N 37365728 E
MertisPartition: part 6 has 14444909 N 60122064 E
MertisPartition: part 7 has 14493336 N 37760331 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 39512110,  9797409, 32293938]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
After renumbering graph:  {'_ID': tensor([ 4302716,  4302743,    89605,  ..., 53588237, 49114752,  5199485]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 6, 6, 6])}
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18863774, num_edges=55186826,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2256.166 seconds
[Rank1] pid = 31319
[Rank2] pid = 31415
[Rank3] pid = 31483
[Rank4] pid = 31550
[Rank5] pid = 31683
[Rank6] pid = 31848
INFO [64334 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [31319 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [31415 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [31483 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [31550 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [31848 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [31683 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [32034 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [31415 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31550 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [32034 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31848 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31683 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31483 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [64334 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [31319 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240204 04:00:10.930452 31416 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240204 04:00:10.932916 32145 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240204 04:00:10.933955 31320 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240204 04:00:10.934166 31863 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240204 04:00:10.934428 31484 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240204 04:00:10.934464 31712 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240204 04:00:10.934590 31551 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240204 04:00:10.934590 32058 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240204 04:00:11.015139 31416 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1020497a3000 7.629 MB
W20240204 04:00:11.015448 31416 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x102049f54000 7.629 MB
W20240204 04:00:11.015470 32145 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10204a6f7000 7.629 MB
W20240204 04:00:11.015480 31484 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10204ae9a000 7.629 MB
W20240204 04:00:11.015484 31320 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10204b63d000 7.629 MB
W20240204 04:00:11.015488 31863 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x10204bde0000 7.629 MB
W20240204 04:00:11.015493 31712 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10204c583000 7.629 MB
W20240204 04:00:11.015516 32058 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10204d4c9000 7.629 MB
W20240204 04:00:11.015513 31551 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x10204cd26000 7.629 MB
W20240204 04:00:11.015568 31416 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10204dc6c000 1.49 GB
W20240204 04:00:11.015612 31416 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1020ad24f000 1.49 GB
W20240204 04:00:11.015661 31416 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 04:00:11.017480 31484 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x10210c832000 7.629 MB
W20240204 04:00:11.017493 31863 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10210cfd5000 7.629 MB
W20240204 04:00:11.017514 32145 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10210d778000 7.629 MB
W20240204 04:00:11.017546 31320 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x10210df1b000 7.629 MB
W20240204 04:00:11.017566 31551 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x10210e6be000 7.629 MB
W20240204 04:00:11.017578 32145 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10210ee63000 1.49 GB
W20240204 04:00:11.017599 31863 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 400]0x10216e446000 1.49 GB
W20240204 04:00:11.017606 31484 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1021cda29000 1.49 GB
W20240204 04:00:11.017627 32145 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10222d00c000 1.49 GB
W20240204 04:00:11.017661 31320 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10228c5ef000 1.49 GB
W20240204 04:00:11.017668 31863 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 400]0x1022ebbd2000 1.49 GB
W20240204 04:00:11.017676 31712 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10234b1b5000 7.629 MB
W20240204 04:00:11.017686 32058 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x10234b958000 7.629 MB
W20240204 04:00:11.017709 31484 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10234c0fb000 1.49 GB
W20240204 04:00:11.017711 32145 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 04:00:11.017722 31416 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240204 04:00:11.017727 31551 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1023ab6de000 1.49 GB
W20240204 04:00:11.017733 31320 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10240acc1000 1.49 GB
W20240204 04:00:11.017761 31863 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 04:00:11.017762 31484 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 04:00:11.017776 31712 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 400]0x10246a2a4000 1.49 GB
W20240204 04:00:11.017823 32058 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 400]0x1024c9887000 1.49 GB
W20240204 04:00:11.017830 31551 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x102528e6a000 1.49 GB
W20240204 04:00:11.017844 31320 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 04:00:11.017853 31712 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 400]0x10258844d000 1.49 GB
W20240204 04:00:11.017894 31712 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 04:00:11.017896 32058 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 400]0x1025e7a30000 1.49 GB
W20240204 04:00:11.017906 31551 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 04:00:11.017966 32058 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 400]; dev=7; size=1.49 GB
W20240204 04:00:11.031736 32145 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240204 04:00:11.031801 31320 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240204 04:00:11.031806 31863 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 400]; dev=6; size=1.49 GB
W20240204 04:00:11.031816 31484 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240204 04:00:11.031826 31712 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 400]; dev=5; size=1.49 GB
W20240204 04:00:11.031841 31551 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240204 04:00:11.031841 32058 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 400]; dev=7; size=1.49 GB
cudaHostRegister 0x100026322000
2: KnownLocalCachedEmbedding init done
WARNING [31415 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
7: KnownLocalCachedEmbedding init done
WARNING [32034 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
1: KnownLocalCachedEmbedding init done
WARNING [31319 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank7] pid = 32034
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100026322000
0: KnownLocalCachedEmbedding init done
WARNING [64334 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
4: KnownLocalCachedEmbedding init done
WARNING [31550 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
6: KnownLocalCachedEmbedding init done
WARNING [31848 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
5: KnownLocalCachedEmbedding init done
WARNING [31683 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100026322000
3: KnownLocalCachedEmbedding init done
WARNING [31483 DistTensor.py:59] The tensor name already exists in the kvstore
I20240204 04:01:02.083573 31484 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240204 04:01:02.084110 31863 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 04:01:02.084230 31551 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 04:01:02.084416 31320 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 04:01:02.084600 31712 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 04:01:02.084697 32145 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 04:01:02.084932 31416 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240204 04:01:02.085180 32058 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240204 04:01:02.089208 32145 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240204 04:01:02.089558 32145 grad_base.h:184] Init GradProcessingBase done
I20240204 04:01:14.584457 32145 grad_async_v1.h:203] Use main thread to update emb.
W20240204 04:01:14.584573 32145 kg_controller.h:75] after init GradAsyncProcessing
I20240204 04:01:14.584581 32145 kg_controller.h:84] Construct KGCacheController done
E20240204 04:01:15.404930 31712 recstore.cc:66] init folly done
E20240204 04:01:15.404948 32145 recstore.cc:66] init folly done
E20240204 04:01:15.405023 31551 recstore.cc:66] init folly done
E20240204 04:01:15.405058 31416 recstore.cc:66] init folly done
E20240204 04:01:15.405066 31863 recstore.cc:66] init folly done
E20240204 04:01:15.405124 31484 recstore.cc:66] init folly done
E20240204 04:01:15.405129 31320 recstore.cc:66] init folly done
E20240204 04:01:15.405160 32058 recstore.cc:66] init folly done
I20240204 04:01:15.406455 32145 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240204 04:01:37.360818 32058 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
I20240204 04:01:37.374255 31712 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 04:01:37.646669 31551 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 04:01:38.483249 31416 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 04:01:39.568574 31484 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 04:01:39.731472 31320 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 04:01:40.195371 32145 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240204 04:01:40.573879 31863 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 29.488 ms                 | 29.488 ms                 |
| Forward                   | 734.972 ms                | 734.972 ms                |
| Backward                  | 219.940 ms                | 219.940 ms                |
| Optimize                  | 4.926 ms                  | 4.926 ms                  |
| BarrierTimeBeforeRank0    | 50.555 ms                 | 50.555 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240204 04:01:42.993758 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240204 04:01:43.749740 32145 grad_async_v1.h:533] Stalled in ProcessBackward: rank=6, step_no=1, sample_step_cpp_seen_[rank]=0
W20240204 04:01:44.036661 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=3, pq.top=3
W20240204 04:01:45.036007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.768 ms                  | 370.460 ms                |
| ProcessBack:UpdateCache   | 11.519 ms                 | 689.454 ms                |
| ProcessBack:UpsertPq      | 31.417 ms                 | 39.939 ms                 |
| ProcessOneStep            | 55.829 ms                 | 1.379 s                   |
| BlockToStepN              | 3.395 ms                  | 711.690 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:01:46.107280 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=7, pq.top=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 19.540 ms                 | 126.302 ms                |
| Forward                   | 5.377 ms                  | 734.972 ms                |
| Backward                  | 5.223 ms                  | 219.940 ms                |
| Optimize                  | 4.365 ms                  | 4.926 ms                  |
| BarrierTimeBeforeRank0    | 29.608 us                 | 233.273 ms                |
| AfterBackward             | 55.865 ms                 | 1.379 s                   |
| BlockToStepN              | 3.460 ms                  | 713.052 ms                |
| OneStep                   | 236.439 ms                | 3.134 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:01:47.107005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240204 04:01:48.107008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=11, pq.top=11
W20240204 04:01:49.107009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240204 04:01:50.107009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=15, pq.top=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 370.460 ms                |
| ProcessBack:UpdateCache   | 11.519 ms                 | 689.454 ms                |
| ProcessBack:UpsertPq      | 31.417 ms                 | 39.939 ms                 |
| ProcessOneStep            | 54.494 ms                 | 1.379 s                   |
| BlockToStepN              | 3.395 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:01:51.107010 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.100 ms                 | 126.302 ms                |
| Forward                   | 5.172 ms                  | 734.972 ms                |
| Backward                  | 5.045 ms                  | 219.940 ms                |
| Optimize                  | 2.910 ms                  | 4.926 ms                  |
| BarrierTimeBeforeRank0    | 33.263 us                 | 233.273 ms                |
| AfterBackward             | 54.532 ms                 | 1.379 s                   |
| BlockToStepN              | 3.460 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 3.134 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:01:52.107005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=19, pq.top=19
W20240204 04:01:53.107010 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
W20240204 04:01:54.107007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
W20240204 04:01:55.107008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=25, pq.top=25
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 370.460 ms                |
| ProcessBack:UpdateCache   | 11.547 ms                 | 689.454 ms                |
| ProcessBack:UpsertPq      | 31.417 ms                 | 43.794 ms                 |
| ProcessOneStep            | 54.494 ms                 | 1.379 s                   |
| BlockToStepN              | 3.395 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:01:56.107008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 13.012 ms                 | 126.302 ms                |
| Forward                   | 5.269 ms                  | 734.972 ms                |
| Backward                  | 5.045 ms                  | 219.940 ms                |
| Optimize                  | 2.432 ms                  | 4.926 ms                  |
| BarrierTimeBeforeRank0    | 1.657 ms                  | 233.273 ms                |
| AfterBackward             | 55.254 ms                 | 1.379 s                   |
| BlockToStepN              | 3.460 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 3.134 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:01:57.107005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=29, pq.top=29
W20240204 04:01:58.107007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240204 04:01:59.107021 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=33, pq.top=33
W20240204 04:02:00.107007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 317.514 ms                |
| ProcessBack:UpdateCache   | 11.491 ms                 | 688.153 ms                |
| ProcessBack:UpsertPq      | 33.784 ms                 | 60.582 ms                 |
| ProcessOneStep            | 57.542 ms                 | 1.379 s                   |
| BlockToStepN              | 3.395 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:01.107007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=37, pq.top=37
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 14.100 ms                 | 126.302 ms                |
| Forward                   | 5.269 ms                  | 734.972 ms                |
| Backward                  | 5.130 ms                  | 219.940 ms                |
| Optimize                  | 2.607 ms                  | 5.137 ms                  |
| BarrierTimeBeforeRank0    | 3.696 ms                  | 233.273 ms                |
| AfterBackward             | 58.430 ms                 | 1.379 s                   |
| BlockToStepN              | 3.460 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 3.134 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:02.127667 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
W20240204 04:02:03.127007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240204 04:02:04.127007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=43, pq.top=43
W20240204 04:02:05.127007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.417 ms                  | 317.514 ms                |
| ProcessBack:UpdateCache   | 11.564 ms                 | 688.153 ms                |
| ProcessBack:UpsertPq      | 34.079 ms                 | 60.582 ms                 |
| ProcessOneStep            | 57.542 ms                 | 1.379 s                   |
| BlockToStepN              | 3.395 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:06.127007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=47, pq.top=47
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.796 ms                 | 126.302 ms                |
| Forward                   | 5.172 ms                  | 734.972 ms                |
| Backward                  | 5.170 ms                  | 219.940 ms                |
| Optimize                  | 2.883 ms                  | 5.211 ms                  |
| BarrierTimeBeforeRank0    | 3.508 ms                  | 233.273 ms                |
| AfterBackward             | 55.865 ms                 | 1.379 s                   |
| BlockToStepN              | 3.654 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 3.134 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:07.127007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240204 04:02:08.127008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240204 04:02:09.127009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=53, pq.top=53
W20240204 04:02:10.127007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.426 ms                  | 317.514 ms                |
| ProcessBack:UpdateCache   | 11.434 ms                 | 688.153 ms                |
| ProcessBack:UpsertPq      | 32.770 ms                 | 60.582 ms                 |
| ProcessOneStep            | 55.423 ms                 | 209.081 ms                |
| BlockToStepN              | 3.594 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:11.127007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=57, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.328 ms                 | 124.247 ms                |
| Forward                   | 5.172 ms                  | 10.729 ms                 |
| Backward                  | 5.238 ms                  | 19.491 ms                 |
| Optimize                  | 2.883 ms                  | 5.371 ms                  |
| BarrierTimeBeforeRank0    | 3.508 ms                  | 230.341 ms                |
| AfterBackward             | 55.254 ms                 | 209.126 ms                |
| BlockToStepN              | 3.654 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:12.127005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240204 04:02:13.127008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=61, pq.top=61
W20240204 04:02:14.127007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240204 04:02:15.127007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=65, pq.top=65
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.385 ms                  | 317.514 ms                |
| ProcessBack:UpdateCache   | 11.386 ms                 | 688.153 ms                |
| ProcessBack:UpsertPq      | 32.770 ms                 | 70.097 ms                 |
| ProcessOneStep            | 55.253 ms                 | 209.081 ms                |
| BlockToStepN              | 3.594 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:16.127010 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.843 ms                  | 124.247 ms                |
| Forward                   | 5.137 ms                  | 10.729 ms                 |
| Backward                  | 5.263 ms                  | 19.491 ms                 |
| Optimize                  | 2.883 ms                  | 5.828 ms                  |
| BarrierTimeBeforeRank0    | 3.696 ms                  | 230.341 ms                |
| AfterBackward             | 55.865 ms                 | 209.126 ms                |
| BlockToStepN              | 3.654 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:17.127005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=69, pq.top=69
W20240204 04:02:18.265269 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240204 04:02:19.345376 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240204 04:02:20.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=75, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.382 ms                  | 317.514 ms                |
| ProcessBack:UpdateCache   | 11.381 ms                 | 688.153 ms                |
| ProcessBack:UpsertPq      | 33.700 ms                 | 72.074 ms                 |
| ProcessOneStep            | 57.542 ms                 | 209.081 ms                |
| BlockToStepN              | 3.594 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:21.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.036 ms                  | 126.302 ms                |
| Forward                   | 5.169 ms                  | 10.729 ms                 |
| Backward                  | 5.405 ms                  | 19.491 ms                 |
| Optimize                  | 2.838 ms                  | 5.828 ms                  |
| BarrierTimeBeforeRank0    | 4.752 ms                  | 230.341 ms                |
| AfterBackward             | 57.515 ms                 | 209.126 ms                |
| BlockToStepN              | 3.654 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:22.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=79, pq.top=79
W20240204 04:02:23.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240204 04:02:24.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=83, pq.top=83
W20240204 04:02:25.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.377 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 11.171 ms                 | 21.840 ms                 |
| ProcessBack:UpsertPq      | 33.662 ms                 | 70.097 ms                 |
| ProcessOneStep            | 55.423 ms                 | 209.081 ms                |
| BlockToStepN              | 3.594 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:26.345021 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=87, pq.top=87
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.510 ms                  | 126.302 ms                |
| Forward                   | 5.137 ms                  | 10.729 ms                 |
| Backward                  | 7.407 ms                  | 19.491 ms                 |
| Optimize                  | 2.838 ms                  | 5.959 ms                  |
| BarrierTimeBeforeRank0    | 4.752 ms                  | 230.341 ms                |
| AfterBackward             | 55.457 ms                 | 209.126 ms                |
| BlockToStepN              | 3.654 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:27.345009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240204 04:02:28.345009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=91, pq.top=91
W20240204 04:02:29.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
W20240204 04:02:30.345009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=95, pq.top=95
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.412 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 10.833 ms                 | 21.840 ms                 |
| ProcessBack:UpsertPq      | 32.838 ms                 | 70.097 ms                 |
| ProcessOneStep            | 55.423 ms                 | 209.081 ms                |
| BlockToStepN              | 3.594 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:31.345009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.935 ms                  | 126.302 ms                |
| Forward                   | 5.108 ms                  | 10.729 ms                 |
| Backward                  | 10.007 ms                 | 19.491 ms                 |
| Optimize                  | 2.838 ms                  | 5.968 ms                  |
| BarrierTimeBeforeRank0    | 4.752 ms                  | 230.341 ms                |
| AfterBackward             | 55.283 ms                 | 209.126 ms                |
| BlockToStepN              | 3.654 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:32.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=99, pq.top=99
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 53.066, sample: 1.399, forward: 1.304, backward: 0.988, update: 0.253
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 55.423, sample: 2.430, forward: 1.285, backward: 1.322, update: 0.262
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 52.224, sample: 2.614, forward: 1.318, backward: 0.713, update: 0.239
train_sampler.Prefill()
-------Step 0-------
tensor([   65812,    65845,    65893,    65926,  5986356,    93197, 56357042,
        15786136, 24256940,    65968]) tensor([ 5256735, 16580272, 52105829, 65532160, 20598023, 30570199, 42259825,
        72500965, 72835657, 24962596])
-------Step 1-------
tensor([   65812,    65845,    65893,    65926,  5986356,    93197, 56357042,
        15786136, 24256940,    65968]) tensor([60699118, 32354764, 10756080, 80125143, 82471635, 37038550, 80154835,
        42210291, 32443929, 11834441])
-------Step 2-------
tensor([  164217,   164253,   164301,    22509,   164339,   164381,   164432,
        21633785,   164485,   164528]) tensor([69557489, 27762531, 71934257, 42783521, 47737308, 32569146, 60984496,
        47083951, 12306563, 36259922])
-------Step 3-------
tensor([  164217,   164253,   164301,    22509,   164339,   164381,   164432,
        21633785,   164485,   164528]) tensor([42516988, 84497409, 30165175, 37598087, 55894044, 73057606, 31459485,
        14588084, 22579718,   691461])
-------Step 4-------
tensor([  262237, 51728409,   262268,   117373,   262304,   117395,   262352,
        39370080,   262387,   262436]) tensor([82991855,  9139129, 85738678, 18110228, 61939919, 48628111, 66934240,
        36775630, 84973771, 49366867])
-------Step 5-------
tensor([  262237, 51728409,   262268,   117373,   262304,   117395,   262352,
        39370080,   262387,   262436]) tensor([39934345, 74536760,   227287, 82971172, 50845209, 47193164, 12839626,
         8685567, 62152714, 34720704])
-------Step 6-------
tensor([  360258,    46982,   360310,   360354,    47003, 75771139,   360390,
          360424,   129338, 35556863]) tensor([13087286, 33034854, 40746873, 83847815, 37934713, 42313778, 20943935,
         6150808, 66162912, 84292161])
-------Step 7-------
tensor([  360258,    46982,   360310,   360354,    47003, 75771139,   360390,
          360424,   129338, 35556863]) tensor([28789521, 59574328, 78588800, 66595799, 71825593, 56966704, 52753663,
        48816095, 30848209, 28000768])
-------Step 8-------
tensor([  454422, 24675439,   454450,   140688,   454476,    58302,   454503,
          454528,   454557,   454582]) tensor([38595873, 28352865, 29613922,  1972088, 56442845, 75117603, 17428067,
        62811952,  1587959, 71230718])
-------Step 9-------
tensor([  454422, 24675439,   454450,   140688,   454476,    58302,   454503,
          454528,   454557,   454582]) tensor([54479583, 31376988, 12069634, 47639042,  8001797, 46774741, 26398712,
        36594160, 78442378, 75775844])
before start barrier
start train
[proc 0] 100 steps, total: 52.602, sample: 1.959, forward: 1.266, backward: 1.030, update: 0.326
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 54.314, sample: 2.270, forward: 1.288, backward: 1.225, update: 0.282
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 55.151, sample: 2.115, forward: 1.303, backward: 1.298, update: 0.272
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 55.437, sample: 1.449, forward: 1.328, backward: 1.232, update: 0.275
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 53.229, sample: 2.494, forward: 1.301, backward: 1.061, update: 0.256
W20240204 04:02:33.345010 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240204 04:02:34.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240204 04:02:35.345009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=105, pq.top=105
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.412 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 10.803 ms                 | 21.840 ms                 |
| ProcessBack:UpsertPq      | 32.900 ms                 | 73.219 ms                 |
| ProcessOneStep            | 55.829 ms                 | 209.081 ms                |
| BlockToStepN              | 3.594 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:36.345009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.843 ms                  | 126.302 ms                |
| Forward                   | 5.108 ms                  | 10.729 ms                 |
| Backward                  | 10.202 ms                 | 19.491 ms                 |
| Optimize                  | 2.828 ms                  | 6.894 ms                  |
| BarrierTimeBeforeRank0    | 5.169 ms                  | 230.341 ms                |
| AfterBackward             | 56.004 ms                 | 209.126 ms                |
| BlockToStepN              | 3.654 ms                  | 806.044 ms                |
| OneStep                   | 236.439 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:37.345006 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240204 04:02:38.345010 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
W20240204 04:02:39.345019 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=113, pq.top=113
W20240204 04:02:40.345019 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.401 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 10.769 ms                 | 21.840 ms                 |
| ProcessBack:UpsertPq      | 33.662 ms                 | 73.219 ms                 |
| ProcessOneStep            | 57.542 ms                 | 209.081 ms                |
| BlockToStepN              | 3.594 ms                  | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:41.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=117, pq.top=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.935 ms                  | 126.302 ms                |
| Forward                   | 5.121 ms                  | 10.729 ms                 |
| Backward                  | 10.213 ms                 | 19.491 ms                 |
| Optimize                  | 2.774 ms                  | 14.808 ms                 |
| BarrierTimeBeforeRank0    | 5.169 ms                  | 230.341 ms                |
| AfterBackward             | 57.398 ms                 | 209.126 ms                |
| BlockToStepN              | 40.682 ms                 | 806.044 ms                |
| OneStep                   | 236.439 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:42.345005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240204 04:02:43.345005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=121, pq.top=121
W20240204 04:02:44.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240204 04:02:45.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=125, pq.top=125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.401 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 10.736 ms                 | 21.840 ms                 |
| ProcessBack:UpsertPq      | 33.636 ms                 | 73.219 ms                 |
| ProcessOneStep            | 56.163 ms                 | 209.081 ms                |
| BlockToStepN              | 40.611 ms                 | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:46.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.570 ms                  | 126.302 ms                |
| Forward                   | 5.137 ms                  | 10.729 ms                 |
| Backward                  | 10.272 ms                 | 19.491 ms                 |
| Optimize                  | 2.774 ms                  | 14.808 ms                 |
| BarrierTimeBeforeRank0    | 5.169 ms                  | 230.341 ms                |
| AfterBackward             | 56.081 ms                 | 209.126 ms                |
| BlockToStepN              | 77.722 ms                 | 806.044 ms                |
| OneStep                   | 236.439 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:47.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240204 04:02:48.345006 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240204 04:02:49.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=133, pq.top=133
W20240204 04:02:50.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.416 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 10.469 ms                 | 13.663 ms                 |
| ProcessBack:UpsertPq      | 33.058 ms                 | 72.074 ms                 |
| ProcessOneStep            | 55.829 ms                 | 209.081 ms                |
| BlockToStepN              | 83.859 ms                 | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:51.345006 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.395 ms                  | 126.302 ms                |
| Forward                   | 5.137 ms                  | 10.729 ms                 |
| Backward                  | 10.284 ms                 | 19.491 ms                 |
| Optimize                  | 2.670 ms                  | 14.808 ms                 |
| BarrierTimeBeforeRank0    | 5.119 ms                  | 230.341 ms                |
| AfterBackward             | 55.641 ms                 | 209.126 ms                |
| BlockToStepN              | 83.929 ms                 | 806.044 ms                |
| OneStep                   | 236.439 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:52.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240204 04:02:53.345013 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=141, pq.top=141
W20240204 04:02:54.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240204 04:02:55.345008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=145, pq.top=145
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.398 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 10.415 ms                 | 13.663 ms                 |
| ProcessBack:UpsertPq      | 32.872 ms                 | 72.074 ms                 |
| ProcessOneStep            | 55.370 ms                 | 209.081 ms                |
| BlockToStepN              | 83.859 ms                 | 805.929 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:56.345006 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.259 ms                  | 126.302 ms                |
| Forward                   | 5.121 ms                  | 10.729 ms                 |
| Backward                  | 10.284 ms                 | 19.491 ms                 |
| Optimize                  | 2.670 ms                  | 14.808 ms                 |
| BarrierTimeBeforeRank0    | 5.169 ms                  | 230.341 ms                |
| AfterBackward             | 55.283 ms                 | 209.126 ms                |
| BlockToStepN              | 669.750 ms                | 806.044 ms                |
| OneStep                   | 749.925 ms                | 1.180 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:02:57.345007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=149, pq.top=149
W20240204 04:02:58.514186 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240204 04:02:59.554816 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=153, pq.top=153
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.398 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 10.398 ms                 | 13.663 ms                 |
| ProcessBack:UpsertPq      | 32.900 ms                 | 72.074 ms                 |
| ProcessOneStep            | 55.370 ms                 | 114.016 ms                |
| BlockToStepN              | 96.595 ms                 | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:00.554005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240204 04:03:01.554008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=157, pq.top=157
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.200 ms                  | 124.247 ms                |
| Forward                   | 5.121 ms                  | 8.721 ms                  |
| Backward                  | 10.293 ms                 | 18.121 ms                 |
| Optimize                  | 2.670 ms                  | 6.894 ms                  |
| BarrierTimeBeforeRank0    | 5.535 ms                  | 175.230 ms                |
| AfterBackward             | 55.641 ms                 | 114.053 ms                |
| BlockToStepN              | 96.664 ms                 | 801.573 ms                |
| OneStep                   | 236.439 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:02.565681 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240204 04:03:03.622046 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=161, pq.top=161
W20240204 04:03:04.679600 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.401 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 10.261 ms                 | 13.663 ms                 |
| ProcessBack:UpsertPq      | 33.127 ms                 | 72.074 ms                 |
| ProcessOneStep            | 55.965 ms                 | 114.016 ms                |
| BlockToStepN              | 102.146 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:05.728123 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240204 04:03:06.949314 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.385 ms                  | 124.247 ms                |
| Forward                   | 5.137 ms                  | 8.721 ms                  |
| Backward                  | 10.300 ms                 | 18.121 ms                 |
| Optimize                  | 2.670 ms                  | 6.894 ms                  |
| BarrierTimeBeforeRank0    | 5.119 ms                  | 175.230 ms                |
| AfterBackward             | 56.004 ms                 | 114.053 ms                |
| BlockToStepN              | 125.460 ms                | 801.573 ms                |
| OneStep                   | 236.439 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:07.990522 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=169, pq.top=169
W20240204 04:03:08.990005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240204 04:03:09.990006 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=173, pq.top=173
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.405 ms                  | 25.132 ms                 |
| ProcessBack:UpdateCache   | 10.261 ms                 | 13.663 ms                 |
| ProcessBack:UpsertPq      | 33.325 ms                 | 72.074 ms                 |
| ProcessOneStep            | 56.048 ms                 | 114.016 ms                |
| BlockToStepN              | 125.405 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:10.993580 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240204 04:03:12.053088 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=177, pq.top=177
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.385 ms                  | 124.247 ms                |
| Forward                   | 5.121 ms                  | 8.721 ms                  |
| Backward                  | 10.318 ms                 | 18.121 ms                 |
| Optimize                  | 2.628 ms                  | 10.120 ms                 |
| BarrierTimeBeforeRank0    | 4.752 ms                  | 175.230 ms                |
| AfterBackward             | 56.004 ms                 | 114.053 ms                |
| BlockToStepN              | 125.460 ms                | 801.573 ms                |
| OneStep                   | 236.439 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:13.108558 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240204 04:03:14.162068 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=181, pq.top=181
W20240204 04:03:15.386962 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.405 ms                  | 24.427 ms                 |
| ProcessBack:UpdateCache   | 10.246 ms                 | 13.585 ms                 |
| ProcessBack:UpsertPq      | 33.127 ms                 | 71.472 ms                 |
| ProcessOneStep            | 55.600 ms                 | 114.016 ms                |
| BlockToStepN              | 125.405 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:16.386006 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=185, pq.top=185
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.385 ms                  | 124.247 ms                |
| Forward                   | 5.121 ms                  | 8.852 ms                  |
| Backward                  | 10.321 ms                 | 18.121 ms                 |
| Optimize                  | 2.628 ms                  | 10.120 ms                 |
| BarrierTimeBeforeRank0    | 4.752 ms                  | 175.230 ms                |
| AfterBackward             | 55.540 ms                 | 114.053 ms                |
| BlockToStepN              | 125.460 ms                | 801.573 ms                |
| OneStep                   | 236.439 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:17.431938 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240204 04:03:18.519917 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=189, pq.top=189
W20240204 04:03:19.587944 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.405 ms                  | 24.427 ms                 |
| ProcessBack:UpdateCache   | 10.129 ms                 | 13.585 ms                 |
| ProcessBack:UpsertPq      | 33.127 ms                 | 71.472 ms                 |
| ProcessOneStep            | 55.507 ms                 | 114.016 ms                |
| BlockToStepN              | 669.621 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:20.670279 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=193, pq.top=193
W20240204 04:03:21.739604 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.260 ms                  | 124.247 ms                |
| Forward                   | 5.121 ms                  | 10.729 ms                 |
| Backward                  | 10.326 ms                 | 18.121 ms                 |
| Optimize                  | 2.628 ms                  | 10.120 ms                 |
| BarrierTimeBeforeRank0    | 4.814 ms                  | 175.230 ms                |
| AfterBackward             | 55.540 ms                 | 114.053 ms                |
| BlockToStepN              | 134.483 ms                | 801.573 ms                |
| OneStep                   | 236.439 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:22.807483 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=197, pq.top=197
W20240204 04:03:24.013303 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 0] 200 steps, total: 52.109, sample: 1.748, forward: 0.553, backward: 1.052, update: 0.341
[proc 7] 200 steps, total: 52.109, sample: 1.587, forward: 0.541, backward: 0.947, update: 0.265
[proc 6] 200 steps, total: 52.109, sample: 2.195, forward: 0.551, backward: 0.581, update: 0.240
[proc 2] 200 steps, total: 52.109, sample: 2.197, forward: 0.504, backward: 1.087, update: 0.262
[proc 3] 200 steps, total: 52.109, sample: 2.027, forward: 0.536, backward: 0.845, update: 0.252
[proc 4] 200 steps, total: 52.109, sample: 2.070, forward: 0.549, backward: 1.070, update: 0.259
[proc 5] 200 steps, total: 52.110, sample: 1.866, forward: 0.588, backward: 1.078, update: 0.249
[proc 1] 200 steps, total: 52.110, sample: 1.619, forward: 0.533, backward: 0.758, update: 0.266
W20240204 04:03:25.013006 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.416 ms                  | 24.427 ms                 |
| ProcessBack:UpdateCache   | 10.084 ms                 | 13.585 ms                 |
| ProcessBack:UpsertPq      | 32.954 ms                 | 71.472 ms                 |
| ProcessOneStep            | 55.423 ms                 | 114.016 ms                |
| BlockToStepN              | 143.571 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:26.056818 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=203, pq.top=203
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.218 ms                  | 124.247 ms                |
| Forward                   | 5.111 ms                  | 10.729 ms                 |
| Backward                  | 10.318 ms                 | 18.121 ms                 |
| Optimize                  | 2.670 ms                  | 10.120 ms                 |
| BarrierTimeBeforeRank0    | 4.530 ms                  | 175.230 ms                |
| AfterBackward             | 55.540 ms                 | 114.053 ms                |
| BlockToStepN              | 143.678 ms                | 801.573 ms                |
| OneStep                   | 250.032 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:27.140174 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240204 04:03:28.140007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=206, pq.top=206
W20240204 04:03:29.160939 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=208, pq.top=208
W20240204 04:03:30.195454 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=210, pq.top=210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.405 ms                  | 24.427 ms                 |
| ProcessBack:UpdateCache   | 9.943 ms                  | 13.585 ms                 |
| ProcessBack:UpsertPq      | 33.348 ms                 | 72.074 ms                 |
| ProcessOneStep            | 55.623 ms                 | 114.016 ms                |
| BlockToStepN              | 143.571 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:31.195011 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=211, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.259 ms                  | 124.247 ms                |
| Forward                   | 5.107 ms                  | 10.729 ms                 |
| Backward                  | 10.318 ms                 | 18.121 ms                 |
| Optimize                  | 2.670 ms                  | 10.120 ms                 |
| BarrierTimeBeforeRank0    | 4.450 ms                  | 175.230 ms                |
| AfterBackward             | 56.004 ms                 | 114.053 ms                |
| BlockToStepN              | 143.678 ms                | 801.573 ms                |
| OneStep                   | 250.032 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:32.195013 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240204 04:03:33.195017 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
W20240204 04:03:34.195009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=217, pq.top=217
W20240204 04:03:35.195009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.417 ms                  | 24.427 ms                 |
| ProcessBack:UpdateCache   | 9.953 ms                  | 13.585 ms                 |
| ProcessBack:UpsertPq      | 33.449 ms                 | 72.074 ms                 |
| ProcessOneStep            | 56.163 ms                 | 114.016 ms                |
| BlockToStepN              | 153.537 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:36.195008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.385 ms                  | 124.247 ms                |
| Forward                   | 5.111 ms                  | 10.729 ms                 |
| Backward                  | 10.321 ms                 | 18.121 ms                 |
| Optimize                  | 2.680 ms                  | 10.120 ms                 |
| BarrierTimeBeforeRank0    | 4.336 ms                  | 175.230 ms                |
| AfterBackward             | 56.673 ms                 | 114.053 ms                |
| BlockToStepN              | 153.589 ms                | 801.573 ms                |
| OneStep                   | 250.032 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:37.195004 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240204 04:03:38.195006 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240204 04:03:39.244513 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240204 04:03:40.321094 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=229, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.426 ms                  | 18.945 ms                 |
| ProcessBack:UpdateCache   | 10.084 ms                 | 13.311 ms                 |
| ProcessBack:UpsertPq      | 33.560 ms                 | 71.472 ms                 |
| ProcessOneStep            | 56.744 ms                 | 114.016 ms                |
| BlockToStepN              | 158.099 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:41.513163 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.384 ms                  | 124.247 ms                |
| Forward                   | 5.108 ms                  | 10.729 ms                 |
| Backward                  | 10.306 ms                 | 18.121 ms                 |
| Optimize                  | 2.679 ms                  | 10.120 ms                 |
| BarrierTimeBeforeRank0    | 4.450 ms                  | 175.230 ms                |
| AfterBackward             | 56.776 ms                 | 114.053 ms                |
| BlockToStepN              | 158.152 ms                | 801.573 ms                |
| OneStep                   | 250.032 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:42.513839 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
W20240204 04:03:43.513008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=234, pq.top=234
W20240204 04:03:44.513007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=236, pq.top=236
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.418 ms                  | 18.945 ms                 |
| ProcessBack:UpdateCache   | 10.148 ms                 | 13.311 ms                 |
| ProcessBack:UpsertPq      | 33.558 ms                 | 71.472 ms                 |
| ProcessOneStep            | 56.744 ms                 | 114.016 ms                |
| BlockToStepN              | 161.100 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:45.577452 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=238, pq.top=238
W20240204 04:03:46.577010 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=239, pq.top=239
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.257 ms                  | 124.247 ms                |
| Forward                   | 5.110 ms                  | 10.729 ms                 |
| Backward                  | 10.305 ms                 | 18.121 ms                 |
| Optimize                  | 2.680 ms                  | 10.120 ms                 |
| BarrierTimeBeforeRank0    | 4.530 ms                  | 175.230 ms                |
| AfterBackward             | 56.776 ms                 | 114.053 ms                |
| BlockToStepN              | 161.824 ms                | 801.573 ms                |
| OneStep                   | 250.032 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:47.577006 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240204 04:03:48.577010 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=243, pq.top=243
W20240204 04:03:49.577008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.427 ms                  | 18.945 ms                 |
| ProcessBack:UpdateCache   | 10.147 ms                 | 13.311 ms                 |
| ProcessBack:UpsertPq      | 33.560 ms                 | 71.472 ms                 |
| ProcessOneStep            | 56.982 ms                 | 114.016 ms                |
| BlockToStepN              | 174.539 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:50.577004 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240204 04:03:51.577008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.257 ms                  | 124.247 ms                |
| Forward                   | 5.099 ms                  | 10.729 ms                 |
| Backward                  | 10.305 ms                 | 18.121 ms                 |
| Optimize                  | 2.694 ms                  | 10.120 ms                 |
| BarrierTimeBeforeRank0    | 4.752 ms                  | 175.230 ms                |
| AfterBackward             | 57.068 ms                 | 114.053 ms                |
| BlockToStepN              | 174.600 ms                | 801.573 ms                |
| OneStep                   | 269.688 ms                | 1.155 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:52.581025 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=251, pq.top=251
W20240204 04:03:53.581008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=252, pq.top=252
W20240204 04:03:54.599736 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=254, pq.top=254
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.426 ms                  | 18.945 ms                 |
| ProcessBack:UpdateCache   | 10.130 ms                 | 13.585 ms                 |
| ProcessBack:UpsertPq      | 33.572 ms                 | 71.472 ms                 |
| ProcessOneStep            | 57.034 ms                 | 113.906 ms                |
| BlockToStepN              | 174.539 ms                | 799.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:55.599005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=255, pq.top=255
W20240204 04:03:56.599009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.211 ms                  | 124.223 ms                |
| Forward                   | 5.108 ms                  | 8.852 ms                  |
| Backward                  | 10.306 ms                 | 15.964 ms                 |
| Optimize                  | 2.679 ms                  | 6.950 ms                  |
| BarrierTimeBeforeRank0    | 4.530 ms                  | 171.513 ms                |
| AfterBackward             | 57.197 ms                 | 113.955 ms                |
| BlockToStepN              | 174.600 ms                | 799.265 ms                |
| OneStep                   | 269.688 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:03:57.599009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240204 04:03:58.599007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=261, pq.top=261
W20240204 04:03:59.599009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.427 ms                  | 18.945 ms                 |
| ProcessBack:UpdateCache   | 10.118 ms                 | 13.585 ms                 |
| ProcessBack:UpsertPq      | 33.572 ms                 | 71.472 ms                 |
| ProcessOneStep            | 57.159 ms                 | 113.906 ms                |
| BlockToStepN              | 174.539 ms                | 799.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:04:00.599004 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=265, pq.top=265
W20240204 04:04:01.599009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.200 ms                  | 124.223 ms                |
| Forward                   | 5.110 ms                  | 8.852 ms                  |
| Backward                  | 10.312 ms                 | 15.964 ms                 |
| Optimize                  | 2.679 ms                  | 6.950 ms                  |
| BarrierTimeBeforeRank0    | 4.752 ms                  | 171.513 ms                |
| AfterBackward             | 57.197 ms                 | 113.955 ms                |
| BlockToStepN              | 174.600 ms                | 799.265 ms                |
| OneStep                   | 269.688 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:04:02.599009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=268, pq.top=268
W20240204 04:04:03.599007 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=270, pq.top=270
W20240204 04:04:04.599009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.444 ms                  | 18.945 ms                 |
| ProcessBack:UpdateCache   | 9.953 ms                  | 13.585 ms                 |
| ProcessBack:UpsertPq      | 33.582 ms                 | 71.472 ms                 |
| ProcessOneStep            | 57.282 ms                 | 113.906 ms                |
| BlockToStepN              | 174.539 ms                | 799.144 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:04:05.599005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=273, pq.top=273
W20240204 04:04:06.599009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=275, pq.top=275
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.195 ms                  | 124.223 ms                |
| Forward                   | 5.111 ms                  | 8.852 ms                  |
| Backward                  | 10.305 ms                 | 15.964 ms                 |
| Optimize                  | 2.679 ms                  | 6.950 ms                  |
| BarrierTimeBeforeRank0    | 4.450 ms                  | 171.513 ms                |
| AfterBackward             | 57.398 ms                 | 113.955 ms                |
| BlockToStepN              | 669.750 ms                | 801.573 ms                |
| OneStep                   | 749.925 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:04:07.599009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240204 04:04:08.599005 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=279, pq.top=279
W20240204 04:04:09.611982 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.457 ms                  | 18.643 ms                 |
| ProcessBack:UpdateCache   | 9.943 ms                  | 13.353 ms                 |
| ProcessBack:UpsertPq      | 33.728 ms                 | 71.256 ms                 |
| ProcessOneStep            | 57.374 ms                 | 113.906 ms                |
| BlockToStepN              | 669.621 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:04:10.611008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=282, pq.top=282
W20240204 04:04:11.659756 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=284, pq.top=284
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.218 ms                  | 124.223 ms                |
| Forward                   | 5.111 ms                  | 10.729 ms                 |
| Backward                  | 10.306 ms                 | 18.121 ms                 |
| Optimize                  | 2.679 ms                  | 8.979 ms                  |
| BarrierTimeBeforeRank0    | 4.692 ms                  | 171.513 ms                |
| AfterBackward             | 57.593 ms                 | 113.955 ms                |
| BlockToStepN              | 188.085 ms                | 801.573 ms                |
| OneStep                   | 289.386 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
W20240204 04:04:12.659008 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240204 04:04:13.659010 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=287, pq.top=287
W20240204 04:04:14.659009 32145 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
Successfully xmh. training takes 155.0492136478424 seconds
before call kg_cache_controller.StopThreads()
W20240204 04:04:15.244740 32145 grad_async_v1.h:243] call StopThreads. PID = 64334
W20240204 04:04:15.244768 32145 grad_base.h:212] before processOneStepNegThread_.join();
W20240204 04:04:15.249401 32145 grad_base.h:214] after processOneStepNegThread_.join();
W20240204 04:04:15.249413 32145 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.464 ms                  | 18.643 ms                 |
| ProcessBack:UpdateCache   | 9.905 ms                  | 13.353 ms                 |
| ProcessBack:UpsertPq      | 33.728 ms                 | 71.256 ms                 |
| ProcessOneStep            | 57.558 ms                 | 113.906 ms                |
| BlockToStepN              | 187.974 ms                | 801.452 ms                |
+---------------------------+---------------------------+---------------------------+
W20240204 04:04:15.489550 32145 grad_async_v1.h:264] StopThreads done.
