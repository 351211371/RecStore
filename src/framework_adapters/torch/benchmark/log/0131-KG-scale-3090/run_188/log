WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 03:47:30.260464 50963 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_132', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=5, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=5, gpu=[0, 1, 2, 3, 4], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [50963 sampler.py:454] Start PreSampling
WARNING [50963 sampler.py:532] Before construct renumbering_dict
WARNING [50963 sampler.py:555] PreSampling done
W20240206 04:06:58.648996 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 04:06:58.649191 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 04:06:58.649233 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 04:06:58.649263 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 04:06:58.649297 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 04:06:58.649330 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 04:06:58.649369 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 04:06:58.649407 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 04:06:58.649434 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 04:06:58.649475 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 04:06:58.649509 50963 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 04:06:58.649538 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 04:06:58.649564 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 04:06:58.649726 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 04:06:58.649778 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 04:06:58.649820 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 04:06:58.649863 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 04:06:58.649888 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 04:06:58.649925 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 04:06:58.649966 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 04:06:58.650000 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 04:06:58.650034 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 04:06:58.650060 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 04:06:58.650095 50963 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 04:06:58.650117 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 04:06:58.650146 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 04:06:58.650209 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 04:06:58.650244 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 04:06:58.650274 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 04:06:58.650300 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 04:06:58.650331 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 04:06:58.650363 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 04:06:58.650395 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 04:06:58.650425 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 04:06:58.650455 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 04:06:58.650487 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 04:06:58.650519 50963 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 04:06:58.650542 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 04:06:58.650563 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 04:06:58.650627 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240206 04:06:58.650656 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240206 04:06:58.650682 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240206 04:06:58.650709 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240206 04:06:58.650738 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240206 04:06:58.650769 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240206 04:06:58.650799 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240206 04:06:58.650826 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240206 04:06:58.650862 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240206 04:06:58.650895 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240206 04:06:58.650928 50963 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240206 04:06:58.650950 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240206 04:06:58.650974 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240206 04:06:58.651032 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x100013192000 7.629 MB
W20240206 04:06:58.651063 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x100013935000 7.629 MB
W20240206 04:06:58.651090 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000140d8000 7.629 MB
W20240206 04:06:58.651119 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x10001487b000 7.629 MB
W20240206 04:06:58.651147 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x10001501e000 7.629 MB
W20240206 04:06:58.651175 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000157c1000 7.629 MB
W20240206 04:06:58.651204 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x100015f64000 7.629 MB
W20240206 04:06:58.651235 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x100016707000 7.629 MB
W20240206 04:06:58.651268 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x100016eaa000 7.629 MB
W20240206 04:06:58.651304 50963 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x10001764d000 7.629 MB
W20240206 04:06:58.651333 50963 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x100017df0000 80 B 
W20240206 04:06:58.651669 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x100017df2000 8 B 
W20240206 04:06:58.651700 50963 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100017df4000 8 B 
W20240206 04:06:59.048795 50963 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x100017df6000 128.2 GB
W20240206 04:15:32.037868 50963 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x102026a2e000 328.3 MB
{0: Graph(num_nodes=20747160, num_edges=52627628,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=22453096, num_edges=82686155,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=19237572, num_edges=68187033,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=19123946, num_edges=82521325,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=24344931, num_edges=85060575,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 20747160 N 52627628 E
MertisPartition: part 1 has 22453096 N 82686155 E
MertisPartition: part 2 has 19237572 N 68187033 E
MertisPartition: part 3 has 19123946 N 82521325 E
MertisPartition: part 4 has 24344931 N 85060575 E
Rank0: cached key size 860541
Rank1: cached key size 860541
Rank2: cached key size 860541
Rank3: cached key size 860541
Rank4: cached key size 860541
Before renumbering graph:  {'_ID': tensor([     239,      240,      265,  ..., 86036354,  5226631, 86047326]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 2])}
After renumbering graph:  {'_ID': tensor([ 4310118,  4310144,   580862,  ...,  2097999, 80949806, 85819256]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 1, 2])}
part_g: DGLGraph(num_nodes=20747160, num_edges=52627628,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=20747160, num_edges=52627628,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2186.272 seconds
[Rank1] pid = 52228
[Rank2] pid = 52324
[Rank3] pid = 52394
INFO [50963 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [52228 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [52324 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [52394 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [52461 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [52324 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [52461 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [52394 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [50963 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
INFO [52228 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 5 nodes.
W20240206 04:24:03.217213 52325 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240206 04:24:03.217903 52462 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240206 04:24:03.218842 52525 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240206 04:24:03.219920 52395 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240206 04:24:03.219918 52229 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240206 04:24:03.274152 52462 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10203b27f000 7.629 MB
W20240206 04:24:03.274274 52395 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10203ba22000 7.629 MB
W20240206 04:24:03.274338 52462 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10203c1c5000 7.629 MB
W20240206 04:24:03.274399 52229 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10203c968000 7.629 MB
W20240206 04:24:03.274420 52462 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10203d10b000 1.49 GB
W20240206 04:24:03.274474 52462 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10209c6ee000 1.49 GB
W20240206 04:24:03.274504 52325 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1020fbcd1000 7.629 MB
W20240206 04:24:03.274510 52525 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1020fc474000 7.629 MB
W20240206 04:24:03.274518 52395 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1020fcc17000 7.629 MB
W20240206 04:24:03.274529 52462 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 04:24:03.274605 52395 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 400]0x1020fd3ba000 1.49 GB
W20240206 04:24:03.274648 52395 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x10215c99d000 1.49 GB
W20240206 04:24:03.274686 52395 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 04:24:03.277434 52525 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1021bbf80000 7.629 MB
W20240206 04:24:03.277493 52325 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1021bc723000 7.629 MB
W20240206 04:24:03.277505 52229 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1021bcec6000 7.629 MB
W20240206 04:24:03.277554 52525 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 400]0x1021bd669000 1.49 GB
W20240206 04:24:03.277581 52325 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x10221cc4c000 1.49 GB
W20240206 04:24:03.277588 52229 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x10227c22f000 1.49 GB
W20240206 04:24:03.277611 52525 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 400]0x1022db812000 1.49 GB
W20240206 04:24:03.277638 52325 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10233adf7000 1.49 GB
W20240206 04:24:03.277650 52229 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10239a3da000 1.49 GB
W20240206 04:24:03.277689 52325 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240206 04:24:03.277693 52229 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 04:24:03.277704 52525 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 04:24:03.277706 52462 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240206 04:24:03.277807 52395 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240206 04:24:03.285504 52229 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240206 04:24:03.287207 52525 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 400]; dev=4; size=1.49 GB
W20240206 04:24:03.287215 52325 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
cudaHostRegister 0x100017df6000
4: KnownLocalCachedEmbedding init done
WARNING [52461 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
2: KnownLocalCachedEmbedding init done
WARNING [52324 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank4] pid = 52461
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535)]
cudaHostRegister 0x100017df6000
0: KnownLocalCachedEmbedding init done
WARNING [50963 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
1: KnownLocalCachedEmbedding init done
WARNING [52228 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x100017df6000
3: KnownLocalCachedEmbedding init done
WARNING [52394 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 04:24:40.220196 52395 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 5
I20240206 04:24:40.220329 52229 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240206 04:24:40.220464 52325 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240206 04:24:40.220554 52462 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
I20240206 04:24:40.220693 52525 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 5
W20240206 04:24:40.222911 52462 grad_base.h:55] KGCacheController, config={
        "num_gpus": 5,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240206 04:24:40.223207 52462 grad_base.h:184] Init GradProcessingBase done
I20240206 04:24:53.493233 52462 grad_async_v1.h:203] Use main thread to update emb.
W20240206 04:24:53.493397 52462 kg_controller.h:75] after init GradAsyncProcessing
I20240206 04:24:53.493408 52462 kg_controller.h:84] Construct KGCacheController done
E20240206 04:24:55.021200 52325 recstore.cc:66] init folly done
E20240206 04:24:55.021245 52462 recstore.cc:66] init folly done
E20240206 04:24:55.021255 52229 recstore.cc:66] init folly done
E20240206 04:24:55.021255 52525 recstore.cc:66] init folly done
E20240206 04:24:55.021257 52395 recstore.cc:66] init folly done
I20240206 04:24:55.022392 52462 grad_base.h:60] GraphEnv RegTensorsPerProcess
I20240206 04:25:11.251430 52462 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 5
I20240206 04:25:13.998226 52325 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240206 04:25:16.233336 52395 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240206 04:25:16.442638 52525 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
I20240206 04:25:16.717931 52229 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 5
W20240206 04:25:18.507287 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=1, pq.top=1
E20240206 04:25:18.915254 52637 grad_async_v1.h:533] Stalled in ProcessBackward: rank=1, step_no=1, sample_step_cpp_seen_[rank]=0
W20240206 04:25:19.641234 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=5, pq.top=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.211 ms                  | 204.969 ms                |
| ProcessBack:UpdateCache   | 4.115 ms                  | 370.421 ms                |
| ProcessBack:UpsertPq      | 27.624 ms                 | 32.240 ms                 |
| ProcessOneStep            | 40.327 ms                 | 746.365 ms                |
| BlockToStepN              | 368.392 ms                | 396.446 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 10.559 ms                 | 111.117 ms                |
| Forward                   | 6.273 ms                  | 755.511 ms                |
| Backward                  | 11.627 ms                 | 260.129 ms                |
| Optimize                  | 2.955 ms                  | 4.809 ms                  |
| BarrierTimeBeforeRank0    | 133.446 us                | 3.956 ms                  |
| AfterBackward             | 39.048 ms                 | 746.514 ms                |
| BlockToStepN              | 69.266 us                 | 396.558 ms                |
| OneStep                   | 151.946 ms                | 2.161 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:20.868721 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240206 04:25:21.868007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=13, pq.top=13
W20240206 04:25:22.938587 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=17, pq.top=17
W20240206 04:25:24.045183 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=21, pq.top=21
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.211 ms                  | 204.969 ms                |
| ProcessBack:UpdateCache   | 4.074 ms                  | 370.421 ms                |
| ProcessBack:UpsertPq      | 26.677 ms                 | 38.446 ms                 |
| ProcessOneStep            | 38.426 ms                 | 746.365 ms                |
| BlockToStepN              | 11.626 us                 | 443.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:25.045006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=23, pq.top=23
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.246 ms                  | 111.117 ms                |
| Forward                   | 6.034 ms                  | 755.511 ms                |
| Backward                  | 11.096 ms                 | 260.129 ms                |
| Optimize                  | 2.903 ms                  | 13.914 ms                 |
| BarrierTimeBeforeRank0    | 58.579 us                 | 44.156 ms                 |
| AfterBackward             | 38.467 ms                 | 746.514 ms                |
| BlockToStepN              | 343.059 ms                | 443.090 ms                |
| OneStep                   | 410.412 ms                | 2.161 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:26.045008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=27, pq.top=27
W20240206 04:25:27.045008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=31, pq.top=31
W20240206 04:25:28.075573 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=35, pq.top=35
W20240206 04:25:29.339143 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=39, pq.top=39
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.211 ms                  | 181.798 ms                |
| ProcessBack:UpdateCache   | 4.049 ms                  | 369.393 ms                |
| ProcessBack:UpsertPq      | 27.132 ms                 | 54.918 ms                 |
| ProcessOneStep            | 38.426 ms                 | 746.365 ms                |
| BlockToStepN              | 11.626 us                 | 443.037 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 4.906 ms                  | 118.939 ms                |
| Forward                   | 5.524 ms                  | 755.511 ms                |
| Backward                  | 10.488 ms                 | 260.129 ms                |
| Optimize                  | 2.861 ms                  | 13.914 ms                 |
| BarrierTimeBeforeRank0    | 49.634 us                 | 56.540 ms                 |
| AfterBackward             | 38.467 ms                 | 746.514 ms                |
| BlockToStepN              | 69.266 us                 | 443.090 ms                |
| OneStep                   | 176.660 ms                | 2.161 s                   |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:30.339005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=41, pq.top=41
W20240206 04:25:31.339007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=45, pq.top=45
W20240206 04:25:32.389971 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240206 04:25:33.389005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=51, pq.top=51
W20240206 04:25:34.389006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=55, pq.top=55
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.155 ms                  | 181.798 ms                |
| ProcessBack:UpdateCache   | 4.049 ms                  | 369.393 ms                |
| ProcessBack:UpsertPq      | 27.042 ms                 | 56.891 ms                 |
| ProcessOneStep            | 39.229 ms                 | 123.908 ms                |
| BlockToStepN              | 11.626 us                 | 435.075 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.246 ms                  | 118.939 ms                |
| Forward                   | 5.412 ms                  | 15.162 ms                 |
| Backward                  | 10.440 ms                 | 13.133 ms                 |
| Optimize                  | 2.861 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 38.735 us                 | 44.156 ms                 |
| AfterBackward             | 39.270 ms                 | 123.950 ms                |
| BlockToStepN              | 69.266 us                 | 435.307 ms                |
| OneStep                   | 176.660 ms                | 600.519 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:35.429755 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=59, pq.top=59
W20240206 04:25:36.520524 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240206 04:25:37.603121 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=67, pq.top=67
W20240206 04:25:38.785732 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240206 04:25:39.785010 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=73, pq.top=73
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.131 ms                  | 181.798 ms                |
| ProcessBack:UpdateCache   | 4.054 ms                  | 369.393 ms                |
| ProcessBack:UpsertPq      | 26.199 ms                 | 56.891 ms                 |
| ProcessOneStep            | 38.832 ms                 | 123.908 ms                |
| BlockToStepN              | 11.626 us                 | 435.075 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.406 ms                  | 118.939 ms                |
| Forward                   | 5.253 ms                  | 15.162 ms                 |
| Backward                  | 10.360 ms                 | 13.133 ms                 |
| Optimize                  | 2.719 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 34.599 us                 | 44.156 ms                 |
| AfterBackward             | 38.861 ms                 | 123.950 ms                |
| BlockToStepN              | 69.266 us                 | 435.307 ms                |
| OneStep                   | 176.660 ms                | 600.519 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:40.785009 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=77, pq.top=77
W20240206 04:25:41.785008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=81, pq.top=81
W20240206 04:25:42.785007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=85, pq.top=85
W20240206 04:25:43.935073 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240206 04:25:45.005172 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.077 ms                  | 15.097 ms                 |
| ProcessBack:UpdateCache   | 4.074 ms                  | 15.362 ms                 |
| ProcessBack:UpsertPq      | 25.746 ms                 | 54.918 ms                 |
| ProcessOneStep            | 38.832 ms                 | 123.908 ms                |
| BlockToStepN              | 11.626 us                 | 435.075 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.852 ms                  | 118.939 ms                |
| Forward                   | 5.189 ms                  | 15.162 ms                 |
| Backward                  | 10.336 ms                 | 13.133 ms                 |
| Optimize                  | 2.607 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 30.607 us                 | 44.156 ms                 |
| AfterBackward             | 38.861 ms                 | 123.950 ms                |
| BlockToStepN              | 69.266 us                 | 435.307 ms                |
| OneStep                   | 176.660 ms                | 600.519 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:46.074896 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=97, pq.top=97
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 30.883, sample: 1.380, forward: 1.105, backward: 1.107, update: 0.237
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 30.674, sample: 1.496, forward: 1.026, backward: 1.282, update: 0.237
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 30.398, sample: 1.354, forward: 1.089, backward: 1.297, update: 0.235
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 33.118, sample: 1.318, forward: 1.089, backward: 1.292, update: 0.246
train_sampler.Prefill()
-------Step 0-------
tensor([ 4313056,   187145,   697480,   187175,   187194,   187219,   697492,
          187243, 37124558,   697503]) tensor([ 7874613, 16353070,   668565, 85420981,   768312, 41772998, 67184580,
        32142644, 59655785, 63828521])
-------Step 1-------
tensor([ 4313056,   187145,   697480,   187175,   187194,   187219,   697492,
          187243, 37124558,   697503]) tensor([85601167, 68105352, 17654667, 49232687, 43658037,   229786, 26464871,
        83464682,  6342634, 47378147])
-------Step 2-------
tensor([  247261,   247289,   247317,   247342, 20157326, 73110429,   247372,
          247399,   247418,   247440]) tensor([48665879, 16235222, 12854151,  4328364, 33499689, 49253279, 52909646,
        73772513, 16919495, 75325387])
-------Step 3-------
tensor([  247261,   247289,   247317,   247342, 20157326, 73110429,   247372,
          247399,   247418,   247440]) tensor([ 8222457, 12696885, 56202508, 70500792, 28543075, 59416908, 28147794,
           34498, 57744454, 38835322])
-------Step 4-------
tensor([26515105,   307190,   307203,   307235,   307253,   307276,   307304,
          317461,   307329,   307354]) tensor([39290674, 41925700, 64833373, 17621268, 65939798, 53809992, 76425854,
        74803165, 62011069, 84201474])
-------Step 5-------
tensor([26515105,   307190,   307203,   307235,   307253,   307276,   307304,
          317461,   307329,   307354]) tensor([72564718, 44232137, 14643689, 48891804, 15675055, 35141550, 45943241,
        74845892, 81824342,  9822573])
-------Step 6-------
tensor([  367686, 15010366,   367707,   367739,   367762,   707409,   367792,
          707423,   367816,   367851]) tensor([10064503, 20722953, 67850962,   178040, 10407149, 31403898, 75072487,
        51347973, 68840839, 44116187])
-------Step 7-------
tensor([  367686, 15010366,   367707,   367739,   367762,   707409,   367792,
          707423,   367816,   367851]) tensor([ 3970070, 22115253, 68118062, 44002753, 21395718, 59602502, 24362324,
        30028246,  9420620,  6897079])
-------Step 8-------
tensor([ 4961843,   426869,  4313056,   426902,   426920,   426945,   426979,
          426997,   427028, 67643154]) tensor([15031046, 72707129, 71311421, 53777713, 53315490,  1433125, 57902255,
          430298, 55571375, 46765078])
-------Step 9-------
tensor([ 4961843,   426869,  4313056,   426902,   426920,   426945,   426979,
          426997,   427028, 67643154]) tensor([53363043, 79025963, 37378561, 81746165, 21979982, 42743097, 28945429,
        72981242, 80248454,   171160])
before start barrier
start train
[proc 0] 100 steps, total: 35.865, sample: 2.085, forward: 1.287, backward: 1.297, update: 0.320
W20240206 04:25:47.179076 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=101, pq.top=101
W20240206 04:25:48.179008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240206 04:25:49.179008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=107, pq.top=107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.077 ms                  | 15.097 ms                 |
| ProcessBack:UpdateCache   | 4.049 ms                  | 15.362 ms                 |
| ProcessBack:UpsertPq      | 25.974 ms                 | 64.514 ms                 |
| ProcessOneStep            | 39.091 ms                 | 123.908 ms                |
| BlockToStepN              | 11.626 us                 | 435.075 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:50.207401 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=111, pq.top=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.241 ms                  | 118.939 ms                |
| Forward                   | 5.188 ms                  | 15.162 ms                 |
| Backward                  | 10.318 ms                 | 13.357 ms                 |
| Optimize                  | 2.614 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 29.976 us                 | 44.156 ms                 |
| AfterBackward             | 39.155 ms                 | 123.950 ms                |
| BlockToStepN              | 69.266 us                 | 435.307 ms                |
| OneStep                   | 176.660 ms                | 600.519 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:51.264060 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=115, pq.top=115
W20240206 04:25:52.495304 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=119, pq.top=119
W20240206 04:25:53.651685 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240206 04:25:54.695163 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=127, pq.top=127
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.077 ms                  | 12.224 ms                 |
| ProcessBack:UpdateCache   | 4.013 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 26.067 ms                 | 64.514 ms                 |
| ProcessOneStep            | 39.091 ms                 | 123.908 ms                |
| BlockToStepN              | 11.626 us                 | 435.075 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.262 ms                  | 135.316 ms                |
| Forward                   | 5.147 ms                  | 15.162 ms                 |
| Backward                  | 10.324 ms                 | 15.293 ms                 |
| Optimize                  | 2.691 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 30.676 us                 | 44.156 ms                 |
| AfterBackward             | 39.048 ms                 | 123.950 ms                |
| BlockToStepN              | 69.266 us                 | 435.307 ms                |
| OneStep                   | 176.660 ms                | 600.519 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:25:55.713963 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=131, pq.top=131
W20240206 04:25:56.824823 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240206 04:25:57.882902 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=139, pq.top=139
W20240206 04:25:58.890440 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=143, pq.top=143
W20240206 04:25:59.933015 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=147, pq.top=147
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.939 ms                  | 12.224 ms                 |
| ProcessBack:UpdateCache   | 4.005 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 24.948 ms                 | 64.514 ms                 |
| ProcessOneStep            | 38.002 ms                 | 123.908 ms                |
| BlockToStepN              | 11.626 us                 | 435.075 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.823 ms                  | 135.316 ms                |
| Forward                   | 5.132 ms                  | 15.162 ms                 |
| Backward                  | 10.357 ms                 | 15.293 ms                 |
| Optimize                  | 2.607 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 32.259 us                 | 44.156 ms                 |
| AfterBackward             | 38.036 ms                 | 123.950 ms                |
| BlockToStepN              | 69.266 us                 | 435.307 ms                |
| OneStep                   | 176.660 ms                | 600.519 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:01.039525 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=151, pq.top=151
W20240206 04:26:02.080716 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=155, pq.top=155
W20240206 04:26:03.143930 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240206 04:26:04.171183 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=163, pq.top=163
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.863 ms                  | 12.224 ms                 |
| ProcessBack:UpdateCache   | 4.006 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 24.237 ms                 | 64.514 ms                 |
| ProcessOneStep            | 36.921 ms                 | 102.669 ms                |
| BlockToStepN              | 11.626 us                 | 434.813 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.403 ms                  | 118.939 ms                |
| Forward                   | 5.098 ms                  | 12.691 ms                 |
| Backward                  | 10.407 ms                 | 13.389 ms                 |
| Optimize                  | 2.578 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 32.023 us                 | 26.944 ms                 |
| AfterBackward             | 36.837 ms                 | 102.709 ms                |
| BlockToStepN              | 69.266 us                 | 434.876 ms                |
| OneStep                   | 176.660 ms                | 593.627 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:05.265311 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=167, pq.top=167
W20240206 04:26:06.373890 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240206 04:26:07.469408 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240206 04:26:08.511301 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=179, pq.top=179
W20240206 04:26:09.617676 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=183, pq.top=183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.735 ms                  | 12.224 ms                 |
| ProcessBack:UpdateCache   | 4.006 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 23.029 ms                 | 61.624 ms                 |
| ProcessOneStep            | 36.241 ms                 | 102.669 ms                |
| BlockToStepN              | 11.626 us                 | 434.813 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.789 ms                  | 118.939 ms                |
| Forward                   | 5.091 ms                  | 15.162 ms                 |
| Backward                  | 10.412 ms                 | 15.293 ms                 |
| Optimize                  | 2.595 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 34.599 us                 | 26.944 ms                 |
| AfterBackward             | 36.123 ms                 | 102.709 ms                |
| BlockToStepN              | 69.266 us                 | 434.876 ms                |
| OneStep                   | 176.660 ms                | 593.627 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:10.695309 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=187, pq.top=187
W20240206 04:26:11.789005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=191, pq.top=191
W20240206 04:26:12.866854 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=195, pq.top=195
W20240206 04:26:14.035389 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 0] 200 steps, total: 27.435, sample: 1.445, forward: 0.521, backward: 1.055, update: 0.328
[proc 1] 200 steps, total: 27.435, sample: 1.248, forward: 0.487, backward: 1.030, update: 0.233
[proc 2] 200 steps, total: 27.435, sample: 1.311, forward: 0.474, backward: 1.041, update: 0.235
[proc 4] 200 steps, total: 27.435, sample: 1.286, forward: 0.417, backward: 1.019, update: 0.253
[proc 3] 200 steps, total: 27.435, sample: 1.193, forward: 0.481, backward: 0.804, update: 0.232
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.754 ms                  | 12.224 ms                 |
| ProcessBack:UpdateCache   | 3.991 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 22.482 ms                 | 61.624 ms                 |
| ProcessOneStep            | 35.376 ms                 | 102.669 ms                |
| BlockToStepN              | 11.626 us                 | 443.037 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:15.035004 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=201, pq.top=201
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.303 ms                  | 118.939 ms                |
| Forward                   | 5.060 ms                  | 15.162 ms                 |
| Backward                  | 10.408 ms                 | 15.293 ms                 |
| Optimize                  | 2.614 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 33.429 us                 | 26.944 ms                 |
| AfterBackward             | 35.640 ms                 | 102.709 ms                |
| BlockToStepN              | 69.266 us                 | 443.090 ms                |
| OneStep                   | 176.660 ms                | 593.627 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:16.035008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=205, pq.top=205
W20240206 04:26:17.035008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=209, pq.top=209
W20240206 04:26:18.035007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240206 04:26:19.035046 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=215, pq.top=215
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.756 ms                  | 12.224 ms                 |
| ProcessBack:UpdateCache   | 3.988 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 22.639 ms                 | 61.624 ms                 |
| ProcessOneStep            | 35.421 ms                 | 102.669 ms                |
| BlockToStepN              | 11.626 us                 | 444.869 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:20.035004 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=219, pq.top=219
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.360 ms                  | 135.316 ms                |
| Forward                   | 5.060 ms                  | 15.162 ms                 |
| Backward                  | 10.408 ms                 | 15.293 ms                 |
| Optimize                  | 2.612 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 32.259 us                 | 26.944 ms                 |
| AfterBackward             | 35.448 ms                 | 102.709 ms                |
| BlockToStepN              | 97.531 us                 | 444.934 ms                |
| OneStep                   | 176.660 ms                | 600.519 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:21.072010 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=223, pq.top=223
W20240206 04:26:22.122224 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=227, pq.top=227
W20240206 04:26:23.426415 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=231, pq.top=231
W20240206 04:26:24.426007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=233, pq.top=233
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.732 ms                  | 11.725 ms                 |
| ProcessBack:UpdateCache   | 3.972 ms                  | 7.209 ms                  |
| ProcessBack:UpsertPq      | 22.482 ms                 | 56.891 ms                 |
| ProcessOneStep            | 34.871 ms                 | 102.669 ms                |
| BlockToStepN              | 342.986 ms                | 444.869 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 5.876 ms                  | 142.587 ms                |
| Forward                   | 5.040 ms                  | 15.162 ms                 |
| Backward                  | 10.360 ms                 | 15.293 ms                 |
| Optimize                  | 2.587 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 31.830 us                 | 26.944 ms                 |
| AfterBackward             | 34.879 ms                 | 102.709 ms                |
| BlockToStepN              | 97.531 us                 | 444.934 ms                |
| OneStep                   | 176.660 ms                | 677.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:25.426007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=237, pq.top=237
W20240206 04:26:26.426005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=241, pq.top=241
W20240206 04:26:27.426005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=245, pq.top=245
W20240206 04:26:28.558959 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=249, pq.top=249
W20240206 04:26:29.618217 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=253, pq.top=253
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.724 ms                  | 11.725 ms                 |
| ProcessBack:UpdateCache   | 3.966 ms                  | 7.209 ms                  |
| ProcessBack:UpsertPq      | 22.176 ms                 | 56.891 ms                 |
| ProcessOneStep            | 34.412 ms                 | 86.190 ms                 |
| BlockToStepN              | 11.626 us                 | 444.558 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.206 ms                  | 142.587 ms                |
| Forward                   | 5.026 ms                  | 12.691 ms                 |
| Backward                  | 10.337 ms                 | 13.389 ms                 |
| Optimize                  | 2.570 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 31.830 us                 | 26.944 ms                 |
| AfterBackward             | 34.431 ms                 | 86.230 ms                 |
| BlockToStepN              | 97.531 us                 | 444.624 ms                |
| OneStep                   | 176.660 ms                | 623.860 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:30.692677 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=257, pq.top=257
W20240206 04:26:31.714450 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=260, pq.top=260
W20240206 04:26:32.714005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=263, pq.top=263
W20240206 04:26:33.714006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=267, pq.top=267
W20240206 04:26:34.714005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=271, pq.top=271
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.713 ms                  | 11.725 ms                 |
| ProcessBack:UpdateCache   | 3.931 ms                  | 7.209 ms                  |
| ProcessBack:UpsertPq      | 21.833 ms                 | 56.891 ms                 |
| ProcessOneStep            | 33.929 ms                 | 86.190 ms                 |
| BlockToStepN              | 42.878 ms                 | 444.558 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.246 ms                  | 142.587 ms                |
| Forward                   | 5.002 ms                  | 12.691 ms                 |
| Backward                  | 10.312 ms                 | 13.389 ms                 |
| Optimize                  | 2.566 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 30.607 us                 | 26.944 ms                 |
| AfterBackward             | 33.960 ms                 | 86.230 ms                 |
| BlockToStepN              | 49.674 ms                 | 444.624 ms                |
| OneStep                   | 176.660 ms                | 623.860 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:35.714005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=274, pq.top=274
W20240206 04:26:36.714007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=277, pq.top=277
W20240206 04:26:37.714006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240206 04:26:38.714005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=285, pq.top=285
W20240206 04:26:39.760067 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=289, pq.top=289
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.684 ms                  | 9.424 ms                  |
| ProcessBack:UpdateCache   | 3.931 ms                  | 6.653 ms                  |
| ProcessBack:UpsertPq      | 21.537 ms                 | 54.918 ms                 |
| ProcessOneStep            | 33.734 ms                 | 86.190 ms                 |
| BlockToStepN              | 49.628 ms                 | 444.558 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.246 ms                  | 142.587 ms                |
| Forward                   | 4.991 ms                  | 12.691 ms                 |
| Backward                  | 10.273 ms                 | 13.389 ms                 |
| Optimize                  | 2.565 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 29.932 us                 | 26.944 ms                 |
| AfterBackward             | 33.764 ms                 | 86.230 ms                 |
| BlockToStepN              | 343.059 ms                | 444.624 ms                |
| OneStep                   | 410.412 ms                | 623.860 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:40.760005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=291, pq.top=291
W20240206 04:26:41.760005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=295, pq.top=295
W20240206 04:26:42.795995 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=299, pq.top=299
[proc 1] 300 steps, total: 28.763, sample: 1.020, forward: 0.485, backward: 1.034, update: 0.230
[proc 4] 300 steps, total: 28.763, sample: 1.132, forward: 0.409, backward: 1.074, update: 0.246
[proc 2] 300 steps, total: 28.763, sample: 1.044, forward: 0.509, backward: 1.046, update: 0.253
[proc 3] 300 steps, total: 28.763, sample: 1.081, forward: 0.494, backward: 0.801, update: 0.229
[proc 0] 300 steps, total: 28.763, sample: 2.232, forward: 0.475, backward: 0.969, update: 0.295
W20240206 04:26:43.896564 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240206 04:26:44.896008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=305, pq.top=305
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.669 ms                  | 9.424 ms                  |
| ProcessBack:UpdateCache   | 3.954 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 21.440 ms                 | 54.918 ms                 |
| ProcessOneStep            | 33.492 ms                 | 86.190 ms                 |
| BlockToStepN              | 49.628 ms                 | 444.558 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.206 ms                  | 166.659 ms                |
| Forward                   | 4.963 ms                  | 12.691 ms                 |
| Backward                  | 10.259 ms                 | 13.389 ms                 |
| Optimize                  | 2.570 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 29.976 us                 | 29.490 ms                 |
| AfterBackward             | 33.610 ms                 | 86.230 ms                 |
| BlockToStepN              | 49.674 ms                 | 444.624 ms                |
| OneStep                   | 176.660 ms                | 650.806 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:45.896008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240206 04:26:46.896008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=311, pq.top=311
W20240206 04:26:47.896005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240206 04:26:48.948318 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240206 04:26:49.948006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=321, pq.top=321
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.673 ms                  | 10.271 ms                 |
| ProcessBack:UpdateCache   | 3.960 ms                  | 8.528 ms                  |
| ProcessBack:UpsertPq      | 21.661 ms                 | 54.918 ms                 |
| ProcessOneStep            | 33.699 ms                 | 86.190 ms                 |
| BlockToStepN              | 342.986 ms                | 453.796 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.433 ms                  | 166.659 ms                |
| Forward                   | 4.957 ms                  | 12.691 ms                 |
| Backward                  | 10.249 ms                 | 13.389 ms                 |
| Optimize                  | 2.566 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 29.704 us                 | 29.490 ms                 |
| AfterBackward             | 33.764 ms                 | 86.230 ms                 |
| BlockToStepN              | 60.065 ms                 | 453.846 ms                |
| OneStep                   | 192.791 ms                | 660.121 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:50.948006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240206 04:26:51.948005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=327, pq.top=327
W20240206 04:26:52.948006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=331, pq.top=331
W20240206 04:26:53.948005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=335, pq.top=335
W20240206 04:26:54.992492 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=338, pq.top=338
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.673 ms                  | 9.685 ms                  |
| ProcessBack:UpdateCache   | 3.960 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 21.778 ms                 | 53.528 ms                 |
| ProcessOneStep            | 33.222 ms                 | 86.190 ms                 |
| BlockToStepN              | 342.986 ms                | 455.115 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.482 ms                  | 188.145 ms                |
| Forward                   | 4.952 ms                  | 12.691 ms                 |
| Backward                  | 10.213 ms                 | 13.389 ms                 |
| Optimize                  | 2.560 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 29.484 us                 | 29.490 ms                 |
| AfterBackward             | 33.250 ms                 | 86.230 ms                 |
| BlockToStepN              | 66.805 ms                 | 455.331 ms                |
| OneStep                   | 192.791 ms                | 677.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:26:55.992005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=341, pq.top=341
W20240206 04:26:57.123479 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=345, pq.top=345
W20240206 04:26:58.123006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=348, pq.top=348
W20240206 04:26:59.123005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=351, pq.top=351
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.659 ms                  | 9.685 ms                  |
| ProcessBack:UpdateCache   | 3.954 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 21.475 ms                 | 53.528 ms                 |
| ProcessOneStep            | 32.447 ms                 | 76.988 ms                 |
| BlockToStepN              | 69.406 ms                 | 455.115 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:00.123004 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=355, pq.top=355
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.492 ms                  | 188.145 ms                |
| Forward                   | 4.942 ms                  | 11.526 ms                 |
| Backward                  | 10.192 ms                 | 13.357 ms                 |
| Optimize                  | 2.549 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 29.319 us                 | 26.944 ms                 |
| AfterBackward             | 32.473 ms                 | 77.018 ms                 |
| BlockToStepN              | 69.447 ms                 | 455.331 ms                |
| OneStep                   | 192.791 ms                | 677.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:01.123005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=358, pq.top=358
W20240206 04:27:02.123006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=361, pq.top=361
W20240206 04:27:03.125034 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=365, pq.top=365
W20240206 04:27:04.125006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=367, pq.top=367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.669 ms                  | 11.725 ms                 |
| ProcessBack:UpdateCache   | 3.911 ms                  | 8.227 ms                  |
| ProcessBack:UpsertPq      | 21.324 ms                 | 53.528 ms                 |
| ProcessOneStep            | 32.323 ms                 | 76.988 ms                 |
| BlockToStepN              | 76.552 ms                 | 458.131 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:05.125003 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=371, pq.top=371
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.584 ms                  | 188.145 ms                |
| Forward                   | 4.942 ms                  | 11.526 ms                 |
| Backward                  | 10.139 ms                 | 13.389 ms                 |
| Optimize                  | 2.539 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 29.484 us                 | 26.944 ms                 |
| AfterBackward             | 32.347 ms                 | 77.018 ms                 |
| BlockToStepN              | 76.601 ms                 | 458.246 ms                |
| OneStep                   | 192.791 ms                | 677.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:06.301956 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=375, pq.top=375
W20240206 04:27:07.301007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=377, pq.top=377
W20240206 04:27:08.301007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=381, pq.top=381
W20240206 04:27:09.318733 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=385, pq.top=385
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.669 ms                  | 11.725 ms                 |
| ProcessBack:UpdateCache   | 3.922 ms                  | 8.186 ms                  |
| ProcessBack:UpsertPq      | 21.123 ms                 | 53.089 ms                 |
| ProcessOneStep            | 32.288 ms                 | 76.988 ms                 |
| BlockToStepN              | 92.426 ms                 | 458.131 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.568 ms                  | 188.145 ms                |
| Forward                   | 4.930 ms                  | 11.526 ms                 |
| Backward                  | 10.111 ms                 | 13.389 ms                 |
| Optimize                  | 2.546 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 29.319 us                 | 26.944 ms                 |
| AfterBackward             | 32.312 ms                 | 77.018 ms                 |
| BlockToStepN              | 92.477 ms                 | 458.246 ms                |
| OneStep                   | 192.791 ms                | 677.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:10.318004 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=387, pq.top=387
W20240206 04:27:11.318004 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240206 04:27:12.354030 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=394, pq.top=394
W20240206 04:27:13.354007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=397, pq.top=397
[proc 2] 400 steps, total: 30.937, sample: 1.106, forward: 0.473, backward: 1.034, update: 0.231
[proc 1] 400 steps, total: 30.937, sample: 1.083, forward: 0.507, backward: 1.017, update: 0.226
[proc 0] 400 steps, total: 30.937, sample: 2.095, forward: 0.477, backward: 0.987, update: 0.306
[proc 4] 400 steps, total: 30.937, sample: 1.187, forward: 0.413, backward: 1.041, update: 0.229
[proc 3] 400 steps, total: 30.937, sample: 1.123, forward: 0.487, backward: 0.820, update: 0.248
W20240206 04:27:14.354008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=401, pq.top=401
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.665 ms                  | 11.725 ms                 |
| ProcessBack:UpdateCache   | 3.927 ms                  | 8.186 ms                  |
| ProcessBack:UpsertPq      | 21.377 ms                 | 53.089 ms                 |
| ProcessOneStep            | 32.381 ms                 | 76.988 ms                 |
| BlockToStepN              | 92.426 ms                 | 458.131 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.615 ms                  | 188.145 ms                |
| Forward                   | 4.914 ms                  | 11.526 ms                 |
| Backward                  | 10.095 ms                 | 13.389 ms                 |
| Optimize                  | 2.538 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 28.933 us                 | 26.944 ms                 |
| AfterBackward             | 32.411 ms                 | 77.018 ms                 |
| BlockToStepN              | 92.477 ms                 | 458.246 ms                |
| OneStep                   | 192.791 ms                | 677.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:15.354008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240206 04:27:16.397204 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240206 04:27:17.397008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=409, pq.top=409
W20240206 04:27:18.397006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=413, pq.top=413
W20240206 04:27:19.397004 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=417, pq.top=417
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.668 ms                  | 11.725 ms                 |
| ProcessBack:UpdateCache   | 3.931 ms                  | 8.186 ms                  |
| ProcessBack:UpsertPq      | 21.396 ms                 | 53.089 ms                 |
| ProcessOneStep            | 32.410 ms                 | 76.988 ms                 |
| BlockToStepN              | 92.426 ms                 | 458.131 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.662 ms                  | 188.145 ms                |
| Forward                   | 4.925 ms                  | 11.526 ms                 |
| Backward                  | 10.040 ms                 | 13.389 ms                 |
| Optimize                  | 2.528 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 28.904 us                 | 26.944 ms                 |
| AfterBackward             | 32.434 ms                 | 77.018 ms                 |
| BlockToStepN              | 92.477 ms                 | 458.246 ms                |
| OneStep                   | 192.791 ms                | 677.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:20.397004 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=419, pq.top=419
W20240206 04:27:21.416901 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=423, pq.top=423
W20240206 04:27:22.543145 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240206 04:27:23.558027 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=430, pq.top=430
W20240206 04:27:24.558009 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=433, pq.top=433
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.673 ms                  | 10.271 ms                 |
| ProcessBack:UpdateCache   | 3.928 ms                  | 7.209 ms                  |
| ProcessBack:UpsertPq      | 21.219 ms                 | 52.186 ms                 |
| ProcessOneStep            | 32.288 ms                 | 76.988 ms                 |
| BlockToStepN              | 93.059 ms                 | 458.131 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.663 ms                  | 188.145 ms                |
| Forward                   | 4.925 ms                  | 11.526 ms                 |
| Backward                  | 9.945 ms                  | 13.389 ms                 |
| Optimize                  | 2.534 ms                  | 10.279 ms                 |
| BarrierTimeBeforeRank0    | 29.319 us                 | 27.631 ms                 |
| AfterBackward             | 32.312 ms                 | 77.018 ms                 |
| BlockToStepN              | 93.118 ms                 | 458.246 ms                |
| OneStep                   | 192.791 ms                | 677.708 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:25.558007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=437, pq.top=437
W20240206 04:27:26.558007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=439, pq.top=439
W20240206 04:27:27.558007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=443, pq.top=443
W20240206 04:27:28.558005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=447, pq.top=447
W20240206 04:27:29.558005 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=450, pq.top=450
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.668 ms                  | 10.271 ms                 |
| ProcessBack:UpdateCache   | 3.903 ms                  | 7.209 ms                  |
| ProcessBack:UpsertPq      | 21.021 ms                 | 52.186 ms                 |
| ProcessOneStep            | 32.137 ms                 | 75.617 ms                 |
| BlockToStepN              | 93.059 ms                 | 458.131 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.662 ms                  | 180.792 ms                |
| Forward                   | 4.895 ms                  | 9.992 ms                  |
| Backward                  | 9.923 ms                  | 13.357 ms                 |
| Optimize                  | 2.538 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 29.102 us                 | 26.944 ms                 |
| AfterBackward             | 32.153 ms                 | 75.680 ms                 |
| BlockToStepN              | 93.118 ms                 | 455.331 ms                |
| OneStep                   | 192.791 ms                | 669.679 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:30.558008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=453, pq.top=453
W20240206 04:27:31.570824 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=457, pq.top=457
W20240206 04:27:32.570010 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=459, pq.top=459
W20240206 04:27:33.570006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=463, pq.top=463
W20240206 04:27:34.570008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=466, pq.top=466
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.659 ms                  | 10.271 ms                 |
| ProcessBack:UpdateCache   | 3.899 ms                  | 7.209 ms                  |
| ProcessBack:UpsertPq      | 20.989 ms                 | 52.186 ms                 |
| ProcessOneStep            | 32.073 ms                 | 75.617 ms                 |
| BlockToStepN              | 100.875 ms                | 455.115 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.584 ms                  | 180.792 ms                |
| Forward                   | 4.900 ms                  | 9.992 ms                  |
| Backward                  | 9.896 ms                  | 13.389 ms                 |
| Optimize                  | 2.539 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 28.904 us                 | 26.944 ms                 |
| AfterBackward             | 32.069 ms                 | 75.680 ms                 |
| BlockToStepN              | 343.059 ms                | 455.331 ms                |
| OneStep                   | 410.412 ms                | 669.679 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:35.570008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240206 04:27:36.668792 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=473, pq.top=473
W20240206 04:27:37.671370 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=476, pq.top=476
W20240206 04:27:38.671008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=479, pq.top=479
W20240206 04:27:39.723215 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=483, pq.top=483
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.659 ms                  | 9.685 ms                  |
| ProcessBack:UpdateCache   | 3.903 ms                  | 6.737 ms                  |
| ProcessBack:UpsertPq      | 20.897 ms                 | 49.387 ms                 |
| ProcessOneStep            | 32.029 ms                 | 75.617 ms                 |
| BlockToStepN              | 100.875 ms                | 455.115 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.450 ms                  | 180.792 ms                |
| Forward                   | 4.895 ms                  | 9.992 ms                  |
| Backward                  | 9.866 ms                  | 14.775 ms                 |
| Optimize                  | 2.546 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 28.635 us                 | 27.631 ms                 |
| AfterBackward             | 32.059 ms                 | 75.680 ms                 |
| BlockToStepN              | 343.059 ms                | 455.331 ms                |
| OneStep                   | 410.412 ms                | 669.679 ms                |
+---------------------------+---------------------------+---------------------------+
W20240206 04:27:40.723008 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=485, pq.top=485
W20240206 04:27:41.723004 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=489, pq.top=489
W20240206 04:27:42.723007 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=491, pq.top=491
W20240206 04:27:43.723006 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=495, pq.top=495
W20240206 04:27:44.723013 52462 grad_async_v1.h:429] Sleep in <BlockToStepN>, step_no=498, pq.top=498
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.665 ms                  | 9.685 ms                  |
| ProcessBack:UpdateCache   | 3.903 ms                  | 7.209 ms                  |
| ProcessBack:UpsertPq      | 21.072 ms                 | 49.387 ms                 |
| ProcessOneStep            | 32.137 ms                 | 75.617 ms                 |
| BlockToStepN              | 100.875 ms                | 455.115 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.492 ms                  | 180.792 ms                |
| Forward                   | 4.881 ms                  | 9.992 ms                  |
| Backward                  | 9.840 ms                  | 14.775 ms                 |
| Optimize                  | 2.539 ms                  | 10.266 ms                 |
| BarrierTimeBeforeRank0    | 28.637 us                 | 27.631 ms                 |
| AfterBackward             | 32.166 ms                 | 75.680 ms                 |
| BlockToStepN              | 100.927 ms                | 455.331 ms                |
| OneStep                   | 192.791 ms                | 669.679 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 31.165, sample: 1.657, forward: 0.483, backward: 0.989, update: 0.280
[proc 1] 500 steps, total: 31.165, sample: 1.083, forward: 0.539, backward: 1.000, update: 0.244
[proc 3] 500 steps, total: 31.165, sample: 1.091, forward: 0.512, backward: 0.984, update: 0.243
[proc 2] 500 steps, total: 31.165, sample: 1.086, forward: 0.514, backward: 1.040, update: 0.244
[proc 4] 500 steps, total: 31.165, sample: 1.109, forward: 0.438, backward: 1.055, update: 0.244
Successfully xmh. training takes 154.1660017967224 seconds
before call kg_cache_controller.StopThreads()
W20240206 04:27:45.417441 52462 grad_async_v1.h:243] call StopThreads. PID = 50963
W20240206 04:27:45.417469 52462 grad_base.h:212] before processOneStepNegThread_.join();
W20240206 04:27:45.425907 52462 grad_base.h:214] after processOneStepNegThread_.join();
W20240206 04:27:45.425971 52462 grad_async_v1.h:245] call GradProcessingBase::StopThreads.
W20240206 04:27:45.458204 52462 grad_async_v1.h:264] StopThreads done.
