WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240206 01:04:49.921285 26556 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/data/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_128', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=3, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=3, gpu=[0, 1, 2], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [26556 sampler.py:454] Start PreSampling
WARNING [26556 sampler.py:532] Before construct renumbering_dict
WARNING [26556 sampler.py:555] PreSampling done
W20240206 01:23:05.244630 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240206 01:23:05.244855 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240206 01:23:05.244894 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240206 01:23:05.244925 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240206 01:23:05.244953 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240206 01:23:05.244985 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240206 01:23:05.245010 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240206 01:23:05.245043 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240206 01:23:05.245066 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240206 01:23:05.245097 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240206 01:23:05.245133 26556 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240206 01:23:05.245155 26556 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240206 01:23:05.245177 26556 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240206 01:23:05.245339 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240206 01:23:05.245380 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240206 01:23:05.245407 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240206 01:23:05.245453 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240206 01:23:05.245476 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240206 01:23:05.245515 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240206 01:23:05.245543 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240206 01:23:05.245576 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240206 01:23:05.245610 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240206 01:23:05.245642 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240206 01:23:05.245666 26556 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240206 01:23:05.245685 26556 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240206 01:23:05.245712 26556 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240206 01:23:05.245764 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240206 01:23:05.245792 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240206 01:23:05.245813 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240206 01:23:05.245847 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240206 01:23:05.245878 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240206 01:23:05.245913 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240206 01:23:05.245945 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240206 01:23:05.245971 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240206 01:23:05.245995 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240206 01:23:05.246016 26556 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240206 01:23:05.246042 26556 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240206 01:23:05.246060 26556 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240206 01:23:05.246079 26556 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240206 01:23:05.718201 26556 IPCTensor.h:369] NewIPCTensor: full_emb [86054151, 400]0x10000e52e000 128.2 GB
W20240206 01:30:59.199199 26556 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x10201d166000 328.3 MB
{0: Graph(num_nodes=32806815, num_edges=98289586,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=31756927, num_edges=120802495,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=32681333, num_edges=137186093,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 32806815 N 98289586 E
MertisPartition: part 1 has 31756927 N 120802495 E
MertisPartition: part 2 has 32681333 N 137186093 E
Rank0: cached key size 1434235
Rank1: cached key size 1434235
Rank2: cached key size 1434235
Before renumbering graph:  {'_ID': tensor([     196,      197,      239,  ..., 85907466, 77843586,   627118]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([ 4309192,  4309224,  4310590,  ..., 73515180, 83462087, 24505532]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=32806815, num_edges=98289586,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=32806815, num_edges=98289586,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2071.660 seconds
[Rank1] pid = 27614
INFO [26556 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [27614 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [27708 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [26556 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
INFO [27614 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
INFO [27708 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
WARNING [26556 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [27708 DistTensor.py:59] The tensor name already exists in the kvstore
WARNING [27614 DistTensor.py:59] The tensor name already exists in the kvstore
I20240206 01:39:25.747824 27709 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 3
I20240206 01:39:25.748071 27738 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
I20240206 01:39:25.748253 27615 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
E20240206 01:39:26.069506 27738 recstore.cc:66] init folly done
E20240206 01:39:26.069948 27709 recstore.cc:66] init folly done
E20240206 01:39:26.069969 27615 recstore.cc:66] init folly done
I20240206 01:39:41.670331 27738 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 3
I20240206 01:39:43.095089 27615 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
I20240206 01:39:47.241236 27709 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 17.082 ms                 | 196.726 ms                |
| Forward                   | 9.449 ms                  | 664.822 ms                |
| Backward                  | 207.914 ms                | 384.329 ms                |
| Optimize                  | 4.205 ms                  | 9.139 ms                  |
| BarrierTimeBeforeRank0    | 21.720 ms                 | 64.731 ms                 |
| BlockToStepN              | 30.679 us                 | 105.623 us                |
| OneStep                   | 276.513 ms                | 1.125 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.898 ms                 | 196.726 ms                |
| Forward                   | 9.041 ms                  | 664.822 ms                |
| Backward                  | 206.225 ms                | 384.329 ms                |
| Optimize                  | 4.192 ms                  | 9.139 ms                  |
| BarrierTimeBeforeRank0    | 14.316 ms                 | 64.731 ms                 |
| BlockToStepN              | 29.197 us                 | 105.623 us                |
| OneStep                   | 259.539 ms                | 1.125 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.898 ms                 | 196.726 ms                |
| Forward                   | 8.852 ms                  | 664.822 ms                |
| Backward                  | 203.450 ms                | 384.329 ms                |
| Optimize                  | 4.266 ms                  | 9.139 ms                  |
| BarrierTimeBeforeRank0    | 12.864 ms                 | 64.731 ms                 |
| BlockToStepN              | 29.279 us                 | 105.623 us                |
| OneStep                   | 245.388 ms                | 1.125 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 11.919 ms                 | 178.294 ms                |
| Forward                   | 8.655 ms                  | 16.038 ms                 |
| Backward                  | 202.563 ms                | 236.118 ms                |
| Optimize                  | 4.266 ms                  | 7.508 ms                  |
| BarrierTimeBeforeRank0    | 12.864 ms                 | 64.731 ms                 |
| BlockToStepN              | 29.324 us                 | 47.381 us                 |
| OneStep                   | 243.008 ms                | 1.125 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.866 ms                  | 178.294 ms                |
| Forward                   | 8.686 ms                  | 16.038 ms                 |
| Backward                  | 201.253 ms                | 353.632 ms                |
| Optimize                  | 4.278 ms                  | 9.139 ms                  |
| BarrierTimeBeforeRank0    | 12.805 ms                 | 64.731 ms                 |
| BlockToStepN              | 29.324 us                 | 58.795 us                 |
| OneStep                   | 240.825 ms                | 1.125 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 27.412, sample: 1.657, forward: 2.733, backward: 21.623, update: 0.316
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 31.558, sample: 1.590, forward: 2.795, backward: 21.105, update: 0.365
[Rank2] pid = 27708
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121)]
train_sampler.Prefill()
-------Step 0-------
tensor([  593792,    49933,   593831, 19167317,   593880,   593920,     2127,
         1213184,  1030071,   593966]) tensor([ 8794478, 50222750, 26259989, 66840983, 29557439,   387616, 63711607,
        18112372, 48471560, 45925789])
-------Step 1-------
tensor([  593792,    49933,   593831, 19167317,   593880,   593920,     2127,
         1213184,  1030071,   593966]) tensor([63018706, 22331106,  4584589, 66454839, 75353058, 39733054, 20950542,
        22575296,  1734299, 36035518])
-------Step 2-------
tensor([ 702321,  702372,    2339, 1038594,  702421,  702471,  702519,  553263,
         702564,  702604]) tensor([27412543, 36956665, 80325083, 60930351, 23030795, 40570549, 24336015,
        41813542, 55592286, 58002334])
-------Step 3-------
tensor([ 702321,  702372,    2339, 1038594,  702421,  702471,  702519,  553263,
         702564,  702604]) tensor([64857542,  1326757, 63013395, 15221871, 62120976, 12130725, 14037198,
        85055484, 75518093, 71633328])
-------Step 4-------
tensor([  825864,   825897,   375254,   825943,  1225054,   825980, 21890134,
          826018,   826061,   826103]) tensor([46486358, 62307875, 10575157, 63723298, 51501876, 85058451, 13331107,
        25538087,  8024778, 27182380])
-------Step 5-------
tensor([  825864,   825897,   375254,   825943,  1225054,   825980, 21890134,
          826018,   826061,   826103]) tensor([50068135, 60718639, 30429327, 54364485, 10537311, 73997733, 42893034,
        29696336,   810020, 39177112])
-------Step 6-------
tensor([  936029,   936070,   936102,  1231080, 21890134,   936144,   936180,
          936221,   936269,       27]) tensor([43065005, 11711771, 68600495, 24318275,  1081838, 33192492, 16183247,
         7995621,   253012, 28806509])
-------Step 7-------
tensor([  936029,   936070,   936102,  1231080, 21890134,   936144,   936180,
          936221,   936269,       27]) tensor([57326717, 37322191, 42196408,   227290, 38335047, 49320457, 81053037,
        79680272, 39032853, 30041821])
-------Step 8-------
tensor([ 1036130,  1036159,  1036195,  1036225,  1062065,  1036261, 16287910,
         1036292,  1036331, 16559427]) tensor([75849810, 23370004, 23815923, 19037166, 57090368, 10895983, 67595621,
         1400479, 65777705, 52286996])
-------Step 9-------
tensor([ 1036130,  1036159,  1036195,  1036225,  1062065,  1036261, 16287910,
         1036292,  1036331, 16559427]) tensor([31331540, 41337158, 37794365, 58697617, 47466918, 71704909, 50248249,
        31728547, 85140525, 24405634])
before start barrier
start train
[proc 0] 100 steps, total: 32.983, sample: 2.220, forward: 1.565, backward: 20.353, update: 0.455
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.232 ms                  | 178.294 ms                |
| Forward                   | 8.647 ms                  | 16.038 ms                 |
| Backward                  | 200.223 ms                | 353.632 ms                |
| Optimize                  | 4.278 ms                  | 9.139 ms                  |
| BarrierTimeBeforeRank0    | 12.805 ms                 | 97.619 ms                 |
| BlockToStepN              | 29.066 us                 | 58.795 us                 |
| OneStep                   | 241.274 ms                | 1.125 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.608 ms                  | 178.294 ms                |
| Forward                   | 8.625 ms                  | 16.038 ms                 |
| Backward                  | 197.692 ms                | 384.329 ms                |
| Optimize                  | 4.278 ms                  | 9.139 ms                  |
| BarrierTimeBeforeRank0    | 12.805 ms                 | 97.619 ms                 |
| BlockToStepN              | 29.197 us                 | 102.959 us                |
| OneStep                   | 240.715 ms                | 1.125 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.781 ms                  | 178.294 ms                |
| Forward                   | 8.625 ms                  | 16.038 ms                 |
| Backward                  | 196.333 ms                | 384.329 ms                |
| Optimize                  | 4.283 ms                  | 9.139 ms                  |
| BarrierTimeBeforeRank0    | 12.838 ms                 | 134.262 ms                |
| BlockToStepN              | 29.040 us                 | 102.959 us                |
| OneStep                   | 239.302 ms                | 1.125 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.446 ms                  | 176.408 ms                |
| Forward                   | 8.603 ms                  | 14.172 ms                 |
| Backward                  | 195.682 ms                | 353.632 ms                |
| Optimize                  | 4.283 ms                  | 7.739 ms                  |
| BarrierTimeBeforeRank0    | 12.864 ms                 | 134.262 ms                |
| BlockToStepN              | 29.040 us                 | 88.956 us                 |
| OneStep                   | 237.774 ms                | 427.370 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.225 ms                  | 176.408 ms                |
| Forward                   | 8.535 ms                  | 14.994 ms                 |
| Backward                  | 195.682 ms                | 353.632 ms                |
| Optimize                  | 4.282 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 12.864 ms                 | 134.262 ms                |
| BlockToStepN              | 29.040 us                 | 88.956 us                 |
| OneStep                   | 238.655 ms                | 427.370 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 25.022, sample: 1.529, forward: 1.830, backward: 20.309, update: 0.310
[proc 1] 200 steps, total: 25.022, sample: 1.438, forward: 1.835, backward: 19.808, update: 0.335
[proc 0] 200 steps, total: 25.022, sample: 2.148, forward: 0.891, backward: 19.763, update: 0.415
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.608 ms                  | 176.408 ms                |
| Forward                   | 8.564 ms                  | 14.994 ms                 |
| Backward                  | 195.451 ms                | 353.632 ms                |
| Optimize                  | 4.278 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 12.494 ms                 | 134.262 ms                |
| BlockToStepN              | 29.066 us                 | 88.956 us                 |
| OneStep                   | 238.094 ms                | 427.370 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.608 ms                  | 176.408 ms                |
| Forward                   | 8.564 ms                  | 14.994 ms                 |
| Backward                  | 195.194 ms                | 353.632 ms                |
| Optimize                  | 4.282 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 12.805 ms                 | 134.262 ms                |
| BlockToStepN              | 29.279 us                 | 102.959 us                |
| OneStep                   | 237.774 ms                | 427.370 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.392 ms                  | 176.408 ms                |
| Forward                   | 8.603 ms                  | 14.994 ms                 |
| Backward                  | 195.230 ms                | 353.632 ms                |
| Optimize                  | 4.275 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 11.929 ms                 | 149.906 ms                |
| BlockToStepN              | 29.121 us                 | 102.959 us                |
| OneStep                   | 237.441 ms                | 427.370 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.392 ms                  | 163.463 ms                |
| Forward                   | 8.625 ms                  | 14.994 ms                 |
| Backward                  | 195.230 ms                | 327.969 ms                |
| Optimize                  | 4.280 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 11.071 ms                 | 134.262 ms                |
| BlockToStepN              | 28.995 us                 | 102.959 us                |
| OneStep                   | 236.925 ms                | 416.212 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.725 ms                  | 163.463 ms                |
| Forward                   | 8.637 ms                  | 14.994 ms                 |
| Backward                  | 195.092 ms                | 327.969 ms                |
| Optimize                  | 4.282 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 10.930 ms                 | 134.262 ms                |
| BlockToStepN              | 29.040 us                 | 102.959 us                |
| OneStep                   | 236.707 ms                | 416.212 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 24.546, sample: 1.258, forward: 1.742, backward: 19.500, update: 0.329
[proc 2] 300 steps, total: 24.546, sample: 1.490, forward: 1.753, backward: 20.105, update: 0.333
[proc 0] 300 steps, total: 24.546, sample: 1.829, forward: 0.949, backward: 19.854, update: 0.413
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.608 ms                  | 163.463 ms                |
| Forward                   | 8.603 ms                  | 14.994 ms                 |
| Backward                  | 195.038 ms                | 327.969 ms                |
| Optimize                  | 4.280 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 11.071 ms                 | 134.262 ms                |
| BlockToStepN              | 29.040 us                 | 102.959 us                |
| OneStep                   | 236.597 ms                | 416.212 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.468 ms                  | 163.463 ms                |
| Forward                   | 8.588 ms                  | 14.994 ms                 |
| Backward                  | 195.016 ms                | 327.969 ms                |
| Optimize                  | 4.282 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 11.366 ms                 | 134.262 ms                |
| BlockToStepN              | 28.959 us                 | 102.959 us                |
| OneStep                   | 236.483 ms                | 416.212 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.232 ms                  | 163.463 ms                |
| Forward                   | 8.588 ms                  | 14.994 ms                 |
| Backward                  | 195.321 ms                | 344.845 ms                |
| Optimize                  | 4.280 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 11.570 ms                 | 149.906 ms                |
| BlockToStepN              | 28.784 us                 | 102.959 us                |
| OneStep                   | 236.925 ms                | 416.212 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.446 ms                  | 156.167 ms                |
| Forward                   | 8.594 ms                  | 14.278 ms                 |
| Backward                  | 195.038 ms                | 327.969 ms                |
| Optimize                  | 4.283 ms                  | 7.739 ms                  |
| BarrierTimeBeforeRank0    | 11.613 ms                 | 134.262 ms                |
| BlockToStepN              | 28.860 us                 | 102.959 us                |
| OneStep                   | 236.597 ms                | 396.556 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.264 ms                  | 156.167 ms                |
| Forward                   | 8.571 ms                  | 14.278 ms                 |
| Backward                  | 194.688 ms                | 327.969 ms                |
| Optimize                  | 4.280 ms                  | 7.739 ms                  |
| BarrierTimeBeforeRank0    | 12.342 ms                 | 134.262 ms                |
| BlockToStepN              | 28.888 us                 | 102.959 us                |
| OneStep                   | 236.412 ms                | 396.556 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 24.882, sample: 1.182, forward: 1.585, backward: 19.341, update: 0.333
[proc 2] 400 steps, total: 24.882, sample: 1.413, forward: 1.726, backward: 20.564, update: 0.340
[proc 0] 400 steps, total: 24.881, sample: 1.611, forward: 0.877, backward: 19.746, update: 0.400
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.225 ms                  | 156.167 ms                |
| Forward                   | 8.564 ms                  | 14.278 ms                 |
| Backward                  | 194.588 ms                | 340.898 ms                |
| Optimize                  | 4.279 ms                  | 7.739 ms                  |
| BarrierTimeBeforeRank0    | 12.342 ms                 | 134.262 ms                |
| BlockToStepN              | 28.898 us                 | 102.959 us                |
| OneStep                   | 236.315 ms                | 416.212 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 9.003 ms                  | 156.167 ms                |
| Forward                   | 8.530 ms                  | 14.278 ms                 |
| Backward                  | 194.401 ms                | 340.898 ms                |
| Optimize                  | 4.278 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 12.864 ms                 | 134.262 ms                |
| BlockToStepN              | 28.854 us                 | 102.959 us                |
| OneStep                   | 236.160 ms                | 416.212 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.960 ms                  | 156.167 ms                |
| Forward                   | 8.530 ms                  | 14.278 ms                 |
| Backward                  | 194.090 ms                | 340.898 ms                |
| Optimize                  | 4.276 ms                  | 7.771 ms                  |
| BarrierTimeBeforeRank0    | 13.432 ms                 | 149.906 ms                |
| BlockToStepN              | 28.760 us                 | 102.959 us                |
| OneStep                   | 235.960 ms                | 416.212 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.900 ms                  | 153.390 ms                |
| Forward                   | 8.497 ms                  | 14.172 ms                 |
| Backward                  | 193.717 ms                | 338.073 ms                |
| Optimize                  | 4.277 ms                  | 7.739 ms                  |
| BarrierTimeBeforeRank0    | 13.625 ms                 | 134.262 ms                |
| BlockToStepN              | 28.854 us                 | 88.956 us                 |
| OneStep                   | 235.704 ms                | 396.556 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.850 ms                  | 153.390 ms                |
| Forward                   | 8.457 ms                  | 14.172 ms                 |
| Backward                  | 193.659 ms                | 338.073 ms                |
| Optimize                  | 4.278 ms                  | 7.739 ms                  |
| BarrierTimeBeforeRank0    | 13.625 ms                 | 140.851 ms                |
| BlockToStepN              | 28.888 us                 | 102.959 us                |
| OneStep                   | 235.704 ms                | 396.556 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 24.561, sample: 1.463, forward: 0.859, backward: 19.163, update: 0.394
[proc 2] 500 steps, total: 24.561, sample: 1.550, forward: 1.646, backward: 20.470, update: 0.317
[proc 1] 500 steps, total: 24.561, sample: 1.295, forward: 1.558, backward: 19.567, update: 0.329
Successfully xmh. training takes 131.99358654022217 seconds
before call kg_cache_controller.StopThreads()
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
INFO [26556 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.752 ms                  | 153.390 ms                |
| Forward                   | 8.474 ms                  | 14.172 ms                 |
| Backward                  | 193.655 ms                | 338.073 ms                |
| Optimize                  | 4.277 ms                  | 7.739 ms                  |
| BarrierTimeBeforeRank0    | 13.655 ms                 | 140.851 ms                |
| BlockToStepN              | 28.811 us                 | 102.959 us                |
| OneStep                   | 235.473 ms                | 396.556 ms                |
+---------------------------+---------------------------+---------------------------+
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
