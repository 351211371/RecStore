WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240116 11:37:49.870733 18629 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240116 11:37:49.877559 18629 IPCTensor.h:367] NewIPCTensor: full_emb [100000000, 32]0x100000002000
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:165: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [18629 perf_emb.py:165] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f903da058a0>==========
Worker 1 pid=18922
Worker 2 pid=18923
INFO [18629 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [18923 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [18924 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [18922 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [18629 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [18923 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [18922 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [18924 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 11:37:50.520220 18629 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 11:37:50.520530 18923 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 11:37:50.520539 18922 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 11:37:50.520538 18924 IPCTensor.h:346] IPCTensor full_emb already exists
W20240116 11:37:50.528781 18629 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [10000000, 32]; dev=0; size=1.192 GB
W20240116 11:37:50.528884 18922 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [10000000, 32]; dev=1; size=1.192 GB
W20240116 11:37:50.528889 18924 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [10000000, 32]; dev=3; size=1.192 GB
W20240116 11:37:50.528887 18923 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [10000000, 32]; dev=2; size=1.192 GB
W20240116 11:37:51.163360 18922 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1002faf0e000
W20240116 11:37:51.163576 18922 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x1002fafd3000
W20240116 11:37:51.163663 18922 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 32]0x1002fb098000
W20240116 11:37:51.163724 18922 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 32]0x1002fbccf000
W20240116 11:37:51.163790 18922 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 11:37:51.164577 18922 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 11:37:51.167778 18629 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1002fc90c000
W20240116 11:37:51.167928 18629 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1002fc9d1000
W20240116 11:37:51.168004 18629 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 32]0x1002fca96000
W20240116 11:37:51.168054 18629 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 32]0x1002fd6cd000
W20240116 11:37:51.168104 18629 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 11:37:51.168687 18629 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 11:37:51.174649 18924 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x1002fe30a000
W20240116 11:37:51.174799 18924 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1002fe3cf000
W20240116 11:37:51.174867 18924 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 32]0x1002fe494000
W20240116 11:37:51.174921 18924 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 32]0x1002ff0cb000
W20240116 11:37:51.174983 18924 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240116 11:37:51.176168 18924 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240116 11:37:51.179606 18923 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1002ffd08000
W20240116 11:37:51.179744 18923 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x1002ffdcd000
W20240116 11:37:51.179816 18923 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 32]0x1002ffe92000
W20240116 11:37:51.179872 18923 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 32]0x100300ac9000
W20240116 11:37:51.179927 18923 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 11:37:51.182849 18923 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 32]; dev=2; size=12.21 MB
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
Worker 3 pid=18924
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 10000000), (10000000, 20000000), (20000000, 30000000), (30000000, 40000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
W20240116 11:37:54.038283 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100301704000
W20240116 11:37:54.038311 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x1003017c9000
W20240116 11:37:54.038326 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10030188e000
W20240116 11:37:54.038355 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x100301953000
W20240116 11:37:54.038516 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x100301a18000
W20240116 11:37:54.038522 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100301add000
W20240116 11:37:54.038529 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x100301ba2000
W20240116 11:37:54.038537 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x100301c67000
W20240116 11:37:54.038589 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x100301d2c000
W20240116 11:37:54.038594 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x100301df1000
W20240116 11:37:54.038596 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x100301eb6000
W20240116 11:37:54.038619 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100301f7b000
W20240116 11:37:54.038646 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x100302040000
W20240116 11:37:54.038652 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100302105000
W20240116 11:37:54.038663 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x1003021ca000
W20240116 11:37:54.038689 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x10030228f000
W20240116 11:37:54.038708 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100302354000
W20240116 11:37:54.038723 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100302419000
W20240116 11:37:54.038729 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x1003024de000
W20240116 11:37:54.038753 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x1003025a3000
W20240116 11:37:54.038785 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100302668000
W20240116 11:37:54.038800 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10030272d000
W20240116 11:37:54.038805 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1003027f2000
W20240116 11:37:54.038833 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x1003028b7000
W20240116 11:37:54.038872 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x10030297c000
W20240116 11:37:54.038878 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100302a41000
W20240116 11:37:54.038888 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100302b06000
W20240116 11:37:54.038919 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100302bcb000
W20240116 11:37:54.038941 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x100302c90000
W20240116 11:37:54.038971 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x100302d55000
W20240116 11:37:54.038978 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100302e1a000
W20240116 11:37:54.038991 18629 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x100302edf000
W20240116 11:37:54.039036 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100302fa4000
W20240116 11:37:54.039057 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x100303069000
W20240116 11:37:54.039059 18629 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x10030312e000
W20240116 11:37:54.039075 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100303130000
W20240116 11:37:54.039108 18629 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1003031f5000
W20240116 11:37:54.039116 18923 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x1003031f7000
W20240116 11:37:54.039129 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x1003032bc000
W20240116 11:37:54.039168 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100303381000
W20240116 11:37:54.039171 18629 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100303446000
W20240116 11:37:54.039191 18923 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100303448000
W20240116 11:37:54.039196 18924 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x10030344a000
W20240116 11:37:54.039242 18922 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x10030350f000
W20240116 11:37:54.039247 18923 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x1003035d4000
W20240116 11:37:54.039266 18924 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x1003035d6000
W20240116 11:37:54.039299 18923 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1003035d8000
W20240116 11:37:54.039309 18924 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x1003035da000
W20240116 11:37:54.039317 18922 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x1003035dc000
W20240116 11:37:54.039363 18924 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1003035de000
W20240116 11:37:54.039371 18922 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x1003035e0000
W20240116 11:37:54.039445 18922 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1003035e2000
Construct PerfSampler done
I20240116 11:37:54.039626 18629 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
Construct PerfSampler done
Construct PerfSampler done
Construct PerfSampler done
I20240116 11:37:54.039788 18923 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240116 11:37:54.039871 18924 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240116 11:37:54.039885 18922 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240116 11:37:54.041499 18629 grad_base.h:54] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240116 11:37:54.041843 18629 grad_base.h:169] Init GradProcessingBase done
I20240116 11:38:11.249675 18629 grad_async_v2.h:32] Use background thread to update emb.
W20240116 11:38:11.250046 18629 kg_controller.h:78] after init GradAsyncProcessingV2
I20240116 11:38:11.250056 18629 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240116 11:38:11.738691 18629 grad_base.h:59] GraphEnv RegTensorsPerProcess
W20240116 11:38:15.317966 19817 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 11:38:15.318315 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
Before Training
I20240116 11:38:16.265990 18924 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
E20240116 11:38:16.318322 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=1576
W20240116 11:38:16.335072 19817 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
Before Training
I20240116 11:38:16.512707 18629 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 11:38:16.546501 18922 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 11:38:16.581646 18923 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240116 11:38:17.843523 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240116 11:38:17.929052 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240116 11:38:17.948302 19817 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
E20240116 11:38:18.843052 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=197
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
W20240116 11:38:18.954064 19817 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 441.001 us                | 40.218 ms                 |
| Backward                  | 888.927 us                | 30.349 ms                 |
| Optimize                  | 135.908 us                | 530.251 us                |
| BarrierTimeBeforeRank0    | 1.118 ms                  | 3.146 ms                  |
| AfterBackward             | 85.363 ms                 | 1.135 s                   |
| BlockToStepN              | 16.390 ms                 | 17.126 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 11:38:19.110031 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=6, pq.top=5
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
E20240116 11:38:19.846910 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=33652
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
W20240116 11:38:20.093343 19817 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
W20240116 11:38:20.308822 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=11, pq.top=11
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
E20240116 11:38:20.846073 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=52409
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240116 11:38:21.121640 19817 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
W20240116 11:38:21.480692 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=16, pq.top=16
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.642 ms                  | 158.906 ms                |
| ProcessBack:UpdateCache   | 5.570 ms                  | 888.074 ms                |
| ProcessBack:UpsertPq      | 77.190 ms                 | 91.371 ms                 |
| ProcessOneStep            | 85.640 ms                 | 1.135 s                   |
| BlockToStepN              | 15.836 ms                 | 17.382 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:38:21.846097 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=69898
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
W20240116 11:38:22.239360 19817 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
W20240116 11:38:22.683933 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=21, pq.top=21
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240116 11:38:22.846014 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=87038
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
W20240116 11:38:23.268595 19817 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
E20240116 11:38:23.846006 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=101622
W20240116 11:38:23.853359 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=26, pq.top=26
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 426.953 us                | 40.218 ms                 |
| Backward                  | 1.363 ms                  | 30.349 ms                 |
| Optimize                  | 106.157 us                | 530.251 us                |
| BarrierTimeBeforeRank0    | 727.218 us                | 7.985 ms                  |
| AfterBackward             | 85.124 ms                 | 1.135 s                   |
| BlockToStepN              | 15.924 ms                 | 18.030 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
W20240116 11:38:24.376614 19817 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
E20240116 11:38:24.846031 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=94
W20240116 11:38:24.863739 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=30, pq.top=30
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
W20240116 11:38:25.392561 19817 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
E20240116 11:38:25.846028 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=17
W20240116 11:38:25.898434 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=34, pq.top=34
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240116 11:38:26.460196 19817 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.648 ms                  | 158.906 ms                |
| ProcessBack:UpdateCache   | 5.607 ms                  | 888.074 ms                |
| ProcessBack:UpsertPq      | 77.862 ms                 | 98.177 ms                 |
| ProcessOneStep            | 86.698 ms                 | 1.135 s                   |
| BlockToStepN              | 16.234 ms                 | 17.929 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:38:26.846107 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=146279
W20240116 11:38:26.957760 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=38, pq.top=38
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240116 11:38:27.487486 19817 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
E20240116 11:38:27.846010 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=162498
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
W20240116 11:38:28.145457 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=43, pq.top=43
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
W20240116 11:38:28.514969 19817 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
E20240116 11:38:28.846119 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=15
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 434.925 us                | 40.218 ms                 |
| Backward                  | 888.927 us                | 30.349 ms                 |
| Optimize                  | 113.993 us                | 530.251 us                |
| BarrierTimeBeforeRank0    | 666.276 us                | 7.985 ms                  |
| AfterBackward             | 86.384 ms                 | 1.135 s                   |
| BlockToStepN              | 16.289 ms                 | 18.030 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
W20240116 11:38:29.347877 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=48, pq.top=48
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
W20240116 11:38:29.601613 19817 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
E20240116 11:38:29.846011 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=191472
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
W20240116 11:38:30.525525 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=53, pq.top=53
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240116 11:38:30.614364 19817 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
E20240116 11:38:30.846024 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=321
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
W20240116 11:38:31.697826 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=58, pq.top=58
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
W20240116 11:38:31.717341 19817 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.632 ms                  | 5.598 ms                  |
| ProcessBack:UpdateCache   | 5.570 ms                  | 9.799 ms                  |
| ProcessBack:UpsertPq      | 77.155 ms                 | 97.899 ms                 |
| ProcessOneStep            | 85.614 ms                 | 108.136 ms                |
| BlockToStepN              | 16.102 ms                 | 17.929 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:38:31.846010 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=223099
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
W20240116 11:38:32.747328 19817 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 11:38:32.846016 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=237329
W20240116 11:38:32.865149 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=63, pq.top=63
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
W20240116 11:38:33.815493 19817 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 11:38:33.846012 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=210
W20240116 11:38:34.032218 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=68, pq.top=68
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 426.953 us                | 2.000 ms                  |
| Backward                  | 1.107 ms                  | 3.529 ms                  |
| Optimize                  | 109.136 us                | 402.795 us                |
| BarrierTimeBeforeRank0    | 363.948 us                | 3.558 ms                  |
| AfterBackward             | 85.124 ms                 | 108.245 ms                |
| BlockToStepN              | 16.019 ms                 | 18.030 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
W20240116 11:38:34.843998 19817 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
E20240116 11:38:34.846031 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=465
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
W20240116 11:38:35.266225 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=73, pq.top=73
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
E20240116 11:38:35.846028 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=278498
W20240116 11:38:35.873987 19817 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
W20240116 11:38:36.290704 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=77, pq.top=77
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.632 ms                  | 5.598 ms                  |
| ProcessBack:UpdateCache   | 5.570 ms                  | 9.799 ms                  |
| ProcessBack:UpsertPq      | 77.136 ms                 | 97.899 ms                 |
| ProcessOneStep            | 85.595 ms                 | 108.136 ms                |
| BlockToStepN              | 15.975 ms                 | 17.929 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
E20240116 11:38:36.846024 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=292099
W20240116 11:38:36.880403 19817 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
W20240116 11:38:37.299463 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=81, pq.top=81
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
E20240116 11:38:37.846028 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=333
W20240116 11:38:37.902309 19817 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
W20240116 11:38:38.516038 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=86, pq.top=86
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
E20240116 11:38:38.846007 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=319962
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
W20240116 11:38:39.026755 19817 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 426.953 us                | 2.000 ms                  |
| Backward                  | 767.902 us                | 3.529 ms                  |
| Optimize                  | 109.136 us                | 402.795 us                |
| BarrierTimeBeforeRank0    | 471.124 us                | 3.558 ms                  |
| AfterBackward             | 85.960 ms                 | 108.245 ms                |
| BlockToStepN              | 16.191 ms                 | 18.030 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
W20240116 11:38:39.731660 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=91, pq.top=91
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
E20240116 11:38:39.846047 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=333734
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
W20240116 11:38:40.048673 19817 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
E20240116 11:38:40.846014 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=24
W20240116 11:38:40.926635 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=96, pq.top=96
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
W20240116 11:38:41.183950 19817 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.632 ms                  | 5.598 ms                  |
| ProcessBack:UpdateCache   | 5.570 ms                  | 9.799 ms                  |
| ProcessBack:UpsertPq      | 77.290 ms                 | 97.899 ms                 |
| ProcessOneStep            | 85.889 ms                 | 108.136 ms                |
| BlockToStepN              | 16.091 ms                 | 17.945 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:38:41.846026 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=362032
Step99:rank1, time: 47.851, per_step: 0.478506
Step99:rank2, time: 47.851, per_step: 0.478506
Step99:rank3, time: 47.851, per_step: 0.478506
Step99:rank0, time: 47.851, per_step: 0.478506
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
W20240116 11:38:42.115897 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=101, pq.top=101
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
W20240116 11:38:42.200839 19817 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
E20240116 11:38:42.846012 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=375021
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
W20240116 11:38:43.303535 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=106, pq.top=106
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
W20240116 11:38:43.321717 19817 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
E20240116 11:38:43.846086 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=389016
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 427.197 us                | 2.000 ms                  |
| Backward                  | 749.723 us                | 3.529 ms                  |
| Optimize                  | 108.322 us                | 402.795 us                |
| BarrierTimeBeforeRank0    | 625.413 us                | 7.862 ms                  |
| AfterBackward             | 85.633 ms                 | 108.245 ms                |
| BlockToStepN              | 16.137 ms                 | 18.053 ms                 |
| E2E-100                   | 25.376 s                  | 25.376 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
W20240116 11:38:44.325074 19817 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
W20240116 11:38:44.477421 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=111, pq.top=111
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
E20240116 11:38:44.846066 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=403279
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
W20240116 11:38:45.454875 19817 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
W20240116 11:38:45.672065 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=116, pq.top=116
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
E20240116 11:38:45.846006 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=232
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240116 11:38:46.467777 19817 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.627 ms                  | 5.598 ms                  |
| ProcessBack:UpdateCache   | 5.545 ms                  | 9.799 ms                  |
| ProcessBack:UpsertPq      | 76.886 ms                 | 97.899 ms                 |
| ProcessOneStep            | 85.129 ms                 | 108.136 ms                |
| BlockToStepN              | 15.972 ms                 | 17.945 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:38:46.846061 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240116 11:38:46.854223 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=121, pq.top=121
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240116 11:38:47.589469 19817 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240116 11:38:47.846063 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=443510
W20240116 11:38:48.041483 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=126, pq.top=126
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
W20240116 11:38:48.598695 19817 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
E20240116 11:38:48.846009 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=457330
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 421.075 us                | 2.000 ms                  |
| Backward                  | 775.825 us                | 3.529 ms                  |
| Optimize                  | 107.375 us                | 402.795 us                |
| BarrierTimeBeforeRank0    | 431.274 us                | 7.862 ms                  |
| AfterBackward             | 85.020 ms                 | 108.245 ms                |
| BlockToStepN              | 16.050 ms                 | 18.053 ms                 |
| E2E-100                   | 25.376 s                  | 25.376 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 11:38:49.221825 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=131, pq.top=131
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240116 11:38:49.706776 19817 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 11:38:49.849712 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
W20240116 11:38:50.398347 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=136, pq.top=136
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
W20240116 11:38:50.711110 19817 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 11:38:50.849081 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=165
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
W20240116 11:38:51.558327 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=141, pq.top=141
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.613 ms                  | 5.598 ms                  |
| ProcessBack:UpdateCache   | 5.540 ms                  | 9.799 ms                  |
| ProcessBack:UpsertPq      | 76.200 ms                 | 97.899 ms                 |
| ProcessOneStep            | 84.657 ms                 | 108.136 ms                |
| BlockToStepN              | 15.934 ms                 | 18.053 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
W20240116 11:38:51.806485 19817 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 11:38:51.849016 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=496079
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
W20240116 11:38:52.719223 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=146, pq.top=146
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
W20240116 11:38:52.834252 19817 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 11:38:52.849026 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=509620
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
E20240116 11:38:53.849022 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=523499
W20240116 11:38:53.894481 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=151, pq.top=151
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240116 11:38:53.912865 19817 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 418.611 us                | 771.195 us                |
| Backward                  | 931.602 us                | 2.448 ms                  |
| Optimize                  | 107.331 us                | 244.384 us                |
| BarrierTimeBeforeRank0    | 345.281 us                | 4.799 ms                  |
| AfterBackward             | 84.503 ms                 | 107.850 ms                |
| BlockToStepN              | 16.022 ms                 | 18.053 ms                 |
| E2E-100                   | 25.376 s                  | 25.376 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
E20240116 11:38:54.849078 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=534066
W20240116 11:38:54.991948 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=155, pq.top=155
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
W20240116 11:38:55.012221 19817 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
E20240116 11:38:55.849023 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=544681
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
W20240116 11:38:56.022660 19817 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
W20240116 11:38:56.213665 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=159, pq.top=159
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.602 ms                  | 3.748 ms                  |
| ProcessBack:UpdateCache   | 5.543 ms                  | 7.994 ms                  |
| ProcessBack:UpsertPq      | 76.094 ms                 | 97.899 ms                 |
| ProcessOneStep            | 84.475 ms                 | 108.136 ms                |
| BlockToStepN              | 15.979 ms                 | 20.037 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:38:56.849011 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=19
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240116 11:38:57.029701 19817 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
W20240116 11:38:57.490607 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=163, pq.top=163
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
E20240116 11:38:57.849016 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=564330
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
W20240116 11:38:58.118827 19817 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
W20240116 11:38:58.665143 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=167, pq.top=167
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
E20240116 11:38:58.849047 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=574953
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 425.366 us                | 845.672 us                |
| Backward                  | 1.171 ms                  | 2.448 ms                  |
| Optimize                  | 107.375 us                | 252.410 us                |
| BarrierTimeBeforeRank0    | 294.335 us                | 4.799 ms                  |
| AfterBackward             | 84.578 ms                 | 108.245 ms                |
| BlockToStepN              | 16.191 ms                 | 20.358 ms                 |
| E2E-100                   | 25.376 s                  | 25.376 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
W20240116 11:38:59.247170 19817 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
W20240116 11:38:59.795681 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=171, pq.top=171
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
E20240116 11:38:59.849031 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=585791
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
W20240116 11:39:00.384907 19817 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
E20240116 11:39:00.849013 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=596608
W20240116 11:39:00.931578 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=175, pq.top=175
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
W20240116 11:39:01.519630 19817 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.597 ms                  | 3.748 ms                  |
| ProcessBack:UpdateCache   | 5.545 ms                  | 7.994 ms                  |
| ProcessBack:UpsertPq      | 76.009 ms                 | 97.899 ms                 |
| ProcessOneStep            | 84.360 ms                 | 108.136 ms                |
| BlockToStepN              | 16.188 ms                 | 20.275 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
E20240116 11:39:01.849013 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=607335
W20240116 11:39:02.061633 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=179, pq.top=179
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
W20240116 11:39:02.650498 19817 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
E20240116 11:39:02.849010 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=1726
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
W20240116 11:39:03.195430 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=183, pq.top=183
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
W20240116 11:39:03.776017 19817 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 11:39:03.849025 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=589
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 425.366 us                | 845.672 us                |
| Backward                  | 1.197 ms                  | 2.448 ms                  |
| Optimize                  | 107.952 us                | 252.410 us                |
| BarrierTimeBeforeRank0    | 246.978 us                | 4.799 ms                  |
| AfterBackward             | 84.280 ms                 | 108.245 ms                |
| BlockToStepN              | 16.306 ms                 | 20.358 ms                 |
| E2E-100                   | 25.376 s                  | 25.376 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 11:39:04.313143 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=187, pq.top=187
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
E20240116 11:39:04.849031 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=639851
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240116 11:39:04.894847 19817 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
W20240116 11:39:05.433957 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=191, pq.top=191
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
E20240116 11:39:05.849018 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=650459
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240116 11:39:06.018509 19817 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
W20240116 11:39:06.552102 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=195, pq.top=195
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.588 ms                  | 3.748 ms                  |
| ProcessBack:UpdateCache   | 5.545 ms                  | 7.994 ms                  |
| ProcessBack:UpsertPq      | 75.737 ms                 | 97.899 ms                 |
| ProcessOneStep            | 84.177 ms                 | 108.136 ms                |
| BlockToStepN              | 16.329 ms                 | 20.275 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
E20240116 11:39:06.849010 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=661293
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
W20240116 11:39:07.131299 19817 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
W20240116 11:39:07.667066 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=199, pq.top=199
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
E20240116 11:39:07.849014 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=671988
Step199:rank2, time: 26.073, per_step: 0.258149
Step199:rank3, time: 26.073, per_step: 0.258149
Step199:rank1, time: 26.073, per_step: 0.258149
Step199:rank0, time: 26.073, per_step: 0.258149
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
W20240116 11:39:08.242775 19817 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
W20240116 11:39:08.776785 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=203, pq.top=203
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
E20240116 11:39:08.849123 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=682844
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 424.415 us                | 845.672 us                |
| Backward                  | 1.206 ms                  | 2.448 ms                  |
| Optimize                  | 107.928 us                | 252.410 us                |
| BarrierTimeBeforeRank0    | 213.555 us                | 4.799 ms                  |
| AfterBackward             | 84.005 ms                 | 108.245 ms                |
| BlockToStepN              | 16.502 ms                 | 20.736 ms                 |
| E2E-100                   | 25.376 s                  | 26.073 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
W20240116 11:39:09.410714 19817 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
E20240116 11:39:09.849041 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=692905
W20240116 11:39:09.938102 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=207, pq.top=207
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
W20240116 11:39:10.522281 19817 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
E20240116 11:39:10.849057 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=703784
W20240116 11:39:11.050402 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=211, pq.top=211
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
W20240116 11:39:11.627573 19817 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.585 ms                  | 3.748 ms                  |
| ProcessBack:UpdateCache   | 5.553 ms                  | 7.994 ms                  |
| ProcessBack:UpsertPq      | 75.546 ms                 | 98.177 ms                 |
| ProcessOneStep            | 83.891 ms                 | 110.696 ms                |
| BlockToStepN              | 16.459 ms                 | 21.097 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:39:11.849030 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=1803
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
W20240116 11:39:12.165108 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=215, pq.top=215
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
W20240116 11:39:12.756518 19817 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 11:39:12.849047 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=699
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
W20240116 11:39:13.358386 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=219, pq.top=219
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
W20240116 11:39:13.786775 19817 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 11:39:13.849017 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=734945
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 424.881 us                | 845.672 us                |
| Backward                  | 1.214 ms                  | 2.448 ms                  |
| Optimize                  | 108.304 us                | 252.410 us                |
| BarrierTimeBeforeRank0    | 185.760 us                | 4.799 ms                  |
| AfterBackward             | 83.834 ms                 | 110.757 ms                |
| BlockToStepN              | 16.539 ms                 | 21.287 ms                 |
| E2E-100                   | 25.376 s                  | 26.073 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
W20240116 11:39:14.470250 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=223, pq.top=223
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
W20240116 11:39:14.815907 19817 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
E20240116 11:39:14.849014 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=745143
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
W20240116 11:39:15.597275 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=227, pq.top=227
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
E20240116 11:39:15.849012 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=755743
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
W20240116 11:39:15.895411 19817 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
W20240116 11:39:16.711458 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=231, pq.top=231
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.575 ms                  | 3.748 ms                  |
| ProcessBack:UpdateCache   | 5.562 ms                  | 7.994 ms                  |
| ProcessBack:UpsertPq      | 75.288 ms                 | 98.177 ms                 |
| ProcessOneStep            | 83.675 ms                 | 110.696 ms                |
| BlockToStepN              | 16.562 ms                 | 21.211 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:39:16.849009 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=933
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
W20240116 11:39:17.012427 19817 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
W20240116 11:39:17.849882 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=235, pq.top=235
E20240116 11:39:17.850719 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=776200
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
W20240116 11:39:18.145972 19817 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
E20240116 11:39:18.850018 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=786769
W20240116 11:39:18.965327 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=239, pq.top=239
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 425.314 us                | 845.672 us                |
| Backward                  | 1.224 ms                  | 2.448 ms                  |
| Optimize                  | 108.322 us                | 252.410 us                |
| BarrierTimeBeforeRank0    | 139.962 us                | 4.799 ms                  |
| AfterBackward             | 83.634 ms                 | 110.757 ms                |
| BlockToStepN              | 16.665 ms                 | 21.287 ms                 |
| E2E-100                   | 25.376 s                  | 26.073 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
W20240116 11:39:19.264910 19817 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
E20240116 11:39:19.850014 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=797768
W20240116 11:39:20.082928 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=243, pq.top=243
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
W20240116 11:39:20.386143 19817 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
E20240116 11:39:20.850009 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=807939
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
W20240116 11:39:21.220983 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=247, pq.top=247
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
W20240116 11:39:21.528365 19817 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.569 ms                  | 3.748 ms                  |
| ProcessBack:UpdateCache   | 5.569 ms                  | 7.994 ms                  |
| ProcessBack:UpsertPq      | 75.160 ms                 | 98.177 ms                 |
| ProcessOneStep            | 83.395 ms                 | 110.696 ms                |
| BlockToStepN              | 16.622 ms                 | 21.211 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
E20240116 11:39:21.850015 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=817997
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
W20240116 11:39:22.364156 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=251, pq.top=251
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
W20240116 11:39:22.666723 19817 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 11:39:22.850020 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=828209
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
W20240116 11:39:23.495381 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=255, pq.top=255
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
W20240116 11:39:23.797271 19817 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 11:39:23.850049 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=838634
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 425.366 us                | 771.195 us                |
| Backward                  | 1.226 ms                  | 1.868 ms                  |
| Optimize                  | 108.322 us                | 244.384 us                |
| BarrierTimeBeforeRank0    | 138.580 us                | 3.558 ms                  |
| AfterBackward             | 83.292 ms                 | 108.245 ms                |
| BlockToStepN              | 16.789 ms                 | 21.177 ms                 |
| E2E-100                   | 25.376 s                  | 26.073 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
W20240116 11:39:24.618319 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=259, pq.top=259
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
E20240116 11:39:24.850011 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=849307
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
W20240116 11:39:24.917533 19817 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
W20240116 11:39:25.745669 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=263, pq.top=263
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
E20240116 11:39:25.850059 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=859146
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
W20240116 11:39:26.050431 19817 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.558 ms                  | 3.419 ms                  |
| ProcessBack:UpdateCache   | 5.570 ms                  | 6.990 ms                  |
| ProcessBack:UpsertPq      | 74.690 ms                 | 97.899 ms                 |
| ProcessOneStep            | 83.122 ms                 | 108.136 ms                |
| BlockToStepN              | 16.724 ms                 | 21.105 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:39:26.850010 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=869365
W20240116 11:39:26.874001 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=267, pq.top=267
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
W20240116 11:39:27.177047 19817 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
E20240116 11:39:27.850009 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=2025
W20240116 11:39:27.913583 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=271, pq.top=271
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
W20240116 11:39:28.196328 19817 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
E20240116 11:39:28.850010 18629 parallel_pq_v2.h:76] insert failed, size(hashtable)=1572
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 425.528 us                | 816.726 us                |
| Backward                  | 1.216 ms                  | 1.868 ms                  |
| Optimize                  | 109.021 us                | 244.384 us                |
| BarrierTimeBeforeRank0    | 187.924 us                | 3.558 ms                  |
| AfterBackward             | 82.786 ms                 | 108.245 ms                |
| BlockToStepN              | 16.811 ms                 | 21.186 ms                 |
| E2E-100                   | 25.376 s                  | 26.073 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 11:39:29.098404 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=276, pq.top=276
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
W20240116 11:39:29.215797 19817 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
E20240116 11:39:29.850021 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=245
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
W20240116 11:39:30.291074 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=281, pq.top=281
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
W20240116 11:39:30.311311 19817 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
E20240116 11:39:30.850016 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=916192
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
W20240116 11:39:31.325559 19817 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
W20240116 11:39:31.478816 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=286, pq.top=286
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.553 ms                  | 3.419 ms                  |
| ProcessBack:UpdateCache   | 5.575 ms                  | 6.990 ms                  |
| ProcessBack:UpsertPq      | 74.269 ms                 | 97.899 ms                 |
| ProcessOneStep            | 82.597 ms                 | 108.136 ms                |
| BlockToStepN              | 16.688 ms                 | 21.105 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:39:31.850008 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=928057
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
W20240116 11:39:32.450563 19817 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
W20240116 11:39:32.670466 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=291, pq.top=291
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
E20240116 11:39:32.850011 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=940755
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
W20240116 11:39:33.461217 19817 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
W20240116 11:39:33.851790 18629 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=296, pq.top=296
E20240116 11:39:33.852332 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=951647
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 425.528 us                | 816.726 us                |
| Backward                  | 1.206 ms                  | 1.868 ms                  |
| Optimize                  | 109.021 us                | 244.384 us                |
| BarrierTimeBeforeRank0    | 301.586 us                | 3.558 ms                  |
| AfterBackward             | 82.560 ms                 | 108.245 ms                |
| BlockToStepN              | 16.799 ms                 | 21.186 ms                 |
| E2E-100                   | 25.376 s                  | 26.073 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
W20240116 11:39:34.589085 19817 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
Step299:rank3, time: 26.864, per_step: 0.265979
Step299:rank2, time: 26.864, per_step: 0.265979
Step299:rank0, time: 26.864, per_step: 0.265978
Step299:rank1, time: 26.864, per_step: 0.265979
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
E20240116 11:39:34.852022 19817 parallel_pq_v2.h:76] insert failed, size(hashtable)=964646
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
ERROR [18629 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
*** Aborted at 1705376376 (Unix time, try 'date -d @1705376376') ***
*** Signal 11 (SIGSEGV) (0x100000623980) received by PID 18629 (pthread TID 0x7f8cf9887700) (linux TID 19804) (code: address not mapped to object), stack trace: ***
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN5folly10symbolizer17getStackTraceSafeEPmm+0x7c)[0x7f90f133b115]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN5folly10symbolizer21SafeStackTracePrinter15printStackTraceEb+0x66)[0x7f90f12f2d14]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(+0x7c71d9)[0x7f90f12f11d9]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(+0x7c72b6)[0x7f90f12f12b6]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x1297f)[0x7f9233e5b97f]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53df1c5)[0x7f913a0611c5]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZNK2at18TensorIteratorBase15serial_for_eachEN3c1012function_refIFvPPcPKlllEEENS_5RangeE+0x17b)[0x7f9135fea63b]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at18TensorIteratorBase8for_eachEN3c1012function_refIFvPPcPKlllEEEl+0x16e)[0x7f9135feabbe]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53e7cca)[0x7f913a069cca]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53e9bed)[0x7f913a06bbed]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x19a56bd)[0x7f91366276bd]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at6native28structured_index_add_cpu_out4implERKNS_6TensorElS4_S4_RKN3c106ScalarES4_+0x2b6)[0x7f913663ed06]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x2600f2d)[0x7f9137282f2d]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_10redispatchEN3c1014DispatchKeySetERNS_6TensorElRKS4_S7_RKNS2_6ScalarE+0x99)[0x7f9137160629]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x4580b9d)[0x7f9139202b9d]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_10redispatchEN3c1014DispatchKeySetERNS_6TensorElRKS4_S7_RKNS2_6ScalarE+0x99)[0x7f9137160629]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x3f86b23)[0x7f9138c08b23]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_4callERNS_6TensorElRKS2_S5_RKN3c106ScalarE+0x196)[0x7f91371c2d46]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNK2at6Tensor10index_add_ElRKS0_S2_RKN3c106ScalarE+0x3a)[0x7f90f1129582]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN8recstore21GradAsyncProcessingV214GradWorkThreadEi+0x2d4)[0x7f90f113880a]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt13__invoke_implIvRMN8recstore21GradAsyncProcessingV2EFviERPS1_JRiEET_St21__invoke_memfun_derefOT0_OT1_DpOT2_+0x7d)[0x7f90f11a8ede]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt8__invokeIRMN8recstore21GradAsyncProcessingV2EFviEJRPS1_RiEENSt15__invoke_resultIT_JDpT0_EE4typeEOS9_DpOSA_+0x4e)[0x7f90f11a8e2e]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS1_iEE6__callIvJEJLm0ELm1EEEET_OSt5tupleIJDpT0_EESt12_Index_tupleIJXspT1_EEE+0x83)[0x7f90f11a8d4b]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS1_iEEclIJEvEET0_DpOT_+0x32)[0x7f90f11a8c48]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt13__invoke_implIvSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS2_iEEJEET_St14__invoke_otherOT0_DpOT1_+0x1f)[0x7f90f11a8a85]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt8__invokeISt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS2_iEEJEENSt15__invoke_resultIT_JDpT0_EE4typeEOS9_DpOSA_+0x1f)[0x7f90f11a8918]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt6thread8_InvokerISt5tupleIJSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS4_iEEEEE9_M_invokeIJLm0EEEEvSt12_Index_tupleIJXspT_EEE+0x27)[0x7f90f11a882d]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt6thread8_InvokerISt5tupleIJSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS4_iEEEEEclEv+0x17)[0x7f90f11a8797]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt6thread11_State_implINS_8_InvokerISt5tupleIJSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS5_iEEEEEEE6_M_runEv+0x1b)[0x7f90f11a869f]
/home/xieminhui/miniconda3/bin/../lib/libstdc++.so.6(+0xd3e94)[0x7f9147076e94]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x76da)[0x7f9233e506da]
/lib/x86_64-linux-gnu/libc.so.6(clone+0x3e)[0x7f92333d461e]
(safe mode, symbolizer not available)
