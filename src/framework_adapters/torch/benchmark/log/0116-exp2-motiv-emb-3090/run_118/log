WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240116 22:19:01.818185 10991 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240116 22:19:01.821746 10991 IPCTensor.h:367] NewIPCTensor: full_emb [100000000, 32]0x100000002000
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:165: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [10991 perf_emb.py:165] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f5f156f1a80>==========
Worker 1 pid=11170
Worker 2 pid=11171
INFO [10991 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [11170 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [11172 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [11171 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [11171 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [11172 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [10991 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [11170 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 22:19:03.616758 11172 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 22:19:03.616760 11171 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 22:19:03.616859 10991 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 22:19:03.617022 11170 IPCTensor.h:346] IPCTensor full_emb already exists
W20240116 22:19:03.646703 10991 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [20000000, 32]; dev=0; size=2.384 GB
W20240116 22:19:03.646790 11172 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [20000000, 32]; dev=3; size=2.384 GB
W20240116 22:19:03.646792 11170 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [20000000, 32]; dev=1; size=2.384 GB
W20240116 22:19:03.646792 11171 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [20000000, 32]; dev=2; size=2.384 GB
W20240116 22:19:04.293272 10991 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1002faf0e000
W20240116 22:19:04.293519 10991 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1002fafd3000
W20240116 22:19:04.293594 10991 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 32]0x1002fb098000
W20240116 22:19:04.293666 10991 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 32]0x1002fbccf000
W20240116 22:19:04.293722 10991 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 22:19:04.295325 11170 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1002fc908000
W20240116 22:19:04.295516 11170 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x1002fc9cd000
W20240116 22:19:04.295624 11170 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 32]0x1002fca92000
W20240116 22:19:04.295698 11170 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 32]0x1002fd6c9000
W20240116 22:19:04.295765 11170 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 22:19:04.296097 11171 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1002fe302000
W20240116 22:19:04.296322 11171 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x1002fe3c7000
W20240116 22:19:04.296422 11171 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 32]0x1002fe48c000
W20240116 22:19:04.296489 11171 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 32]0x1002ff0c3000
W20240116 22:19:04.296571 11171 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 22:19:04.297133 10991 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 22:19:04.301543 11170 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 22:19:04.302661 11171 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 22:19:04.304052 11172 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x1002ffd04000
W20240116 22:19:04.304235 11172 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1002ffdc9000
W20240116 22:19:04.304307 11172 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 32]0x1002ffe8e000
W20240116 22:19:04.304340 11172 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 32]0x100300ac5000
W20240116 22:19:04.304373 11172 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240116 22:19:04.306555 11172 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 32]; dev=3; size=12.21 MB
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
Worker 3 pid=11172
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 20000000), (20000000, 40000000), (40000000, 60000000), (60000000, 80000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240116 22:19:07.509187 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x100301704000
W20240116 22:19:07.509303 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1003017c9000
W20240116 22:19:07.509346 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x10030188e000
W20240116 22:19:07.509373 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100301953000
W20240116 22:19:07.509398 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100301a18000
W20240116 22:19:07.509438 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100301add000
W20240116 22:19:07.509470 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100301ba2000
W20240116 22:19:07.509493 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x100301c67000
W20240116 22:19:07.509516 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100301d2c000
W20240116 22:19:07.509557 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100301eb6000
W20240116 22:19:07.509548 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100301df1000
W20240116 22:19:07.509593 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x100302040000
W20240116 22:19:07.509596 11172 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100302105000
W20240116 22:19:07.509634 11172 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x1003021ca000
W20240116 22:19:07.509640 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x1003021cc000
W20240116 22:19:07.509661 11172 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x100302291000
W20240116 22:19:07.509670 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100302293000
W20240116 22:19:07.509613 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100301f7b000
W20240116 22:19:07.509673 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100302358000
W20240116 22:19:07.509698 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x10030241d000
W20240116 22:19:07.509711 11172 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1003024e2000
W20240116 22:19:07.509732 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1003024e4000
W20240116 22:19:07.509752 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x1003025a9000
W20240116 22:19:07.509773 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x10030266e000
W20240116 22:19:07.509783 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100302733000
W20240116 22:19:07.509807 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x1003027f8000
W20240116 22:19:07.509811 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1003028bd000
W20240116 22:19:07.509842 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100302982000
W20240116 22:19:07.509871 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100302a47000
W20240116 22:19:07.509873 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x100302b0c000
W20240116 22:19:07.509896 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x100302bd1000
W20240116 22:19:07.509903 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100302c96000
W20240116 22:19:07.509920 11170 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100302d5b000
W20240116 22:19:07.509936 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100302e20000
W20240116 22:19:07.509938 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100302ee5000
W20240116 22:19:07.509965 11170 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100302faa000
W20240116 22:19:07.509971 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x100302fac000
W20240116 22:19:07.509994 11170 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100303071000
W20240116 22:19:07.510003 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x100303073000
W20240116 22:19:07.510010 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x100303138000
Construct PerfSampler done
W20240116 22:19:07.510046 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x1003031fd000
W20240116 22:19:07.510051 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x1003032c2000
W20240116 22:19:07.510056 11170 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100303387000
W20240116 22:19:07.510080 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x100303389000
W20240116 22:19:07.510102 11171 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10030344e000
I20240116 22:19:07.510110 11172 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240116 22:19:07.510123 10991 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x100303513000
W20240116 22:19:07.510152 11171 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x1003035d8000
W20240116 22:19:07.510159 10991 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1003035da000
W20240116 22:19:07.510185 11171 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x1003035dc000
W20240116 22:19:07.510188 10991 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1003035de000
W20240116 22:19:07.510221 10991 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1003035e0000
W20240116 22:19:07.510247 11171 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1003035e2000
Construct PerfSampler done
I20240116 22:19:07.510484 11170 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
Construct PerfSampler done
Construct PerfSampler done
I20240116 22:19:07.510583 10991 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240116 22:19:07.510620 11171 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240116 22:19:07.511384 10991 grad_base.h:54] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.2,
        "backgrad_init": "both"
    }
W20240116 22:19:07.511441 10991 grad_base.h:169] Init GradProcessingBase done
I20240116 22:19:16.417877 10991 grad_async_v2.h:32] Use background thread to update emb.
W20240116 22:19:16.418169 10991 kg_controller.h:78] after init GradAsyncProcessingV2
I20240116 22:19:16.418174 10991 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240116 22:19:16.851171 10991 grad_base.h:59] GraphEnv RegTensorsPerProcess
W20240116 22:19:18.209447 11973 grad_async_v2.h:118] Detect new sample comes, old_end0, new_end1
E20240116 22:19:18.209758 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240116 22:19:19.209026 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240116 22:19:19.241680 11973 grad_async_v2.h:118] Detect new sample comes, old_end4, new_end5
Before Training
I20240116 22:19:20.013450 11170 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
Before Training
I20240116 22:19:20.054427 11171 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 22:19:20.095419 11172 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 22:19:20.134721 10991 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240116 22:19:20.209054 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240116 22:19:20.283203 11973 grad_async_v2.h:118] Detect new sample comes, old_end0, new_end1
E20240116 22:19:21.214612 10991 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240116 22:19:21.245903 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240116 22:19:21.318217 11973 grad_async_v2.h:118] Detect new sample comes, old_end1, new_end2
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.171 ms                  | 219.685 ms                |
| ProcessBack:UpdateCache   | 7.012 ms                  | 776.632 ms                |
| ProcessBack:UpsertPq      | 29.208 ms                 | 40.934 ms                 |
| ProcessOneStep            | 40.506 ms                 | 1.030 s                   |
| BlockToStepN              | 6.515 ms                  | 7.653 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
E20240116 22:19:22.214012 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=533
W20240116 22:19:22.287969 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=14, pq.top=14
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240116 22:19:22.334152 11973 grad_async_v2.h:118] Detect new sample comes, old_end4, new_end5
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 114.555 us                | 147.968 us                |
| GenInput                  | 359.190 us                | 2.064 ms                  |
| Forward                   | 345.008 us                | 48.018 ms                 |
| Backward                  | 815.553 us                | 29.840 ms                 |
| Optimize                  | 106.913 us                | 469.489 us                |
| BarrierTimeBeforeRank0    | 20.370 us                 | 530.885 us                |
| AfterBackward             | 41.862 ms                 | 1.030 s                   |
| BlockToStepN              | 5.763 ms                  | 7.706 ms                  |
| OneStep                   | 47.611 ms                 | 1.117 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
E20240116 22:19:23.214018 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=42
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240116 22:19:23.334671 11973 grad_async_v2.h:118] Detect new sample comes, old_end9, new_end0
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
W20240116 22:19:23.799046 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=40, pq.top=40
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
E20240116 22:19:24.214746 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=382
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
W20240116 22:19:24.694902 11973 grad_async_v2.h:118] Detect new sample comes, old_end6, new_end7
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
W20240116 22:19:25.155747 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=56, pq.top=56
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
E20240116 22:19:25.214008 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=162
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
W20240116 22:19:25.971860 11973 grad_async_v2.h:118] Detect new sample comes, old_end3, new_end4
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
E20240116 22:19:26.214011 10991 parallel_pq_v2.h:76] insert failed, size(hashtable)=70852
W20240116 22:19:26.231287 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=67, pq.top=67
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.036 ms                  | 46.401 ms                 |
| ProcessBack:UpdateCache   | 5.785 ms                  | 8.103 ms                  |
| ProcessBack:UpsertPq      | 28.035 ms                 | 45.655 ms                 |
| ProcessOneStep            | 39.495 ms                 | 401.627 ms                |
| BlockToStepN              | 169.970 us                | 305.083 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
W20240116 22:19:26.977098 11973 grad_async_v2.h:118] Detect new sample comes, old_end1, new_end2
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
E20240116 22:19:27.214042 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=647
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
W20240116 22:19:27.354571 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=89, pq.top=89
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 92.196 us                 | 147.968 us                |
| GenInput                  | 322.304 us                | 19.209 ms                 |
| Forward                   | 257.650 us                | 1.320 ms                  |
| Backward                  | 589.526 us                | 1.324 ms                  |
| Optimize                  | 82.169 us                 | 198.605 us                |
| BarrierTimeBeforeRank0    | 116.808 us                | 1.990 ms                  |
| AfterBackward             | 39.518 ms                 | 401.702 ms                |
| BlockToStepN              | 245.197 us                | 305.140 ms                |
| OneStep                   | 43.429 ms                 | 685.251 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank0, time: 20.342, per_step: 0.203422
Step99:rank1, time: 20.342, per_step: 0.203422
Step99:rank3, time: 20.342, per_step: 0.203422
Step99:rank2, time: 20.342, per_step: 0.203422
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
W20240116 22:19:28.002686 11973 grad_async_v2.h:118] Detect new sample comes, old_end1, new_end2
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
E20240116 22:19:28.214016 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=412984
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
W20240116 22:19:29.064615 11973 grad_async_v2.h:118] Detect new sample comes, old_end8, new_end9
W20240116 22:19:29.157464 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=119, pq.top=119
E20240116 22:19:29.214008 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=18583
W20240116 22:19:30.157043 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=119, pq.top=119
E20240116 22:19:30.217310 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=45723
W20240116 22:19:31.157124 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=119, pq.top=119
E20240116 22:19:31.217134 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=50077
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240116 22:19:31.600621 11973 grad_async_v2.h:118] Detect new sample comes, old_end9, new_end0
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.073 ms                  | 46.401 ms                 |
| ProcessBack:UpdateCache   | 5.807 ms                  | 8.103 ms                  |
| ProcessBack:UpsertPq      | 28.035 ms                 | 59.224 ms                 |
| ProcessOneStep            | 38.641 ms                 | 401.627 ms                |
| BlockToStepN              | 245.538 us                | 409.344 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240116 22:19:32.157143 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=128, pq.top=128
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
E20240116 22:19:32.217010 10991 parallel_pq_v2.h:76] insert failed, size(hashtable)=206
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 97.857 us                 | 180.203 us                |
| GenInput                  | 329.975 us                | 19.209 ms                 |
| Forward                   | 261.980 us                | 1.320 ms                  |
| Backward                  | 631.836 us                | 1.639 ms                  |
| Optimize                  | 84.417 us                 | 198.605 us                |
| BarrierTimeBeforeRank0    | 78.247 us                 | 1.990 ms                  |
| AfterBackward             | 38.881 ms                 | 401.702 ms                |
| BlockToStepN              | 302.666 us                | 409.471 ms                |
| OneStep                   | 42.861 ms                 | 1.117 s                   |
| E2E-100                   | 7.717 s                   | 7.717 s                   |
+---------------------------+---------------------------+---------------------------+
W20240116 22:19:32.643669 11973 grad_async_v2.h:118] Detect new sample comes, old_end8, new_end3
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240116 22:19:33.157209 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=144, pq.top=144
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240116 22:19:33.217007 10991 parallel_pq_v2.h:76] insert failed, size(hashtable)=1395
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
W20240116 22:19:33.644886 11973 grad_async_v2.h:118] Detect new sample comes, old_end7, new_end8
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240116 22:19:34.157307 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=162, pq.top=162
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
E20240116 22:19:34.217008 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=428557
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
W20240116 22:19:34.678608 11973 grad_async_v2.h:118] Detect new sample comes, old_end6, new_end3
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
E20240116 22:19:35.217012 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=612297
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
W20240116 22:19:35.272243 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=185, pq.top=185
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
W20240116 22:19:35.700215 11973 grad_async_v2.h:118] Detect new sample comes, old_end1, new_end5
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
Step199:rank2, time: 8.189, per_step: 0.081082
Step199:rank3, time: 8.189, per_step: 0.081082
Step199:rank1, time: 8.189, per_step: 0.081082
Step199:rank0, time: 8.189, per_step: 0.081082
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
E20240116 22:19:36.217010 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=814090
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
W20240116 22:19:36.272073 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=206, pq.top=206
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
W20240116 22:19:36.717836 11973 grad_async_v2.h:118] Detect new sample comes, old_end1, new_end7
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.937 ms                  | 24.598 ms                 |
| ProcessBack:UpdateCache   | 5.741 ms                  | 7.877 ms                  |
| ProcessBack:UpsertPq      | 22.989 ms                 | 58.230 ms                 |
| ProcessOneStep            | 33.893 ms                 | 390.215 ms                |
| BlockToStepN              | 353.086 us                | 305.083 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
E20240116 22:19:37.217012 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=989707
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
W20240116 22:19:37.332082 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=230, pq.top=230
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 89.097 us                 | 147.968 us                |
| GenInput                  | 342.991 us                | 11.842 ms                 |
| Forward                   | 257.650 us                | 755.198 us                |
| Backward                  | 673.139 us                | 1.324 ms                  |
| Optimize                  | 79.731 us                 | 175.430 us                |
| BarrierTimeBeforeRank0    | 57.922 us                 | 1.770 ms                  |
| AfterBackward             | 33.676 ms                 | 390.253 ms                |
| BlockToStepN              | 421.467 us                | 305.140 ms                |
| OneStep                   | 38.633 ms                 | 685.251 ms                |
| E2E-100                   | 7.717 s                   | 8.189 s                   |
+---------------------------+---------------------------+---------------------------+
W20240116 22:19:37.734951 11973 grad_async_v2.h:118] Detect new sample comes, old_end9, new_end4
E20240116 22:19:38.218276 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=7537
W20240116 22:19:38.332091 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=234, pq.top=234
E20240116 22:19:39.223760 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=8321
W20240116 22:19:39.332156 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=234, pq.top=234
E20240116 22:19:40.230306 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=9084
W20240116 22:19:40.332041 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=234, pq.top=234
E20240116 22:19:41.239773 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=9720
W20240116 22:19:41.332392 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=234, pq.top=234
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
W20240116 22:19:41.743543 11973 grad_async_v2.h:118] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.941 ms                  | 24.598 ms                 |
| ProcessBack:UpdateCache   | 5.741 ms                  | 7.877 ms                  |
| ProcessBack:UpsertPq      | 22.826 ms                 | 58.230 ms                 |
| ProcessOneStep            | 33.658 ms                 | 401.627 ms                |
| BlockToStepN              | 370.511 us                | 409.344 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 22:19:42.332427 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=235, pq.top=234
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 89.756 us                 | 180.203 us                |
| GenInput                  | 343.203 us                | 19.209 ms                 |
| Forward                   | 257.674 us                | 810.439 us                |
| Backward                  | 673.489 us                | 1.639 ms                  |
| Optimize                  | 79.819 us                 | 198.055 us                |
| BarrierTimeBeforeRank0    | 58.184 us                 | 1.770 ms                  |
| AfterBackward             | 33.911 ms                 | 401.702 ms                |
| BlockToStepN              | 421.467 us                | 409.471 ms                |
| OneStep                   | 38.633 ms                 | 1.117 s                   |
| E2E-100                   | 7.717 s                   | 8.189 s                   |
+---------------------------+---------------------------+---------------------------+
E20240116 22:19:42.569542 11971 parallel_pq_v2.h:76] insert failed, size(hashtable)=21776
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
W20240116 22:19:42.760254 11973 grad_async_v2.h:118] Detect new sample comes, old_end5, new_end9
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
W20240116 22:19:43.554857 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=252, pq.top=252
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
E20240116 22:19:43.569005 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=167810
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
W20240116 22:19:43.798558 11973 grad_async_v2.h:118] Detect new sample comes, old_end2, new_end8
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
W20240116 22:19:44.560786 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=270, pq.top=270
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
E20240116 22:19:44.569029 11973 parallel_pq_v2.h:76] insert failed, size(hashtable)=322944
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
W20240116 22:19:44.870308 11973 grad_async_v2.h:118] Detect new sample comes, old_end0, new_end8
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
E20240116 22:19:45.569011 10991 parallel_pq_v2.h:76] insert failed, size(hashtable)=23
W20240116 22:19:45.590417 10991 grad_async_v2.h:275] Sleep in <BlockToStepN>, step_no=291, pq.top=291
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
W20240116 22:19:45.959378 11973 grad_async_v2.h:118] Detect new sample comes, old_end9, new_end0
Step299:rank1, time: 9.985, per_step: 0.098860
Step299:rank3, time: 9.985, per_step: 0.098860
Step299:rank2, time: 9.985, per_step: 0.098860
Step299:rank0, time: 9.985, per_step: 0.098860
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.905 ms                  | 24.598 ms                 |
| ProcessBack:UpdateCache   | 5.735 ms                  | 7.775 ms                  |
| ProcessBack:UpsertPq      | 21.543 ms                 | 55.424 ms                 |
| ProcessOneStep            | 30.751 ms                 | 398.307 ms                |
| BlockToStepN              | 534.038 us                | 409.344 ms                |
+---------------------------+---------------------------+---------------------------+
ERROR [10991 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 88.386 us                 | 147.968 us                |
| GenInput                  | 346.321 us                | 11.842 ms                 |
| Forward                   | 258.704 us                | 755.198 us                |
| Backward                  | 677.096 us                | 1.393 ms                  |
| Optimize                  | 79.648 us                 | 175.430 us                |
| BarrierTimeBeforeRank0    | 68.827 us                 | 1.768 ms                  |
| AfterBackward             | 30.770 ms                 | 398.347 ms                |
| BlockToStepN              | 584.619 us                | 409.471 ms                |
| OneStep                   | 37.535 ms                 | 828.329 ms                |
| E2E-100                   | 8.189 s                   | 9.985 s                   |
+---------------------------+---------------------------+---------------------------+
*** Aborted at 1705414787 (Unix time, try 'date -d @1705414787') ***
*** Signal 11 (SIGSEGV) (0x1000036d0700) received by PID 10991 (pthread TID 0x7f5a3affd700) (linux TID 11962) (code: address not mapped to object), stack trace: ***
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN5folly10symbolizer17getStackTraceSafeEPmm+0x7c)[0x7f5fc8d89881]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN5folly10symbolizer21SafeStackTracePrinter15printStackTraceEb+0x66)[0x7f5fc8d41016]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(+0x5ac4db)[0x7f5fc8d3f4db]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(+0x5ac5b8)[0x7f5fc8d3f5b8]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x1297f)[0x7f610b81b97f]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53df1c5)[0x7f6011a211c5]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZNK2at18TensorIteratorBase15serial_for_eachEN3c1012function_refIFvPPcPKlllEEENS_5RangeE+0x17b)[0x7f600d9aa63b]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at18TensorIteratorBase8for_eachEN3c1012function_refIFvPPcPKlllEEEl+0x16e)[0x7f600d9aabbe]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53e7cca)[0x7f6011a29cca]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53e9bed)[0x7f6011a2bbed]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x19a56bd)[0x7f600dfe76bd]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at6native28structured_index_add_cpu_out4implERKNS_6TensorElS4_S4_RKN3c106ScalarES4_+0x2b6)[0x7f600dffed06]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x2600f2d)[0x7f600ec42f2d]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_10redispatchEN3c1014DispatchKeySetERNS_6TensorElRKS4_S7_RKNS2_6ScalarE+0x99)[0x7f600eb20629]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x4580b9d)[0x7f6010bc2b9d]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_10redispatchEN3c1014DispatchKeySetERNS_6TensorElRKS4_S7_RKNS2_6ScalarE+0x99)[0x7f600eb20629]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x3f86b23)[0x7f60105c8b23]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_4callERNS_6TensorElRKS2_S5_RKN3c106ScalarE+0x196)[0x7f600eb82d46]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN8recstore21GradAsyncProcessingV214GradWorkThreadEi+0x24f)[0x7f5fc8bb749f]
/home/xieminhui/miniconda3/bin/../lib/libstdc++.so.6(+0xd3e94)[0x7f601ea36e94]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x76da)[0x7f610b8106da]
/lib/x86_64-linux-gnu/libc.so.6(clone+0x3e)[0x7f610ad9461e]
(safe mode, symbolizer not available)
