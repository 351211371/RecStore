WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240120 00:47:18.158697 33685 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240120 00:47:18.164031 33685 IPCTensor.h:367] NewIPCTensor: full_emb [100000000, 32]0x100000002000
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [33685 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f0bbe331bc0>==========
Worker 1 pid=34193
Worker 2 pid=34194
Worker 3 pid=34195
Worker 4 pid=34196
Worker 5 pid=34197
Worker 6 pid=34198
INFO [33685 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [34193 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [34194 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [34195 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [34198 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [34196 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [34197 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [34199 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [34199 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34197 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34198 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34196 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34193 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34195 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [34194 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240120 00:47:20.343407 34199 IPCTensor.h:346] IPCTensor full_emb already exists
E20240120 00:47:20.343575 34197 IPCTensor.h:346] IPCTensor full_emb already exists
E20240120 00:47:20.343704 34198 IPCTensor.h:346] IPCTensor full_emb already exists
E20240120 00:47:20.343742 34196 IPCTensor.h:346] IPCTensor full_emb already exists
E20240120 00:47:20.343813 34193 IPCTensor.h:346] IPCTensor full_emb already exists
E20240120 00:47:20.343852 34195 IPCTensor.h:346] IPCTensor full_emb already exists
E20240120 00:47:20.343919 34194 IPCTensor.h:346] IPCTensor full_emb already exists
INFO [33685 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240120 00:47:20.347421 33685 IPCTensor.h:346] IPCTensor full_emb already exists
W20240120 00:47:20.378667 33685 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [5000000, 32]; dev=0; size=610.4 MB
W20240120 00:47:20.378773 34199 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_7 [5000000, 32]; dev=7; size=610.4 MB
W20240120 00:47:20.378769 34197 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_5 [5000000, 32]; dev=5; size=610.4 MB
W20240120 00:47:20.378813 34195 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [5000000, 32]; dev=3; size=610.4 MB
W20240120 00:47:20.378823 34194 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [5000000, 32]; dev=2; size=610.4 MB
W20240120 00:47:20.379119 34196 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_4 [5000000, 32]; dev=4; size=610.4 MB
W20240120 00:47:20.379122 34193 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [5000000, 32]; dev=1; size=610.4 MB
W20240120 00:47:20.379132 34198 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_6 [5000000, 32]; dev=6; size=610.4 MB
W20240120 00:47:21.522204 33685 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1002faf0e000
W20240120 00:47:21.522430 33685 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1002fafd3000
W20240120 00:47:21.522467 33685 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 32]0x1002fb098000
W20240120 00:47:21.522501 33685 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 32]0x1002fbccf000
W20240120 00:47:21.522529 33685 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240120 00:47:21.562541 33685 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240120 00:47:21.568099 34199 IPCTensor.h:367] NewIPCTensor: input_keys_7 [100000]0x1002fc90a000
W20240120 00:47:21.568271 34199 IPCTensor.h:367] NewIPCTensor: input_keys_neg_7 [100000]0x1002fc9cf000
W20240120 00:47:21.568323 34199 IPCTensor.h:367] NewIPCTensor: backward_grads_7 [100000, 32]0x1002fca94000
W20240120 00:47:21.568369 34199 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_7 [100000, 32]0x1002fd6cb000
W20240120 00:47:21.568399 34199 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_7_gpu [100000, 32]; dev=7; size=12.21 MB
W20240120 00:47:21.568693 34195 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x1002fe308000
W20240120 00:47:21.568758 34193 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1002fe3cd000
W20240120 00:47:21.568768 34198 IPCTensor.h:367] NewIPCTensor: input_keys_6 [100000]0x1002fe492000
W20240120 00:47:21.568856 34195 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1002fe559000
W20240120 00:47:21.568907 34198 IPCTensor.h:367] NewIPCTensor: input_keys_neg_6 [100000]0x1002fe61e000
W20240120 00:47:21.568918 34193 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x1002fe6e3000
W20240120 00:47:21.568938 34195 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 32]0x1002fe7a8000
W20240120 00:47:21.568959 34198 IPCTensor.h:367] NewIPCTensor: backward_grads_6 [100000, 32]0x1002ff3df000
W20240120 00:47:21.568985 34193 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 32]0x100300016000
W20240120 00:47:21.569005 34195 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 32]0x100300c4d000
W20240120 00:47:21.569015 34198 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_6 [100000, 32]0x100301884000
W20240120 00:47:21.569041 34198 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_6_gpu [100000, 32]; dev=6; size=12.21 MB
W20240120 00:47:21.569042 34195 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240120 00:47:21.569057 34193 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 32]0x1003024bb000
W20240120 00:47:21.569092 34193 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240120 00:47:21.569380 34194 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1003030f4000
W20240120 00:47:21.569481 34194 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x1003031b9000
W20240120 00:47:21.569526 34194 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 32]0x10030327e000
W20240120 00:47:21.569563 34194 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 32]0x100303eb5000
W20240120 00:47:21.569592 34194 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240120 00:47:21.574568 34199 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 32]; dev=7; size=12.21 MB
W20240120 00:47:21.575459 34198 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 32]; dev=6; size=12.21 MB
W20240120 00:47:21.575488 34195 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240120 00:47:21.575549 34193 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240120 00:47:21.575781 34194 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240120 00:47:21.580686 34197 IPCTensor.h:367] NewIPCTensor: input_keys_5 [100000]0x100304b02000
W20240120 00:47:21.580822 34197 IPCTensor.h:367] NewIPCTensor: input_keys_neg_5 [100000]0x100304bc7000
W20240120 00:47:21.580866 34197 IPCTensor.h:367] NewIPCTensor: backward_grads_5 [100000, 32]0x100304c8c000
W20240120 00:47:21.580910 34197 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_5 [100000, 32]0x1003058c3000
W20240120 00:47:21.580933 34197 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_5_gpu [100000, 32]; dev=5; size=12.21 MB
W20240120 00:47:21.583052 34197 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 32]; dev=5; size=12.21 MB
W20240120 00:47:21.596891 34196 IPCTensor.h:367] NewIPCTensor: input_keys_4 [100000]0x100306500000
W20240120 00:47:21.596998 34196 IPCTensor.h:367] NewIPCTensor: input_keys_neg_4 [100000]0x1003065c5000
W20240120 00:47:21.597043 34196 IPCTensor.h:367] NewIPCTensor: backward_grads_4 [100000, 32]0x10030668a000
W20240120 00:47:21.597085 34196 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_4 [100000, 32]0x1003072c1000
W20240120 00:47:21.597108 34196 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_4_gpu [100000, 32]; dev=4; size=12.21 MB
W20240120 00:47:21.597856 34196 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 32]; dev=4; size=12.21 MB
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
Worker 7 pid=34199
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 5000000), (5000000, 10000000), (10000000, 15000000), (15000000, 20000000), (20000000, 25000000), (25000000, 30000000), (30000000, 35000000), (35000000, 40000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
W20240120 00:47:26.121502 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x100307efc000
W20240120 00:47:26.121937 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x100307fc1000
W20240120 00:47:26.122001 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x100308086000
W20240120 00:47:26.122074 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10030814b000
W20240120 00:47:26.122179 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x1003082d5000
W20240120 00:47:26.122189 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x100308210000
W20240120 00:47:26.122203 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x10030839a000
W20240120 00:47:26.122401 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x100308524000
W20240120 00:47:26.122411 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x10030845f000
W20240120 00:47:26.122457 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x1003085e9000
W20240120 00:47:26.122467 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x1003086ae000
W20240120 00:47:26.122473 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x100308773000
W20240120 00:47:26.122517 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x100308838000
W20240120 00:47:26.122539 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x1003089c2000
W20240120 00:47:26.122542 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100308a87000
W20240120 00:47:26.122599 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x100308b4c000
W20240120 00:47:26.122555 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1003088fd000
W20240120 00:47:26.122633 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x100308c11000
W20240120 00:47:26.122725 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100308cd6000
W20240120 00:47:26.122813 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x100308d9b000
W20240120 00:47:26.122818 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x100308e60000
W20240120 00:47:26.122879 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x100308f25000
W20240120 00:47:26.122893 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x100308fea000
W20240120 00:47:26.122948 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x100309174000
W20240120 00:47:26.122987 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x100309239000
W20240120 00:47:26.122989 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x1003093c3000
W20240120 00:47:26.123016 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x100309488000
W20240120 00:47:26.123054 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x100309612000
W20240120 00:47:26.123108 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x10030979c000
W20240120 00:47:26.123145 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x1003096d7000
W20240120 00:47:26.123147 34197 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x100309926000
W20240120 00:47:26.122972 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x1003092fe000
W20240120 00:47:26.123198 34197 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x1003099eb000
W20240120 00:47:26.123310 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x100309ab2000
W20240120 00:47:26.123320 34197 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x100309b77000
W20240120 00:47:26.123215 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100309861000
W20240120 00:47:26.123345 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x100309c3e000
W20240120 00:47:26.123279 34196 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x1003099ed000
W20240120 00:47:26.123355 34197 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100309d03000
W20240120 00:47:26.123400 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x100309d05000
W20240120 00:47:26.123412 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x100309dca000
W20240120 00:47:26.123457 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x100309f54000
W20240120 00:47:26.123477 34196 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x10030a019000
W20240120 00:47:26.123328 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x100309b79000
W20240120 00:47:26.123497 34199 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x10030a01b000
W20240120 00:47:26.123508 34196 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x10030a0e0000
W20240120 00:47:26.123420 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100309e8f000
W20240120 00:47:26.123518 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x10030a0e2000
W20240120 00:47:26.123551 34199 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x10030a1a9000
Construct PerfSampler done
W20240120 00:47:26.123589 34199 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x10030a270000
W20240120 00:47:26.123605 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x10030a272000
W20240120 00:47:26.123543 34196 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10030a1a7000
W20240120 00:47:26.123621 34199 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10030a337000
W20240120 00:47:26.123641 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x10030a339000
W20240120 00:47:26.123567 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x10030a1ab000
I20240120 00:47:26.123728 34197 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240120 00:47:26.123656 34195 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x10030a3fe000
W20240120 00:47:26.123811 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x10030a4c3000
Construct PerfSampler done
Construct PerfSampler done
I20240120 00:47:26.123992 34199 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240120 00:47:26.123900 34195 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x10030a588000
W20240120 00:47:26.124089 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x10030a58a000
W20240120 00:47:26.123119 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x10030954d000
I20240120 00:47:26.124006 34196 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240120 00:47:26.124248 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x10030a716000
W20240120 00:47:26.124291 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x10030a7db000
W20240120 00:47:26.124157 34195 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x10030a64f000
W20240120 00:47:26.124222 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x10030a651000
W20240120 00:47:26.123281 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x1003090af000
W20240120 00:47:26.124358 34195 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10030a8a0000
W20240120 00:47:26.124402 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x10030a8a2000
W20240120 00:47:26.124495 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x10030a967000
W20240120 00:47:26.124554 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10030aa2c000
Construct PerfSampler done
W20240120 00:47:26.124593 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x10030aaf1000
W20240120 00:47:26.124598 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x10030abb6000
W20240120 00:47:26.124614 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x10030ac7b000
W20240120 00:47:26.124634 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x10030ad40000
W20240120 00:47:26.124640 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x10030ae05000
I20240120 00:47:26.124647 34195 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240120 00:47:26.124682 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x10030aeca000
W20240120 00:47:26.124696 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x10030af8f000
W20240120 00:47:26.124712 34198 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x10030b054000
W20240120 00:47:26.124714 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x10030b119000
W20240120 00:47:26.124743 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x10030b1de000
W20240120 00:47:26.124765 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x10030b2a3000
W20240120 00:47:26.124785 34193 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x10030b368000
W20240120 00:47:26.124823 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10030b42d000
W20240120 00:47:26.124845 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x10030b4f2000
W20240120 00:47:26.124855 34193 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x10030b5b7000
W20240120 00:47:26.124857 34198 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x10030b5b9000
W20240120 00:47:26.124874 33685 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x10030b5bb000
W20240120 00:47:26.124902 34198 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x10030b680000
W20240120 00:47:26.124913 34193 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x10030b682000
W20240120 00:47:26.124920 33685 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x10030b684000
W20240120 00:47:26.124922 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x10030b686000
W20240120 00:47:26.124948 34193 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10030b74b000
W20240120 00:47:26.124953 34198 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10030b74d000
W20240120 00:47:26.124972 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x10030b74f000
W20240120 00:47:26.124977 33685 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x10030b814000
W20240120 00:47:26.125000 33685 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10030b816000
W20240120 00:47:26.125022 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x10030b818000
W20240120 00:47:26.125056 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10030b8dd000
W20240120 00:47:26.125089 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x10030b9a2000
Construct PerfSampler done
W20240120 00:47:26.125138 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x10030ba67000
Construct PerfSampler done
W20240120 00:47:26.125205 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10030bb2c000
Construct PerfSampler done
W20240120 00:47:26.125247 34194 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10030bbf1000
W20240120 00:47:26.125303 34194 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x10030bcb6000
I20240120 00:47:26.125304 34193 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240120 00:47:26.125315 34198 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240120 00:47:26.125326 34194 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x10030bcb8000
I20240120 00:47:26.125327 33685 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240120 00:47:26.125355 34194 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10030bcba000
Construct PerfSampler done
I20240120 00:47:26.125641 34194 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240120 00:47:26.126427 33685 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both"
    }
W20240120 00:47:26.126509 33685 grad_base.h:172] Init GradProcessingBase done
I20240120 00:47:35.376544 33685 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=16
W20240120 00:47:35.376912 33685 kg_controller.h:78] after init GradAsyncProcessingV2
I20240120 00:47:35.376921 33685 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240120 00:47:36.127779 33685 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240120 00:47:38.210290 36352 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240120 00:47:38.210661 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240120 00:47:39.210012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240120 00:47:39.238292 36352 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240120 00:47:40.210022 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240120 00:47:40.332616 36352 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240120 00:47:41.210017 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240120 00:47:41.379231 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240120 00:47:42.210011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240120 00:47:42.389423 36352 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240120 00:47:43.210013 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240120 00:47:43.456718 36352 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
Before Training
I20240120 00:47:43.774924 34197 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240120 00:47:43.838413 34198 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240120 00:47:43.899771 34199 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240120 00:47:43.964323 33685 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240120 00:47:44.027562 34193 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240120 00:47:44.088662 34194 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240120 00:47:44.149701 34195 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240120 00:47:44.204751 34196 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240120 00:47:44.210700 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240120 00:47:44.487075 36352 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240120 00:47:46.024183 33685 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 257.041 ms                | 257.041 ms                |
| ProcessBack:UpdateCache   | 1.454 s                   | 1.454 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 151.518 us                | 151.518 us                |
| GenInput                  | 1.700 ms                  | 1.700 ms                  |
| Forward                   | 45.913 ms                 | 45.913 ms                 |
| Backward                  | 24.076 ms                 | 24.076 ms                 |
| Optimize                  | 600.032 us                | 600.032 us                |
| BarrierTimeBeforeRank0    | 28.108 ms                 | 28.108 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240120 00:47:46.160883 33685 grad_async_v2.h:236] pq is empty
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240120 00:47:46.162395 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
E20240120 00:47:47.024010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
W20240120 00:47:47.226047 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
E20240120 00:47:48.024027 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
W20240120 00:47:48.253962 36352 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240120 00:47:49.024016 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240120 00:47:49.423556 36352 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240120 00:47:50.024012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240120 00:47:50.559947 36352 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240120 00:47:50.867208 33685 grad_async_v2.h:236] pq is empty
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
E20240120 00:47:51.024011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 13.897 ms                 | 257.041 ms                |
| ProcessBack:UpdateCache   | 27.935 ms                 | 1.454 s                   |
| ProcessBack:UpsertPq      | 134.276 ms                | 237.079 ms                |
| ProcessOneStep            | 182.268 ms                | 2.547 s                   |
| BlockToStepN              | 107.953 us                | 252.187 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 141.495 us                | 278.714 us                |
| GenInput                  | 883.285 us                | 3.110 ms                  |
| Forward                   | 396.537 us                | 45.913 ms                 |
| Backward                  | 1.142 ms                  | 24.076 ms                 |
| Optimize                  | 126.499 us                | 600.032 us                |
| BarrierTimeBeforeRank0    | 341.186 us                | 28.108 ms                 |
| AfterBackward             | 182.352 ms                | 2.547 s                   |
| BlockToStepN              | 181.889 us                | 438.865 us                |
| OneStep                   | 185.172 ms                | 2.550 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
W20240120 00:47:51.675908 36352 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
W20240120 00:47:51.965507 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=20, pq.top=20
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
E20240120 00:47:52.024010 33685 parallel_pq_v2.h:76] insert failed, size(hashtable)=2529
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
W20240120 00:47:52.688894 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
E20240120 00:47:53.024036 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240120 00:47:53.898993 36352 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end6
E20240120 00:47:54.024008 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240120 00:47:54.971129 36352 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240120 00:47:55.024011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=79
W20240120 00:47:55.348811 33685 grad_async_v2.h:236] pq is empty
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
E20240120 00:47:56.024082 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=2344
W20240120 00:47:56.028895 36352 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.822 ms                  | 257.041 ms                |
| ProcessBack:UpdateCache   | 20.703 ms                 | 1.454 s                   |
| ProcessBack:UpsertPq      | 127.005 ms                | 377.454 ms                |
| ProcessOneStep            | 165.519 ms                | 2.547 s                   |
| BlockToStepN              | 77.018 us                 | 719.761 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 131.190 us                | 308.510 us                |
| GenInput                  | 813.656 us                | 20.099 ms                 |
| Forward                   | 384.605 us                | 45.913 ms                 |
| Backward                  | 1.088 ms                  | 24.076 ms                 |
| Optimize                  | 119.058 us                | 600.032 us                |
| BarrierTimeBeforeRank0    | 303.473 us                | 28.108 ms                 |
| AfterBackward             | 165.565 ms                | 2.547 s                   |
| BlockToStepN              | 174.789 us                | 786.919 us                |
| OneStep                   | 171.035 ms                | 2.550 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
W20240120 00:47:56.480616 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=31, pq.top=31
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
E20240120 00:47:57.024011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=108
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240120 00:47:57.238355 36352 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end7
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
E20240120 00:47:58.024011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=119
W20240120 00:47:58.343010 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
W20240120 00:47:58.622916 33685 grad_async_v2.h:236] pq is empty
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
W20240120 00:47:58.912133 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=39, pq.top=39
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
E20240120 00:47:59.024008 33685 parallel_pq_v2.h:76] insert failed, size(hashtable)=4405
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
W20240120 00:47:59.390926 36352 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
E20240120 00:48:00.024009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=3163
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
W20240120 00:48:00.419234 36352 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
W20240120 00:48:00.458698 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=52, pq.top=52
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
E20240120 00:48:01.024008 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=666
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.257 ms                 | 16.922 ms                 |
| ProcessBack:UpdateCache   | 20.703 ms                 | 31.522 ms                 |
| ProcessBack:UpsertPq      | 107.398 ms                | 279.835 ms                |
| ProcessOneStep            | 146.236 ms                | 2.494 s                   |
| BlockToStepN              | 88.490 us                 | 18.433 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.011 us                | 317.469 us                |
| GenInput                  | 804.755 us                | 12.620 ms                 |
| Forward                   | 361.270 us                | 1.187 ms                  |
| Backward                  | 1.062 ms                  | 3.215 ms                  |
| Optimize                  | 113.423 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 341.186 us                | 6.602 ms                  |
| AfterBackward             | 146.273 ms                | 2.494 s                   |
| BlockToStepN              | 165.134 us                | 18.545 ms                 |
| OneStep                   | 151.409 ms                | 2.499 s                   |
+---------------------------+---------------------------+---------------------------+
W20240120 00:48:01.453467 36352 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
E20240120 00:48:02.024009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=41525
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
W20240120 00:48:02.139066 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=55, pq.top=55
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
W20240120 00:48:02.489456 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240120 00:48:03.024010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=55350
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240120 00:48:03.250391 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=62, pq.top=62
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240120 00:48:03.699321 36352 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
E20240120 00:48:04.024010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=5536
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240120 00:48:04.774085 36352 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end9
E20240120 00:48:05.024014 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=137
W20240120 00:48:05.877470 36352 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240120 00:48:06.024024 33685 parallel_pq_v2.h:76] insert failed, size(hashtable)=858
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.071 ms                 | 16.922 ms                 |
| ProcessBack:UpdateCache   | 20.536 ms                 | 31.522 ms                 |
| ProcessBack:UpsertPq      | 98.797 ms                 | 279.835 ms                |
| ProcessOneStep            | 136.392 ms                | 2.494 s                   |
| BlockToStepN              | 107.953 us                | 81.546 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 125.853 us                | 317.469 us                |
| GenInput                  | 813.656 us                | 12.620 ms                 |
| Forward                   | 356.252 us                | 1.187 ms                  |
| Backward                  | 1.040 ms                  | 3.215 ms                  |
| Optimize                  | 112.070 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 446.155 us                | 6.602 ms                  |
| AfterBackward             | 136.435 ms                | 2.494 s                   |
| BlockToStepN              | 189.607 us                | 81.675 ms                 |
| OneStep                   | 149.242 ms                | 2.499 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
W20240120 00:48:06.882652 36352 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
E20240120 00:48:07.024012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=825
W20240120 00:48:07.087062 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=79, pq.top=79
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
E20240120 00:48:08.024011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=1948
W20240120 00:48:08.135113 36352 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end2
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
E20240120 00:48:09.024011 33685 parallel_pq_v2.h:76] insert failed, size(hashtable)=29203
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
W20240120 00:48:09.181824 36352 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
E20240120 00:48:10.024009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=5324
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
W20240120 00:48:10.434171 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
E20240120 00:48:11.024010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=5291
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.275 ms                 | 23.338 ms                 |
| ProcessBack:UpdateCache   | 20.532 ms                 | 41.794 ms                 |
| ProcessBack:UpsertPq      | 97.020 ms                 | 279.835 ms                |
| ProcessOneStep            | 135.478 ms                | 2.494 s                   |
| BlockToStepN              | 140.467 us                | 81.546 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.011 us                | 338.914 us                |
| GenInput                  | 791.363 us                | 12.620 ms                 |
| Forward                   | 353.520 us                | 1.187 ms                  |
| Backward                  | 1.040 ms                  | 3.215 ms                  |
| Optimize                  | 113.423 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 335.437 us                | 6.602 ms                  |
| AfterBackward             | 135.519 ms                | 2.494 s                   |
| BlockToStepN              | 224.438 us                | 81.675 ms                 |
| OneStep                   | 143.313 ms                | 2.499 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
W20240120 00:48:11.444033 36352 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
E20240120 00:48:12.024013 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=57
W20240120 00:48:12.608624 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240120 00:48:13.024011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=897
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank1, time: 47.500, per_step: 0.474999
Step99:rank0, time: 47.500, per_step: 0.474999
Step99:rank4, time: 47.500, per_step: 0.474999
Step99:rank6, time: 47.500, per_step: 0.474999
Step99:rank7, time: 47.500, per_step: 0.474999
Step99:rank5, time: 47.500, per_step: 0.474999
Step99:rank2, time: 47.500, per_step: 0.475000
Step99:rank3, time: 47.500, per_step: 0.475003
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
W20240120 00:48:13.683065 36352 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
W20240120 00:48:13.883265 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=102, pq.top=102
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240120 00:48:14.024053 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=10963
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
W20240120 00:48:14.924010 36352 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
E20240120 00:48:15.024010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=18023
E20240120 00:48:16.024011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=1363
W20240120 00:48:16.059137 36352 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.323 ms                 | 23.338 ms                 |
| ProcessBack:UpdateCache   | 20.536 ms                 | 41.794 ms                 |
| ProcessBack:UpsertPq      | 93.824 ms                 | 279.835 ms                |
| ProcessOneStep            | 130.321 ms                | 2.494 s                   |
| BlockToStepN              | 172.694 us                | 110.283 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.234 us                | 837.925 us                |
| GenInput                  | 804.755 us                | 20.152 ms                 |
| Forward                   | 353.287 us                | 1.240 ms                  |
| Backward                  | 1.032 ms                  | 3.215 ms                  |
| Optimize                  | 113.423 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 378.093 us                | 7.442 ms                  |
| AfterBackward             | 130.358 ms                | 2.494 s                   |
| BlockToStepN              | 245.886 us                | 110.377 ms                |
| OneStep                   | 141.808 ms                | 2.499 s                   |
| E2E-100                   | 29.657 s                  | 29.657 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
W20240120 00:48:16.983736 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=113, pq.top=113
E20240120 00:48:17.024010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=34771
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240120 00:48:17.106038 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
E20240120 00:48:18.024013 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=46400
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240120 00:48:18.277151 36352 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end0
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
W20240120 00:48:18.674979 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=122, pq.top=122
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
E20240120 00:48:19.024010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=5754
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240120 00:48:19.386660 36352 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
E20240120 00:48:20.024008 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=93815
W20240120 00:48:20.414606 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
W20240120 00:48:20.702594 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=126, pq.top=126
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
E20240120 00:48:21.024010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=84540
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.384 ms                 | 23.338 ms                 |
| ProcessBack:UpdateCache   | 20.571 ms                 | 41.794 ms                 |
| ProcessBack:UpsertPq      | 94.279 ms                 | 279.835 ms                |
| ProcessOneStep            | 135.088 ms                | 2.494 s                   |
| BlockToStepN              | 192.015 us                | 110.283 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.751 us                | 2.698 ms                  |
| GenInput                  | 804.755 us                | 20.152 ms                 |
| Forward                   | 355.780 us                | 1.240 ms                  |
| Backward                  | 1.033 ms                  | 3.215 ms                  |
| Optimize                  | 114.478 us                | 395.620 us                |
| BarrierTimeBeforeRank0    | 398.590 us                | 7.442 ms                  |
| AfterBackward             | 135.126 ms                | 2.494 s                   |
| BlockToStepN              | 277.632 us                | 110.377 ms                |
| OneStep                   | 147.983 ms                | 2.499 s                   |
| E2E-100                   | 29.657 s                  | 29.657 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
W20240120 00:48:21.513378 36352 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
W20240120 00:48:21.702229 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=133, pq.top=133
E20240120 00:48:22.024009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=103901
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
W20240120 00:48:22.513401 36352 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
E20240120 00:48:23.024012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=358026
W20240120 00:48:23.678988 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end2
E20240120 00:48:24.024025 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=73733
W20240120 00:48:24.511996 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=142, pq.top=142
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
W20240120 00:48:24.783783 36352 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240120 00:48:25.024346 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=268588
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240120 00:48:25.835727 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=152, pq.top=152
W20240120 00:48:25.962878 36352 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
E20240120 00:48:26.024003 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=55308
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.323 ms                 | 22.111 ms                 |
| ProcessBack:UpdateCache   | 20.539 ms                 | 41.705 ms                 |
| ProcessBack:UpsertPq      | 90.964 ms                 | 237.079 ms                |
| ProcessOneStep            | 129.952 ms                | 1.852 s                   |
| BlockToStepN              | 223.335 us                | 172.746 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.234 us                | 1.512 ms                  |
| GenInput                  | 799.197 us                | 20.152 ms                 |
| Forward                   | 353.520 us                | 1.187 ms                  |
| Backward                  | 1.045 ms                  | 2.138 ms                  |
| Optimize                  | 112.538 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 378.093 us                | 7.442 ms                  |
| AfterBackward             | 130.000 ms                | 1.852 s                   |
| BlockToStepN              | 310.349 us                | 172.859 ms                |
| OneStep                   | 141.808 ms                | 1.956 s                   |
| E2E-100                   | 29.657 s                  | 29.657 s                  |
+---------------------------+---------------------------+---------------------------+
W20240120 00:48:26.835057 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=152, pq.top=152
E20240120 00:48:27.024009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=274169
W20240120 00:48:27.040858 36352 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end2
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
W20240120 00:48:27.911983 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=156, pq.top=156
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
E20240120 00:48:28.024008 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=504860
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240120 00:48:28.275163 36352 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end1
W20240120 00:48:28.911324 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240120 00:48:29.024008 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=178273
W20240120 00:48:29.352360 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240120 00:48:29.911020 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=162, pq.top=161
E20240120 00:48:30.024178 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=404175
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240120 00:48:30.379176 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
E20240120 00:48:31.024010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=630196
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.383 ms                 | 22.111 ms                 |
| ProcessBack:UpdateCache   | 20.565 ms                 | 41.705 ms                 |
| ProcessBack:UpsertPq      | 87.801 ms                 | 237.079 ms                |
| ProcessOneStep            | 125.941 ms                | 1.852 s                   |
| BlockToStepN              | 251.569 us                | 366.127 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.192 us                | 2.151 ms                  |
| GenInput                  | 798.824 us                | 31.083 ms                 |
| Forward                   | 353.287 us                | 1.187 ms                  |
| Backward                  | 1.045 ms                  | 2.138 ms                  |
| Optimize                  | 113.497 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 373.588 us                | 7.442 ms                  |
| AfterBackward             | 125.986 ms                | 1.852 s                   |
| BlockToStepN              | 347.706 us                | 366.270 ms                |
| OneStep                   | 138.800 ms                | 1.956 s                   |
| E2E-100                   | 29.657 s                  | 29.657 s                  |
+---------------------------+---------------------------+---------------------------+
W20240120 00:48:31.674360 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end2
E20240120 00:48:32.024009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=844420
W20240120 00:48:32.732115 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
E20240120 00:48:33.024012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=1016417
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
W20240120 00:48:33.432646 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=175, pq.top=175
W20240120 00:48:33.754465 36352 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
E20240120 00:48:34.026400 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=121065
W20240120 00:48:34.432374 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=175, pq.top=175
E20240120 00:48:35.041383 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=121325
W20240120 00:48:35.432525 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=175, pq.top=175
E20240120 00:48:36.046030 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=121605
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.384 ms                 | 22.111 ms                 |
| ProcessBack:UpdateCache   | 20.573 ms                 | 41.705 ms                 |
| ProcessBack:UpsertPq      | 87.801 ms                 | 237.079 ms                |
| ProcessOneStep            | 126.303 ms                | 1.852 s                   |
| BlockToStepN              | 252.187 us                | 366.127 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.234 us                | 2.151 ms                  |
| GenInput                  | 799.197 us                | 31.083 ms                 |
| Forward                   | 355.065 us                | 1.187 ms                  |
| Backward                  | 1.045 ms                  | 2.138 ms                  |
| Optimize                  | 113.818 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 373.588 us                | 7.442 ms                  |
| AfterBackward             | 126.351 ms                | 1.852 s                   |
| BlockToStepN              | 349.309 us                | 366.270 ms                |
| OneStep                   | 138.957 ms                | 1.956 s                   |
| E2E-100                   | 29.657 s                  | 29.657 s                  |
+---------------------------+---------------------------+---------------------------+
W20240120 00:48:36.432168 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=175, pq.top=175
E20240120 00:48:37.048717 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=121848
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
W20240120 00:48:37.320698 36352 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
W20240120 00:48:37.585990 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=176, pq.top=175
E20240120 00:48:38.351727 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=205257
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
W20240120 00:48:38.353161 36352 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
W20240120 00:48:38.598498 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
E20240120 00:48:39.351011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=639
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
W20240120 00:48:39.401791 36352 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
W20240120 00:48:39.620406 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=181, pq.top=181
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
E20240120 00:48:40.351012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=338283
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240120 00:48:40.677268 36352 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.391 ms                 | 22.111 ms                 |
| ProcessBack:UpdateCache   | 20.571 ms                 | 41.705 ms                 |
| ProcessBack:UpsertPq      | 86.202 ms                 | 237.079 ms                |
| ProcessOneStep            | 124.773 ms                | 1.852 s                   |
| BlockToStepN              | 302.783 us                | 1.335 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.192 us                | 2.398 ms                  |
| GenInput                  | 801.021 us                | 70.102 ms                 |
| Forward                   | 355.065 us                | 1.240 ms                  |
| Backward                  | 1.039 ms                  | 2.138 ms                  |
| Optimize                  | 114.478 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 370.195 us                | 7.442 ms                  |
| AfterBackward             | 124.811 ms                | 1.852 s                   |
| BlockToStepN              | 378.580 us                | 1.335 s                   |
| OneStep                   | 137.074 ms                | 2.499 s                   |
| E2E-100                   | 29.657 s                  | 29.657 s                  |
+---------------------------+---------------------------+---------------------------+
E20240120 00:48:41.351007 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=575
W20240120 00:48:41.862697 36352 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240120 00:48:42.351557 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=191, pq.top=191
E20240120 00:48:42.351823 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=164654
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
W20240120 00:48:42.877357 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
E20240120 00:48:43.351008 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=117682
W20240120 00:48:43.575757 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=195, pq.top=195
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
W20240120 00:48:44.042302 36352 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
E20240120 00:48:44.351011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=103395
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
Step199:rank6, time: 31.153, per_step: 0.308446
Step199:rank2, time: 31.153, per_step: 0.308446
Step199:rank0, time: 31.153, per_step: 0.308449
Step199:rank1, time: 31.153, per_step: 0.308449
Step199:rank4, time: 31.153, per_step: 0.308449
Step199:rank3, time: 31.153, per_step: 0.308446
Step199:rank5, time: 31.153, per_step: 0.308446
========== Step 200 ========== 
Step199:rank7, time: 31.153, per_step: 0.308447
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
W20240120 00:48:45.065019 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=204, pq.top=204
W20240120 00:48:45.128495 36352 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end4
E20240120 00:48:45.351011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=61976
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.383 ms                 | 22.111 ms                 |
| ProcessBack:UpdateCache   | 20.543 ms                 | 41.705 ms                 |
| ProcessBack:UpsertPq      | 86.202 ms                 | 279.835 ms                |
| ProcessOneStep            | 124.773 ms                | 1.852 s                   |
| BlockToStepN              | 318.547 us                | 1.335 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.543 us                | 2.398 ms                  |
| GenInput                  | 799.197 us                | 70.102 ms                 |
| Forward                   | 352.859 us                | 1.240 ms                  |
| Backward                  | 1.034 ms                  | 2.138 ms                  |
| Optimize                  | 112.538 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 354.009 us                | 7.442 ms                  |
| AfterBackward             | 124.811 ms                | 1.852 s                   |
| BlockToStepN              | 395.477 us                | 1.335 s                   |
| OneStep                   | 137.999 ms                | 2.499 s                   |
| E2E-100                   | 29.657 s                  | 31.153 s                  |
+---------------------------+---------------------------+---------------------------+
W20240120 00:48:46.284345 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
E20240120 00:48:46.351009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=15438
W20240120 00:48:47.060544 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=209, pq.top=209
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
W20240120 00:48:47.317929 36352 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240120 00:48:47.351011 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=81938
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
E20240120 00:48:48.351006 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=464468
W20240120 00:48:48.366976 36352 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end6
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
E20240120 00:48:49.351008 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=739792
W20240120 00:48:49.411116 36352 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240120 00:48:49.490814 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=221, pq.top=221
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
E20240120 00:48:50.351008 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=983734
W20240120 00:48:50.413969 36352 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.413 ms                 | 22.111 ms                 |
| ProcessBack:UpdateCache   | 20.629 ms                 | 41.705 ms                 |
| ProcessBack:UpsertPq      | 88.077 ms                 | 279.835 ms                |
| ProcessOneStep            | 126.303 ms                | 1.852 s                   |
| BlockToStepN              | 346.958 us                | 1.335 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.192 us                | 2.398 ms                  |
| GenInput                  | 793.814 us                | 70.102 ms                 |
| Forward                   | 355.065 us                | 1.240 ms                  |
| Backward                  | 1.027 ms                  | 2.138 ms                  |
| Optimize                  | 113.502 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 373.588 us                | 7.442 ms                  |
| AfterBackward             | 126.351 ms                | 1.852 s                   |
| BlockToStepN              | 438.865 us                | 1.335 s                   |
| OneStep                   | 141.210 ms                | 2.499 s                   |
| E2E-100                   | 29.657 s                  | 31.153 s                  |
+---------------------------+---------------------------+---------------------------+
E20240120 00:48:51.351012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=134986
W20240120 00:48:51.498113 36352 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240120 00:48:51.627720 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=228, pq.top=228
E20240120 00:48:52.351024 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=202413
W20240120 00:48:52.627565 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=228, pq.top=228
E20240120 00:48:53.505229 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=203089
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
W20240120 00:48:53.506961 36352 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
W20240120 00:48:54.246521 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=230, pq.top=230
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
E20240120 00:48:54.505468 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=100324
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
W20240120 00:48:54.535403 36352 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end2
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
W20240120 00:48:55.246415 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=237, pq.top=237
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
E20240120 00:48:55.505008 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=111064
W20240120 00:48:55.575697 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.426 ms                 | 22.111 ms                 |
| ProcessBack:UpdateCache   | 20.738 ms                 | 41.705 ms                 |
| ProcessBack:UpsertPq      | 87.296 ms                 | 335.943 ms                |
| ProcessOneStep            | 125.656 ms                | 1.852 s                   |
| BlockToStepN              | 369.228 us                | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.192 us                | 2.398 ms                  |
| GenInput                  | 799.197 us                | 70.102 ms                 |
| Forward                   | 355.065 us                | 1.728 ms                  |
| Backward                  | 1.029 ms                  | 2.138 ms                  |
| Optimize                  | 114.478 us                | 277.256 us                |
| BarrierTimeBeforeRank0    | 377.428 us                | 7.442 ms                  |
| AfterBackward             | 125.694 ms                | 1.852 s                   |
| BlockToStepN              | 497.375 us                | 1.417 s                   |
| OneStep                   | 140.150 ms                | 2.550 s                   |
| E2E-100                   | 29.657 s                  | 31.153 s                  |
+---------------------------+---------------------------+---------------------------+
E20240120 00:48:56.505010 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=342199
W20240120 00:48:56.670266 36352 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
E20240120 00:48:57.505012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=1316
W20240120 00:48:57.695422 36352 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240120 00:48:57.808257 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=243, pq.top=243
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
E20240120 00:48:58.505009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=125996
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
W20240120 00:48:58.914148 36352 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end3
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
E20240120 00:48:59.505009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=33161
W20240120 00:48:59.551239 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=255, pq.top=255
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
W20240120 00:49:00.298869 36352 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end6
E20240120 00:49:00.505012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=196029
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.525 ms                 | 21.534 ms                 |
| ProcessBack:UpdateCache   | 20.881 ms                 | 41.297 ms                 |
| ProcessBack:UpsertPq      | 86.106 ms                 | 279.835 ms                |
| ProcessOneStep            | 124.773 ms                | 1.820 s                   |
| BlockToStepN              | 420.906 us                | 1.335 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.234 us                | 2.320 ms                  |
| GenInput                  | 799.197 us                | 37.252 ms                 |
| Forward                   | 353.228 us                | 1.240 ms                  |
| Backward                  | 1.029 ms                  | 1.730 ms                  |
| Optimize                  | 114.569 us                | 270.507 us                |
| BarrierTimeBeforeRank0    | 375.957 us                | 6.944 ms                  |
| AfterBackward             | 124.811 ms                | 1.820 s                   |
| BlockToStepN              | 510.681 us                | 1.335 s                   |
| OneStep                   | 138.957 ms                | 2.499 s                   |
| E2E-100                   | 29.657 s                  | 31.153 s                  |
+---------------------------+---------------------------+---------------------------+
W20240120 00:49:01.342552 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=256, pq.top=255
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
W20240120 00:49:01.406781 36352 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240120 00:49:01.505007 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=27395
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
E20240120 00:49:02.505009 33685 parallel_pq_v2.h:76] insert failed, size(hashtable)=288500
W20240120 00:49:02.510691 36352 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
E20240120 00:49:03.505012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=530476
W20240120 00:49:03.873900 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
E20240120 00:49:04.505008 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=740535
W20240120 00:49:04.896221 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=270, pq.top=270
E20240120 00:49:05.524881 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=16946
W20240120 00:49:05.896718 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=270, pq.top=270
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.651 ms                 | 21.534 ms                 |
| ProcessBack:UpdateCache   | 20.991 ms                 | 41.297 ms                 |
| ProcessBack:UpsertPq      | 86.265 ms                 | 279.835 ms                |
| ProcessOneStep            | 125.604 ms                | 1.820 s                   |
| BlockToStepN              | 431.543 us                | 1.335 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.710 us                | 2.320 ms                  |
| GenInput                  | 804.755 us                | 37.252 ms                 |
| Forward                   | 352.313 us                | 1.240 ms                  |
| Backward                  | 1.019 ms                  | 1.730 ms                  |
| Optimize                  | 114.580 us                | 270.507 us                |
| BarrierTimeBeforeRank0    | 378.093 us                | 6.944 ms                  |
| AfterBackward             | 125.647 ms                | 1.820 s                   |
| BlockToStepN              | 534.912 us                | 1.335 s                   |
| OneStep                   | 138.800 ms                | 2.499 s                   |
| E2E-100                   | 29.657 s                  | 31.153 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
W20240120 00:49:06.259569 36352 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
E20240120 00:49:06.524011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=58711
W20240120 00:49:06.896677 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=271, pq.top=270
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
W20240120 00:49:07.322713 36352 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
E20240120 00:49:07.524011 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=265354
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
W20240120 00:49:08.353937 36352 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
E20240120 00:49:08.524012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=531054
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
E20240120 00:49:09.524009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=700441
W20240120 00:49:09.585160 36352 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
E20240120 00:49:10.524012 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=881737
W20240120 00:49:10.760749 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.892 ms                 | 21.534 ms                 |
| ProcessBack:UpdateCache   | 21.292 ms                 | 41.297 ms                 |
| ProcessBack:UpsertPq      | 87.296 ms                 | 279.835 ms                |
| ProcessOneStep            | 126.303 ms                | 1.843 s                   |
| BlockToStepN              | 445.990 us                | 1.363 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.312 us                | 2.320 ms                  |
| GenInput                  | 799.197 us                | 70.102 ms                 |
| Forward                   | 353.287 us                | 1.240 ms                  |
| Backward                  | 1.019 ms                  | 1.730 ms                  |
| Optimize                  | 115.234 us                | 270.507 us                |
| BarrierTimeBeforeRank0    | 378.093 us                | 7.442 ms                  |
| AfterBackward             | 126.351 ms                | 1.843 s                   |
| BlockToStepN              | 553.498 us                | 1.363 s                   |
| OneStep                   | 139.283 ms                | 2.550 s                   |
| E2E-100                   | 29.657 s                  | 31.153 s                  |
+---------------------------+---------------------------+---------------------------+
E20240120 00:49:11.558503 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=18332
W20240120 00:49:11.760551 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
E20240120 00:49:12.570972 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=18345
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
W20240120 00:49:12.572768 36352 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 285 ========== 
W20240120 00:49:12.915247 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=286, pq.top=285
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
E20240120 00:49:13.570019 33685 parallel_pq_v2.h:76] insert failed, size(hashtable)=62531
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
W20240120 00:49:13.678953 36352 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
W20240120 00:49:13.987772 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=291, pq.top=291
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
E20240120 00:49:14.570009 36352 parallel_pq_v2.h:76] insert failed, size(hashtable)=344003
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
W20240120 00:49:14.709779 36352 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
E20240120 00:49:15.570009 36351 parallel_pq_v2.h:76] insert failed, size(hashtable)=541371
W20240120 00:49:15.975411 36352 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 10.764 ms                 | 21.534 ms                 |
| ProcessBack:UpdateCache   | 21.045 ms                 | 41.297 ms                 |
| ProcessBack:UpsertPq      | 87.136 ms                 | 279.835 ms                |
| ProcessOneStep            | 125.942 ms                | 1.843 s                   |
| BlockToStepN              | 493.696 us                | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 128.234 us                | 2.368 ms                  |
| GenInput                  | 798.824 us                | 71.481 ms                 |
| Forward                   | 353.228 us                | 1.240 ms                  |
| Backward                  | 1.020 ms                  | 1.730 ms                  |
| Optimize                  | 115.086 us                | 270.507 us                |
| BarrierTimeBeforeRank0    | 373.588 us                | 7.442 ms                  |
| AfterBackward             | 125.986 ms                | 1.843 s                   |
| BlockToStepN              | 564.137 us                | 1.417 s                   |
| OneStep                   | 139.283 ms                | 2.824 s                   |
| E2E-100                   | 29.657 s                  | 31.153 s                  |
+---------------------------+---------------------------+---------------------------+
E20240120 00:49:16.570451 33685 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240120 00:49:16.593173 33685 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=299, pq.top=299
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
Step299:rank2, time: 32.202, per_step: 0.318828
Step299:rank1, time: 32.202, per_step: 0.318829
Step299:rank4, time: 32.202, per_step: 0.318828
Step299:rank3, time: 32.202, per_step: 0.318828
Step299:rank7, time: 32.202, per_step: 0.318829
Step299:rank5, time: 32.202, per_step: 0.318829
timer name is E2E-100
timer name is timer name is E2E-100E2E-100
Step299:rank6, time: 32.202, per_step: 0.318832

Step299:rank0, time: 32.202, per_step: 0.318832
timer name is E2E-100
timer name is E2E-100
timer name is timer name is E2E-100E2E-100

timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
ERROR [33685 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
