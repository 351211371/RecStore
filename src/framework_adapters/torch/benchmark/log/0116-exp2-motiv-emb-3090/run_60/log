WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240116 11:55:42.212005 54060 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240116 11:55:42.217734 54060 IPCTensor.h:367] NewIPCTensor: full_emb [100000000, 32]0x100000002000
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:165: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [54060 perf_emb.py:165] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fe5801418a0>==========
Worker 1 pid=54343
Worker 2 pid=54345
INFO [54060 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [54345 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [54346 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [54343 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [54345 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [54346 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [54343 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 11:55:44.006805 54345 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 11:55:44.006971 54346 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 11:55:44.006970 54343 IPCTensor.h:346] IPCTensor full_emb already exists
INFO [54060 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 11:55:44.007992 54060 IPCTensor.h:346] IPCTensor full_emb already exists
W20240116 11:55:44.038818 54060 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [10000000, 32]; dev=0; size=1.192 GB
W20240116 11:55:44.038853 54346 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [10000000, 32]; dev=3; size=1.192 GB
W20240116 11:55:44.038857 54345 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [10000000, 32]; dev=2; size=1.192 GB
W20240116 11:55:44.038858 54343 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [10000000, 32]; dev=1; size=1.192 GB
W20240116 11:55:44.594990 54345 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1002faf12000
W20240116 11:55:44.595062 54343 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1002fafd7000
W20240116 11:55:44.595202 54345 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x1002fb09c000
W20240116 11:55:44.595232 54060 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1002fb161000
W20240116 11:55:44.595276 54345 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 32]0x1002fb226000
W20240116 11:55:44.595335 54345 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 32]0x1002fbe5d000
W20240116 11:55:44.595350 54343 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x1002fca94000
W20240116 11:55:44.595387 54345 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 11:55:44.595511 54343 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 32]0x1002fcb59000
W20240116 11:55:44.595542 54060 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1002fd790000
W20240116 11:55:44.595683 54343 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 32]0x1002fd855000
W20240116 11:55:44.595759 54060 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 32]0x1002fe48c000
W20240116 11:55:44.595796 54343 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 11:55:44.595882 54060 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 32]0x1002ff0c3000
W20240116 11:55:44.596014 54060 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 11:55:44.596243 54345 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 11:55:44.597121 54343 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 11:55:44.597304 54060 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 11:55:44.607488 54346 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x1002ffd08000
W20240116 11:55:44.607605 54346 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1002ffdcd000
W20240116 11:55:44.607666 54346 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 32]0x1002ffe92000
W20240116 11:55:44.607723 54346 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 32]0x100300ac9000
W20240116 11:55:44.607767 54346 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240116 11:55:44.609587 54346 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 32]; dev=3; size=12.21 MB
Worker 3 pid=54346
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 10000000), (10000000, 20000000), (20000000, 30000000), (30000000, 40000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
W20240116 11:55:47.477320 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x100301704000
W20240116 11:55:47.477531 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x1003017c9000
W20240116 11:55:47.477603 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x10030188e000
W20240116 11:55:47.477661 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100301953000
W20240116 11:55:47.477710 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100301a18000
W20240116 11:55:47.477766 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100301add000
W20240116 11:55:47.477847 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100301c67000
W20240116 11:55:47.477849 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x100301ba2000
W20240116 11:55:47.477941 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100301d2c000
W20240116 11:55:47.477998 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100301df1000
W20240116 11:55:47.478065 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x100301eb6000
W20240116 11:55:47.478070 54346 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100301f7b000
W20240116 11:55:47.478137 54346 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100302040000
W20240116 11:55:47.478156 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100302107000
W20240116 11:55:47.478201 54346 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x1003021cc000
W20240116 11:55:47.478224 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x1003021ce000
W20240116 11:55:47.478183 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100302042000
W20240116 11:55:47.478273 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100302293000
W20240116 11:55:47.478286 54346 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100302358000
W20240116 11:55:47.478334 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x10030235a000
W20240116 11:55:47.478385 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x10030241f000
W20240116 11:55:47.478488 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x1003024e4000
W20240116 11:55:47.478510 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1003025a9000
Construct PerfSampler done
W20240116 11:55:47.478540 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x10030266e000
W20240116 11:55:47.478587 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x100302733000
W20240116 11:55:47.478605 54343 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x1003027f8000
I20240116 11:55:47.478618 54346 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240116 11:55:47.478675 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x1003028bd000
W20240116 11:55:47.478686 54343 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100302982000
W20240116 11:55:47.478734 54343 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100302984000
W20240116 11:55:47.478749 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100302986000
W20240116 11:55:47.478817 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x100302a4b000
W20240116 11:55:47.478829 54343 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100302b10000
W20240116 11:55:47.478883 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x100302b12000
W20240116 11:55:47.478981 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100302bd7000
W20240116 11:55:47.479027 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x100302c9c000
W20240116 11:55:47.479106 54060 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x100302d61000
Construct PerfSampler done
W20240116 11:55:47.479172 54060 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x100302e26000
W20240116 11:55:47.479205 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100302e28000
W20240116 11:55:47.479219 54060 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x100302eed000
I20240116 11:55:47.479229 54343 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240116 11:55:47.479313 54060 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100302eef000
W20240116 11:55:47.479326 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100302ef1000
W20240116 11:55:47.479384 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x100302fb6000
W20240116 11:55:47.479449 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x10030307b000
W20240116 11:55:47.479508 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100303140000
W20240116 11:55:47.479571 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x100303205000
W20240116 11:55:47.479626 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x1003032ca000
Construct PerfSampler done
W20240116 11:55:47.479709 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x10030338f000
W20240116 11:55:47.479763 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x100303454000
W20240116 11:55:47.479826 54345 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x100303519000
I20240116 11:55:47.479858 54060 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240116 11:55:47.479876 54345 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x1003035de000
W20240116 11:55:47.479935 54345 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x1003035e0000
W20240116 11:55:47.480010 54345 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1003035e2000
Construct PerfSampler done
I20240116 11:55:47.480340 54345 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240116 11:55:47.482334 54060 grad_base.h:54] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240116 11:55:47.482610 54060 grad_base.h:169] Init GradProcessingBase done
I20240116 11:56:04.635342 54060 grad_async_v2.h:32] Use background thread to update emb.
W20240116 11:56:04.635705 54060 kg_controller.h:78] after init GradAsyncProcessingV2
I20240116 11:56:04.635715 54060 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240116 11:56:05.117585 54060 grad_base.h:59] GraphEnv RegTensorsPerProcess
W20240116 11:56:06.014415 55272 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 11:56:06.014887 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240116 11:56:07.014016 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=16041
W20240116 11:56:07.077844 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 11:56:08.014020 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=4969
W20240116 11:56:08.081900 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 11:56:09.014010 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=10893
W20240116 11:56:09.181139 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
Before Training
I20240116 11:56:09.670203 54060 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
Before Training
I20240116 11:56:09.754457 54343 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 11:56:09.839980 54345 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 11:56:09.955289 54346 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240116 11:56:10.014014 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=596
W20240116 11:56:10.253448 55272 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 11:56:11.314460 54060 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240116 11:56:11.375773 54060 grad_async_v2.h:209] pq is empty
========== Step 1 ========== 
W20240116 11:56:11.376514 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240116 11:56:11.791616 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=2, pq.top=2
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
E20240116 11:56:12.314019 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=3281
W20240116 11:56:12.417161 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 666.825 us                | 43.564 ms                 |
| Backward                  | 2.385 ms                  | 31.355 ms                 |
| Optimize                  | 173.057 us                | 577.336 us                |
| BarrierTimeBeforeRank0    | 817.494 us                | 1.011 ms                  |
| AfterBackward             | 65.539 ms                 | 934.077 ms                |
| BlockToStepN              | 290.293 us                | 11.696 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
E20240116 11:56:13.314023 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=11146
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
W20240116 11:56:13.520725 55272 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
W20240116 11:56:13.915530 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=7, pq.top=7
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
E20240116 11:56:14.315834 54060 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
W20240116 11:56:14.588165 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.351 ms                  | 159.890 ms                |
| ProcessBack:UpdateCache   | 5.601 ms                  | 704.504 ms                |
| ProcessBack:UpsertPq      | 55.049 ms                 | 84.882 ms                 |
| ProcessOneStep            | 64.596 ms                 | 933.898 ms                |
| BlockToStepN              | 130.998 us                | 15.120 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 11:56:15.168948 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=10, pq.top=10
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
E20240116 11:56:15.315038 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=6009
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
W20240116 11:56:15.637127 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240116 11:56:16.315045 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=10024
W20240116 11:56:16.516420 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=13, pq.top=12
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240116 11:56:16.710965 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
E20240116 11:56:17.315959 54060 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 577.245 us                | 43.564 ms                 |
| Backward                  | 1.467 ms                  | 31.355 ms                 |
| Optimize                  | 168.187 us                | 577.336 us                |
| BarrierTimeBeforeRank0    | 347.020 us                | 3.700 ms                  |
| AfterBackward             | 65.855 ms                 | 934.077 ms                |
| BlockToStepN              | 2.840 ms                  | 23.110 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 11:56:17.792418 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=16, pq.top=16
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
W20240116 11:56:17.813338 55272 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
E20240116 11:56:18.315025 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=3624
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
W20240116 11:56:18.816295 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
W20240116 11:56:19.039935 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=19, pq.top=19
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
E20240116 11:56:19.315016 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=13137
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
W20240116 11:56:19.882318 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.415 ms                  | 159.890 ms                |
| ProcessBack:UpdateCache   | 5.619 ms                  | 704.504 ms                |
| ProcessBack:UpsertPq      | 55.049 ms                 | 84.882 ms                 |
| ProcessOneStep            | 64.596 ms                 | 933.898 ms                |
| BlockToStepN              | 3.614 ms                  | 33.772 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
E20240116 11:56:20.315016 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=18658
W20240116 11:56:20.648986 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=23, pq.top=23
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
W20240116 11:56:20.963080 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
E20240116 11:56:21.315017 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=26052
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
W20240116 11:56:22.027120 55272 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 11:56:22.315016 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=14131
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 548.217 us                | 43.564 ms                 |
| Backward                  | 1.459 ms                  | 31.355 ms                 |
| Optimize                  | 139.417 us                | 577.336 us                |
| BarrierTimeBeforeRank0    | 179.945 us                | 3.700 ms                  |
| AfterBackward             | 61.391 ms                 | 934.077 ms                |
| BlockToStepN              | 3.672 ms                  | 102.253 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
W20240116 11:56:23.064743 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
W20240116 11:56:23.199308 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=29, pq.top=29
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
E20240116 11:56:23.315021 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1792
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
W20240116 11:56:24.104547 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
E20240116 11:56:24.315012 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=10130
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.383 ms                  | 159.890 ms                |
| ProcessBack:UpdateCache   | 5.611 ms                  | 704.504 ms                |
| ProcessBack:UpsertPq      | 55.049 ms                 | 90.590 ms                 |
| ProcessOneStep            | 64.596 ms                 | 933.898 ms                |
| BlockToStepN              | 2.493 ms                  | 102.164 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 11:56:25.163513 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 11:56:25.315122 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=14694
W20240116 11:56:25.428426 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=34, pq.top=34
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240116 11:56:26.318253 55272 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 11:56:26.318373 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
W20240116 11:56:27.144981 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=38, pq.top=38
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
E20240116 11:56:27.318012 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=7010
W20240116 11:56:27.340902 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 522.990 us                | 43.564 ms                 |
| Backward                  | 1.459 ms                  | 31.355 ms                 |
| Optimize                  | 131.388 us                | 577.336 us                |
| BarrierTimeBeforeRank0    | 100.704 us                | 3.700 ms                  |
| AfterBackward             | 64.641 ms                 | 934.077 ms                |
| BlockToStepN              | 2.283 ms                  | 102.253 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
E20240116 11:56:28.318028 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=32024
W20240116 11:56:28.379953 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=41, pq.top=41
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
W20240116 11:56:28.381276 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
E20240116 11:56:29.324486 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
W20240116 11:56:29.451936 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.337 ms                  | 159.890 ms                |
| ProcessBack:UpdateCache   | 5.601 ms                  | 704.504 ms                |
| ProcessBack:UpsertPq      | 52.104 ms                 | 90.590 ms                 |
| ProcessOneStep            | 61.349 ms                 | 933.898 ms                |
| BlockToStepN              | 1.926 ms                  | 148.181 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 11:56:30.170121 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=45, pq.top=45
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
E20240116 11:56:30.324021 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=4972
W20240116 11:56:30.469413 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
E20240116 11:56:31.324014 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=12865
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
W20240116 11:56:31.486400 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
W20240116 11:56:31.711565 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=49, pq.top=49
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
E20240116 11:56:32.324036 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=14972
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 538.164 us                | 1.092 ms                  |
| Backward                  | 1.456 ms                  | 2.385 ms                  |
| Optimize                  | 129.543 us                | 501.700 us                |
| BarrierTimeBeforeRank0    | 64.675 us                 | 2.756 ms                  |
| AfterBackward             | 60.091 ms                 | 99.153 ms                 |
| BlockToStepN              | 1.293 ms                  | 102.253 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 11:56:32.513726 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
W20240116 11:56:32.963827 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=53, pq.top=53
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
E20240116 11:56:33.326371 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=16230
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
W20240116 11:56:33.524382 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
W20240116 11:56:34.258869 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=57, pq.top=57
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
E20240116 11:56:34.326005 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1201
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
W20240116 11:56:34.633702 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.128 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.588 ms                  | 8.035 ms                  |
| ProcessBack:UpsertPq      | 46.459 ms                 | 86.097 ms                 |
| ProcessOneStep            | 55.675 ms                 | 99.108 ms                 |
| BlockToStepN              | 945.670 us                | 116.302 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 11:56:35.258064 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=60, pq.top=60
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240116 11:56:35.326007 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=3776
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240116 11:56:35.671134 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
E20240116 11:56:36.326020 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=25737
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240116 11:56:36.763844 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=65, pq.top=65
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
W20240116 11:56:36.837234 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
E20240116 11:56:37.326009 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=23419
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 522.990 us                | 1.092 ms                  |
| Backward                  | 1.444 ms                  | 2.385 ms                  |
| Optimize                  | 125.579 us                | 501.700 us                |
| BarrierTimeBeforeRank0    | 47.148 us                 | 2.756 ms                  |
| AfterBackward             | 53.038 ms                 | 99.153 ms                 |
| BlockToStepN              | 1.016 ms                  | 116.384 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240116 11:56:37.998301 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
W20240116 11:56:38.327713 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=69, pq.top=69
E20240116 11:56:38.328859 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
W20240116 11:56:39.059535 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
E20240116 11:56:39.328023 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=145
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
W20240116 11:56:40.110337 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.943 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.586 ms                  | 8.035 ms                  |
| ProcessBack:UpsertPq      | 43.981 ms                 | 90.590 ms                 |
| ProcessOneStep            | 52.996 ms                 | 112.173 ms                |
| BlockToStepN              | 942.982 us                | 116.302 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 11:56:40.218324 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=75, pq.top=75
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
E20240116 11:56:40.328011 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1797
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
W20240116 11:56:41.211318 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
E20240116 11:56:41.328009 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=56735
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240116 11:56:41.962069 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=80, pq.top=80
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
E20240116 11:56:42.336486 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
W20240116 11:56:42.337960 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 522.990 us                | 1.092 ms                  |
| Backward                  | 1.443 ms                  | 5.081 ms                  |
| Optimize                  | 124.445 us                | 501.700 us                |
| BarrierTimeBeforeRank0    | 45.855 us                 | 2.756 ms                  |
| AfterBackward             | 51.579 ms                 | 112.260 ms                |
| BlockToStepN              | 1.275 ms                  | 116.384 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
E20240116 11:56:43.336015 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=39114
W20240116 11:56:43.368430 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
W20240116 11:56:43.528386 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=85, pq.top=85
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
E20240116 11:56:44.336012 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1833
W20240116 11:56:44.425712 55272 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
W20240116 11:56:44.588621 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=88, pq.top=88
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.929 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.578 ms                  | 8.035 ms                  |
| ProcessBack:UpsertPq      | 41.177 ms                 | 90.590 ms                 |
| ProcessOneStep            | 50.127 ms                 | 112.173 ms                |
| BlockToStepN              | 1.197 ms                  | 131.960 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
E20240116 11:56:45.336010 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=5760
W20240116 11:56:45.428444 55272 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
W20240116 11:56:46.143177 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=93, pq.top=93
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
E20240116 11:56:46.336015 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=61956
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
W20240116 11:56:46.432826 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
W20240116 11:56:47.143159 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=96, pq.top=96
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
E20240116 11:56:47.336011 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=9628
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
W20240116 11:56:47.474743 55272 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 505.337 us                | 1.092 ms                  |
| Backward                  | 1.434 ms                  | 5.081 ms                  |
| Optimize                  | 122.172 us                | 501.700 us                |
| BarrierTimeBeforeRank0    | 37.224 us                 | 2.756 ms                  |
| AfterBackward             | 49.301 ms                 | 112.260 ms                |
| BlockToStepN              | 1.346 ms                  | 148.258 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank1, time: 60.833, per_step: 0.608331
Step99:rank2, time: 60.832, per_step: 0.608317
Step99:rank3, time: 60.834, per_step: 0.608336
Step99:rank0, time: 60.833, per_step: 0.608331
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
E20240116 11:56:48.336009 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=67035
W20240116 11:56:48.494922 55272 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
W20240116 11:56:49.074717 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=102, pq.top=102
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240116 11:56:49.336014 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=26331
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
W20240116 11:56:49.549049 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.916 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.572 ms                  | 8.035 ms                  |
| ProcessBack:UpsertPq      | 38.708 ms                 | 90.590 ms                 |
| ProcessOneStep            | 47.381 ms                 | 112.173 ms                |
| BlockToStepN              | 1.277 ms                  | 148.181 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 11:56:50.336210 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=81622
W20240116 11:56:50.375953 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=106, pq.top=106
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
W20240116 11:56:50.584764 55272 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
E20240116 11:56:51.336026 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=46373
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
W20240116 11:56:51.588038 55272 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
W20240116 11:56:51.978724 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=111, pq.top=111
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
E20240116 11:56:52.336016 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=5020
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 502.497 us                | 1.092 ms                  |
| Backward                  | 1.433 ms                  | 5.081 ms                  |
| Optimize                  | 122.172 us                | 501.700 us                |
| BarrierTimeBeforeRank0    | 34.135 us                 | 2.756 ms                  |
| AfterBackward             | 47.237 ms                 | 112.260 ms                |
| BlockToStepN              | 1.484 ms                  | 209.476 ms                |
| E2E-100                   | 38.641 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
W20240116 11:56:52.612102 55272 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240116 11:56:53.127717 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=114, pq.top=114
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
E20240116 11:56:53.336011 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=8105
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
W20240116 11:56:53.655122 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
W20240116 11:56:54.264251 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=117, pq.top=117
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
E20240116 11:56:54.336126 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=18
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
W20240116 11:56:54.712652 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.918 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.572 ms                  | 8.035 ms                  |
| ProcessBack:UpsertPq      | 38.604 ms                 | 90.590 ms                 |
| ProcessOneStep            | 47.320 ms                 | 112.173 ms                |
| BlockToStepN              | 1.439 ms                  | 209.381 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 11:56:55.321242 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=120, pq.top=120
E20240116 11:56:55.412041 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
W20240116 11:56:55.765413 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
E20240116 11:56:56.412016 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=53588
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240116 11:56:56.844065 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
W20240116 11:56:56.943907 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=125, pq.top=125
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240116 11:56:57.412520 54060 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 500.770 us                | 1.092 ms                  |
| Backward                  | 1.431 ms                  | 5.081 ms                  |
| Optimize                  | 124.328 us                | 501.700 us                |
| BarrierTimeBeforeRank0    | 33.274 us                 | 2.756 ms                  |
| AfterBackward             | 47.237 ms                 | 112.260 ms                |
| BlockToStepN              | 1.610 ms                  | 209.476 ms                |
| E2E-100                   | 38.641 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240116 11:56:57.899286 55272 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
W20240116 11:56:58.055935 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=128, pq.top=128
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
E20240116 11:56:58.412009 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=95
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
W20240116 11:56:58.907822 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
E20240116 11:56:59.412024 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=128090
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240116 11:56:59.806860 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=134, pq.top=134
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
W20240116 11:56:59.929437 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.916 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.567 ms                  | 8.035 ms                  |
| ProcessBack:UpsertPq      | 37.701 ms                 | 90.590 ms                 |
| ProcessOneStep            | 46.321 ms                 | 112.173 ms                |
| BlockToStepN              | 1.642 ms                  | 209.381 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
E20240116 11:57:00.412010 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=182917
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240116 11:57:00.976532 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
E20240116 11:57:01.412015 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=244350
W20240116 11:57:01.474717 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=140, pq.top=140
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
E20240116 11:57:02.414641 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=20
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 500.444 us                | 1.092 ms                  |
| Backward                  | 1.423 ms                  | 5.081 ms                  |
| Optimize                  | 122.172 us                | 501.700 us                |
| BarrierTimeBeforeRank0    | 34.057 us                 | 2.756 ms                  |
| AfterBackward             | 46.205 ms                 | 112.260 ms                |
| BlockToStepN              | 1.762 ms                  | 284.921 ms                |
| E2E-100                   | 38.641 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 11:57:02.810236 55272 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
W20240116 11:57:03.375041 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=142, pq.top=142
E20240116 11:57:03.442479 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=32388
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240116 11:57:03.812687 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
E20240116 11:57:04.442020 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=87037
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
W20240116 11:57:04.895378 55272 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.910 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.562 ms                  | 8.035 ms                  |
| ProcessBack:UpsertPq      | 37.067 ms                 | 90.590 ms                 |
| ProcessOneStep            | 45.737 ms                 | 112.173 ms                |
| BlockToStepN              | 1.776 ms                  | 284.776 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
E20240116 11:57:05.442023 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=144751
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240116 11:57:05.790388 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=150, pq.top=150
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
W20240116 11:57:06.282975 55272 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 11:57:06.442015 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=10711
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240116 11:57:06.855799 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=152, pq.top=152
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240116 11:57:07.335150 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 11:57:07.442018 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=31346
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 497.577 us                | 1.059 ms                  |
| Backward                  | 1.409 ms                  | 2.385 ms                  |
| Optimize                  | 120.769 us                | 346.655 us                |
| BarrierTimeBeforeRank0    | 37.224 us                 | 2.295 ms                  |
| AfterBackward             | 45.539 ms                 | 99.153 ms                 |
| BlockToStepN              | 1.982 ms                  | 284.921 ms                |
| E2E-100                   | 38.641 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
W20240116 11:57:08.359071 55272 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 11:57:08.442011 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=86950
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240116 11:57:09.395509 55272 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 11:57:09.442010 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=144691
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.900 ms                  | 4.463 ms                  |
| ProcessBack:UpdateCache   | 5.554 ms                  | 7.674 ms                  |
| ProcessBack:UpsertPq      | 35.848 ms                 | 86.097 ms                 |
| ProcessOneStep            | 44.439 ms                 | 99.108 ms                 |
| BlockToStepN              | 1.927 ms                  | 284.776 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240116 11:57:10.436691 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
E20240116 11:57:10.442001 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=199936
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
E20240116 11:57:11.443006 54060 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240116 11:57:11.468039 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
E20240116 11:57:12.442198 54060 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 493.144 us                | 1.059 ms                  |
| Backward                  | 1.395 ms                  | 2.385 ms                  |
| Optimize                  | 118.634 us                | 346.655 us                |
| BarrierTimeBeforeRank0    | 46.940 us                 | 2.295 ms                  |
| AfterBackward             | 44.234 ms                 | 102.122 ms                |
| BlockToStepN              | 2.079 ms                  | 284.921 ms                |
| E2E-100                   | 38.641 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 11:57:12.522742 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
E20240116 11:57:13.442018 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=369330
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
W20240116 11:57:13.563851 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
E20240116 11:57:14.442016 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=426581
W20240116 11:57:14.584892 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.895 ms                  | 4.463 ms                  |
| ProcessBack:UpdateCache   | 5.548 ms                  | 7.674 ms                  |
| ProcessBack:UpsertPq      | 35.434 ms                 | 90.590 ms                 |
| ProcessOneStep            | 44.145 ms                 | 102.072 ms                |
| BlockToStepN              | 2.055 ms                  | 284.776 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
E20240116 11:57:15.442013 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=478136
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 489.161 us                | 1.059 ms                  |
| Backward                  | 1.385 ms                  | 2.385 ms                  |
| Optimize                  | 118.086 us                | 346.655 us                |
| BarrierTimeBeforeRank0    | 56.274 us                 | 2.295 ms                  |
| AfterBackward             | 44.234 ms                 | 102.122 ms                |
| BlockToStepN              | 2.134 ms                  | 284.921 ms                |
| E2E-100                   | 38.641 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 11:57:18.931156 55272 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 11:57:18.931326 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.895 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.553 ms                  | 7.674 ms                  |
| ProcessBack:UpsertPq      | 35.554 ms                 | 90.590 ms                 |
| ProcessOneStep            | 44.239 ms                 | 102.072 ms                |
| BlockToStepN              | 2.068 ms                  | 284.776 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 11:57:20.333706 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
E20240116 11:57:20.333899 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=15941
W20240116 11:57:20.641196 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=185, pq.top=185
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
E20240116 11:57:21.333017 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=66313
W20240116 11:57:21.359961 55272 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
W20240116 11:57:21.910653 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=189, pq.top=189
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
E20240116 11:57:22.333017 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=118220
W20240116 11:57:22.365182 55272 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 497.577 us                | 1.059 ms                  |
| Backward                  | 1.381 ms                  | 2.385 ms                  |
| Optimize                  | 118.813 us                | 346.655 us                |
| BarrierTimeBeforeRank0    | 100.704 us                | 2.295 ms                  |
| AfterBackward             | 44.282 ms                 | 102.122 ms                |
| BlockToStepN              | 2.208 ms                  | 284.921 ms                |
| E2E-100                   | 38.641 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
E20240116 11:57:23.333011 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=173278
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
W20240116 11:57:23.456652 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
E20240116 11:57:24.333014 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=231289
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
W20240116 11:57:24.548981 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.903 ms                  | 11.750 ms                 |
| ProcessBack:UpdateCache   | 5.547 ms                  | 7.674 ms                  |
| ProcessBack:UpsertPq      | 35.488 ms                 | 90.590 ms                 |
| ProcessOneStep            | 44.165 ms                 | 102.072 ms                |
| BlockToStepN              | 2.204 ms                  | 284.776 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 11:57:25.171612 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=200, pq.top=200
Step199:rank2, time: 36.864, per_step: 0.364985
Step199:rank3, time: 36.864, per_step: 0.364985
Step199:rank0, time: 36.864, per_step: 0.364985
Step199:rank1, time: 36.864, per_step: 0.364985
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
E20240116 11:57:25.333006 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=285303
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
W20240116 11:57:25.596328 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
E20240116 11:57:26.333783 54060 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
W20240116 11:57:26.619019 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
E20240116 11:57:27.333014 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=401201
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 489.161 us                | 1.059 ms                  |
| Backward                  | 1.376 ms                  | 2.385 ms                  |
| Optimize                  | 117.961 us                | 346.655 us                |
| BarrierTimeBeforeRank0    | 183.340 us                | 2.295 ms                  |
| AfterBackward             | 44.013 ms                 | 102.122 ms                |
| BlockToStepN              | 2.301 ms                  | 284.921 ms                |
| E2E-100                   | 36.863 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
W20240116 11:57:27.708916 55272 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
E20240116 11:57:28.333015 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=460584
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
W20240116 11:57:28.785460 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
E20240116 11:57:29.333014 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=520512
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
W20240116 11:57:29.853140 55272 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.899 ms                  | 11.750 ms                 |
| ProcessBack:UpdateCache   | 5.528 ms                  | 7.674 ms                  |
| ProcessBack:UpsertPq      | 35.201 ms                 | 93.141 ms                 |
| ProcessOneStep            | 43.861 ms                 | 112.173 ms                |
| BlockToStepN              | 2.315 ms                  | 284.776 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 11:57:30.333022 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=565814
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
W20240116 11:57:30.879987 55272 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
E20240116 11:57:31.333388 54060 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
W20240116 11:57:31.631567 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=222, pq.top=222
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
W20240116 11:57:31.907927 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
E20240116 11:57:32.334038 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=675774
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 482.690 us                | 1.059 ms                  |
| Backward                  | 1.363 ms                  | 2.385 ms                  |
| Optimize                  | 117.236 us                | 346.655 us                |
| BarrierTimeBeforeRank0    | 293.709 us                | 2.411 ms                  |
| AfterBackward             | 43.763 ms                 | 133.287 ms                |
| BlockToStepN              | 2.434 ms                  | 284.921 ms                |
| E2E-100                   | 36.863 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
W20240116 11:57:33.000169 55272 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
E20240116 11:57:33.334008 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=733918
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
W20240116 11:57:34.093381 55272 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
E20240116 11:57:34.334021 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=794205
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
W20240116 11:57:34.915629 54060 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=234, pq.top=234
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.891 ms                  | 11.750 ms                 |
| ProcessBack:UpdateCache   | 5.501 ms                  | 7.674 ms                  |
| ProcessBack:UpsertPq      | 34.843 ms                 | 103.597 ms                |
| ProcessOneStep            | 43.629 ms                 | 133.235 ms                |
| BlockToStepN              | 2.407 ms                  | 284.776 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
W20240116 11:57:35.194380 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 11:57:35.334012 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=851904
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
W20240116 11:57:36.223798 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
E20240116 11:57:36.334013 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=15
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
W20240116 11:57:37.261096 55272 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 11:57:37.334007 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=969031
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 478.328 us                | 1.059 ms                  |
| Backward                  | 1.347 ms                  | 2.385 ms                  |
| Optimize                  | 114.934 us                | 346.655 us                |
| BarrierTimeBeforeRank0    | 372.990 us                | 2.411 ms                  |
| AfterBackward             | 43.431 ms                 | 133.287 ms                |
| BlockToStepN              | 2.532 ms                  | 284.921 ms                |
| E2E-100                   | 36.863 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
W20240116 11:57:38.295395 55272 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 11:57:38.334013 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1027187
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
W20240116 11:57:39.308465 55272 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
E20240116 11:57:39.334817 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1081933
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.880 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.491 ms                  | 7.389 ms                  |
| ProcessBack:UpsertPq      | 34.702 ms                 | 93.141 ms                 |
| ProcessOneStep            | 43.343 ms                 | 112.173 ms                |
| BlockToStepN              | 2.489 ms                  | 209.381 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 11:57:40.334009 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1115040
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
W20240116 11:57:40.616443 55272 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
E20240116 11:57:41.337249 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1151403
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
W20240116 11:57:41.703578 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
E20240116 11:57:42.337009 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1200960
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 477.770 us                | 988.161 us                |
| Backward                  | 1.255 ms                  | 2.141 ms                  |
| Optimize                  | 114.752 us                | 271.146 us                |
| BarrierTimeBeforeRank0    | 401.715 us                | 2.345 ms                  |
| AfterBackward             | 43.667 ms                 | 131.725 ms                |
| BlockToStepN              | 2.570 ms                  | 209.476 ms                |
| E2E-100                   | 36.863 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
W20240116 11:57:42.734913 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
E20240116 11:57:43.337021 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1256555
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
W20240116 11:57:43.781884 55272 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
E20240116 11:57:44.337008 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1311149
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
W20240116 11:57:44.785567 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.871 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.475 ms                  | 7.389 ms                  |
| ProcessBack:UpsertPq      | 34.843 ms                 | 103.597 ms                |
| ProcessOneStep            | 43.629 ms                 | 131.676 ms                |
| BlockToStepN              | 2.595 ms                  | 209.381 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
E20240116 11:57:45.337009 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1370696
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
W20240116 11:57:45.833403 55272 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
E20240116 11:57:46.337015 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1427178
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
W20240116 11:57:46.872611 55272 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
E20240116 11:57:47.337340 54060 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 473.699 us                | 988.161 us                |
| Backward                  | 1.340 ms                  | 2.141 ms                  |
| Optimize                  | 114.803 us                | 271.146 us                |
| BarrierTimeBeforeRank0    | 372.990 us                | 2.345 ms                  |
| AfterBackward             | 43.383 ms                 | 131.725 ms                |
| BlockToStepN              | 2.766 ms                  | 209.476 ms                |
| E2E-100                   | 36.863 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
W20240116 11:57:47.894289 55272 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
E20240116 11:57:48.337013 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1546337
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
W20240116 11:57:48.894783 55272 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
E20240116 11:57:49.337018 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1603981
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
W20240116 11:57:49.947360 55272 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.861 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.467 ms                  | 7.389 ms                  |
| ProcessBack:UpsertPq      | 34.366 ms                 | 103.597 ms                |
| ProcessOneStep            | 43.159 ms                 | 131.676 ms                |
| BlockToStepN              | 2.720 ms                  | 209.381 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 11:57:50.337018 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1662727
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
W20240116 11:57:50.995687 55272 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
E20240116 11:57:51.337016 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1720177
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
W20240116 11:57:52.026986 55272 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
E20240116 11:57:52.337009 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1777256
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 466.497 us                | 988.161 us                |
| Backward                  | 1.348 ms                  | 2.141 ms                  |
| Optimize                  | 114.752 us                | 271.146 us                |
| BarrierTimeBeforeRank0    | 313.119 us                | 2.345 ms                  |
| AfterBackward             | 42.973 ms                 | 131.725 ms                |
| BlockToStepN              | 2.838 ms                  | 209.476 ms                |
| E2E-100                   | 36.863 s                  | 38.641 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
W20240116 11:57:53.052000 55272 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
E20240116 11:57:53.337020 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1835750
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
W20240116 11:57:54.095669 55272 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
Step299:rank3, time: 29.081, per_step: 0.287932
Step299:rank1, time: 29.081, per_step: 0.287932
Step299:rank2, time: 29.081, per_step: 0.287932
Step299:rank0, time: 29.081, per_step: 0.287932
timer name is E2E-100
timer name is timer name is E2E-100E2E-100

timer name is E2E-100
E20240116 11:57:54.337018 55272 parallel_pq_v2.h:76] insert failed, size(hashtable)=1890058
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.856 ms                  | 4.762 ms                  |
| ProcessBack:UpdateCache   | 5.462 ms                  | 7.389 ms                  |
| ProcessBack:UpsertPq      | 34.184 ms                 | 103.597 ms                |
| ProcessOneStep            | 42.841 ms                 | 131.676 ms                |
| BlockToStepN              | 2.806 ms                  | 209.381 ms                |
+---------------------------+---------------------------+---------------------------+
ERROR [54060 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
*** Aborted at 1705377476 (Unix time, try 'date -d @1705377476') ***
*** Signal 11 (SIGSEGV) (0x10000e332d80) received by PID 54060 (pthread TID 0x7fe1d1ff3700) (linux TID 55270) (code: address not mapped to object), stack trace: ***
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN5folly10symbolizer17getStackTraceSafeEPmm+0x7c)[0x7fe633a7f115]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN5folly10symbolizer21SafeStackTracePrinter15printStackTraceEb+0x66)[0x7fe633a36d14]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(+0x7c71d9)[0x7fe633a351d9]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(+0x7c72b6)[0x7fe633a352b6]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x1297f)[0x7fe77659f97f]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53df1c5)[0x7fe67c7a51c5]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZNK2at18TensorIteratorBase15serial_for_eachEN3c1012function_refIFvPPcPKlllEEENS_5RangeE+0x17b)[0x7fe67872e63b]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at18TensorIteratorBase8for_eachEN3c1012function_refIFvPPcPKlllEEEl+0x16e)[0x7fe67872ebbe]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53e7cca)[0x7fe67c7adcca]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53e9bed)[0x7fe67c7afbed]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x19a56bd)[0x7fe678d6b6bd]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at6native28structured_index_add_cpu_out4implERKNS_6TensorElS4_S4_RKN3c106ScalarES4_+0x2b6)[0x7fe678d82d06]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x2600f2d)[0x7fe6799c6f2d]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_10redispatchEN3c1014DispatchKeySetERNS_6TensorElRKS4_S7_RKNS2_6ScalarE+0x99)[0x7fe6798a4629]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x4580b9d)[0x7fe67b946b9d]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_10redispatchEN3c1014DispatchKeySetERNS_6TensorElRKS4_S7_RKNS2_6ScalarE+0x99)[0x7fe6798a4629]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x3f86b23)[0x7fe67b34cb23]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_4callERNS_6TensorElRKS2_S5_RKN3c106ScalarE+0x196)[0x7fe679906d46]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNK2at6Tensor10index_add_ElRKS0_S2_RKN3c106ScalarE+0x3a)[0x7fe63386d582]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN8recstore21GradAsyncProcessingV214GradWorkThreadEi+0x2d4)[0x7fe63387c80a]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt13__invoke_implIvRMN8recstore21GradAsyncProcessingV2EFviERPS1_JRiEET_St21__invoke_memfun_derefOT0_OT1_DpOT2_+0x7d)[0x7fe6338ecede]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt8__invokeIRMN8recstore21GradAsyncProcessingV2EFviEJRPS1_RiEENSt15__invoke_resultIT_JDpT0_EE4typeEOS9_DpOSA_+0x4e)[0x7fe6338ece2e]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS1_iEE6__callIvJEJLm0ELm1EEEET_OSt5tupleIJDpT0_EESt12_Index_tupleIJXspT1_EEE+0x83)[0x7fe6338ecd4b]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS1_iEEclIJEvEET0_DpOT_+0x32)[0x7fe6338ecc48]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt13__invoke_implIvSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS2_iEEJEET_St14__invoke_otherOT0_DpOT1_+0x1f)[0x7fe6338eca85]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt8__invokeISt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS2_iEEJEENSt15__invoke_resultIT_JDpT0_EE4typeEOS9_DpOSA_+0x1f)[0x7fe6338ec918]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt6thread8_InvokerISt5tupleIJSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS4_iEEEEE9_M_invokeIJLm0EEEEvSt12_Index_tupleIJXspT_EEE+0x27)[0x7fe6338ec82d]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt6thread8_InvokerISt5tupleIJSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS4_iEEEEEclEv+0x17)[0x7fe6338ec797]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt6thread11_State_implINS_8_InvokerISt5tupleIJSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS5_iEEEEEEE6_M_runEv+0x1b)[0x7fe6338ec69f]
/home/xieminhui/miniconda3/bin/../lib/libstdc++.so.6(+0xd3e94)[0x7fe6897bae94]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x76da)[0x7fe7765946da]
/lib/x86_64-linux-gnu/libc.so.6(clone+0x3e)[0x7fe775b1861e]
(safe mode, symbolizer not available)
