WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240119 21:32:57.387280 39219 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240119 21:32:57.393692 39219 IPCTensor.h:367] NewIPCTensor: full_emb [100000000, 32]0x100000002000
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [39219 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f545a471bc0>==========
Worker 1 pid=39737
Worker 2 pid=39738
Worker 3 pid=39739
Worker 4 pid=39758
Worker 5 pid=39759
Worker 6 pid=39760
INFO [39219 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [39737 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [39738 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [39739 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [39758 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [39759 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [39219 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39767 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [39760 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [39738 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39737 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39758 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39760 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39767 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240119 21:32:59.815690 39219 IPCTensor.h:346] IPCTensor full_emb already exists
INFO [39739 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [39759 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240119 21:32:59.815985 39738 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 21:32:59.816073 39758 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 21:32:59.816074 39760 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 21:32:59.816098 39737 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 21:32:59.816110 39767 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 21:32:59.816290 39739 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 21:32:59.816295 39759 IPCTensor.h:346] IPCTensor full_emb already exists
W20240119 21:32:59.850100 39219 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [1000000, 32]; dev=0; size=122.1 MB
W20240119 21:32:59.850072 39759 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_5 [1000000, 32]; dev=5; size=122.1 MB
W20240119 21:32:59.850081 39738 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [1000000, 32]; dev=2; size=122.1 MB
W20240119 21:32:59.850085 39739 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [1000000, 32]; dev=3; size=122.1 MB
W20240119 21:32:59.850087 39758 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_4 [1000000, 32]; dev=4; size=122.1 MB
W20240119 21:32:59.850090 39760 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_6 [1000000, 32]; dev=6; size=122.1 MB
W20240119 21:32:59.850090 39737 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [1000000, 32]; dev=1; size=122.1 MB
W20240119 21:32:59.850095 39767 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_7 [1000000, 32]; dev=7; size=122.1 MB
W20240119 21:33:00.890352 39219 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1002faf0e000
W20240119 21:33:00.890465 39219 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1002fafd3000
W20240119 21:33:00.890503 39219 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 32]0x1002fb098000
W20240119 21:33:00.890530 39219 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 32]0x1002fbccf000
W20240119 21:33:00.890550 39219 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240119 21:33:00.892686 39219 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240119 21:33:00.947785 39738 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1002fc90e000
W20240119 21:33:00.947968 39737 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1002fc9d3000
W20240119 21:33:00.948081 39738 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x1002fca98000
W20240119 21:33:00.948158 39737 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x1002fcb5d000
W20240119 21:33:00.948182 39738 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 32]0x1002fcc22000
W20240119 21:33:00.948235 39737 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 32]0x1002fd859000
W20240119 21:33:00.948274 39738 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 32]0x1002fe490000
W20240119 21:33:00.948297 39737 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 32]0x1002ff0c7000
W20240119 21:33:00.948340 39737 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240119 21:33:00.948348 39738 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240119 21:33:00.954059 39759 IPCTensor.h:367] NewIPCTensor: input_keys_5 [100000]0x1002ffd00000
W20240119 21:33:00.954233 39759 IPCTensor.h:367] NewIPCTensor: input_keys_neg_5 [100000]0x1002ffdc5000
W20240119 21:33:00.954283 39759 IPCTensor.h:367] NewIPCTensor: backward_grads_5 [100000, 32]0x1002ffe8a000
W20240119 21:33:00.954329 39759 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_5 [100000, 32]0x100300ac1000
W20240119 21:33:00.954365 39759 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_5_gpu [100000, 32]; dev=5; size=12.21 MB
W20240119 21:33:00.956830 39737 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240119 21:33:00.956852 39738 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240119 21:33:00.957108 39767 IPCTensor.h:367] NewIPCTensor: input_keys_7 [100000]0x100301700000
W20240119 21:33:00.957188 39759 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 32]; dev=5; size=12.21 MB
W20240119 21:33:00.957233 39767 IPCTensor.h:367] NewIPCTensor: input_keys_neg_7 [100000]0x1003017c5000
W20240119 21:33:00.957280 39767 IPCTensor.h:367] NewIPCTensor: backward_grads_7 [100000, 32]0x10030188a000
W20240119 21:33:00.957324 39767 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_7 [100000, 32]0x1003024c1000
W20240119 21:33:00.957358 39767 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_7_gpu [100000, 32]; dev=7; size=12.21 MB
W20240119 21:33:00.961386 39758 IPCTensor.h:367] NewIPCTensor: input_keys_4 [100000]0x100303100000
W20240119 21:33:00.961496 39758 IPCTensor.h:367] NewIPCTensor: input_keys_neg_4 [100000]0x1003031c7000
W20240119 21:33:00.961496 39767 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 32]; dev=7; size=12.21 MB
W20240119 21:33:00.961536 39758 IPCTensor.h:367] NewIPCTensor: backward_grads_4 [100000, 32]0x10030328c000
W20240119 21:33:00.961572 39758 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_4 [100000, 32]0x100303ec3000
W20240119 21:33:00.961604 39758 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_4_gpu [100000, 32]; dev=4; size=12.21 MB
W20240119 21:33:00.962972 39739 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x100304afc000
W20240119 21:33:00.963088 39739 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x100304bc1000
W20240119 21:33:00.963124 39739 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 32]0x100304c86000
W20240119 21:33:00.963176 39739 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 32]0x1003058bd000
W20240119 21:33:00.963203 39739 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240119 21:33:00.964036 39758 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 32]; dev=4; size=12.21 MB
W20240119 21:33:00.965768 39739 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240119 21:33:00.988070 39760 IPCTensor.h:367] NewIPCTensor: input_keys_6 [100000]0x100306500000
W20240119 21:33:00.988210 39760 IPCTensor.h:367] NewIPCTensor: input_keys_neg_6 [100000]0x1003065c5000
W20240119 21:33:00.988262 39760 IPCTensor.h:367] NewIPCTensor: backward_grads_6 [100000, 32]0x10030668a000
W20240119 21:33:00.988306 39760 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_6 [100000, 32]0x1003072c1000
W20240119 21:33:00.988344 39760 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_6_gpu [100000, 32]; dev=6; size=12.21 MB
W20240119 21:33:01.009243 39760 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 32]; dev=6; size=12.21 MB
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
Worker 7 pid=39767
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1000000), (1000000, 2000000), (2000000, 3000000), (3000000, 4000000), (4000000, 5000000), (5000000, 6000000), (6000000, 7000000), (7000000, 8000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
W20240119 21:33:05.414654 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x100307efc000
W20240119 21:33:05.414753 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100307fc1000
W20240119 21:33:05.414983 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x1003082d5000
W20240119 21:33:05.415169 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x100308524000
W20240119 21:33:05.415009 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x10030814b000
W20240119 21:33:05.415068 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x100308210000
W20240119 21:33:05.415230 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x100308773000
W20240119 21:33:05.415174 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x1003086ae000
W20240119 21:33:05.415318 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x100308838000
W20240119 21:33:05.415292 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x100308086000
W20240119 21:33:05.415347 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1003088fd000
W20240119 21:33:05.415143 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x1003085e9000
W20240119 21:33:05.415107 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x10030845f000
W20240119 21:33:05.415210 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x10030839a000
W20240119 21:33:05.415529 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x1003089c2000
W20240119 21:33:05.415551 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x100308a87000
W20240119 21:33:05.415578 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x100308b4c000
W20240119 21:33:05.415611 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x100308c11000
W20240119 21:33:05.415616 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x100308cd6000
W20240119 21:33:05.415624 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x100308d9b000
W20240119 21:33:05.415649 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x100308e60000
W20240119 21:33:05.415663 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100308f25000
W20240119 21:33:05.415673 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100308fea000
W20240119 21:33:05.415689 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x100309174000
W20240119 21:33:05.415688 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x1003090af000
W20240119 21:33:05.415711 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x100309239000
W20240119 21:33:05.415716 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x1003092fe000
W20240119 21:33:05.415721 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x1003093c3000
W20240119 21:33:05.415735 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100309488000
W20240119 21:33:05.415748 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10030954d000
W20240119 21:33:05.415757 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100309612000
W20240119 21:33:05.415766 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x1003096d7000
W20240119 21:33:05.415776 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x10030979c000
W20240119 21:33:05.415786 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x100309861000
W20240119 21:33:05.415793 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100309926000
W20240119 21:33:05.415794 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x1003099eb000
W20240119 21:33:05.415808 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100309ab0000
W20240119 21:33:05.415822 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x100309b75000
W20240119 21:33:05.415827 39760 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x100309c3a000
W20240119 21:33:05.415831 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x100309cff000
W20240119 21:33:05.415854 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x100309dc4000
W20240119 21:33:05.415866 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x100309f4e000
W20240119 21:33:05.415863 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x100309e89000
W20240119 21:33:05.415870 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x10030a013000
W20240119 21:33:05.415879 39760 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x10030a0d8000
W20240119 21:33:05.415880 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x10030a0da000
W20240119 21:33:05.415884 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x10030a19f000
W20240119 21:33:05.415897 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x10030a264000
W20240119 21:33:05.415913 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x10030a329000
W20240119 21:33:05.415920 39760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x10030a3ee000
W20240119 21:33:05.415930 39738 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10030a3f0000
W20240119 21:33:05.415933 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x10030a4b5000
W20240119 21:33:05.415946 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x10030a57a000
W20240119 21:33:05.415951 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x10030a63f000
W20240119 21:33:05.415956 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x10030a704000
W20240119 21:33:05.415966 39760 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10030a7c9000
W20240119 21:33:05.415979 39738 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x10030a7cb000
W20240119 21:33:05.415982 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x10030a7cd000
W20240119 21:33:05.415985 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x10030a892000
W20240119 21:33:05.415990 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x10030a957000
W20240119 21:33:05.416013 39738 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x10030aa1c000
W20240119 21:33:05.416026 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10030aa1e000
W20240119 21:33:05.416033 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x10030aae3000
W20240119 21:33:05.416047 39738 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10030aba8000
W20240119 21:33:05.416056 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x10030abaa000
W20240119 21:33:05.416060 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x10030ac6f000
W20240119 21:33:05.416065 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x10030ad34000
W20240119 21:33:05.416070 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x10030adf9000
W20240119 21:33:05.416071 39219 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x10030aebe000
W20240119 21:33:05.416093 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x10030af83000
W20240119 21:33:05.416105 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x10030b048000
W20240119 21:33:05.416126 39219 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x10030b10d000
W20240119 21:33:05.416136 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10030b10f000
W20240119 21:33:05.416138 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x10030b1d4000
W20240119 21:33:05.416143 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x10030b299000
W20240119 21:33:05.416146 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x10030b35e000
W20240119 21:33:05.416158 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x10030b423000
W20240119 21:33:05.416160 39219 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x10030b4e8000
Construct PerfSampler done
W20240119 21:33:05.416184 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x10030b4ea000
W20240119 21:33:05.416195 39758 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x10030b5af000
W20240119 21:33:05.416201 39759 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x10030b674000
Construct PerfSampler done
W20240119 21:33:05.416203 39219 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10030b739000
W20240119 21:33:05.416213 39737 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x10030b73b000
W20240119 21:33:05.416256 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x10030b800000
I20240119 21:33:05.416263 39760 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240119 21:33:05.416267 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x10030b8c5000
I20240119 21:33:05.416285 39738 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 21:33:05.416316 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x10030b98a000
W20240119 21:33:05.416326 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x10030ba4f000
W20240119 21:33:05.416355 39739 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x10030bb14000
W20240119 21:33:05.416383 39767 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x10030bbd9000
Construct PerfSampler done
W20240119 21:33:05.416419 39739 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x10030bc9e000
W20240119 21:33:05.416441 39767 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x10030bca0000
W20240119 21:33:05.416453 39739 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x10030bca2000
I20240119 21:33:05.416453 39219 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 21:33:05.416477 39737 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x10030bca4000
W20240119 21:33:05.416491 39767 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x10030bca6000
W20240119 21:33:05.416500 39739 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10030bca8000
W20240119 21:33:05.416532 39737 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x10030bcaa000
W20240119 21:33:05.416535 39767 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x10030bcac000
W20240119 21:33:05.416560 39737 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10030bcb0000
W20240119 21:33:05.416560 39759 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x10030bcae000
W20240119 21:33:05.416564 39758 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x10030bcb2000
W20240119 21:33:05.416610 39759 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x10030bcb6000
W20240119 21:33:05.416607 39758 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x10030bcb4000
W20240119 21:33:05.416646 39759 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10030bcb8000
W20240119 21:33:05.416651 39758 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10030bcba000
Construct PerfSampler done
Construct PerfSampler done
Construct PerfSampler done
Construct PerfSampler done
I20240119 21:33:05.416811 39767 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 21:33:05.416829 39737 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 21:33:05.416839 39739 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
Construct PerfSampler done
I20240119 21:33:05.416896 39759 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240119 21:33:05.416949 39758 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 21:33:05.417651 39219 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.01,
        "backgrad_init": "both"
    }
W20240119 21:33:05.417750 39219 grad_base.h:172] Init GradProcessingBase done
I20240119 21:33:14.444618 39219 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=16
W20240119 21:33:14.444878 39219 kg_controller.h:78] after init GradAsyncProcessingV2
I20240119 21:33:14.444886 39219 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240119 21:33:15.290438 39219 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240119 21:33:17.152104 42296 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 21:33:17.152506 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240119 21:33:18.152030 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240119 21:33:18.167661 42296 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 21:33:19.152518 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240119 21:33:19.206772 42296 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 21:33:20.152045 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240119 21:33:20.225263 42296 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
Before Training
I20240119 21:33:20.433247 39219 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240119 21:33:20.473459 39737 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 21:33:20.513550 39738 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 21:33:20.553472 39739 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 21:33:20.593163 39758 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 21:33:20.633137 39759 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 21:33:20.672725 39760 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 21:33:20.716132 39767 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240119 21:33:23.093600 39219 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240119 21:33:23.221079 39219 grad_async_v2.h:236] pq is empty
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240119 21:33:23.223505 42296 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
E20240119 21:33:24.093008 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=19
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
W20240119 21:33:24.380260 42296 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240119 21:33:25.093010 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=22
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.432 ms                  | 355.729 ms                |
| ProcessBack:UpdateCache   | 22.348 ms                 | 1.911 s                   |
| ProcessBack:UpsertPq      | 81.684 ms                 | 127.416 ms                |
| ProcessOneStep            | 117.026 ms                | 2.399 s                   |
| BlockToStepN              | 46.471 us                 | 83.172 us                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 142.698 us                | 672.677 us                |
| GenInput                  | 604.269 us                | 3.434 ms                  |
| Forward                   | 395.326 us                | 47.523 ms                 |
| Backward                  | 950.052 us                | 36.877 ms                 |
| Optimize                  | 132.034 us                | 580.654 us                |
| BarrierTimeBeforeRank0    | 344.006 us                | 15.606 ms                 |
| AfterBackward             | 117.063 ms                | 2.400 s                   |
| BlockToStepN              | 106.554 us                | 211.992 us                |
| OneStep                   | 121.526 ms                | 2.505 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 21:33:25.457005 42296 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
E20240119 21:33:26.093012 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240119 21:33:26.383378 39219 grad_async_v2.h:236] pq is empty
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
W20240119 21:33:26.482429 42296 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
W20240119 21:33:26.877454 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=21, pq.top=21
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
E20240119 21:33:27.093008 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=482
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240119 21:33:27.612639 42296 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
E20240119 21:33:28.093009 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=82
W20240119 21:33:28.639483 42296 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 21:33:28.745046 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=31, pq.top=31
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
E20240119 21:33:29.093008 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240119 21:33:29.697899 42296 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
E20240119 21:33:30.093011 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=112
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.945 ms                  | 355.729 ms                |
| ProcessBack:UpdateCache   | 20.945 ms                 | 1.911 s                   |
| ProcessBack:UpsertPq      | 62.708 ms                 | 138.815 ms                |
| ProcessOneStep            | 93.013 ms                 | 2.399 s                   |
| BlockToStepN              | 56.533 us                 | 18.972 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.224 us                | 672.677 us                |
| GenInput                  | 658.439 us                | 3.752 ms                  |
| Forward                   | 370.019 us                | 47.523 ms                 |
| Backward                  | 945.960 us                | 36.877 ms                 |
| Optimize                  | 120.243 us                | 580.654 us                |
| BarrierTimeBeforeRank0    | 322.220 us                | 15.606 ms                 |
| AfterBackward             | 93.055 ms                 | 2.400 s                   |
| BlockToStepN              | 139.110 us                | 19.058 ms                 |
| OneStep                   | 102.232 ms                | 2.505 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 21:33:30.783864 42296 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240119 21:33:30.986078 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=45, pq.top=45
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
E20240119 21:33:31.093009 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=2037
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240119 21:33:31.909183 42296 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end4
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
E20240119 21:33:32.093010 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=1005
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
W20240119 21:33:32.480123 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=58, pq.top=58
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
W20240119 21:33:33.023435 42296 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
E20240119 21:33:33.093008 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=202
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240119 21:33:33.848686 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=62, pq.top=62
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
W20240119 21:33:34.033952 42296 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
E20240119 21:33:34.093008 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=5630
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
W20240119 21:33:35.080065 42296 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
E20240119 21:33:35.093001 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=241
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.301 ms                  | 13.301 ms                 |
| ProcessBack:UpdateCache   | 22.090 ms                 | 31.948 ms                 |
| ProcessBack:UpsertPq      | 61.197 ms                 | 127.416 ms                |
| ProcessOneStep            | 92.203 ms                 | 1.318 s                   |
| BlockToStepN              | 112.093 us                | 11.730 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.683 us                | 654.291 us                |
| GenInput                  | 625.914 us                | 3.434 ms                  |
| Forward                   | 375.210 us                | 1.507 ms                  |
| Backward                  | 918.069 us                | 1.992 ms                  |
| Optimize                  | 118.496 us                | 183.476 us                |
| BarrierTimeBeforeRank0    | 348.500 us                | 1.804 ms                  |
| AfterBackward             | 92.243 ms                 | 1.318 s                   |
| BlockToStepN              | 213.233 us                | 11.815 ms                 |
| OneStep                   | 101.005 ms                | 1.325 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
W20240119 21:33:36.080654 42296 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
E20240119 21:33:36.093003 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=87
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
E20240119 21:33:37.093010 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=127
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
W20240119 21:33:37.244434 42296 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end8
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
E20240119 21:33:38.093022 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=106
W20240119 21:33:38.323087 42296 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
W20240119 21:33:38.791288 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=91, pq.top=91
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
E20240119 21:33:39.093009 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=3593
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
W20240119 21:33:39.513574 42296 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank3, time: 34.246, per_step: 0.342462
Step99:rank5, time: 34.246, per_step: 0.342458
Step99:rank6, time: 34.246, per_step: 0.342463
Step99:rank0, time: 34.246, per_step: 0.342459
Step99:rank4, time: 34.246, per_step: 0.342463
Step99:rank7, time: 34.246, per_step: 0.342463
Step99:rank1, time: 34.246, per_step: 0.342463
Step99:rank2, time: 34.246, per_step: 0.342463
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240119 21:33:40.093015 42295 parallel_pq_v2.h:76] insert failed, size(hashtable)=117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.301 ms                  | 14.694 ms                 |
| ProcessBack:UpdateCache   | 22.070 ms                 | 32.461 ms                 |
| ProcessBack:UpsertPq      | 62.054 ms                 | 127.416 ms                |
| ProcessOneStep            | 93.685 ms                 | 1.318 s                   |
| BlockToStepN              | 157.518 us                | 18.972 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.683 us                | 654.291 us                |
| GenInput                  | 604.270 us                | 3.434 ms                  |
| Forward                   | 370.206 us                | 1.507 ms                  |
| Backward                  | 882.813 us                | 1.992 ms                  |
| Optimize                  | 116.074 us                | 336.661 us                |
| BarrierTimeBeforeRank0    | 360.671 us                | 1.804 ms                  |
| AfterBackward             | 93.723 ms                 | 1.318 s                   |
| BlockToStepN              | 247.168 us                | 19.058 ms                 |
| OneStep                   | 102.232 ms                | 1.325 s                   |
| E2E-100                   | 19.228 s                  | 19.228 s                  |
+---------------------------+---------------------------+---------------------------+
W20240119 21:33:40.572011 42296 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240119 21:33:41.024281 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=103, pq.top=103
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
E20240119 21:33:41.093009 39219 parallel_pq_v2.h:76] insert failed, size(hashtable)=7161
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
W20240119 21:33:41.654002 42296 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end9
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
E20240119 21:33:42.093156 39219 parallel_pq_v2.h:76] insert failed, size(hashtable)=51
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
W20240119 21:33:42.695151 42296 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end7
E20240119 21:33:43.093015 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=7154
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
W20240119 21:33:43.701053 42296 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 117 ========== 
========== Step 117 ========== 
W20240119 21:33:43.808851 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=118, pq.top=118
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
E20240119 21:33:44.093010 39219 parallel_pq_v2.h:76] insert failed, size(hashtable)=13150
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
W20240119 21:33:44.775206 42296 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end6
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
E20240119 21:33:45.093012 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=423
W20240119 21:33:45.187357 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=130, pq.top=130
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.120 ms                  | 14.694 ms                 |
| ProcessBack:UpdateCache   | 20.912 ms                 | 32.880 ms                 |
| ProcessBack:UpsertPq      | 62.731 ms                 | 127.416 ms                |
| ProcessOneStep            | 94.538 ms                 | 1.318 s                   |
| BlockToStepN              | 180.705 us                | 38.303 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 126.096 us                | 672.677 us                |
| GenInput                  | 624.936 us                | 3.752 ms                  |
| Forward                   | 364.370 us                | 1.507 ms                  |
| Backward                  | 884.930 us                | 1.992 ms                  |
| Optimize                  | 112.815 us                | 336.661 us                |
| BarrierTimeBeforeRank0    | 352.265 us                | 1.804 ms                  |
| AfterBackward             | 94.580 ms                 | 1.318 s                   |
| BlockToStepN              | 277.088 us                | 38.403 ms                 |
| OneStep                   | 104.051 ms                | 1.325 s                   |
| E2E-100                   | 19.228 s                  | 19.228 s                  |
+---------------------------+---------------------------+---------------------------+
W20240119 21:33:45.896689 42296 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
E20240119 21:33:46.093009 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=1454
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240119 21:33:46.722472 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=134, pq.top=134
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
W20240119 21:33:47.072662 42296 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240119 21:33:47.093006 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=58745
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
W20240119 21:33:47.824221 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=138, pq.top=138
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240119 21:33:48.089567 42296 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 21:33:48.093003 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=64152
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
E20240119 21:33:49.093009 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=317048
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
W20240119 21:33:49.161717 42296 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240119 21:33:49.379953 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=150, pq.top=150
E20240119 21:33:50.093014 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=178863
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.289 ms                  | 14.533 ms                 |
| ProcessBack:UpdateCache   | 22.013 ms                 | 36.130 ms                 |
| ProcessBack:UpsertPq      | 62.801 ms                 | 127.416 ms                |
| ProcessOneStep            | 99.110 ms                 | 1.318 s                   |
| BlockToStepN              | 199.419 us                | 349.847 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 21:33:50.299715 42296 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240119 21:33:50.379073 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=151, pq.top=150
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 130.587 us                | 672.677 us                |
| GenInput                  | 635.087 us                | 7.496 ms                  |
| Forward                   | 368.682 us                | 1.204 ms                  |
| Backward                  | 878.140 us                | 1.520 ms                  |
| Optimize                  | 115.045 us                | 183.476 us                |
| BarrierTimeBeforeRank0    | 360.671 us                | 1.804 ms                  |
| AfterBackward             | 99.400 ms                 | 1.232 s                   |
| BlockToStepN              | 288.203 us                | 350.014 ms                |
| OneStep                   | 106.005 ms                | 1.325 s                   |
| E2E-100                   | 19.228 s                  | 19.228 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
E20240119 21:33:51.093006 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=404237
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240119 21:33:51.357924 42296 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end1
W20240119 21:33:52.043035 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240119 21:33:52.096195 42295 parallel_pq_v2.h:76] insert failed, size(hashtable)=112184
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240119 21:33:53.010473 42296 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 21:33:53.096009 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=1802
W20240119 21:33:53.332360 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=162, pq.top=161
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
E20240119 21:33:54.096011 39219 parallel_pq_v2.h:76] insert failed, size(hashtable)=11646
W20240119 21:33:54.099514 42296 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
W20240119 21:33:54.332047 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=168, pq.top=168
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240119 21:33:54.795281 42295 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
E20240119 21:33:55.096006 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=23606
W20240119 21:33:55.176067 42296 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.413 ms                  | 14.533 ms                 |
| ProcessBack:UpdateCache   | 21.107 ms                 | 35.937 ms                 |
| ProcessBack:UpsertPq      | 62.801 ms                 | 114.054 ms                |
| ProcessOneStep            | 99.358 ms                 | 1.232 s                   |
| BlockToStepN              | 227.564 us                | 546.830 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 21:33:55.332346 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=171, pq.top=171
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 129.999 us                | 1.118 ms                  |
| GenInput                  | 633.758 us                | 27.359 ms                 |
| Forward                   | 365.930 us                | 1.204 ms                  |
| Backward                  | 874.765 us                | 1.520 ms                  |
| Optimize                  | 113.588 us                | 231.134 us                |
| BarrierTimeBeforeRank0    | 361.850 us                | 2.698 ms                  |
| AfterBackward             | 99.400 ms                 | 1.232 s                   |
| BlockToStepN              | 321.968 us                | 547.010 ms                |
| OneStep                   | 106.005 ms                | 1.325 s                   |
| E2E-100                   | 19.228 s                  | 19.228 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
E20240119 21:33:56.096010 42295 parallel_pq_v2.h:76] insert failed, size(hashtable)=257771
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
W20240119 21:33:56.225298 42296 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
W20240119 21:33:56.332288 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
E20240119 21:33:57.096010 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=211803
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
W20240119 21:33:57.362579 42296 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end7
W20240119 21:33:57.415516 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=187, pq.top=187
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
E20240119 21:33:58.096009 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=170145
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
W20240119 21:33:58.486171 42296 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
E20240119 21:33:59.096011 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=410382
W20240119 21:33:59.509173 42296 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
W20240119 21:33:59.744478 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=193, pq.top=193
E20240119 21:34:00.097254 42295 parallel_pq_v2.h:76] insert failed, size(hashtable)=24350
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.432 ms                  | 14.533 ms                 |
| ProcessBack:UpdateCache   | 22.148 ms                 | 36.375 ms                 |
| ProcessBack:UpsertPq      | 61.813 ms                 | 114.054 ms                |
| ProcessOneStep            | 99.110 ms                 | 1.232 s                   |
| BlockToStepN              | 274.953 us                | 641.534 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 131.838 us                | 1.557 ms                  |
| GenInput                  | 635.087 us                | 27.359 ms                 |
| Forward                   | 370.018 us                | 1.204 ms                  |
| Backward                  | 864.564 us                | 1.520 ms                  |
| Optimize                  | 114.855 us                | 231.134 us                |
| BarrierTimeBeforeRank0    | 361.850 us                | 2.698 ms                  |
| AfterBackward             | 99.146 ms                 | 1.232 s                   |
| BlockToStepN              | 363.172 us                | 641.697 ms                |
| OneStep                   | 105.960 ms                | 1.325 s                   |
| E2E-100                   | 19.228 s                  | 19.228 s                  |
+---------------------------+---------------------------+---------------------------+
W20240119 21:34:00.744040 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=193, pq.top=193
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240119 21:34:00.786304 42296 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
E20240119 21:34:01.097008 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=71787
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
Step199:rank1, time: 21.803, per_step: 0.215875
Step199:rank3, time: 21.803, per_step: 0.215876
Step199:rank2, time: 21.803, per_step: 0.215875
Step199:rank0, time: 21.803, per_step: 0.215876
Step199:rank6, time: 21.803, per_step: 0.215876
Step199:rank5, time: 21.803, per_step: 0.215876
Step199:rank4, time: 21.803, per_step: 0.215876
Step199:rank7, time: 21.803, per_step: 0.215876
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
W20240119 21:34:01.984364 42296 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 21:34:02.097013 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=314035
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
E20240119 21:34:03.097008 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=526399
W20240119 21:34:03.122735 42296 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 21:34:03.369340 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=207, pq.top=207
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
E20240119 21:34:04.097016 39219 parallel_pq_v2.h:76] insert failed, size(hashtable)=50225
W20240119 21:34:04.134229 42296 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240119 21:34:04.369316 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=208, pq.top=208
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
E20240119 21:34:05.097012 39219 parallel_pq_v2.h:76] insert failed, size(hashtable)=41422
W20240119 21:34:05.160126 42296 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.481 ms                  | 14.533 ms                 |
| ProcessBack:UpdateCache   | 22.148 ms                 | 36.699 ms                 |
| ProcessBack:UpsertPq      | 61.519 ms                 | 127.416 ms                |
| ProcessOneStep            | 98.900 ms                 | 1.232 s                   |
| BlockToStepN              | 326.723 us                | 847.970 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 21:34:05.369096 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=214, pq.top=214
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 132.695 us                | 1.557 ms                  |
| GenInput                  | 636.322 us                | 27.359 ms                 |
| Forward                   | 369.711 us                | 1.204 ms                  |
| Backward                  | 869.887 us                | 1.520 ms                  |
| Optimize                  | 114.613 us                | 231.134 us                |
| BarrierTimeBeforeRank0    | 349.019 us                | 2.698 ms                  |
| AfterBackward             | 98.937 ms                 | 1.232 s                   |
| BlockToStepN              | 409.646 us                | 848.135 ms                |
| OneStep                   | 105.689 ms                | 1.841 s                   |
| E2E-100                   | 19.228 s                  | 21.803 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
E20240119 21:34:06.097007 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=290164
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
W20240119 21:34:06.305403 42296 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end4
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
E20240119 21:34:07.098627 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=540900
W20240119 21:34:07.316766 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=225, pq.top=225
E20240119 21:34:08.108389 42295 parallel_pq_v2.h:76] insert failed, size(hashtable)=47545
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
W20240119 21:34:08.194767 42296 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240119 21:34:08.370342 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=226, pq.top=226
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
E20240119 21:34:09.108009 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=54408
W20240119 21:34:09.223986 42296 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
W20240119 21:34:09.480515 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=232, pq.top=231
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
E20240119 21:34:10.108011 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=50456
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.458 ms                  | 14.533 ms                 |
| ProcessBack:UpdateCache   | 22.090 ms                 | 36.699 ms                 |
| ProcessBack:UpsertPq      | 62.054 ms                 | 127.416 ms                |
| ProcessOneStep            | 99.115 ms                 | 1.232 s                   |
| BlockToStepN              | 414.115 us                | 878.539 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 21:34:10.305950 42296 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 132.235 us                | 2.003 ms                  |
| GenInput                  | 642.662 us                | 29.645 ms                 |
| Forward                   | 369.711 us                | 1.204 ms                  |
| Backward                  | 874.765 us                | 1.520 ms                  |
| Optimize                  | 114.555 us                | 231.134 us                |
| BarrierTimeBeforeRank0    | 348.717 us                | 2.698 ms                  |
| AfterBackward             | 99.165 ms                 | 1.232 s                   |
| BlockToStepN              | 513.848 us                | 878.684 ms                |
| OneStep                   | 106.193 ms                | 1.841 s                   |
| E2E-100                   | 19.228 s                  | 21.803 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
E20240119 21:34:11.108011 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=278331
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
W20240119 21:34:11.403599 42296 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
E20240119 21:34:12.108011 39219 parallel_pq_v2.h:76] insert failed, size(hashtable)=4828
W20240119 21:34:12.143777 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
W20240119 21:34:13.035684 42296 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 247 ========== 
========== Step 247 ========== 
E20240119 21:34:13.108064 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=20324
W20240119 21:34:13.200453 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=248
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
W20240119 21:34:14.089644 42296 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
E20240119 21:34:14.108011 39219 parallel_pq_v2.h:76] insert failed, size(hashtable)=282294
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
E20240119 21:34:15.108011 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=8460
W20240119 21:34:15.283957 42296 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.560 ms                  | 14.312 ms                 |
| ProcessBack:UpdateCache   | 22.153 ms                 | 36.662 ms                 |
| ProcessBack:UpsertPq      | 61.519 ms                 | 123.967 ms                |
| ProcessOneStep            | 99.110 ms                 | 1.218 s                   |
| BlockToStepN              | 481.816 us                | 878.539 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 134.824 us                | 1.885 ms                  |
| GenInput                  | 635.228 us                | 29.645 ms                 |
| Forward                   | 369.225 us                | 774.942 us                |
| Backward                  | 873.043 us                | 1.441 ms                  |
| Optimize                  | 114.613 us                | 183.476 us                |
| BarrierTimeBeforeRank0    | 336.153 us                | 1.804 ms                  |
| AfterBackward             | 99.146 ms                 | 1.218 s                   |
| BlockToStepN              | 559.475 us                | 878.684 ms                |
| OneStep                   | 106.005 ms                | 1.840 s                   |
| E2E-100                   | 19.228 s                  | 21.803 s                  |
+---------------------------+---------------------------+---------------------------+
W20240119 21:34:15.945075 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=262, pq.top=262
E20240119 21:34:16.108983 42295 parallel_pq_v2.h:76] insert failed, size(hashtable)=200994
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
W20240119 21:34:16.428372 42296 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 262 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
W20240119 21:34:16.982411 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=264, pq.top=264
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
E20240119 21:34:17.108011 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=350781
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
W20240119 21:34:17.443652 42296 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
W20240119 21:34:17.982379 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=271, pq.top=271
E20240119 21:34:18.108011 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=417
W20240119 21:34:18.449048 42296 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240119 21:34:18.982332 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=271, pq.top=271
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
E20240119 21:34:19.108012 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=187961
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
W20240119 21:34:19.453723 42296 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
E20240119 21:34:20.108012 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=375006
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.526 ms                  | 14.554 ms                 |
| ProcessBack:UpdateCache   | 22.137 ms                 | 36.662 ms                 |
| ProcessBack:UpsertPq      | 61.381 ms                 | 127.416 ms                |
| ProcessOneStep            | 98.900 ms                 | 1.218 s                   |
| BlockToStepN              | 524.539 us                | 891.780 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.683 us                | 2.003 ms                  |
| GenInput                  | 633.758 us                | 42.041 ms                 |
| Forward                   | 368.865 us                | 1.204 ms                  |
| Backward                  | 873.909 us                | 1.441 ms                  |
| Optimize                  | 114.516 us                | 183.476 us                |
| BarrierTimeBeforeRank0    | 327.879 us                | 1.804 ms                  |
| AfterBackward             | 98.937 ms                 | 1.218 s                   |
| BlockToStepN              | 603.715 us                | 891.944 ms                |
| OneStep                   | 106.005 ms                | 1.840 s                   |
| E2E-100                   | 19.228 s                  | 21.803 s                  |
+---------------------------+---------------------------+---------------------------+
W20240119 21:34:20.540563 42296 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end4
E20240119 21:34:21.108011 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=599337
W20240119 21:34:21.212765 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=284, pq.top=284
E20240119 21:34:22.116833 42295 parallel_pq_v2.h:76] insert failed, size(hashtable)=10462
W20240119 21:34:22.212034 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=284, pq.top=284
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
W20240119 21:34:22.247743 42296 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
E20240119 21:34:23.116007 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=176934
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
W20240119 21:34:23.346657 42296 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
W20240119 21:34:23.882112 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=297, pq.top=297
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
E20240119 21:34:24.116009 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=508549
W20240119 21:34:24.561672 42296 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
E20240119 21:34:25.116010 42296 parallel_pq_v2.h:76] insert failed, size(hashtable)=159531
W20240119 21:34:25.211187 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=299, pq.top=299
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.479 ms                  | 14.554 ms                 |
| ProcessBack:UpdateCache   | 22.060 ms                 | 36.662 ms                 |
| ProcessBack:UpsertPq      | 61.197 ms                 | 127.416 ms                |
| ProcessOneStep            | 98.680 ms                 | 1.218 s                   |
| BlockToStepN              | 585.937 us                | 967.704 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 132.695 us                | 2.003 ms                  |
| GenInput                  | 635.087 us                | 42.041 ms                 |
| Forward                   | 366.836 us                | 1.204 ms                  |
| Backward                  | 878.519 us                | 1.441 ms                  |
| Optimize                  | 113.905 us                | 183.476 us                |
| BarrierTimeBeforeRank0    | 323.857 us                | 1.804 ms                  |
| AfterBackward             | 98.740 ms                 | 1.218 s                   |
| BlockToStepN              | 668.488 us                | 967.909 ms                |
| OneStep                   | 105.689 ms                | 1.841 s                   |
| E2E-100                   | 19.228 s                  | 21.803 s                  |
+---------------------------+---------------------------+---------------------------+
E20240119 21:34:26.133414 42295 parallel_pq_v2.h:76] insert failed, size(hashtable)=182456
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
W20240119 21:34:26.134730 42296 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 21:34:26.262308 39219 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=300, pq.top=299
Step299:rank0, time: 24.968, per_step: 0.247209
Step299:rank7, time: 24.968, per_step: 0.247209
Step299:rank6, time: 24.968, per_step: 0.247209
Step299:rank5, time: 24.968, per_step: 0.247209
Step299:rank3, time: 24.968, per_step: 0.247210
Step299:rank2, time: 24.968, per_step: 0.247210
Step299:rank1, time: 24.968, per_step: 0.247210
Step299:rank4, time: 24.968, per_step: 0.247209
timer name is timer name is E2E-100E2E-100

timer name is E2E-100timer name is 
timer name is E2E-100
E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
ERROR [39219 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
