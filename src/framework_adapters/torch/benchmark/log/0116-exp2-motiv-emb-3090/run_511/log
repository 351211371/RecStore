WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240119 22:43:47.173993 52670 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240119 22:43:47.179759 52670 IPCTensor.h:367] NewIPCTensor: full_emb [100000000, 32]0x100000002000
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:148: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [52670 perf_emb.py:148] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fa2c0565bc0>==========
Worker 1 pid=53179
Worker 2 pid=53180
Worker 3 pid=53181
Worker 4 pid=53182
Worker 5 pid=53183
Worker 6 pid=53184
INFO [52670 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [53179 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [53180 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [53181 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [53182 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [53183 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [53179 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53182 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53183 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53180 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53184 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [53185 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [53181 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53184 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [53185 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240119 22:43:49.435031 53182 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 22:43:49.435055 53179 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 22:43:49.435057 53183 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 22:43:49.435150 53180 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 22:43:49.435400 53181 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 22:43:49.435559 53184 IPCTensor.h:346] IPCTensor full_emb already exists
E20240119 22:43:49.435588 53185 IPCTensor.h:346] IPCTensor full_emb already exists
INFO [52670 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240119 22:43:49.444833 52670 IPCTensor.h:346] IPCTensor full_emb already exists
W20240119 22:43:49.474534 52670 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [10000000, 32]; dev=0; size=1.192 GB
W20240119 22:43:49.474512 53180 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [10000000, 32]; dev=2; size=1.192 GB
W20240119 22:43:49.474517 53185 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_7 [10000000, 32]; dev=7; size=1.192 GB
W20240119 22:43:49.474519 53182 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_4 [10000000, 32]; dev=4; size=1.192 GB
W20240119 22:43:49.474515 53183 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_5 [10000000, 32]; dev=5; size=1.192 GB
W20240119 22:43:49.474516 53179 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [10000000, 32]; dev=1; size=1.192 GB
W20240119 22:43:49.474525 53184 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_6 [10000000, 32]; dev=6; size=1.192 GB
W20240119 22:43:49.475975 53181 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [10000000, 32]; dev=3; size=1.192 GB
W20240119 22:43:50.522131 53180 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1002faf0e000
W20240119 22:43:50.522289 53180 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x1002fafd3000
W20240119 22:43:50.522325 53180 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 32]0x1002fb098000
W20240119 22:43:50.522353 53180 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 32]0x1002fbccf000
W20240119 22:43:50.522383 53180 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240119 22:43:50.543952 53180 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240119 22:43:50.544348 52670 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1002fc90a000
W20240119 22:43:50.544533 52670 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1002fc9d1000
W20240119 22:43:50.544574 53183 IPCTensor.h:367] NewIPCTensor: input_keys_5 [100000]0x1002fca96000
W20240119 22:43:50.544605 52670 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 32]0x1002fcb5b000
W20240119 22:43:50.544637 52670 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 32]0x1002fd792000
W20240119 22:43:50.544684 53183 IPCTensor.h:367] NewIPCTensor: input_keys_neg_5 [100000]0x1002fe3c9000
W20240119 22:43:50.544719 53183 IPCTensor.h:367] NewIPCTensor: backward_grads_5 [100000, 32]0x1002fe48e000
W20240119 22:43:50.544692 52670 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240119 22:43:50.544754 53183 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_5 [100000, 32]0x1002ff0c5000
W20240119 22:43:50.544799 53183 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_5_gpu [100000, 32]; dev=5; size=12.21 MB
W20240119 22:43:50.550334 52670 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240119 22:43:50.550382 53183 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 32]; dev=5; size=12.21 MB
W20240119 22:43:50.551815 53182 IPCTensor.h:367] NewIPCTensor: input_keys_4 [100000]0x1002ffd04000
W20240119 22:43:50.551913 53182 IPCTensor.h:367] NewIPCTensor: input_keys_neg_4 [100000]0x1002ffdc9000
W20240119 22:43:50.551947 53182 IPCTensor.h:367] NewIPCTensor: backward_grads_4 [100000, 32]0x1002ffe8e000
W20240119 22:43:50.551985 53182 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_4 [100000, 32]0x100300ac5000
W20240119 22:43:50.552019 53182 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_4_gpu [100000, 32]; dev=4; size=12.21 MB
W20240119 22:43:50.566084 53182 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 32]; dev=4; size=12.21 MB
W20240119 22:43:50.569483 53184 IPCTensor.h:367] NewIPCTensor: input_keys_6 [100000]0x100301704000
W20240119 22:43:50.569730 53184 IPCTensor.h:367] NewIPCTensor: input_keys_neg_6 [100000]0x1003017c9000
W20240119 22:43:50.569801 53184 IPCTensor.h:367] NewIPCTensor: backward_grads_6 [100000, 32]0x10030188e000
W20240119 22:43:50.569857 53184 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_6 [100000, 32]0x1003024c5000
W20240119 22:43:50.569918 53184 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_6_gpu [100000, 32]; dev=6; size=12.21 MB
W20240119 22:43:50.581424 53184 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 32]; dev=6; size=12.21 MB
W20240119 22:43:50.587631 53181 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x100303104000
W20240119 22:43:50.587754 53181 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1003031c9000
W20240119 22:43:50.587790 53181 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 32]0x10030328e000
W20240119 22:43:50.587827 53181 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 32]0x100303ec5000
W20240119 22:43:50.587860 53181 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240119 22:43:50.589664 53181 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240119 22:43:50.604833 53185 IPCTensor.h:367] NewIPCTensor: input_keys_7 [100000]0x100304b02000
W20240119 22:43:50.604970 53185 IPCTensor.h:367] NewIPCTensor: input_keys_neg_7 [100000]0x100304bc7000
W20240119 22:43:50.605017 53185 IPCTensor.h:367] NewIPCTensor: backward_grads_7 [100000, 32]0x100304c8e000
W20240119 22:43:50.605099 53185 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_7 [100000, 32]0x1003058c5000
W20240119 22:43:50.605154 53185 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_7_gpu [100000, 32]; dev=7; size=12.21 MB
W20240119 22:43:50.605222 53179 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1003064fc000
W20240119 22:43:50.605315 53179 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x1003065c1000
W20240119 22:43:50.605340 53179 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 32]0x100306686000
W20240119 22:43:50.605367 53179 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 32]0x1003072bd000
W20240119 22:43:50.605389 53179 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240119 22:43:50.607386 53185 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 32]; dev=7; size=12.21 MB
W20240119 22:43:50.607481 53179 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 32]; dev=1; size=12.21 MB
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
Worker 7 pid=53185
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 10000000), (10000000, 20000000), (20000000, 30000000), (30000000, 40000000), (40000000, 50000000), (50000000, 60000000), (60000000, 70000000), (70000000, 80000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
W20240119 22:43:55.383067 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_0 [100000]0x100307efc000
W20240119 22:43:55.383195 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_1 [100000]0x100307fc1000
W20240119 22:43:55.383234 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_2 [100000]0x100308086000
W20240119 22:43:55.383277 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_3 [100000]0x10030814b000
W20240119 22:43:55.383311 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_4 [100000]0x100308210000
W20240119 22:43:55.383344 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_5 [100000]0x1003082d5000
W20240119 22:43:55.383374 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_6 [100000]0x10030839a000
W20240119 22:43:55.383420 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_7 [100000]0x10030845f000
W20240119 22:43:55.383450 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_8 [100000]0x100308524000
W20240119 22:43:55.383492 53185 IPCTensor.h:367] NewIPCTensor: cached_sampler_r7_9 [100000]0x1003085e9000
W20240119 22:43:55.383538 53185 IPCTensor.h:367] NewIPCTensor: step_r7 [10]0x1003086ae000
W20240119 22:43:55.383574 53185 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r7 [1]0x1003086b0000
W20240119 22:43:55.383605 53185 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100308777000
W20240119 22:43:55.383621 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x1003086b2000
W20240119 22:43:55.383718 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_0 [100000]0x100308779000
W20240119 22:43:55.383875 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x10030883e000
W20240119 22:43:55.383988 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x100308903000
Construct PerfSampler done
W20240119 22:43:55.384043 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_1 [100000]0x1003089c8000
W20240119 22:43:55.384080 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x100308a8d000
I20240119 22:43:55.384088 53185 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240119 22:43:55.384092 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_2 [100000]0x100308b52000
W20240119 22:43:55.384153 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100308c17000
W20240119 22:43:55.384160 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_3 [100000]0x100308cdc000
W20240119 22:43:55.384187 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_4 [100000]0x100308da1000
W20240119 22:43:55.384212 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x100308e66000
W20240119 22:43:55.384231 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_5 [100000]0x100308f2b000
W20240119 22:43:55.384255 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_6 [100000]0x100308ff0000
W20240119 22:43:55.384274 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x1003090b5000
W20240119 22:43:55.384323 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_7 [100000]0x10030917a000
W20240119 22:43:55.384348 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x10030923f000
W20240119 22:43:55.384352 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_8 [100000]0x100309304000
W20240119 22:43:55.384385 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x1003093c9000
W20240119 22:43:55.384413 53184 IPCTensor.h:367] NewIPCTensor: cached_sampler_r6_9 [100000]0x10030948e000
W20240119 22:43:55.384446 53180 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x100309553000
W20240119 22:43:55.384461 53184 IPCTensor.h:367] NewIPCTensor: step_r6 [10]0x100309618000
W20240119 22:43:55.384487 53184 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r6 [1]0x10030961a000
W20240119 22:43:55.384523 53180 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x10030961c000
W20240119 22:43:55.384526 53184 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10030961e000
W20240119 22:43:55.384560 53180 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100309620000
W20240119 22:43:55.384594 53180 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100309622000
W20240119 22:43:55.384729 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100309624000
W20240119 22:43:55.384892 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x1003096e9000
W20240119 22:43:55.384922 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1003097ae000
W20240119 22:43:55.384977 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x100309873000
Construct PerfSampler done
W20240119 22:43:55.385012 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100309938000
W20240119 22:43:55.385056 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x1003099fd000
W20240119 22:43:55.385084 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x100309ac2000
Construct PerfSampler done
W20240119 22:43:55.385102 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x100309b87000
I20240119 22:43:55.385130 53180 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 22:43:55.385139 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100309c4c000
W20240119 22:43:55.385157 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x100309d11000
W20240119 22:43:55.385185 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x100309dd6000
W20240119 22:43:55.385216 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100309e9b000
W20240119 22:43:55.385224 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100309f60000
W20240119 22:43:55.385258 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x10030a025000
W20240119 22:43:55.385283 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x10030a0ea000
I20240119 22:43:55.385301 53184 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 22:43:55.385308 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x10030a1af000
W20240119 22:43:55.385325 52670 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x10030a274000
W20240119 22:43:55.385360 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x10030a339000
W20240119 22:43:55.385371 52670 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x10030a3fe000
W20240119 22:43:55.385401 52670 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x10030a400000
W20240119 22:43:55.385421 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x10030a402000
W20240119 22:43:55.385427 52670 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10030a4c7000
W20240119 22:43:55.385437 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x10030a4c9000
W20240119 22:43:55.385463 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x10030a58e000
W20240119 22:43:55.385494 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x10030a653000
W20240119 22:43:55.385509 53179 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x10030a718000
W20240119 22:43:55.385550 53179 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x10030a8a2000
W20240119 22:43:55.385555 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x10030a8a4000
W20240119 22:43:55.385545 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_0 [100000]0x10030a7dd000
W20240119 22:43:55.385576 53179 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x10030a969000
W20240119 22:43:55.385594 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x10030a96b000
W20240119 22:43:55.385612 53179 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10030aa30000
W20240119 22:43:55.385639 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x10030aa32000
W20240119 22:43:55.385675 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x10030aaf7000
W20240119 22:43:55.385715 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_1 [100000]0x10030abbc000
W20240119 22:43:55.385751 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_2 [100000]0x10030ac81000
W20240119 22:43:55.385761 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x10030ad46000
W20240119 22:43:55.385792 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x10030ae0b000
W20240119 22:43:55.385802 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_3 [100000]0x10030aed0000
Construct PerfSampler done
W20240119 22:43:55.385830 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_4 [100000]0x10030af95000
Construct PerfSampler done
W20240119 22:43:55.385847 53181 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x10030b05a000
W20240119 22:43:55.385877 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_5 [100000]0x10030b11f000
W20240119 22:43:55.385900 53181 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x10030b1e4000
W20240119 22:43:55.385907 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_6 [100000]0x10030b1e6000
I20240119 22:43:55.385921 53179 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 22:43:55.385941 53181 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x10030b2ab000
W20240119 22:43:55.385977 53181 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10030b372000
I20240119 22:43:55.385982 52670 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 22:43:55.385995 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_7 [100000]0x10030b374000
W20240119 22:43:55.385980 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_0 [100000]0x10030b2ad000
W20240119 22:43:55.386025 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_8 [100000]0x10030b439000
W20240119 22:43:55.386077 53183 IPCTensor.h:367] NewIPCTensor: cached_sampler_r5_9 [100000]0x10030b4fe000
W20240119 22:43:55.386129 53183 IPCTensor.h:367] NewIPCTensor: step_r5 [10]0x10030b5c3000
W20240119 22:43:55.386181 53183 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r5 [1]0x10030b5c5000
W20240119 22:43:55.386216 53183 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10030b5c7000
W20240119 22:43:55.386252 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_1 [100000]0x10030b5c9000
Construct PerfSampler done
W20240119 22:43:55.386335 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_2 [100000]0x10030b68e000
W20240119 22:43:55.386451 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_3 [100000]0x10030b753000
I20240119 22:43:55.386485 53181 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 22:43:55.386534 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_4 [100000]0x10030b818000
W20240119 22:43:55.386642 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_5 [100000]0x10030b8dd000
Construct PerfSampler done
W20240119 22:43:55.386716 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_6 [100000]0x10030b9a2000
I20240119 22:43:55.386785 53183 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 22:43:55.386826 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_7 [100000]0x10030ba67000
W20240119 22:43:55.386891 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_8 [100000]0x10030bb2c000
W20240119 22:43:55.387014 53182 IPCTensor.h:367] NewIPCTensor: cached_sampler_r4_9 [100000]0x10030bbf1000
W20240119 22:43:55.387112 53182 IPCTensor.h:367] NewIPCTensor: step_r4 [10]0x10030bcb6000
W20240119 22:43:55.387181 53182 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r4 [1]0x10030bcb8000
W20240119 22:43:55.387219 53182 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x10030bcba000
Construct PerfSampler done
I20240119 22:43:55.387653 53182 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240119 22:43:55.389240 52670 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240119 22:43:55.389340 52670 grad_base.h:172] Init GradProcessingBase done
I20240119 22:44:05.277842 52670 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=16
W20240119 22:44:05.278069 52670 kg_controller.h:78] after init GradAsyncProcessingV2
I20240119 22:44:05.278076 52670 kg_controller.h:84] Construct KGCacheController done
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240119 22:44:07.086637 52670 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240119 22:44:09.422983 55690 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 22:44:09.423278 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240119 22:44:10.423012 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240119 22:44:10.423928 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 22:44:11.423009 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240119 22:44:11.429373 55690 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
Before Training
I20240119 22:44:12.134052 52670 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240119 22:44:12.199987 53181 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 22:44:12.222131 53182 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 22:44:12.265967 53184 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 22:44:12.288010 53185 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 22:44:12.309871 53179 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 22:44:12.331426 53180 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240119 22:44:12.352962 53183 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240119 22:44:12.423017 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240119 22:44:12.429922 55690 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240119 22:44:14.324967 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240119 22:44:14.436209 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
W20240119 22:44:14.453173 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240119 22:44:14.483145 55689 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
E20240119 22:44:15.324020 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 97.312 us                 | 518.575 us                |
| GenInput                  | 894.214 us                | 6.282 ms                  |
| Forward                   | 498.990 us                | 44.513 ms                 |
| Backward                  | 1.182 ms                  | 32.101 ms                 |
| Optimize                  | 126.928 us                | 802.033 us                |
| BarrierTimeBeforeRank0    | 507.028 us                | 12.424 ms                 |
| AfterBackward             | 318.534 ms                | 1.987 s                   |
| BlockToStepN              | 15.334 ms                 | 25.846 ms                 |
| OneStep                   | 347.126 ms                | 2.098 s                   |
+---------------------------+---------------------------+---------------------------+
W20240119 22:44:15.462939 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=4, pq.top=4
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
W20240119 22:44:15.489231 55690 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
E20240119 22:44:16.324018 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=107
W20240119 22:44:16.491267 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 22:44:16.658711 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=7
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 206.227 ms                | 455.535 ms                |
| ProcessBack:UpdateCache   | 23.379 ms                 | 1.417 s                   |
| ProcessBack:UpsertPq      | 110.968 ms                | 135.101 ms                |
| ProcessOneStep            | 352.498 ms                | 1.987 s                   |
| BlockToStepN              | 24.382 ms                 | 42.913 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240119 22:44:17.324015 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=3900
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
W20240119 22:44:17.511345 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 22:44:17.677814 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=10, pq.top=10
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
E20240119 22:44:18.326507 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=18734
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240119 22:44:18.594002 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240119 22:44:18.912680 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=14, pq.top=14
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
E20240119 22:44:19.327381 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=2981
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
W20240119 22:44:19.596503 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
W20240119 22:44:20.137390 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=18, pq.top=18
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
E20240119 22:44:20.327011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=2238
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 133.881 us                | 639.053 us                |
| GenInput                  | 2.904 ms                  | 6.282 ms                  |
| Forward                   | 405.494 us                | 44.513 ms                 |
| Backward                  | 1.143 ms                  | 32.101 ms                 |
| Optimize                  | 126.928 us                | 802.033 us                |
| BarrierTimeBeforeRank0    | 874.870 us                | 12.424 ms                 |
| AfterBackward             | 313.698 ms                | 1.987 s                   |
| BlockToStepN              | 28.016 ms                 | 44.100 ms                 |
| OneStep                   | 347.835 ms                | 2.098 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
W20240119 22:44:20.602572 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240119 22:44:21.327016 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=781
W20240119 22:44:21.452958 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=22, pq.top=22
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
W20240119 22:44:21.612653 55690 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 197.365 ms                | 455.535 ms                |
| ProcessBack:UpdateCache   | 22.796 ms                 | 1.417 s                   |
| ProcessBack:UpsertPq      | 92.982 ms                 | 135.101 ms                |
| ProcessOneStep            | 311.704 ms                | 1.987 s                   |
| BlockToStepN              | 28.999 ms                 | 43.997 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
E20240119 22:44:22.327018 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=1623
W20240119 22:44:22.499534 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=25, pq.top=25
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
W20240119 22:44:22.624230 55690 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
E20240119 22:44:23.327021 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
W20240119 22:44:23.589110 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=29, pq.top=29
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240119 22:44:23.666848 55690 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
E20240119 22:44:24.327018 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=6496
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
W20240119 22:44:24.693292 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=33, pq.top=32
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
W20240119 22:44:24.726573 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
E20240119 22:44:25.336041 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 120.433 us                | 639.053 us                |
| GenInput                  | 1.536 ms                  | 6.282 ms                  |
| Forward                   | 397.664 us                | 44.513 ms                 |
| Backward                  | 967.963 us                | 32.101 ms                 |
| Optimize                  | 124.069 us                | 802.033 us                |
| BarrierTimeBeforeRank0    | 874.870 us                | 12.424 ms                 |
| AfterBackward             | 295.493 ms                | 1.987 s                   |
| BlockToStepN              | 30.284 ms                 | 44.100 ms                 |
| OneStep                   | 331.263 ms                | 2.098 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
W20240119 22:44:25.761559 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=36, pq.top=36
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240119 22:44:25.791910 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
E20240119 22:44:26.359671 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
W20240119 22:44:26.808254 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=39, pq.top=39
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
W20240119 22:44:26.843206 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 39 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 197.365 ms                | 455.535 ms                |
| ProcessBack:UpdateCache   | 22.663 ms                 | 1.417 s                   |
| ProcessBack:UpsertPq      | 87.137 ms                 | 135.101 ms                |
| ProcessOneStep            | 308.954 ms                | 1.987 s                   |
| BlockToStepN              | 30.149 ms                 | 43.997 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
E20240119 22:44:27.359011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=2729
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
W20240119 22:44:27.846150 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 22:44:27.856738 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=42, pq.top=42
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
E20240119 22:44:28.359009 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=38049
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
W20240119 22:44:28.856015 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=45, pq.top=45
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
W20240119 22:44:28.872915 55690 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
E20240119 22:44:29.359019 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=268
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
W20240119 22:44:29.856065 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=48, pq.top=48
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
W20240119 22:44:29.891836 55690 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
E20240119 22:44:30.359022 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=110561
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 115.873 us                | 639.053 us                |
| GenInput                  | 1.977 ms                  | 6.282 ms                  |
| Forward                   | 397.664 us                | 44.513 ms                 |
| Backward                  | 946.322 us                | 32.101 ms                 |
| Optimize                  | 119.526 us                | 802.033 us                |
| BarrierTimeBeforeRank0    | 874.870 us                | 12.424 ms                 |
| AfterBackward             | 309.045 ms                | 1.987 s                   |
| BlockToStepN              | 31.616 ms                 | 52.726 ms                 |
| OneStep                   | 347.805 ms                | 2.098 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
W20240119 22:44:30.924098 55690 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240119 22:44:31.067135 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=51, pq.top=50
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
E20240119 22:44:31.359011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=20892
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240119 22:44:31.944774 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 201.968 ms                | 247.400 ms                |
| ProcessBack:UpdateCache   | 22.669 ms                 | 34.436 ms                 |
| ProcessBack:UpsertPq      | 80.328 ms                 | 132.731 ms                |
| ProcessOneStep            | 308.954 ms                | 392.782 ms                |
| BlockToStepN              | 32.715 ms                 | 52.569 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240119 22:44:32.359016 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=410
W20240119 22:44:32.393014 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=55, pq.top=55
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
W20240119 22:44:33.060228 55690 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
E20240119 22:44:33.359009 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=64
W20240119 22:44:33.627951 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=59, pq.top=59
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
W20240119 22:44:34.077601 55690 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
E20240119 22:44:34.359011 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=6433
W20240119 22:44:34.627111 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=62, pq.top=62
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
W20240119 22:44:35.083573 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
E20240119 22:44:35.359007 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=737
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.762 us                | 518.575 us                |
| GenInput                  | 1.947 ms                  | 5.966 ms                  |
| Forward                   | 408.573 us                | 972.319 us                |
| Backward                  | 1.046 ms                  | 3.533 ms                  |
| Optimize                  | 120.165 us                | 242.271 us                |
| BarrierTimeBeforeRank0    | 874.870 us                | 3.726 ms                  |
| AfterBackward             | 307.209 ms                | 392.882 ms                |
| BlockToStepN              | 32.383 ms                 | 69.595 ms                 |
| OneStep                   | 347.126 ms                | 422.977 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 22:44:35.627053 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=65, pq.top=65
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
W20240119 22:44:36.104370 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
E20240119 22:44:36.359016 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240119 22:44:36.846181 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=69, pq.top=68
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 197.365 ms                | 247.400 ms                |
| ProcessBack:UpdateCache   | 22.638 ms                 | 34.436 ms                 |
| ProcessBack:UpsertPq      | 78.958 ms                 | 132.731 ms                |
| ProcessOneStep            | 304.854 ms                | 392.782 ms                |
| BlockToStepN              | 32.915 ms                 | 69.442 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240119 22:44:37.122817 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
E20240119 22:44:37.359012 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
W20240119 22:44:38.102332 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=73, pq.top=73
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
W20240119 22:44:38.192296 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 22:44:38.359010 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=79
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
W20240119 22:44:39.204098 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 22:44:39.404578 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=9901
W20240119 22:44:39.482797 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=77, pq.top=77
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240119 22:44:40.236178 55690 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
E20240119 22:44:40.404032 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=37329
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 116.831 us                | 518.575 us                |
| GenInput                  | 1.536 ms                  | 5.966 ms                  |
| Forward                   | 397.664 us                | 972.319 us                |
| Backward                  | 1.063 ms                  | 3.533 ms                  |
| Optimize                  | 119.352 us                | 242.271 us                |
| BarrierTimeBeforeRank0    | 793.036 us                | 3.726 ms                  |
| AfterBackward             | 299.196 ms                | 424.360 ms                |
| BlockToStepN              | 33.741 ms                 | 92.448 ms                 |
| OneStep                   | 341.201 ms                | 458.204 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 22:44:40.574049 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=80, pq.top=80
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
W20240119 22:44:41.310912 55690 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 82 ========== 
E20240119 22:44:41.404013 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=24
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
W20240119 22:44:41.693187 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=84, pq.top=84
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 185.620 ms                | 247.400 ms                |
| ProcessBack:UpdateCache   | 22.795 ms                 | 34.436 ms                 |
| ProcessBack:UpsertPq      | 78.594 ms                 | 135.101 ms                |
| ProcessOneStep            | 298.694 ms                | 424.296 ms                |
| BlockToStepN              | 33.603 ms                 | 92.289 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
W20240119 22:44:42.337891 55690 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
E20240119 22:44:42.404007 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=437
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
W20240119 22:44:42.843639 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=89, pq.top=89
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
E20240119 22:44:43.404011 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=406769
W20240119 22:44:43.417199 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
W20240119 22:44:43.843087 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=92, pq.top=92
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
E20240119 22:44:44.404013 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=71622
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
W20240119 22:44:44.669879 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240119 22:44:44.995342 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=94, pq.top=93
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
E20240119 22:44:45.404016 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=152142
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 116.831 us                | 639.053 us                |
| GenInput                  | 1.526 ms                  | 6.282 ms                  |
| Forward                   | 396.905 us                | 972.319 us                |
| Backward                  | 1.004 ms                  | 3.533 ms                  |
| Optimize                  | 118.117 us                | 269.067 us                |
| BarrierTimeBeforeRank0    | 738.170 us                | 5.427 ms                  |
| AfterBackward             | 294.241 ms                | 424.360 ms                |
| BlockToStepN              | 33.741 ms                 | 228.216 ms                |
| OneStep                   | 337.494 ms                | 842.413 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
W20240119 22:44:45.694602 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240119 22:44:46.006610 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=97, pq.top=97
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
E20240119 22:44:46.404011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=928
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
W20240119 22:44:46.711141 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240119 22:44:47.006065 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=100, pq.top=100
Step99:rank0, time: 51.687, per_step: 0.516867
Step99:rank4, time: 51.686, per_step: 0.516857
Step99:rank3, time: 51.688, per_step: 0.516879
Step99:rank2, time: 51.688, per_step: 0.516882
Step99:rank6, time: 51.688, per_step: 0.516879
Step99:rank7, time: 51.688, per_step: 0.516881
Step99:rank5, time: 51.686, per_step: 0.516860
Step99:rank1, time: 51.688, per_step: 0.516883
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 184.524 ms                | 247.400 ms                |
| ProcessBack:UpdateCache   | 22.597 ms                 | 34.436 ms                 |
| ProcessBack:UpsertPq      | 76.844 ms                 | 135.101 ms                |
| ProcessOneStep            | 294.194 ms                | 424.296 ms                |
| BlockToStepN              | 34.029 ms                 | 228.078 ms                |
+---------------------------+---------------------------+---------------------------+
E20240119 22:44:47.474103 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=56252
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
W20240119 22:44:47.730053 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
W20240119 22:44:48.098686 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=103, pq.top=102
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
E20240119 22:44:48.474028 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=6419
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
W20240119 22:44:48.750716 55690 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
W20240119 22:44:49.158887 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=106, pq.top=106
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
E20240119 22:44:49.544652 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=696
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
W20240119 22:44:49.771281 55690 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
W20240119 22:44:50.320936 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=108
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 116.100 us                | 639.053 us                |
| GenInput                  | 1.466 ms                  | 6.282 ms                  |
| Forward                   | 396.905 us                | 972.319 us                |
| Backward                  | 966.376 us                | 3.533 ms                  |
| Optimize                  | 118.709 us                | 269.067 us                |
| BarrierTimeBeforeRank0    | 738.170 us                | 5.427 ms                  |
| AfterBackward             | 295.493 ms                | 424.360 ms                |
| BlockToStepN              | 34.204 ms                 | 228.216 ms                |
| OneStep                   | 339.414 ms                | 842.413 ms                |
| E2E-100                   | 34.937 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
E20240119 22:44:50.544015 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
W20240119 22:44:50.796195 55690 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
W20240119 22:44:51.419308 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=112, pq.top=112
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
E20240119 22:44:51.544014 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=123610
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240119 22:44:51.834887 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 113 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 189.685 ms                | 247.400 ms                |
| ProcessBack:UpdateCache   | 22.771 ms                 | 34.436 ms                 |
| ProcessBack:UpsertPq      | 78.415 ms                 | 163.962 ms                |
| ProcessOneStep            | 296.687 ms                | 424.296 ms                |
| BlockToStepN              | 33.623 ms                 | 228.078 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
W20240119 22:44:52.438719 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=115, pq.top=115
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
E20240119 22:44:52.544011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=218120
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
W20240119 22:44:52.846745 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
E20240119 22:44:53.544009 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240119 22:44:53.737727 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=119, pq.top=119
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240119 22:44:53.885993 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
E20240119 22:44:54.544153 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=67967
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
W20240119 22:44:54.872875 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=122, pq.top=122
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
W20240119 22:44:54.906509 55690 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.183 us                | 639.053 us                |
| GenInput                  | 1.466 ms                  | 8.991 ms                  |
| Forward                   | 395.392 us                | 972.319 us                |
| Backward                  | 946.322 us                | 3.533 ms                  |
| Optimize                  | 118.709 us                | 269.067 us                |
| BarrierTimeBeforeRank0    | 707.792 us                | 5.499 ms                  |
| AfterBackward             | 295.493 ms                | 424.360 ms                |
| BlockToStepN              | 33.787 ms                 | 228.216 ms                |
| OneStep                   | 340.643 ms                | 842.413 ms                |
| E2E-100                   | 34.937 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
E20240119 22:44:55.544008 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=2475
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
W20240119 22:44:55.872129 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=126, pq.top=126
W20240119 22:44:55.949229 55690 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
E20240119 22:44:56.544011 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=112082
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
W20240119 22:44:56.951601 55690 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240119 22:44:57.067793 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=129, pq.top=129
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 186.386 ms                | 247.400 ms                |
| ProcessBack:UpdateCache   | 22.669 ms                 | 34.436 ms                 |
| ProcessBack:UpsertPq      | 78.103 ms                 | 180.259 ms                |
| ProcessOneStep            | 295.443 ms                | 424.296 ms                |
| BlockToStepN              | 33.623 ms                 | 228.078 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
E20240119 22:44:57.544008 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=14050
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
W20240119 22:44:57.978219 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240119 22:44:58.294581 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=132, pq.top=132
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
E20240119 22:44:58.544013 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=30547
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
W20240119 22:44:58.994082 55690 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
W20240119 22:44:59.299808 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=136, pq.top=136
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
E20240119 22:44:59.544008 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=166362
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
W20240119 22:45:00.013957 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
W20240119 22:45:00.379379 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=141, pq.top=141
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 118.223 us                | 639.053 us                |
| GenInput                  | 1.471 ms                  | 8.991 ms                  |
| Forward                   | 397.664 us                | 972.319 us                |
| Backward                  | 940.367 us                | 3.533 ms                  |
| Optimize                  | 118.989 us                | 269.067 us                |
| BarrierTimeBeforeRank0    | 705.235 us                | 5.499 ms                  |
| AfterBackward             | 288.765 ms                | 424.360 ms                |
| BlockToStepN              | 34.135 ms                 | 228.216 ms                |
| OneStep                   | 338.611 ms                | 842.413 ms                |
| E2E-100                   | 34.937 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
E20240119 22:45:00.544009 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=301129
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240119 22:45:01.347322 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 143 ========== 
========== Step 143 ========== 
E20240119 22:45:01.544014 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=37095
W20240119 22:45:01.666863 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=144, pq.top=143
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 185.620 ms                | 247.400 ms                |
| ProcessBack:UpdateCache   | 22.722 ms                 | 34.436 ms                 |
| ProcessBack:UpsertPq      | 76.844 ms                 | 180.259 ms                |
| ProcessOneStep            | 292.869 ms                | 424.296 ms                |
| BlockToStepN              | 34.345 ms                 | 265.043 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
W20240119 22:45:02.395856 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240119 22:45:02.544008 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=25337
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
W20240119 22:45:02.901684 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=148, pq.top=148
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240119 22:45:03.421723 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
E20240119 22:45:03.544014 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=137356
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240119 22:45:03.971024 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=152, pq.top=152
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240119 22:45:04.427312 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
E20240119 22:45:04.544023 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=265949
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
W20240119 22:45:05.109535 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=157, pq.top=157
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.027 us                | 558.804 us                |
| GenInput                  | 1.466 ms                  | 8.991 ms                  |
| Forward                   | 394.054 us                | 799.061 us                |
| Backward                  | 923.027 us                | 1.948 ms                  |
| Optimize                  | 117.154 us                | 242.271 us                |
| BarrierTimeBeforeRank0    | 705.235 us                | 5.427 ms                  |
| AfterBackward             | 278.900 ms                | 408.386 ms                |
| BlockToStepN              | 34.204 ms                 | 228.216 ms                |
| OneStep                   | 332.777 ms                | 573.853 ms                |
| E2E-100                   | 34.937 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 158 ========== 
========== Step 158 ========== 
W20240119 22:45:05.459035 55690 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
E20240119 22:45:05.544009 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=1301
W20240119 22:45:06.109052 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=159, pq.top=159
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
W20240119 22:45:06.483870 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240119 22:45:06.544013 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=67863
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 181.101 ms                | 246.705 ms                |
| ProcessBack:UpdateCache   | 22.589 ms                 | 34.413 ms                 |
| ProcessBack:UpsertPq      | 76.811 ms                 | 163.962 ms                |
| ProcessOneStep            | 278.789 ms                | 408.321 ms                |
| BlockToStepN              | 34.345 ms                 | 265.043 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 22:45:07.271716 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=162, pq.top=161
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
W20240119 22:45:07.510408 55690 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240119 22:45:07.544009 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=171410
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240119 22:45:08.271013 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=165
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
E20240119 22:45:08.544111 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=32303
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
W20240119 22:45:08.671345 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
W20240119 22:45:09.339857 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=168, pq.top=167
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
E20240119 22:45:09.544009 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=28449
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
W20240119 22:45:09.721910 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 116.100 us                | 639.053 us                |
| GenInput                  | 1.393 ms                  | 8.991 ms                  |
| Forward                   | 389.711 us                | 799.061 us                |
| Backward                  | 919.556 us                | 1.948 ms                  |
| Optimize                  | 114.162 us                | 242.271 us                |
| BarrierTimeBeforeRank0    | 667.112 us                | 5.427 ms                  |
| AfterBackward             | 278.836 ms                | 408.386 ms                |
| BlockToStepN              | 34.698 ms                 | 265.196 ms                |
| OneStep                   | 332.777 ms                | 842.413 ms                |
| E2E-100                   | 34.937 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
W20240119 22:45:10.419550 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=172, pq.top=172
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
E20240119 22:45:10.544011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=66381
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
W20240119 22:45:10.824429 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
W20240119 22:45:11.483947 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=175, pq.top=175
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
E20240119 22:45:11.544009 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=75284
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
W20240119 22:45:11.935295 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 181.173 ms                | 246.705 ms                |
| ProcessBack:UpdateCache   | 22.586 ms                 | 34.413 ms                 |
| ProcessBack:UpsertPq      | 75.653 ms                 | 163.962 ms                |
| ProcessOneStep            | 277.704 ms                | 408.321 ms                |
| BlockToStepN              | 34.761 ms                 | 265.043 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
E20240119 22:45:12.544008 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=112
W20240119 22:45:12.592242 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=178, pq.top=178
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
W20240119 22:45:13.062124 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
E20240119 22:45:13.544009 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=504
W20240119 22:45:13.592166 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=181, pq.top=181
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
W20240119 22:45:14.078142 55690 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
E20240119 22:45:14.544011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=67225
W20240119 22:45:14.628059 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=184, pq.top=184
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
W20240119 22:45:15.109869 55690 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 115.786 us                | 639.053 us                |
| GenInput                  | 1.446 ms                  | 8.991 ms                  |
| Forward                   | 389.711 us                | 799.061 us                |
| Backward                  | 929.631 us                | 1.948 ms                  |
| Optimize                  | 113.489 us                | 242.271 us                |
| BarrierTimeBeforeRank0    | 661.719 us                | 5.427 ms                  |
| AfterBackward             | 277.356 ms                | 408.386 ms                |
| BlockToStepN              | 35.045 ms                 | 265.196 ms                |
| OneStep                   | 332.777 ms                | 842.413 ms                |
| E2E-100                   | 34.937 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
E20240119 22:45:15.544011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=27192
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
W20240119 22:45:15.907265 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=188, pq.top=188
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
W20240119 22:45:16.122990 55690 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
E20240119 22:45:16.544011 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=127499
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 181.101 ms                | 246.705 ms                |
| ProcessBack:UpdateCache   | 22.561 ms                 | 34.413 ms                 |
| ProcessBack:UpsertPq      | 74.264 ms                 | 163.962 ms                |
| ProcessOneStep            | 277.310 ms                | 408.321 ms                |
| BlockToStepN              | 35.239 ms                 | 265.043 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 22:45:17.141327 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=192, pq.top=192
W20240119 22:45:17.166859 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
E20240119 22:45:17.544010 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=84064
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
W20240119 22:45:18.188313 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
W20240119 22:45:18.199633 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=196, pq.top=196
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
E20240119 22:45:18.544026 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
W20240119 22:45:19.215143 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end0
W20240119 22:45:19.342633 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=200, pq.top=200
Step199:rank0, time: 32.315, per_step: 0.319955
Step199:rank2, time: 32.315, per_step: 0.319955
Step199:rank5, time: 32.315, per_step: 0.319953
Step199:rank4, time: 32.315, per_step: 0.319955
Step199:rank1, time: 32.315, per_step: 0.319953
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
Step199:rank3, time: 32.316, per_step: 0.319956
Step199:rank7, time: 32.315, per_step: 0.319953
Step199:rank6, time: 32.315, per_step: 0.319955
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
E20240119 22:45:19.544009 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=229967
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
W20240119 22:45:20.256188 55690 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240119 22:45:20.342283 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=203, pq.top=203
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 115.311 us                | 639.053 us                |
| GenInput                  | 1.458 ms                  | 8.991 ms                  |
| Forward                   | 388.480 us                | 799.061 us                |
| Backward                  | 932.907 us                | 1.948 ms                  |
| Optimize                  | 113.333 us                | 242.271 us                |
| BarrierTimeBeforeRank0    | 671.367 us                | 5.427 ms                  |
| AfterBackward             | 276.359 ms                | 408.386 ms                |
| BlockToStepN              | 35.696 ms                 | 265.196 ms                |
| OneStep                   | 331.263 ms                | 842.413 ms                |
| E2E-100                   | 32.315 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
E20240119 22:45:20.544009 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=341
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
W20240119 22:45:21.393867 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=205, pq.top=205
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
W20240119 22:45:21.431259 55690 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240119 22:45:21.544008 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=83852
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 181.173 ms                | 246.705 ms                |
| ProcessBack:UpdateCache   | 22.522 ms                 | 34.413 ms                 |
| ProcessBack:UpsertPq      | 72.856 ms                 | 180.259 ms                |
| ProcessOneStep            | 276.308 ms                | 424.296 ms                |
| BlockToStepN              | 35.649 ms                 | 322.815 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
W20240119 22:45:22.477414 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=208, pq.top=208
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
W20240119 22:45:22.502990 55690 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240119 22:45:22.544011 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=16852
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
W20240119 22:45:23.522459 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240119 22:45:23.544008 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=132654
W20240119 22:45:23.635727 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=212, pq.top=212
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
E20240119 22:45:24.544016 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=1574
W20240119 22:45:24.635210 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
W20240119 22:45:24.695573 55690 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 114.019 us                | 639.053 us                |
| GenInput                  | 1.470 ms                  | 9.683 ms                  |
| Forward                   | 388.006 us                | 972.319 us                |
| Backward                  | 932.907 us                | 1.948 ms                  |
| Optimize                  | 113.599 us                | 242.271 us                |
| BarrierTimeBeforeRank0    | 671.367 us                | 5.427 ms                  |
| AfterBackward             | 275.767 ms                | 424.360 ms                |
| BlockToStepN              | 36.264 ms                 | 322.961 ms                |
| OneStep                   | 331.263 ms                | 842.413 ms                |
| E2E-100                   | 32.315 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
E20240119 22:45:25.544009 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=30147
W20240119 22:45:25.737202 55690 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240119 22:45:25.760155 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=219, pq.top=219
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
E20240119 22:45:26.544559 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=141164
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
W20240119 22:45:26.835582 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240119 22:45:26.978336 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=223, pq.top=223
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 178.179 ms                | 246.705 ms                |
| ProcessBack:UpdateCache   | 22.505 ms                 | 34.413 ms                 |
| ProcessBack:UpsertPq      | 72.322 ms                 | 180.259 ms                |
| ProcessOneStep            | 275.314 ms                | 424.296 ms                |
| BlockToStepN              | 36.167 ms                 | 322.815 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
E20240119 22:45:27.544011 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=234092
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
W20240119 22:45:27.908661 55690 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
W20240119 22:45:28.153167 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
E20240119 22:45:28.544013 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=335185
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
W20240119 22:45:28.963224 55690 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
W20240119 22:45:29.365564 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=232, pq.top=232
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
E20240119 22:45:29.544013 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=465797
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
W20240119 22:45:29.972119 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 115.388 us                | 639.053 us                |
| GenInput                  | 1.463 ms                  | 9.683 ms                  |
| Forward                   | 388.920 us                | 972.319 us                |
| Backward                  | 925.848 us                | 1.948 ms                  |
| Optimize                  | 114.435 us                | 242.271 us                |
| BarrierTimeBeforeRank0    | 672.850 us                | 5.427 ms                  |
| AfterBackward             | 273.325 ms                | 424.360 ms                |
| BlockToStepN              | 35.942 ms                 | 322.961 ms                |
| OneStep                   | 325.988 ms                | 842.413 ms                |
| E2E-100                   | 32.315 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
W20240119 22:45:30.466974 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=235, pq.top=235
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
E20240119 22:45:30.546079 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=566504
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
W20240119 22:45:30.989882 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
E20240119 22:45:31.546010 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=23
W20240119 22:45:31.615605 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=239, pq.top=239
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
W20240119 22:45:32.015731 55690 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 175.947 ms                | 246.705 ms                |
| ProcessBack:UpdateCache   | 22.522 ms                 | 34.436 ms                 |
| ProcessBack:UpsertPq      | 71.444 ms                 | 180.259 ms                |
| ProcessOneStep            | 272.810 ms                | 424.296 ms                |
| BlockToStepN              | 35.905 ms                 | 322.815 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
E20240119 22:45:32.547336 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=273
W20240119 22:45:32.615018 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=242, pq.top=242
E20240119 22:45:33.547238 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=4533
W20240119 22:45:33.615303 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=242, pq.top=242
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
W20240119 22:45:34.519835 55690 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 242 ========== 
========== Step 242 ========== 
E20240119 22:45:34.547016 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=13376
W20240119 22:45:34.972816 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=243, pq.top=242
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 115.311 us                | 663.313 us                |
| GenInput                  | 1.470 ms                  | 11.116 ms                 |
| Forward                   | 388.920 us                | 1.732 ms                  |
| Backward                  | 925.848 us                | 1.948 ms                  |
| Optimize                  | 114.162 us                | 242.271 us                |
| BarrierTimeBeforeRank0    | 671.367 us                | 5.427 ms                  |
| AfterBackward             | 274.630 ms                | 424.360 ms                |
| BlockToStepN              | 36.264 ms                 | 633.480 ms                |
| OneStep                   | 327.061 ms                | 917.478 ms                |
| E2E-100                   | 32.315 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
W20240119 22:45:35.546000 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240119 22:45:35.547008 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=21905
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
W20240119 22:45:35.972448 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=245, pq.top=245
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
E20240119 22:45:36.547031 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=13371
W20240119 22:45:36.574564 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
W20240119 22:45:37.053097 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=247
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 176.135 ms                | 246.705 ms                |
| ProcessBack:UpdateCache   | 22.561 ms                 | 34.436 ms                 |
| ProcessBack:UpsertPq      | 72.074 ms                 | 180.259 ms                |
| ProcessOneStep            | 274.576 ms                | 424.296 ms                |
| BlockToStepN              | 36.167 ms                 | 633.344 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
E20240119 22:45:37.547009 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=48802
W20240119 22:45:37.598758 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
W20240119 22:45:38.053040 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=251, pq.top=251
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
E20240119 22:45:38.547013 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=57617
W20240119 22:45:38.621261 55690 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
W20240119 22:45:39.053422 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=254, pq.top=254
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
E20240119 22:45:39.547010 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=63
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
W20240119 22:45:39.648308 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 256 ========== 
W20240119 22:45:40.053429 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=257, pq.top=257
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 115.388 us                | 639.053 us                |
| GenInput                  | 1.471 ms                  | 9.683 ms                  |
| Forward                   | 388.480 us                | 972.319 us                |
| Backward                  | 924.300 us                | 1.821 ms                  |
| Optimize                  | 116.037 us                | 210.688 us                |
| BarrierTimeBeforeRank0    | 671.367 us                | 3.726 ms                  |
| AfterBackward             | 274.630 ms                | 408.386 ms                |
| BlockToStepN              | 36.610 ms                 | 408.315 ms                |
| OneStep                   | 327.061 ms                | 860.974 ms                |
| E2E-100                   | 32.315 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
E20240119 22:45:40.547015 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=9242
W20240119 22:45:40.649470 55690 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
W20240119 22:45:41.053154 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=260, pq.top=260
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
E20240119 22:45:41.547013 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=20585
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
W20240119 22:45:41.787873 55690 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 178.722 ms                | 238.348 ms                |
| ProcessBack:UpdateCache   | 22.589 ms                 | 34.413 ms                 |
| ProcessBack:UpsertPq      | 72.322 ms                 | 163.962 ms                |
| ProcessOneStep            | 275.314 ms                | 408.321 ms                |
| BlockToStepN              | 36.608 ms                 | 408.151 ms                |
+---------------------------+---------------------------+---------------------------+
W20240119 22:45:42.096060 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=263
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
E20240119 22:45:42.547011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=62573
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
W20240119 22:45:42.794553 55690 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
W20240119 22:45:43.287104 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=267, pq.top=267
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
E20240119 22:45:43.547008 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=21895
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
W20240119 22:45:43.811713 55690 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
W20240119 22:45:44.450400 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=270, pq.top=270
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
E20240119 22:45:44.547010 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=15275
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
W20240119 22:45:44.811100 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 115.940 us                | 639.053 us                |
| GenInput                  | 1.482 ms                  | 9.683 ms                  |
| Forward                   | 386.890 us                | 972.319 us                |
| Backward                  | 915.416 us                | 1.821 ms                  |
| Optimize                  | 117.582 us                | 210.688 us                |
| BarrierTimeBeforeRank0    | 691.074 us                | 3.726 ms                  |
| AfterBackward             | 275.357 ms                | 408.386 ms                |
| BlockToStepN              | 36.787 ms                 | 408.315 ms                |
| OneStep                   | 329.707 ms                | 860.974 ms                |
| E2E-100                   | 32.315 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
W20240119 22:45:45.450332 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=273, pq.top=273
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
E20240119 22:45:45.547070 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=20637
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
W20240119 22:45:45.821844 55690 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
E20240119 22:45:46.547014 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=68000
W20240119 22:45:46.634982 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=277
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
W20240119 22:45:46.833781 55690 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 178.722 ms                | 238.348 ms                |
| ProcessBack:UpdateCache   | 22.638 ms                 | 34.413 ms                 |
| ProcessBack:UpsertPq      | 72.074 ms                 | 163.962 ms                |
| ProcessOneStep            | 275.314 ms                | 408.321 ms                |
| BlockToStepN              | 36.848 ms                 | 408.151 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
E20240119 22:45:47.554214 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=90
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
W20240119 22:45:47.866442 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=281
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
W20240119 22:45:47.903252 55690 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
E20240119 22:45:48.554008 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=66787
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
W20240119 22:45:48.903970 55690 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240119 22:45:49.037796 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=285
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
E20240119 22:45:49.554013 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=43062
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
W20240119 22:45:49.914660 55690 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
W20240119 22:45:50.281930 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=289
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 115.873 us                | 663.313 us                |
| GenInput                  | 1.471 ms                  | 11.116 ms                 |
| Forward                   | 385.289 us                | 972.319 us                |
| Backward                  | 908.647 us                | 1.821 ms                  |
| Optimize                  | 118.117 us                | 210.688 us                |
| BarrierTimeBeforeRank0    | 672.850 us                | 5.427 ms                  |
| AfterBackward             | 275.357 ms                | 408.386 ms                |
| BlockToStepN              | 36.989 ms                 | 408.315 ms                |
| OneStep                   | 328.592 ms                | 860.974 ms                |
| E2E-100                   | 32.315 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
E20240119 22:45:50.554013 55689 parallel_pq_v2.h:76] insert failed, size(hashtable)=168682
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
W20240119 22:45:50.923434 55690 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
W20240119 22:45:51.476886 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=292, pq.top=292
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
E20240119 22:45:51.554010 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=11004
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
W20240119 22:45:51.949448 55690 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 178.970 ms                | 238.348 ms                |
| ProcessBack:UpdateCache   | 22.638 ms                 | 34.413 ms                 |
| ProcessBack:UpsertPq      | 71.627 ms                 | 163.962 ms                |
| ProcessOneStep            | 275.821 ms                | 408.321 ms                |
| BlockToStepN              | 36.848 ms                 | 408.151 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
W20240119 22:45:52.476079 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=295, pq.top=295
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
E20240119 22:45:52.554011 55690 parallel_pq_v2.h:76] insert failed, size(hashtable)=47616
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
W20240119 22:45:52.970621 55690 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
E20240119 22:45:53.554011 52670 parallel_pq_v2.h:76] insert failed, size(hashtable)=208
W20240119 22:45:53.594465 52670 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=298, pq.top=298
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
W20240119 22:45:53.983443 55690 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
Step299:rank2, time: 34.823, per_step: 0.344784
Step299:rank1, time: 34.823, per_step: 0.344784
Step299:rank7, time: 34.823, per_step: 0.344780
Step299:rank0, time: 34.823, per_step: 0.344784
Step299:rank5, time: 34.823, per_step: 0.344784
Step299:rank4, time: 34.823, per_step: 0.344784
timer name is E2E-100
timer name is E2E-100
Step299:rank3, time: 34.823, per_step: 0.344782
Step299:rank6, time: 34.823, per_step: 0.344780
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is timer name is E2E-100E2E-100

[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker5: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker6: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker7: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker4: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 116.100 us                | 663.313 us                |
| GenInput                  | 1.471 ms                  | 11.116 ms                 |
| Forward                   | 385.015 us                | 1.020 ms                  |
| Backward                  | 913.800 us                | 1.821 ms                  |
| Optimize                  | 118.117 us                | 210.688 us                |
| BarrierTimeBeforeRank0    | 671.367 us                | 5.427 ms                  |
| AfterBackward             | 276.359 ms                | 408.386 ms                |
| BlockToStepN              | 36.949 ms                 | 408.315 ms                |
| OneStep                   | 329.707 ms                | 860.974 ms                |
| E2E-100                   | 34.823 s                  | 34.937 s                  |
+---------------------------+---------------------------+---------------------------+
ERROR [52670 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 181.101 ms                | 238.348 ms                |
| ProcessBack:UpdateCache   | 22.663 ms                 | 34.413 ms                 |
| ProcessBack:UpsertPq      | 72.074 ms                 | 163.962 ms                |
| ProcessOneStep            | 276.308 ms                | 408.321 ms                |
| BlockToStepN              | 36.848 ms                 | 408.151 ms                |
+---------------------------+---------------------------+---------------------------+
