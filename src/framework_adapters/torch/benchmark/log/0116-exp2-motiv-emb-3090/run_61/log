WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240116 11:58:03.697728 58285 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240116 11:58:03.704178 58285 IPCTensor.h:367] NewIPCTensor: full_emb [100000000, 32]0x100000002000
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:165: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [58285 perf_emb.py:165] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f14e4bf18a0>==========
Worker 1 pid=58462
Worker 2 pid=58463
INFO [58285 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [58463 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [58462 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [58464 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [58463 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [58285 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [58464 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [58462 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 11:58:05.708699 58285 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 11:58:05.708882 58463 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 11:58:05.709064 58462 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 11:58:05.709066 58464 IPCTensor.h:346] IPCTensor full_emb already exists
W20240116 11:58:05.738586 58285 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [10000000, 32]; dev=0; size=1.192 GB
W20240116 11:58:05.738638 58464 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [10000000, 32]; dev=3; size=1.192 GB
W20240116 11:58:05.738642 58463 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [10000000, 32]; dev=2; size=1.192 GB
W20240116 11:58:05.740101 58462 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [10000000, 32]; dev=1; size=1.192 GB
W20240116 11:58:06.350881 58463 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1002faf0e000
W20240116 11:58:06.351083 58463 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x1002fafd3000
W20240116 11:58:06.351151 58463 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 32]0x1002fb098000
W20240116 11:58:06.351210 58463 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 32]0x1002fbccf000
W20240116 11:58:06.351259 58463 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 11:58:06.352248 58463 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 11:58:06.359720 58464 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x1002fc90c000
W20240116 11:58:06.359953 58464 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1002fc9d1000
W20240116 11:58:06.360047 58464 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 32]0x1002fca96000
W20240116 11:58:06.360128 58464 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 32]0x1002fd6cd000
W20240116 11:58:06.360201 58464 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240116 11:58:06.362161 58464 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240116 11:58:06.367249 58462 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1002fe30a000
W20240116 11:58:06.367389 58462 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x1002fe3cf000
W20240116 11:58:06.367449 58462 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 32]0x1002fe494000
W20240116 11:58:06.367508 58462 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 32]0x1002ff0cb000
W20240116 11:58:06.367568 58462 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 11:58:06.369021 58462 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 11:58:06.371131 58285 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1002ffd06000
W20240116 11:58:06.371250 58285 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1002ffdcb000
W20240116 11:58:06.371325 58285 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 32]0x1002ffe90000
W20240116 11:58:06.371376 58285 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 32]0x100300ac7000
W20240116 11:58:06.371433 58285 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 11:58:06.372424 58285 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 32]; dev=0; size=12.21 MB
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
Worker 3 pid=58464
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 10000000), (10000000, 20000000), (20000000, 30000000), (30000000, 40000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
W20240116 11:58:09.180286 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x100301704000
W20240116 11:58:09.180331 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x1003017c9000
W20240116 11:58:09.180413 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x10030188e000
W20240116 11:58:09.180475 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100301953000
W20240116 11:58:09.180481 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x100301a18000
W20240116 11:58:09.180542 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x100301add000
W20240116 11:58:09.180557 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100301ba2000
W20240116 11:58:09.180573 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x100301c67000
W20240116 11:58:09.180600 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x100301df1000
W20240116 11:58:09.180609 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x100301eb6000
W20240116 11:58:09.180620 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100301d2c000
W20240116 11:58:09.180657 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x100301f7b000
W20240116 11:58:09.180662 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100302040000
W20240116 11:58:09.180671 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x100302105000
W20240116 11:58:09.180718 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x1003021ca000
W20240116 11:58:09.180724 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x10030228f000
W20240116 11:58:09.180729 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100302354000
W20240116 11:58:09.180774 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100302419000
W20240116 11:58:09.180779 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x1003024de000
W20240116 11:58:09.180800 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x1003025a3000
W20240116 11:58:09.180868 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x100302668000
W20240116 11:58:09.180879 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x10030272d000
W20240116 11:58:09.180889 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1003027f2000
W20240116 11:58:09.180895 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x1003028b7000
W20240116 11:58:09.180933 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x10030297c000
W20240116 11:58:09.180938 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100302a41000
W20240116 11:58:09.180955 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100302b06000
W20240116 11:58:09.180958 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x100302bcb000
W20240116 11:58:09.180996 58463 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x100302c90000
W20240116 11:58:09.181020 58462 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100302d55000
W20240116 11:58:09.181037 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100302e1a000
W20240116 11:58:09.181056 58463 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x100302edf000
W20240116 11:58:09.181061 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100302ee1000
W20240116 11:58:09.181082 58462 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100302fa6000
W20240116 11:58:09.181093 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100302fa8000
W20240116 11:58:09.181113 58463 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x10030306d000
W20240116 11:58:09.181118 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x10030306f000
W20240116 11:58:09.181128 58462 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100303134000
W20240116 11:58:09.181156 58463 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100303136000
W20240116 11:58:09.181159 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x100303138000
W20240116 11:58:09.181165 58462 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1003031fd000
W20240116 11:58:09.181190 58464 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x1003031ff000
W20240116 11:58:09.181231 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x1003032c4000
W20240116 11:58:09.181242 58464 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x100303389000
W20240116 11:58:09.181288 58464 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x10030338b000
W20240116 11:58:09.181298 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x10030338d000
W20240116 11:58:09.181329 58464 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100303452000
W20240116 11:58:09.181351 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x100303454000
W20240116 11:58:09.181407 58285 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x100303519000
W20240116 11:58:09.181473 58285 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x1003035de000
Construct PerfSampler done
Construct PerfSampler done
W20240116 11:58:09.181519 58285 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1003035e0000
I20240116 11:58:09.181547 58463 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240116 11:58:09.181564 58285 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1003035e2000
I20240116 11:58:09.181565 58462 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
Construct PerfSampler done
I20240116 11:58:09.181777 58464 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
Construct PerfSampler done
I20240116 11:58:09.181996 58285 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240116 11:58:09.183046 58285 grad_base.h:54] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240116 11:58:09.183310 58285 grad_base.h:169] Init GradProcessingBase done
I20240116 11:58:26.369617 58285 grad_async_v2.h:32] Use background thread to update emb.
W20240116 11:58:26.370008 58285 kg_controller.h:78] after init GradAsyncProcessingV2
I20240116 11:58:26.370020 58285 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240116 11:58:26.880012 58285 grad_base.h:59] GraphEnv RegTensorsPerProcess
W20240116 11:58:30.432060 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 11:58:30.432523 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240116 11:58:31.432024 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=6157
W20240116 11:58:31.482522 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
E20240116 11:58:32.432020 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=5514
W20240116 11:58:32.489943 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
Before Training
I20240116 11:58:32.742332 58463 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
Before Training
I20240116 11:58:32.811342 58464 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 11:58:32.886693 58285 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 11:58:32.941465 58462 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 40.953 ms                 | 40.953 ms                 |
| Backward                  | 33.435 ms                 | 33.435 ms                 |
| Optimize                  | 927.242 us                | 927.242 us                |
| BarrierTimeBeforeRank0    | 702.629 us                | 702.629 us                |
+---------------------------+---------------------------+---------------------------+
E20240116 11:58:34.262897 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240116 11:58:34.378964 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=1, pq.top=0
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240116 11:58:34.403036 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
E20240116 11:58:35.262014 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=18
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
W20240116 11:58:35.412848 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
W20240116 11:58:35.819049 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=4, pq.top=4
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
E20240116 11:58:36.262012 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=344
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
W20240116 11:58:36.417946 59379 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 114.642 ms                | 243.075 ms                |
| ProcessBack:UpdateCache   | 5.926 ms                  | 748.967 ms                |
| ProcessBack:UpsertPq      | 97.009 ms                 | 115.920 ms                |
| ProcessOneStep            | 219.333 ms                | 1.112 s                   |
| BlockToStepN              | 16.324 ms                 | 19.466 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 11:58:36.994096 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=7, pq.top=7
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
E20240116 11:58:37.262027 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=24986
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
W20240116 11:58:37.433071 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
W20240116 11:58:38.035794 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=10, pq.top=9
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
E20240116 11:58:38.262009 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=58037
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
W20240116 11:58:38.466439 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
W20240116 11:58:39.092963 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=13, pq.top=13
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 491.450 us                | 40.953 ms                 |
| Backward                  | 845.258 us                | 33.435 ms                 |
| Optimize                  | 114.895 us                | 927.242 us                |
| BarrierTimeBeforeRank0    | 874.872 us                | 2.576 ms                  |
| AfterBackward             | 120.173 ms                | 1.112 s                   |
| BlockToStepN              | 17.790 ms                 | 19.532 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:58:39.262022 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=87666
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240116 11:58:39.474700 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
W20240116 11:58:40.127357 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=16, pq.top=16
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240116 11:58:40.262004 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=120695
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
W20240116 11:58:40.480253 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
E20240116 11:58:41.262037 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=700
W20240116 11:58:41.272408 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=19, pq.top=19
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
W20240116 11:58:41.640822 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.978 ms                  | 243.075 ms                |
| ProcessBack:UpdateCache   | 5.946 ms                  | 748.967 ms                |
| ProcessBack:UpsertPq      | 97.009 ms                 | 125.841 ms                |
| ProcessOneStep            | 117.150 ms                | 1.112 s                   |
| BlockToStepN              | 16.866 ms                 | 19.466 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240116 11:58:42.262018 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=176418
W20240116 11:58:42.399066 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=22, pq.top=22
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
W20240116 11:58:42.765357 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
E20240116 11:58:43.262012 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=204828
W20240116 11:58:43.532065 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=25, pq.top=25
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
W20240116 11:58:43.895891 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 480.837 us                | 40.953 ms                 |
| Backward                  | 815.349 us                | 33.435 ms                 |
| Optimize                  | 113.454 us                | 927.242 us                |
| BarrierTimeBeforeRank0    | 874.872 us                | 3.566 ms                  |
| AfterBackward             | 117.198 ms                | 1.112 s                   |
| BlockToStepN              | 16.824 ms                 | 19.532 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
E20240116 11:58:44.262020 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=232292
W20240116 11:58:44.589993 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=28, pq.top=28
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240116 11:58:44.944041 59379 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
E20240116 11:58:45.262015 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=261317
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
W20240116 11:58:45.663647 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=31, pq.top=31
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
W20240116 11:58:46.098713 59379 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 11:58:46.262017 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=959
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
W20240116 11:58:46.797343 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=34, pq.top=34
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.930 ms                  | 243.075 ms                |
| ProcessBack:UpdateCache   | 6.001 ms                  | 748.967 ms                |
| ProcessBack:UpsertPq      | 99.831 ms                 | 155.473 ms                |
| ProcessOneStep            | 113.485 ms                | 1.112 s                   |
| BlockToStepN              | 16.763 ms                 | 19.466 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
W20240116 11:58:47.152164 59379 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 11:58:47.262039 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=315149
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240116 11:58:47.839538 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=37, pq.top=37
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
W20240116 11:58:48.194554 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
E20240116 11:58:48.262006 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=342967
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
W20240116 11:58:48.843236 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=40, pq.top=40
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 476.528 us                | 40.953 ms                 |
| Backward                  | 809.020 us                | 33.435 ms                 |
| Optimize                  | 112.231 us                | 927.242 us                |
| BarrierTimeBeforeRank0    | 873.041 us                | 3.566 ms                  |
| AfterBackward             | 112.673 ms                | 1.112 s                   |
| BlockToStepN              | 16.516 ms                 | 19.532 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
W20240116 11:58:49.201416 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
E20240116 11:58:49.262013 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=372431
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
W20240116 11:58:49.843307 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=43, pq.top=43
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
W20240116 11:58:50.248615 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
E20240116 11:58:50.262006 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=523
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
W20240116 11:58:50.871734 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=46, pq.top=46
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
E20240116 11:58:51.262010 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=427102
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
W20240116 11:58:51.281641 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.747 ms                  | 243.075 ms                |
| ProcessBack:UpdateCache   | 6.009 ms                  | 748.967 ms                |
| ProcessBack:UpsertPq      | 98.528 ms                 | 155.473 ms                |
| ProcessOneStep            | 110.418 ms                | 1.112 s                   |
| BlockToStepN              | 16.242 ms                 | 19.466 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 11:58:51.992854 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=49, pq.top=49
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
E20240116 11:58:52.262012 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=456520
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
W20240116 11:58:52.428481 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
W20240116 11:58:53.114658 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=52, pq.top=52
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
E20240116 11:58:53.262007 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1059
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240116 11:58:53.481006 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
W20240116 11:58:54.150483 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=55, pq.top=55
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 477.970 us                | 923.248 us                |
| Backward                  | 809.020 us                | 1.553 ms                  |
| Optimize                  | 113.454 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 797.408 us                | 2.938 ms                  |
| AfterBackward             | 111.289 ms                | 231.488 ms                |
| BlockToStepN              | 16.248 ms                 | 19.004 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:58:54.262012 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=508305
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
W20240116 11:58:54.514911 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
W20240116 11:58:55.221544 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=58, pq.top=58
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
E20240116 11:58:55.262012 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=534075
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
W20240116 11:58:55.644371 59379 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240116 11:58:56.262019 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=556931
W20240116 11:58:56.499023 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=61, pq.top=61
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240116 11:58:56.703539 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.726 ms                  | 128.569 ms                |
| ProcessBack:UpdateCache   | 6.011 ms                  | 7.230 ms                  |
| ProcessBack:UpsertPq      | 99.915 ms                 | 143.100 ms                |
| ProcessOneStep            | 112.505 ms                | 231.444 ms                |
| BlockToStepN              | 16.112 ms                 | 18.910 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
E20240116 11:58:57.262019 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=580849
W20240116 11:58:57.577279 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=64, pq.top=64
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240116 11:58:57.710316 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
E20240116 11:58:58.262012 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=607867
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
W20240116 11:58:58.595196 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=67, pq.top=67
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
W20240116 11:58:58.716790 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 475.046 us                | 923.248 us                |
| Backward                  | 807.721 us                | 1.553 ms                  |
| Optimize                  | 112.231 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 779.974 us                | 2.938 ms                  |
| AfterBackward             | 110.562 ms                | 231.488 ms                |
| BlockToStepN              | 16.161 ms                 | 19.004 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
E20240116 11:58:59.262005 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=636119
W20240116 11:58:59.595410 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=70, pq.top=70
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
W20240116 11:58:59.726891 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
E20240116 11:59:00.262010 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=660105
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
W20240116 11:59:00.611264 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=73, pq.top=73
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
W20240116 11:59:00.745165 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
E20240116 11:59:01.262089 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=29
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
W20240116 11:59:01.611366 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=76, pq.top=76
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
W20240116 11:59:01.774593 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.710 ms                  | 128.569 ms                |
| ProcessBack:UpdateCache   | 6.009 ms                  | 7.230 ms                  |
| ProcessBack:UpsertPq      | 98.528 ms                 | 143.100 ms                |
| ProcessOneStep            | 109.527 ms                | 231.444 ms                |
| BlockToStepN              | 15.995 ms                 | 18.910 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
E20240116 11:59:02.262127 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=2706
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
W20240116 11:59:02.677582 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=79, pq.top=79
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240116 11:59:02.812139 59379 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
E20240116 11:59:03.262017 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=737262
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
W20240116 11:59:04.126073 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=82, pq.top=82
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
W20240116 11:59:04.151739 59379 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 463.412 us                | 923.248 us                |
| Backward                  | 809.207 us                | 4.687 ms                  |
| Optimize                  | 111.864 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 736.863 us                | 2.938 ms                  |
| AfterBackward             | 109.942 ms                | 252.460 ms                |
| BlockToStepN              | 16.161 ms                 | 19.886 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:59:04.262018 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=755276
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
W20240116 11:59:05.210450 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=85, pq.top=85
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
W20240116 11:59:05.232681 59379 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 11:59:05.263628 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=262
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
E20240116 11:59:06.263017 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=806257
W20240116 11:59:06.320587 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=88, pq.top=88
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
W20240116 11:59:06.342274 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.712 ms                  | 128.569 ms                |
| ProcessBack:UpdateCache   | 6.022 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 98.974 ms                 | 146.457 ms                |
| ProcessOneStep            | 110.418 ms                | 252.368 ms                |
| BlockToStepN              | 16.112 ms                 | 20.051 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
E20240116 11:59:07.263010 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=830840
W20240116 11:59:07.351953 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
W20240116 11:59:07.673235 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=91, pq.top=91
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
E20240116 11:59:08.263032 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1240
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
W20240116 11:59:08.584517 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
W20240116 11:59:09.022809 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=94, pq.top=94
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 457.766 us                | 923.248 us                |
| Backward                  | 838.792 us                | 4.687 ms                  |
| Optimize                  | 111.864 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 720.587 us                | 2.946 ms                  |
| AfterBackward             | 111.289 ms                | 252.460 ms                |
| BlockToStepN              | 16.290 ms                 | 20.358 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:59:09.263870 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=883196
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
W20240116 11:59:09.603230 59379 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
E20240116 11:59:10.279937 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240116 11:59:10.364099 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=97, pq.top=97
E20240116 11:59:11.305596 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=388
W20240116 11:59:11.364427 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.747 ms                  | 128.569 ms                |
| ProcessBack:UpdateCache   | 6.011 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 98.861 ms                 | 146.457 ms                |
| ProcessOneStep            | 112.505 ms                | 252.368 ms                |
| BlockToStepN              | 16.242 ms                 | 20.274 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:59:12.311930 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=732
W20240116 11:59:12.364012 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=97, pq.top=97
E20240116 11:59:13.315399 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1066
W20240116 11:59:13.364728 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 457.766 us                | 923.248 us                |
| Backward                  | 844.644 us                | 4.687 ms                  |
| Optimize                  | 111.864 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 730.428 us                | 2.946 ms                  |
| AfterBackward             | 112.547 ms                | 252.460 ms                |
| BlockToStepN              | 16.336 ms                 | 20.358 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:59:14.321568 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1412
W20240116 11:59:14.365046 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=97, pq.top=97
E20240116 11:59:15.324201 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1788
W20240116 11:59:15.365667 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=97, pq.top=97
E20240116 11:59:16.330960 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=2107
W20240116 11:59:16.365577 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=97, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.747 ms                  | 128.569 ms                |
| ProcessBack:UpdateCache   | 6.011 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 98.861 ms                 | 146.457 ms                |
| ProcessOneStep            | 112.505 ms                | 252.368 ms                |
| BlockToStepN              | 16.242 ms                 | 20.274 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240116 11:59:17.337648 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=2446
W20240116 11:59:17.365918 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=97, pq.top=97
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
W20240116 11:59:17.773361 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
W20240116 11:59:18.366003 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=98, pq.top=97
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 457.766 us                | 923.248 us                |
| Backward                  | 844.644 us                | 4.687 ms                  |
| Optimize                  | 111.864 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 720.587 us                | 2.946 ms                  |
| AfterBackward             | 112.547 ms                | 252.460 ms                |
| BlockToStepN              | 16.379 ms                 | 25.291 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 11:59:19.365983 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=98, pq.top=97
E20240116 11:59:19.570861 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=43
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
W20240116 11:59:19.608050 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
W20240116 11:59:20.519578 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=100, pq.top=99
E20240116 11:59:20.570101 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=277
Step99:rank3, time: 71.407, per_step: 0.714066
Step99:rank1, time: 71.407, per_step: 0.714067
Step99:rank2, time: 71.407, per_step: 0.714066
Step99:rank0, time: 71.407, per_step: 0.714066
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
W20240116 11:59:20.643785 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240116 11:59:21.570013 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=28518
W20240116 11:59:21.792001 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=103, pq.top=103
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
W20240116 11:59:21.830958 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.877 ms                  | 128.569 ms                |
| ProcessBack:UpdateCache   | 6.026 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 98.528 ms                 | 146.457 ms                |
| ProcessOneStep            | 112.631 ms                | 252.368 ms                |
| BlockToStepN              | 16.405 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
E20240116 11:59:22.615738 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
W20240116 11:59:22.847317 59379 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
W20240116 11:59:23.234491 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=106, pq.top=106
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
E20240116 11:59:23.615027 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=80
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
W20240116 11:59:23.856037 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 474.186 us                | 1.083 ms                  |
| Backward                  | 872.188 us                | 4.687 ms                  |
| Optimize                  | 113.454 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 683.087 us                | 2.946 ms                  |
| AfterBackward             | 113.142 ms                | 253.861 ms                |
| BlockToStepN              | 16.537 ms                 | 1.417 s                   |
| E2E-100                   | 47.700 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 11:59:24.446530 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=109, pq.top=109
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
E20240116 11:59:24.615013 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=17811
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
W20240116 11:59:24.889446 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
W20240116 11:59:25.482520 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=112, pq.top=112
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
E20240116 11:59:25.615005 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=46189
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240116 11:59:25.916327 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
W20240116 11:59:26.483121 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=115, pq.top=115
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
E20240116 11:59:26.615023 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=72531
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.930 ms                  | 128.569 ms                |
| ProcessBack:UpdateCache   | 6.022 ms                  | 10.506 ms                 |
| ProcessBack:UpsertPq      | 97.478 ms                 | 146.457 ms                |
| ProcessOneStep            | 112.631 ms                | 253.795 ms                |
| BlockToStepN              | 16.763 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
W20240116 11:59:26.924396 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
E20240116 11:59:27.615008 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=788
W20240116 11:59:27.619657 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=118, pq.top=118
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240116 11:59:27.972766 59379 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
E20240116 11:59:28.615010 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=95
W20240116 11:59:28.676688 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=121, pq.top=121
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
W20240116 11:59:29.175089 59379 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 457.180 us                | 1.083 ms                  |
| Backward                  | 903.199 us                | 4.687 ms                  |
| Optimize                  | 113.234 us                | 310.006 us                |
| BarrierTimeBeforeRank0    | 659.148 us                | 2.946 ms                  |
| AfterBackward             | 112.673 ms                | 253.861 ms                |
| BlockToStepN              | 17.026 ms                 | 1.417 s                   |
| E2E-100                   | 47.700 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
E20240116 11:59:29.615010 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=739
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
W20240116 11:59:30.058888 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=124, pq.top=124
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240116 11:59:30.196733 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240116 11:59:30.615037 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=177980
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
W20240116 11:59:31.277328 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=127, pq.top=127
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240116 11:59:31.301437 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 11:59:31.615010 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=200128
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.978 ms                  | 128.569 ms                |
| ProcessBack:UpdateCache   | 6.026 ms                  | 10.506 ms                 |
| ProcessBack:UpsertPq      | 97.305 ms                 | 146.457 ms                |
| ProcessOneStep            | 112.821 ms                | 253.795 ms                |
| BlockToStepN              | 17.027 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
W20240116 11:59:32.375617 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=130, pq.top=130
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
W20240116 11:59:32.401453 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 11:59:32.615020 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=228515
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
W20240116 11:59:33.427805 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=133, pq.top=133
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240116 11:59:33.455679 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 11:59:33.615005 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=249695
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 461.526 us                | 1.083 ms                  |
| Backward                  | 1.110 ms                  | 4.687 ms                  |
| Optimize                  | 114.694 us                | 310.006 us                |
| BarrierTimeBeforeRank0    | 651.885 us                | 2.946 ms                  |
| AfterBackward             | 113.522 ms                | 253.861 ms                |
| BlockToStepN              | 17.188 ms                 | 1.417 s                   |
| E2E-100                   | 47.700 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
W20240116 11:59:34.530478 59379 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 11:59:34.615046 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=275766
W20240116 11:59:34.741348 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=136, pq.top=136
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240116 11:59:35.571410 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
E20240116 11:59:35.615017 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=293209
W20240116 11:59:35.843621 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=139, pq.top=139
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
W20240116 11:59:36.572898 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
E20240116 11:59:36.615024 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=819
W20240116 11:59:36.844282 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=142, pq.top=142
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.087 ms                  | 128.569 ms                |
| ProcessBack:UpdateCache   | 6.030 ms                  | 10.506 ms                 |
| ProcessBack:UpsertPq      | 97.009 ms                 | 146.457 ms                |
| ProcessOneStep            | 113.098 ms                | 253.795 ms                |
| BlockToStepN              | 17.513 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240116 11:59:37.615007 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=343061
W20240116 11:59:37.615897 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
W20240116 11:59:38.172230 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=146, pq.top=146
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
E20240116 11:59:38.615012 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=370293
W20240116 11:59:38.616191 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
W20240116 11:59:39.173344 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=149, pq.top=149
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 456.595 us                | 1.083 ms                  |
| Backward                  | 1.141 ms                  | 4.687 ms                  |
| Optimize                  | 114.895 us                | 310.006 us                |
| BarrierTimeBeforeRank0    | 631.985 us                | 2.946 ms                  |
| AfterBackward             | 112.855 ms                | 253.861 ms                |
| BlockToStepN              | 17.624 ms                 | 1.417 s                   |
| E2E-100                   | 47.700 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
E20240116 11:59:39.615024 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=396590
W20240116 11:59:39.645689 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
W20240116 11:59:40.173218 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=152, pq.top=152
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
E20240116 11:59:40.616544 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=422534
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240116 11:59:40.686982 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
W20240116 11:59:41.485756 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=155, pq.top=155
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
E20240116 11:59:41.616003 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=450149
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.087 ms                  | 117.743 ms                |
| ProcessBack:UpdateCache   | 6.026 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 96.379 ms                 | 144.159 ms                |
| ProcessOneStep            | 113.098 ms                | 252.368 ms                |
| BlockToStepN              | 17.588 ms                 | 85.129 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
W20240116 11:59:41.944654 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
E20240116 11:59:42.616194 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=477295
W20240116 11:59:42.786537 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=158, pq.top=158
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
W20240116 11:59:42.956440 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
E20240116 11:59:43.616010 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=33
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240116 11:59:44.073182 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=161, pq.top=161
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 457.180 us                | 923.248 us                |
| Backward                  | 1.273 ms                  | 1.934 ms                  |
| Optimize                  | 114.369 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 627.361 us                | 2.938 ms                  |
| AfterBackward             | 114.058 ms                | 252.460 ms                |
| BlockToStepN              | 17.810 ms                 | 85.206 ms                 |
| E2E-100                   | 47.700 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
E20240116 11:59:44.620467 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=435
W20240116 11:59:45.074432 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240116 11:59:45.622232 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1119
W20240116 11:59:46.074342 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240116 11:59:46.623080 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1727
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.685 ms                  | 119.430 ms                |
| ProcessBack:UpdateCache   | 6.030 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 96.010 ms                 | 144.159 ms                |
| ProcessOneStep            | 114.020 ms                | 252.368 ms                |
| BlockToStepN              | 17.728 ms                 | 85.129 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 11:59:47.075356 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=161, pq.top=161
E20240116 11:59:47.630105 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=2284
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240116 11:59:47.683981 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
E20240116 11:59:48.668926 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240116 11:59:48.754091 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=162, pq.top=161
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
W20240116 11:59:48.799410 59379 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 457.766 us                | 923.248 us                |
| Backward                  | 1.285 ms                  | 1.934 ms                  |
| Optimize                  | 114.369 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 630.268 us                | 2.938 ms                  |
| AfterBackward             | 114.058 ms                | 253.861 ms                |
| BlockToStepN              | 17.829 ms                 | 1.417 s                   |
| E2E-100                   | 47.700 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
E20240116 11:59:49.668022 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=36467
W20240116 11:59:49.814049 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=165, pq.top=164
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
W20240116 11:59:49.865135 59379 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
E20240116 11:59:50.668025 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=61211
W20240116 11:59:50.880057 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=168, pq.top=167
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240116 11:59:50.916031 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
E20240116 11:59:51.668020 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=83267
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.251 ms                  | 119.430 ms                |
| ProcessBack:UpdateCache   | 6.035 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 96.010 ms                 | 146.457 ms                |
| ProcessOneStep            | 113.485 ms                | 253.795 ms                |
| BlockToStepN              | 17.906 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
W20240116 11:59:51.994387 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=171, pq.top=170
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
W20240116 11:59:52.055819 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
E20240116 11:59:52.668011 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=110806
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
W20240116 11:59:53.153506 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=174, pq.top=173
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
W20240116 11:59:53.207254 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
E20240116 11:59:53.668030 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=132917
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 461.526 us                | 923.248 us                |
| Backward                  | 1.324 ms                  | 1.934 ms                  |
| Optimize                  | 114.895 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 591.349 us                | 2.938 ms                  |
| AfterBackward             | 113.703 ms                | 253.861 ms                |
| BlockToStepN              | 18.215 ms                 | 1.417 s                   |
| E2E-100                   | 47.700 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 11:59:54.412977 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=177, pq.top=176
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
W20240116 11:59:54.447669 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 11:59:54.668313 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=156910
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
W20240116 11:59:55.588868 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=180, pq.top=179
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
W20240116 11:59:55.652004 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 11:59:55.668038 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=177455
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
E20240116 11:59:56.668097 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=625
W20240116 11:59:56.685158 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=183, pq.top=183
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
W20240116 11:59:56.709206 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 5.157 ms                  | 119.430 ms                |
| ProcessBack:UpdateCache   | 6.060 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 96.611 ms                 | 146.457 ms                |
| ProcessOneStep            | 114.020 ms                | 253.795 ms                |
| BlockToStepN              | 18.195 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
E20240116 11:59:57.668016 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=231997
W20240116 11:59:57.742583 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=186, pq.top=186
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
W20240116 11:59:57.766487 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
E20240116 11:59:58.668020 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=254009
W20240116 11:59:58.826741 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=189, pq.top=189
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240116 11:59:58.850888 59379 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 458.672 us                | 923.248 us                |
| Backward                  | 1.342 ms                  | 1.934 ms                  |
| Optimize                  | 115.210 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 558.658 us                | 2.938 ms                  |
| AfterBackward             | 113.393 ms                | 253.861 ms                |
| BlockToStepN              | 18.413 ms                 | 1.417 s                   |
| E2E-100                   | 47.700 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
E20240116 11:59:59.668018 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=275315
W20240116 11:59:59.858626 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
W20240116 12:00:00.057972 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=192, pq.top=192
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
E20240116 12:00:00.668023 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=300927
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
W20240116 12:00:00.859051 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
W20240116 12:00:01.130455 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=195, pq.top=195
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
E20240116 12:00:01.668026 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1533
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.738 ms                  | 119.430 ms                |
| ProcessBack:UpdateCache   | 6.067 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 96.733 ms                 | 146.457 ms                |
| ProcessOneStep            | 113.098 ms                | 253.795 ms                |
| BlockToStepN              | 18.406 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
W20240116 12:00:01.892446 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
W20240116 12:00:02.144831 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=198, pq.top=198
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
E20240116 12:00:02.668020 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=353648
Step199:rank3, time: 42.240, per_step: 0.418214
Step199:rank1, time: 42.239, per_step: 0.418212
Step199:rank2, time: 42.239, per_step: 0.418212
Step199:rank0, time: 42.239, per_step: 0.418212
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
W20240116 12:00:02.932786 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
W20240116 12:00:03.146291 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=201, pq.top=201
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
E20240116 12:00:03.668021 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=380341
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
W20240116 12:00:03.941300 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
W20240116 12:00:04.147089 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=204, pq.top=204
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 458.672 us                | 923.248 us                |
| Backward                  | 1.356 ms                  | 1.934 ms                  |
| Optimize                  | 114.895 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 501.843 us                | 2.938 ms                  |
| AfterBackward             | 112.547 ms                | 253.861 ms                |
| BlockToStepN              | 18.425 ms                 | 1.417 s                   |
| E2E-100                   | 42.239 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
E20240116 12:00:04.668011 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=407532
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
W20240116 12:00:04.971238 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
W20240116 12:00:05.457227 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=208, pq.top=208
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
E20240116 12:00:05.668023 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=434699
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
W20240116 12:00:06.142625 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
W20240116 12:00:06.457980 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=211, pq.top=211
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
E20240116 12:00:06.668010 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=2129
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.549 ms                  | 119.430 ms                |
| ProcessBack:UpdateCache   | 6.060 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 96.267 ms                 | 146.457 ms                |
| ProcessOneStep            | 111.268 ms                | 253.795 ms                |
| BlockToStepN              | 18.195 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
W20240116 12:00:07.186786 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
W20240116 12:00:07.459497 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=214, pq.top=214
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
E20240116 12:00:07.668005 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1965
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
W20240116 12:00:08.213886 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
W20240116 12:00:08.492147 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=217, pq.top=217
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
E20240116 12:00:08.668015 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1609
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 457.766 us                | 923.248 us                |
| Backward                  | 1.356 ms                  | 1.934 ms                  |
| Optimize                  | 114.857 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 472.502 us                | 2.938 ms                  |
| AfterBackward             | 111.289 ms                | 253.861 ms                |
| BlockToStepN              | 18.264 ms                 | 1.417 s                   |
| E2E-100                   | 42.239 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:00:09.256386 59379 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
W20240116 12:00:09.576386 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=220, pq.top=220
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
E20240116 12:00:09.668057 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=702
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
W20240116 12:00:10.460018 59379 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 12:00:10.673146 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=556168
W20240116 12:00:10.882668 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=223, pq.top=223
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
W20240116 12:00:11.475289 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
E20240116 12:00:11.673019 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=577897
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.477 ms                  | 119.430 ms                |
| ProcessBack:UpdateCache   | 6.067 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 96.010 ms                 | 146.457 ms                |
| ProcessOneStep            | 111.259 ms                | 253.795 ms                |
| BlockToStepN              | 18.320 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
W20240116 12:00:11.992296 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=226, pq.top=226
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
W20240116 12:00:12.516053 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 12:00:12.673264 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=875
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
W20240116 12:00:13.021700 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=229, pq.top=229
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
W20240116 12:00:13.549952 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:00:13.673014 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=440
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
W20240116 12:00:14.068914 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=232, pq.top=232
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 458.155 us                | 923.248 us                |
| Backward                  | 1.352 ms                  | 1.934 ms                  |
| Optimize                  | 114.857 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 476.354 us                | 2.938 ms                  |
| AfterBackward             | 110.733 ms                | 253.861 ms                |
| BlockToStepN              | 18.259 ms                 | 1.417 s                   |
| E2E-100                   | 42.239 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
W20240116 12:00:14.559059 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 12:00:14.673213 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=653223
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
W20240116 12:00:15.155984 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=235, pq.top=235
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
W20240116 12:00:15.605285 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 12:00:15.673004 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=676273
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
W20240116 12:00:16.280031 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=238, pq.top=238
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
W20240116 12:00:16.666332 59379 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
E20240116 12:00:16.673023 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=698798
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 4.213 ms                  | 119.430 ms                |
| ProcessBack:UpdateCache   | 6.060 ms                  | 7.875 ms                  |
| ProcessBack:UpsertPq      | 96.267 ms                 | 146.457 ms                |
| ProcessOneStep            | 111.248 ms                | 253.795 ms                |
| BlockToStepN              | 18.157 ms                 | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
W20240116 12:00:17.353724 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=241, pq.top=241
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
E20240116 12:00:17.673034 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=723749
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
W20240116 12:00:17.727433 59379 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
W20240116 12:00:18.405670 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=244, pq.top=244
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
E20240116 12:00:18.673013 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=748491
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
W20240116 12:00:18.776854 59379 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 458.454 us                | 923.248 us                |
| Backward                  | 1.339 ms                  | 1.934 ms                  |
| Optimize                  | 114.857 us                | 235.794 us                |
| BarrierTimeBeforeRank0    | 467.581 us                | 2.938 ms                  |
| AfterBackward             | 110.562 ms                | 253.861 ms                |
| BlockToStepN              | 18.208 ms                 | 1.417 s                   |
| E2E-100                   | 42.239 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:00:19.463376 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=247, pq.top=247
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
E20240116 12:00:19.673007 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=772108
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
W20240116 12:00:19.841450 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
W20240116 12:00:20.525574 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=250, pq.top=250
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
E20240116 12:00:20.673008 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=795997
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
W20240116 12:00:20.898701 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
W20240116 12:00:21.581468 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=253, pq.top=253
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
E20240116 12:00:21.673023 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=819786
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.973 ms                  | 117.743 ms                |
| ProcessBack:UpdateCache   | 6.067 ms                  | 7.484 ms                  |
| ProcessBack:UpsertPq      | 96.010 ms                 | 144.159 ms                |
| ProcessOneStep            | 110.344 ms                | 252.368 ms                |
| BlockToStepN              | 18.149 ms                 | 85.129 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
W20240116 12:00:21.952334 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
W20240116 12:00:22.650517 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=256, pq.top=256
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
E20240116 12:00:22.673044 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
W20240116 12:00:23.029508 59379 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
E20240116 12:00:23.673010 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=2713
W20240116 12:00:23.717229 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=259, pq.top=259
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
W20240116 12:00:24.102844 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 458.454 us                | 884.638 us                |
| Backward                  | 1.324 ms                  | 1.886 ms                  |
| Optimize                  | 114.857 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 445.016 us                | 2.621 ms                  |
| AfterBackward             | 109.748 ms                | 252.460 ms                |
| BlockToStepN              | 18.259 ms                 | 85.206 ms                 |
| E2E-100                   | 42.239 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
E20240116 12:00:24.673029 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=891349
W20240116 12:00:24.802803 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=262, pq.top=262
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
W20240116 12:00:25.244098 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
E20240116 12:00:25.673009 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=912845
W20240116 12:00:25.950663 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=265, pq.top=265
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
W20240116 12:00:26.333204 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 12:00:26.673015 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=935552
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.917 ms                  | 117.743 ms                |
| ProcessBack:UpdateCache   | 6.067 ms                  | 7.484 ms                  |
| ProcessBack:UpsertPq      | 96.379 ms                 | 144.159 ms                |
| ProcessOneStep            | 109.908 ms                | 252.368 ms                |
| BlockToStepN              | 18.223 ms                 | 85.129 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:00:27.019759 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=268, pq.top=268
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
W20240116 12:00:27.396785 59379 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
E20240116 12:00:27.673014 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=275
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
W20240116 12:00:28.080384 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=271, pq.top=271
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
W20240116 12:00:28.516602 59379 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 12:00:28.673007 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=2023
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
W20240116 12:00:29.194751 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=274, pq.top=274
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 458.155 us                | 884.638 us                |
| Backward                  | 1.293 ms                  | 1.886 ms                  |
| Optimize                  | 114.369 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 420.697 us                | 2.621 ms                  |
| AfterBackward             | 109.571 ms                | 252.460 ms                |
| BlockToStepN              | 18.413 ms                 | 85.206 ms                 |
| E2E-100                   | 42.239 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
W20240116 12:00:29.627995 59379 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 12:00:29.673040 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=585
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
W20240116 12:00:30.309545 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=277, pq.top=277
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
E20240116 12:00:30.673048 58285 parallel_pq_v2.h:76] insert failed, size(hashtable)=64
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
W20240116 12:00:30.807557 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
W20240116 12:00:31.517243 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=280, pq.top=280
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
E20240116 12:00:31.673053 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=824
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.881 ms                  | 117.743 ms                |
| ProcessBack:UpdateCache   | 6.073 ms                  | 7.484 ms                  |
| ProcessBack:UpsertPq      | 95.924 ms                 | 144.159 ms                |
| ProcessOneStep            | 109.425 ms                | 252.368 ms                |
| BlockToStepN              | 18.344 ms                 | 85.129 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
W20240116 12:00:31.970657 59379 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
W20240116 12:00:32.671700 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=283, pq.top=283
E20240116 12:00:32.673017 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1068616
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
W20240116 12:00:33.143842 59379 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
E20240116 12:00:33.673177 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1087541
W20240116 12:00:34.018817 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=286, pq.top=286
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 460.194 us                | 884.638 us                |
| Backward                  | 1.185 ms                  | 1.886 ms                  |
| Optimize                  | 114.369 us                | 234.491 us                |
| BarrierTimeBeforeRank0    | 405.809 us                | 2.621 ms                  |
| AfterBackward             | 109.571 ms                | 252.460 ms                |
| BlockToStepN              | 18.413 ms                 | 85.206 ms                 |
| E2E-100                   | 42.239 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:00:34.249092 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
E20240116 12:00:34.673645 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1099377
W20240116 12:00:35.226332 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=288, pq.top=288
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
W20240116 12:00:35.323493 59379 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
E20240116 12:00:35.673015 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1116454
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
W20240116 12:00:36.361486 59379 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
W20240116 12:00:36.609249 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=291, pq.top=291
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
E20240116 12:00:36.673004 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1133989
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.873 ms                  | 117.743 ms                |
| ProcessBack:UpdateCache   | 6.076 ms                  | 7.484 ms                  |
| ProcessBack:UpsertPq      | 96.352 ms                 | 144.159 ms                |
| ProcessOneStep            | 109.744 ms                | 252.368 ms                |
| BlockToStepN              | 18.344 ms                 | 85.129 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
W20240116 12:00:37.435184 59379 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 12:00:37.673017 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1157064
W20240116 12:00:37.773344 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=294, pq.top=294
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
W20240116 12:00:38.507262 59379 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 12:00:38.673022 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=2232
W20240116 12:00:38.841985 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=297, pq.top=297
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 462.728 us                | 895.497 us                |
| Backward                  | 1.110 ms                  | 1.886 ms                  |
| Optimize                  | 114.857 us                | 235.794 us                |
| BarrierTimeBeforeRank0    | 393.118 us                | 2.621 ms                  |
| AfterBackward             | 109.781 ms                | 252.460 ms                |
| BlockToStepN              | 18.425 ms                 | 85.206 ms                 |
| E2E-100                   | 42.239 s                  | 47.700 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
E20240116 12:00:39.673017 59379 parallel_pq_v2.h:76] insert failed, size(hashtable)=1196984
W20240116 12:00:39.723448 59379 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
W20240116 12:00:40.071822 58285 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=300, pq.top=300
Step299:rank1, time: 37.267, per_step: 0.368984
Step299:rank2, time: 37.267, per_step: 0.368984
Step299:rank0, time: 37.267, per_step: 0.368984
Step299:rank3, time: 37.267, per_step: 0.368984
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
ERROR [58285 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
*** Aborted at 1705377641 (Unix time, try 'date -d @1705377641') ***
*** Signal 11 (SIGSEGV) (0x10000cb7af00) received by PID 58285 (pthread TID 0x7f1136ff5700) (linux TID 59378) (code: address not mapped to object), stack trace: ***
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN5folly10symbolizer17getStackTraceSafeEPmm+0x7c)[0x7f159852d115]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN5folly10symbolizer21SafeStackTracePrinter15printStackTraceEb+0x66)[0x7f15984e4d14]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(+0x7c71d9)[0x7f15984e31d9]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(+0x7c72b6)[0x7f15984e32b6]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x1297f)[0x7f16db04d97f]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53df1c5)[0x7f15e12531c5]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZNK2at18TensorIteratorBase15serial_for_eachEN3c1012function_refIFvPPcPKlllEEENS_5RangeE+0x17b)[0x7f15dd1dc63b]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at18TensorIteratorBase8for_eachEN3c1012function_refIFvPPcPKlllEEEl+0x16e)[0x7f15dd1dcbbe]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53e7cca)[0x7f15e125bcca]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x53e9bed)[0x7f15e125dbed]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x19a56bd)[0x7f15dd8196bd]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at6native28structured_index_add_cpu_out4implERKNS_6TensorElS4_S4_RKN3c106ScalarES4_+0x2b6)[0x7f15dd830d06]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x2600f2d)[0x7f15de474f2d]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_10redispatchEN3c1014DispatchKeySetERNS_6TensorElRKS4_S7_RKNS2_6ScalarE+0x99)[0x7f15de352629]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x4580b9d)[0x7f15e03f4b9d]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_10redispatchEN3c1014DispatchKeySetERNS_6TensorElRKS4_S7_RKNS2_6ScalarE+0x99)[0x7f15de352629]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(+0x3f86b23)[0x7f15dfdfab23]
/home/xieminhui/miniconda3/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so(_ZN2at4_ops10index_add_4callERNS_6TensorElRKS2_S5_RKN3c106ScalarE+0x196)[0x7f15de3b4d46]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNK2at6Tensor10index_add_ElRKS0_S2_RKN3c106ScalarE+0x3a)[0x7f159831b582]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZN8recstore21GradAsyncProcessingV214GradWorkThreadEi+0x2d4)[0x7f159832a80a]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt13__invoke_implIvRMN8recstore21GradAsyncProcessingV2EFviERPS1_JRiEET_St21__invoke_memfun_derefOT0_OT1_DpOT2_+0x7d)[0x7f159839aede]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt8__invokeIRMN8recstore21GradAsyncProcessingV2EFviEJRPS1_RiEENSt15__invoke_resultIT_JDpT0_EE4typeEOS9_DpOSA_+0x4e)[0x7f159839ae2e]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS1_iEE6__callIvJEJLm0ELm1EEEET_OSt5tupleIJDpT0_EESt12_Index_tupleIJXspT1_EEE+0x83)[0x7f159839ad4b]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS1_iEEclIJEvEET0_DpOT_+0x32)[0x7f159839ac48]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt13__invoke_implIvSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS2_iEEJEET_St14__invoke_otherOT0_DpOT1_+0x1f)[0x7f159839aa85]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZSt8__invokeISt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS2_iEEJEENSt15__invoke_resultIT_JDpT0_EE4typeEOS9_DpOSA_+0x1f)[0x7f159839a918]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt6thread8_InvokerISt5tupleIJSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS4_iEEEEE9_M_invokeIJLm0EEEEvSt12_Index_tupleIJXspT_EEE+0x27)[0x7f159839a82d]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt6thread8_InvokerISt5tupleIJSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS4_iEEEEEclEv+0x17)[0x7f159839a797]
/home/xieminhui/RecStore/build/lib/librecstore_pytorch.so(_ZNSt6thread11_State_implINS_8_InvokerISt5tupleIJSt5_BindIFMN8recstore21GradAsyncProcessingV2EFviEPS5_iEEEEEEE6_M_runEv+0x1b)[0x7f159839a69f]
/home/xieminhui/miniconda3/bin/../lib/libstdc++.so.6(+0xd3e94)[0x7f15ee268e94]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x76da)[0x7f16db0426da]
/lib/x86_64-linux-gnu/libc.so.6(clone+0x3e)[0x7f16da5c661e]
(safe mode, symbolizer not available)
