WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 22:18:36.237005 570066 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240130 22:18:36.238271 570066 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:151: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [570066 perf_rec_model.py:151] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f0fd8d21120>==========
Worker 1 pid=570372
Worker 2 pid=570374
INFO [570066 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [570372 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [570376 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [570374 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [570376 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [570374 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240130 22:18:38.583421 570376 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 22:18:38.583441 570374 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [570066 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [570372 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240130 22:18:38.584853 570066 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 22:18:38.585279 570372 IPCTensor.h:348] IPCTensor full_emb already exists
W20240130 22:18:38.589433 570372 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [3376257, 32]; dev=1; size=412.1 MB
W20240130 22:18:38.590152 570376 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [3376257, 32]; dev=3; size=412.1 MB
W20240130 22:18:38.590251 570372 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10010196e000 7.629 MB
W20240130 22:18:38.590351 570372 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100102111000 7.629 MB
W20240130 22:18:38.590394 570372 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x1001028b4000 122.1 MB
W20240130 22:18:38.590430 570372 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10010a2c8000 122.1 MB
W20240130 22:18:38.590474 570372 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240130 22:18:38.591217 570066 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [3376257, 32]; dev=0; size=412.1 MB
W20240130 22:18:38.591485 570374 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [3376257, 32]; dev=2; size=412.1 MB
W20240130 22:18:38.592836 570372 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240130 22:18:38.592963 570376 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100111ce0000 7.629 MB
W20240130 22:18:38.593106 570376 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100112483000 7.629 MB
W20240130 22:18:38.593171 570376 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100112c26000 122.1 MB
W20240130 22:18:38.593220 570376 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10011a63a000 122.1 MB
W20240130 22:18:38.593261 570376 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240130 22:18:38.596308 570374 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100122054000 7.629 MB
W20240130 22:18:38.596472 570066 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1001227f7000 7.629 MB
W20240130 22:18:38.596549 570374 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100122f9a000 7.629 MB
W20240130 22:18:38.596624 570066 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10012373d000 7.629 MB
W20240130 22:18:38.596655 570374 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x100123ee0000 122.1 MB
W20240130 22:18:38.596743 570374 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10012b8f4000 122.1 MB
W20240130 22:18:38.596746 570066 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100133308000 122.1 MB
W20240130 22:18:38.596825 570066 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10013ad1c000 122.1 MB
W20240130 22:18:38.596836 570374 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240130 22:18:38.596896 570066 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 22:18:38.597667 570376 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240130 22:18:38.599505 570066 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 22:18:38.599503 570374 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
Worker 3 pid=570376
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 3376257), (3376257, 6752514), (6752514, 10128771), (10128771, 13505028)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240130 22:18:44.409406 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10014273c000 7.629 MB
W20240130 22:18:44.409569 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100142edf000 7.629 MB
W20240130 22:18:44.409600 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100143682000 7.629 MB
W20240130 22:18:44.409621 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x100143e25000 7.629 MB
W20240130 22:18:44.409667 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1001445c8000 7.629 MB
W20240130 22:18:44.409696 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100144d6b000 7.629 MB
W20240130 22:18:44.409724 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10014550e000 7.629 MB
W20240130 22:18:44.409770 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100145cb1000 7.629 MB
W20240130 22:18:44.409808 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100146454000 7.629 MB
W20240130 22:18:44.409830 570376 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x100146bf7000 7.629 MB
W20240130 22:18:44.409858 570376 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10014739a000 80 B 
W20240130 22:18:44.409883 570376 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10014739c000 8 B 
W20240130 22:18:44.409904 570376 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10014739e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:18:44.410243 570376 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240130 22:18:45.628264 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1001473a0000 7.629 MB
W20240130 22:18:45.628428 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100147b43000 7.629 MB
W20240130 22:18:45.628456 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1001482e6000 7.629 MB
W20240130 22:18:45.628480 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100148a89000 7.629 MB
W20240130 22:18:45.628501 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10014922c000 7.629 MB
W20240130 22:18:45.628520 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1001499cf000 7.629 MB
W20240130 22:18:45.628540 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10014a172000 7.629 MB
W20240130 22:18:45.628590 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10014a915000 7.629 MB
W20240130 22:18:45.628608 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10014b0b8000 7.629 MB
W20240130 22:18:45.628623 570066 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10014b85b000 7.629 MB
W20240130 22:18:45.628639 570066 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10014bffe000 80 B 
W20240130 22:18:45.628659 570066 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10014c000000 8 B 
W20240130 22:18:45.628674 570066 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10014c002000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:18:45.628911 570066 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 22:18:45.642470 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10014c004000 7.629 MB
W20240130 22:18:45.642608 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x10014c7a7000 7.629 MB
W20240130 22:18:45.642637 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x10014cf4a000 7.629 MB
W20240130 22:18:45.642655 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10014d6ed000 7.629 MB
W20240130 22:18:45.642683 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10014de90000 7.629 MB
W20240130 22:18:45.642710 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x10014e633000 7.629 MB
W20240130 22:18:45.642740 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10014edd6000 7.629 MB
W20240130 22:18:45.642776 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x10014f579000 7.629 MB
W20240130 22:18:45.642809 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10014fd1c000 7.629 MB
W20240130 22:18:45.642832 570372 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1001504bf000 7.629 MB
W20240130 22:18:45.642856 570372 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x100150c62000 80 B 
W20240130 22:18:45.642879 570372 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100150c64000 8 B 
W20240130 22:18:45.642897 570372 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100150c66000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:18:45.643146 570372 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 22:18:45.654325 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x100150c68000 7.629 MB
W20240130 22:18:45.654448 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10015140b000 7.629 MB
W20240130 22:18:45.654474 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100151bae000 7.629 MB
W20240130 22:18:45.654495 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100152351000 7.629 MB
W20240130 22:18:45.654531 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x100152af4000 7.629 MB
W20240130 22:18:45.654553 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x100153297000 7.629 MB
W20240130 22:18:45.654573 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x100153a3a000 7.629 MB
W20240130 22:18:45.654601 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1001541dd000 7.629 MB
W20240130 22:18:45.654624 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x100154980000 7.629 MB
W20240130 22:18:45.654644 570374 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x100155123000 7.629 MB
W20240130 22:18:45.654668 570374 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1001558c6000 80 B 
W20240130 22:18:45.654690 570374 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1001558c8000 8 B 
W20240130 22:18:45.654716 570374 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1001558ca000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:18:45.654959 570374 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 22:18:45.656165 570066 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240130 22:18:45.656296 570066 grad_base.h:184] Init GradProcessingBase done
I20240130 22:18:47.948047 570066 grad_async_v2.h:43] Use main thread to update emb.
W20240130 22:18:47.948254 570066 kg_controller.h:78] after init GradAsyncProcessingV2
I20240130 22:18:47.948263 570066 kg_controller.h:84] Construct KGCacheController done
E20240130 22:18:48.270714 570066 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240130 22:18:48.270794 570374 recstore.cc:66] init folly done
E20240130 22:18:48.270798 570372 recstore.cc:66] init folly done
E20240130 22:18:48.270812 570376 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240130 22:18:48.271502 570066 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 22:18:49.284214 570935 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 22:18:49.284396 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 22:18:50.284022 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:18:50.325855 570935 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240130 22:18:51.284076 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:18:51.372104 570935 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240130 22:18:52.284054 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 91.033 us                 | 171.156 us                |
+---------------------------+---------------------------+---------------------------+
Before Training
I20240130 22:18:53.513234 570376 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
Before Training
Before Training
Before Training
I20240130 22:18:53.513622 570066 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240130 22:18:53.513654 570374 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240130 22:18:53.513679 570372 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
W20240130 22:18:53.515058 570935 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 22:18:53.515151 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 22:18:54.774009 571252 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:18:54.877358 570066 grad_async_v2.h:269] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240130 22:18:54.983980 570935 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
INFO [570372 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [570376 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [570374 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [570066 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.063 us                | 206.143 us                |
| GenInput                  | 949.110 us                | 1.345 ms                  |
| NN                        | 2.294 ms                  | 97.822 ms                 |
| Forward                   | 2.671 ms                  | 98.754 ms                 |
| Backward                  | 100.757 ms                | 100.757 ms                |
| Optimize                  | 9.280 ms                  | 9.280 ms                  |
| BarrierTimeBeforeRank0    | 33.733 ms                 | 33.733 ms                 |
| AfterBackward             | 1.116 s                   | 1.116 s                   |
| BlockToStepN              | 105.497 ms                | 105.497 ms                |
| OneStep                   | 1.469 s                   | 1.469 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 22:18:55.737450 570066 grad_async_v2.h:256] pq is empty
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
E20240130 22:18:55.773082 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
W20240130 22:18:56.256517 570935 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
W20240130 22:18:56.289031 570066 grad_async_v2.h:256] pq is empty
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
E20240130 22:18:56.773006 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240130 22:18:57.450151 570935 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
E20240130 22:18:57.774003 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=50
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.857 us                | 2.472 ms                  |
| ProcessBack:Shuffle       | 56.862 ms                 | 213.215 ms                |
| ProcessBack:UpdateCache   | 5.983 ms                  | 723.649 ms                |
| ProcessBack:UpsertPq      | 39.306 us                 | 103.569 ms                |
| ProcessOneStep            | 60.957 ms                 | 1.116 s                   |
| BlockToStepN              | 52.960 us                 | 105.223 ms                |
+---------------------------+---------------------------+---------------------------+
W20240130 22:18:58.551244 570935 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
E20240130 22:18:58.773079 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
W20240130 22:18:59.508091 570066 grad_async_v2.h:256] pq is empty
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240130 22:18:59.656313 570935 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240130 22:18:59.773027 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 120.546 us                | 328.580 us                |
| GenInput                  | 353.722 us                | 1.345 ms                  |
| NN                        | 458.771 us                | 97.822 ms                 |
| Forward                   | 665.487 us                | 98.754 ms                 |
| Backward                  | 1.706 ms                  | 741.129 ms                |
| Optimize                  | 172.164 us                | 9.280 ms                  |
| BarrierTimeBeforeRank0    | 127.457 us                | 33.733 ms                 |
| AfterBackward             | 59.686 ms                 | 1.116 s                   |
| BlockToStepN              | 112.984 us                | 105.497 ms                |
| OneStep                   | 64.317 ms                 | 1.469 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
W20240130 22:19:00.715574 570935 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end7
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
E20240130 22:19:00.773213 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 22:19:01.773547 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:19:01.790557 570935 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
W20240130 22:19:02.085055 570066 grad_async_v2.h:256] pq is empty
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240130 22:19:02.773128 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
W20240130 22:19:03.259864 570935 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 82.466 us                 | 187.708 us                |
| ProcessBack:Shuffle       | 55.434 ms                 | 68.373 ms                 |
| ProcessBack:UpdateCache   | 5.546 ms                  | 7.313 ms                  |
| ProcessBack:UpsertPq      | 40.435 us                 | 190.980 us                |
| ProcessOneStep            | 58.670 ms                 | 1.116 s                   |
| BlockToStepN              | 80.833 us                 | 217.237 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
E20240130 22:19:03.773029 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
W20240130 22:19:04.281019 570935 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end5
W20240130 22:19:04.281272 570066 grad_async_v2.h:256] pq is empty
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
W20240130 22:19:04.463615 570066 grad_async_v2.h:256] pq is empty
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
E20240130 22:19:04.773078 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
W20240130 22:19:04.899309 570066 grad_async_v2.h:256] pq is empty
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
W20240130 22:19:05.296979 570935 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
W20240130 22:19:05.618527 570066 grad_async_v2.h:256] pq is empty
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.118 us                | 206.143 us                |
| GenInput                  | 354.051 us                | 1.239 ms                  |
| NN                        | 468.862 us                | 2.294 ms                  |
| Forward                   | 672.639 us                | 2.671 ms                  |
| Backward                  | 1.681 ms                  | 100.757 ms                |
| Optimize                  | 174.890 us                | 648.198 us                |
| BarrierTimeBeforeRank0    | 57.039 us                 | 1.846 ms                  |
| AfterBackward             | 58.687 ms                 | 1.116 s                   |
| BlockToStepN              | 151.805 us                | 478.814 us                |
| OneStep                   | 62.409 ms                 | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
E20240130 22:19:05.773038 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
W20240130 22:19:06.302008 570935 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank1, time: 26.654, per_step: 0.266542
Step99:rank3, time: 26.654, per_step: 0.266542
Step99:rank2, time: 26.654, per_step: 0.266543
Step99:rank0, time: 26.654, per_step: 0.266544
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.733 us                | 206.143 us                |
| GenInput                  | 344.481 us                | 1.239 ms                  |
| NN                        | 467.727 us                | 2.294 ms                  |
| Forward                   | 665.487 us                | 2.671 ms                  |
| Backward                  | 1.669 ms                  | 100.757 ms                |
| Optimize                  | 174.618 us                | 648.198 us                |
| BarrierTimeBeforeRank0    | 42.361 us                 | 1.846 ms                  |
| AfterBackward             | 58.452 ms                 | 1.116 s                   |
| BlockToStepN              | 166.599 us                | 478.814 us                |
| OneStep                   | 62.223 ms                 | 1.205 s                   |
| E2E-100                   | 13.040 s                  | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240130 22:19:06.773010 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
W20240130 22:19:06.940953 570066 grad_async_v2.h:256] pq is empty
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
W20240130 22:19:07.310500 570935 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
W20240130 22:19:07.387056 570066 grad_async_v2.h:256] pq is empty
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
E20240130 22:19:07.773222 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 98.574 us                 | 221.320 us                |
| ProcessBack:Shuffle       | 52.585 ms                 | 72.903 ms                 |
| ProcessBack:UpdateCache   | 5.969 ms                  | 8.084 ms                  |
| ProcessBack:UpsertPq      | 41.877 us                 | 354.233 us                |
| ProcessOneStep            | 58.275 ms                 | 1.116 s                   |
| BlockToStepN              | 137.988 us                | 377.119 us                |
+---------------------------+---------------------------+---------------------------+
W20240130 22:19:08.349539 570935 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end9
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
E20240130 22:19:08.773038 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
W20240130 22:19:09.295578 570066 grad_async_v2.h:256] pq is empty
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
W20240130 22:19:09.646796 570066 grad_async_v2.h:256] pq is empty
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
W20240130 22:19:09.660912 570935 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
E20240130 22:19:09.773041 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
W20240130 22:19:09.938793 570066 grad_async_v2.h:256] pq is empty
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.563 us                | 279.216 us                |
| GenInput                  | 344.369 us                | 1.345 ms                  |
| NN                        | 466.021 us                | 2.294 ms                  |
| Forward                   | 668.874 us                | 2.671 ms                  |
| Backward                  | 1.631 ms                  | 100.757 ms                |
| Optimize                  | 174.799 us                | 648.198 us                |
| BarrierTimeBeforeRank0    | 36.836 us                 | 1.846 ms                  |
| AfterBackward             | 58.618 ms                 | 1.116 s                   |
| BlockToStepN              | 203.444 us                | 478.814 us                |
| OneStep                   | 62.228 ms                 | 1.205 s                   |
| E2E-100                   | 13.040 s                  | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:19:10.686254 570935 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240130 22:19:10.773072 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:19:10.829514 570066 grad_async_v2.h:256] pq is empty
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
W20240130 22:19:11.533160 570066 grad_async_v2.h:256] pq is empty
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
W20240130 22:19:11.730293 570935 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240130 22:19:11.773069 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
W20240130 22:19:12.022233 570066 grad_async_v2.h:256] pq is empty
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240130 22:19:12.624574 570066 grad_async_v2.h:256] pq is empty
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
W20240130 22:19:12.684327 570066 grad_async_v2.h:256] pq is empty
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
E20240130 22:19:12.773013 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=70
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240130 22:19:12.948462 570935 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240130 22:19:13.123414 570066 grad_async_v2.h:256] pq is empty
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 95.992 us                 | 223.724 us                |
| ProcessBack:Shuffle       | 52.813 ms                 | 70.593 ms                 |
| ProcessBack:UpdateCache   | 5.993 ms                  | 7.435 ms                  |
| ProcessBack:UpsertPq      | 43.731 us                 | 190.980 us                |
| ProcessOneStep            | 58.600 ms                 | 749.830 ms                |
| BlockToStepN              | 173.562 us                | 513.500 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
E20240130 22:19:13.773101 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:19:13.800810 570066 grad_async_v2.h:256] pq is empty
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
W20240130 22:19:13.959486 570066 grad_async_v2.h:256] pq is empty
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
W20240130 22:19:14.177878 570935 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
W20240130 22:19:14.351243 570066 grad_async_v2.h:256] pq is empty
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
E20240130 22:19:14.773362 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240130 22:19:15.199595 570066 grad_async_v2.h:256] pq is empty
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
W20240130 22:19:15.269749 570935 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 118.216 us                | 206.143 us                |
| GenInput                  | 349.977 us                | 1.345 ms                  |
| NN                        | 466.505 us                | 1.737 ms                  |
| Forward                   | 672.074 us                | 2.269 ms                  |
| Backward                  | 1.665 ms                  | 6.534 ms                  |
| Optimize                  | 174.799 us                | 604.074 us                |
| BarrierTimeBeforeRank0    | 84.629 us                 | 1.726 ms                  |
| AfterBackward             | 58.620 ms                 | 749.866 ms                |
| BlockToStepN              | 242.398 us                | 611.083 us                |
| OneStep                   | 62.672 ms                 | 754.380 ms                |
| E2E-100                   | 13.040 s                  | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:19:15.773015 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
Step199:rank3, time: 9.567, per_step: 0.094721
Step199:rank1, time: 9.567, per_step: 0.094721
Step199:rank0, time: 9.567, per_step: 0.094721
Step199:rank2, time: 9.567, per_step: 0.094721
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.733 us                | 206.143 us                |
| GenInput                  | 349.300 us                | 1.345 ms                  |
| NN                        | 466.021 us                | 1.737 ms                  |
| Forward                   | 671.344 us                | 2.269 ms                  |
| Backward                  | 1.664 ms                  | 6.534 ms                  |
| Optimize                  | 174.383 us                | 604.074 us                |
| BarrierTimeBeforeRank0    | 91.664 us                 | 1.726 ms                  |
| AfterBackward             | 58.618 ms                 | 749.866 ms                |
| BlockToStepN              | 243.473 us                | 611.083 us                |
| OneStep                   | 62.672 ms                 | 754.380 ms                |
| E2E-100                   | 9.567 s                   | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
W20240130 22:19:16.340711 570935 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
E20240130 22:19:16.773162 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
W20240130 22:19:17.208892 570066 grad_async_v2.h:256] pq is empty
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
W20240130 22:19:17.523217 570935 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
E20240130 22:19:17.773007 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 100.435 us                | 252.723 us                |
| ProcessBack:Shuffle       | 52.813 ms                 | 72.903 ms                 |
| ProcessBack:UpdateCache   | 5.940 ms                  | 8.084 ms                  |
| ProcessBack:UpsertPq      | 43.731 us                 | 190.980 us                |
| ProcessOneStep            | 58.588 ms                 | 749.830 ms                |
| BlockToStepN              | 205.130 us                | 555.848 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
E20240130 22:19:18.773008 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
W20240130 22:19:18.868973 570935 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
W20240130 22:19:19.189082 570066 grad_async_v2.h:256] pq is empty
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
E20240130 22:19:19.773010 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
W20240130 22:19:19.887367 570935 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.733 us                | 247.754 us                |
| GenInput                  | 347.240 us                | 1.345 ms                  |
| NN                        | 466.021 us                | 1.737 ms                  |
| Forward                   | 672.074 us                | 2.269 ms                  |
| Backward                  | 1.658 ms                  | 6.534 ms                  |
| Optimize                  | 173.391 us                | 604.074 us                |
| BarrierTimeBeforeRank0    | 110.686 us                | 1.726 ms                  |
| AfterBackward             | 58.620 ms                 | 749.866 ms                |
| BlockToStepN              | 278.904 us                | 827.182 us                |
| OneStep                   | 62.672 ms                 | 754.380 ms                |
| E2E-100                   | 9.567 s                   | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
E20240130 22:19:20.773027 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
W20240130 22:19:20.923144 570935 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
W20240130 22:19:21.746465 570066 grad_async_v2.h:256] pq is empty
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
E20240130 22:19:21.773027 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:19:21.807395 570066 grad_async_v2.h:256] pq is empty
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
W20240130 22:19:21.866850 570066 grad_async_v2.h:256] pq is empty
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
W20240130 22:19:22.095507 570935 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
E20240130 22:19:22.773022 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
W20240130 22:19:23.259100 570935 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.799 us                | 244.636 us                |
| ProcessBack:Shuffle       | 52.532 ms                 | 70.593 ms                 |
| ProcessBack:UpdateCache   | 5.949 ms                  | 7.436 ms                  |
| ProcessBack:UpsertPq      | 43.445 us                 | 190.980 us                |
| ProcessOneStep            | 58.507 ms                 | 471.087 ms                |
| BlockToStepN              | 248.952 us                | 555.848 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
W20240130 22:19:23.494498 570066 grad_async_v2.h:256] pq is empty
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
E20240130 22:19:23.773219 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
W20240130 22:19:24.283800 570066 grad_async_v2.h:256] pq is empty
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
W20240130 22:19:24.505409 570935 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
E20240130 22:19:24.773010 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
W20240130 22:19:24.862984 570066 grad_async_v2.h:256] pq is empty
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
W20240130 22:19:25.303828 570066 grad_async_v2.h:256] pq is empty
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 116.652 us                | 206.143 us                |
| GenInput                  | 344.575 us                | 1.479 ms                  |
| NN                        | 463.461 us                | 1.090 ms                  |
| Forward                   | 665.487 us                | 1.532 ms                  |
| Backward                  | 1.661 ms                  | 4.394 ms                  |
| Optimize                  | 171.256 us                | 408.463 us                |
| BarrierTimeBeforeRank0    | 137.225 us                | 1.726 ms                  |
| AfterBackward             | 58.466 ms                 | 471.122 ms                |
| BlockToStepN              | 317.072 us                | 726.869 us                |
| OneStep                   | 62.309 ms                 | 754.172 ms                |
| E2E-100                   | 9.567 s                   | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:19:25.747182 570935 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240130 22:19:25.773006 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
E20240130 22:19:26.773113 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:19:26.778720 570066 grad_async_v2.h:256] pq is empty
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
Step299:rank3, time: 10.729, per_step: 0.106231
Step299:rank0, time: 10.729, per_step: 0.106231
Step299:rank1, time: 10.729, per_step: 0.106231
Step299:rank2, time: 10.729, per_step: 0.106231
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 300 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 116.652 us                | 206.143 us                |
| GenInput                  | 344.481 us                | 1.479 ms                  |
| NN                        | 463.461 us                | 1.090 ms                  |
| Forward                   | 665.566 us                | 1.532 ms                  |
| Backward                  | 1.659 ms                  | 4.394 ms                  |
| Optimize                  | 171.256 us                | 408.463 us                |
| BarrierTimeBeforeRank0    | 133.744 us                | 1.726 ms                  |
| AfterBackward             | 58.525 ms                 | 471.122 ms                |
| BlockToStepN              | 324.424 us                | 738.392 us                |
| OneStep                   | 62.357 ms                 | 754.172 ms                |
| E2E-100                   | 10.729 s                  | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 300 ========== 
W20240130 22:19:26.975128 570935 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
E20240130 22:19:27.773232 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
W20240130 22:19:28.142547 570935 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 104.307 us                | 226.410 us                |
| ProcessBack:Shuffle       | 52.687 ms                 | 70.593 ms                 |
| ProcessBack:UpdateCache   | 5.940 ms                  | 7.436 ms                  |
| ProcessBack:UpsertPq      | 44.330 us                 | 205.353 us                |
| ProcessOneStep            | 58.600 ms                 | 471.087 ms                |
| BlockToStepN              | 284.806 us                | 850.696 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
W20240130 22:19:28.364240 570066 grad_async_v2.h:256] pq is empty
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
W20240130 22:19:28.431391 570066 grad_async_v2.h:256] pq is empty
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
E20240130 22:19:28.773046 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
W20240130 22:19:29.172703 570935 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
E20240130 22:19:29.773046 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
W20240130 22:19:30.249538 570935 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 117.606 us                | 240.548 us                |
| GenInput                  | 344.154 us                | 1.479 ms                  |
| NN                        | 466.821 us                | 1.090 ms                  |
| Forward                   | 675.201 us                | 1.532 ms                  |
| Backward                  | 1.671 ms                  | 4.394 ms                  |
| Optimize                  | 172.784 us                | 408.463 us                |
| BarrierTimeBeforeRank0    | 128.350 us                | 1.806 ms                  |
| AfterBackward             | 58.896 ms                 | 471.122 ms                |
| BlockToStepN              | 353.653 us                | 981.599 us                |
| OneStep                   | 62.936 ms                 | 754.172 ms                |
| E2E-100                   | 10.729 s                  | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
E20240130 22:19:30.773100 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
W20240130 22:19:31.287730 570935 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
W20240130 22:19:31.510138 570066 grad_async_v2.h:256] pq is empty
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
W20240130 22:19:31.644959 570066 grad_async_v2.h:256] pq is empty
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
E20240130 22:19:31.773042 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
W20240130 22:19:32.226128 570066 grad_async_v2.h:256] pq is empty
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
W20240130 22:19:32.296000 570066 grad_async_v2.h:256] pq is empty
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
W20240130 22:19:32.321522 570935 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
E20240130 22:19:32.773099 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=84
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 86.681 us                 | 216.087 us                |
| ProcessBack:Shuffle       | 53.540 ms                 | 70.852 ms                 |
| ProcessBack:UpdateCache   | 5.892 ms                  | 7.436 ms                  |
| ProcessBack:UpsertPq      | 45.944 us                 | 190.980 us                |
| ProcessOneStep            | 59.093 ms                 | 428.684 ms                |
| BlockToStepN              | 323.502 us                | 923.130 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
W20240130 22:19:33.335224 570935 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
W20240130 22:19:33.615629 570066 grad_async_v2.h:256] pq is empty
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
E20240130 22:19:33.773022 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:19:33.984980 570066 grad_async_v2.h:256] pq is empty
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
W20240130 22:19:34.357041 570935 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
W20240130 22:19:34.568351 570066 grad_async_v2.h:256] pq is empty
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
E20240130 22:19:34.773181 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
W20240130 22:19:35.170840 570066 grad_async_v2.h:256] pq is empty
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
W20240130 22:19:35.393256 570935 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.545 us                | 207.830 us                |
| GenInput                  | 346.799 us                | 1.345 ms                  |
| NN                        | 473.968 us                | 1.090 ms                  |
| Forward                   | 687.888 us                | 1.532 ms                  |
| Backward                  | 1.698 ms                  | 4.138 ms                  |
| Optimize                  | 175.406 us                | 408.463 us                |
| BarrierTimeBeforeRank0    | 108.283 us                | 1.806 ms                  |
| AfterBackward             | 59.212 ms                 | 428.716 ms                |
| BlockToStepN              | 386.925 us                | 1.174 ms                  |
| OneStep                   | 63.416 ms                 | 474.705 ms                |
| E2E-100                   | 10.729 s                  | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
E20240130 22:19:35.773007 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
W20240130 22:19:36.124078 570066 grad_async_v2.h:256] pq is empty
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
W20240130 22:19:36.470017 570935 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
Step399:rank3, time: 9.710, per_step: 0.096134
Step399:rank1, time: 9.709, per_step: 0.096134
Step399:rank2, time: 9.709, per_step: 0.096133
Step399:rank0, time: 9.710, per_step: 0.096134
========== Step 400 ========== 
========== Step 400 ========== 
========== Step 400 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 119.709 us                | 207.830 us                |
| GenInput                  | 346.819 us                | 1.345 ms                  |
| NN                        | 477.647 us                | 1.090 ms                  |
| Forward                   | 690.213 us                | 1.532 ms                  |
| Backward                  | 1.696 ms                  | 4.138 ms                  |
| Optimize                  | 175.745 us                | 408.463 us                |
| BarrierTimeBeforeRank0    | 105.516 us                | 1.806 ms                  |
| AfterBackward             | 59.214 ms                 | 428.716 ms                |
| BlockToStepN              | 391.793 us                | 1.174 ms                  |
| OneStep                   | 63.504 ms                 | 474.705 ms                |
| E2E-100                   | 9.710 s                   | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 400 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
E20240130 22:19:36.773092 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
W20240130 22:19:37.603161 570935 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 22:19:37.773093 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:19:37.778437 570066 grad_async_v2.h:256] pq is empty
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
W20240130 22:19:37.842367 570066 grad_async_v2.h:256] pq is empty
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 88.820 us                 | 329.321 us                |
| ProcessBack:Shuffle       | 53.805 ms                 | 72.903 ms                 |
| ProcessBack:UpdateCache   | 5.687 ms                  | 9.129 ms                  |
| ProcessBack:UpsertPq      | 47.579 us                 | 190.980 us                |
| ProcessOneStep            | 59.208 ms                 | 428.684 ms                |
| BlockToStepN              | 354.785 us                | 1.065 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
W20240130 22:19:38.581735 570066 grad_async_v2.h:256] pq is empty
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
E20240130 22:19:38.773021 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=23
W20240130 22:19:38.822525 570935 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240130 22:19:38.994921 570066 grad_async_v2.h:256] pq is empty
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
E20240130 22:19:39.773140 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
W20240130 22:19:40.029735 570935 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 120.655 us                | 207.830 us                |
| GenInput                  | 346.799 us                | 1.345 ms                  |
| NN                        | 478.601 us                | 1.096 ms                  |
| Forward                   | 690.685 us                | 1.532 ms                  |
| Backward                  | 1.702 ms                  | 4.394 ms                  |
| Optimize                  | 175.856 us                | 408.463 us                |
| BarrierTimeBeforeRank0    | 108.283 us                | 1.806 ms                  |
| AfterBackward             | 59.386 ms                 | 428.716 ms                |
| BlockToStepN              | 419.682 us                | 1.177 ms                  |
| OneStep                   | 63.759 ms                 | 474.705 ms                |
| E2E-100                   | 9.710 s                   | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:19:40.773061 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
W20240130 22:19:41.107023 570066 grad_async_v2.h:256] pq is empty
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
W20240130 22:19:41.279619 570935 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
E20240130 22:19:41.773046 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
W20240130 22:19:42.130007 570066 grad_async_v2.h:256] pq is empty
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
W20240130 22:19:42.191999 570066 grad_async_v2.h:256] pq is empty
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
W20240130 22:19:42.318768 570066 grad_async_v2.h:256] pq is empty
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
W20240130 22:19:42.497355 570935 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
E20240130 22:19:42.773144 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.938 us                | 239.376 us                |
| ProcessBack:Shuffle       | 54.190 ms                 | 70.852 ms                 |
| ProcessBack:UpdateCache   | 5.563 ms                  | 8.109 ms                  |
| ProcessBack:UpsertPq      | 49.141 us                 | 162.451 us                |
| ProcessOneStep            | 59.397 ms                 | 412.056 ms                |
| BlockToStepN              | 377.119 us                | 1.077 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
W20240130 22:19:43.491688 570066 grad_async_v2.h:256] pq is empty
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
W20240130 22:19:43.715057 570935 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
E20240130 22:19:43.773005 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
W20240130 22:19:44.556877 570066 grad_async_v2.h:256] pq is empty
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
W20240130 22:19:44.717532 570935 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240130 22:19:44.773303 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
W20240130 22:19:45.496287 570066 grad_async_v2.h:256] pq is empty
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 121.720 us                | 206.143 us                |
| GenInput                  | 346.819 us                | 1.302 ms                  |
| NN                        | 479.311 us                | 1.090 ms                  |
| Forward                   | 692.968 us                | 1.529 ms                  |
| Backward                  | 1.720 ms                  | 4.394 ms                  |
| Optimize                  | 175.769 us                | 385.553 us                |
| BarrierTimeBeforeRank0    | 108.283 us                | 1.806 ms                  |
| AfterBackward             | 59.632 ms                 | 412.084 ms                |
| BlockToStepN              | 441.286 us                | 1.247 ms                  |
| OneStep                   | 64.130 ms                 | 432.987 ms                |
| E2E-100                   | 9.710 s                   | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
W20240130 22:19:45.723938 570935 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240130 22:19:45.773018 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
W20240130 22:19:46.756690 570935 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240130 22:19:46.773214 570935 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
Step499:rank2, time: 10.416, per_step: 0.103124
Step499:rank1, time: 10.416, per_step: 0.103124
Step499:rank3, time: 10.416, per_step: 0.103125
Step499:rank0, time: 10.416, per_step: 0.103124
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 122.180 us                | 206.143 us                |
| GenInput                  | 349.300 us                | 1.302 ms                  |
| NN                        | 480.393 us                | 1.090 ms                  |
| Forward                   | 693.435 us                | 1.529 ms                  |
| Backward                  | 1.721 ms                  | 4.394 ms                  |
| Optimize                  | 175.856 us                | 385.553 us                |
| BarrierTimeBeforeRank0    | 108.283 us                | 1.806 ms                  |
| AfterBackward             | 59.659 ms                 | 412.084 ms                |
| BlockToStepN              | 448.888 us                | 1.405 ms                  |
| OneStep                   | 64.199 ms                 | 432.987 ms                |
| E2E-100                   | 10.416 s                  | 13.040 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:19:46.975709 570066 grad_async_v2.h:89] call StopThreads. PID = 570066
W20240130 22:19:46.975733 570066 grad_base.h:212] before processOneStepNegThread_.join();
W20240130 22:19:46.975787 570066 grad_base.h:214] after processOneStepNegThread_.join();
W20240130 22:19:46.975797 570066 grad_async_v2.h:91] call GradProcessingBase::StopThreads.
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
W20240130 22:19:47.255108 570066 grad_async_v2.h:110] StopThreads done.
timer name is E2E-100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 127.768 us                | 277.507 us                |
| ProcessBack:Shuffle       | 55.004 ms                 | 72.603 ms                 |
| ProcessBack:UpdateCache   | 5.194 ms                  | 8.109 ms                  |
| ProcessBack:UpsertPq      | 50.651 us                 | 162.451 us                |
| ProcessOneStep            | 59.633 ms                 | 412.056 ms                |
| BlockToStepN              | 393.343 us                | 1.301 ms                  |
+---------------------------+---------------------------+---------------------------+
ERROR [570066 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7f0fd7185d90>
Successfully xmh
W20240130 22:19:52.160465 570066 HazptrDomain.h:148] Tagged objects remain. This may indicate a higher-level leak of object(s) that use hazptr_obj_cohort.
