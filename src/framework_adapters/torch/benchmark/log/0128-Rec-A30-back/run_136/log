WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 22:21:28.280805 605630 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240130 22:21:28.282850 605630 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:151: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [605630 perf_rec_model.py:151] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f6302725120>==========
Worker 1 pid=605773
Worker 2 pid=605775
INFO [605630 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [605773 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [605630 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [605777 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [605775 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [605773 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [605777 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [605775 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240130 22:21:31.447566 605630 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 22:21:31.447695 605773 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 22:21:31.447988 605775 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 22:21:31.447996 605777 IPCTensor.h:348] IPCTensor full_emb already exists
W20240130 22:21:31.453718 605630 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [3376257, 32]; dev=0; size=412.1 MB
W20240130 22:21:31.453693 605773 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [3376257, 32]; dev=1; size=412.1 MB
W20240130 22:21:31.454473 605775 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [3376257, 32]; dev=2; size=412.1 MB
W20240130 22:21:31.454826 605777 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [3376257, 32]; dev=3; size=412.1 MB
W20240130 22:21:31.458566 605773 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100101974000 7.629 MB
W20240130 22:21:31.458613 605630 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100102117000 7.629 MB
W20240130 22:21:31.458688 605775 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x1001028ba000 7.629 MB
W20240130 22:21:31.458763 605630 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100103800000 7.629 MB
W20240130 22:21:31.458747 605777 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x10010305d000 7.629 MB
W20240130 22:21:31.458777 605773 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100103fa3000 7.629 MB
W20240130 22:21:31.458822 605630 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100104746000 122.1 MB
W20240130 22:21:31.458873 605773 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10010c15a000 122.1 MB
W20240130 22:21:31.458878 605630 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100113b6e000 122.1 MB
W20240130 22:21:31.458925 605630 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 22:21:31.458932 605773 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10011bd25000 122.1 MB
W20240130 22:21:31.458927 605775 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x10011b582000 7.629 MB
W20240130 22:21:31.458985 605773 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240130 22:21:31.459007 605777 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100123739000 7.629 MB
W20240130 22:21:31.459049 605775 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x100123edc000 122.1 MB
W20240130 22:21:31.459125 605777 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x10012b8f0000 122.1 MB
W20240130 22:21:31.459161 605775 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100133304000 122.1 MB
W20240130 22:21:31.459218 605777 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10013ad18000 122.1 MB
W20240130 22:21:31.459257 605775 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240130 22:21:31.459285 605777 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240130 22:21:31.460723 605630 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 22:21:31.460841 605773 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240130 22:21:31.460868 605775 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240130 22:21:31.460892 605777 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
Worker 3 pid=605777
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 3376257), (3376257, 6752514), (6752514, 10128771), (10128771, 13505028)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240130 22:21:38.893980 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10014273c000 7.629 MB
W20240130 22:21:38.894163 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100142edf000 7.629 MB
W20240130 22:21:38.894198 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100143682000 7.629 MB
W20240130 22:21:38.894223 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100143e25000 7.629 MB
W20240130 22:21:38.894248 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1001445c8000 7.629 MB
W20240130 22:21:38.894270 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100144d6b000 7.629 MB
W20240130 22:21:38.894297 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10014550e000 7.629 MB
W20240130 22:21:38.894337 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100145cb1000 7.629 MB
W20240130 22:21:38.894359 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x100146454000 7.629 MB
W20240130 22:21:38.894383 605773 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100146bf7000 7.629 MB
W20240130 22:21:38.894407 605773 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10014739a000 80 B 
W20240130 22:21:38.894428 605773 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10014739c000 8 B 
W20240130 22:21:38.894444 605773 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10014739e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:21:38.894757 605773 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240130 22:21:38.895937 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1001473a0000 7.629 MB
W20240130 22:21:38.896061 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100147b43000 7.629 MB
W20240130 22:21:38.896096 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1001482e6000 7.629 MB
W20240130 22:21:38.896121 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100148a89000 7.629 MB
W20240130 22:21:38.896144 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10014922c000 7.629 MB
W20240130 22:21:38.896167 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1001499cf000 7.629 MB
W20240130 22:21:38.896193 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10014a172000 7.629 MB
W20240130 22:21:38.896245 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10014a915000 7.629 MB
W20240130 22:21:38.896265 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10014b0b8000 7.629 MB
W20240130 22:21:38.896288 605775 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10014b85b000 7.629 MB
W20240130 22:21:38.896313 605775 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10014bffe000 80 B 
W20240130 22:21:38.896334 605775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10014c000000 8 B 
W20240130 22:21:38.896351 605775 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10014c002000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:21:38.896602 605775 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 22:21:39.524502 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10014c004000 7.629 MB
W20240130 22:21:39.524646 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10014c7a7000 7.629 MB
W20240130 22:21:39.524673 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x10014cf4a000 7.629 MB
W20240130 22:21:39.524694 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x10014d6ed000 7.629 MB
W20240130 22:21:39.524714 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10014de90000 7.629 MB
W20240130 22:21:39.524732 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x10014e633000 7.629 MB
W20240130 22:21:39.524752 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10014edd6000 7.629 MB
W20240130 22:21:39.524782 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10014f579000 7.629 MB
W20240130 22:21:39.524801 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10014fd1c000 7.629 MB
W20240130 22:21:39.524824 605630 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1001504bf000 7.629 MB
W20240130 22:21:39.524847 605630 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100150c62000 80 B 
W20240130 22:21:39.524868 605630 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100150c64000 8 B 
W20240130 22:21:39.524892 605630 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100150c66000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:21:39.525146 605630 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 22:21:39.534449 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100150c68000 7.629 MB
W20240130 22:21:39.534571 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10015140b000 7.629 MB
W20240130 22:21:39.534602 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100151bae000 7.629 MB
W20240130 22:21:39.534626 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x100152351000 7.629 MB
W20240130 22:21:39.534647 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x100152af4000 7.629 MB
W20240130 22:21:39.534670 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100153297000 7.629 MB
W20240130 22:21:39.534698 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100153a3a000 7.629 MB
W20240130 22:21:39.534735 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1001541dd000 7.629 MB
W20240130 22:21:39.534754 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100154980000 7.629 MB
W20240130 22:21:39.534775 605777 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x100155123000 7.629 MB
W20240130 22:21:39.534799 605777 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1001558c6000 80 B 
W20240130 22:21:39.534821 605777 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1001558c8000 8 B 
W20240130 22:21:39.534849 605777 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1001558ca000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:21:39.535071 605777 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 22:21:39.536449 605630 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240130 22:21:39.536558 605630 grad_base.h:184] Init GradProcessingBase done
I20240130 22:21:41.816185 605630 grad_async_v2.h:43] Use main thread to update emb.
W20240130 22:21:41.816541 605630 kg_controller.h:78] after init GradAsyncProcessingV2
I20240130 22:21:41.816550 605630 kg_controller.h:84] Construct KGCacheController done
E20240130 22:21:43.187666 605777 recstore.cc:66] init folly done
E20240130 22:21:43.187695 605775 recstore.cc:66] init folly done
E20240130 22:21:43.187726 605630 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240130 22:21:43.187755 605773 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240130 22:21:43.188858 605630 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 22:21:44.306743 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 22:21:44.307025 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 22:21:45.307020 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:21:45.330752 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240130 22:21:46.307163 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:21:46.415138 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
E20240130 22:21:47.307009 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240130 22:21:47.574959 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 129.256 us                | 240.774 us                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:21:48.307165 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:21:48.584834 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240130 22:21:49.307026 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:21:49.661154 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240130 22:21:50.307343 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:21:50.712571 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240130 22:21:51.307010 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
Before Training
I20240130 22:21:52.726989 605630 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
Before Training
Before Training
I20240130 22:21:52.727336 605775 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240130 22:21:52.727365 605773 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240130 22:21:52.727682 605777 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
W20240130 22:21:52.747143 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 22:21:52.747220 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 137.165 us                | 259.238 us                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:21:54.426086 606867 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 198.270 us                | 198.270 us                |
| GenInput                  | 31.009 ms                 | 31.009 ms                 |
| NN                        | 151.836 ms                | 151.836 ms                |
| Forward                   | 153.081 ms                | 153.081 ms                |
| Backward                  | 143.955 ms                | 143.955 ms                |
| Optimize                  | 9.614 ms                  | 9.614 ms                  |
| BarrierTimeBeforeRank0    | 17.522 ms                 | 17.522 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240130 22:21:54.714020 605630 grad_async_v2.h:269] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240130 22:21:54.890790 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
INFO [605773 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [605630 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [605777 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [605775 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
E20240130 22:21:55.426013 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=404
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
W20240130 22:21:55.772081 605630 grad_async_v2.h:256] pq is empty
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
W20240130 22:21:56.146674 605630 grad_async_v2.h:256] pq is empty
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
E20240130 22:21:56.426046 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=868
W20240130 22:21:56.460037 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
E20240130 22:21:57.426192 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=531
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
W20240130 22:21:57.797997 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.615 us                | 264.606 us                |
| ProcessBack:Shuffle       | 53.953 ms                 | 780.598 ms                |
| ProcessBack:UpdateCache   | 3.184 ms                  | 684.947 ms                |
| ProcessBack:UpsertPq      | 57.006 us                 | 287.840 ms                |
| ProcessOneStep            | 143.756 ms                | 1.629 s                   |
| BlockToStepN              | 47.167 us                 | 162.112 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:21:58.426028 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:21:59.112844 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
E20240130 22:21:59.426079 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 192.872 us                | 257.632 us                |
| GenInput                  | 35.006 ms                 | 42.471 ms                 |
| NN                        | 679.422 us                | 151.836 ms                |
| Forward                   | 1.015 ms                  | 153.081 ms                |
| Backward                  | 2.321 ms                  | 143.955 ms                |
| Optimize                  | 208.181 us                | 9.614 ms                  |
| BarrierTimeBeforeRank0    | 407.261 us                | 17.522 ms                 |
| AfterBackward             | 143.777 ms                | 1.629 s                   |
| BlockToStepN              | 114.911 us                | 162.528 ms                |
| OneStep                   | 216.149 ms                | 2.149 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240130 22:22:00.221931 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
E20240130 22:22:00.426331 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=158
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
E20240130 22:22:01.426173 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=47
W20240130 22:22:01.444451 605630 grad_async_v2.h:256] pq is empty
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
W20240130 22:22:01.466254 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end1
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240130 22:22:02.426379 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:22:02.587833 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end2
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.596 us                | 7.201 ms                  |
| ProcessBack:Shuffle       | 113.897 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.313 ms                  | 684.947 ms                |
| ProcessBack:UpsertPq      | 57.006 us                 | 287.840 ms                |
| ProcessOneStep            | 133.191 ms                | 2.050 s                   |
| BlockToStepN              | 54.297 us                 | 162.112 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:22:03.426010 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:22:03.707738 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end3
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
E20240130 22:22:04.426008 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=40
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 192.615 us                | 257.632 us                |
| GenInput                  | 36.288 ms                 | 45.760 ms                 |
| NN                        | 657.098 us                | 151.836 ms                |
| Forward                   | 1.005 ms                  | 153.081 ms                |
| Backward                  | 2.244 ms                  | 143.955 ms                |
| Optimize                  | 214.946 us                | 9.614 ms                  |
| BarrierTimeBeforeRank0    | 601.633 us                | 17.522 ms                 |
| AfterBackward             | 143.777 ms                | 2.051 s                   |
| BlockToStepN              | 124.579 us                | 162.528 ms                |
| OneStep                   | 216.149 ms                | 2.149 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 22:22:04.930533 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
E20240130 22:22:05.426041 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=91
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
W20240130 22:22:06.322423 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end8
E20240130 22:22:06.426100 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
E20240130 22:22:07.426115 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:22:07.438616 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 124.425 us                | 930.139 us                |
| ProcessBack:Shuffle       | 124.026 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.313 ms                  | 684.947 ms                |
| ProcessBack:UpsertPq      | 58.772 us                 | 287.840 ms                |
| ProcessOneStep            | 143.756 ms                | 2.050 s                   |
| BlockToStepN              | 63.582 us                 | 162.112 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
E20240130 22:22:08.438858 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:08.624715 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end0
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
E20240130 22:22:09.438119 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.842 us                | 257.632 us                |
| GenInput                  | 36.320 ms                 | 45.760 ms                 |
| NN                        | 663.710 us                | 151.836 ms                |
| Forward                   | 1.006 ms                  | 153.081 ms                |
| Backward                  | 2.297 ms                  | 143.955 ms                |
| Optimize                  | 218.393 us                | 9.614 ms                  |
| BarrierTimeBeforeRank0    | 601.633 us                | 17.522 ms                 |
| AfterBackward             | 193.982 ms                | 2.051 s                   |
| BlockToStepN              | 129.057 us                | 162.528 ms                |
| OneStep                   | 243.325 ms                | 2.149 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
W20240130 22:22:09.986892 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
E20240130 22:22:10.438019 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240130 22:22:11.080811 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end2
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
E20240130 22:22:11.438338 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
W20240130 22:22:11.985076 605630 grad_async_v2.h:256] pq is empty
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
E20240130 22:22:12.438274 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:12.458024 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.351 us                | 630.838 us                |
| ProcessBack:Shuffle       | 124.729 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.137 ms                  | 684.947 ms                |
| ProcessBack:UpsertPq      | 59.041 us                 | 287.840 ms                |
| ProcessOneStep            | 241.119 ms                | 2.050 s                   |
| BlockToStepN              | 66.649 us                 | 162.112 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
E20240130 22:22:13.438964 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=219
W20240130 22:22:13.456593 605630 grad_async_v2.h:256] pq is empty
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
W20240130 22:22:14.243988 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
E20240130 22:22:14.438025 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 187.020 us                | 257.632 us                |
| GenInput                  | 36.492 ms                 | 45.760 ms                 |
| NN                        | 656.207 us                | 151.836 ms                |
| Forward                   | 1.005 ms                  | 153.081 ms                |
| Backward                  | 2.510 ms                  | 143.955 ms                |
| Optimize                  | 214.878 us                | 9.614 ms                  |
| BarrierTimeBeforeRank0    | 583.839 us                | 17.522 ms                 |
| AfterBackward             | 193.982 ms                | 2.051 s                   |
| BlockToStepN              | 145.262 us                | 162.528 ms                |
| OneStep                   | 243.325 ms                | 2.149 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
E20240130 22:22:15.438295 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:15.565344 605630 grad_async_v2.h:256] pq is empty
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
W20240130 22:22:15.712168 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end3
E20240130 22:22:16.438020 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
W20240130 22:22:16.921856 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
E20240130 22:22:17.438071 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:18.076360 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.238 us                | 201.706 us                |
| ProcessBack:Shuffle       | 124.610 ms                | 1.472 s                   |
| ProcessBack:UpdateCache   | 2.218 ms                  | 684.947 ms                |
| ProcessBack:UpsertPq      | 60.284 us                 | 287.840 ms                |
| ProcessOneStep            | 193.962 ms                | 2.050 s                   |
| BlockToStepN              | 81.523 us                 | 162.112 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:22:18.438120 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
W20240130 22:22:19.091449 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
W20240130 22:22:19.417973 605630 grad_async_v2.h:256] pq is empty
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
E20240130 22:22:19.438050 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=29
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.649 us                | 257.632 us                |
| GenInput                  | 36.492 ms                 | 49.326 ms                 |
| NN                        | 656.207 us                | 151.836 ms                |
| Forward                   | 1.005 ms                  | 153.081 ms                |
| Backward                  | 2.483 ms                  | 143.955 ms                |
| Optimize                  | 214.878 us                | 9.614 ms                  |
| BarrierTimeBeforeRank0    | 405.159 us                | 17.522 ms                 |
| AfterBackward             | 133.230 ms                | 2.314 s                   |
| BlockToStepN              | 177.861 us                | 162.528 ms                |
| OneStep                   | 177.376 ms                | 2.344 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
W20240130 22:22:20.264256 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end0
E20240130 22:22:20.438042 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 22:22:21.438122 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
W20240130 22:22:22.094187 605630 grad_async_v2.h:256] pq is empty
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240130 22:22:22.320158 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end4
E20240130 22:22:22.438010 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.875 us                | 209.900 us                |
| ProcessBack:Shuffle       | 124.026 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.438 ms                  | 18.996 ms                 |
| ProcessBack:UpsertPq      | 60.284 us                 | 5.536 ms                  |
| ProcessOneStep            | 143.756 ms                | 2.050 s                   |
| BlockToStepN              | 92.691 us                 | 478.343 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
E20240130 22:22:23.438055 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:23.606186 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end6
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
E20240130 22:22:24.438069 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.720 us                | 257.632 us                |
| GenInput                  | 36.611 ms                 | 45.760 ms                 |
| NN                        | 655.568 us                | 11.864 ms                 |
| Forward                   | 987.100 us                | 12.236 ms                 |
| Backward                  | 2.441 ms                  | 52.898 ms                 |
| Optimize                  | 214.946 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 344.716 us                | 2.755 ms                  |
| AfterBackward             | 193.982 ms                | 2.051 s                   |
| BlockToStepN              | 179.377 us                | 9.081 ms                  |
| OneStep                   | 243.325 ms                | 2.149 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 22:22:24.778612 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end9
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240130 22:22:25.438076 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:26.252725 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 22:22:26.438181 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=128
W20240130 22:22:26.463811 605630 grad_async_v2.h:256] pq is empty
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
E20240130 22:22:27.438143 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:27.669302 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end6
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.858 us                | 1.377 ms                  |
| ProcessBack:Shuffle       | 124.729 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 3.184 ms                  | 18.996 ms                 |
| ProcessBack:UpsertPq      | 61.540 us                 | 5.536 ms                  |
| ProcessOneStep            | 164.325 ms                | 2.050 s                   |
| BlockToStepN              | 99.682 us                 | 478.343 us                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:22:28.438580 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:28.706434 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end7
E20240130 22:22:29.438123 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.649 us                | 257.632 us                |
| GenInput                  | 36.510 ms                 | 49.326 ms                 |
| NN                        | 649.399 us                | 11.864 ms                 |
| Forward                   | 984.587 us                | 12.236 ms                 |
| Backward                  | 2.441 ms                  | 52.898 ms                 |
| Optimize                  | 214.946 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 177.423 us                | 2.755 ms                  |
| AfterBackward             | 164.457 ms                | 2.051 s                   |
| BlockToStepN              | 186.100 us                | 9.081 ms                  |
| OneStep                   | 216.149 ms                | 2.149 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 22:22:29.975697 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
E20240130 22:22:30.438162 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:30.964308 605630 grad_async_v2.h:256] pq is empty
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240130 22:22:30.975915 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
W20240130 22:22:31.152491 605630 grad_async_v2.h:256] pq is empty
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
E20240130 22:22:31.451771 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
E20240130 22:22:32.451249 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:32.543427 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end4
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 119.200 us                | 4.482 ms                  |
| ProcessBack:Shuffle       | 141.791 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.580 ms                  | 18.996 ms                 |
| ProcessBack:UpsertPq      | 61.403 us                 | 5.536 ms                  |
| ProcessOneStep            | 193.962 ms                | 2.050 s                   |
| BlockToStepN              | 116.489 us                | 478.343 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
E20240130 22:22:33.451303 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:33.562773 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end7
E20240130 22:22:34.451154 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.649 us                | 257.632 us                |
| GenInput                  | 36.477 ms                 | 49.326 ms                 |
| NN                        | 647.844 us                | 11.864 ms                 |
| Forward                   | 974.098 us                | 12.236 ms                 |
| Backward                  | 2.483 ms                  | 52.898 ms                 |
| Optimize                  | 214.878 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 191.721 us                | 2.755 ms                  |
| AfterBackward             | 193.982 ms                | 2.051 s                   |
| BlockToStepN              | 192.069 us                | 9.081 ms                  |
| OneStep                   | 243.325 ms                | 2.149 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
W20240130 22:22:34.960908 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end8
E20240130 22:22:35.451025 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
W20240130 22:22:36.326313 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240130 22:22:36.451057 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=37
E20240130 22:22:37.451494 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
W20240130 22:22:37.784698 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.290 us                | 229.031 us                |
| ProcessBack:Shuffle       | 141.791 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.677 ms                  | 22.706 ms                 |
| ProcessBack:UpsertPq      | 59.572 us                 | 5.536 ms                  |
| ProcessOneStep            | 164.325 ms                | 2.050 s                   |
| BlockToStepN              | 129.640 us                | 478.343 us                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:22:38.451010 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 22:22:38.923955 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
E20240130 22:22:39.451061 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 187.020 us                | 259.562 us                |
| GenInput                  | 36.510 ms                 | 49.326 ms                 |
| NN                        | 637.427 us                | 11.864 ms                 |
| Forward                   | 970.517 us                | 12.236 ms                 |
| Backward                  | 2.511 ms                  | 52.898 ms                 |
| Optimize                  | 211.959 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 177.423 us                | 2.755 ms                  |
| AfterBackward             | 164.457 ms                | 2.051 s                   |
| BlockToStepN              | 206.646 us                | 9.081 ms                  |
| OneStep                   | 216.149 ms                | 2.149 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 22:22:40.177868 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
E20240130 22:22:40.451012 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
W20240130 22:22:41.362987 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
E20240130 22:22:41.451021 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
W20240130 22:22:42.367949 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end1
E20240130 22:22:42.451089 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 121.526 us                | 5.799 ms                  |
| ProcessBack:Shuffle       | 159.103 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.477 ms                  | 22.706 ms                 |
| ProcessBack:UpsertPq      | 60.404 us                 | 5.536 ms                  |
| ProcessOneStep            | 193.962 ms                | 2.050 s                   |
| BlockToStepN              | 142.886 us                | 478.343 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
E20240130 22:22:43.451210 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:43.576731 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end5
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
E20240130 22:22:44.451185 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 186.893 us                | 259.562 us                |
| GenInput                  | 36.492 ms                 | 49.326 ms                 |
| NN                        | 635.929 us                | 11.864 ms                 |
| Forward                   | 965.465 us                | 12.236 ms                 |
| Backward                  | 2.511 ms                  | 52.898 ms                 |
| Optimize                  | 211.959 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 166.669 us                | 2.755 ms                  |
| AfterBackward             | 193.982 ms                | 2.051 s                   |
| BlockToStepN              | 221.693 us                | 9.081 ms                  |
| OneStep                   | 243.325 ms                | 2.149 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 22:22:45.366233 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
E20240130 22:22:45.451042 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
E20240130 22:22:46.451011 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 22:22:47.173550 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank2, time: 74.636, per_step: 0.746363
Step99:rank0, time: 74.636, per_step: 0.746363
Step99:rank1, time: 74.636, per_step: 0.746363
Step99:rank3, time: 74.636, per_step: 0.746364
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 185.702 us                | 259.562 us                |
| GenInput                  | 36.492 ms                 | 49.326 ms                 |
| NN                        | 635.071 us                | 11.864 ms                 |
| Forward                   | 964.837 us                | 12.236 ms                 |
| Backward                  | 2.511 ms                  | 52.898 ms                 |
| Optimize                  | 214.878 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 119.211 us                | 2.755 ms                  |
| AfterBackward             | 188.655 ms                | 2.051 s                   |
| BlockToStepN              | 223.419 us                | 12.033 ms                 |
| OneStep                   | 243.325 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
E20240130 22:22:47.451025 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 22:22:47.527675 605630 grad_async_v2.h:256] pq is empty
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 121.202 us                | 503.769 us                |
| ProcessBack:Shuffle       | 141.791 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.580 ms                  | 22.706 ms                 |
| ProcessBack:UpsertPq      | 60.284 us                 | 5.536 ms                  |
| ProcessOneStep            | 164.325 ms                | 2.050 s                   |
| BlockToStepN              | 148.270 us                | 11.984 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240130 22:22:48.451052 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
W20240130 22:22:49.158802 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end5
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
E20240130 22:22:49.451138 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 185.702 us                | 264.619 us                |
| GenInput                  | 36.477 ms                 | 49.326 ms                 |
| NN                        | 635.071 us                | 11.864 ms                 |
| Forward                   | 964.837 us                | 12.236 ms                 |
| Backward                  | 2.510 ms                  | 52.898 ms                 |
| Optimize                  | 214.301 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 113.444 us                | 2.755 ms                  |
| AfterBackward             | 188.655 ms                | 2.051 s                   |
| BlockToStepN              | 227.753 us                | 12.033 ms                 |
| OneStep                   | 222.805 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:22:50.451640 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:50.624742 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end6
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
W20240130 22:22:50.762259 605630 grad_async_v2.h:256] pq is empty
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
E20240130 22:22:51.451267 606545 parallel_pq_v2.h:76] insert failed, size(hashtable)=229
W20240130 22:22:51.805302 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
E20240130 22:22:52.451325 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 140.761 us                | 15.967 ms                 |
| ProcessBack:Shuffle       | 159.103 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.438 ms                  | 22.706 ms                 |
| ProcessBack:UpsertPq      | 61.540 us                 | 5.536 ms                  |
| ProcessOneStep            | 188.621 ms                | 2.050 s                   |
| BlockToStepN              | 164.976 us                | 11.984 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240130 22:22:53.238740 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end4
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
E20240130 22:22:53.451131 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=56
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
E20240130 22:22:54.451017 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 185.341 us                | 264.619 us                |
| GenInput                  | 36.586 ms                 | 49.326 ms                 |
| NN                        | 626.557 us                | 11.864 ms                 |
| Forward                   | 959.139 us                | 12.236 ms                 |
| Backward                  | 2.510 ms                  | 52.898 ms                 |
| Optimize                  | 214.929 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 159.980 us                | 2.978 ms                  |
| AfterBackward             | 186.527 ms                | 2.051 s                   |
| BlockToStepN              | 243.111 us                | 12.033 ms                 |
| OneStep                   | 222.805 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:22:54.760802 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
W20240130 22:22:55.119819 605630 grad_async_v2.h:256] pq is empty
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
E20240130 22:22:55.451016 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240130 22:22:56.129962 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240130 22:22:56.314013 605630 grad_async_v2.h:256] pq is empty
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
E20240130 22:22:56.451373 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:22:56.624606 605630 grad_async_v2.h:256] pq is empty
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
W20240130 22:22:56.689293 605630 grad_async_v2.h:256] pq is empty
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
W20240130 22:22:56.818156 605630 grad_async_v2.h:256] pq is empty
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240130 22:22:57.451058 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
W20240130 22:22:57.566692 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.337 us                | 1.330 ms                  |
| ProcessBack:Shuffle       | 150.643 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.309 ms                  | 22.706 ms                 |
| ProcessBack:UpsertPq      | 61.540 us                 | 5.536 ms                  |
| ProcessOneStep            | 186.499 ms                | 2.050 s                   |
| BlockToStepN              | 176.625 us                | 11.984 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240130 22:22:58.451354 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240130 22:22:58.946156 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
E20240130 22:22:59.455778 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=111
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 185.096 us                | 264.619 us                |
| GenInput                  | 36.477 ms                 | 49.326 ms                 |
| NN                        | 621.840 us                | 11.864 ms                 |
| Forward                   | 956.176 us                | 12.236 ms                 |
| Backward                  | 2.510 ms                  | 52.898 ms                 |
| Optimize                  | 209.291 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 165.796 us                | 2.978 ms                  |
| AfterBackward             | 164.457 ms                | 2.051 s                   |
| BlockToStepN              | 253.847 us                | 12.033 ms                 |
| OneStep                   | 216.149 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:23:00.224239 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
E20240130 22:23:00.457464 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=101
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
W20240130 22:23:01.338665 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
E20240130 22:23:01.457284 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
W20240130 22:23:01.841856 605630 grad_async_v2.h:256] pq is empty
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
E20240130 22:23:02.457021 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:23:02.544062 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 92.625 us                 | 5.153 ms                  |
| ProcessBack:Shuffle       | 124.729 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.275 ms                  | 22.706 ms                 |
| ProcessBack:UpsertPq      | 62.481 us                 | 5.536 ms                  |
| ProcessOneStep            | 164.325 ms                | 2.050 s                   |
| BlockToStepN              | 189.969 us                | 11.984 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240130 22:23:03.458796 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
W20240130 22:23:03.889796 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end2
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
E20240130 22:23:04.458249 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 185.096 us                | 264.619 us                |
| GenInput                  | 36.477 ms                 | 49.326 ms                 |
| NN                        | 609.604 us                | 11.864 ms                 |
| Forward                   | 956.176 us                | 12.236 ms                 |
| Backward                  | 2.511 ms                  | 52.898 ms                 |
| Optimize                  | 214.210 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 138.727 us                | 2.978 ms                  |
| AfterBackward             | 164.457 ms                | 2.051 s                   |
| BlockToStepN              | 260.199 us                | 12.033 ms                 |
| OneStep                   | 213.983 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:23:04.998579 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
E20240130 22:23:05.458014 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 22:23:06.242148 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
E20240130 22:23:06.458170 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 22:23:07.228340 605630 grad_async_v2.h:256] pq is empty
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
W20240130 22:23:07.418030 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
E20240130 22:23:07.458781 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
W20240130 22:23:08.172304 605630 grad_async_v2.h:256] pq is empty
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.025 us                | 6.230 ms                  |
| ProcessBack:Shuffle       | 134.725 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.197 ms                  | 22.706 ms                 |
| ProcessBack:UpsertPq      | 63.133 us                 | 5.536 ms                  |
| ProcessOneStep            | 173.119 ms                | 2.299 s                   |
| BlockToStepN              | 194.005 us                | 11.984 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240130 22:23:08.458010 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240130 22:23:09.096606 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
E20240130 22:23:09.458015 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 185.096 us                | 264.619 us                |
| GenInput                  | 36.477 ms                 | 45.760 ms                 |
| NN                        | 621.840 us                | 5.405 ms                  |
| Forward                   | 957.139 us                | 5.954 ms                  |
| Backward                  | 2.511 ms                  | 13.984 ms                 |
| Optimize                  | 214.301 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 89.121 us                 | 2.755 ms                  |
| AfterBackward             | 173.146 ms                | 2.299 s                   |
| BlockToStepN              | 265.967 us                | 12.033 ms                 |
| OneStep                   | 216.149 ms                | 2.344 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
E20240130 22:23:10.458071 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:23:10.541476 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end2
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
E20240130 22:23:11.458599 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240130 22:23:11.978953 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end4
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
E20240130 22:23:12.458032 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 99.558 us                 | 1.924 ms                  |
| ProcessBack:Shuffle       | 150.643 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 2.218 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 64.250 us                 | 1.210 ms                  |
| ProcessOneStep            | 192.218 ms                | 2.050 s                   |
| BlockToStepN              | 201.352 us                | 584.860 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
E20240130 22:23:13.458220 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=46
W20240130 22:23:13.726378 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end9
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
E20240130 22:23:14.458493 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 185.702 us                | 264.619 us                |
| GenInput                  | 36.469 ms                 | 47.076 ms                 |
| NN                        | 623.655 us                | 5.405 ms                  |
| Forward                   | 959.139 us                | 7.049 ms                  |
| Backward                  | 2.493 ms                  | 13.984 ms                 |
| Optimize                  | 214.210 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 83.225 us                 | 2.755 ms                  |
| AfterBackward             | 188.655 ms                | 2.051 s                   |
| BlockToStepN              | 272.739 us                | 9.081 ms                  |
| OneStep                   | 230.447 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:23:14.819422 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end0
E20240130 22:23:15.458151 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:23:15.817494 605630 grad_async_v2.h:256] pq is empty
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240130 22:23:15.955960 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end1
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
E20240130 22:23:16.458207 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
W20240130 22:23:17.174294 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
E20240130 22:23:17.458370 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.341 us                | 4.904 ms                  |
| ProcessBack:Shuffle       | 136.577 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 2.197 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 64.675 us                 | 1.210 ms                  |
| ProcessOneStep            | 186.499 ms                | 2.050 s                   |
| BlockToStepN              | 204.489 us                | 871.681 us                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:23:18.458187 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:23:18.459980 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end7
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
E20240130 22:23:19.458029 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=57
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 186.126 us                | 264.619 us                |
| GenInput                  | 36.384 ms                 | 47.076 ms                 |
| NN                        | 623.655 us                | 5.405 ms                  |
| Forward                   | 959.139 us                | 7.049 ms                  |
| Backward                  | 2.493 ms                  | 13.984 ms                 |
| Optimize                  | 214.210 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 61.810 us                 | 2.755 ms                  |
| AfterBackward             | 188.655 ms                | 2.051 s                   |
| BlockToStepN              | 282.732 us                | 9.081 ms                  |
| OneStep                   | 230.447 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 169 ========== 
W20240130 22:23:19.636811 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end0
E20240130 22:23:20.458053 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
W20240130 22:23:20.651522 605630 grad_async_v2.h:256] pq is empty
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
W20240130 22:23:21.134817 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
E20240130 22:23:21.458014 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
W20240130 22:23:22.162425 605630 grad_async_v2.h:256] pq is empty
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
E20240130 22:23:22.458326 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=107
W20240130 22:23:23.079969 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 101.261 us                | 1.385 ms                  |
| ProcessBack:Shuffle       | 150.643 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 2.309 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 64.902 us                 | 1.210 ms                  |
| ProcessOneStep            | 188.621 ms                | 2.050 s                   |
| BlockToStepN              | 214.487 us                | 871.681 us                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:23:23.458429 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
W20240130 22:23:24.273100 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end8
E20240130 22:23:24.458524 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 186.860 us                | 264.619 us                |
| GenInput                  | 36.405 ms                 | 48.081 ms                 |
| NN                        | 623.741 us                | 5.405 ms                  |
| Forward                   | 959.139 us                | 7.049 ms                  |
| Backward                  | 2.493 ms                  | 13.984 ms                 |
| Optimize                  | 213.226 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 54.613 us                 | 2.755 ms                  |
| AfterBackward             | 188.655 ms                | 2.051 s                   |
| BlockToStepN              | 294.289 us                | 9.081 ms                  |
| OneStep                   | 230.447 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
E20240130 22:23:25.458012 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:23:25.540910 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end9
W20240130 22:23:25.703169 605630 grad_async_v2.h:256] pq is empty
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
W20240130 22:23:26.076476 605630 grad_async_v2.h:256] pq is empty
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
E20240130 22:23:26.458077 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240130 22:23:26.564946 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
W20240130 22:23:26.801982 605630 grad_async_v2.h:256] pq is empty
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
E20240130 22:23:27.458514 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
W20240130 22:23:28.119751 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.907 us                | 1.023 ms                  |
| ProcessBack:Shuffle       | 150.643 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.197 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 65.485 us                 | 1.210 ms                  |
| ProcessOneStep            | 192.218 ms                | 2.050 s                   |
| BlockToStepN              | 220.026 us                | 871.681 us                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:23:28.458009 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
E20240130 22:23:29.458271 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:23:29.529044 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 187.020 us                | 264.619 us                |
| GenInput                  | 36.384 ms                 | 48.081 ms                 |
| NN                        | 623.741 us                | 5.405 ms                  |
| Forward                   | 957.139 us                | 7.049 ms                  |
| Backward                  | 2.493 ms                  | 13.984 ms                 |
| Optimize                  | 212.606 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 38.085 us                 | 2.755 ms                  |
| AfterBackward             | 193.982 ms                | 2.051 s                   |
| BlockToStepN              | 301.217 us                | 9.081 ms                  |
| OneStep                   | 238.237 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
E20240130 22:23:30.458025 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=221
W20240130 22:23:31.024333 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end1
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
E20240130 22:23:31.458012 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
E20240130 22:23:32.458151 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=55
W20240130 22:23:32.627707 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.026 us                | 5.890 ms                  |
| ProcessBack:Shuffle       | 159.103 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.275 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 65.623 us                 | 1.210 ms                  |
| ProcessOneStep            | 198.397 ms                | 2.050 s                   |
| BlockToStepN              | 227.079 us                | 871.681 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
E20240130 22:23:33.458357 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:23:33.943200 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
W20240130 22:23:34.326767 605630 grad_async_v2.h:256] pq is empty
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
E20240130 22:23:34.458011 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=116
W20240130 22:23:34.526599 605630 grad_async_v2.h:256] pq is empty
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 187.020 us                | 264.619 us                |
| GenInput                  | 36.384 ms                 | 48.081 ms                 |
| NN                        | 623.655 us                | 5.405 ms                  |
| Forward                   | 957.139 us                | 7.049 ms                  |
| Backward                  | 2.511 ms                  | 13.984 ms                 |
| Optimize                  | 213.226 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 38.085 us                 | 2.755 ms                  |
| AfterBackward             | 198.430 ms                | 2.051 s                   |
| BlockToStepN              | 309.051 us                | 9.081 ms                  |
| OneStep                   | 243.325 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
W20240130 22:23:35.242056 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end0
E20240130 22:23:35.458025 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:23:35.522969 605630 grad_async_v2.h:256] pq is empty
Step199:rank0, time: 48.131, per_step: 0.476549
Step199:rank2, time: 48.131, per_step: 0.476549
Step199:rank1, time: 48.131, per_step: 0.476549
Step199:rank3, time: 48.131, per_step: 0.476549
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 187.020 us                | 264.619 us                |
| GenInput                  | 36.384 ms                 | 48.081 ms                 |
| NN                        | 622.704 us                | 5.405 ms                  |
| Forward                   | 956.176 us                | 7.049 ms                  |
| Backward                  | 2.511 ms                  | 13.984 ms                 |
| Optimize                  | 212.606 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 38.085 us                 | 2.755 ms                  |
| AfterBackward             | 198.430 ms                | 2.051 s                   |
| BlockToStepN              | 312.886 us                | 9.081 ms                  |
| OneStep                   | 243.325 ms                | 2.149 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
E20240130 22:23:36.458387 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:23:36.751423 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
W20240130 22:23:37.082425 605630 grad_async_v2.h:256] pq is empty
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
E20240130 22:23:37.458009 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
W20240130 22:23:38.082741 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.830 us                | 5.553 ms                  |
| ProcessBack:Shuffle       | 163.588 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.182 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 66.020 us                 | 1.210 ms                  |
| ProcessOneStep            | 227.366 ms                | 2.050 s                   |
| BlockToStepN              | 234.576 us                | 871.681 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
E20240130 22:23:38.458737 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
E20240130 22:23:39.458151 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 187.135 us                | 264.619 us                |
| GenInput                  | 36.404 ms                 | 48.081 ms                 |
| NN                        | 623.741 us                | 5.405 ms                  |
| Forward                   | 959.139 us                | 7.049 ms                  |
| Backward                  | 2.494 ms                  | 13.984 ms                 |
| Optimize                  | 212.606 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 35.329 us                 | 2.755 ms                  |
| AfterBackward             | 241.142 ms                | 2.051 s                   |
| BlockToStepN              | 318.465 us                | 9.081 ms                  |
| OneStep                   | 284.492 ms                | 2.149 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:23:39.732000 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end7
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
E20240130 22:23:40.458243 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
W20240130 22:23:41.044780 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end9
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
E20240130 22:23:41.464496 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:23:42.229967 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end2
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
E20240130 22:23:42.464013 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 133.878 us                | 11.465 ms                 |
| ProcessBack:Shuffle       | 170.536 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.137 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 66.204 us                 | 1.210 ms                  |
| ProcessOneStep            | 241.119 ms                | 2.050 s                   |
| BlockToStepN              | 242.372 us                | 1.775 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:23:43.384287 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
E20240130 22:23:43.464017 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
E20240130 22:23:44.464303 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 188.950 us                | 264.619 us                |
| GenInput                  | 36.384 ms                 | 48.081 ms                 |
| NN                        | 623.741 us                | 5.405 ms                  |
| Forward                   | 959.139 us                | 7.049 ms                  |
| Backward                  | 2.493 ms                  | 13.984 ms                 |
| Optimize                  | 213.951 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 33.419 us                 | 2.755 ms                  |
| AfterBackward             | 241.142 ms                | 2.051 s                   |
| BlockToStepN              | 327.829 us                | 9.081 ms                  |
| OneStep                   | 284.492 ms                | 2.149 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
W20240130 22:23:44.952558 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end8
E20240130 22:23:45.464166 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
W20240130 22:23:46.228386 605630 grad_async_v2.h:256] pq is empty
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
W20240130 22:23:46.456413 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
E20240130 22:23:46.464286 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
E20240130 22:23:47.464232 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240130 22:23:48.110107 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 100.746 us                | 199.165 us                |
| ProcessBack:Shuffle       | 172.037 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.137 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 66.243 us                 | 1.210 ms                  |
| ProcessOneStep            | 246.160 ms                | 2.050 s                   |
| BlockToStepN              | 242.522 us                | 1.775 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:23:48.464017 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
W20240130 22:23:49.187692 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240130 22:23:49.464018 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
W20240130 22:23:49.506284 605630 grad_async_v2.h:256] pq is empty
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 188.950 us                | 264.619 us                |
| GenInput                  | 36.320 ms                 | 48.081 ms                 |
| NN                        | 623.931 us                | 5.405 ms                  |
| Forward                   | 961.368 us                | 7.049 ms                  |
| Backward                  | 2.494 ms                  | 13.984 ms                 |
| Optimize                  | 214.162 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 34.361 us                 | 2.755 ms                  |
| AfterBackward             | 249.829 ms                | 2.051 s                   |
| BlockToStepN              | 334.906 us                | 9.081 ms                  |
| OneStep                   | 291.234 ms                | 2.149 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
W20240130 22:23:50.332734 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
E20240130 22:23:50.464228 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
E20240130 22:23:51.464319 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:23:51.782552 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end9
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
E20240130 22:23:52.464702 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
W20240130 22:23:52.915673 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end1
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.840 us                | 5.780 ms                  |
| ProcessBack:Shuffle       | 186.122 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.056 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 66.260 us                 | 1.210 ms                  |
| ProcessOneStep            | 266.736 ms                | 2.050 s                   |
| BlockToStepN              | 256.956 us                | 2.777 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:23:53.464035 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=49
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
E20240130 22:23:54.464053 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=40
W20240130 22:23:54.526036 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.720 us                | 264.619 us                |
| GenInput                  | 36.384 ms                 | 48.081 ms                 |
| NN                        | 626.158 us                | 5.405 ms                  |
| Forward                   | 961.396 us                | 7.049 ms                  |
| Backward                  | 2.493 ms                  | 13.984 ms                 |
| Optimize                  | 213.951 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 33.419 us                 | 2.755 ms                  |
| AfterBackward             | 266.773 ms                | 2.051 s                   |
| BlockToStepN              | 344.707 us                | 9.081 ms                  |
| OneStep                   | 307.816 ms                | 2.149 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
E20240130 22:23:55.464016 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 22:23:55.512277 605630 grad_async_v2.h:256] pq is empty
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
W20240130 22:23:56.436543 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
E20240130 22:23:56.464008 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
E20240130 22:23:57.464037 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 22:23:57.767359 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end2
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.510 us                | 1.099 ms                  |
| ProcessBack:Shuffle       | 186.122 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 2.041 ms                  | 21.778 ms                 |
| ProcessBack:UpsertPq      | 66.425 us                 | 1.210 ms                  |
| ProcessOneStep            | 266.736 ms                | 2.050 s                   |
| BlockToStepN              | 265.331 us                | 2.777 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
E20240130 22:23:58.464018 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:23:59.253795 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end4
W20240130 22:23:59.397864 605630 grad_async_v2.h:256] pq is empty
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
E20240130 22:23:59.466092 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 188.950 us                | 264.619 us                |
| GenInput                  | 36.319 ms                 | 48.081 ms                 |
| NN                        | 623.741 us                | 5.405 ms                  |
| Forward                   | 960.868 us                | 7.049 ms                  |
| Backward                  | 2.483 ms                  | 13.984 ms                 |
| Optimize                  | 212.606 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 32.980 us                 | 2.755 ms                  |
| AfterBackward             | 266.773 ms                | 2.051 s                   |
| BlockToStepN              | 357.414 us                | 9.081 ms                  |
| OneStep                   | 307.816 ms                | 2.149 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:24:00.466418 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=27
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
W20240130 22:24:00.931106 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
E20240130 22:24:01.466061 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
W20240130 22:24:02.403915 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
E20240130 22:24:02.466305 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.088 us                | 6.194 ms                  |
| ProcessBack:Shuffle       | 173.954 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 1.995 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 66.425 us                 | 314.504 us                |
| ProcessOneStep            | 264.580 ms                | 1.939 s                   |
| BlockToStepN              | 277.079 us                | 1.775 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:24:03.466207 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:24:03.982867 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
E20240130 22:24:04.466163 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 188.950 us                | 264.149 us                |
| GenInput                  | 36.313 ms                 | 48.043 ms                 |
| NN                        | 623.741 us                | 5.322 ms                  |
| Forward                   | 961.368 us                | 5.954 ms                  |
| Backward                  | 2.477 ms                  | 13.229 ms                 |
| Optimize                  | 210.865 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 32.849 us                 | 2.744 ms                  |
| AfterBackward             | 266.773 ms                | 1.939 s                   |
| BlockToStepN              | 370.082 us                | 2.852 ms                  |
| OneStep                   | 307.816 ms                | 2.097 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:05.084558 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
E20240130 22:24:05.473429 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 22:24:06.473011 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 22:24:06.474156 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
E20240130 22:24:07.473639 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.522 us                | 5.555 ms                  |
| ProcessBack:Shuffle       | 183.718 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 1.952 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 66.450 us                 | 314.504 us                |
| ProcessOneStep            | 266.736 ms                | 1.939 s                   |
| BlockToStepN              | 292.385 us                | 2.777 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:08.277369 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end1
E20240130 22:24:08.473042 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
E20240130 22:24:09.473018 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=158
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 188.950 us                | 264.149 us                |
| GenInput                  | 36.288 ms                 | 48.043 ms                 |
| NN                        | 623.655 us                | 5.322 ms                  |
| Forward                   | 960.868 us                | 5.954 ms                  |
| Backward                  | 2.483 ms                  | 13.229 ms                 |
| Optimize                  | 210.168 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 32.849 us                 | 2.744 ms                  |
| AfterBackward             | 266.773 ms                | 1.939 s                   |
| BlockToStepN              | 373.446 us                | 3.006 ms                  |
| OneStep                   | 307.816 ms                | 2.097 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:10.026365 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end3
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
E20240130 22:24:10.473021 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
W20240130 22:24:11.058899 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end6
E20240130 22:24:11.473408 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
W20240130 22:24:12.178735 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end9
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
E20240130 22:24:12.473073 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 116.544 us                | 1.144 ms                  |
| ProcessBack:Shuffle       | 191.681 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 1.952 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 66.791 us                 | 314.504 us                |
| ProcessOneStep            | 270.263 ms                | 1.939 s                   |
| BlockToStepN              | 302.249 us                | 2.777 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:13.433195 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end1
E20240130 22:24:13.473034 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
E20240130 22:24:14.473119 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=79
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.560 us                | 264.149 us                |
| GenInput                  | 36.254 ms                 | 48.043 ms                 |
| NN                        | 623.655 us                | 5.322 ms                  |
| Forward                   | 960.868 us                | 5.954 ms                  |
| Backward                  | 2.483 ms                  | 13.229 ms                 |
| Optimize                  | 209.177 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 32.980 us                 | 2.744 ms                  |
| AfterBackward             | 272.214 ms                | 1.939 s                   |
| BlockToStepN              | 393.477 us                | 3.006 ms                  |
| OneStep                   | 310.393 ms                | 2.097 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:14.718933 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
E20240130 22:24:15.473340 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:24:16.106812 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
E20240130 22:24:16.473105 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
W20240130 22:24:17.396992 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
E20240130 22:24:17.473037 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 113.477 us                | 1.208 ms                  |
| ProcessBack:Shuffle       | 193.619 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 1.920 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 66.929 us                 | 326.066 us                |
| ProcessOneStep            | 272.177 ms                | 1.939 s                   |
| BlockToStepN              | 304.819 us                | 2.777 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
E20240130 22:24:18.473176 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:24:18.507874 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
E20240130 22:24:19.473388 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.560 us                | 264.149 us                |
| GenInput                  | 36.220 ms                 | 48.043 ms                 |
| NN                        | 623.741 us                | 5.405 ms                  |
| Forward                   | 961.368 us                | 5.981 ms                  |
| Backward                  | 2.483 ms                  | 13.229 ms                 |
| Optimize                  | 210.168 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 33.136 us                 | 2.744 ms                  |
| AfterBackward             | 272.214 ms                | 1.939 s                   |
| BlockToStepN              | 397.266 us                | 3.006 ms                  |
| OneStep                   | 310.393 ms                | 2.097 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:19.562309 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
W20240130 22:24:19.725840 605630 grad_async_v2.h:256] pq is empty
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
W20240130 22:24:20.369061 605630 grad_async_v2.h:256] pq is empty
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
E20240130 22:24:20.473013 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240130 22:24:20.692709 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240130 22:24:21.038794 605630 grad_async_v2.h:256] pq is empty
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
E20240130 22:24:21.473125 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:24:21.841442 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
E20240130 22:24:22.473057 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:24:22.987147 605630 grad_async_v2.h:256] pq is empty
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
W20240130 22:24:23.000000 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 22:24:23.145042 605630 grad_async_v2.h:256] pq is empty
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 119.970 us                | 5.472 ms                  |
| ProcessBack:Shuffle       | 223.810 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 1.794 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 67.676 us                 | 326.066 us                |
| ProcessOneStep            | 274.600 ms                | 1.939 s                   |
| BlockToStepN              | 316.656 us                | 2.918 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
E20240130 22:24:23.473017 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
W20240130 22:24:24.432752 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
E20240130 22:24:24.473033 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 189.720 us                | 264.619 us                |
| GenInput                  | 36.213 ms                 | 48.043 ms                 |
| NN                        | 623.655 us                | 5.540 ms                  |
| Forward                   | 961.368 us                | 5.981 ms                  |
| Backward                  | 2.483 ms                  | 13.229 ms                 |
| Optimize                  | 209.177 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 32.980 us                 | 2.744 ms                  |
| AfterBackward             | 272.823 ms                | 1.939 s                   |
| BlockToStepN              | 405.918 us                | 5.787 ms                  |
| OneStep                   | 315.602 ms                | 2.097 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
E20240130 22:24:25.473269 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:24:26.080125 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end8
E20240130 22:24:26.473496 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
W20240130 22:24:27.311980 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end1
W20240130 22:24:27.379525 605630 grad_async_v2.h:256] pq is empty
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
E20240130 22:24:27.473021 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.952 us                | 8.927 ms                  |
| ProcessBack:Shuffle       | 223.810 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 1.773 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 68.779 us                 | 326.066 us                |
| ProcessOneStep            | 272.757 ms                | 1.939 s                   |
| BlockToStepN              | 322.170 us                | 5.697 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
E20240130 22:24:28.473664 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=106
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
W20240130 22:24:29.331780 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end7
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
E20240130 22:24:29.473213 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.007 us                | 264.619 us                |
| GenInput                  | 36.205 ms                 | 48.081 ms                 |
| NN                        | 623.281 us                | 5.540 ms                  |
| Forward                   | 960.868 us                | 5.981 ms                  |
| Backward                  | 2.477 ms                  | 13.984 ms                 |
| Optimize                  | 209.143 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 33.031 us                 | 2.744 ms                  |
| AfterBackward             | 272.331 ms                | 1.939 s                   |
| BlockToStepN              | 411.773 us                | 6.107 ms                  |
| OneStep                   | 310.620 ms                | 2.097 s                   |
| E2E-100                   | 48.131 s                  | 54.665 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:24:30.473212 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
W20240130 22:24:30.979245 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
Step299:rank2, time: 55.779, per_step: 0.552270
Step299:rank3, time: 55.779, per_step: 0.552268
Step299:rank1, time: 55.779, per_step: 0.552268
Step299:rank0, time: 55.779, per_step: 0.552272
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 300 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.139 us                | 264.619 us                |
| GenInput                  | 36.163 ms                 | 48.081 ms                 |
| NN                        | 623.281 us                | 5.540 ms                  |
| Forward                   | 960.868 us                | 5.981 ms                  |
| Backward                  | 2.477 ms                  | 13.984 ms                 |
| Optimize                  | 209.143 us                | 497.698 us                |
| BarrierTimeBeforeRank0    | 32.980 us                 | 2.744 ms                  |
| AfterBackward             | 272.331 ms                | 1.939 s                   |
| BlockToStepN              | 418.960 us                | 6.107 ms                  |
| OneStep                   | 315.602 ms                | 2.097 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 300 ========== 
E20240130 22:24:31.473028 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
W20240130 22:24:32.269534 605630 grad_async_v2.h:256] pq is empty
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
E20240130 22:24:32.473039 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
W20240130 22:24:32.527913 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end3
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.412 us                | 5.852 ms                  |
| ProcessBack:Shuffle       | 226.589 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 1.685 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 68.929 us                 | 326.066 us                |
| ProcessOneStep            | 273.138 ms                | 1.939 s                   |
| BlockToStepN              | 334.991 us                | 5.697 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
E20240130 22:24:33.473134 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=46
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
W20240130 22:24:34.041050 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
W20240130 22:24:34.195333 605630 grad_async_v2.h:256] pq is empty
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
E20240130 22:24:34.473291 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.332 us                | 264.619 us                |
| GenInput                  | 36.133 ms                 | 48.081 ms                 |
| NN                        | 623.281 us                | 5.642 ms                  |
| Forward                   | 960.868 us                | 6.401 ms                  |
| Backward                  | 2.477 ms                  | 13.984 ms                 |
| Optimize                  | 209.143 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 32.980 us                 | 2.744 ms                  |
| AfterBackward             | 272.823 ms                | 1.939 s                   |
| BlockToStepN              | 424.211 us                | 6.107 ms                  |
| OneStep                   | 315.602 ms                | 2.097 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
E20240130 22:24:35.473192 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
W20240130 22:24:35.628852 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
E20240130 22:24:36.473565 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=55
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
W20240130 22:24:37.179152 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
E20240130 22:24:37.473459 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 76.076 us                 | 884.033 us                |
| ProcessBack:Shuffle       | 223.810 ms                | 1.453 s                   |
| ProcessBack:UpdateCache   | 1.665 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 68.779 us                 | 326.066 us                |
| ProcessOneStep            | 272.284 ms                | 1.939 s                   |
| BlockToStepN              | 340.607 us                | 5.697 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
W20240130 22:24:38.315783 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
E20240130 22:24:38.473618 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
E20240130 22:24:39.473037 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240130 22:24:39.549578 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.332 us                | 276.623 us                |
| GenInput                  | 36.140 ms                 | 48.081 ms                 |
| NN                        | 622.704 us                | 5.642 ms                  |
| Forward                   | 961.368 us                | 6.401 ms                  |
| Backward                  | 2.471 ms                  | 13.984 ms                 |
| Optimize                  | 208.863 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 32.980 us                 | 2.755 ms                  |
| AfterBackward             | 272.823 ms                | 1.939 s                   |
| BlockToStepN              | 436.370 us                | 6.107 ms                  |
| OneStep                   | 315.602 ms                | 2.097 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
E20240130 22:24:40.473383 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=30
W20240130 22:24:41.246310 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
E20240130 22:24:41.476678 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
E20240130 22:24:42.476109 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=91
W20240130 22:24:42.825886 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end8
W20240130 22:24:43.184320 605630 grad_async_v2.h:256] pq is empty
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.231 us                | 9.662 ms                  |
| ProcessBack:Shuffle       | 223.810 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.665 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 68.987 us                 | 326.066 us                |
| ProcessOneStep            | 272.284 ms                | 1.939 s                   |
| BlockToStepN              | 356.023 us                | 5.697 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:24:43.476145 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
W20240130 22:24:43.969249 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end1
W20240130 22:24:44.105686 605630 grad_async_v2.h:256] pq is empty
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
E20240130 22:24:44.476222 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.434 us                | 276.795 us                |
| GenInput                  | 36.041 ms                 | 48.081 ms                 |
| NN                        | 623.741 us                | 5.642 ms                  |
| Forward                   | 963.207 us                | 6.401 ms                  |
| Backward                  | 2.483 ms                  | 13.984 ms                 |
| Optimize                  | 208.842 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 32.455 us                 | 2.755 ms                  |
| AfterBackward             | 272.823 ms                | 1.939 s                   |
| BlockToStepN              | 444.455 us                | 6.107 ms                  |
| OneStep                   | 315.602 ms                | 2.097 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:45.366309 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
E20240130 22:24:45.476007 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
E20240130 22:24:46.476275 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:24:46.567034 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end2
E20240130 22:24:47.476085 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
W20240130 22:24:47.591382 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 135.861 us                | 1.878 ms                  |
| ProcessBack:Shuffle       | 224.957 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.637 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 68.996 us                 | 326.066 us                |
| ProcessOneStep            | 272.757 ms                | 2.050 s                   |
| BlockToStepN              | 358.432 us                | 5.697 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:48.411921 605630 grad_async_v2.h:256] pq is empty
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
E20240130 22:24:48.476047 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240130 22:24:48.745676 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
E20240130 22:24:49.476318 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.617 us                | 276.795 us                |
| GenInput                  | 35.946 ms                 | 48.081 ms                 |
| NN                        | 623.931 us                | 5.642 ms                  |
| Forward                   | 963.207 us                | 6.401 ms                  |
| Backward                  | 2.483 ms                  | 13.984 ms                 |
| Optimize                  | 208.842 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 32.455 us                 | 2.755 ms                  |
| AfterBackward             | 274.645 ms                | 2.051 s                   |
| BlockToStepN              | 446.616 us                | 6.107 ms                  |
| OneStep                   | 317.678 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:49.799346 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
W20240130 22:24:50.476729 605630 grad_async_v2.h:256] pq is empty
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
E20240130 22:24:50.495863 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:24:50.810624 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
E20240130 22:24:51.495007 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
W20240130 22:24:51.772197 605630 grad_async_v2.h:256] pq is empty
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
W20240130 22:24:51.939061 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240130 22:24:52.413065 605630 grad_async_v2.h:256] pq is empty
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
E20240130 22:24:52.495030 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
W20240130 22:24:52.690372 605630 grad_async_v2.h:256] pq is empty
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
W20240130 22:24:53.080497 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 104.319 us                | 6.833 ms                  |
| ProcessBack:Shuffle       | 252.936 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.627 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 69.083 us                 | 326.066 us                |
| ProcessOneStep            | 280.455 ms                | 2.050 s                   |
| BlockToStepN              | 358.930 us                | 5.697 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
E20240130 22:24:53.495038 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=141
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
E20240130 22:24:54.495472 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.441 us                | 278.142 us                |
| GenInput                  | 35.814 ms                 | 48.081 ms                 |
| NN                        | 623.655 us                | 5.642 ms                  |
| Forward                   | 961.368 us                | 6.401 ms                  |
| Backward                  | 2.483 ms                  | 13.984 ms                 |
| Optimize                  | 208.842 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 31.745 us                 | 2.755 ms                  |
| AfterBackward             | 280.503 ms                | 2.051 s                   |
| BlockToStepN              | 448.263 us                | 6.107 ms                  |
| OneStep                   | 324.357 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:54.859370 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
E20240130 22:24:55.495013 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=74
W20240130 22:24:56.243659 605630 grad_async_v2.h:256] pq is empty
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
E20240130 22:24:56.495014 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240130 22:24:56.850703 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end8
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
E20240130 22:24:57.495361 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 86.210 us                 | 1.523 ms                  |
| ProcessBack:Shuffle       | 257.153 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.627 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 69.276 us                 | 326.066 us                |
| ProcessOneStep            | 282.178 ms                | 2.050 s                   |
| BlockToStepN              | 363.137 us                | 5.697 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:24:58.314654 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end9
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
E20240130 22:24:58.495040 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
E20240130 22:24:59.495106 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:24:59.500458 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.807 us                | 276.795 us                |
| GenInput                  | 35.946 ms                 | 48.081 ms                 |
| NN                        | 623.655 us                | 5.540 ms                  |
| Forward                   | 961.396 us                | 5.981 ms                  |
| Backward                  | 2.477 ms                  | 13.229 ms                 |
| Optimize                  | 208.842 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 31.151 us                 | 2.744 ms                  |
| AfterBackward             | 282.222 ms                | 1.939 s                   |
| BlockToStepN              | 452.964 us                | 5.787 ms                  |
| OneStep                   | 324.540 ms                | 2.097 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
E20240130 22:25:00.495018 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:25:01.281522 605630 grad_async_v2.h:256] pq is empty
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
E20240130 22:25:01.495025 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
W20240130 22:25:01.711627 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end9
E20240130 22:25:02.495035 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:25:02.533054 605630 grad_async_v2.h:256] pq is empty
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
W20240130 22:25:02.993773 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.749 us                | 3.789 ms                  |
| ProcessBack:Shuffle       | 257.153 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.618 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 69.467 us                 | 314.504 us                |
| ProcessOneStep            | 283.087 ms                | 1.939 s                   |
| BlockToStepN              | 369.755 us                | 2.918 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:25:03.495288 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:25:04.025185 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
E20240130 22:25:04.495432 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 190.842 us                | 276.795 us                |
| GenInput                  | 35.946 ms                 | 48.478 ms                 |
| NN                        | 623.741 us                | 5.642 ms                  |
| Forward                   | 963.207 us                | 6.401 ms                  |
| Backward                  | 2.477 ms                  | 13.229 ms                 |
| Optimize                  | 208.821 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 31.151 us                 | 2.744 ms                  |
| AfterBackward             | 283.176 ms                | 1.939 s                   |
| BlockToStepN              | 457.508 us                | 5.787 ms                  |
| OneStep                   | 324.540 ms                | 2.097 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
W20240130 22:25:05.056444 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end2
E20240130 22:25:05.495033 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
W20240130 22:25:06.174835 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end3
E20240130 22:25:06.495010 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
W20240130 22:25:07.480158 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
E20240130 22:25:07.500809 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 124.388 us                | 4.895 ms                  |
| ProcessBack:Shuffle       | 257.153 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.614 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 69.474 us                 | 318.038 us                |
| ProcessOneStep            | 283.087 ms                | 2.050 s                   |
| BlockToStepN              | 375.249 us                | 2.918 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:25:08.500427 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
W20240130 22:25:08.990197 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end0
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
E20240130 22:25:09.500034 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 191.019 us                | 276.795 us                |
| GenInput                  | 35.870 ms                 | 48.478 ms                 |
| NN                        | 623.931 us                | 5.642 ms                  |
| Forward                   | 964.098 us                | 6.401 ms                  |
| Backward                  | 2.483 ms                  | 13.229 ms                 |
| Optimize                  | 208.821 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 32.129 us                 | 2.755 ms                  |
| AfterBackward             | 282.222 ms                | 2.051 s                   |
| BlockToStepN              | 460.513 us                | 9.081 ms                  |
| OneStep                   | 324.357 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
E20240130 22:25:10.500229 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:25:10.848961 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end2
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
E20240130 22:25:11.500038 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=95
E20240130 22:25:12.500304 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:25:12.762172 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.800 us                | 11.015 ms                 |
| ProcessBack:Shuffle       | 257.153 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.606 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 69.474 us                 | 318.038 us                |
| ProcessOneStep            | 283.087 ms                | 2.050 s                   |
| BlockToStepN              | 382.892 us                | 6.646 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:25:13.500042 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
E20240130 22:25:14.500319 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 191.564 us                | 276.795 us                |
| GenInput                  | 35.896 ms                 | 48.478 ms                 |
| NN                        | 623.931 us                | 5.642 ms                  |
| Forward                   | 964.098 us                | 6.401 ms                  |
| Backward                  | 2.483 ms                  | 13.229 ms                 |
| Optimize                  | 208.799 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 31.296 us                 | 2.755 ms                  |
| AfterBackward             | 282.222 ms                | 2.051 s                   |
| BlockToStepN              | 469.173 us                | 11.229 ms                 |
| OneStep                   | 324.357 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:25:14.568684 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end1
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
E20240130 22:25:15.500435 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240130 22:25:16.035925 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
E20240130 22:25:16.500051 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
W20240130 22:25:17.134341 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
E20240130 22:25:17.500101 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 100.856 us                | 6.342 ms                  |
| ProcessBack:Shuffle       | 257.153 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.618 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 69.474 us                 | 318.038 us                |
| ProcessOneStep            | 283.087 ms                | 2.050 s                   |
| BlockToStepN              | 389.732 us                | 11.125 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240130 22:25:18.249351 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
E20240130 22:25:18.500098 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
E20240130 22:25:19.500066 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=34
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 192.025 us                | 278.142 us                |
| GenInput                  | 35.946 ms                 | 48.478 ms                 |
| NN                        | 625.845 us                | 5.642 ms                  |
| Forward                   | 964.837 us                | 6.401 ms                  |
| Backward                  | 2.493 ms                  | 13.229 ms                 |
| Optimize                  | 208.863 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 31.745 us                 | 2.755 ms                  |
| AfterBackward             | 283.176 ms                | 2.051 s                   |
| BlockToStepN              | 475.143 us                | 11.229 ms                 |
| OneStep                   | 324.540 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:25:19.714576 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end0
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
E20240130 22:25:20.500033 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
W20240130 22:25:20.708377 605630 grad_async_v2.h:256] pq is empty
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
W20240130 22:25:20.838704 605630 grad_async_v2.h:256] pq is empty
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
W20240130 22:25:21.246008 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end7
E20240130 22:25:21.500007 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
E20240130 22:25:22.500021 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
W20240130 22:25:22.661089 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 97.017 us                 | 5.377 ms                  |
| ProcessBack:Shuffle       | 252.936 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.626 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 69.753 us                 | 318.038 us                |
| ProcessOneStep            | 282.178 ms                | 2.050 s                   |
| BlockToStepN              | 396.353 us                | 11.125 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240130 22:25:23.500078 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
W20240130 22:25:23.932248 605630 grad_async_v2.h:256] pq is empty
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
W20240130 22:25:24.100656 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end9
E20240130 22:25:24.500650 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 192.459 us                | 280.179 us                |
| GenInput                  | 35.896 ms                 | 49.326 ms                 |
| NN                        | 626.672 us                | 5.642 ms                  |
| Forward                   | 966.384 us                | 6.401 ms                  |
| Backward                  | 2.477 ms                  | 13.229 ms                 |
| Optimize                  | 208.863 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 31.745 us                 | 2.865 ms                  |
| AfterBackward             | 282.222 ms                | 2.051 s                   |
| BlockToStepN              | 479.031 us                | 11.229 ms                 |
| OneStep                   | 324.357 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:25:25.220567 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
E20240130 22:25:25.500422 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
W20240130 22:25:26.354591 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240130 22:25:26.500092 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240130 22:25:26.528271 605630 grad_async_v2.h:256] pq is empty
Step399:rank3, time: 55.225, per_step: 0.546786
Step399:rank2, time: 55.225, per_step: 0.546786
Step399:rank1, time: 55.225, per_step: 0.546786
Step399:rank0, time: 55.225, per_step: 0.546786
========== Step 400 ========== 
========== Step 400 ========== 
========== Step 400 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 192.221 us                | 280.179 us                |
| GenInput                  | 35.896 ms                 | 49.326 ms                 |
| NN                        | 626.672 us                | 5.642 ms                  |
| Forward                   | 966.384 us                | 6.401 ms                  |
| Backward                  | 2.477 ms                  | 13.229 ms                 |
| Optimize                  | 208.863 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 31.296 us                 | 2.865 ms                  |
| AfterBackward             | 283.176 ms                | 2.051 s                   |
| BlockToStepN              | 479.031 us                | 11.229 ms                 |
| OneStep                   | 324.540 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 400 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
E20240130 22:25:27.500219 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:25:27.505121 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.205 us                | 11.279 ms                 |
| ProcessBack:Shuffle       | 262.018 ms                | 1.462 s                   |
| ProcessBack:UpdateCache   | 1.618 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 69.769 us                 | 318.038 us                |
| ProcessOneStep            | 284.376 ms                | 2.050 s                   |
| BlockToStepN              | 397.752 us                | 11.125 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
E20240130 22:25:28.500016 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=63
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
W20240130 22:25:28.789093 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end6
E20240130 22:25:29.500021 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 192.579 us                | 280.179 us                |
| GenInput                  | 35.946 ms                 | 49.326 ms                 |
| NN                        | 626.686 us                | 5.642 ms                  |
| Forward                   | 966.978 us                | 6.401 ms                  |
| Backward                  | 2.477 ms                  | 13.229 ms                 |
| Optimize                  | 208.863 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 31.151 us                 | 2.865 ms                  |
| AfterBackward             | 284.409 ms                | 2.051 s                   |
| BlockToStepN              | 480.766 us                | 11.229 ms                 |
| OneStep                   | 328.248 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
W20240130 22:25:30.206142 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end9
E20240130 22:25:30.500610 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
E20240130 22:25:31.500044 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
W20240130 22:25:31.810927 606534 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end3
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
W20240130 22:25:32.397409 605630 grad_async_v2.h:256] pq is empty
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
E20240130 22:25:32.500094 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=123
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
W20240130 22:25:33.052728 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.566 us                | 6.394 ms                  |
| ProcessBack:Shuffle       | 257.153 ms                | 1.462 s                   |
| ProcessBack:UpdateCache   | 1.606 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 69.805 us                 | 318.038 us                |
| ProcessOneStep            | 283.087 ms                | 2.050 s                   |
| BlockToStepN              | 401.837 us                | 11.125 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240130 22:25:33.500308 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 22:25:34.181685 605630 grad_async_v2.h:256] pq is empty
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
W20240130 22:25:34.374147 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end8
E20240130 22:25:34.500020 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 192.594 us                | 280.179 us                |
| GenInput                  | 35.896 ms                 | 49.326 ms                 |
| NN                        | 626.557 us                | 5.642 ms                  |
| Forward                   | 966.384 us                | 6.401 ms                  |
| Backward                  | 2.470 ms                  | 13.229 ms                 |
| Optimize                  | 208.821 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 30.941 us                 | 2.978 ms                  |
| AfterBackward             | 284.409 ms                | 2.051 s                   |
| BlockToStepN              | 489.961 us                | 11.229 ms                 |
| OneStep                   | 324.540 ms                | 2.149 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:25:35.500236 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:25:35.500522 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end8
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
E20240130 22:25:36.500783 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=149
W20240130 22:25:36.644538 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240130 22:25:37.273492 605630 grad_async_v2.h:256] pq is empty
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
E20240130 22:25:37.500357 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=337
W20240130 22:25:37.905478 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.015 us                | 5.582 ms                  |
| ProcessBack:Shuffle       | 257.153 ms                | 1.462 s                   |
| ProcessBack:UpdateCache   | 1.603 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 69.775 us                 | 318.038 us                |
| ProcessOneStep            | 284.376 ms                | 2.244 s                   |
| BlockToStepN              | 410.972 us                | 11.125 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
E20240130 22:25:38.500128 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
W20240130 22:25:39.020902 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
E20240130 22:25:39.500264 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 192.725 us                | 280.179 us                |
| GenInput                  | 35.870 ms                 | 49.326 ms                 |
| NN                        | 626.672 us                | 5.642 ms                  |
| Forward                   | 967.280 us                | 6.401 ms                  |
| Backward                  | 2.479 ms                  | 13.229 ms                 |
| Optimize                  | 208.842 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 30.941 us                 | 3.268 ms                  |
| AfterBackward             | 284.409 ms                | 2.244 s                   |
| BlockToStepN              | 492.053 us                | 11.229 ms                 |
| OneStep                   | 324.540 ms                | 2.297 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
W20240130 22:25:40.135886 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end7
E20240130 22:25:40.500049 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
E20240130 22:25:41.500093 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
W20240130 22:25:42.307117 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end1
E20240130 22:25:42.500025 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.365 us                | 5.380 ms                  |
| ProcessBack:Shuffle       | 262.575 ms                | 1.462 s                   |
| ProcessBack:UpdateCache   | 1.594 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 69.952 us                 | 318.038 us                |
| ProcessOneStep            | 288.861 ms                | 2.244 s                   |
| BlockToStepN              | 420.010 us                | 11.125 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240130 22:25:43.452737 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end2
E20240130 22:25:43.500011 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
E20240130 22:25:44.500483 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 193.270 us                | 280.179 us                |
| GenInput                  | 35.887 ms                 | 49.326 ms                 |
| NN                        | 629.099 us                | 5.642 ms                  |
| Forward                   | 969.302 us                | 6.401 ms                  |
| Backward                  | 2.488 ms                  | 13.229 ms                 |
| Optimize                  | 208.899 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 31.296 us                 | 3.268 ms                  |
| AfterBackward             | 288.897 ms                | 2.244 s                   |
| BlockToStepN              | 503.433 us                | 11.229 ms                 |
| OneStep                   | 328.639 ms                | 2.297 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
W20240130 22:25:44.657892 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
W20240130 22:25:45.304760 605630 grad_async_v2.h:256] pq is empty
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
E20240130 22:25:45.500010 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
W20240130 22:25:45.914091 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240130 22:25:46.129631 605630 grad_async_v2.h:256] pq is empty
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
E20240130 22:25:46.500221 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240130 22:25:47.276219 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
E20240130 22:25:47.500247 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 101.633 us                | 199.961 us                |
| ProcessBack:Shuffle       | 257.153 ms                | 1.462 s                   |
| ProcessBack:UpdateCache   | 1.591 ms                  | 20.686 ms                 |
| ProcessBack:UpsertPq      | 70.096 us                 | 318.038 us                |
| ProcessOneStep            | 284.376 ms                | 2.244 s                   |
| BlockToStepN              | 429.922 us                | 11.125 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240130 22:25:48.354668 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240130 22:25:48.355319 605630 grad_async_v2.h:256] pq is empty
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
E20240130 22:25:48.500128 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 22:25:49.181645 605630 grad_async_v2.h:256] pq is empty
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
W20240130 22:25:49.372691 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240130 22:25:49.500118 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 193.592 us                | 280.179 us                |
| GenInput                  | 35.814 ms                 | 49.326 ms                 |
| NN                        | 629.181 us                | 5.642 ms                  |
| Forward                   | 970.517 us                | 6.401 ms                  |
| Backward                  | 2.484 ms                  | 13.229 ms                 |
| Optimize                  | 208.842 us                | 1.424 ms                  |
| BarrierTimeBeforeRank0    | 31.151 us                 | 3.268 ms                  |
| AfterBackward             | 284.557 ms                | 2.244 s                   |
| BlockToStepN              | 508.525 us                | 11.229 ms                 |
| OneStep                   | 328.248 ms                | 2.297 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:25:49.861683 605630 grad_async_v2.h:256] pq is empty
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
E20240130 22:25:50.508318 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
W20240130 22:25:50.737203 606534 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end0
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
E20240130 22:25:51.508016 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:25:51.879390 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end1
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
E20240130 22:25:52.508066 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
W20240130 22:25:52.908272 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.591 us                | 7.063 ms                  |
| ProcessBack:Shuffle       | 257.153 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.590 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 70.096 us                 | 314.504 us                |
| ProcessOneStep            | 283.087 ms                | 2.180 s                   |
| BlockToStepN              | 432.151 us                | 6.646 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:25:53.508496 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
W20240130 22:25:54.452785 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end6
E20240130 22:25:54.508121 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 193.860 us                | 278.142 us                |
| GenInput                  | 35.887 ms                 | 48.478 ms                 |
| NN                        | 629.099 us                | 5.540 ms                  |
| Forward                   | 970.517 us                | 6.241 ms                  |
| Backward                  | 2.493 ms                  | 9.664 ms                  |
| Optimize                  | 208.863 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 31.296 us                 | 2.978 ms                  |
| AfterBackward             | 283.176 ms                | 2.181 s                   |
| BlockToStepN              | 519.214 us                | 9.081 ms                  |
| OneStep                   | 324.357 ms                | 2.226 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:25:55.508713 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
W20240130 22:25:56.185089 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
E20240130 22:25:56.508029 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=15
W20240130 22:25:56.771008 605630 grad_async_v2.h:256] pq is empty
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
W20240130 22:25:56.828258 605630 grad_async_v2.h:256] pq is empty
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
E20240130 22:25:57.508028 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
W20240130 22:25:57.529456 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
W20240130 22:25:58.109813 605630 grad_async_v2.h:256] pq is empty
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
W20240130 22:25:58.217408 605630 grad_async_v2.h:256] pq is empty
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 123.645 us                | 11.654 ms                 |
| ProcessBack:Shuffle       | 252.936 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.591 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 69.952 us                 | 314.504 us                |
| ProcessOneStep            | 282.178 ms                | 2.180 s                   |
| BlockToStepN              | 437.618 us                | 6.646 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:25:58.508251 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:25:58.855998 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end5
E20240130 22:25:59.508035 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 193.860 us                | 278.142 us                |
| GenInput                  | 35.954 ms                 | 48.478 ms                 |
| NN                        | 629.123 us                | 5.540 ms                  |
| Forward                   | 970.600 us                | 6.241 ms                  |
| Backward                  | 2.495 ms                  | 9.664 ms                  |
| Optimize                  | 209.143 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 31.296 us                 | 2.978 ms                  |
| AfterBackward             | 282.222 ms                | 2.181 s                   |
| BlockToStepN              | 526.427 us                | 9.081 ms                  |
| OneStep                   | 322.663 ms                | 2.226 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
W20240130 22:26:00.171098 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end7
E20240130 22:26:00.508129 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
E20240130 22:26:01.508325 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:26:01.538264 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
E20240130 22:26:02.508039 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=38
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.828 us                | 8.583 ms                  |
| ProcessBack:Shuffle       | 242.435 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.591 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 69.952 us                 | 314.504 us                |
| ProcessOneStep            | 280.455 ms                | 2.180 s                   |
| BlockToStepN              | 447.346 us                | 6.646 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:26:03.318533 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end5
E20240130 22:26:03.508013 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
E20240130 22:26:04.508016 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 193.961 us                | 286.338 us                |
| GenInput                  | 35.953 ms                 | 48.478 ms                 |
| NN                        | 629.181 us                | 5.540 ms                  |
| Forward                   | 971.011 us                | 6.241 ms                  |
| Backward                  | 2.494 ms                  | 9.664 ms                  |
| Optimize                  | 209.143 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 32.129 us                 | 2.978 ms                  |
| AfterBackward             | 282.222 ms                | 2.181 s                   |
| BlockToStepN              | 530.131 us                | 9.081 ms                  |
| OneStep                   | 322.663 ms                | 2.226 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:26:04.620934 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
E20240130 22:26:05.508673 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:26:06.194505 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240130 22:26:06.361127 605630 grad_async_v2.h:256] pq is empty
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
E20240130 22:26:06.508164 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=44
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
W20240130 22:26:07.506181 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240130 22:26:07.508004 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 22:26:07.839368 605630 grad_async_v2.h:256] pq is empty
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 98.171 us                 | 4.934 ms                  |
| ProcessBack:Shuffle       | 252.936 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.591 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 69.952 us                 | 314.504 us                |
| ProcessOneStep            | 283.087 ms                | 2.180 s                   |
| BlockToStepN              | 451.102 us                | 6.646 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:26:08.484647 605630 grad_async_v2.h:256] pq is empty
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
E20240130 22:26:08.508073 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=109
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
W20240130 22:26:08.669152 606534 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end2
E20240130 22:26:09.508248 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 193.961 us                | 286.338 us                |
| GenInput                  | 35.946 ms                 | 48.478 ms                 |
| NN                        | 629.523 us                | 5.540 ms                  |
| Forward                   | 972.323 us                | 6.241 ms                  |
| Backward                  | 2.495 ms                  | 9.664 ms                  |
| Optimize                  | 209.291 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 32.455 us                 | 2.978 ms                  |
| AfterBackward             | 283.176 ms                | 2.181 s                   |
| BlockToStepN              | 531.314 us                | 9.081 ms                  |
| OneStep                   | 324.357 ms                | 2.226 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:26:10.074299 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end2
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
E20240130 22:26:10.508142 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
W20240130 22:26:11.203480 606534 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240130 22:26:11.508064 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 22:26:11.698302 605630 grad_async_v2.h:256] pq is empty
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
E20240130 22:26:12.509464 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=50
W20240130 22:26:12.528923 606534 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.268 us                | 6.111 ms                  |
| ProcessBack:Shuffle       | 257.153 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.591 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 69.952 us                 | 314.504 us                |
| ProcessOneStep            | 284.520 ms                | 2.180 s                   |
| BlockToStepN              | 455.217 us                | 6.646 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 22:26:13.509460 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240130 22:26:13.653507 605630 grad_async_v2.h:256] pq is empty
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
W20240130 22:26:13.671985 606534 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
W20240130 22:26:14.388370 605630 grad_async_v2.h:256] pq is empty
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
E20240130 22:26:14.509322 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=15
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 194.321 us                | 290.972 us                |
| GenInput                  | 35.946 ms                 | 48.478 ms                 |
| NN                        | 630.938 us                | 5.540 ms                  |
| Forward                   | 972.967 us                | 6.241 ms                  |
| Backward                  | 2.510 ms                  | 9.664 ms                  |
| Optimize                  | 209.291 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 32.455 us                 | 2.978 ms                  |
| AfterBackward             | 288.897 ms                | 2.181 s                   |
| BlockToStepN              | 542.105 us                | 9.081 ms                  |
| OneStep                   | 328.639 ms                | 2.226 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:26:14.715278 606534 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
W20240130 22:26:15.039568 605630 grad_async_v2.h:256] pq is empty
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
E20240130 22:26:15.509320 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:26:15.698300 605630 grad_async_v2.h:256] pq is empty
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
W20240130 22:26:15.865846 606534 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240130 22:26:16.359493 605630 grad_async_v2.h:256] pq is empty
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
E20240130 22:26:16.509060 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=79
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
W20240130 22:26:16.907987 606534 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
E20240130 22:26:17.509054 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 161.763 us                | 6.848 ms                  |
| ProcessBack:Shuffle       | 262.018 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.574 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 69.984 us                 | 314.504 us                |
| ProcessOneStep            | 288.861 ms                | 2.180 s                   |
| BlockToStepN              | 458.799 us                | 6.646 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:26:18.237404 606534 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end6
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
E20240130 22:26:18.512409 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
Step499:rank1, time: 52.254, per_step: 0.517363
Step499:rank2, time: 52.254, per_step: 0.517363
Step499:rank3, time: 52.254, per_step: 0.517364
Step499:rank0, time: 52.254, per_step: 0.517363
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 194.159 us                | 290.972 us                |
| GenInput                  | 35.946 ms                 | 48.478 ms                 |
| NN                        | 629.181 us                | 5.540 ms                  |
| Forward                   | 971.011 us                | 6.241 ms                  |
| Backward                  | 2.510 ms                  | 9.664 ms                  |
| Optimize                  | 208.899 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 32.849 us                 | 2.978 ms                  |
| AfterBackward             | 284.409 ms                | 2.181 s                   |
| BlockToStepN              | 549.300 us                | 9.081 ms                  |
| OneStep                   | 328.248 ms                | 2.226 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:26:18.782904 605630 grad_async_v2.h:89] call StopThreads. PID = 605630
W20240130 22:26:18.782927 605630 grad_base.h:212] before processOneStepNegThread_.join();
W20240130 22:26:18.782970 605630 grad_base.h:214] after processOneStepNegThread_.join();
W20240130 22:26:18.782976 605630 grad_async_v2.h:91] call GradProcessingBase::StopThreads.
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
E20240130 22:26:19.512022 606534 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 194.159 us                | 290.972 us                |
| GenInput                  | 35.946 ms                 | 48.478 ms                 |
| NN                        | 629.181 us                | 5.540 ms                  |
| Forward                   | 971.011 us                | 6.241 ms                  |
| Backward                  | 2.510 ms                  | 9.664 ms                  |
| Optimize                  | 208.899 us                | 1.035 ms                  |
| BarrierTimeBeforeRank0    | 32.849 us                 | 2.978 ms                  |
| AfterBackward             | 284.409 ms                | 2.181 s                   |
| BlockToStepN              | 549.300 us                | 9.081 ms                  |
| OneStep                   | 324.540 ms                | 2.226 s                   |
| E2E-100                   | 54.665 s                  | 55.780 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:26:20.020233 605630 grad_async_v2.h:110] StopThreads done.
timer name is E2E-100
ERROR [605630 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7f63019b46d0>
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.538 us                | 200.695 us                |
| ProcessBack:Shuffle       | 254.917 ms                | 1.461 s                   |
| ProcessBack:UpdateCache   | 1.574 ms                  | 20.388 ms                 |
| ProcessBack:UpsertPq      | 69.984 us                 | 314.504 us                |
| ProcessOneStep            | 284.376 ms                | 2.180 s                   |
| BlockToStepN              | 459.083 us                | 6.646 ms                  |
+---------------------------+---------------------------+---------------------------+
