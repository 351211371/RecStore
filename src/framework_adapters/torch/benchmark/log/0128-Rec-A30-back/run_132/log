WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 22:16:23.222359 535561 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240130 22:16:23.223743 535561 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:151: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [535561 perf_rec_model.py:151] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fec14ab1120>==========
Worker 1 pid=535704
Worker 2 pid=535706
INFO [535561 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [535706 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [535708 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [535704 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [535706 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [535704 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [535708 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240130 22:16:25.504381 535706 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 22:16:25.504549 535704 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 22:16:25.504586 535708 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [535561 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240130 22:16:25.513247 535561 IPCTensor.h:348] IPCTensor full_emb already exists
W20240130 22:16:25.517596 535561 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [3376257, 32]; dev=0; size=412.1 MB
W20240130 22:16:25.517838 535708 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [3376257, 32]; dev=3; size=412.1 MB
W20240130 22:16:25.518702 535706 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [3376257, 32]; dev=2; size=412.1 MB
W20240130 22:16:25.519459 535704 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [3376257, 32]; dev=1; size=412.1 MB
W20240130 22:16:25.522224 535561 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100101974000 7.629 MB
W20240130 22:16:25.522356 535561 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1001028ba000 7.629 MB
W20240130 22:16:25.522341 535708 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100102117000 7.629 MB
W20240130 22:16:25.522383 535706 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10010305d000 7.629 MB
W20240130 22:16:25.522415 535561 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100103800000 122.1 MB
W20240130 22:16:25.522473 535561 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10010b9b7000 122.1 MB
W20240130 22:16:25.522452 535704 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10010b214000 7.629 MB
W20240130 22:16:25.522549 535561 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 22:16:25.522641 535708 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1001133cb000 7.629 MB
W20240130 22:16:25.522673 535706 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100113b6e000 7.629 MB
W20240130 22:16:25.522706 535704 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100114311000 7.629 MB
W20240130 22:16:25.522740 535708 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100114ab4000 122.1 MB
W20240130 22:16:25.522761 535706 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10011c4c8000 122.1 MB
W20240130 22:16:25.522820 535708 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100123edc000 122.1 MB
W20240130 22:16:25.522831 535704 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10012b8f0000 122.1 MB
W20240130 22:16:25.522840 535706 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x100133304000 122.1 MB
W20240130 22:16:25.522904 535708 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240130 22:16:25.522955 535706 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240130 22:16:25.522966 535704 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10013ad18000 122.1 MB
W20240130 22:16:25.523036 535561 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 22:16:25.523059 535704 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240130 22:16:25.524757 535708 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240130 22:16:25.524766 535706 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240130 22:16:25.524839 535704 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
Worker 3 pid=535708
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 3376257), (3376257, 6752514), (6752514, 10128771), (10128771, 13505028)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240130 22:16:31.370919 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10014273c000 7.629 MB
W20240130 22:16:31.371114 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100142edf000 7.629 MB
W20240130 22:16:31.371162 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100143682000 7.629 MB
W20240130 22:16:31.371201 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100143e25000 7.629 MB
W20240130 22:16:31.371228 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1001445c8000 7.629 MB
W20240130 22:16:31.371263 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100144d6b000 7.629 MB
W20240130 22:16:31.371299 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10014550e000 7.629 MB
W20240130 22:16:31.371364 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100145cb1000 7.629 MB
W20240130 22:16:31.371403 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x100146454000 7.629 MB
W20240130 22:16:31.371439 535704 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100146bf7000 7.629 MB
W20240130 22:16:31.371472 535704 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10014739a000 80 B 
W20240130 22:16:31.371505 535704 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10014739c000 8 B 
W20240130 22:16:31.371529 535704 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10014739e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:16:31.371871 535704 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240130 22:16:31.389755 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1001473a0000 7.629 MB
W20240130 22:16:31.389886 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100147b43000 7.629 MB
W20240130 22:16:31.389918 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1001482e6000 7.629 MB
W20240130 22:16:31.389946 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100148a89000 7.629 MB
W20240130 22:16:31.389964 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10014922c000 7.629 MB
W20240130 22:16:31.389991 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1001499cf000 7.629 MB
W20240130 22:16:31.390019 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10014a172000 7.629 MB
W20240130 22:16:31.390071 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10014a915000 7.629 MB
W20240130 22:16:31.390098 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10014b0b8000 7.629 MB
W20240130 22:16:31.390125 535706 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10014b85b000 7.629 MB
W20240130 22:16:31.390151 535706 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10014bffe000 80 B 
W20240130 22:16:31.390172 535706 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10014c000000 8 B 
W20240130 22:16:31.390188 535706 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10014c002000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:16:31.390425 535706 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 22:16:31.803802 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10014c004000 7.629 MB
W20240130 22:16:31.803956 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10014c7a7000 7.629 MB
W20240130 22:16:31.803997 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10014cf4a000 7.629 MB
W20240130 22:16:31.804021 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10014d6ed000 7.629 MB
W20240130 22:16:31.804039 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10014de90000 7.629 MB
W20240130 22:16:31.804066 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10014e633000 7.629 MB
W20240130 22:16:31.804095 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10014edd6000 7.629 MB
W20240130 22:16:31.804138 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10014f579000 7.629 MB
W20240130 22:16:31.804167 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10014fd1c000 7.629 MB
W20240130 22:16:31.804220 535708 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1001504bf000 7.629 MB
W20240130 22:16:31.804250 535708 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x100150c62000 80 B 
W20240130 22:16:31.804271 535708 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x100150c64000 8 B 
W20240130 22:16:31.804293 535708 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100150c66000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:16:31.804616 535708 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 22:16:31.911706 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100150c68000 7.629 MB
W20240130 22:16:31.911845 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10015140b000 7.629 MB
W20240130 22:16:31.911871 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100151bae000 7.629 MB
W20240130 22:16:31.911902 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100152351000 7.629 MB
W20240130 22:16:31.911921 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100152af4000 7.629 MB
W20240130 22:16:31.911944 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100153297000 7.629 MB
W20240130 22:16:31.911960 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100153a3a000 7.629 MB
W20240130 22:16:31.911990 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1001541dd000 7.629 MB
W20240130 22:16:31.912011 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100154980000 7.629 MB
W20240130 22:16:31.912030 535561 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x100155123000 7.629 MB
W20240130 22:16:31.912050 535561 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1001558c6000 80 B 
W20240130 22:16:31.912070 535561 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1001558c8000 8 B 
W20240130 22:16:31.912099 535561 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1001558ca000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240130 22:16:31.912315 535561 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 22:16:31.913576 535561 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240130 22:16:31.913662 535561 grad_base.h:184] Init GradProcessingBase done
I20240130 22:16:34.020610 535561 grad_async_v2.h:43] Use main thread to update emb.
W20240130 22:16:34.020865 535561 kg_controller.h:78] after init GradAsyncProcessingV2
I20240130 22:16:34.020876 535561 kg_controller.h:84] Construct KGCacheController done
E20240130 22:16:34.354995 535704 recstore.cc:66] init folly done
E20240130 22:16:34.354997 535561 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240130 22:16:34.355067 535706 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240130 22:16:34.355078 535708 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240130 22:16:34.355705 535561 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 22:16:35.351653 536455 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 22:16:35.351996 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 22:16:36.351019 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 22:16:36.354138 536455 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
Before Training
Before Training
I20240130 22:16:38.639619 535708 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240130 22:16:38.639645 535561 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
Before Training
I20240130 22:16:38.641793 535704 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240130 22:16:38.641817 535706 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
W20240130 22:16:38.643040 536455 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 22:16:38.643178 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 130.842 us                | 229.553 us                |
| ProcessBack:Shuffle       | 175.922 ms                | 175.922 ms                |
+---------------------------+---------------------------+---------------------------+
E20240130 22:16:39.900590 536540 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:16:39.948779 535561 grad_async_v2.h:269] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240130 22:16:40.009195 536455 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
INFO [535706 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [535704 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [535561 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [535708 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
W20240130 22:16:40.767273 535561 grad_async_v2.h:256] pq is empty
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
E20240130 22:16:40.900092 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
W20240130 22:16:41.085182 536455 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
W20240130 22:16:41.185312 535561 grad_async_v2.h:256] pq is empty
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240130 22:16:41.632531 535561 grad_async_v2.h:256] pq is empty
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240130 22:16:41.900014 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 93.922 us                 | 2.348 ms                  |
| GenInput                  | 287.329 us                | 2.489 ms                  |
| NN                        | 516.618 us                | 105.715 ms                |
| Forward                   | 725.883 us                | 106.706 ms                |
| Backward                  | 1.345 ms                  | 745.841 ms                |
| Optimize                  | 190.460 us                | 9.223 ms                  |
| BarrierTimeBeforeRank0    | 35.796 us                 | 18.102 ms                 |
| AfterBackward             | 69.109 ms                 | 1.076 s                   |
| BlockToStepN              | 82.510 us                 | 59.594 ms                 |
| OneStep                   | 72.639 ms                 | 1.367 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
W20240130 22:16:42.189054 536455 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
W20240130 22:16:42.226224 535561 grad_async_v2.h:256] pq is empty
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
E20240130 22:16:42.900023 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
W20240130 22:16:43.211066 536455 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end1
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
E20240130 22:16:43.900020 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 134.349 us                | 350.016 us                |
| ProcessBack:Shuffle       | 57.781 ms                 | 175.922 ms                |
| ProcessBack:UpdateCache   | 6.177 ms                  | 775.236 ms                |
| ProcessBack:UpsertPq      | 51.931 us                 | 47.679 ms                 |
| ProcessOneStep            | 66.269 ms                 | 1.076 s                   |
| BlockToStepN              | 76.880 us                 | 59.264 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
W20240130 22:16:44.400880 536455 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
E20240130 22:16:44.900007 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
W20240130 22:16:45.599085 536455 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
E20240130 22:16:45.900046 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
W20240130 22:16:46.848906 536455 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
E20240130 22:16:46.908180 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=74
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 103.934 us                | 148.855 us                |
| GenInput                  | 295.080 us                | 912.052 us                |
| NN                        | 487.266 us                | 1.570 ms                  |
| Forward                   | 691.067 us                | 1.845 ms                  |
| Backward                  | 1.354 ms                  | 93.480 ms                 |
| Optimize                  | 190.389 us                | 1.151 ms                  |
| BarrierTimeBeforeRank0    | 25.433 us                 | 1.068 ms                  |
| AfterBackward             | 62.635 ms                 | 275.665 ms                |
| BlockToStepN              | 161.724 us                | 286.437 us                |
| OneStep                   | 67.126 ms                 | 758.752 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
W20240130 22:16:47.119230 535561 grad_async_v2.h:256] pq is empty
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
W20240130 22:16:47.240797 535561 grad_async_v2.h:256] pq is empty
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
E20240130 22:16:47.908039 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
W20240130 22:16:48.128010 536455 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
E20240130 22:16:48.908233 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
Step99:rank3, time: 22.114, per_step: 0.221135
Step99:rank0, time: 22.113, per_step: 0.221134
Step99:rank2, time: 22.113, per_step: 0.221135
Step99:rank1, time: 22.113, per_step: 0.221135
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 97.371 us                 | 148.855 us                |
| GenInput                  | 298.565 us                | 927.335 us                |
| NN                        | 470.709 us                | 1.570 ms                  |
| Forward                   | 657.772 us                | 1.845 ms                  |
| Backward                  | 1.326 ms                  | 93.480 ms                 |
| Optimize                  | 180.558 us                | 1.151 ms                  |
| BarrierTimeBeforeRank0    | 35.796 us                 | 1.068 ms                  |
| AfterBackward             | 58.636 ms                 | 381.275 ms                |
| BlockToStepN              | 178.514 us                | 5.358 ms                  |
| OneStep                   | 62.208 ms                 | 758.752 ms                |
| E2E-100                   | 10.323 s                  | 10.323 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
W20240130 22:16:49.264797 536455 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end5
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 125.885 us                | 288.880 us                |
| ProcessBack:Shuffle       | 54.993 ms                 | 78.908 ms                 |
| ProcessBack:UpdateCache   | 6.183 ms                  | 18.973 ms                 |
| ProcessBack:UpsertPq      | 42.993 us                 | 89.448 us                 |
| ProcessOneStep            | 58.732 ms                 | 381.235 ms                |
| BlockToStepN              | 134.959 us                | 5.315 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
E20240130 22:16:49.908056 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240130 22:16:50.321768 536455 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end4
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
W20240130 22:16:50.494505 535561 grad_async_v2.h:256] pq is empty
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
E20240130 22:16:50.908031 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 22:16:51.406294 536455 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240130 22:16:51.507562 535561 grad_async_v2.h:256] pq is empty
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
E20240130 22:16:51.908285 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 96.364 us                 | 148.855 us                |
| GenInput                  | 306.485 us                | 927.335 us                |
| NN                        | 465.345 us                | 1.570 ms                  |
| Forward                   | 650.836 us                | 1.845 ms                  |
| Backward                  | 1.318 ms                  | 93.480 ms                 |
| Optimize                  | 174.541 us                | 1.151 ms                  |
| BarrierTimeBeforeRank0    | 75.803 us                 | 1.068 ms                  |
| AfterBackward             | 58.707 ms                 | 840.990 ms                |
| BlockToStepN              | 201.586 us                | 5.358 ms                  |
| OneStep                   | 61.914 ms                 | 844.322 ms                |
| E2E-100                   | 10.323 s                  | 10.323 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
W20240130 22:16:52.477169 536455 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
E20240130 22:16:52.908075 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
W20240130 22:16:53.568056 535561 grad_async_v2.h:256] pq is empty
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240130 22:16:53.702533 536455 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end4
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240130 22:16:53.908017 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.634 us                | 268.020 us                |
| ProcessBack:Shuffle       | 56.415 ms                 | 78.908 ms                 |
| ProcessBack:UpdateCache   | 5.642 ms                  | 18.973 ms                 |
| ProcessBack:UpsertPq      | 42.546 us                 | 183.574 us                |
| ProcessOneStep            | 58.732 ms                 | 840.923 ms                |
| BlockToStepN              | 169.190 us                | 5.315 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
W20240130 22:16:54.765408 536455 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end3
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
E20240130 22:16:54.908052 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
W20240130 22:16:55.067881 535561 grad_async_v2.h:256] pq is empty
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240130 22:16:55.778805 536455 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
E20240130 22:16:55.908593 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
W20240130 22:16:56.135741 535561 grad_async_v2.h:256] pq is empty
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
W20240130 22:16:56.202491 535561 grad_async_v2.h:256] pq is empty
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
E20240130 22:16:56.908037 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 95.389 us                 | 138.922 us                |
| GenInput                  | 305.816 us                | 1.019 ms                  |
| NN                        | 459.270 us                | 1.535 ms                  |
| Forward                   | 646.683 us                | 1.739 ms                  |
| Backward                  | 1.311 ms                  | 3.004 ms                  |
| Optimize                  | 174.541 us                | 673.501 us                |
| BarrierTimeBeforeRank0    | 75.803 us                 | 1.019 ms                  |
| AfterBackward             | 58.636 ms                 | 810.434 ms                |
| BlockToStepN              | 246.368 us                | 611.062 us                |
| OneStep                   | 61.925 ms                 | 813.599 ms                |
| E2E-100                   | 10.323 s                  | 10.323 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:16:57.076948 536455 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end2
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
E20240130 22:16:57.908015 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
W20240130 22:16:58.187430 536455 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
W20240130 22:16:58.224798 535561 grad_async_v2.h:256] pq is empty
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
W20240130 22:16:58.287561 535561 grad_async_v2.h:256] pq is empty
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
W20240130 22:16:58.603636 535561 grad_async_v2.h:256] pq is empty
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
W20240130 22:16:58.845199 535561 grad_async_v2.h:256] pq is empty
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
E20240130 22:16:58.908118 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
W20240130 22:16:59.196333 536455 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
W20240130 22:16:59.355165 535561 grad_async_v2.h:256] pq is empty
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.494 us                | 222.916 us                |
| ProcessBack:Shuffle       | 56.160 ms                 | 78.786 ms                 |
| ProcessBack:UpdateCache   | 1.805 ms                  | 17.400 ms                 |
| ProcessBack:UpsertPq      | 42.835 us                 | 89.448 us                 |
| ProcessOneStep            | 58.400 ms                 | 840.923 ms                |
| BlockToStepN              | 215.693 us                | 564.903 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
W20240130 22:16:59.531533 535561 grad_async_v2.h:256] pq is empty
Step199:rank3, time: 10.569, per_step: 0.104645
Step199:rank0, time: 10.569, per_step: 0.104644
Step199:rank2, time: 10.569, per_step: 0.104644
Step199:rank1, time: 10.569, per_step: 0.104644
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 93.733 us                 | 138.922 us                |
| GenInput                  | 304.519 us                | 1.019 ms                  |
| NN                        | 455.351 us                | 1.535 ms                  |
| Forward                   | 637.028 us                | 1.739 ms                  |
| Backward                  | 1.306 ms                  | 4.222 ms                  |
| Optimize                  | 169.178 us                | 673.501 us                |
| BarrierTimeBeforeRank0    | 85.137 us                 | 1.068 ms                  |
| AfterBackward             | 58.419 ms                 | 840.990 ms                |
| BlockToStepN              | 264.959 us                | 614.708 us                |
| OneStep                   | 61.853 ms                 | 844.322 ms                |
| E2E-100                   | 10.323 s                  | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
E20240130 22:16:59.908244 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
W20240130 22:17:00.358896 536455 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
W20240130 22:17:00.516820 535561 grad_async_v2.h:256] pq is empty
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
E20240130 22:17:00.908015 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
W20240130 22:17:01.578518 536455 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
E20240130 22:17:01.908015 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 93.431 us                 | 148.855 us                |
| GenInput                  | 293.899 us                | 1.197 ms                  |
| NN                        | 450.715 us                | 1.535 ms                  |
| Forward                   | 628.115 us                | 1.739 ms                  |
| Backward                  | 1.302 ms                  | 4.222 ms                  |
| Optimize                  | 165.978 us                | 673.501 us                |
| BarrierTimeBeforeRank0    | 73.813 us                 | 1.068 ms                  |
| AfterBackward             | 58.286 ms                 | 840.990 ms                |
| BlockToStepN              | 277.192 us                | 5.358 ms                  |
| OneStep                   | 61.641 ms                 | 844.322 ms                |
| E2E-100                   | 10.323 s                  | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:17:01.918459 535561 grad_async_v2.h:256] pq is empty
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
W20240130 22:17:02.773092 536455 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
W20240130 22:17:02.865473 535561 grad_async_v2.h:256] pq is empty
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
E20240130 22:17:02.908159 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
W20240130 22:17:02.986271 535561 grad_async_v2.h:256] pq is empty
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
W20240130 22:17:03.722564 535561 grad_async_v2.h:256] pq is empty
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
E20240130 22:17:03.908023 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 22:17:04.010440 536455 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 96.500 us                 | 231.415 us                |
| ProcessBack:Shuffle       | 55.761 ms                 | 70.927 ms                 |
| ProcessBack:UpdateCache   | 1.896 ms                  | 12.978 ms                 |
| ProcessBack:UpsertPq      | 42.479 us                 | 85.774 us                 |
| ProcessOneStep            | 58.213 ms                 | 810.393 ms                |
| BlockToStepN              | 248.451 us                | 649.665 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
E20240130 22:17:04.908010 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
W20240130 22:17:05.088573 536455 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end1
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
W20240130 22:17:05.569700 535561 grad_async_v2.h:256] pq is empty
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
E20240130 22:17:05.908020 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
W20240130 22:17:06.188477 536455 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
W20240130 22:17:06.871596 535561 grad_async_v2.h:256] pq is empty
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
E20240130 22:17:06.908010 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 93.733 us                 | 147.984 us                |
| GenInput                  | 289.563 us                | 1.019 ms                  |
| NN                        | 452.302 us                | 1.151 ms                  |
| Forward                   | 632.011 us                | 1.581 ms                  |
| Backward                  | 1.306 ms                  | 4.222 ms                  |
| Optimize                  | 167.567 us                | 306.855 us                |
| BarrierTimeBeforeRank0    | 47.710 us                 | 1.068 ms                  |
| AfterBackward             | 58.127 ms                 | 810.434 ms                |
| BlockToStepN              | 321.317 us                | 863.952 us                |
| OneStep                   | 61.573 ms                 | 813.599 ms                |
| E2E-100                   | 10.323 s                  | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
W20240130 22:17:07.400840 536455 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
Step299:rank1, time: 7.967, per_step: 0.078885
Step299:rank2, time: 7.967, per_step: 0.078885
Step299:rank3, time: 7.967, per_step: 0.078885
Step299:rank0, time: 7.967, per_step: 0.078885
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 300 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 93.553 us                 | 147.984 us                |
| GenInput                  | 287.195 us                | 1.019 ms                  |
| NN                        | 452.302 us                | 1.151 ms                  |
| Forward                   | 632.675 us                | 1.581 ms                  |
| Backward                  | 1.311 ms                  | 4.222 ms                  |
| Optimize                  | 167.008 us                | 306.855 us                |
| BarrierTimeBeforeRank0    | 42.482 us                 | 1.068 ms                  |
| AfterBackward             | 58.127 ms                 | 810.434 ms                |
| BlockToStepN              | 322.484 us                | 863.952 us                |
| OneStep                   | 61.632 ms                 | 813.599 ms                |
| E2E-100                   | 10.323 s                  | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 300 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
W20240130 22:17:07.619849 535561 grad_async_v2.h:256] pq is empty
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
E20240130 22:17:07.908175 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
W20240130 22:17:08.016813 535561 grad_async_v2.h:256] pq is empty
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
W20240130 22:17:08.479844 535561 grad_async_v2.h:256] pq is empty
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
W20240130 22:17:08.540261 535561 grad_async_v2.h:256] pq is empty
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
W20240130 22:17:08.568635 536455 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end5
W20240130 22:17:08.598803 535561 grad_async_v2.h:256] pq is empty
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
E20240130 22:17:08.908016 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.976 us                | 211.122 us                |
| ProcessBack:Shuffle       | 55.477 ms                 | 70.927 ms                 |
| ProcessBack:UpdateCache   | 4.356 ms                  | 12.978 ms                 |
| ProcessBack:UpsertPq      | 43.199 us                 | 85.774 us                 |
| ProcessOneStep            | 58.007 ms                 | 810.393 ms                |
| BlockToStepN              | 283.871 us                | 819.055 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
W20240130 22:17:09.632844 536455 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end6
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
W20240130 22:17:09.721925 535561 grad_async_v2.h:256] pq is empty
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
E20240130 22:17:09.908071 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
W20240130 22:17:10.128235 535561 grad_async_v2.h:256] pq is empty
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
W20240130 22:17:10.653898 536455 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
W20240130 22:17:10.679350 535561 grad_async_v2.h:256] pq is empty
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
E20240130 22:17:10.908042 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
W20240130 22:17:11.472689 535561 grad_async_v2.h:256] pq is empty
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
W20240130 22:17:11.828884 536455 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
E20240130 22:17:11.908355 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 95.389 us                 | 147.928 us                |
| GenInput                  | 277.736 us                | 927.335 us                |
| NN                        | 455.351 us                | 835.850 us                |
| Forward                   | 639.319 us                | 1.130 ms                  |
| Backward                  | 1.321 ms                  | 3.004 ms                  |
| Optimize                  | 172.379 us                | 269.973 us                |
| BarrierTimeBeforeRank0    | 31.888 us                 | 1.068 ms                  |
| AfterBackward             | 58.127 ms                 | 810.434 ms                |
| BlockToStepN              | 361.067 us                | 956.072 us                |
| OneStep                   | 61.542 ms                 | 813.599 ms                |
| E2E-100                   | 10.323 s                  | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
W20240130 22:17:12.158625 535561 grad_async_v2.h:256] pq is empty
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
E20240130 22:17:12.908198 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
W20240130 22:17:13.010104 535561 grad_async_v2.h:256] pq is empty
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
W20240130 22:17:13.149967 536455 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
E20240130 22:17:13.908025 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
W20240130 22:17:14.292440 536455 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.802 us                | 265.142 us                |
| ProcessBack:Shuffle       | 55.688 ms                 | 69.044 ms                 |
| ProcessBack:UpdateCache   | 3.301 ms                  | 12.581 ms                 |
| ProcessBack:UpsertPq      | 44.078 us                 | 85.186 us                 |
| ProcessOneStep            | 58.213 ms                 | 603.934 ms                |
| BlockToStepN              | 333.203 us                | 819.055 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
W20240130 22:17:14.440546 535561 grad_async_v2.h:256] pq is empty
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
E20240130 22:17:14.908082 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
W20240130 22:17:15.661332 536455 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240130 22:17:15.703253 535561 grad_async_v2.h:256] pq is empty
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
E20240130 22:17:15.908047 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
Step399:rank1, time: 8.655, per_step: 0.085698
========== Step 400 ========== 
Step399:rank2, time: 8.655, per_step: 0.085698
Step399:rank0, time: 8.655, per_step: 0.085697
Step399:rank3, time: 8.655, per_step: 0.085698
========== Step 400 ========== 
========== Step 400 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 95.582 us                 | 147.928 us                |
| GenInput                  | 278.706 us                | 1.006 ms                  |
| NN                        | 457.392 us                | 835.850 us                |
| Forward                   | 642.840 us                | 1.130 ms                  |
| Backward                  | 1.323 ms                  | 4.222 ms                  |
| Optimize                  | 172.990 us                | 275.768 us                |
| BarrierTimeBeforeRank0    | 31.888 us                 | 1.068 ms                  |
| AfterBackward             | 58.172 ms                 | 603.969 ms                |
| BlockToStepN              | 391.205 us                | 863.952 us                |
| OneStep                   | 61.641 ms                 | 758.752 ms                |
| E2E-100                   | 8.656 s                   | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 400 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
W20240130 22:17:16.690681 536455 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
E20240130 22:17:16.908385 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 95.529 us                 | 147.928 us                |
| GenInput                  | 280.484 us                | 1.006 ms                  |
| NN                        | 457.392 us                | 835.850 us                |
| Forward                   | 642.840 us                | 1.130 ms                  |
| Backward                  | 1.322 ms                  | 4.222 ms                  |
| Optimize                  | 172.361 us                | 275.768 us                |
| BarrierTimeBeforeRank0    | 33.846 us                 | 1.068 ms                  |
| AfterBackward             | 58.154 ms                 | 603.969 ms                |
| BlockToStepN              | 394.629 us                | 863.952 us                |
| OneStep                   | 61.632 ms                 | 758.752 ms                |
| E2E-100                   | 8.656 s                   | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
W20240130 22:17:17.837709 536455 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
E20240130 22:17:17.908010 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
W20240130 22:17:18.110987 535561 grad_async_v2.h:256] pq is empty
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
W20240130 22:17:18.204784 535561 grad_async_v2.h:256] pq is empty
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
E20240130 22:17:18.908597 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
W20240130 22:17:19.112937 536455 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end7
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 126.225 us                | 557.408 us                |
| ProcessBack:Shuffle       | 55.584 ms                 | 69.044 ms                 |
| ProcessBack:UpdateCache   | 3.357 ms                  | 12.581 ms                 |
| ProcessBack:UpsertPq      | 44.633 us                 | 85.186 us                 |
| ProcessOneStep            | 58.056 ms                 | 603.934 ms                |
| BlockToStepN              | 364.503 us                | 819.055 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
W20240130 22:17:19.675379 535561 grad_async_v2.h:256] pq is empty
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
E20240130 22:17:19.910920 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
W20240130 22:17:20.128773 536455 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end7
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
E20240130 22:17:20.910020 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
W20240130 22:17:21.130976 536455 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
W20240130 22:17:21.303597 535561 grad_async_v2.h:256] pq is empty
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
W20240130 22:17:21.363739 535561 grad_async_v2.h:256] pq is empty
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
E20240130 22:17:21.910115 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 95.874 us                 | 147.928 us                |
| GenInput                  | 277.554 us                | 927.335 us                |
| NN                        | 458.887 us                | 805.017 us                |
| Forward                   | 644.715 us                | 1.101 ms                  |
| Backward                  | 1.325 ms                  | 4.222 ms                  |
| Optimize                  | 171.608 us                | 275.768 us                |
| BarrierTimeBeforeRank0    | 30.336 us                 | 1.064 ms                  |
| AfterBackward             | 58.073 ms                 | 575.975 ms                |
| BlockToStepN              | 427.923 us                | 863.952 us                |
| OneStep                   | 61.539 ms                 | 606.966 ms                |
| E2E-100                   | 8.656 s                   | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:17:22.138546 536455 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end6
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
W20240130 22:17:22.405268 535561 grad_async_v2.h:256] pq is empty
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
W20240130 22:17:22.576964 535561 grad_async_v2.h:256] pq is empty
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
E20240130 22:17:22.910010 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 22:17:23.222729 536455 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
E20240130 22:17:23.910043 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 99.864 us                 | 232.893 us                |
| ProcessBack:Shuffle       | 55.538 ms                 | 68.392 ms                 |
| ProcessBack:UpdateCache   | 3.985 ms                  | 12.470 ms                 |
| ProcessBack:UpsertPq      | 45.255 us                 | 85.186 us                 |
| ProcessOneStep            | 58.105 ms                 | 575.935 ms                |
| BlockToStepN              | 393.794 us                | 819.055 us                |
+---------------------------+---------------------------+---------------------------+
W20240130 22:17:24.454622 536455 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
E20240130 22:17:24.910647 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
W20240130 22:17:25.580986 536455 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end8
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
Step499:rank2, time: 9.581, per_step: 0.094860
Step499:rank1, time: 9.581, per_step: 0.094863
Step499:rank3, time: 9.581, per_step: 0.094856
Step499:rank0, time: 9.581, per_step: 0.094859
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 96.034 us                 | 147.928 us                |
| GenInput                  | 277.554 us                | 956.776 us                |
| NN                        | 462.049 us                | 835.850 us                |
| Forward                   | 649.113 us                | 1.130 ms                  |
| Backward                  | 1.330 ms                  | 4.222 ms                  |
| Optimize                  | 172.361 us                | 275.768 us                |
| BarrierTimeBeforeRank0    | 28.897 us                 | 1.064 ms                  |
| AfterBackward             | 58.127 ms                 | 603.969 ms                |
| BlockToStepN              | 443.226 us                | 871.996 us                |
| OneStep                   | 61.714 ms                 | 758.752 ms                |
| E2E-100                   | 9.581 s                   | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 22:17:25.737452 535561 grad_async_v2.h:89] call StopThreads. PID = 535561
W20240130 22:17:25.737474 535561 grad_base.h:212] before processOneStepNegThread_.join();
W20240130 22:17:25.737514 535561 grad_base.h:214] after processOneStepNegThread_.join();
W20240130 22:17:25.737521 535561 grad_async_v2.h:91] call GradProcessingBase::StopThreads.
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
E20240130 22:17:25.910460 536455 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 22:17:26.606870 535561 grad_async_v2.h:110] StopThreads done.
timer name is E2E-100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 96.034 us                 | 147.928 us                |
| GenInput                  | 277.554 us                | 956.776 us                |
| NN                        | 462.049 us                | 835.850 us                |
| Forward                   | 649.113 us                | 1.130 ms                  |
| Backward                  | 1.330 ms                  | 4.222 ms                  |
| Optimize                  | 172.361 us                | 275.768 us                |
| BarrierTimeBeforeRank0    | 28.897 us                 | 1.064 ms                  |
| AfterBackward             | 58.127 ms                 | 603.969 ms                |
| BlockToStepN              | 443.226 us                | 871.996 us                |
| OneStep                   | 61.714 ms                 | 758.752 ms                |
| E2E-100                   | 9.581 s                   | 10.569 s                  |
+---------------------------+---------------------------+---------------------------+
ERROR [535561 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7fecc971dd50>
Successfully xmh
