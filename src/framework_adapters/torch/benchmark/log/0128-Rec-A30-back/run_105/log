WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 21:31:42.795769 209715 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240130 21:31:42.797493 209715 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:151: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [209715 perf_rec_model.py:151] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f8391635120>==========
Worker 1 pid=209860
Worker 2 pid=209862
INFO [209715 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [209860 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [209862 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [209862 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [209860 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [209864 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [209715 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240130 21:31:46.058249 209862 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 21:31:46.058414 209860 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 21:31:46.058777 209715 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [209864 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240130 21:31:46.059718 209864 IPCTensor.h:348] IPCTensor full_emb already exists
W20240130 21:31:46.066812 209860 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240130 21:31:46.067003 209715 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240130 21:31:46.067174 209862 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [472460, 32]; dev=2; size=57.67 MB
W20240130 21:31:46.067879 209864 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [472460, 32]; dev=3; size=57.67 MB
W20240130 21:31:46.068449 209860 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10004817d000 7.629 MB
W20240130 21:31:46.068715 209860 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100048924000 7.629 MB
W20240130 21:31:46.068742 209715 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000490c7000 7.629 MB
W20240130 21:31:46.068768 209862 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10004986a000 7.629 MB
W20240130 21:31:46.068868 209860 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10004a00f000 122.1 MB
W20240130 21:31:46.068939 209715 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100051a23000 7.629 MB
W20240130 21:31:46.068975 209860 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000521c6000 122.1 MB
W20240130 21:31:46.069013 209862 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100059bda000 7.629 MB
W20240130 21:31:46.069027 209715 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10005a37d000 122.1 MB
W20240130 21:31:46.069067 209860 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240130 21:31:46.069110 209715 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100061d91000 122.1 MB
W20240130 21:31:46.069137 209862 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1000697a5000 122.1 MB
W20240130 21:31:46.069183 209715 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 21:31:46.069186 209864 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000711b9000 7.629 MB
W20240130 21:31:46.069221 209862 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10007195c000 122.1 MB
W20240130 21:31:46.069358 209862 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240130 21:31:46.069449 209864 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100079370000 7.629 MB
W20240130 21:31:46.069550 209864 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100079b13000 122.1 MB
W20240130 21:31:46.069622 209864 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100081527000 122.1 MB
W20240130 21:31:46.069681 209864 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240130 21:31:46.071331 209715 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 21:31:46.071377 209860 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240130 21:31:46.071390 209862 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240130 21:31:46.071398 209864 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
Worker 3 pid=209864
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920), (944920, 1417380), (1417380, 1889840)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240130 21:31:49.988513 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100088f4b000 7.629 MB
W20240130 21:31:49.988682 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000896ee000 7.629 MB
W20240130 21:31:49.988709 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100089e91000 7.629 MB
W20240130 21:31:49.988732 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10008a634000 7.629 MB
W20240130 21:31:49.988760 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10008add7000 7.629 MB
W20240130 21:31:49.988795 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10008b57a000 7.629 MB
W20240130 21:31:49.988817 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10008bd1d000 7.629 MB
W20240130 21:31:49.988853 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10008c4c0000 7.629 MB
W20240130 21:31:49.988875 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10008cc63000 7.629 MB
W20240130 21:31:49.988900 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10008d406000 7.629 MB
W20240130 21:31:49.988926 209864 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10008dba9000 80 B 
W20240130 21:31:49.988950 209864 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10008dbab000 8 B 
W20240130 21:31:49.988966 209864 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10008dbad000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240130 21:31:49.989274 209864 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240130 21:31:50.302855 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10008dbaf000 7.629 MB
W20240130 21:31:50.302978 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10008e352000 7.629 MB
W20240130 21:31:50.303006 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10008eaf5000 7.629 MB
W20240130 21:31:50.303031 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10008f298000 7.629 MB
W20240130 21:31:50.303056 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10008fa3b000 7.629 MB
W20240130 21:31:50.303084 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000901de000 7.629 MB
W20240130 21:31:50.303107 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x100090981000 7.629 MB
W20240130 21:31:50.303157 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100091124000 7.629 MB
W20240130 21:31:50.303182 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000918c7000 7.629 MB
W20240130 21:31:50.303226 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10009206a000 7.629 MB
W20240130 21:31:50.303249 209862 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10009280d000 80 B 
W20240130 21:31:50.303272 209862 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10009280f000 8 B 
W20240130 21:31:50.303290 209862 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100092811000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240130 21:31:50.303529 209862 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 21:31:50.330440 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100092813000 7.629 MB
W20240130 21:31:50.330575 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100092fb6000 7.629 MB
W20240130 21:31:50.330600 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100093759000 7.629 MB
W20240130 21:31:50.330626 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100093efc000 7.629 MB
W20240130 21:31:50.330648 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10009469f000 7.629 MB
W20240130 21:31:50.330675 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100094e42000 7.629 MB
W20240130 21:31:50.330704 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000955e5000 7.629 MB
W20240130 21:31:50.330741 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100095d88000 7.629 MB
W20240130 21:31:50.330761 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10009652b000 7.629 MB
W20240130 21:31:50.330785 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100096cce000 7.629 MB
W20240130 21:31:50.330808 209860 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x100097471000 80 B 
W20240130 21:31:50.330832 209860 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100097473000 8 B 
W20240130 21:31:50.330848 209860 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100097475000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240130 21:31:50.331077 209860 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 21:31:50.439054 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100097477000 7.629 MB
W20240130 21:31:50.439204 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100097c1a000 7.629 MB
W20240130 21:31:50.439239 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000983bd000 7.629 MB
W20240130 21:31:50.439267 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100098b60000 7.629 MB
W20240130 21:31:50.439291 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100099303000 7.629 MB
W20240130 21:31:50.439312 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100099aa6000 7.629 MB
W20240130 21:31:50.439332 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10009a249000 7.629 MB
W20240130 21:31:50.439363 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10009a9ec000 7.629 MB
W20240130 21:31:50.439383 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10009b18f000 7.629 MB
W20240130 21:31:50.439407 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10009b932000 7.629 MB
W20240130 21:31:50.439445 209715 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10009c0d5000 80 B 
W20240130 21:31:50.439479 209715 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10009c0d7000 8 B 
W20240130 21:31:50.439530 209715 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10009c0d9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240130 21:31:50.439872 209715 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 21:31:50.441356 209715 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240130 21:31:50.441473 209715 grad_base.h:184] Init GradProcessingBase done
I20240130 21:31:51.118446 209715 grad_async_v2.h:43] Use main thread to update emb.
W20240130 21:31:51.118711 209715 kg_controller.h:78] after init GradAsyncProcessingV2
I20240130 21:31:51.118721 209715 kg_controller.h:84] Construct KGCacheController done
E20240130 21:31:51.490669 209860 recstore.cc:66] init folly done
E20240130 21:31:51.490671 209715 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240130 21:31:51.490882 209862 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240130 21:31:51.490940 209864 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
I20240130 21:31:51.491616 209715 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 21:31:52.268680 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 21:31:52.276235 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 21:31:53.276043 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:31:53.370312 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
E20240130 21:31:54.276018 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240130 21:31:54.447597 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
E20240130 21:31:55.276363 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:31:55.561225 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240130 21:31:56.276074 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=74
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 135.679 us                | 241.577 us                |
+---------------------------+---------------------------+---------------------------+
W20240130 21:31:56.718937 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240130 21:31:57.276245 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
Before Training
Before Training
Before Training
I20240130 21:31:58.480958 209862 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240130 21:31:58.480991 209860 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240130 21:31:58.481032 209715 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240130 21:31:58.481220 209864 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
W20240130 21:31:58.494001 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 21:31:58.494307 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 21:31:59.863461 211520 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:00.321687 209715 grad_async_v2.h:269] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 184.686 us                | 184.686 us                |
| GenInput                  | 27.887 ms                 | 27.887 ms                 |
| NN                        | 119.393 ms                | 119.393 ms                |
| Forward                   | 121.906 ms                | 121.906 ms                |
| Backward                  | 132.624 ms                | 132.624 ms                |
| Optimize                  | 9.241 ms                  | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 34.411 ms                 | 34.411 ms                 |
| AfterBackward             | 1.513 s                   | 1.513 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240130 21:32:00.573770 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
INFO [209715 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [209864 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [209862 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [209860 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
E20240130 21:32:00.863073 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:32:01.407742 209715 grad_async_v2.h:256] pq is empty
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 141.048 us                | 1.480 ms                  |
| ProcessBack:Shuffle       | 347.423 ms                | 698.890 ms                |
| ProcessBack:UpdateCache   | 1.982 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 62.567 us                 | 458.673 ms                |
| ProcessOneStep            | 701.031 ms                | 1.512 s                   |
| BlockToStepN              | 82.453 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
W20240130 21:32:01.732637 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
E20240130 21:32:01.863037 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
E20240130 21:32:02.863190 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:02.978873 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
W20240130 21:32:03.008762 209715 grad_async_v2.h:256] pq is empty
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
E20240130 21:32:03.863073 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:03.982173 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end9
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240130 21:32:04.863044 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.241 us                | 264.933 us                |
| GenInput                  | 36.164 ms                 | 46.080 ms                 |
| NN                        | 598.636 us                | 119.393 ms                |
| Forward                   | 862.815 us                | 121.906 ms                |
| Backward                  | 3.222 ms                  | 132.624 ms                |
| Optimize                  | 199.243 us                | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 352.997 us                | 34.411 ms                 |
| AfterBackward             | 260.002 ms                | 1.513 s                   |
| BlockToStepN              | 148.191 us                | 228.064 ms                |
| OneStep                   | 303.160 ms                | 2.069 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:05.630636 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end4
E20240130 21:32:05.863106 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 131.706 us                | 293.806 us                |
| ProcessBack:Shuffle       | 259.041 ms                | 1.307 s                   |
| ProcessBack:UpdateCache   | 1.520 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 51.717 us                 | 458.673 ms                |
| ProcessOneStep            | 259.960 ms                | 1.512 s                   |
| BlockToStepN              | 57.367 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240130 21:32:06.863306 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=128
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
W20240130 21:32:06.970168 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end9
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
E20240130 21:32:07.863059 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=146
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240130 21:32:08.863054 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:09.039261 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
E20240130 21:32:09.863320 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:10.004447 209715 grad_async_v2.h:256] pq is empty
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
W20240130 21:32:10.157974 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.241 us                | 264.933 us                |
| GenInput                  | 36.164 ms                 | 46.080 ms                 |
| NN                        | 596.282 us                | 119.393 ms                |
| Forward                   | 862.815 us                | 121.906 ms                |
| Backward                  | 1.867 ms                  | 132.624 ms                |
| Optimize                  | 196.650 us                | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 556.479 us                | 34.411 ms                 |
| AfterBackward             | 160.883 ms                | 1.513 s                   |
| BlockToStepN              | 148.191 us                | 228.064 ms                |
| OneStep                   | 200.769 ms                | 2.069 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:10.863112 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:11.272512 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
W20240130 21:32:11.360296 209715 grad_async_v2.h:256] pq is empty
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 127.100 us                | 227.170 us                |
| ProcessBack:Shuffle       | 159.162 ms                | 1.307 s                   |
| ProcessBack:UpdateCache   | 1.982 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 59.177 us                 | 458.673 ms                |
| ProcessOneStep            | 250.324 ms                | 1.512 s                   |
| BlockToStepN              | 81.211 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
E20240130 21:32:11.863021 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=283
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
E20240130 21:32:12.863118 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=50
W20240130 21:32:12.957051 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
W20240130 21:32:13.775382 209715 grad_async_v2.h:256] pq is empty
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
E20240130 21:32:13.863097 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:14.785179 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
E20240130 21:32:14.863029 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:15.152961 209715 grad_async_v2.h:256] pq is empty
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.623 us                | 264.933 us                |
| GenInput                  | 36.095 ms                 | 46.080 ms                 |
| NN                        | 565.336 us                | 119.393 ms                |
| Forward                   | 833.525 us                | 121.906 ms                |
| Backward                  | 1.873 ms                  | 132.624 ms                |
| Optimize                  | 203.454 us                | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 435.553 us                | 34.411 ms                 |
| AfterBackward             | 160.883 ms                | 1.513 s                   |
| BlockToStepN              | 150.099 us                | 228.064 ms                |
| OneStep                   | 200.769 ms                | 2.069 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:15.863124 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:15.892622 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 98.130 us                 | 11.752 ms                 |
| ProcessBack:Shuffle       | 146.753 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.940 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 57.072 us                 | 458.673 ms                |
| ProcessOneStep            | 160.859 ms                | 1.512 s                   |
| BlockToStepN              | 91.184 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
E20240130 21:32:16.863065 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:17.440901 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
E20240130 21:32:17.863329 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:18.052050 209715 grad_async_v2.h:256] pq is empty
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
W20240130 21:32:18.570124 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
E20240130 21:32:18.863199 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:19.144217 209715 grad_async_v2.h:256] pq is empty
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240130 21:32:19.583372 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240130 21:32:19.741433 209715 grad_async_v2.h:256] pq is empty
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
E20240130 21:32:19.863039 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:32:20.252332 209715 grad_async_v2.h:256] pq is empty
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.172 us                | 264.933 us                |
| GenInput                  | 36.095 ms                 | 46.080 ms                 |
| NN                        | 598.193 us                | 119.393 ms                |
| Forward                   | 865.062 us                | 121.906 ms                |
| Backward                  | 1.922 ms                  | 132.624 ms                |
| Optimize                  | 213.922 us                | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 435.553 us                | 34.411 ms                 |
| AfterBackward             | 207.057 ms                | 1.513 s                   |
| BlockToStepN              | 159.975 us                | 228.064 ms                |
| OneStep                   | 250.183 ms                | 2.069 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:20.563292 209715 grad_async_v2.h:256] pq is empty
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
W20240130 21:32:20.628405 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
E20240130 21:32:20.863124 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:21.227722 209715 grad_async_v2.h:256] pq is empty
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.646 us                | 5.548 ms                  |
| ProcessBack:Shuffle       | 201.088 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.738 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 58.254 us                 | 458.673 ms                |
| ProcessOneStep            | 250.324 ms                | 1.512 s                   |
| BlockToStepN              | 98.969 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
W20240130 21:32:21.807698 209715 grad_async_v2.h:256] pq is empty
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
E20240130 21:32:21.865823 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:32:21.891196 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end9
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
E20240130 21:32:22.865134 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:22.954874 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end0
E20240130 21:32:23.865018 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:23.980258 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
W20240130 21:32:24.756696 209715 grad_async_v2.h:256] pq is empty
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
E20240130 21:32:24.865228 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=60
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
W20240130 21:32:25.022991 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.347 us                | 258.448 us                |
| GenInput                  | 36.027 ms                 | 42.207 ms                 |
| NN                        | 598.193 us                | 4.624 ms                  |
| Forward                   | 865.571 us                | 4.877 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 216.044 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 254.236 us                | 3.467 ms                  |
| AfterBackward             | 250.350 ms                | 1.331 s                   |
| BlockToStepN              | 165.530 us                | 3.419 ms                  |
| OneStep                   | 289.600 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:25.865099 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=42
W20240130 21:32:25.892335 209715 grad_async_v2.h:256] pq is empty
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240130 21:32:26.029984 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 130.932 us                | 11.671 ms                 |
| ProcessBack:Shuffle       | 245.652 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.520 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 86.286 us                 |
| ProcessOneStep            | 259.960 ms                | 1.331 s                   |
| BlockToStepN              | 100.873 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
E20240130 21:32:26.865044 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=69
W20240130 21:32:27.089236 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240130 21:32:27.347600 209715 grad_async_v2.h:256] pq is empty
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
E20240130 21:32:27.865129 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:28.099434 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
W20240130 21:32:28.859696 209715 grad_async_v2.h:256] pq is empty
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
E20240130 21:32:28.869335 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:29.127327 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
W20240130 21:32:29.398296 209715 grad_async_v2.h:256] pq is empty
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240130 21:32:29.869060 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:32:29.925318 209715 grad_async_v2.h:256] pq is empty
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240130 21:32:30.316959 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.971 us                | 258.448 us                |
| GenInput                  | 36.094 ms                 | 46.080 ms                 |
| NN                        | 598.772 us                | 4.624 ms                  |
| Forward                   | 889.512 us                | 6.421 ms                  |
| Backward                  | 1.917 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 221.526 us                | 4.492 ms                  |
| AfterBackward             | 260.002 ms                | 1.331 s                   |
| BlockToStepN              | 195.696 us                | 3.419 ms                  |
| OneStep                   | 303.160 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
E20240130 21:32:30.869117 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:31.414161 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.573 us                | 11.707 ms                 |
| ProcessBack:Shuffle       | 259.041 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.169 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.559 us                 | 86.286 us                 |
| ProcessOneStep            | 277.068 ms                | 1.331 s                   |
| BlockToStepN              | 114.571 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:31.869460 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
W20240130 21:32:32.416639 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
E20240130 21:32:32.869241 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:32.908464 209715 grad_async_v2.h:256] pq is empty
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240130 21:32:33.517230 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240130 21:32:33.869153 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:32:34.005162 209715 grad_async_v2.h:256] pq is empty
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
W20240130 21:32:34.507587 209715 grad_async_v2.h:256] pq is empty
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
W20240130 21:32:34.519248 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
E20240130 21:32:34.869082 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.971 us                | 263.333 us                |
| GenInput                  | 36.094 ms                 | 51.682 ms                 |
| NN                        | 603.899 us                | 4.624 ms                  |
| Forward                   | 895.230 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 306.883 us                | 4.492 ms                  |
| AfterBackward             | 285.492 ms                | 1.331 s                   |
| BlockToStepN              | 207.617 us                | 3.419 ms                  |
| OneStep                   | 325.248 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
W20240130 21:32:35.639099 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
E20240130 21:32:35.869077 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 136.803 us                | 15.844 ms                 |
| ProcessBack:Shuffle       | 245.652 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 259.960 ms                | 1.331 s                   |
| BlockToStepN              | 120.024 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:36.785697 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end9
E20240130 21:32:36.869122 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
E20240130 21:32:37.869159 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
W20240130 21:32:38.483968 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end1
W20240130 21:32:38.524556 209715 grad_async_v2.h:256] pq is empty
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
E20240130 21:32:38.869016 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
E20240130 21:32:39.869025 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
W20240130 21:32:40.107018 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end6
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.151 us                | 263.333 us                |
| GenInput                  | 36.027 ms                 | 51.682 ms                 |
| NN                        | 598.193 us                | 4.624 ms                  |
| Forward                   | 885.046 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 211.266 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 221.526 us                | 4.492 ms                  |
| AfterBackward             | 245.087 ms                | 1.331 s                   |
| BlockToStepN              | 219.825 us                | 4.706 ms                  |
| OneStep                   | 280.847 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
E20240130 21:32:40.869171 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:41.162906 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end1
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.372 us                | 219.951 us                |
| ProcessBack:Shuffle       | 223.785 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 245.061 ms                | 1.331 s                   |
| BlockToStepN              | 130.411 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:41.869071 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:42.347841 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240130 21:32:42.523243 209715 grad_async_v2.h:256] pq is empty
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
E20240130 21:32:42.869069 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
W20240130 21:32:43.361377 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end5
E20240130 21:32:43.869048 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:44.084669 209715 grad_async_v2.h:256] pq is empty
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
W20240130 21:32:44.444093 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240130 21:32:44.581440 209715 grad_async_v2.h:256] pq is empty
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
E20240130 21:32:44.869057 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.527 us                | 264.933 us                |
| GenInput                  | 35.924 ms                 | 51.682 ms                 |
| NN                        | 598.636 us                | 4.624 ms                  |
| Forward                   | 889.512 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 212.100 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 112.726 us                | 4.492 ms                  |
| AfterBackward             | 250.350 ms                | 1.331 s                   |
| BlockToStepN              | 224.874 us                | 5.433 ms                  |
| OneStep                   | 289.600 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:45.649093 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240130 21:32:45.869244 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 132.905 us                | 4.367 ms                  |
| ProcessBack:Shuffle       | 230.402 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 57.737 us                 | 107.479 us                |
| ProcessOneStep            | 250.324 ms                | 1.331 s                   |
| BlockToStepN              | 133.924 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:46.532948 209715 grad_async_v2.h:256] pq is empty
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank2, time: 60.010, per_step: 0.600104
Step99:rank1, time: 60.010, per_step: 0.600102
Step99:rank0, time: 60.010, per_step: 0.600105
Step99:rank3, time: 60.010, per_step: 0.600103
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.527 us                | 264.933 us                |
| GenInput                  | 35.643 ms                 | 51.682 ms                 |
| NN                        | 598.636 us                | 4.624 ms                  |
| Forward                   | 889.512 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 212.100 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 110.137 us                | 4.492 ms                  |
| AfterBackward             | 250.350 ms                | 1.331 s                   |
| BlockToStepN              | 230.998 us                | 5.433 ms                  |
| OneStep                   | 303.160 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
W20240130 21:32:46.663648 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
E20240130 21:32:46.869300 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240130 21:32:47.869092 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:47.989427 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
W20240130 21:32:48.619036 209715 grad_async_v2.h:256] pq is empty
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
E20240130 21:32:48.869104 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:49.221302 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
W20240130 21:32:49.594219 209715 grad_async_v2.h:256] pq is empty
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
E20240130 21:32:49.869251 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:50.086123 209715 grad_async_v2.h:256] pq is empty
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
W20240130 21:32:50.241995 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.151 us                | 264.933 us                |
| GenInput                  | 35.333 ms                 | 51.682 ms                 |
| NN                        | 598.636 us                | 4.624 ms                  |
| Forward                   | 889.512 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 112.726 us                | 4.492 ms                  |
| AfterBackward             | 260.002 ms                | 1.331 s                   |
| BlockToStepN              | 240.938 us                | 5.433 ms                  |
| OneStep                   | 303.160 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
E20240130 21:32:50.869832 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:51.431916 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.541 us                | 587.451 us                |
| ProcessBack:Shuffle       | 241.779 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 57.737 us                 | 128.614 us                |
| ProcessOneStep            | 259.960 ms                | 1.331 s                   |
| BlockToStepN              | 147.787 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
E20240130 21:32:51.869072 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:52.182971 209715 grad_async_v2.h:256] pq is empty
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
W20240130 21:32:52.422165 209715 grad_async_v2.h:256] pq is empty
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240130 21:32:52.490789 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
E20240130 21:32:52.869060 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 21:32:53.567466 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
E20240130 21:32:53.869442 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
E20240130 21:32:54.869103 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:55.165043 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end9
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.730 us                | 264.933 us                |
| GenInput                  | 35.945 ms                 | 51.682 ms                 |
| NN                        | 598.772 us                | 4.624 ms                  |
| Forward                   | 898.001 us                | 6.421 ms                  |
| Backward                  | 1.941 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 101.250 us                | 4.492 ms                  |
| AfterBackward             | 260.002 ms                | 1.331 s                   |
| BlockToStepN              | 255.937 us                | 5.433 ms                  |
| OneStep                   | 303.160 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:55.869047 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
W20240130 21:32:56.449082 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.886 us                | 5.889 ms                  |
| ProcessBack:Shuffle       | 241.779 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 57.737 us                 | 128.614 us                |
| ProcessOneStep            | 259.960 ms                | 1.331 s                   |
| BlockToStepN              | 154.183 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
E20240130 21:32:56.869618 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=47
W20240130 21:32:57.618333 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end2
E20240130 21:32:57.869350 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
W20240130 21:32:58.715503 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 21:32:58.867688 209715 grad_async_v2.h:256] pq is empty
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
E20240130 21:32:58.875022 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240130 21:32:59.364383 209715 grad_async_v2.h:256] pq is empty
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
W20240130 21:32:59.831818 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
E20240130 21:32:59.875800 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.744 us                | 264.933 us                |
| GenInput                  | 35.945 ms                 | 51.682 ms                 |
| NN                        | 603.899 us                | 4.624 ms                  |
| Forward                   | 908.123 us                | 6.421 ms                  |
| Backward                  | 1.945 ms                  | 11.807 ms                 |
| Optimize                  | 216.044 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 112.726 us                | 4.492 ms                  |
| AfterBackward             | 284.812 ms                | 1.366 s                   |
| BlockToStepN              | 261.136 us                | 5.433 ms                  |
| OneStep                   | 325.248 ms                | 1.405 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
E20240130 21:33:00.875252 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:01.283208 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 96.911 us                 | 4.666 ms                  |
| ProcessBack:Shuffle       | 259.041 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.170 us                 | 128.614 us                |
| ProcessOneStep            | 284.776 ms                | 1.366 s                   |
| BlockToStepN              | 170.085 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:33:01.875108 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
W20240130 21:33:02.383136 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240130 21:33:02.743494 209715 grad_async_v2.h:256] pq is empty
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
E20240130 21:33:02.875178 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:03.221974 209715 grad_async_v2.h:256] pq is empty
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240130 21:33:03.497695 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
E20240130 21:33:03.875013 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
W20240130 21:33:04.590409 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
E20240130 21:33:04.875025 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.198 us                | 5.969 ms                  |
| GenInput                  | 35.333 ms                 | 51.682 ms                 |
| NN                        | 603.899 us                | 4.624 ms                  |
| Forward                   | 908.123 us                | 6.421 ms                  |
| Backward                  | 1.956 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 97.246 us                 | 4.492 ms                  |
| AfterBackward             | 285.175 ms                | 1.366 s                   |
| BlockToStepN              | 266.612 us                | 5.433 ms                  |
| OneStep                   | 327.579 ms                | 1.405 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240130 21:33:05.822202 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end9
E20240130 21:33:05.875120 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.144 us                | 12.814 ms                 |
| ProcessBack:Shuffle       | 279.211 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 128.614 us                |
| ProcessOneStep            | 285.466 ms                | 1.366 s                   |
| BlockToStepN              | 178.137 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
E20240130 21:33:06.875140 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:06.952148 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
E20240130 21:33:07.875034 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240130 21:33:08.453126 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240130 21:33:08.875159 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:09.521629 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
W20240130 21:33:09.664395 209715 grad_async_v2.h:256] pq is empty
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
E20240130 21:33:09.875339 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.485 us                | 5.969 ms                  |
| GenInput                  | 35.333 ms                 | 51.682 ms                 |
| NN                        | 619.604 us                | 4.624 ms                  |
| Forward                   | 918.049 us                | 6.421 ms                  |
| Backward                  | 1.958 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 94.561 us                 | 4.492 ms                  |
| AfterBackward             | 285.175 ms                | 1.366 s                   |
| BlockToStepN              | 278.179 us                | 5.433 ms                  |
| OneStep                   | 326.976 ms                | 1.405 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240130 21:33:10.746599 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end0
E20240130 21:33:10.875356 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 84.657 us                 | 11.534 ms                 |
| ProcessBack:Shuffle       | 275.954 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 57.737 us                 | 128.614 us                |
| ProcessOneStep            | 285.085 ms                | 1.366 s                   |
| BlockToStepN              | 189.314 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:33:11.875064 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:33:12.208235 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
E20240130 21:33:12.875108 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:13.091265 209715 grad_async_v2.h:256] pq is empty
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
W20240130 21:33:13.209002 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 21:33:13.662954 209715 grad_async_v2.h:256] pq is empty
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
E20240130 21:33:13.875082 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=59
W20240130 21:33:14.402382 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end6
E20240130 21:33:14.875165 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:15.185740 209715 grad_async_v2.h:256] pq is empty
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
W20240130 21:33:15.433267 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.441 us                | 4.346 ms                  |
| GenInput                  | 35.284 ms                 | 46.713 ms                 |
| NN                        | 620.935 us                | 1.846 ms                  |
| Forward                   | 918.654 us                | 6.177 ms                  |
| Backward                  | 1.941 ms                  | 6.700 ms                  |
| Optimize                  | 213.922 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 101.250 us                | 4.492 ms                  |
| AfterBackward             | 285.492 ms                | 1.331 s                   |
| BlockToStepN              | 284.356 us                | 4.706 ms                  |
| OneStep                   | 327.579 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:15.710600 209715 grad_async_v2.h:256] pq is empty
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
E20240130 21:33:15.875244 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:16.249895 209715 grad_async_v2.h:256] pq is empty
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.275 us                | 5.951 ms                  |
| ProcessBack:Shuffle       | 282.573 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 288.098 ms                | 1.331 s                   |
| BlockToStepN              | 209.678 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:16.604100 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
E20240130 21:33:16.875119 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=59
W20240130 21:33:17.977339 209715 grad_async_v2.h:256] pq is empty
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240130 21:33:17.990366 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240130 21:33:17.997385 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
E20240130 21:33:18.997668 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:19.227147 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
W20240130 21:33:19.497786 209715 grad_async_v2.h:256] pq is empty
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240130 21:33:19.986498 209715 grad_async_v2.h:256] pq is empty
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
E20240130 21:33:19.997229 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
W20240130 21:33:20.244483 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.198 us                | 4.346 ms                  |
| GenInput                  | 35.282 ms                 | 46.713 ms                 |
| NN                        | 620.935 us                | 1.846 ms                  |
| Forward                   | 918.654 us                | 6.177 ms                  |
| Backward                  | 1.934 ms                  | 6.700 ms                  |
| Optimize                  | 213.922 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 110.137 us                | 4.492 ms                  |
| AfterBackward             | 285.492 ms                | 1.331 s                   |
| BlockToStepN              | 293.725 us                | 4.706 ms                  |
| OneStep                   | 327.579 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
E20240130 21:33:20.997270 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240130 21:33:21.452551 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.915 us                | 5.443 ms                  |
| ProcessBack:Shuffle       | 279.211 ms                | 1.322 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 285.466 ms                | 1.331 s                   |
| BlockToStepN              | 215.351 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:21.979282 209715 grad_async_v2.h:256] pq is empty
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
E20240130 21:33:21.997045 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=30
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
W20240130 21:33:22.742107 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
E20240130 21:33:22.997185 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=48
W20240130 21:33:23.823688 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 21:33:23.957707 209715 grad_async_v2.h:256] pq is empty
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
E20240130 21:33:23.997134 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
W20240130 21:33:24.700938 209715 grad_async_v2.h:256] pq is empty
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
W20240130 21:33:24.835505 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
E20240130 21:33:24.997102 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=98
W20240130 21:33:25.076584 209715 grad_async_v2.h:256] pq is empty
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.171 us                | 4.346 ms                  |
| GenInput                  | 35.282 ms                 | 48.456 ms                 |
| NN                        | 620.935 us                | 1.846 ms                  |
| Forward                   | 918.654 us                | 6.177 ms                  |
| Backward                  | 1.934 ms                  | 6.700 ms                  |
| Optimize                  | 213.922 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 113.941 us                | 4.492 ms                  |
| AfterBackward             | 288.133 ms                | 1.331 s                   |
| BlockToStepN              | 303.358 us                | 4.706 ms                  |
| OneStep                   | 327.814 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:25.920238 209715 grad_async_v2.h:256] pq is empty
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
W20240130 21:33:25.932253 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
E20240130 21:33:25.997473 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:26.408218 209715 grad_async_v2.h:256] pq is empty
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
W20240130 21:33:26.473466 209715 grad_async_v2.h:256] pq is empty
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 129.749 us                | 3.711 ms                  |
| ProcessBack:Shuffle       | 282.801 ms                | 1.322 s                   |
| ProcessBack:UpdateCache   | 1.358 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.790 us                 | 107.479 us                |
| ProcessOneStep            | 298.130 ms                | 1.331 s                   |
| BlockToStepN              | 221.736 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
E20240130 21:33:26.997016 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:33:27.292140 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end1
W20240130 21:33:27.890260 209715 grad_async_v2.h:256] pq is empty
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
E20240130 21:33:27.997134 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
W20240130 21:33:28.384481 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
E20240130 21:33:28.997102 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:29.457340 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240130 21:33:29.588470 209715 grad_async_v2.h:256] pq is empty
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
E20240130 21:33:29.997292 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:30.179594 209715 grad_async_v2.h:256] pq is empty
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.673 us                | 4.673 ms                  |
| GenInput                  | 35.220 ms                 | 48.456 ms                 |
| NN                        | 621.580 us                | 1.846 ms                  |
| Forward                   | 919.019 us                | 6.177 ms                  |
| Backward                  | 1.945 ms                  | 6.700 ms                  |
| Optimize                  | 213.107 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 110.137 us                | 6.694 ms                  |
| AfterBackward             | 298.162 ms                | 1.331 s                   |
| BlockToStepN              | 309.268 us                | 4.706 ms                  |
| OneStep                   | 346.832 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:30.463188 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
E20240130 21:33:30.997009 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
W20240130 21:33:31.470201 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.505 us                | 1.195 ms                  |
| ProcessBack:Shuffle       | 284.627 ms                | 1.322 s                   |
| ProcessBack:UpdateCache   | 1.351 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.589 us                 | 107.479 us                |
| ProcessOneStep            | 303.855 ms                | 1.331 s                   |
| BlockToStepN              | 229.921 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
E20240130 21:33:31.997051 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:33:32.266894 209715 grad_async_v2.h:256] pq is empty
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240130 21:33:32.346307 209715 grad_async_v2.h:256] pq is empty
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
W20240130 21:33:32.694896 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end2
E20240130 21:33:32.997398 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
E20240130 21:33:33.997090 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240130 21:33:34.013749 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
E20240130 21:33:34.997056 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 21:33:35.060974 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
W20240130 21:33:35.423224 209715 grad_async_v2.h:256] pq is empty
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 165.673 us                | 4.673 ms                  |
| GenInput                  | 35.220 ms                 | 48.456 ms                 |
| NN                        | 620.935 us                | 1.846 ms                  |
| Forward                   | 919.019 us                | 6.177 ms                  |
| Backward                  | 1.961 ms                  | 11.807 ms                 |
| Optimize                  | 214.989 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 101.250 us                | 6.694 ms                  |
| AfterBackward             | 338.844 ms                | 1.331 s                   |
| BlockToStepN              | 326.033 us                | 4.706 ms                  |
| OneStep                   | 375.633 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
E20240130 21:33:35.997094 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
W20240130 21:33:36.294894 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.107 us                | 5.711 ms                  |
| ProcessBack:Shuffle       | 296.954 ms                | 1.322 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.790 us                 | 107.479 us                |
| ProcessOneStep            | 338.777 ms                | 1.331 s                   |
| BlockToStepN              | 234.598 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:33:36.997013 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:33:37.061897 209715 grad_async_v2.h:256] pq is empty
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
W20240130 21:33:37.308917 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
Step199:rank1, time: 50.988, per_step: 0.504835
Step199:rank3, time: 50.988, per_step: 0.504835
Step199:rank0, time: 50.988, per_step: 0.504835
Step199:rank2, time: 50.988, per_step: 0.504836
========== Step 200 ========== 
========== Step 200 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.198 us                | 4.673 ms                  |
| GenInput                  | 34.976 ms                 | 49.287 ms                 |
| NN                        | 621.580 us                | 4.624 ms                  |
| Forward                   | 923.886 us                | 6.177 ms                  |
| Backward                  | 1.961 ms                  | 11.807 ms                 |
| Optimize                  | 216.044 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 94.561 us                 | 6.694 ms                  |
| AfterBackward             | 338.844 ms                | 1.331 s                   |
| BlockToStepN              | 326.518 us                | 4.706 ms                  |
| OneStep                   | 394.260 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
E20240130 21:33:37.997148 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:33:38.619366 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
E20240130 21:33:38.997177 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=24
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
W20240130 21:33:39.862469 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end6
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
E20240130 21:33:39.997908 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
W20240130 21:33:40.247483 209715 grad_async_v2.h:256] pq is empty
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.415 us                | 4.673 ms                  |
| GenInput                  | 34.903 ms                 | 49.287 ms                 |
| NN                        | 619.604 us                | 4.624 ms                  |
| Forward                   | 918.654 us                | 6.177 ms                  |
| Backward                  | 1.963 ms                  | 11.807 ms                 |
| Optimize                  | 214.989 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 82.302 us                 | 6.694 ms                  |
| AfterBackward             | 298.162 ms                | 1.331 s                   |
| BlockToStepN              | 329.333 us                | 4.706 ms                  |
| OneStep                   | 346.832 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:33:40.997203 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.153 us                | 1.829 ms                  |
| ProcessBack:Shuffle       | 282.925 ms                | 1.322 s                   |
| ProcessBack:UpdateCache   | 1.267 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.540 us                 | 107.479 us                |
| ProcessOneStep            | 298.130 ms                | 1.331 s                   |
| BlockToStepN              | 237.533 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:41.570443 209715 grad_async_v2.h:256] pq is empty
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
W20240130 21:33:41.587952 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
E20240130 21:33:41.997438 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:42.600421 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
E20240130 21:33:42.997664 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:43.608136 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end2
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
E20240130 21:33:43.997139 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=23
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
W20240130 21:33:44.726843 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end6
E20240130 21:33:44.997059 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.198 us                | 4.673 ms                  |
| GenInput                  | 34.730 ms                 | 49.287 ms                 |
| NN                        | 621.580 us                | 4.624 ms                  |
| Forward                   | 923.886 us                | 6.177 ms                  |
| Backward                  | 1.963 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 82.302 us                 | 6.694 ms                  |
| AfterBackward             | 303.878 ms                | 1.331 s                   |
| BlockToStepN              | 337.347 us                | 4.706 ms                  |
| OneStep                   | 347.380 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
W20240130 21:33:45.953851 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
E20240130 21:33:45.997031 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.032 us                | 11.632 ms                 |
| ProcessBack:Shuffle       | 284.627 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.288 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.540 us                 | 107.479 us                |
| ProcessOneStep            | 303.855 ms                | 1.338 s                   |
| BlockToStepN              | 247.660 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
E20240130 21:33:46.997251 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=71
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
W20240130 21:33:47.038313 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end1
E20240130 21:33:47.997211 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=39
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
W20240130 21:33:48.231796 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end2
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
E20240130 21:33:48.998052 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:49.311632 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 21:33:49.446727 209715 grad_async_v2.h:256] pq is empty
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
W20240130 21:33:49.626102 209715 grad_async_v2.h:256] pq is empty
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
E20240130 21:33:49.998117 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:33:50.325178 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.829 us                | 5.860 ms                  |
| GenInput                  | 34.903 ms                 | 49.287 ms                 |
| NN                        | 622.472 us                | 4.624 ms                  |
| Forward                   | 930.554 us                | 6.177 ms                  |
| Backward                  | 1.979 ms                  | 11.807 ms                 |
| Optimize                  | 215.337 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 89.584 us                 | 6.694 ms                  |
| AfterBackward             | 303.878 ms                | 1.338 s                   |
| BlockToStepN              | 343.401 us                | 4.706 ms                  |
| OneStep                   | 347.380 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:50.533486 209715 grad_async_v2.h:256] pq is empty
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
E20240130 21:33:50.998160 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:33:51.383878 209715 grad_async_v2.h:256] pq is empty
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.154 us                | 7.091 ms                  |
| ProcessBack:Shuffle       | 296.954 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.288 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.559 us                 | 107.479 us                |
| ProcessOneStep            | 308.955 ms                | 1.338 s                   |
| BlockToStepN              | 252.195 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:51.603031 209715 grad_async_v2.h:256] pq is empty
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
W20240130 21:33:51.709067 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
E20240130 21:33:51.998019 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
E20240130 21:33:52.998100 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
W20240130 21:33:53.158270 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end5
E20240130 21:33:53.998625 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=66
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
W20240130 21:33:54.415659 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end6
E20240130 21:33:54.998183 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:55.384840 209715 grad_async_v2.h:256] pq is empty
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.303 us                | 5.860 ms                  |
| GenInput                  | 34.976 ms                 | 49.287 ms                 |
| NN                        | 622.472 us                | 4.624 ms                  |
| Forward                   | 930.554 us                | 6.177 ms                  |
| Backward                  | 1.989 ms                  | 11.807 ms                 |
| Optimize                  | 216.044 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 82.302 us                 | 6.694 ms                  |
| AfterBackward             | 303.878 ms                | 1.338 s                   |
| BlockToStepN              | 350.665 us                | 4.706 ms                  |
| OneStep                   | 347.380 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
W20240130 21:33:55.898885 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
E20240130 21:33:55.998346 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.512 us                | 5.679 ms                  |
| ProcessBack:Shuffle       | 296.954 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.324 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.559 us                 | 107.479 us                |
| ProcessOneStep            | 308.955 ms                | 1.338 s                   |
| BlockToStepN              | 265.744 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
E20240130 21:33:56.998147 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=15
W20240130 21:33:57.246826 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
E20240130 21:33:57.998644 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
W20240130 21:33:58.353457 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
E20240130 21:33:58.998342 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=107
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
W20240130 21:33:59.635670 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end6
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
E20240130 21:33:59.998090 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.304 us                | 5.860 ms                  |
| GenInput                  | 34.976 ms                 | 49.287 ms                 |
| NN                        | 621.580 us                | 4.624 ms                  |
| Forward                   | 923.886 us                | 6.177 ms                  |
| Backward                  | 1.992 ms                  | 11.807 ms                 |
| Optimize                  | 215.337 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 64.526 us                 | 6.694 ms                  |
| AfterBackward             | 308.984 ms                | 1.338 s                   |
| BlockToStepN              | 367.728 us                | 4.706 ms                  |
| OneStep                   | 348.815 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:00.752202 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end9
E20240130 21:34:00.998261 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.901 us                | 3.019 ms                  |
| ProcessBack:Shuffle       | 296.954 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.324 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.540 us                 | 107.479 us                |
| ProcessOneStep            | 308.955 ms                | 1.338 s                   |
| BlockToStepN              | 274.954 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:01.708608 209715 grad_async_v2.h:256] pq is empty
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
E20240130 21:34:01.998185 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:02.166736 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end0
E20240130 21:34:02.998026 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
W20240130 21:34:03.260396 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240130 21:34:03.623996 209715 grad_async_v2.h:256] pq is empty
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
W20240130 21:34:03.951547 209715 grad_async_v2.h:256] pq is empty
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
E20240130 21:34:03.998178 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=19
W20240130 21:34:04.351261 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 21:34:04.603025 209715 grad_async_v2.h:256] pq is empty
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
E20240130 21:34:04.998196 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
W20240130 21:34:05.360963 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
W20240130 21:34:05.406210 209715 grad_async_v2.h:256] pq is empty
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.304 us                | 4.673 ms                  |
| GenInput                  | 34.903 ms                 | 48.864 ms                 |
| NN                        | 621.580 us                | 1.846 ms                  |
| Forward                   | 923.886 us                | 5.795 ms                  |
| Backward                  | 2.001 ms                  | 8.925 ms                  |
| Optimize                  | 216.044 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 61.965 us                 | 5.905 ms                  |
| AfterBackward             | 338.844 ms                | 1.338 s                   |
| BlockToStepN              | 382.688 us                | 3.419 ms                  |
| OneStep                   | 375.633 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:34:05.998023 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.876 us                | 1.480 ms                  |
| ProcessBack:Shuffle       | 301.812 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.315 ms                  | 16.212 ms                 |
| ProcessBack:UpsertPq      | 58.540 us                 | 101.098 us                |
| ProcessOneStep            | 338.777 ms                | 1.338 s                   |
| BlockToStepN              | 296.998 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:06.540002 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end8
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
E20240130 21:34:06.998030 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
W20240130 21:34:07.542065 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end1
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
E20240130 21:34:07.998127 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:08.853299 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end3
E20240130 21:34:08.998286 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
W20240130 21:34:09.957511 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
E20240130 21:34:09.998214 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.039 us                | 4.673 ms                  |
| GenInput                  | 35.220 ms                 | 48.864 ms                 |
| NN                        | 622.472 us                | 1.846 ms                  |
| Forward                   | 930.554 us                | 5.795 ms                  |
| Backward                  | 2.016 ms                  | 9.830 ms                  |
| Optimize                  | 216.291 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 59.535 us                 | 5.905 ms                  |
| AfterBackward             | 338.844 ms                | 1.338 s                   |
| BlockToStepN              | 393.106 us                | 3.419 ms                  |
| OneStep                   | 375.633 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 265 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 98.153 us                 | 3.153 ms                  |
| ProcessBack:Shuffle       | 301.812 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.324 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.500 us                 | 101.098 us                |
| ProcessOneStep            | 338.777 ms                | 1.338 s                   |
| BlockToStepN              | 313.482 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:11.641146 209715 grad_async_v2.h:256] pq is empty
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
W20240130 21:34:11.647737 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240130 21:34:11.648051 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
E20240130 21:34:12.648990 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:12.750257 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
W20240130 21:34:13.146111 209715 grad_async_v2.h:256] pq is empty
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
W20240130 21:34:13.566349 209715 grad_async_v2.h:256] pq is empty
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
E20240130 21:34:13.648790 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
W20240130 21:34:13.908457 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end4
W20240130 21:34:14.194607 209715 grad_async_v2.h:256] pq is empty
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
E20240130 21:34:14.648017 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:34:15.264842 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.370 us                | 4.673 ms                  |
| GenInput                  | 34.976 ms                 | 48.864 ms                 |
| NN                        | 622.716 us                | 1.846 ms                  |
| Forward                   | 931.206 us                | 5.795 ms                  |
| Backward                  | 2.016 ms                  | 9.830 ms                  |
| Optimize                  | 216.119 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 64.526 us                 | 5.905 ms                  |
| AfterBackward             | 303.878 ms                | 1.338 s                   |
| BlockToStepN              | 400.417 us                | 3.419 ms                  |
| OneStep                   | 347.380 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:34:15.648295 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=16
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.168 us                | 5.824 ms                  |
| ProcessBack:Shuffle       | 292.544 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.315 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.438 us                 | 101.098 us                |
| ProcessOneStep            | 303.855 ms                | 1.338 s                   |
| BlockToStepN              | 320.051 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:16.534931 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
E20240130 21:34:16.648401 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
W20240130 21:34:17.536321 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
E20240130 21:34:17.648073 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
W20240130 21:34:18.614105 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 21:34:18.648252 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
E20240130 21:34:19.648270 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:19.681890 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 21:34:20.065353 209715 grad_async_v2.h:256] pq is empty
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.933 us                | 4.673 ms                  |
| GenInput                  | 34.976 ms                 | 48.864 ms                 |
| NN                        | 624.987 us                | 1.846 ms                  |
| Forward                   | 934.857 us                | 5.795 ms                  |
| Backward                  | 2.009 ms                  | 9.830 ms                  |
| Optimize                  | 215.681 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 67.523 us                 | 5.905 ms                  |
| AfterBackward             | 303.878 ms                | 1.352 s                   |
| BlockToStepN              | 414.046 us                | 3.419 ms                  |
| OneStep                   | 347.380 ms                | 1.392 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:34:20.648109 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=36
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
W20240130 21:34:20.971666 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end8
W20240130 21:34:21.208721 209715 grad_async_v2.h:256] pq is empty
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 111.228 us                | 14.355 ms                 |
| ProcessBack:Shuffle       | 288.247 ms                | 1.330 s                   |
| ProcessBack:UpdateCache   | 1.351 ms                  | 17.015 ms                 |
| ProcessBack:UpsertPq      | 58.308 us                 | 107.479 us                |
| ProcessOneStep            | 298.130 ms                | 1.352 s                   |
| BlockToStepN              | 346.993 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
E20240130 21:34:21.648036 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:34:22.586915 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end4
E20240130 21:34:22.648010 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:34:22.924659 209715 grad_async_v2.h:256] pq is empty
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
W20240130 21:34:23.614049 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end5
E20240130 21:34:23.648108 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:24.648008 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
W20240130 21:34:24.648701 209715 grad_async_v2.h:256] pq is empty
E20240130 21:34:24.648983 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.304 us                | 4.673 ms                  |
| GenInput                  | 34.976 ms                 | 48.864 ms                 |
| NN                        | 624.610 us                | 1.846 ms                  |
| Forward                   | 932.907 us                | 5.795 ms                  |
| Backward                  | 2.001 ms                  | 9.830 ms                  |
| Optimize                  | 214.989 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 67.523 us                 | 5.905 ms                  |
| AfterBackward             | 298.162 ms                | 1.363 s                   |
| BlockToStepN              | 431.243 us                | 3.419 ms                  |
| OneStep                   | 346.832 ms                | 1.403 s                   |
| E2E-100                   | 48.146 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
E20240130 21:34:25.649976 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
W20240130 21:34:25.891162 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end0
Step299:rank3, time: 48.396, per_step: 0.479173
Step299:rank1, time: 48.396, per_step: 0.479173
Step299:rank0, time: 48.396, per_step: 0.479172
Step299:rank2, time: 48.396, per_step: 0.479173
========== Step 300 ========== 
========== Step 300 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.933 us                | 4.673 ms                  |
| GenInput                  | 35.197 ms                 | 48.864 ms                 |
| NN                        | 624.987 us                | 1.846 ms                  |
| Forward                   | 933.060 us                | 5.795 ms                  |
| Backward                  | 2.001 ms                  | 9.830 ms                  |
| Optimize                  | 215.158 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 67.523 us                 | 5.905 ms                  |
| AfterBackward             | 293.655 ms                | 1.363 s                   |
| BlockToStepN              | 431.859 us                | 3.419 ms                  |
| OneStep                   | 346.832 ms                | 1.403 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 300 ========== 
========== Step 300 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.903 us                | 11.392 ms                 |
| ProcessBack:Shuffle       | 284.627 ms                | 1.330 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 17.015 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 293.609 ms                | 1.363 s                   |
| BlockToStepN              | 351.652 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:26.604918 209715 grad_async_v2.h:256] pq is empty
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
E20240130 21:34:26.649981 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:27.011783 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end2
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
E20240130 21:34:27.649463 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
W20240130 21:34:28.174417 209715 grad_async_v2.h:256] pq is empty
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
W20240130 21:34:28.379905 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
E20240130 21:34:28.649641 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
E20240130 21:34:29.649143 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:34:29.947661 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.370 us                | 4.673 ms                  |
| GenInput                  | 35.220 ms                 | 48.864 ms                 |
| NN                        | 631.086 us                | 1.846 ms                  |
| Forward                   | 939.289 us                | 5.795 ms                  |
| Backward                  | 2.009 ms                  | 9.830 ms                  |
| Optimize                  | 215.681 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 67.523 us                 | 5.905 ms                  |
| AfterBackward             | 298.162 ms                | 1.363 s                   |
| BlockToStepN              | 438.454 us                | 3.419 ms                  |
| OneStep                   | 346.832 ms                | 1.403 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:30.469182 209715 grad_async_v2.h:256] pq is empty
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
E20240130 21:34:30.649072 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=31
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
W20240130 21:34:30.970520 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 115.703 us                | 5.257 ms                  |
| ProcessBack:Shuffle       | 292.544 ms                | 1.330 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 17.015 ms                 |
| ProcessBack:UpsertPq      | 58.170 us                 | 107.479 us                |
| ProcessOneStep            | 303.855 ms                | 1.363 s                   |
| BlockToStepN              | 355.908 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:34:31.649726 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
W20240130 21:34:32.074412 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
E20240130 21:34:32.649428 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240130 21:34:33.096021 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end4
E20240130 21:34:33.649106 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
W20240130 21:34:34.220714 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
E20240130 21:34:34.649098 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:34:35.455533 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 167.304 us                | 4.673 ms                  |
| GenInput                  | 35.293 ms                 | 48.864 ms                 |
| NN                        | 633.380 us                | 1.846 ms                  |
| Forward                   | 941.418 us                | 5.795 ms                  |
| Backward                  | 2.009 ms                  | 11.807 ms                 |
| Optimize                  | 215.158 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 55.492 us                 | 5.905 ms                  |
| AfterBackward             | 298.162 ms                | 1.363 s                   |
| BlockToStepN              | 442.219 us                | 4.706 ms                  |
| OneStep                   | 346.832 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:35.626199 209715 grad_async_v2.h:256] pq is empty
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
E20240130 21:34:35.649222 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=39
W20240130 21:34:36.243858 209715 grad_async_v2.h:256] pq is empty
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
W20240130 21:34:36.484275 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.776 us                | 5.427 ms                  |
| ProcessBack:Shuffle       | 292.544 ms                | 1.343 s                   |
| ProcessBack:UpdateCache   | 1.358 ms                  | 17.015 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 303.855 ms                | 1.363 s                   |
| BlockToStepN              | 356.957 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:34:36.649767 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:36.740303 209715 grad_async_v2.h:256] pq is empty
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
W20240130 21:34:37.224149 209715 grad_async_v2.h:256] pq is empty
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
W20240130 21:34:37.586741 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
E20240130 21:34:37.649004 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:34:37.719267 209715 grad_async_v2.h:256] pq is empty
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
E20240130 21:34:38.649063 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
W20240130 21:34:38.684505 209715 grad_async_v2.h:256] pq is empty
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
W20240130 21:34:38.697327 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
W20240130 21:34:39.127681 209715 grad_async_v2.h:256] pq is empty
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
W20240130 21:34:39.430984 209715 grad_async_v2.h:256] pq is empty
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
E20240130 21:34:39.649330 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:39.844238 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end8
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.039 us                | 4.673 ms                  |
| GenInput                  | 35.333 ms                 | 48.864 ms                 |
| NN                        | 636.126 us                | 1.846 ms                  |
| Forward                   | 943.597 us                | 5.795 ms                  |
| Backward                  | 2.013 ms                  | 11.807 ms                 |
| Optimize                  | 215.681 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 55.492 us                 | 5.905 ms                  |
| AfterBackward             | 308.984 ms                | 1.363 s                   |
| BlockToStepN              | 442.309 us                | 4.706 ms                  |
| OneStep                   | 348.815 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
E20240130 21:34:40.649217 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
W20240130 21:34:41.334177 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 121.166 us                | 12.036 ms                 |
| ProcessBack:Shuffle       | 292.544 ms                | 1.343 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 17.015 ms                 |
| ProcessBack:UpsertPq      | 58.119 us                 | 107.479 us                |
| ProcessOneStep            | 303.855 ms                | 1.363 s                   |
| BlockToStepN              | 363.569 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:34:41.649075 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:34:42.398188 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end4
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
E20240130 21:34:42.649197 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=33
W20240130 21:34:42.747438 209715 grad_async_v2.h:256] pq is empty
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
W20240130 21:34:43.242038 209715 grad_async_v2.h:256] pq is empty
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
W20240130 21:34:43.543509 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240130 21:34:43.649005 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
E20240130 21:34:44.649369 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:44.864890 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.422 us                | 4.673 ms                  |
| GenInput                  | 35.482 ms                 | 48.864 ms                 |
| NN                        | 636.126 us                | 1.846 ms                  |
| Forward                   | 943.597 us                | 5.795 ms                  |
| Backward                  | 2.009 ms                  | 11.807 ms                 |
| Optimize                  | 216.044 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 53.021 us                 | 5.905 ms                  |
| AfterBackward             | 298.162 ms                | 1.363 s                   |
| BlockToStepN              | 450.169 us                | 4.706 ms                  |
| OneStep                   | 346.832 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
E20240130 21:34:45.649026 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=100
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
W20240130 21:34:45.898993 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 135.363 us                | 1.410 ms                  |
| ProcessBack:Shuffle       | 288.247 ms                | 1.343 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 17.015 ms                 |
| ProcessBack:UpsertPq      | 58.095 us                 | 107.479 us                |
| ProcessOneStep            | 298.130 ms                | 1.363 s                   |
| BlockToStepN              | 377.963 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:34:46.649277 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
W20240130 21:34:47.088685 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end5
E20240130 21:34:47.649118 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240130 21:34:47.843765 209715 grad_async_v2.h:256] pq is empty
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
W20240130 21:34:48.099824 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240130 21:34:48.351754 209715 grad_async_v2.h:256] pq is empty
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
E20240130 21:34:48.649195 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:49.199710 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
W20240130 21:34:49.350845 209715 grad_async_v2.h:256] pq is empty
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
W20240130 21:34:49.472676 209715 grad_async_v2.h:256] pq is empty
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
E20240130 21:34:49.649116 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:34:50.211962 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.422 us                | 4.673 ms                  |
| GenInput                  | 35.488 ms                 | 48.864 ms                 |
| NN                        | 635.956 us                | 1.846 ms                  |
| Forward                   | 943.597 us                | 5.795 ms                  |
| Backward                  | 2.009 ms                  | 11.807 ms                 |
| Optimize                  | 216.119 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 45.717 us                 | 5.905 ms                  |
| AfterBackward             | 303.878 ms                | 1.363 s                   |
| BlockToStepN              | 450.652 us                | 4.706 ms                  |
| OneStep                   | 347.380 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:50.817179 209715 grad_async_v2.h:256] pq is empty
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
E20240130 21:34:50.824525 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 103.794 us                | 11.568 ms                 |
| ProcessBack:Shuffle       | 292.544 ms                | 1.343 s                   |
| ProcessBack:UpdateCache   | 1.335 ms                  | 17.015 ms                 |
| ProcessBack:UpsertPq      | 58.170 us                 | 107.479 us                |
| ProcessOneStep            | 303.855 ms                | 1.363 s                   |
| BlockToStepN              | 378.474 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:34:51.711091 209715 grad_async_v2.h:256] pq is empty
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
W20240130 21:34:51.718303 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240130 21:34:51.756765 209715 grad_async_v2.h:256] pq is empty
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
E20240130 21:34:51.824589 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 21:34:52.714754 209715 grad_async_v2.h:256] pq is empty
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
W20240130 21:34:52.721652 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
E20240130 21:34:52.824227 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:34:53.192973 209715 grad_async_v2.h:256] pq is empty
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
W20240130 21:34:53.686462 209715 grad_async_v2.h:256] pq is empty
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
W20240130 21:34:53.813258 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
E20240130 21:34:53.824213 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:54.241062 209715 grad_async_v2.h:256] pq is empty
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
E20240130 21:34:54.824110 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=64
W20240130 21:34:55.014582 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end0
W20240130 21:34:55.320634 209715 grad_async_v2.h:256] pq is empty
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.422 us                | 4.346 ms                  |
| GenInput                  | 35.488 ms                 | 48.456 ms                 |
| NN                        | 636.581 us                | 1.793 ms                  |
| Forward                   | 945.344 us                | 5.351 ms                  |
| Backward                  | 2.001 ms                  | 9.830 ms                  |
| Optimize                  | 216.291 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 44.877 us                 | 4.492 ms                  |
| AfterBackward             | 330.566 ms                | 1.360 s                   |
| BlockToStepN              | 455.540 us                | 3.419 ms                  |
| OneStep                   | 375.010 ms                | 1.403 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
E20240130 21:34:55.824496 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:56.043393 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 110.052 us                | 12.282 ms                 |
| ProcessBack:Shuffle       | 296.954 ms                | 1.333 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.170 us                 | 101.910 us                |
| ProcessOneStep            | 308.955 ms                | 1.359 s                   |
| BlockToStepN              | 385.070 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:34:56.824214 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:34:57.124927 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end3
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
E20240130 21:34:57.824247 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
W20240130 21:34:58.503082 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end0
E20240130 21:34:58.824599 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
W20240130 21:34:59.567984 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end1
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
E20240130 21:34:59.824087 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.370 us                | 4.346 ms                  |
| GenInput                  | 35.422 ms                 | 48.456 ms                 |
| NN                        | 635.046 us                | 1.793 ms                  |
| Forward                   | 943.597 us                | 5.351 ms                  |
| Backward                  | 1.996 ms                  | 9.830 ms                  |
| Optimize                  | 216.119 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 41.005 us                 | 4.492 ms                  |
| AfterBackward             | 303.878 ms                | 1.363 s                   |
| BlockToStepN              | 461.821 us                | 3.419 ms                  |
| OneStep                   | 347.380 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:00.603415 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end2
E20240130 21:35:00.824409 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:00.977931 209715 grad_async_v2.h:256] pq is empty
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
W20240130 21:35:01.048432 209715 grad_async_v2.h:256] pq is empty
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 101.296 us                | 5.645 ms                  |
| ProcessBack:Shuffle       | 292.919 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.119 us                 | 101.910 us                |
| ProcessOneStep            | 303.855 ms                | 1.363 s                   |
| BlockToStepN              | 387.623 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:35:01.824208 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:35:01.960798 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end4
W20240130 21:35:02.200553 209715 grad_async_v2.h:256] pq is empty
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
W20240130 21:35:02.653213 209715 grad_async_v2.h:256] pq is empty
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
E20240130 21:35:02.824291 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:03.453641 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
E20240130 21:35:03.824092 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
W20240130 21:35:04.718160 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
E20240130 21:35:04.824301 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:05.343060 209715 grad_async_v2.h:256] pq is empty
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.485 us                | 4.346 ms                  |
| GenInput                  | 35.333 ms                 | 48.456 ms                 |
| NN                        | 636.581 us                | 1.793 ms                  |
| Forward                   | 945.344 us                | 5.351 ms                  |
| Backward                  | 1.995 ms                  | 9.830 ms                  |
| Optimize                  | 216.530 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 40.431 us                 | 4.492 ms                  |
| AfterBackward             | 330.566 ms                | 1.363 s                   |
| BlockToStepN              | 472.037 us                | 3.419 ms                  |
| OneStep                   | 375.010 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:05.831737 209715 grad_async_v2.h:256] pq is empty
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
W20240130 21:35:05.838495 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240130 21:35:05.838865 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:06.315071 209715 grad_async_v2.h:256] pq is empty
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.361 us                | 5.317 ms                  |
| ProcessBack:Shuffle       | 308.151 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 101.910 us                |
| ProcessOneStep            | 330.805 ms                | 1.363 s                   |
| BlockToStepN              | 387.623 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:06.809487 209715 grad_async_v2.h:256] pq is empty
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
E20240130 21:35:06.838092 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=148
W20240130 21:35:06.929968 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240130 21:35:07.182009 209715 grad_async_v2.h:256] pq is empty
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
W20240130 21:35:07.796099 209715 grad_async_v2.h:256] pq is empty
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
E20240130 21:35:07.843765 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:07.965400 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 21:35:08.670363 209715 grad_async_v2.h:256] pq is empty
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
E20240130 21:35:08.843024 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 21:35:09.036826 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240130 21:35:09.421008 209715 grad_async_v2.h:256] pq is empty
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
W20240130 21:35:09.731479 209715 grad_async_v2.h:256] pq is empty
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
E20240130 21:35:09.843137 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
W20240130 21:35:10.300040 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.690 us                | 4.346 ms                  |
| GenInput                  | 35.284 ms                 | 48.456 ms                 |
| NN                        | 636.632 us                | 1.793 ms                  |
| Forward                   | 947.411 us                | 5.351 ms                  |
| Backward                  | 2.001 ms                  | 11.807 ms                 |
| Optimize                  | 216.530 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 37.889 us                 | 4.492 ms                  |
| AfterBackward             | 335.241 ms                | 1.363 s                   |
| BlockToStepN              | 472.037 us                | 3.419 ms                  |
| OneStep                   | 375.633 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
E20240130 21:35:10.843348 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:11.193998 209715 grad_async_v2.h:256] pq is empty
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.425 us                | 7.945 ms                  |
| ProcessBack:Shuffle       | 320.049 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.315 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.262 us                 | 101.910 us                |
| ProcessOneStep            | 338.777 ms                | 1.363 s                   |
| BlockToStepN              | 388.188 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:11.518075 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end1
E20240130 21:35:11.843451 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
W20240130 21:35:12.548985 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
E20240130 21:35:12.843134 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=12
W20240130 21:35:13.611163 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240130 21:35:13.843055 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
W20240130 21:35:14.394462 209715 grad_async_v2.h:256] pq is empty
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
W20240130 21:35:14.438757 209715 grad_async_v2.h:256] pq is empty
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
W20240130 21:35:14.780771 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
E20240130 21:35:14.843041 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:15.389605 209715 grad_async_v2.h:256] pq is empty
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.690 us                | 4.346 ms                  |
| GenInput                  | 35.282 ms                 | 48.621 ms                 |
| NN                        | 637.702 us                | 1.793 ms                  |
| Forward                   | 947.490 us                | 5.351 ms                  |
| Backward                  | 2.013 ms                  | 11.807 ms                 |
| Optimize                  | 216.530 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 37.889 us                 | 4.492 ms                  |
| AfterBackward             | 341.985 ms                | 1.363 s                   |
| BlockToStepN              | 472.037 us                | 4.706 ms                  |
| OneStep                   | 379.102 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:35:15.843291 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:15.889317 209715 grad_async_v2.h:256] pq is empty
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
W20240130 21:35:15.902455 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
W20240130 21:35:16.312841 209715 grad_async_v2.h:256] pq is empty
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 121.201 us                | 5.061 ms                  |
| ProcessBack:Shuffle       | 329.130 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.295 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.308 us                 | 101.910 us                |
| ProcessOneStep            | 341.893 ms                | 1.363 s                   |
| BlockToStepN              | 389.958 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
Step399:rank1, time: 50.756, per_step: 0.502532
Step399:rank2, time: 50.756, per_step: 0.502532
Step399:rank0, time: 50.756, per_step: 0.502532
Step399:rank3, time: 50.756, per_step: 0.502535
========== Step 400 ========== 
========== Step 400 ========== 
========== Step 400 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.706 us                | 4.346 ms                  |
| GenInput                  | 35.197 ms                 | 48.621 ms                 |
| NN                        | 636.581 us                | 1.793 ms                  |
| Forward                   | 945.380 us                | 5.351 ms                  |
| Backward                  | 2.016 ms                  | 11.807 ms                 |
| Optimize                  | 216.530 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 37.854 us                 | 4.492 ms                  |
| AfterBackward             | 341.985 ms                | 1.363 s                   |
| BlockToStepN              | 473.199 us                | 4.706 ms                  |
| OneStep                   | 379.102 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 400 ========== 
E20240130 21:35:16.843098 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:16.999953 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end1
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
E20240130 21:35:17.843055 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:35:18.084236 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
W20240130 21:35:18.939728 209715 grad_async_v2.h:256] pq is empty
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
E20240130 21:35:18.947660 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:19.172483 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240130 21:35:19.644531 209715 grad_async_v2.h:256] pq is empty
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
W20240130 21:35:19.869838 209715 grad_async_v2.h:256] pq is empty
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
E20240130 21:35:19.953644 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 168.706 us                | 4.346 ms                  |
| GenInput                  | 35.282 ms                 | 48.621 ms                 |
| NN                        | 636.632 us                | 1.793 ms                  |
| Forward                   | 947.490 us                | 5.351 ms                  |
| Backward                  | 2.016 ms                  | 11.807 ms                 |
| Optimize                  | 216.119 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 37.854 us                 | 4.492 ms                  |
| AfterBackward             | 341.985 ms                | 1.363 s                   |
| BlockToStepN              | 480.647 us                | 4.706 ms                  |
| OneStep                   | 379.102 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:20.675985 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end0
E20240130 21:35:20.953066 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.706 us                | 10.751 ms                 |
| ProcessBack:Shuffle       | 329.130 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.315 ms                  | 16.974 ms                 |
| ProcessBack:UpsertPq      | 58.410 us                 | 118.623 us                |
| ProcessOneStep            | 341.893 ms                | 1.363 s                   |
| BlockToStepN              | 395.895 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:35:21.953379 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:35:22.162528 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
E20240130 21:35:22.953052 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
W20240130 21:35:23.670982 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end6
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
E20240130 21:35:23.953334 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
E20240130 21:35:24.953961 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.112 us                | 4.346 ms                  |
| GenInput                  | 35.293 ms                 | 48.621 ms                 |
| NN                        | 637.702 us                | 1.793 ms                  |
| Forward                   | 957.356 us                | 5.351 ms                  |
| Backward                  | 2.019 ms                  | 11.807 ms                 |
| Optimize                  | 216.291 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 37.371 us                 | 4.492 ms                  |
| AfterBackward             | 338.844 ms                | 1.363 s                   |
| BlockToStepN              | 485.835 us                | 4.706 ms                  |
| OneStep                   | 379.016 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:25.502722 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end0
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
E20240130 21:35:25.954066 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 108.909 us                | 2.360 ms                  |
| ProcessBack:Shuffle       | 320.049 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.305 ms                  | 16.974 ms                 |
| ProcessBack:UpsertPq      | 58.308 us                 | 118.623 us                |
| ProcessOneStep            | 338.777 ms                | 1.363 s                   |
| BlockToStepN              | 400.388 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:26.724807 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end1
E20240130 21:35:26.954465 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
E20240130 21:35:27.955221 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:28.306245 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end2
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
E20240130 21:35:28.955255 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:35:29.670085 209715 grad_async_v2.h:256] pq is empty
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
W20240130 21:35:29.684898 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
E20240130 21:35:29.955027 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:30.201470 209715 grad_async_v2.h:256] pq is empty
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.250 us                | 4.346 ms                  |
| GenInput                  | 35.293 ms                 | 48.621 ms                 |
| NN                        | 641.258 us                | 1.793 ms                  |
| Forward                   | 957.597 us                | 5.351 ms                  |
| Backward                  | 2.024 ms                  | 11.807 ms                 |
| Optimize                  | 216.530 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 38.137 us                 | 4.492 ms                  |
| AfterBackward             | 338.844 ms                | 1.363 s                   |
| BlockToStepN              | 494.492 us                | 4.706 ms                  |
| OneStep                   | 379.016 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
W20240130 21:35:30.850764 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end8
E20240130 21:35:30.956022 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:31.137578 209715 grad_async_v2.h:256] pq is empty
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 113.333 us                | 8.170 ms                  |
| ProcessBack:Shuffle       | 320.049 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.305 ms                  | 16.974 ms                 |
| ProcessBack:UpsertPq      | 58.438 us                 | 127.088 us                |
| ProcessOneStep            | 338.777 ms                | 1.363 s                   |
| BlockToStepN              | 405.107 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
E20240130 21:35:31.956104 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
W20240130 21:35:32.352573 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end2
W20240130 21:35:32.365912 209715 grad_async_v2.h:256] pq is empty
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
E20240130 21:35:32.956288 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:35:33.547945 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
E20240130 21:35:33.956228 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
W20240130 21:35:34.681161 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end5
E20240130 21:35:34.956091 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:35:35.348449 209715 grad_async_v2.h:256] pq is empty
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.250 us                | 4.346 ms                  |
| GenInput                  | 35.333 ms                 | 48.621 ms                 |
| NN                        | 644.143 us                | 1.793 ms                  |
| Forward                   | 961.374 us                | 5.351 ms                  |
| Backward                  | 2.029 ms                  | 11.807 ms                 |
| Optimize                  | 216.853 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 37.889 us                 | 4.492 ms                  |
| AfterBackward             | 338.844 ms                | 1.363 s                   |
| BlockToStepN              | 498.036 us                | 4.706 ms                  |
| OneStep                   | 379.016 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:35.766090 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240130 21:35:35.944715 209715 grad_async_v2.h:256] pq is empty
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
E20240130 21:35:35.956401 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=18
W20240130 21:35:36.508261 209715 grad_async_v2.h:256] pq is empty
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.141 us                | 2.917 ms                  |
| ProcessBack:Shuffle       | 329.130 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.295 ms                  | 16.974 ms                 |
| ProcessBack:UpsertPq      | 58.540 us                 | 127.088 us                |
| ProcessOneStep            | 341.893 ms                | 1.363 s                   |
| BlockToStepN              | 405.787 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
W20240130 21:35:36.893328 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
E20240130 21:35:36.956096 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=36
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
W20240130 21:35:37.784487 209715 grad_async_v2.h:256] pq is empty
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
E20240130 21:35:37.956024 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
W20240130 21:35:38.393769 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end5
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
E20240130 21:35:38.956801 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
E20240130 21:35:39.956148 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
W20240130 21:35:40.313277 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end1
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.112 us                | 2.614 ms                  |
| GenInput                  | 35.220 ms                 | 48.456 ms                 |
| NN                        | 641.974 us                | 1.714 ms                  |
| Forward                   | 957.951 us                | 4.877 ms                  |
| Backward                  | 2.029 ms                  | 9.830 ms                  |
| Optimize                  | 217.412 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 38.137 us                 | 3.467 ms                  |
| AfterBackward             | 335.241 ms                | 1.360 s                   |
| BlockToStepN              | 504.904 us                | 3.419 ms                  |
| OneStep                   | 375.633 ms                | 1.403 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
E20240130 21:35:40.956552 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:41.438109 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 102.008 us                | 200.654 us                |
| ProcessBack:Shuffle       | 301.812 ms                | 1.343 s                   |
| ProcessBack:UpdateCache   | 1.285 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.405 us                 | 118.623 us                |
| ProcessOneStep            | 330.805 ms                | 1.359 s                   |
| BlockToStepN              | 418.512 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:41.551175 209715 grad_async_v2.h:256] pq is empty
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
E20240130 21:35:41.956323 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
W20240130 21:35:42.725718 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
E20240130 21:35:42.956125 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
W20240130 21:35:43.827487 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
E20240130 21:35:43.956131 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:35:44.468930 209715 grad_async_v2.h:256] pq is empty
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
W20240130 21:35:44.858886 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end3
E20240130 21:35:44.956012 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.112 us                | 2.614 ms                  |
| GenInput                  | 35.293 ms                 | 48.456 ms                 |
| NN                        | 644.143 us                | 1.793 ms                  |
| Forward                   | 959.177 us                | 5.351 ms                  |
| Backward                  | 2.031 ms                  | 9.830 ms                  |
| Optimize                  | 216.853 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 40.431 us                 | 3.467 ms                  |
| AfterBackward             | 308.984 ms                | 1.363 s                   |
| BlockToStepN              | 507.198 us                | 4.706 ms                  |
| OneStep                   | 348.815 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
E20240130 21:35:45.956440 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:46.092916 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end4
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.759 us                | 5.817 ms                  |
| ProcessBack:Shuffle       | 300.328 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.305 ms                  | 16.624 ms                 |
| ProcessBack:UpsertPq      | 58.500 us                 | 127.088 us                |
| ProcessOneStep            | 330.518 ms                | 1.363 s                   |
| BlockToStepN              | 424.266 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:35:46.956799 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
W20240130 21:35:47.535477 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end8
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
E20240130 21:35:47.959630 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:48.932564 209715 grad_async_v2.h:256] pq is empty
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
E20240130 21:35:48.959323 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=30
W20240130 21:35:48.974673 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end0
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
E20240130 21:35:49.959031 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.250 us                | 2.614 ms                  |
| GenInput                  | 35.333 ms                 | 48.456 ms                 |
| NN                        | 644.143 us                | 1.793 ms                  |
| Forward                   | 960.641 us                | 5.351 ms                  |
| Backward                  | 2.030 ms                  | 9.830 ms                  |
| Optimize                  | 217.438 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 38.837 us                 | 3.467 ms                  |
| AfterBackward             | 335.241 ms                | 1.363 s                   |
| BlockToStepN              | 515.063 us                | 4.706 ms                  |
| OneStep                   | 375.633 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:50.515653 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end2
E20240130 21:35:50.959134 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.738 us                | 2.072 ms                  |
| ProcessBack:Shuffle       | 308.151 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.310 ms                  | 16.624 ms                 |
| ProcessBack:UpsertPq      | 58.438 us                 | 127.088 us                |
| ProcessOneStep            | 335.205 ms                | 1.363 s                   |
| BlockToStepN              | 431.372 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:51.632294 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
E20240130 21:35:51.959067 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 21:35:52.228112 209715 grad_async_v2.h:256] pq is empty
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
E20240130 21:35:52.959026 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:52.971961 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end7
E20240130 21:35:53.959401 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
W20240130 21:35:54.086078 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
W20240130 21:35:54.679371 209715 grad_async_v2.h:256] pq is empty
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
E20240130 21:35:54.959043 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:55.290283 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.250 us                | 2.614 ms                  |
| GenInput                  | 35.293 ms                 | 48.456 ms                 |
| NN                        | 645.329 us                | 1.793 ms                  |
| Forward                   | 961.893 us                | 5.501 ms                  |
| Backward                  | 2.029 ms                  | 9.830 ms                  |
| Optimize                  | 219.640 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 37.889 us                 | 3.467 ms                  |
| AfterBackward             | 335.241 ms                | 1.363 s                   |
| BlockToStepN              | 518.898 us                | 5.433 ms                  |
| OneStep                   | 375.633 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:55.663712 209715 grad_async_v2.h:256] pq is empty
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
E20240130 21:35:55.959095 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:35:56.169919 209715 grad_async_v2.h:256] pq is empty
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
W20240130 21:35:56.290314 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 121.825 us                | 2.732 ms                  |
| ProcessBack:Shuffle       | 316.929 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.295 ms                  | 16.624 ms                 |
| ProcessBack:UpsertPq      | 58.438 us                 | 127.088 us                |
| ProcessOneStep            | 338.777 ms                | 1.363 s                   |
| BlockToStepN              | 438.488 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:35:56.653740 209715 grad_async_v2.h:256] pq is empty
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
E20240130 21:35:56.959172 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:57.485996 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
W20240130 21:35:57.620906 209715 grad_async_v2.h:256] pq is empty
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
E20240130 21:35:57.959256 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=17
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
W20240130 21:35:58.150959 209715 grad_async_v2.h:256] pq is empty
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
W20240130 21:35:58.514009 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
W20240130 21:35:58.596786 209715 grad_async_v2.h:256] pq is empty
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
W20240130 21:35:58.654908 209715 grad_async_v2.h:256] pq is empty
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
E20240130 21:35:58.959024 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:35:59.718513 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end1
E20240130 21:35:59.959177 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.714 us                | 4.346 ms                  |
| GenInput                  | 35.220 ms                 | 48.456 ms                 |
| NN                        | 644.235 us                | 1.846 ms                  |
| Forward                   | 962.780 us                | 5.795 ms                  |
| Backward                  | 2.031 ms                  | 9.830 ms                  |
| Optimize                  | 219.640 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 38.837 us                 | 3.467 ms                  |
| AfterBackward             | 330.566 ms                | 1.363 s                   |
| BlockToStepN              | 523.222 us                | 5.433 ms                  |
| OneStep                   | 372.360 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:36:00.959115 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:36:01.142875 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.592 us                | 5.259 ms                  |
| ProcessBack:Shuffle       | 300.328 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.288 ms                  | 16.624 ms                 |
| ProcessBack:UpsertPq      | 58.415 us                 | 127.088 us                |
| ProcessOneStep            | 330.518 ms                | 1.363 s                   |
| BlockToStepN              | 444.252 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:36:01.556911 209715 grad_async_v2.h:256] pq is empty
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
E20240130 21:36:01.959247 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:36:02.246798 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end6
W20240130 21:36:02.395267 209715 grad_async_v2.h:256] pq is empty
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
E20240130 21:36:02.959393 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
W20240130 21:36:03.502993 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end9
E20240130 21:36:03.959167 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:36:03.987299 209715 grad_async_v2.h:256] pq is empty
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
W20240130 21:36:04.236855 209715 grad_async_v2.h:256] pq is empty
Step499:rank0, time: 47.469, per_step: 0.469990
Step499:rank1, time: 47.469, per_step: 0.469991
Step499:rank2, time: 47.469, per_step: 0.469991
Step499:rank3, time: 47.469, per_step: 0.469990
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.995 us                | 4.346 ms                  |
| GenInput                  | 35.197 ms                 | 48.456 ms                 |
| NN                        | 645.329 us                | 1.846 ms                  |
| Forward                   | 962.780 us                | 5.795 ms                  |
| Backward                  | 2.029 ms                  | 9.830 ms                  |
| Optimize                  | 219.640 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 38.137 us                 | 3.467 ms                  |
| AfterBackward             | 330.566 ms                | 1.363 s                   |
| BlockToStepN              | 530.639 us                | 5.433 ms                  |
| OneStep                   | 375.010 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:36:04.237669 209715 grad_async_v2.h:89] call StopThreads. PID = 209715
W20240130 21:36:04.237682 209715 grad_base.h:212] before processOneStepNegThread_.join();
W20240130 21:36:04.237725 209715 grad_base.h:214] after processOneStepNegThread_.join();
W20240130 21:36:04.237732 209715 grad_async_v2.h:91] call GradProcessingBase::StopThreads.
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
W20240130 21:36:04.288594 209715 grad_async_v2.h:110] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
timer name is E2E-100
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 169.995 us                | 4.346 ms                  |
| GenInput                  | 35.197 ms                 | 48.456 ms                 |
| NN                        | 645.329 us                | 1.846 ms                  |
| Forward                   | 962.780 us                | 5.795 ms                  |
| Backward                  | 2.029 ms                  | 9.830 ms                  |
| Optimize                  | 219.640 us                | 544.758 us                |
| BarrierTimeBeforeRank0    | 38.137 us                 | 3.467 ms                  |
| AfterBackward             | 330.566 ms                | 1.363 s                   |
| BlockToStepN              | 530.639 us                | 5.433 ms                  |
| OneStep                   | 372.360 ms                | 1.405 s                   |
| E2E-100                   | 48.397 s                  | 50.988 s                  |
+---------------------------+---------------------------+---------------------------+
ERROR [209715 PsKvstore.py:89] Delete tensor failed, not found
On rank0, prepare to call self.controller.StopThreads(), self=<controller_process.KGCacheControllerWrapper object at 0x7f838604f650>
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 117.852 us                | 6.832 ms                  |
| ProcessBack:Shuffle       | 300.328 ms                | 1.344 s                   |
| ProcessBack:UpdateCache   | 1.288 ms                  | 16.624 ms                 |
| ProcessBack:UpsertPq      | 58.415 us                 | 127.088 us                |
| ProcessOneStep            | 330.518 ms                | 1.363 s                   |
| BlockToStepN              | 444.416 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
