Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
|Train|: 304727650
random partition 304727650 edges into 5 parts
part 0 has 60945530 edges
part 1 has 60945530 edges
part 2 has 60945530 edges
part 3 has 60945530 edges
part 4 has 60945530 edges
ARGS:  Namespace(adversarial_temperature=1.0, async_update=None, batch_size=1000, batch_size_eval=16, data_files=None, data_path='/home/xieminhui/dgl-data', dataset='Freebase', delimiter='\t', double_ent=False, double_rel=False, eval_filter=True, eval_interval=10000, eval_percent=1, force_sync_interval=1000, format='built_in', gamma=16.0, gpu=[0, 1, 2, 3, 4], has_edge_importance=False, hidden_dim=400, log_interval=1000, loss_genre='Logsigmoid', lr=0.01, margin=1.0, max_step=10000, mix_cpu_gpu=True, model_name='TransE_l1', neg_adversarial_sampling=False, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size=200, neg_sample_size_eval=86054151, no_eval_filter=False, no_save_emb=True, nr_gpus=5, num_proc=5, num_thread=1, num_workers=8, pairwise=False, regularization_coef=1e-07, regularization_norm=3, rel_part=False, save_path='/tmp/ckpts/TransE_l1_Freebase_4', soft_rel_part=False, strict_rel_part=False, test=True, valid=False)
|valid|: 16929318
|test|: 16929308
Total initialize time 718.636 seconds
Using backend: pytorch
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl/python/dgl/base.py:45: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  return warnings.warn(message, category=category, stacklevel=1)
[proc 4][Train](1000/10000) average pos_loss: 0.6722108563184738
[proc 4][Train](1000/10000) average neg_loss: 0.6876948353052139
[proc 4][Train](1000/10000) average loss: 0.6799528459906579
[proc 4][Train](1000/10000) average regularization: 8.293626022805257e-06
[proc 4] 1000 steps, total: 36.760, sample: 14.687, forward: 12.901, backward: 2.790, update: 6.373
[proc 2][Train](1000/10000) average pos_loss: 0.6707835027873517
[proc 2][Train](1000/10000) average neg_loss: 0.6918542732596398
[proc 2][Train](1000/10000) average loss: 0.681318888604641
[proc 2][Train](1000/10000) average regularization: 8.249137080838409e-06
[proc 2] 1000 steps, total: 37.917, sample: 14.245, forward: 12.805, backward: 2.824, update: 6.225
[proc 1][Train](1000/10000) average pos_loss: 0.6773085805177689
[proc 1][Train](1000/10000) average neg_loss: 0.690262360394001
[proc 1][Train](1000/10000) average loss: 0.6837854715585708
[proc 1][Train](1000/10000) average regularization: 8.248964298218198e-06
[proc 1] 1000 steps, total: 38.460, sample: 14.317, forward: 12.900, backward: 2.870, update: 6.639
[proc 0][Train](1000/10000) average pos_loss: 0.6715772764980793
[proc 0][Train](1000/10000) average neg_loss: 0.6948021944761277
[proc 0][Train](1000/10000) average loss: 0.6831897346973419
[proc 0][Train](1000/10000) average regularization: 8.187792778016956e-06
[proc 0] 1000 steps, total: 39.031, sample: 14.092, forward: 13.048, backward: 2.907, update: 6.763
[proc 3][Train](1000/10000) average pos_loss: 0.6726397659182548
[proc 3][Train](1000/10000) average neg_loss: 0.6889462488889694
[proc 3][Train](1000/10000) average loss: 0.6807930076122284
[proc 3][Train](1000/10000) average regularization: 8.274498864466296e-06
[proc 3] 1000 steps, total: 37.309, sample: 13.702, forward: 12.937, backward: 2.793, update: 6.242
[proc 3][Train](2000/10000) average pos_loss: 0.6902440525889396
[proc 3][Train](2000/10000) average neg_loss: 0.679916541337967
[proc 3][Train](2000/10000) average loss: 0.6850802989602089
[proc 3][Train](2000/10000) average regularization: 7.167576013216603e-06
[proc 3] 2000 steps, total: 19.613, sample: 2.489, forward: 7.902, backward: 2.755, update: 6.458
[proc 2][Train](2000/10000) average pos_loss: 0.6893423920869828
[proc 2][Train](2000/10000) average neg_loss: 0.6819348008036613
[proc 2][Train](2000/10000) average loss: 0.6856385964155197
[proc 2][Train](2000/10000) average regularization: 7.170692418185354e-06
[proc 2] 2000 steps, total: 19.614, sample: 2.461, forward: 7.665, backward: 2.755, update: 6.182
[proc 1][Train](2000/10000) average pos_loss: 0.6899121185541153
[proc 1][Train](2000/10000) average neg_loss: 0.6808870356678963
[proc 1][Train](2000/10000) average loss: 0.6853995772600174
[proc 1][Train](2000/10000) average regularization: 7.172704820732179e-06
[proc 1] 2000 steps, total: 19.614, sample: 2.461, forward: 7.478, backward: 2.747, update: 6.552
[proc 4][Train](2000/10000) average pos_loss: 0.6903647725582123
[proc 4][Train](2000/10000) average neg_loss: 0.6814739356040954
[proc 4][Train](2000/10000) average loss: 0.6859193533062935
[proc 4][Train](2000/10000) average regularization: 7.180188310485391e-06
[proc 4] 2000 steps, total: 19.615, sample: 2.536, forward: 7.687, backward: 2.833, update: 6.245
[proc 0][Train](2000/10000) average pos_loss: 0.689990653693676
[proc 0][Train](2000/10000) average neg_loss: 0.6816123933792114
[proc 0][Train](2000/10000) average loss: 0.6858015240430831
[proc 0][Train](2000/10000) average regularization: 7.172369741056172e-06
[proc 0] 2000 steps, total: 19.614, sample: 2.448, forward: 7.420, backward: 2.806, update: 6.517
[proc 3][Train](3000/10000) average pos_loss: 0.6992606560587883
[proc 3][Train](3000/10000) average neg_loss: 0.672370611846447
[proc 3][Train](3000/10000) average loss: 0.6858156348466873
[proc 3][Train](3000/10000) average regularization: 6.436631591896003e-06
[proc 3] 3000 steps, total: 18.472, sample: 2.478, forward: 6.780, backward: 2.789, update: 6.418
[proc 2][Train](3000/10000) average pos_loss: 0.6988431836366653
[proc 2][Train](3000/10000) average neg_loss: 0.6725211421251297
[proc 2][Train](3000/10000) average loss: 0.6856821633577347
[proc 2][Train](3000/10000) average regularization: 6.441750340400176e-06
[proc 2] 3000 steps, total: 18.472, sample: 2.478, forward: 6.549, backward: 2.869, update: 6.173
[proc 4][Train](3000/10000) average pos_loss: 0.699202240049839
[proc 4][Train](3000/10000) average neg_loss: 0.6730891540050506
[proc 4][Train](3000/10000) average loss: 0.6861456974148751
[proc 4][Train](3000/10000) average regularization: 6.441538051149109e-06
[proc 4] 3000 steps, total: 18.472, sample: 2.478, forward: 6.514, backward: 2.811, update: 6.176
[proc 1][Train](3000/10000) average pos_loss: 0.6980497394800186
[proc 1][Train](3000/10000) average neg_loss: 0.6738313786387443
[proc 1][Train](3000/10000) average loss: 0.6859405596852303
[proc 1][Train](3000/10000) average regularization: 6.443299092552479e-06
[proc 1] 3000 steps, total: 18.472, sample: 2.572, forward: 6.258, backward: 2.848, update: 6.503
[proc 0][Train](3000/10000) average pos_loss: 0.6997473394274711
[proc 0][Train](3000/10000) average neg_loss: 0.6721710752248764
[proc 0][Train](3000/10000) average loss: 0.6859592071771622
[proc 0][Train](3000/10000) average regularization: 6.436900735479867e-06
[proc 0] 3000 steps, total: 18.472, sample: 2.568, forward: 6.154, backward: 2.818, update: 6.584
[proc 1][Train](4000/10000) average pos_loss: 0.7055251424312592
[proc 1][Train](4000/10000) average neg_loss: 0.6642626013159751
[proc 1][Train](4000/10000) average loss: 0.6848938716650009
[proc 1][Train](4000/10000) average regularization: 6.4803719033079685e-06
[proc 1] 4000 steps, total: 17.584, sample: 2.414, forward: 5.886, backward: 2.833, update: 6.443
[proc 3][Train](4000/10000) average pos_loss: 0.7058151721954345
[proc 3][Train](4000/10000) average neg_loss: 0.6618786501288414
[proc 3][Train](4000/10000) average loss: 0.6838469097614288
[proc 3][Train](4000/10000) average regularization: 6.4796627366376925e-06
[proc 3] 4000 steps, total: 17.585, sample: 2.360, forward: 6.205, backward: 2.741, update: 6.271
[proc 2][Train](4000/10000) average pos_loss: 0.7048594982028008
[proc 2][Train](4000/10000) average neg_loss: 0.6633362342715263
[proc 2][Train](4000/10000) average loss: 0.6840978664755821
[proc 2][Train](4000/10000) average regularization: 6.477691778854933e-06
[proc 2] 4000 steps, total: 17.585, sample: 2.403, forward: 6.113, backward: 2.864, update: 5.987
[proc 0][Train](4000/10000) average pos_loss: 0.7050433026552201
[proc 0][Train](4000/10000) average neg_loss: 0.6627758122682571
[proc 0][Train](4000/10000) average loss: 0.6839095574617385
[proc 0][Train](4000/10000) average regularization: 6.484009133600921e-06
[proc 0] 4000 steps, total: 17.585, sample: 2.424, forward: 5.814, backward: 2.796, update: 6.465
[proc 4][Train](4000/10000) average pos_loss: 0.7047367216944694
[proc 4][Train](4000/10000) average neg_loss: 0.6628044654726982
[proc 4][Train](4000/10000) average loss: 0.683770594716072
[proc 4][Train](4000/10000) average regularization: 6.4807353755895745e-06
[proc 4] 4000 steps, total: 17.585, sample: 2.413, forward: 6.005, backward: 2.818, update: 6.204
[proc 3][Train](5000/10000) average pos_loss: 0.7091904625296592
[proc 3][Train](5000/10000) average neg_loss: 0.6531909712553025
[proc 3][Train](5000/10000) average loss: 0.6811907173395156
[proc 3][Train](5000/10000) average regularization: 6.613858299260756e-06
[proc 3] 5000 steps, total: 17.712, sample: 2.623, forward: 5.955, backward: 2.760, update: 6.365
[proc 2][Train](5000/10000) average pos_loss: 0.7078771044015885
[proc 2][Train](5000/10000) average neg_loss: 0.6533798867464066
[proc 2][Train](5000/10000) average loss: 0.6806284952759742
[proc 2][Train](5000/10000) average regularization: 6.61493972165772e-06
[proc 2] 5000 steps, total: 17.711, sample: 2.570, forward: 5.896, backward: 2.853, update: 6.117
[proc 0][Train](5000/10000) average pos_loss: 0.708981371819973
[proc 0][Train](5000/10000) average neg_loss: 0.6530212119817734
[proc 0][Train](5000/10000) average loss: 0.681001290500164
[proc 0][Train](5000/10000) average regularization: 6.6108723394791016e-06
[proc 0] 5000 steps, total: 17.711, sample: 2.681, forward: 5.616, backward: 2.740, update: 6.449
[proc 1][Train](5000/10000) average pos_loss: 0.7091131081581116
[proc 1][Train](5000/10000) average neg_loss: 0.6541096205711365
[proc 1][Train](5000/10000) average loss: 0.6816113642454147
[proc 1][Train](5000/10000) average regularization: 6.613125595777092e-06
[proc 1] 5000 steps, total: 17.712, sample: 2.627, forward: 5.656, backward: 2.821, update: 6.341
[proc 4][Train](5000/10000) average pos_loss: 0.7083755986690521
[proc 4][Train](5000/10000) average neg_loss: 0.6547570052146912
[proc 4][Train](5000/10000) average loss: 0.6815663005709648
[proc 4][Train](5000/10000) average regularization: 6.612943964228179e-06
[proc 4] 5000 steps, total: 17.712, sample: 2.601, forward: 5.898, backward: 2.888, update: 6.104
[proc 4][Train](6000/10000) average pos_loss: 0.7098554128408432
[proc 4][Train](6000/10000) average neg_loss: 0.6441203071475029
[proc 4][Train](6000/10000) average loss: 0.6769878603219986
[proc 4][Train](6000/10000) average regularization: 6.755364833679778e-06
[proc 4] 6000 steps, total: 17.424, sample: 2.498, forward: 5.909, backward: 2.875, update: 6.135
[proc 3][Train](6000/10000) average pos_loss: 0.7093524392843247
[proc 3][Train](6000/10000) average neg_loss: 0.644367894411087
[proc 3][Train](6000/10000) average loss: 0.6768601665496826
[proc 3][Train](6000/10000) average regularization: 6.7553521339505095e-06
[proc 3] 6000 steps, total: 17.425, sample: 2.340, forward: 5.691, backward: 2.756, update: 6.555
[proc 0][Train](6000/10000) average pos_loss: 0.7106800934672356
[proc 0][Train](6000/10000) average neg_loss: 0.643391973644495
[proc 0][Train](6000/10000) average loss: 0.6770360339283943
[proc 0][Train](6000/10000) average regularization: 6.755541489837924e-06
[proc 0] 6000 steps, total: 17.425, sample: 2.458, forward: 5.531, backward: 2.730, update: 6.504
[proc 1][Train](6000/10000) average pos_loss: 0.7107252332568169
[proc 1][Train](6000/10000) average neg_loss: 0.6440140397548676
[proc 1][Train](6000/10000) average loss: 0.6773696366548538
[proc 1][Train](6000/10000) average regularization: 6.756459207736043e-06
[proc 1] 6000 steps, total: 17.425, sample: 2.437, forward: 5.579, backward: 2.758, update: 6.407
[proc 2][Train](6000/10000) average pos_loss: 0.7099412606954575
[proc 2][Train](6000/10000) average neg_loss: 0.645026342689991
[proc 2][Train](6000/10000) average loss: 0.6774838000535965
[proc 2][Train](6000/10000) average regularization: 6.7498555590646e-06
[proc 2] 6000 steps, total: 17.426, sample: 2.449, forward: 5.832, backward: 2.822, update: 5.976
[proc 3][Train](7000/10000) average pos_loss: 0.7095500648617744
[proc 3][Train](7000/10000) average neg_loss: 0.6351654834747315
[proc 3][Train](7000/10000) average loss: 0.672357773900032
[proc 3][Train](7000/10000) average regularization: 6.900674502958281e-06
[proc 3] 7000 steps, total: 17.343, sample: 2.437, forward: 5.672, backward: 2.740, update: 6.486
[proc 0][Train](7000/10000) average pos_loss: 0.7101693364977837
[proc 0][Train](7000/10000) average neg_loss: 0.6342811685800552
[proc 0][Train](7000/10000) average loss: 0.6722252524495125
[proc 0][Train](7000/10000) average regularization: 6.909070275924023e-06
[proc 0] 7000 steps, total: 17.343, sample: 2.558, forward: 5.486, backward: 2.785, update: 6.441
[proc 2][Train](7000/10000) average pos_loss: 0.7102735354304314
[proc 2][Train](7000/10000) average neg_loss: 0.6344210225343704
[proc 2][Train](7000/10000) average loss: 0.6723472800254822
[proc 2][Train](7000/10000) average regularization: 6.9001655083411606e-06
[proc 2] 7000 steps, total: 17.343, sample: 2.466, forward: 5.789, backward: 2.853, update: 6.104
[proc 4][Train](7000/10000) average pos_loss: 0.710733412861824
[proc 4][Train](7000/10000) average neg_loss: 0.6347644669413567
[proc 4][Train](7000/10000) average loss: 0.6727489393949508
[proc 4][Train](7000/10000) average regularization: 6.9013960383017546e-06
[proc 4] 7000 steps, total: 17.344, sample: 2.504, forward: 5.823, backward: 2.819, update: 5.998
[proc 1][Train](7000/10000) average pos_loss: 0.71141876745224
[proc 1][Train](7000/10000) average neg_loss: 0.634042918920517
[proc 1][Train](7000/10000) average loss: 0.6727308431863784
[proc 1][Train](7000/10000) average regularization: 6.9060218670529136e-06
[proc 1] 7000 steps, total: 17.344, sample: 2.516, forward: 5.540, backward: 2.820, update: 6.325
[proc 2][Train](8000/10000) average pos_loss: 0.7092728328108787
[proc 2][Train](8000/10000) average neg_loss: 0.6247746945619583
[proc 2][Train](8000/10000) average loss: 0.6670237640738488
[proc 2][Train](8000/10000) average regularization: 7.041356822355738e-06
[proc 2] 8000 steps, total: 17.298, sample: 2.274, forward: 5.714, backward: 2.802, update: 5.850
[proc 3][Train](8000/10000) average pos_loss: 0.7086255747079849
[proc 3][Train](8000/10000) average neg_loss: 0.6244596844613552
[proc 3][Train](8000/10000) average loss: 0.6665426298975945
[proc 3][Train](8000/10000) average regularization: 7.0447455254907255e-06
[proc 3] 8000 steps, total: 17.299, sample: 2.360, forward: 5.761, backward: 2.740, update: 6.430
[proc 4][Train](8000/10000) average pos_loss: 0.7095072298645974
[proc 4][Train](8000/10000) average neg_loss: 0.6249424513280392
[proc 4][Train](8000/10000) average loss: 0.667224839925766
[proc 4][Train](8000/10000) average regularization: 7.04119568626993e-06
[proc 4] 8000 steps, total: 17.299, sample: 2.441, forward: 5.774, backward: 2.884, update: 6.108
[proc 0][Train](8000/10000) average pos_loss: 0.7097840115427971
[proc 0][Train](8000/10000) average neg_loss: 0.6250296942293644
[proc 0][Train](8000/10000) average loss: 0.6674068523645401
[proc 0][Train](8000/10000) average regularization: 7.03723977358095e-06
[proc 0] 8000 steps, total: 17.299, sample: 2.397, forward: 5.440, backward: 2.725, update: 6.451
[proc 1][Train](8000/10000) average pos_loss: 0.7084889689087868
[proc 1][Train](8000/10000) average neg_loss: 0.6246039197444916
[proc 1][Train](8000/10000) average loss: 0.6665464433431625
[proc 1][Train](8000/10000) average regularization: 7.041463355108135e-06
[proc 1] 8000 steps, total: 17.299, sample: 2.393, forward: 5.457, backward: 2.757, update: 6.356
[proc 0][Train](9000/10000) average pos_loss: 0.7060425748229027
[proc 0][Train](9000/10000) average neg_loss: 0.6151867599785328
[proc 0][Train](9000/10000) average loss: 0.660614667057991
[proc 0][Train](9000/10000) average regularization: 7.177479199981462e-06
[proc 0] 9000 steps, total: 17.320, sample: 2.654, forward: 5.469, backward: 2.738, update: 6.451
[proc 4][Train](9000/10000) average pos_loss: 0.7054187457561493
[proc 4][Train](9000/10000) average neg_loss: 0.6132799122333527
[proc 4][Train](9000/10000) average loss: 0.6593493297696114
[proc 4][Train](9000/10000) average regularization: 7.182571150678995e-06
[proc 4] 9000 steps, total: 17.321, sample: 2.621, forward: 5.818, backward: 2.847, update: 5.967
[proc 3][Train](9000/10000) average pos_loss: 0.7065016282200813
[proc 3][Train](9000/10000) average neg_loss: 0.6149011635184288
[proc 3][Train](9000/10000) average loss: 0.6607013958096504
[proc 3][Train](9000/10000) average regularization: 7.178223567279929e-06
[proc 3] 9000 steps, total: 17.321, sample: 2.477, forward: 5.592, backward: 2.743, update: 6.372
[proc 1][Train](9000/10000) average pos_loss: 0.7057926670312882
[proc 1][Train](9000/10000) average neg_loss: 0.614867667376995
[proc 1][Train](9000/10000) average loss: 0.6603301669955254
[proc 1][Train](9000/10000) average regularization: 7.179189483395021e-06
[proc 1] 9000 steps, total: 17.320, sample: 2.591, forward: 5.415, backward: 2.837, update: 6.387
[proc 2][Train](9000/10000) average pos_loss: 0.7062123064398765
[proc 2][Train](9000/10000) average neg_loss: 0.6143170219063759
[proc 2][Train](9000/10000) average loss: 0.6602646644115449
[proc 2][Train](9000/10000) average regularization: 7.177392920766579e-06
[proc 2] 9000 steps, total: 17.322, sample: 2.540, forward: 5.702, backward: 2.778, update: 5.904
[proc 4][Train](10000/10000) average pos_loss: 0.7035329688191414
[proc 4][Train](10000/10000) average neg_loss: 0.604742302775383
[proc 4][Train](10000/10000) average loss: 0.6541376363635063
[proc 4][Train](10000/10000) average regularization: 7.3144799639521805e-06
[proc 4] 10000 steps, total: 17.068, sample: 2.495, forward: 5.816, backward: 2.829, update: 5.921
proc 4 takes 196.600 seconds
[proc 1][Train](10000/10000) average pos_loss: 0.7030399969220161
[proc 1][Train](10000/10000) average neg_loss: 0.6042507911622524
[proc 1][Train](10000/10000) average loss: 0.6536453930735588
[proc 1][Train](10000/10000) average regularization: 7.317339480323426e-06
[proc 1] 10000 steps, total: 17.068, sample: 2.441, forward: 5.534, backward: 2.742, update: 6.274
proc 1 takes 198.300 seconds
[proc 3][Train](10000/10000) average pos_loss: 0.7028537054657936
[proc 3][Train](10000/10000) average neg_loss: 0.6046330135762692
[proc 3][Train](10000/10000) average loss: 0.6537433605790138
[proc 3][Train](10000/10000) average regularization: 7.31478453553791e-06
[proc 3] 10000 steps, total: 17.069, sample: 2.278, forward: 5.612, backward: 2.765, update: 6.344
proc 3 takes 197.149 seconds
[proc 2][Train](10000/10000) average pos_loss: 0.7027432733178138
[proc 2][Train](10000/10000) average neg_loss: 0.6052649164795876
[proc 2][Train](10000/10000) average loss: 0.654004094839096
[proc 2][Train](10000/10000) average regularization: 7.31578085651563e-06
[proc 2] 10000 steps, total: 17.068, sample: 2.314, forward: 5.731, backward: 2.795, update: 5.867
[proc 0][Train](10000/10000) average pos_loss: 0.7029408810734749
[proc 0][Train](10000/10000) average neg_loss: 0.6047573719918727
[proc 0][Train](10000/10000) average loss: 0.6538491271734238
[proc 0][Train](10000/10000) average regularization: 7.314635704005923e-06
[proc 0] 10000 steps, total: 17.069, sample: 2.451, forward: 5.415, backward: 2.654, update: 6.411
proc 2 takes 197.757 seconds
proc 0 takes 198.871 seconds
Successfully xmh. training takes 214.8601541519165 seconds
