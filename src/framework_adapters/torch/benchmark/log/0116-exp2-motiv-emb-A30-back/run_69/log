WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240116 12:05:06.410567 26817 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240116 12:05:06.411893 26817 IPCTensor.h:367] NewIPCTensor: full_emb [100000000, 32]0x100000002000
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:165: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [26817 perf_emb.py:165] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f12bb834860>==========
Worker 1 pid=26966
Worker 2 pid=26968
INFO [26817 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [26968 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [26968 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [26966 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [26970 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [26966 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 12:05:09.744158 26968 IPCTensor.h:346] IPCTensor full_emb already exists
INFO [26970 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 12:05:09.744419 26966 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 12:05:09.744722 26970 IPCTensor.h:346] IPCTensor full_emb already exists
INFO [26817 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 12:05:09.745060 26817 IPCTensor.h:346] IPCTensor full_emb already exists
W20240116 12:05:09.747481 26817 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [20000000, 32]; dev=0; size=2.384 GB
W20240116 12:05:09.747566 26966 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [20000000, 32]; dev=1; size=2.384 GB
W20240116 12:05:09.747870 26968 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [20000000, 32]; dev=2; size=2.384 GB
W20240116 12:05:09.748813 26970 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [20000000, 32]; dev=3; size=2.384 GB
W20240116 12:05:09.761148 26966 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1002faf14000
W20240116 12:05:09.761150 26817 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1002fafd9000
W20240116 12:05:09.761186 26968 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1002fb09e000
W20240116 12:05:09.761265 26817 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1002fb228000
W20240116 12:05:09.761266 26970 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x1002fb163000
W20240116 12:05:09.761287 26966 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x1002fb2ed000
W20240116 12:05:09.761330 26817 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 32]0x1002fb477000
W20240116 12:05:09.761328 26968 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x1002fb3b2000
W20240116 12:05:09.761353 26966 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 32]0x1002fc0ae000
W20240116 12:05:09.761379 26817 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 32]0x1002fcce5000
W20240116 12:05:09.761402 26966 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 32]0x1002fd91c000
W20240116 12:05:09.761417 26968 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 32]0x1002fe553000
W20240116 12:05:09.761420 26817 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 12:05:09.761452 26966 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 12:05:09.761457 26970 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1002ff18a000
W20240116 12:05:09.761474 26968 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 32]0x1002ff24f000
W20240116 12:05:09.761531 26968 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 12:05:09.761554 26970 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 32]0x1002ffe86000
W20240116 12:05:09.761634 26970 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 32]0x100300abd000
W20240116 12:05:09.761708 26970 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240116 12:05:09.761813 26817 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 12:05:09.761852 26966 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 12:05:09.761952 26968 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 12:05:09.762233 26970 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 32]; dev=3; size=12.21 MB
Worker 3 pid=26970
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 20000000), (20000000, 40000000), (40000000, 60000000), (60000000, 80000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
W20240116 12:05:13.324801 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x100301704000
W20240116 12:05:13.324988 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x1003017c9000
W20240116 12:05:13.325037 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x10030188e000
W20240116 12:05:13.325078 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x100301953000
W20240116 12:05:13.325117 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x100301a18000
W20240116 12:05:13.325151 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x100301ba2000
W20240116 12:05:13.325150 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x100301add000
W20240116 12:05:13.325188 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x100301c67000
W20240116 12:05:13.325240 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100301eb6000
W20240116 12:05:13.325227 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x100301df1000
W20240116 12:05:13.325223 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100301d2c000
W20240116 12:05:13.325276 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x100301f7b000
W20240116 12:05:13.325313 26817 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x100302040000
W20240116 12:05:13.325359 26817 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x100302105000
W20240116 12:05:13.325398 26817 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x100302107000
W20240116 12:05:13.325434 26817 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100302109000
W20240116 12:05:13.325438 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x10030210b000
W20240116 12:05:13.325492 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x1003021d0000
W20240116 12:05:13.325497 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x100302295000
W20240116 12:05:13.325510 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x10030235a000
W20240116 12:05:13.325552 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x10030241f000
Construct PerfSampler done
W20240116 12:05:13.325603 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x1003024e4000
W20240116 12:05:13.325608 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x1003025a9000
W20240116 12:05:13.325625 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x10030266e000
I20240116 12:05:13.325647 26817 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240116 12:05:13.325671 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100302733000
W20240116 12:05:13.325697 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x1003027f8000
W20240116 12:05:13.325719 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x1003028bd000
W20240116 12:05:13.325739 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100302982000
W20240116 12:05:13.325778 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100302a47000
W20240116 12:05:13.325798 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100302b0c000
W20240116 12:05:13.325807 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x100302bd1000
W20240116 12:05:13.325857 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x100302c96000
W20240116 12:05:13.325861 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100302d5b000
W20240116 12:05:13.325892 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100302e20000
W20240116 12:05:13.325922 26966 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100302ee5000
W20240116 12:05:13.325953 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100302faa000
W20240116 12:05:13.325978 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x10030306f000
W20240116 12:05:13.325982 26966 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x100303134000
W20240116 12:05:13.326038 26966 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x100303136000
W20240116 12:05:13.326048 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x100303138000
W20240116 12:05:13.326062 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x1003031fd000
W20240116 12:05:13.326092 26966 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1003032c2000
W20240116 12:05:13.326129 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x1003032c4000
W20240116 12:05:13.326139 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x100303389000
W20240116 12:05:13.326220 26968 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x10030344e000
W20240116 12:05:13.326234 26970 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x100303513000
Construct PerfSampler done
W20240116 12:05:13.326318 26968 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x1003035d8000
W20240116 12:05:13.326328 26970 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x1003035da000
W20240116 12:05:13.326380 26968 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x1003035dc000
W20240116 12:05:13.326387 26970 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x1003035de000
I20240116 12:05:13.326406 26966 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240116 12:05:13.326435 26968 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1003035e0000
W20240116 12:05:13.326450 26970 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1003035e2000
Construct PerfSampler done
Construct PerfSampler done
I20240116 12:05:13.326757 26968 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240116 12:05:13.326774 26970 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240116 12:05:13.327548 26817 grad_base.h:54] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.2,
        "backgrad_init": "both"
    }
W20240116 12:05:13.327747 26817 grad_base.h:169] Init GradProcessingBase done
I20240116 12:05:29.610127 26817 grad_async_v2.h:32] Use background thread to update emb.
W20240116 12:05:29.610404 26817 kg_controller.h:78] after init GradAsyncProcessingV2
I20240116 12:05:29.610412 26817 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240116 12:05:29.943737 26817 grad_base.h:59] GraphEnv RegTensorsPerProcess
W20240116 12:05:31.644430 27787 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:05:31.644769 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240116 12:05:32.644030 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=11257
W20240116 12:05:32.660173 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 12:05:33.644011 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=8418
W20240116 12:05:33.746765 27787 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 12:05:34.645426 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240116 12:05:34.812665 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
Before Training
I20240116 12:05:35.122460 26817 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
Before Training
I20240116 12:05:35.204205 26966 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 12:05:35.263111 26968 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 12:05:35.332099 26970 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240116 12:05:37.508994 26817 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240116 12:05:37.553496 26817 grad_async_v2.h:209] pq is empty
========== Step 1 ========== 
W20240116 12:05:37.554301 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 598.167 us                | 34.690 ms                 |
| Backward                  | 909.237 us                | 28.915 ms                 |
| Optimize                  | 135.606 us                | 237.499 us                |
| BarrierTimeBeforeRank0    | 13.874 ms                 | 13.874 ms                 |
| AfterBackward             | 1.901 s                   | 1.901 s                   |
| BlockToStepN              | 399.487 us                | 399.487 us                |
+---------------------------+---------------------------+---------------------------+
E20240116 12:05:38.799710 26817 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240116 12:05:38.860178 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=2, pq.top=2
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
W20240116 12:05:38.882589 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
W20240116 12:05:39.190387 26817 grad_async_v2.h:209] pq is empty
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
E20240116 12:05:39.799010 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1850
W20240116 12:05:39.884655 27787 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.897 ms                  | 219.374 ms                |
| ProcessBack:UpdateCache   | 3.564 ms                  | 1.595 s                   |
| ProcessBack:UpsertPq      | 49.827 ms                 | 61.687 ms                 |
| ProcessOneStep            | 61.134 ms                 | 1.900 s                   |
| BlockToStepN              | 155.455 us                | 21.825 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:05:40.049556 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=6, pq.top=5
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
W20240116 12:05:40.613749 26817 grad_async_v2.h:209] pq is empty
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
E20240116 12:05:40.799013 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=15139
W20240116 12:05:40.877786 26817 grad_async_v2.h:209] pq is empty
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
W20240116 12:05:40.929502 27787 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
W20240116 12:05:41.141636 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=10, pq.top=10
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
W20240116 12:05:41.392190 26817 grad_async_v2.h:209] pq is empty
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
W20240116 12:05:41.667554 26817 grad_async_v2.h:209] pq is empty
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240116 12:05:41.799008 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=9993
W20240116 12:05:41.919167 26817 grad_async_v2.h:209] pq is empty
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
W20240116 12:05:41.972277 27787 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240116 12:05:42.432459 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=15, pq.top=15
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
W20240116 12:05:42.671238 26817 grad_async_v2.h:209] pq is empty
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240116 12:05:42.799008 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=10311
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
W20240116 12:05:42.979141 27787 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
W20240116 12:05:43.177207 26817 grad_async_v2.h:209] pq is empty
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 332.287 us                | 34.690 ms                 |
| Backward                  | 836.286 us                | 28.915 ms                 |
| Optimize                  | 119.664 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 482.270 us                | 935.061 ms                |
| AfterBackward             | 54.680 ms                 | 1.901 s                   |
| BlockToStepN              | 270.900 us                | 21.927 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:05:43.432070 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=19, pq.top=19
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
E20240116 12:05:43.799008 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=8170
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
W20240116 12:05:44.015178 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
E20240116 12:05:44.799013 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=12313
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.857 ms                  | 219.374 ms                |
| ProcessBack:UpdateCache   | 3.488 ms                  | 1.595 s                   |
| ProcessBack:UpsertPq      | 44.815 ms                 | 61.687 ms                 |
| ProcessOneStep            | 51.362 ms                 | 1.900 s                   |
| BlockToStepN              | 207.171 us                | 21.825 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:05:45.048748 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
W20240116 12:05:45.248836 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=25, pq.top=25
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
E20240116 12:05:45.799011 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=9115
W20240116 12:05:46.102876 26817 grad_async_v2.h:209] pq is empty
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
W20240116 12:05:46.103430 27787 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
W20240116 12:05:46.628118 26817 grad_async_v2.h:209] pq is empty
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
E20240116 12:05:46.799014 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=7760
W20240116 12:05:47.109099 26817 grad_async_v2.h:209] pq is empty
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240116 12:05:47.109874 27787 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
E20240116 12:05:47.799018 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=12139
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
W20240116 12:05:48.135468 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 341.838 us                | 34.690 ms                 |
| Backward                  | 782.575 us                | 28.915 ms                 |
| Optimize                  | 129.499 us                | 452.738 us                |
| BarrierTimeBeforeRank0    | 492.897 us                | 935.061 ms                |
| AfterBackward             | 56.504 ms                 | 1.901 s                   |
| BlockToStepN              | 452.708 us                | 21.927 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:05:48.365038 26817 grad_async_v2.h:209] pq is empty
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
W20240116 12:05:48.762893 26817 grad_async_v2.h:209] pq is empty
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
E20240116 12:05:48.799019 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=2001
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
W20240116 12:05:49.195228 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
W20240116 12:05:49.479364 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=35, pq.top=35
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
E20240116 12:05:49.801929 26817 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240116 12:05:49.840831 26817 grad_async_v2.h:209] pq is empty
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.857 ms                  | 219.374 ms                |
| ProcessBack:UpdateCache   | 3.507 ms                  | 1.595 s                   |
| ProcessBack:UpsertPq      | 52.761 ms                 | 141.095 ms                |
| ProcessOneStep            | 59.638 ms                 | 1.900 s                   |
| BlockToStepN              | 356.204 us                | 21.825 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
W20240116 12:05:50.257499 27787 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
W20240116 12:05:50.524444 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=38, pq.top=38
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
E20240116 12:05:50.801009 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=15331
W20240116 12:05:50.885073 26817 grad_async_v2.h:209] pq is empty
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240116 12:05:51.292279 27787 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
E20240116 12:05:51.801019 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=14303
W20240116 12:05:51.882565 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=42, pq.top=42
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
W20240116 12:05:52.358755 27787 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
E20240116 12:05:52.801010 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=10108
W20240116 12:05:52.950363 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=45, pq.top=44
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 393.261 us                | 34.690 ms                 |
| Backward                  | 699.805 us                | 28.915 ms                 |
| Optimize                  | 125.688 us                | 452.738 us                |
| BarrierTimeBeforeRank0    | 666.638 us                | 935.061 ms                |
| AfterBackward             | 53.093 ms                 | 1.901 s                   |
| BlockToStepN              | 460.497 us                | 37.671 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:05:53.395893 27787 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
E20240116 12:05:53.801018 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=6865
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
W20240116 12:05:54.452940 27787 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
E20240116 12:05:54.801012 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=3878
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.859 ms                  | 219.374 ms                |
| ProcessBack:UpdateCache   | 3.565 ms                  | 1.595 s                   |
| ProcessBack:UpsertPq      | 45.645 ms                 | 141.095 ms                |
| ProcessOneStep            | 53.048 ms                 | 1.900 s                   |
| BlockToStepN              | 384.681 us                | 37.593 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:05:55.096305 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=51, pq.top=51
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
W20240116 12:05:55.570770 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 12:05:55.801019 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=12816
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
W20240116 12:05:56.590749 27787 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 12:05:56.803324 26817 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240116 12:05:56.844575 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=56, pq.top=56
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
W20240116 12:05:57.692384 27787 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
E20240116 12:05:57.803004 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=8686
W20240116 12:05:57.940189 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=60, pq.top=59
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 403.179 us                | 1.174 ms                  |
| Backward                  | 699.805 us                | 1.438 ms                  |
| Optimize                  | 125.911 us                | 289.499 us                |
| BarrierTimeBeforeRank0    | 677.108 us                | 13.874 ms                 |
| AfterBackward             | 53.093 ms                 | 148.417 ms                |
| BlockToStepN              | 596.491 us                | 57.411 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
W20240116 12:05:58.724825 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 12:05:58.859982 26817 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
W20240116 12:05:59.759644 27787 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 12:05:59.859012 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=11991
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.860 ms                  | 7.660 ms                  |
| ProcessBack:UpdateCache   | 3.564 ms                  | 4.511 ms                  |
| ProcessBack:UpsertPq      | 44.815 ms                 | 134.221 ms                |
| ProcessOneStep            | 51.362 ms                 | 148.351 ms                |
| BlockToStepN              | 527.731 us                | 63.961 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:05:59.958631 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=67, pq.top=67
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
W20240116 12:06:00.828366 27787 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:06:00.859007 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=18718
W20240116 12:06:01.075879 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=71, pq.top=71
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
W20240116 12:06:01.830332 27787 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 12:06:01.859014 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=14569
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
W20240116 12:06:02.193192 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=75, pq.top=75
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
E20240116 12:06:02.859011 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=40102
W20240116 12:06:02.867957 27787 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 386.882 us                | 1.174 ms                  |
| Backward                  | 699.805 us                | 1.438 ms                  |
| Optimize                  | 122.220 us                | 289.499 us                |
| BarrierTimeBeforeRank0    | 581.071 us                | 13.874 ms                 |
| AfterBackward             | 48.179 ms                 | 148.417 ms                |
| BlockToStepN              | 730.565 us                | 81.120 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240116 12:06:03.600075 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=80, pq.top=80
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
E20240116 12:06:03.859184 26817 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
W20240116 12:06:03.877828 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
W20240116 12:06:04.606865 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=84, pq.top=84
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
E20240116 12:06:04.859014 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=9452
W20240116 12:06:04.894021 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.857 ms                  | 7.660 ms                  |
| ProcessBack:UpdateCache   | 3.549 ms                  | 4.511 ms                  |
| ProcessBack:UpsertPq      | 40.888 ms                 | 134.221 ms                |
| ProcessOneStep            | 47.380 ms                 | 148.351 ms                |
| BlockToStepN              | 706.794 us                | 88.459 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
W20240116 12:06:05.744011 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=88, pq.top=88
E20240116 12:06:05.928864 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
W20240116 12:06:05.930436 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
W20240116 12:06:07.063228 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 12:06:07.063361 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240116 12:06:07.367388 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=93, pq.top=93
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
E20240116 12:06:08.063012 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=37917
W20240116 12:06:08.102380 27787 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 376.711 us                | 1.174 ms                  |
| Backward                  | 695.130 us                | 1.438 ms                  |
| Optimize                  | 113.374 us                | 289.499 us                |
| BarrierTimeBeforeRank0    | 483.451 us                | 13.874 ms                 |
| AfterBackward             | 47.394 ms                 | 148.417 ms                |
| BlockToStepN              | 841.900 us                | 137.992 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
W20240116 12:06:08.627516 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=97, pq.top=97
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
E20240116 12:06:09.063016 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=7421
W20240116 12:06:09.140974 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank3, time: 56.275, per_step: 0.562751
Step99:rank2, time: 56.275, per_step: 0.562751
Step99:rank1, time: 56.275, per_step: 0.562751
Step99:rank0, time: 56.275, per_step: 0.562753
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
W20240116 12:06:09.916636 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=101, pq.top=101
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.854 ms                  | 7.660 ms                  |
| ProcessBack:UpdateCache   | 3.547 ms                  | 4.511 ms                  |
| ProcessBack:UpsertPq      | 41.496 ms                 | 134.221 ms                |
| ProcessOneStep            | 48.127 ms                 | 148.351 ms                |
| BlockToStepN              | 867.272 us                | 137.906 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 12:06:10.063009 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=7788
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
W20240116 12:06:10.264430 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
W20240116 12:06:10.916030 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=104, pq.top=104
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
E20240116 12:06:11.063021 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=8770
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
W20240116 12:06:11.327121 27787 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
E20240116 12:06:12.063012 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=9675
W20240116 12:06:12.221545 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=108, pq.top=108
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
W20240116 12:06:12.390684 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
E20240116 12:06:13.063023 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=44777
W20240116 12:06:13.221755 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=111, pq.top=111
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 386.882 us                | 1.174 ms                  |
| Backward                  | 695.130 us                | 1.438 ms                  |
| Optimize                  | 112.785 us                | 289.499 us                |
| BarrierTimeBeforeRank0    | 476.299 us                | 13.874 ms                 |
| AfterBackward             | 48.556 ms                 | 148.417 ms                |
| BlockToStepN              | 1.023 ms                  | 137.992 ms                |
| E2E-100                   | 34.478 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:06:13.447885 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
E20240116 12:06:14.063012 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=42792
W20240116 12:06:14.221558 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=114, pq.top=114
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
W20240116 12:06:14.474139 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.854 ms                  | 7.660 ms                  |
| ProcessBack:UpdateCache   | 3.543 ms                  | 4.511 ms                  |
| ProcessBack:UpsertPq      | 41.496 ms                 | 134.221 ms                |
| ProcessOneStep            | 48.127 ms                 | 148.351 ms                |
| BlockToStepN              | 991.109 us                | 137.906 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
E20240116 12:06:15.063014 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=38293
W20240116 12:06:15.266256 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=117, pq.top=117
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
W20240116 12:06:15.580638 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
E20240116 12:06:16.063021 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=92872
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
W20240116 12:06:16.606894 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
E20240116 12:06:17.063011 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=145432
W20240116 12:06:17.134860 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=123, pq.top=123
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240116 12:06:17.790572 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240116 12:06:18.063017 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=925
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 391.289 us                | 1.174 ms                  |
| Backward                  | 695.130 us                | 1.438 ms                  |
| Optimize                  | 111.230 us                | 289.499 us                |
| BarrierTimeBeforeRank0    | 415.494 us                | 13.874 ms                 |
| AfterBackward             | 47.133 ms                 | 148.417 ms                |
| BlockToStepN              | 1.217 ms                  | 137.992 ms                |
| E2E-100                   | 34.478 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240116 12:06:18.795400 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=128, pq.top=128
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
W20240116 12:06:18.992336 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
E20240116 12:06:19.063014 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=53800
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.854 ms                  | 7.660 ms                  |
| ProcessBack:UpdateCache   | 3.547 ms                  | 4.511 ms                  |
| ProcessBack:UpsertPq      | 40.205 ms                 | 134.221 ms                |
| ProcessOneStep            | 47.095 ms                 | 148.351 ms                |
| BlockToStepN              | 1.259 ms                  | 186.767 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 12:06:20.063302 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=114727
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
W20240116 12:06:20.065225 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240116 12:06:20.947521 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=134, pq.top=134
E20240116 12:06:21.110713 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=16369
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
W20240116 12:06:21.114199 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
W20240116 12:06:21.947697 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=137, pq.top=137
E20240116 12:06:22.121291 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
W20240116 12:06:22.123461 27787 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
E20240116 12:06:23.121016 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=64633
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
W20240116 12:06:23.174672 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 392.376 us                | 1.174 ms                  |
| Backward                  | 694.783 us                | 1.438 ms                  |
| Optimize                  | 111.230 us                | 289.499 us                |
| BarrierTimeBeforeRank0    | 443.476 us                | 13.874 ms                 |
| AfterBackward             | 47.126 ms                 | 148.417 ms                |
| BlockToStepN              | 1.426 ms                  | 190.731 ms                |
| E2E-100                   | 34.478 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
W20240116 12:06:23.883134 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=143, pq.top=143
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
E20240116 12:06:24.121019 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=26110
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
W20240116 12:06:24.249637 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.850 ms                  | 7.660 ms                  |
| ProcessBack:UpdateCache   | 3.549 ms                  | 4.511 ms                  |
| ProcessBack:UpsertPq      | 39.587 ms                 | 134.221 ms                |
| ProcessOneStep            | 46.288 ms                 | 148.351 ms                |
| BlockToStepN              | 1.384 ms                  | 190.567 ms                |
+---------------------------+---------------------------+---------------------------+
W20240116 12:06:25.022472 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=147, pq.top=147
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
E20240116 12:06:25.121012 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=87145
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
W20240116 12:06:25.288456 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
W20240116 12:06:26.048996 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=151, pq.top=151
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
E20240116 12:06:26.121011 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=151376
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
W20240116 12:06:26.314047 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
E20240116 12:06:27.121007 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=218387
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
W20240116 12:06:27.345657 27787 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
W20240116 12:06:27.540077 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=157, pq.top=157
E20240116 12:06:28.219606 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 390.552 us                | 1.120 ms                  |
| Backward                  | 692.740 us                | 1.422 ms                  |
| Optimize                  | 109.685 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 481.367 us                | 1.849 ms                  |
| AfterBackward             | 45.371 ms                 | 140.929 ms                |
| BlockToStepN              | 1.514 ms                  | 190.731 ms                |
| E2E-100                   | 34.478 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:06:28.676165 27787 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
W20240116 12:06:28.928341 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=158, pq.top=158
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
E20240116 12:06:29.219019 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=17072
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240116 12:06:29.721601 27787 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.850 ms                  | 3.815 ms                  |
| ProcessBack:UpdateCache   | 3.547 ms                  | 4.360 ms                  |
| ProcessBack:UpsertPq      | 38.570 ms                 | 117.826 ms                |
| ProcessOneStep            | 45.210 ms                 | 140.851 ms                |
| BlockToStepN              | 1.483 ms                  | 190.567 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
E20240116 12:06:30.219012 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=71124
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240116 12:06:30.735110 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
E20240116 12:06:31.219018 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=135582
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240116 12:06:31.778132 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
E20240116 12:06:32.219013 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=191318
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
W20240116 12:06:32.554220 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=171, pq.top=171
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
W20240116 12:06:32.797537 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
E20240116 12:06:33.219010 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=259024
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 385.480 us                | 1.120 ms                  |
| Backward                  | 685.349 us                | 1.422 ms                  |
| Optimize                  | 109.179 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 483.451 us                | 1.849 ms                  |
| AfterBackward             | 44.544 ms                 | 140.929 ms                |
| BlockToStepN              | 1.651 ms                  | 190.731 ms                |
| E2E-100                   | 34.478 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
W20240116 12:06:33.929044 27787 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
E20240116 12:06:34.219014 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=105
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
W20240116 12:06:34.940591 27787 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.842 ms                  | 3.815 ms                  |
| ProcessBack:UpdateCache   | 3.543 ms                  | 4.360 ms                  |
| ProcessBack:UpsertPq      | 37.603 ms                 | 117.826 ms                |
| ProcessOneStep            | 44.247 ms                 | 140.851 ms                |
| BlockToStepN              | 1.620 ms                  | 190.567 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
E20240116 12:06:35.219008 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=381903
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
W20240116 12:06:35.979163 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
E20240116 12:06:36.219010 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=446654
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 381.040 us                | 1.120 ms                  |
| Backward                  | 683.721 us                | 1.422 ms                  |
| Optimize                  | 108.451 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 489.347 us                | 1.849 ms                  |
| AfterBackward             | 44.288 ms                 | 140.929 ms                |
| BlockToStepN              | 1.742 ms                  | 190.731 ms                |
| E2E-100                   | 34.478 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:06:39.950213 27787 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 12:06:39.950402 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.842 ms                  | 3.815 ms                  |
| ProcessBack:UpdateCache   | 3.543 ms                  | 4.360 ms                  |
| ProcessBack:UpsertPq      | 37.603 ms                 | 117.826 ms                |
| ProcessOneStep            | 44.247 ms                 | 140.851 ms                |
| BlockToStepN              | 1.680 ms                  | 190.567 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
W20240116 12:06:40.500484 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=189, pq.top=189
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
E20240116 12:06:40.950019 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=41057
W20240116 12:06:40.991371 27787 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
W20240116 12:06:41.678629 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=192, pq.top=192
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
E20240116 12:06:41.951262 26817 parallel_pq_v2.h:76] insert failed, size(hashtable)=414
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240116 12:06:42.010808 27787 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
W20240116 12:06:42.767647 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=196, pq.top=195
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
E20240116 12:06:42.951021 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=157401
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
W20240116 12:06:43.042251 27787 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 382.962 us                | 1.120 ms                  |
| Backward                  | 683.721 us                | 1.422 ms                  |
| Optimize                  | 108.451 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 492.897 us                | 1.849 ms                  |
| AfterBackward             | 44.127 ms                 | 140.929 ms                |
| BlockToStepN              | 1.808 ms                  | 196.690 ms                |
| E2E-100                   | 34.478 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
Step199:rank3, time: 34.202, per_step: 0.338631
Step199:rank0, time: 34.202, per_step: 0.338631
Step199:rank1, time: 34.202, per_step: 0.338631
Step199:rank2, time: 34.202, per_step: 0.338631
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
E20240116 12:06:43.951020 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=221457
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
W20240116 12:06:44.059150 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
W20240116 12:06:44.865875 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=204, pq.top=204
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
E20240116 12:06:44.951017 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=281316
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.850 ms                  | 7.660 ms                  |
| ProcessBack:UpdateCache   | 3.542 ms                  | 4.360 ms                  |
| ProcessBack:UpsertPq      | 37.378 ms                 | 117.826 ms                |
| ProcessOneStep            | 43.913 ms                 | 140.851 ms                |
| BlockToStepN              | 1.756 ms                  | 196.556 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
W20240116 12:06:45.191567 27787 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
E20240116 12:06:45.951020 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=342528
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
W20240116 12:06:46.237218 27787 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
E20240116 12:06:46.951010 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=407747
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
W20240116 12:06:47.279846 27787 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
E20240116 12:06:47.951018 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=473477
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
W20240116 12:06:48.324990 27787 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 377.527 us                | 1.120 ms                  |
| Backward                  | 679.459 us                | 1.422 ms                  |
| Optimize                  | 107.824 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 540.734 us                | 1.849 ms                  |
| AfterBackward             | 43.293 ms                 | 140.929 ms                |
| BlockToStepN              | 1.894 ms                  | 196.690 ms                |
| E2E-100                   | 34.202 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
E20240116 12:06:48.965773 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=537238
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
W20240116 12:06:49.383901 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.843 ms                  | 7.660 ms                  |
| ProcessBack:UpdateCache   | 3.541 ms                  | 4.360 ms                  |
| ProcessBack:UpsertPq      | 36.617 ms                 | 117.826 ms                |
| ProcessOneStep            | 43.285 ms                 | 140.851 ms                |
| BlockToStepN              | 1.832 ms                  | 196.556 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 12:06:49.965018 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=583438
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
W20240116 12:06:50.425766 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
E20240116 12:06:50.965011 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=647345
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
W20240116 12:06:51.449409 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
E20240116 12:06:51.965011 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=709940
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
W20240116 12:06:52.461443 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
E20240116 12:06:52.965019 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=419
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 376.952 us                | 1.120 ms                  |
| Backward                  | 676.033 us                | 1.422 ms                  |
| Optimize                  | 107.264 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 574.972 us                | 1.849 ms                  |
| AfterBackward             | 42.900 ms                 | 140.929 ms                |
| BlockToStepN              | 2.024 ms                  | 196.690 ms                |
| E2E-100                   | 34.202 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:06:53.466756 27787 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
E20240116 12:06:53.965010 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=839794
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
W20240116 12:06:54.555402 27787 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.845 ms                  | 7.660 ms                  |
| ProcessBack:UpdateCache   | 3.540 ms                  | 4.360 ms                  |
| ProcessBack:UpsertPq      | 35.918 ms                 | 117.826 ms                |
| ProcessOneStep            | 42.536 ms                 | 140.851 ms                |
| BlockToStepN              | 1.970 ms                  | 196.556 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 12:06:54.965009 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=904864
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
W20240116 12:06:55.564779 27787 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
E20240116 12:06:55.965009 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=966847
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
W20240116 12:06:56.633616 27787 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
E20240116 12:06:56.965008 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1024584
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
W20240116 12:06:57.656345 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
E20240116 12:06:57.965009 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1083054
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 375.344 us                | 765.061 us                |
| Backward                  | 675.218 us                | 1.420 ms                  |
| Optimize                  | 106.826 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 588.973 us                | 1.717 ms                  |
| AfterBackward             | 42.900 ms                 | 124.681 ms                |
| BlockToStepN              | 2.106 ms                  | 190.731 ms                |
| E2E-100                   | 34.202 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
W20240116 12:06:58.657975 27787 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 12:06:58.967185 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1119242
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
W20240116 12:06:59.725126 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.844 ms                  | 3.815 ms                  |
| ProcessBack:UpdateCache   | 3.540 ms                  | 4.163 ms                  |
| ProcessBack:UpsertPq      | 36.341 ms                 | 134.221 ms                |
| ProcessOneStep            | 42.927 ms                 | 148.351 ms                |
| BlockToStepN              | 2.055 ms                  | 190.567 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 12:06:59.969276 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1167059
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
W20240116 12:07:00.726577 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 12:07:00.971755 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1229631
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
W20240116 12:07:01.737241 27787 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 12:07:01.972273 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1295360
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
W20240116 12:07:02.739575 27787 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:07:02.972059 26817 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 375.926 us                | 765.061 us                |
| Backward                  | 675.271 us                | 1.420 ms                  |
| Optimize                  | 106.734 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 599.406 us                | 1.717 ms                  |
| AfterBackward             | 42.483 ms                 | 148.417 ms                |
| BlockToStepN              | 2.222 ms                  | 190.731 ms                |
| E2E-100                   | 34.202 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
W20240116 12:07:03.749960 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
E20240116 12:07:03.972016 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1423397
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
W20240116 12:07:04.774996 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.842 ms                  | 3.815 ms                  |
| ProcessBack:UpdateCache   | 3.539 ms                  | 4.163 ms                  |
| ProcessBack:UpsertPq      | 35.717 ms                 | 134.221 ms                |
| ProcessOneStep            | 42.336 ms                 | 148.351 ms                |
| BlockToStepN              | 2.173 ms                  | 190.567 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 12:07:04.972009 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1486871
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
W20240116 12:07:05.796232 27787 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
E20240116 12:07:05.972009 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1548777
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
W20240116 12:07:06.821375 27787 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 12:07:06.972012 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1611764
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
W20240116 12:07:07.852808 27787 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:07:07.972014 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1673002
W20240116 12:07:08.105123 26817 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=291, pq.top=291
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 374.344 us                | 765.061 us                |
| Backward                  | 675.178 us                | 1.420 ms                  |
| Optimize                  | 106.214 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 624.134 us                | 1.717 ms                  |
| AfterBackward             | 42.082 ms                 | 148.417 ms                |
| BlockToStepN              | 2.323 ms                  | 190.731 ms                |
| E2E-100                   | 34.202 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
W20240116 12:07:08.896382 27787 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
E20240116 12:07:08.972021 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1733708
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
W20240116 12:07:09.930341 27787 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.839 ms                  | 3.815 ms                  |
| ProcessBack:UpdateCache   | 3.539 ms                  | 4.163 ms                  |
| ProcessBack:UpsertPq      | 35.298 ms                 | 134.221 ms                |
| ProcessOneStep            | 41.939 ms                 | 148.351 ms                |
| BlockToStepN              | 2.283 ms                  | 190.567 ms                |
+---------------------------+---------------------------+---------------------------+
E20240116 12:07:09.972007 27787 parallel_pq_v2.h:76] insert failed, size(hashtable)=1795440
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
Step299:rank3, time: 26.642, per_step: 0.263782
Step299:rank2, time: 26.642, per_step: 0.263782
Step299:rank0, time: 26.642, per_step: 0.263782
Step299:rank1, time: 26.642, per_step: 0.263782
timer name is E2E-100
timer name is timer name is E2E-100E2E-100

timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
ERROR [26817 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 374.540 us                | 765.061 us                |
| Backward                  | 675.271 us                | 1.420 ms                  |
| Optimize                  | 106.156 us                | 251.596 us                |
| BarrierTimeBeforeRank0    | 618.614 us                | 1.717 ms                  |
| AfterBackward             | 41.903 ms                 | 148.417 ms                |
| BlockToStepN              | 2.361 ms                  | 190.731 ms                |
| E2E-100                   | 34.202 s                  | 34.478 s                  |
+---------------------------+---------------------------+---------------------------+
*** Aborted at 1705378033 (Unix time, try 'date -d @1705378033') ***
*** Signal 11 (SIGSEGV) (0x10000685b980) received by PID 26817 (pthread TID 0x7f0d2a7fc640) (linux TID 27777) (code: address not mapped to object), stack trace: ***
W20240116 12:07:14.612324 26817 HazptrDomain.h:148] Tagged objects remain. This may indicate a higher-level leak of object(s) that use hazptr_obj_cohort.
