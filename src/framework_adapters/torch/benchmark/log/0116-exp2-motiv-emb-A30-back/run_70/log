WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240116 12:07:21.849776 29563 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240116 12:07:21.851094 29563 IPCTensor.h:367] NewIPCTensor: full_emb [100000000, 32]0x100000002000
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_emb.py:165: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [29563 perf_emb.py:165] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7faebe110860>==========
Worker 1 pid=29711
Worker 2 pid=29713
INFO [29563 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [29711 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [29715 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [29713 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [29713 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [29715 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [29711 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 12:07:25.042714 29711 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 12:07:25.042714 29715 IPCTensor.h:346] IPCTensor full_emb already exists
E20240116 12:07:25.042714 29713 IPCTensor.h:346] IPCTensor full_emb already exists
INFO [29563 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240116 12:07:25.049962 29563 IPCTensor.h:346] IPCTensor full_emb already exists
W20240116 12:07:25.053251 29711 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_1 [20000000, 32]; dev=1; size=2.384 GB
W20240116 12:07:25.053488 29713 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_2 [20000000, 32]; dev=2; size=2.384 GB
W20240116 12:07:25.055555 29563 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_0 [20000000, 32]; dev=0; size=2.384 GB
W20240116 12:07:25.060494 29715 IPCTensor.h:406] NewIPCGPUTensor: embedding_cache_3 [20000000, 32]; dev=3; size=2.384 GB
W20240116 12:07:25.084172 29711 IPCTensor.h:367] NewIPCTensor: input_keys_1 [100000]0x1002faf10000
W20240116 12:07:25.084211 29713 IPCTensor.h:367] NewIPCTensor: input_keys_2 [100000]0x1002fafd5000
W20240116 12:07:25.084333 29711 IPCTensor.h:367] NewIPCTensor: input_keys_neg_1 [100000]0x1002fb09a000
W20240116 12:07:25.084362 29713 IPCTensor.h:367] NewIPCTensor: input_keys_neg_2 [100000]0x1002fb15f000
W20240116 12:07:25.084401 29711 IPCTensor.h:367] NewIPCTensor: backward_grads_1 [100000, 32]0x1002fb224000
W20240116 12:07:25.084453 29713 IPCTensor.h:367] NewIPCTensor: backward_grads_2 [100000, 32]0x1002fbe5b000
W20240116 12:07:25.084458 29711 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_1 [100000, 32]0x1002fca92000
W20240116 12:07:25.084509 29711 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 12:07:25.084523 29713 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_2 [100000, 32]0x1002fd6c9000
W20240116 12:07:25.084591 29713 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 12:07:25.085572 29711 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 32]; dev=1; size=12.21 MB
W20240116 12:07:25.085585 29563 IPCTensor.h:367] NewIPCTensor: input_keys_0 [100000]0x1002fe306000
W20240116 12:07:25.085808 29715 IPCTensor.h:367] NewIPCTensor: input_keys_3 [100000]0x1002fe3cb000
W20240116 12:07:25.085847 29563 IPCTensor.h:367] NewIPCTensor: input_keys_neg_0 [100000]0x1002fe490000
W20240116 12:07:25.086019 29563 IPCTensor.h:367] NewIPCTensor: backward_grads_0 [100000, 32]0x1002fe555000
W20240116 12:07:25.086172 29563 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_0 [100000, 32]0x1002ff18c000
W20240116 12:07:25.086313 29563 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 12:07:25.086354 29715 IPCTensor.h:367] NewIPCTensor: input_keys_neg_3 [100000]0x1002ffdc3000
W20240116 12:07:25.086576 29715 IPCTensor.h:367] NewIPCTensor: backward_grads_3 [100000, 32]0x1002ffe88000
W20240116 12:07:25.086726 29715 IPCTensor.h:367] NewIPCTensor: backward_grads_neg_3 [100000, 32]0x100300abf000
W20240116 12:07:25.086853 29715 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_3_gpu [100000, 32]; dev=3; size=12.21 MB
W20240116 12:07:25.089111 29713 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 32]; dev=2; size=12.21 MB
W20240116 12:07:25.089455 29563 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 32]; dev=0; size=12.21 MB
W20240116 12:07:25.089803 29715 IPCTensor.h:406] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 32]; dev=3; size=12.21 MB
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
Worker 3 pid=29715
New CachedEmbedding, name=full_emb, shape=(100000000, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 20000000), (20000000, 40000000), (40000000, 60000000), (60000000, 80000000)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240116 12:07:27.941613 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_0 [100000]0x100301704000
W20240116 12:07:27.941680 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_0 [100000]0x1003017c9000
W20240116 12:07:27.941764 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_0 [100000]0x10030188e000
W20240116 12:07:27.941772 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_0 [100000]0x100301953000
W20240116 12:07:27.941785 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_1 [100000]0x100301a18000
W20240116 12:07:27.941848 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_2 [100000]0x100301add000
W20240116 12:07:27.941887 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_3 [100000]0x100301ba2000
W20240116 12:07:27.941918 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_4 [100000]0x100301c67000
W20240116 12:07:27.941924 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_1 [100000]0x100301d2c000
W20240116 12:07:27.941951 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_5 [100000]0x100301df1000
W20240116 12:07:27.941977 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_1 [100000]0x100301eb6000
W20240116 12:07:27.941987 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_6 [100000]0x100301f7b000
W20240116 12:07:27.942000 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_1 [100000]0x100302040000
W20240116 12:07:27.942032 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_2 [100000]0x100302105000
W20240116 12:07:27.942035 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_7 [100000]0x1003021ca000
W20240116 12:07:27.942039 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_2 [100000]0x10030228f000
W20240116 12:07:27.942076 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_8 [100000]0x100302354000
W20240116 12:07:27.942081 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_2 [100000]0x100302419000
W20240116 12:07:27.942109 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_3 [100000]0x1003024de000
W20240116 12:07:27.942116 29713 IPCTensor.h:367] NewIPCTensor: cached_sampler_r2_9 [100000]0x1003025a3000
W20240116 12:07:27.942135 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_3 [100000]0x100302668000
W20240116 12:07:27.942152 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_3 [100000]0x10030272d000
W20240116 12:07:27.942154 29713 IPCTensor.h:367] NewIPCTensor: step_r2 [10]0x1003027f2000
W20240116 12:07:27.942179 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_4 [100000]0x1003027f4000
W20240116 12:07:27.942185 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_4 [100000]0x1003028b9000
W20240116 12:07:27.942200 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_4 [100000]0x10030297e000
W20240116 12:07:27.942203 29713 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r2 [1]0x100302a43000
W20240116 12:07:27.942224 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_5 [100000]0x100302a45000
W20240116 12:07:27.942250 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_5 [100000]0x100302b0a000
W20240116 12:07:27.942256 29713 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100302bcf000
W20240116 12:07:27.942268 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_6 [100000]0x100302bd1000
W20240116 12:07:27.942294 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_5 [100000]0x100302c96000
W20240116 12:07:27.942298 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_6 [100000]0x100302d5b000
W20240116 12:07:27.942346 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_6 [100000]0x100302e20000
W20240116 12:07:27.942351 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_7 [100000]0x100302ee5000
W20240116 12:07:27.942361 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_7 [100000]0x100302faa000
W20240116 12:07:27.942404 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_8 [100000]0x10030306f000
W20240116 12:07:27.942416 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_7 [100000]0x100303134000
W20240116 12:07:27.942435 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_8 [100000]0x1003031f9000
W20240116 12:07:27.942451 29715 IPCTensor.h:367] NewIPCTensor: cached_sampler_r3_9 [100000]0x1003032be000
W20240116 12:07:27.942471 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_8 [100000]0x100303383000
Construct PerfSampler done
W20240116 12:07:27.942482 29563 IPCTensor.h:367] NewIPCTensor: cached_sampler_r0_9 [100000]0x100303448000
W20240116 12:07:27.942500 29715 IPCTensor.h:367] NewIPCTensor: step_r3 [10]0x10030350d000
W20240116 12:07:27.942523 29563 IPCTensor.h:367] NewIPCTensor: step_r0 [10]0x10030350f000
I20240116 12:07:27.942528 29713 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240116 12:07:27.942533 29711 IPCTensor.h:367] NewIPCTensor: cached_sampler_r1_9 [100000]0x100303511000
W20240116 12:07:27.942545 29715 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r3 [1]0x1003035d6000
W20240116 12:07:27.942560 29563 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r0 [1]0x1003035d8000
W20240116 12:07:27.942579 29711 IPCTensor.h:367] NewIPCTensor: step_r1 [10]0x1003035da000
W20240116 12:07:27.942584 29715 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1003035dc000
W20240116 12:07:27.942613 29711 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_r1 [1]0x1003035de000
W20240116 12:07:27.942618 29563 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1003035e0000
W20240116 12:07:27.942646 29711 IPCTensor.h:367] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1003035e2000
Construct PerfSampler done
Construct PerfSampler done
Construct PerfSampler done
I20240116 12:07:27.943035 29715 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240116 12:07:27.943051 29563 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240116 12:07:27.943071 29711 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240116 12:07:27.943991 29563 grad_base.h:54] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.2,
        "backgrad_init": "both"
    }
W20240116 12:07:27.944371 29563 grad_base.h:169] Init GradProcessingBase done
I20240116 12:07:43.438199 29563 grad_async_v2.h:32] Use background thread to update emb.
W20240116 12:07:43.438480 29563 kg_controller.h:78] after init GradAsyncProcessingV2
I20240116 12:07:43.438488 29563 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240116 12:07:43.845388 29563 grad_base.h:59] GraphEnv RegTensorsPerProcess
W20240116 12:07:47.296965 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:07:47.297276 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
Before Training
I20240116 12:07:48.135671 29563 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
E20240116 12:07:48.297016 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=58
W20240116 12:07:48.343093 30420 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
Before Training
I20240116 12:07:49.187878 29711 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
E20240116 12:07:49.307816 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240116 12:07:49.355686 30420 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
Before Training
I20240116 12:07:49.473093 29713 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240116 12:07:49.520601 29715 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
E20240116 12:07:52.616380 29563 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240116 12:07:52.761397 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=1, pq.top=1
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240116 12:07:52.785144 30420 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 30.356 ms                 | 30.356 ms                 |
| Backward                  | 27.141 ms                 | 27.141 ms                 |
| Optimize                  | 255.239 us                | 255.239 us                |
| BarrierTimeBeforeRank0    | 166.565 us                | 166.565 us                |
| AfterBackward             | 2.970 s                   | 2.970 s                   |
| BlockToStepN              | 18.090 ms                 | 18.090 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
E20240116 12:07:53.616011 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=15672
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.304 ms                  | 162.024 ms                |
| ProcessBack:UpdateCache   | 5.763 ms                  | 2.518 s                   |
| ProcessBack:UpsertPq      | 85.766 ms                 | 144.633 ms                |
| ProcessOneStep            | 95.043 ms                 | 2.970 s                   |
| BlockToStepN              | 17.302 ms                 | 17.769 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:07:53.877079 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=4, pq.top=3
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
W20240116 12:07:53.898839 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
E20240116 12:07:54.616079 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=53594
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
W20240116 12:07:54.941596 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
W20240116 12:07:55.155392 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=8, pq.top=8
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
E20240116 12:07:55.616009 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=90256
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
W20240116 12:07:55.943145 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
W20240116 12:07:56.394836 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=12, pq.top=12
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240116 12:07:56.616017 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=128036
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240116 12:07:57.147418 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
W20240116 12:07:57.475997 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=15, pq.top=15
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
E20240116 12:07:57.616007 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=154044
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 348.451 us                | 30.356 ms                 |
| Backward                  | 732.176 us                | 27.141 ms                 |
| Optimize                  | 117.939 us                | 307.000 us                |
| BarrierTimeBeforeRank0    | 534.982 us                | 153.065 ms                |
| AfterBackward             | 98.778 ms                 | 2.970 s                   |
| BlockToStepN              | 15.572 ms                 | 18.090 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
W20240116 12:07:58.186671 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
E20240116 12:07:58.616006 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=825
W20240116 12:07:58.758538 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=19, pq.top=19
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.288 ms                  | 162.024 ms                |
| ProcessBack:UpdateCache   | 5.634 ms                  | 2.518 s                   |
| ProcessBack:UpsertPq      | 90.063 ms                 | 144.633 ms                |
| ProcessOneStep            | 99.199 ms                 | 2.970 s                   |
| BlockToStepN              | 15.863 ms                 | 17.769 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
W20240116 12:07:59.190709 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240116 12:07:59.616004 29563 parallel_pq_v2.h:76] insert failed, size(hashtable)=25
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
W20240116 12:08:00.017086 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=23, pq.top=23
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
W20240116 12:08:00.355160 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
E20240116 12:08:00.616016 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=250942
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
W20240116 12:08:01.324657 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=27, pq.top=27
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
W20240116 12:08:01.394776 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 12:08:01.616005 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=280786
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240116 12:08:02.361673 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=30, pq.top=30
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
W20240116 12:08:02.429292 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:08:02.616006 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=311954
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 346.552 us                | 30.356 ms                 |
| Backward                  | 724.561 us                | 27.141 ms                 |
| Optimize                  | 104.485 us                | 307.000 us                |
| BarrierTimeBeforeRank0    | 530.676 us                | 153.065 ms                |
| AfterBackward             | 98.991 ms                 | 2.970 s                   |
| BlockToStepN              | 15.450 ms                 | 18.090 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
W20240116 12:08:03.469125 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 12:08:03.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=340093
W20240116 12:08:03.616510 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=34, pq.top=34
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.264 ms                  | 162.024 ms                |
| ProcessBack:UpdateCache   | 5.643 ms                  | 2.518 s                   |
| ProcessBack:UpsertPq      | 89.459 ms                 | 144.633 ms                |
| ProcessOneStep            | 98.739 ms                 | 2.970 s                   |
| BlockToStepN              | 15.324 ms                 | 17.769 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
W20240116 12:08:04.573922 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 12:08:04.616015 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=372839
W20240116 12:08:04.866158 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=38, pq.top=38
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240116 12:08:05.606092 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:08:05.616012 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=404785
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
W20240116 12:08:06.114552 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=42, pq.top=42
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
E20240116 12:08:06.616007 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=436082
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
W20240116 12:08:06.767732 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
W20240116 12:08:07.385648 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=46, pq.top=46
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
E20240116 12:08:07.616022 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=466466
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
W20240116 12:08:07.784063 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 340.187 us                | 30.356 ms                 |
| Backward                  | 718.634 us                | 27.141 ms                 |
| Optimize                  | 100.648 us                | 307.000 us                |
| BarrierTimeBeforeRank0    | 582.948 us                | 153.065 ms                |
| AfterBackward             | 97.546 ms                 | 2.970 s                   |
| BlockToStepN              | 15.353 ms                 | 18.090 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
W20240116 12:08:08.386226 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=49, pq.top=49
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
E20240116 12:08:08.616011 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=494872
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
W20240116 12:08:08.790055 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.279 ms                  | 162.024 ms                |
| ProcessBack:UpdateCache   | 5.643 ms                  | 2.518 s                   |
| ProcessBack:UpsertPq      | 89.007 ms                 | 144.633 ms                |
| ProcessOneStep            | 98.074 ms                 | 2.970 s                   |
| BlockToStepN              | 15.255 ms                 | 17.769 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
W20240116 12:08:09.389295 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=52, pq.top=52
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
E20240116 12:08:09.616020 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=522914
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240116 12:08:09.838685 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
W20240116 12:08:10.448815 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=55, pq.top=55
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
E20240116 12:08:10.616029 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=547817
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
W20240116 12:08:10.871204 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
E20240116 12:08:11.616060 29563 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
W20240116 12:08:11.634464 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=58, pq.top=58
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
W20240116 12:08:11.983939 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240116 12:08:12.616009 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=598614
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240116 12:08:12.940193 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=62, pq.top=62
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 340.187 us                | 1.074 ms                  |
| Backward                  | 721.828 us                | 1.662 ms                  |
| Optimize                  | 100.601 us                | 255.239 us                |
| BarrierTimeBeforeRank0    | 564.034 us                | 1.259 ms                  |
| AfterBackward             | 98.778 ms                 | 116.129 ms                |
| BlockToStepN              | 15.251 ms                 | 17.360 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
W20240116 12:08:13.009500 30420 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
E20240116 12:08:13.616011 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=627633
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.286 ms                  | 13.658 ms                 |
| ProcessBack:UpdateCache   | 5.656 ms                  | 5.998 ms                  |
| ProcessBack:UpsertPq      | 89.459 ms                 | 106.748 ms                |
| ProcessOneStep            | 98.739 ms                 | 116.083 ms                |
| BlockToStepN              | 15.173 ms                 | 17.302 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
W20240116 12:08:14.032434 30420 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
W20240116 12:08:14.236160 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=66, pq.top=66
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
E20240116 12:08:14.616039 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=656350
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240116 12:08:15.052248 30420 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
W20240116 12:08:15.516494 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=70, pq.top=70
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
E20240116 12:08:15.616012 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=872
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
W20240116 12:08:16.173904 30420 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
E20240116 12:08:16.616012 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=714695
W20240116 12:08:16.793243 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=74, pq.top=74
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
W20240116 12:08:17.188704 30420 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
E20240116 12:08:17.616011 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1631
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 332.747 us                | 1.074 ms                  |
| Backward                  | 739.949 us                | 1.662 ms                  |
| Optimize                  | 96.135 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 502.774 us                | 1.259 ms                  |
| AfterBackward             | 98.480 ms                 | 116.129 ms                |
| BlockToStepN              | 15.251 ms                 | 17.360 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:08:18.079102 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=78, pq.top=78
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
W20240116 12:08:18.197839 30420 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
E20240116 12:08:18.616024 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=771057
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.285 ms                  | 13.658 ms                 |
| ProcessBack:UpdateCache   | 5.653 ms                  | 6.339 ms                  |
| ProcessBack:UpsertPq      | 89.118 ms                 | 137.039 ms                |
| ProcessOneStep            | 98.292 ms                 | 148.363 ms                |
| BlockToStepN              | 15.173 ms                 | 17.471 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:08:19.138985 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=81, pq.top=81
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
W20240116 12:08:19.214736 30420 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
E20240116 12:08:19.616011 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=795688
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
W20240116 12:08:20.172324 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=84, pq.top=84
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
W20240116 12:08:20.249639 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
E20240116 12:08:20.616025 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=821729
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
W20240116 12:08:21.172189 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=87, pq.top=87
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
W20240116 12:08:21.288504 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
E20240116 12:08:21.616039 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=849239
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
W20240116 12:08:22.317780 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
W20240116 12:08:22.468156 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=91, pq.top=91
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
E20240116 12:08:22.616007 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=877010
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 334.668 us                | 1.074 ms                  |
| Backward                  | 755.092 us                | 1.662 ms                  |
| Optimize                  | 94.358 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 432.283 us                | 1.259 ms                  |
| AfterBackward             | 98.777 ms                 | 148.411 ms                |
| BlockToStepN              | 15.137 ms                 | 18.090 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
W20240116 12:08:23.451388 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
E20240116 12:08:23.616022 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=904641
W20240116 12:08:23.757809 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=95, pq.top=95
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.280 ms                  | 13.658 ms                 |
| ProcessBack:UpdateCache   | 5.655 ms                  | 6.339 ms                  |
| ProcessBack:UpsertPq      | 89.459 ms                 | 137.039 ms                |
| ProcessOneStep            | 98.739 ms                 | 148.363 ms                |
| BlockToStepN              | 15.079 ms                 | 17.769 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
W20240116 12:08:24.474644 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
E20240116 12:08:24.616007 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=932101
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
W20240116 12:08:25.058281 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=99, pq.top=99
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank3, time: 57.455, per_step: 0.574553
Step99:rank1, time: 57.455, per_step: 0.574553
Step99:rank0, time: 57.455, per_step: 0.574553
Step99:rank2, time: 57.455, per_step: 0.574553
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
W20240116 12:08:25.503172 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:08:25.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=959606
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
W20240116 12:08:26.351660 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=103, pq.top=103
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
W20240116 12:08:26.523826 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 12:08:26.616004 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=987093
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
E20240116 12:08:27.616184 29563 parallel_pq_v2.h:76] insert failed, size(hashtable)=393
W20240116 12:08:27.645242 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=107, pq.top=107
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
W20240116 12:08:27.663947 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 332.747 us                | 1.074 ms                  |
| Backward                  | 792.346 us                | 1.662 ms                  |
| Optimize                  | 94.300 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 279.217 us                | 1.259 ms                  |
| AfterBackward             | 98.480 ms                 | 148.411 ms                |
| BlockToStepN              | 15.122 ms                 | 18.090 ms                 |
| E2E-100                   | 37.261 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
E20240116 12:08:28.616010 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1039261
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
W20240116 12:08:28.682011 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.279 ms                  | 13.658 ms                 |
| ProcessBack:UpdateCache   | 5.655 ms                  | 6.339 ms                  |
| ProcessBack:UpsertPq      | 89.016 ms                 | 137.039 ms                |
| ProcessOneStep            | 98.271 ms                 | 148.363 ms                |
| BlockToStepN              | 15.010 ms                 | 17.769 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:08:28.933789 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=111, pq.top=111
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
E20240116 12:08:29.616030 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1066741
W20240116 12:08:29.694895 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
W20240116 12:08:30.318841 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=115, pq.top=115
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
E20240116 12:08:30.616019 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1086608
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
W20240116 12:08:30.766657 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
E20240116 12:08:31.616015 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1104834
W20240116 12:08:31.690260 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=118, pq.top=118
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
W20240116 12:08:31.782649 30420 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
E20240116 12:08:32.616029 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1122609
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 335.741 us                | 1.074 ms                  |
| Backward                  | 808.181 us                | 1.662 ms                  |
| Optimize                  | 95.890 us                 | 261.839 us                |
| BarrierTimeBeforeRank0    | 239.807 us                | 1.259 ms                  |
| AfterBackward             | 98.480 ms                 | 168.765 ms                |
| BlockToStepN              | 15.147 ms                 | 18.937 ms                 |
| E2E-100                   | 37.261 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:08:32.958767 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=121, pq.top=121
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
W20240116 12:08:32.978935 30420 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
E20240116 12:08:33.616010 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1147860
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.286 ms                  | 13.658 ms                 |
| ProcessBack:UpdateCache   | 5.659 ms                  | 6.339 ms                  |
| ProcessBack:UpsertPq      | 89.459 ms                 | 145.333 ms                |
| ProcessOneStep            | 98.739 ms                 | 168.691 ms                |
| BlockToStepN              | 15.078 ms                 | 18.831 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:08:34.012816 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=124, pq.top=124
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240116 12:08:34.032351 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240116 12:08:34.616016 29563 parallel_pq_v2.h:76] insert failed, size(hashtable)=1172924
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
W20240116 12:08:35.018869 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=127, pq.top=127
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240116 12:08:35.038353 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
E20240116 12:08:35.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1199145
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
W20240116 12:08:36.018359 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=130, pq.top=130
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
W20240116 12:08:36.080276 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
E20240116 12:08:36.616007 29563 parallel_pq_v2.h:76] insert failed, size(hashtable)=253
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
W20240116 12:08:37.019084 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=133, pq.top=133
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240116 12:08:37.132586 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
E20240116 12:08:37.616010 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1250204
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 340.187 us                | 1.074 ms                  |
| Backward                  | 777.079 us                | 1.662 ms                  |
| Optimize                  | 96.177 us                 | 261.839 us                |
| BarrierTimeBeforeRank0    | 308.782 us                | 1.259 ms                  |
| AfterBackward             | 99.128 ms                 | 168.765 ms                |
| BlockToStepN              | 15.154 ms                 | 18.937 ms                 |
| E2E-100                   | 37.261 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
W20240116 12:08:38.169646 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
W20240116 12:08:38.323909 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=137, pq.top=137
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
E20240116 12:08:38.616019 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1275707
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.290 ms                  | 13.658 ms                 |
| ProcessBack:UpdateCache   | 5.664 ms                  | 6.339 ms                  |
| ProcessBack:UpsertPq      | 89.946 ms                 | 145.333 ms                |
| ProcessOneStep            | 99.093 ms                 | 168.691 ms                |
| BlockToStepN              | 15.078 ms                 | 18.831 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
W20240116 12:08:39.325736 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=140, pq.top=140
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
W20240116 12:08:39.346901 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
E20240116 12:08:39.616016 29563 parallel_pq_v2.h:76] insert failed, size(hashtable)=3586
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240116 12:08:40.384905 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 12:08:40.616017 29563 parallel_pq_v2.h:76] insert failed, size(hashtable)=36
W20240116 12:08:40.643635 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=144, pq.top=144
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
W20240116 12:08:41.423964 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 12:08:41.616010 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1350689
W20240116 12:08:41.643182 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=147, pq.top=147
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240116 12:08:42.461448 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
E20240116 12:08:42.616746 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1375279
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
W20240116 12:08:42.944262 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=151, pq.top=151
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 346.552 us                | 667.183 us                |
| Backward                  | 743.187 us                | 1.520 ms                  |
| Optimize                  | 96.177 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 436.993 us                | 1.259 ms                  |
| AfterBackward             | 99.313 ms                 | 155.608 ms                |
| BlockToStepN              | 15.158 ms                 | 18.937 ms                 |
| E2E-100                   | 37.261 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
E20240116 12:08:43.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1401180
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240116 12:08:43.624313 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.290 ms                  | 10.000 ms                 |
| ProcessBack:UpdateCache   | 5.667 ms                  | 6.183 ms                  |
| ProcessBack:UpsertPq      | 90.063 ms                 | 144.633 ms                |
| ProcessOneStep            | 99.269 ms                 | 155.548 ms                |
| BlockToStepN              | 15.078 ms                 | 18.498 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
W20240116 12:08:44.247257 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=155, pq.top=155
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
E20240116 12:08:44.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=405
W20240116 12:08:44.639540 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
W20240116 12:08:45.558454 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=159, pq.top=159
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
E20240116 12:08:45.616017 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1452991
W20240116 12:08:45.684476 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240116 12:08:46.580529 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=162, pq.top=162
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
E20240116 12:08:46.616011 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1476690
W20240116 12:08:46.704913 30420 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240116 12:08:47.580582 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=165, pq.top=165
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
E20240116 12:08:47.616003 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1501462
W20240116 12:08:47.749715 30420 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 349.424 us                | 667.183 us                |
| Backward                  | 724.191 us                | 1.520 ms                  |
| Optimize                  | 96.127 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 491.957 us                | 1.259 ms                  |
| AfterBackward             | 99.313 ms                 | 155.608 ms                |
| BlockToStepN              | 15.137 ms                 | 18.607 ms                 |
| E2E-100                   | 37.261 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
W20240116 12:08:48.580281 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=168, pq.top=168
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
E20240116 12:08:48.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1526063
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.294 ms                  | 10.000 ms                 |
| ProcessBack:UpdateCache   | 5.667 ms                  | 6.183 ms                  |
| ProcessBack:UpsertPq      | 90.139 ms                 | 144.633 ms                |
| ProcessOneStep            | 99.312 ms                 | 155.548 ms                |
| BlockToStepN              | 15.057 ms                 | 18.498 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
W20240116 12:08:48.923930 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
E20240116 12:08:49.616039 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1551244
W20240116 12:08:49.881136 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=172, pq.top=172
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
W20240116 12:08:49.953325 30420 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
E20240116 12:08:50.616009 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1576161
W20240116 12:08:50.881767 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=175, pq.top=175
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
W20240116 12:08:51.001235 30420 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
E20240116 12:08:51.616025 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1600541
W20240116 12:08:51.881026 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=178, pq.top=178
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
W20240116 12:08:52.048929 30420 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
E20240116 12:08:52.616017 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1624980
W20240116 12:08:52.882004 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=181, pq.top=181
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 353.418 us                | 667.183 us                |
| Backward                  | 719.414 us                | 1.520 ms                  |
| Optimize                  | 96.177 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 477.118 us                | 1.259 ms                  |
| AfterBackward             | 99.296 ms                 | 155.608 ms                |
| BlockToStepN              | 15.154 ms                 | 18.607 ms                 |
| E2E-100                   | 37.261 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
W20240116 12:08:53.218379 30420 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
E20240116 12:08:53.616012 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1649703
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.295 ms                  | 10.000 ms                 |
| ProcessBack:UpdateCache   | 5.668 ms                  | 6.183 ms                  |
| ProcessBack:UpsertPq      | 90.008 ms                 | 144.633 ms                |
| ProcessOneStep            | 99.254 ms                 | 155.548 ms                |
| BlockToStepN              | 15.076 ms                 | 18.498 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
W20240116 12:08:54.195248 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=185, pq.top=185
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
W20240116 12:08:54.267114 30420 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
E20240116 12:08:54.616017 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1674242
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
W20240116 12:08:55.195375 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=188, pq.top=188
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
W20240116 12:08:55.306279 30420 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
E20240116 12:08:55.616039 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1698792
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
W20240116 12:08:56.342715 30420 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
W20240116 12:08:56.493875 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=192, pq.top=192
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
E20240116 12:08:56.616009 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1559
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
W20240116 12:08:57.495930 30420 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
E20240116 12:08:57.616078 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1747879
W20240116 12:08:57.802220 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=196, pq.top=196
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 354.591 us                | 667.183 us                |
| Backward                  | 704.157 us                | 1.520 ms                  |
| Optimize                  | 95.690 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 459.845 us                | 1.259 ms                  |
| AfterBackward             | 99.071 ms                 | 155.608 ms                |
| BlockToStepN              | 15.147 ms                 | 18.607 ms                 |
| E2E-100                   | 37.261 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
W20240116 12:08:58.526540 30420 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
E20240116 12:08:58.616011 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1772275
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.297 ms                  | 10.000 ms                 |
| ProcessBack:UpdateCache   | 5.667 ms                  | 6.183 ms                  |
| ProcessBack:UpsertPq      | 89.764 ms                 | 144.633 ms                |
| ProcessOneStep            | 99.006 ms                 | 155.548 ms                |
| BlockToStepN              | 15.076 ms                 | 18.498 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:08:59.111353 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=200, pq.top=200
Step199:rank3, time: 33.729, per_step: 0.333947
Step199:rank2, time: 33.729, per_step: 0.333946
Step199:rank1, time: 33.729, per_step: 0.333946
Step199:rank0, time: 33.729, per_step: 0.333946
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
W20240116 12:08:59.566629 30420 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
E20240116 12:08:59.616010 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1796349
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
W20240116 12:09:00.115005 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=203, pq.top=203
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
E20240116 12:09:00.616017 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1820515
W20240116 12:09:00.617471 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
W20240116 12:09:01.432474 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=207, pq.top=207
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
E20240116 12:09:01.616012 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2502
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
W20240116 12:09:01.788847 30420 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
W20240116 12:09:02.455327 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=210, pq.top=210
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
E20240116 12:09:02.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1867561
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
W20240116 12:09:02.813905 30420 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 360.033 us                | 667.183 us                |
| Backward                  | 684.379 us                | 1.520 ms                  |
| Optimize                  | 96.127 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 432.437 us                | 1.259 ms                  |
| AfterBackward             | 99.055 ms                 | 155.608 ms                |
| BlockToStepN              | 15.154 ms                 | 18.607 ms                 |
| E2E-100                   | 33.728 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
W20240116 12:09:03.471248 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=213, pq.top=213
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
E20240116 12:09:03.616127 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1890995
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
W20240116 12:09:03.823385 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.297 ms                  | 10.000 ms                 |
| ProcessBack:UpdateCache   | 5.669 ms                  | 6.183 ms                  |
| ProcessBack:UpsertPq      | 89.812 ms                 | 144.633 ms                |
| ProcessOneStep            | 99.025 ms                 | 155.548 ms                |
| BlockToStepN              | 15.076 ms                 | 18.498 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
W20240116 12:09:04.474380 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=216, pq.top=216
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
E20240116 12:09:04.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1933
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
W20240116 12:09:04.874019 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
W20240116 12:09:05.475111 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=219, pq.top=219
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
E20240116 12:09:05.616012 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1938715
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
W20240116 12:09:05.917680 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
E20240116 12:09:06.616020 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2336
W20240116 12:09:06.782017 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=223, pq.top=223
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
W20240116 12:09:06.959640 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
E20240116 12:09:07.616009 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=1986007
W20240116 12:09:07.786954 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=226, pq.top=226
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 360.872 us                | 667.183 us                |
| Backward                  | 676.318 us                | 1.520 ms                  |
| Optimize                  | 96.177 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 386.608 us                | 1.259 ms                  |
| AfterBackward             | 99.071 ms                 | 155.608 ms                |
| BlockToStepN              | 15.137 ms                 | 18.937 ms                 |
| E2E-100                   | 33.728 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:09:07.964190 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
E20240116 12:09:08.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2009350
W20240116 12:09:08.791666 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=229, pq.top=229
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.297 ms                  | 10.000 ms                 |
| ProcessBack:UpdateCache   | 5.668 ms                  | 6.183 ms                  |
| ProcessBack:UpsertPq      | 89.812 ms                 | 144.633 ms                |
| ProcessOneStep            | 99.025 ms                 | 155.548 ms                |
| BlockToStepN              | 15.071 ms                 | 18.831 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:09:08.968354 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
E20240116 12:09:09.616007 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2032789
W20240116 12:09:09.791954 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=232, pq.top=232
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
W20240116 12:09:10.138653 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
E20240116 12:09:10.616016 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2392
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
W20240116 12:09:11.102131 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=236, pq.top=236
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
W20240116 12:09:11.172847 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
E20240116 12:09:11.616006 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2080515
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
W20240116 12:09:12.208524 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
W20240116 12:09:12.410764 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=240, pq.top=240
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
E20240116 12:09:12.616008 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=3106
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 360.872 us                | 667.183 us                |
| Backward                  | 659.856 us                | 1.520 ms                  |
| Optimize                  | 97.095 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 363.636 us                | 1.259 ms                  |
| AfterBackward             | 98.939 ms                 | 155.608 ms                |
| BlockToStepN              | 15.154 ms                 | 18.937 ms                 |
| E2E-100                   | 33.728 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
W20240116 12:09:13.237977 30420 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
E20240116 12:09:13.616019 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=3442
W20240116 12:09:13.716390 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=244, pq.top=244
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.293 ms                  | 10.000 ms                 |
| ProcessBack:UpdateCache   | 5.668 ms                  | 6.183 ms                  |
| ProcessBack:UpsertPq      | 89.472 ms                 | 144.633 ms                |
| ProcessOneStep            | 98.782 ms                 | 155.548 ms                |
| BlockToStepN              | 15.071 ms                 | 18.831 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
W20240116 12:09:14.382638 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
E20240116 12:09:14.616005 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2151584
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
W20240116 12:09:15.039848 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=248, pq.top=248
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
W20240116 12:09:15.426421 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
E20240116 12:09:15.616024 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2173431
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
W20240116 12:09:16.220527 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=251, pq.top=251
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
W20240116 12:09:16.446425 30420 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
E20240116 12:09:16.616555 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2190062
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
W20240116 12:09:17.229311 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=253, pq.top=253
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
W20240116 12:09:17.484985 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
E20240116 12:09:17.616011 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2205688
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 361.762 us                | 584.668 us                |
| Backward                  | 659.267 us                | 1.508 ms                  |
| Optimize                  | 97.224 us                 | 251.782 us                |
| BarrierTimeBeforeRank0    | 324.180 us                | 1.142 ms                  |
| AfterBackward             | 98.934 ms                 | 168.765 ms                |
| BlockToStepN              | 15.147 ms                 | 18.607 ms                 |
| E2E-100                   | 33.728 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
E20240116 12:09:18.616011 29563 parallel_pq_v2.h:76] insert failed, size(hashtable)=3686
W20240116 12:09:18.645748 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=256, pq.top=256
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
W20240116 12:09:18.666133 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.293 ms                  | 9.748 ms                  |
| ProcessBack:UpdateCache   | 5.668 ms                  | 6.095 ms                  |
| ProcessBack:UpsertPq      | 89.654 ms                 | 158.047 ms                |
| ProcessOneStep            | 98.901 ms                 | 168.691 ms                |
| BlockToStepN              | 15.076 ms                 | 18.831 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
E20240116 12:09:19.616032 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2241168
W20240116 12:09:19.824483 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=259, pq.top=259
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
W20240116 12:09:19.844398 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
E20240116 12:09:20.616010 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2263428
W20240116 12:09:20.866866 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=262, pq.top=262
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
W20240116 12:09:20.886552 30420 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
E20240116 12:09:21.616022 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2286072
W20240116 12:09:21.885682 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=265, pq.top=265
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
W20240116 12:09:21.906493 30420 grad_async_v2.h:109] Detect new sample comes, old_end5, new_end6
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
E20240116 12:09:22.616020 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=620
W20240116 12:09:22.892913 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=268, pq.top=268
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
W20240116 12:09:22.912447 30420 grad_async_v2.h:109] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 363.199 us                | 584.668 us                |
| Backward                  | 658.588 us                | 1.508 ms                  |
| Optimize                  | 97.908 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 333.071 us                | 1.259 ms                  |
| AfterBackward             | 99.056 ms                 | 168.765 ms                |
| BlockToStepN              | 15.184 ms                 | 18.937 ms                 |
| E2E-100                   | 33.728 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
E20240116 12:09:23.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2331918
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.292 ms                  | 9.748 ms                  |
| ProcessBack:UpdateCache   | 5.669 ms                  | 6.095 ms                  |
| ProcessBack:UpsertPq      | 89.765 ms                 | 158.047 ms                |
| ProcessOneStep            | 99.004 ms                 | 168.691 ms                |
| BlockToStepN              | 15.108 ms                 | 18.831 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:09:23.893393 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=271, pq.top=271
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
W20240116 12:09:23.954404 30420 grad_async_v2.h:109] Detect new sample comes, old_end1, new_end2
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
E20240116 12:09:24.616030 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=657
W20240116 12:09:24.894908 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=274, pq.top=274
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
W20240116 12:09:24.964113 30420 grad_async_v2.h:109] Detect new sample comes, old_end4, new_end5
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
E20240116 12:09:25.616017 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2377810
W20240116 12:09:25.894322 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=277, pq.top=277
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
W20240116 12:09:25.967793 30420 grad_async_v2.h:109] Detect new sample comes, old_end7, new_end8
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
E20240116 12:09:26.616015 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=553
W20240116 12:09:26.899269 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=280, pq.top=280
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
W20240116 12:09:26.973282 30420 grad_async_v2.h:109] Detect new sample comes, old_end0, new_end1
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
E20240116 12:09:27.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2422822
W20240116 12:09:27.906232 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=283, pq.top=283
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 364.872 us                | 584.668 us                |
| Backward                  | 654.434 us                | 1.508 ms                  |
| Optimize                  | 98.591 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 396.429 us                | 1.329 ms                  |
| AfterBackward             | 98.991 ms                 | 168.765 ms                |
| BlockToStepN              | 15.249 ms                 | 18.937 ms                 |
| E2E-100                   | 33.728 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
W20240116 12:09:27.978824 30420 grad_async_v2.h:109] Detect new sample comes, old_end3, new_end4
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
E20240116 12:09:28.616122 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=394
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.290 ms                  | 9.748 ms                  |
| ProcessBack:UpdateCache   | 5.668 ms                  | 6.095 ms                  |
| ProcessBack:UpsertPq      | 89.654 ms                 | 158.047 ms                |
| ProcessOneStep            | 98.901 ms                 | 168.691 ms                |
| BlockToStepN              | 15.173 ms                 | 18.831 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240116 12:09:28.909212 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=286, pq.top=286
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
W20240116 12:09:28.985198 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
E20240116 12:09:29.616014 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2468049
W20240116 12:09:29.909044 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=289, pq.top=289
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
W20240116 12:09:30.029479 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
E20240116 12:09:30.616010 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2490869
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
W20240116 12:09:31.074452 30420 grad_async_v2.h:109] Detect new sample comes, old_end2, new_end3
W20240116 12:09:31.225560 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=293, pq.top=293
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
E20240116 12:09:31.616010 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2513788
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
W20240116 12:09:32.225917 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=296, pq.top=296
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
W20240116 12:09:32.235265 30420 grad_async_v2.h:109] Detect new sample comes, old_end6, new_end7
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
E20240116 12:09:32.616008 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=946
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| Forward                   | 367.395 us                | 584.668 us                |
| Backward                  | 650.600 us                | 1.508 ms                  |
| Optimize                  | 98.591 us                 | 255.239 us                |
| BarrierTimeBeforeRank0    | 436.624 us                | 1.367 ms                  |
| AfterBackward             | 98.777 ms                 | 168.765 ms                |
| BlockToStepN              | 15.252 ms                 | 19.477 ms                 |
| E2E-100                   | 33.728 s                  | 37.261 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
W20240116 12:09:33.274258 30420 grad_async_v2.h:109] Detect new sample comes, old_end9, new_end0
W20240116 12:09:33.530984 29563 grad_async_v2.h:222] Sleep in <BlockToStepN>, step_no=300, pq.top=300
Step299:rank3, time: 34.420, per_step: 0.340795
Step299:rank2, time: 34.420, per_step: 0.340794
Step299:rank0, time: 34.420, per_step: 0.340794
Step299:rank1, time: 34.420, per_step: 0.340795
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
E20240116 12:09:33.618279 30420 parallel_pq_v2.h:76] insert failed, size(hashtable)=2563088
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 3.288 ms                  | 9.748 ms                  |
| ProcessBack:UpdateCache   | 5.668 ms                  | 6.095 ms                  |
| ProcessBack:UpsertPq      | 89.447 ms                 | 158.047 ms                |
| ProcessOneStep            | 98.728 ms                 | 168.691 ms                |
| BlockToStepN              | 15.181 ms                 | 19.556 ms                 |
+---------------------------+---------------------------+---------------------------+
ERROR [29563 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
*** Aborted at 1705378176 (Unix time, try 'date -d @1705378176') ***
*** Signal 11 (SIGSEGV) (0x1000193db180) received by PID 29563 (pthread TID 0x7fa9287f0640) (linux TID 30419) (code: address not mapped to object), stack trace: ***
W20240116 12:09:37.720919 29563 HazptrDomain.h:148] Tagged objects remain. This may indicate a higher-level leak of object(s) that use hazptr_obj_cohort.
