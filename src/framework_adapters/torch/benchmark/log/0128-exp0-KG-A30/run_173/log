WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 17:02:26.420789 548631 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_FB15k_53', no_save_emb=True, max_step=500, batch_size=1800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [548631 sampler.py:454] Start PreSampling
WARNING [548631 sampler.py:532] Before construct renumbering_dict
WARNING [548631 sampler.py:555] PreSampling done
W20240128 17:02:28.408819 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 17:02:28.408994 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 17:02:28.409022 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 17:02:28.409042 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 17:02:28.409070 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 17:02:28.409096 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 17:02:28.409114 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 17:02:28.409144 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 17:02:28.409166 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 17:02:28.409184 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 17:02:28.409207 548631 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 17:02:28.409226 548631 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 17:02:28.409245 548631 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 17:02:28.409346 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 17:02:28.409372 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 17:02:28.409390 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 17:02:28.409430 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 17:02:28.409448 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 17:02:28.409472 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 17:02:28.409493 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 17:02:28.409510 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 17:02:28.409534 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 17:02:28.409554 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 17:02:28.409570 548631 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 17:02:28.409585 548631 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 17:02:28.409600 548631 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 17:02:28.409638 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 17:02:28.409658 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 17:02:28.409675 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 17:02:28.409691 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 17:02:28.409709 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 17:02:28.409726 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 17:02:28.409742 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 17:02:28.409760 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 17:02:28.409783 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 17:02:28.409806 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 17:02:28.409832 548631 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 17:02:28.409847 548631 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 17:02:28.409862 548631 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 17:02:28.409900 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 17:02:28.409920 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 17:02:28.409937 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 17:02:28.409960 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 17:02:28.409976 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 17:02:28.409997 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 17:02:28.410022 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 17:02:28.410040 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 17:02:28.410058 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 17:02:28.410077 548631 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 17:02:28.410097 548631 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 17:02:28.410112 548631 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 17:02:28.410126 548631 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 17:02:28.558827 548631 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 17:02:28.558951 548631 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([1645, 1929, 2015,  ..., 2327, 6213, 6879]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.169 seconds
[Rank1] pid = 548950
[Rank2] pid = 549014
INFO [548631 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [548950 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [549014 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [549014 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [549014 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [549014 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [549014 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [549015 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [549015 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [548631 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [548950 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [548631 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [548950 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [548631 cache_common.py:139] TorchNativeStdEmb construct done
INFO [549015 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
WARNING [548631 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [548950 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [548950 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [549015 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [549015 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 17:02:30.945353 549016 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 17:02:30.945425 549054 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 17:02:30.945513 549115 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 17:02:30.945601 548951 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240128 17:02:31.323774 549054 recstore.cc:66] init folly done
E20240128 17:02:31.323872 549115 recstore.cc:66] init folly done
E20240128 17:02:31.323879 548951 recstore.cc:66] init folly done
E20240128 17:02:31.323875 549016 recstore.cc:66] init folly done
I20240128 17:02:31.379801 549054 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 17:02:31.399650 548951 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 17:02:31.404399 549115 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 17:02:31.412720 549016 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.847 us                | 12.371 ms                 |
| Forward                   | 7.279 ms                  | 750.451 ms                |
| Backward                  | 82.117 ms                 | 1.467 s                   |
| Optimize                  | 1.239 ms                  | 63.773 ms                 |
| BarrierTimeBeforeRank0    | 42.130 us                 | 327.569 us                |
| BlockToStepN              | 9.505 us                  | 73.149 us                 |
| OneStep                   | 91.685 ms                 | 1.480 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.790 us                | 12.418 ms                 |
| Forward                   | 6.814 ms                  | 750.451 ms                |
| Backward                  | 136.321 ms                | 1.467 s                   |
| Optimize                  | 1.263 ms                  | 63.773 ms                 |
| BarrierTimeBeforeRank0    | 33.269 us                 | 14.288 ms                 |
| BlockToStepN              | 11.630 us                 | 73.149 us                 |
| OneStep                   | 148.712 ms                | 1.480 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.835 us                | 12.371 ms                 |
| Forward                   | 6.661 ms                  | 10.323 ms                 |
| Backward                  | 177.325 ms                | 415.220 ms                |
| Optimize                  | 1.268 ms                  | 2.056 ms                  |
| BarrierTimeBeforeRank0    | 31.440 us                 | 14.288 ms                 |
| BlockToStepN              | 11.630 us                 | 66.775 us                 |
| OneStep                   | 188.504 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.422 us                | 12.371 ms                 |
| Forward                   | 6.545 ms                  | 10.323 ms                 |
| Backward                  | 249.347 ms                | 415.220 ms                |
| Optimize                  | 1.273 ms                  | 2.056 ms                  |
| BarrierTimeBeforeRank0    | 31.440 us                 | 14.288 ms                 |
| BlockToStepN              | 13.577 us                 | 72.499 us                 |
| OneStep                   | 266.200 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.422 us                | 12.371 ms                 |
| Forward                   | 6.511 ms                  | 10.323 ms                 |
| Backward                  | 284.794 ms                | 437.226 ms                |
| Optimize                  | 1.283 ms                  | 2.270 ms                  |
| BarrierTimeBeforeRank0    | 32.450 us                 | 14.288 ms                 |
| BlockToStepN              | 13.577 us                 | 72.499 us                 |
| OneStep                   | 298.205 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.422 us                | 12.371 ms                 |
| Forward                   | 6.477 ms                  | 10.323 ms                 |
| Backward                  | 295.386 ms                | 486.790 ms                |
| Optimize                  | 1.286 ms                  | 2.270 ms                  |
| BarrierTimeBeforeRank0    | 32.308 us                 | 14.288 ms                 |
| BlockToStepN              | 14.316 us                 | 72.499 us                 |
| OneStep                   | 306.204 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 30.363, sample: 0.183, forward: 1.325, backward: 27.344, update: 0.195
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 30.359, sample: 0.195, forward: 1.320, backward: 26.702, update: 0.210
[Rank3] pid = 549015
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
train_sampler.Prefill()
-------Step 0-------
tensor([10949,   352,  9155,  7664,  7987,  5895,  1155,  5058, 11916,   142]) tensor([ 2015,  7951,  9236,  1439,  7649, 10430, 12612, 10809,  7458,  1216])
-------Step 1-------
tensor([10949,   352,  9155,  7664,  7987,  5895,  1155,  5058, 11916,   142]) tensor([13374, 11047,  1698,  3752,  2420,   638,  6856,  3082,  3144, 13303])
-------Step 2-------
tensor([10390,  9842,  6166,  9663,  2094,  8600,  7436,  3163, 12774,    47]) tensor([ 7677,  5215,  3570, 10689,  7088,  1440,  5530, 12568, 11595,  4030])
-------Step 3-------
tensor([10390,  9842,  6166,  9663,  2094,  8600,  7436,  3163, 12774,    47]) tensor([ 9011,  5697,  5043,    79, 13298, 10861, 13096,   356, 13536,  5544])
-------Step 4-------
tensor([11918,   713,  6903,    80, 11679, 10559, 14315, 10819, 11993,  7035]) tensor([ 3346,  8824,  7089, 10491,  9904, 12048,  1950,  2712, 11100,  1451])
-------Step 5-------
tensor([11918,   713,  6903,    80, 11679, 10559, 14315, 10819, 11993,  7035]) tensor([11033, 10473, 11257,  1332,  2164,  9895,  8791, 12976, 10660, 13317])
-------Step 6-------
tensor([   75,   113,  3541, 13086, 13632,   364,   346,   136,  4004,   317]) tensor([ 5939, 12346,  8030, 10811,  9487,  2252,   259, 13243, 11743, 11620])
-------Step 7-------
tensor([   75,   113,  3541, 13086, 13632,   364,   346,   136,  4004,   317]) tensor([10385, 14091,  6949, 11374,   671, 11002,   693, 14288, 13926,  9028])
-------Step 8-------
tensor([ 5046,   667, 12131, 10098,  3754, 11878,  7708, 10102,  5234,  9842]) tensor([13451, 10424, 12822,   843, 12829,  9822,  8210,  2396,  7516,  9818])
-------Step 9-------
tensor([ 5046,   667, 12131, 10098,  3754, 11878,  7708, 10102,  5234,  9842]) tensor([ 9364, 14299,  6075,  7685,  4356,  6964, 13738,  7001,  6839, 12319])
before start barrier
start train
[proc 0] 100 steps, total: 30.383, sample: 0.201, forward: 1.401, backward: 28.419, update: 0.191
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 30.350, sample: 0.198, forward: 1.248, backward: 16.483, update: 0.207
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.835 us                | 12.371 ms                 |
| Forward                   | 6.477 ms                  | 10.323 ms                 |
| Backward                  | 306.912 ms                | 540.223 ms                |
| Optimize                  | 1.292 ms                  | 2.270 ms                  |
| BarrierTimeBeforeRank0    | 32.435 us                 | 14.288 ms                 |
| BlockToStepN              | 14.378 us                 | 72.499 us                 |
| OneStep                   | 315.642 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.422 us                | 12.371 ms                 |
| Forward                   | 6.477 ms                  | 10.323 ms                 |
| Backward                  | 314.623 ms                | 591.025 ms                |
| Optimize                  | 1.292 ms                  | 2.270 ms                  |
| BarrierTimeBeforeRank0    | 32.308 us                 | 14.288 ms                 |
| BlockToStepN              | 14.378 us                 | 73.149 us                 |
| OneStep                   | 324.606 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 827.866 us                | 12.371 ms                 |
| Forward                   | 6.446 ms                  | 10.323 ms                 |
| Backward                  | 321.187 ms                | 609.854 ms                |
| Optimize                  | 1.292 ms                  | 2.270 ms                  |
| BarrierTimeBeforeRank0    | 32.165 us                 | 14.288 ms                 |
| BlockToStepN              | 14.633 us                 | 73.149 us                 |
| OneStep                   | 331.182 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 827.866 us                | 12.371 ms                 |
| Forward                   | 6.395 ms                  | 10.323 ms                 |
| Backward                  | 342.512 ms                | 659.727 ms                |
| Optimize                  | 1.294 ms                  | 2.270 ms                  |
| BarrierTimeBeforeRank0    | 32.165 us                 | 19.848 ms                 |
| BlockToStepN              | 15.215 us                 | 73.149 us                 |
| OneStep                   | 351.379 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 828.537 us                | 12.371 ms                 |
| Forward                   | 6.394 ms                  | 10.323 ms                 |
| Backward                  | 364.482 ms                | 686.577 ms                |
| Optimize                  | 1.305 ms                  | 2.270 ms                  |
| BarrierTimeBeforeRank0    | 32.308 us                 | 19.848 ms                 |
| BlockToStepN              | 15.610 us                 | 73.149 us                 |
| OneStep                   | 376.662 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.599 us                | 12.371 ms                 |
| Forward                   | 6.394 ms                  | 10.323 ms                 |
| Backward                  | 371.263 ms                | 726.443 ms                |
| Optimize                  | 1.305 ms                  | 2.417 ms                  |
| BarrierTimeBeforeRank0    | 32.435 us                 | 42.451 ms                 |
| BlockToStepN              | 15.757 us                 | 73.149 us                 |
| OneStep                   | 381.749 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.923 us                | 12.123 ms                 |
| Forward                   | 6.394 ms                  | 10.196 ms                 |
| Backward                  | 391.817 ms                | 745.233 ms                |
| Optimize                  | 1.310 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 32.536 us                 | 42.451 ms                 |
| BlockToStepN              | 15.942 us                 | 72.499 us                 |
| OneStep                   | 403.964 ms                | 774.023 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.923 us                | 12.123 ms                 |
| Forward                   | 6.382 ms                  | 10.196 ms                 |
| Backward                  | 409.464 ms                | 783.235 ms                |
| Optimize                  | 1.310 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 32.536 us                 | 42.451 ms                 |
| BlockToStepN              | 15.983 us                 | 72.499 us                 |
| OneStep                   | 419.622 ms                | 794.079 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.599 us                | 12.123 ms                 |
| Forward                   | 6.382 ms                  | 10.196 ms                 |
| Backward                  | 415.220 ms                | 807.659 ms                |
| Optimize                  | 1.310 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 32.808 us                 | 42.451 ms                 |
| BlockToStepN              | 16.313 us                 | 72.499 us                 |
| OneStep                   | 428.799 ms                | 826.332 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.790 us                | 12.123 ms                 |
| Forward                   | 6.356 ms                  | 10.196 ms                 |
| Backward                  | 437.226 ms                | 839.296 ms                |
| Optimize                  | 1.312 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 32.864 us                 | 42.451 ms                 |
| BlockToStepN              | 16.599 us                 | 72.499 us                 |
| OneStep                   | 452.156 ms                | 869.530 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.790 us                | 12.123 ms                 |
| Forward                   | 6.380 ms                  | 10.196 ms                 |
| Backward                  | 443.745 ms                | 873.703 ms                |
| Optimize                  | 1.314 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.021 us                 | 42.451 ms                 |
| BlockToStepN              | 17.300 us                 | 72.499 us                 |
| OneStep                   | 467.670 ms                | 895.514 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.014 us                | 12.123 ms                 |
| Forward                   | 6.380 ms                  | 10.196 ms                 |
| Backward                  | 464.416 ms                | 909.558 ms                |
| Optimize                  | 1.329 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.152 us                 | 42.451 ms                 |
| BlockToStepN              | 17.580 us                 | 73.149 us                 |
| OneStep                   | 473.702 ms                | 929.778 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.014 us                | 12.123 ms                 |
| Forward                   | 6.382 ms                  | 10.196 ms                 |
| Backward                  | 467.880 ms                | 933.712 ms                |
| Optimize                  | 1.329 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.119 us                 | 42.451 ms                 |
| BlockToStepN              | 17.935 us                 | 73.149 us                 |
| OneStep                   | 486.602 ms                | 950.256 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.304 us                | 12.371 ms                 |
| Forward                   | 6.388 ms                  | 10.196 ms                 |
| Backward                  | 486.790 ms                | 962.951 ms                |
| Optimize                  | 1.337 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.205 us                 | 42.451 ms                 |
| BlockToStepN              | 18.612 us                 | 73.149 us                 |
| OneStep                   | 499.524 ms                | 973.232 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.014 us                | 12.371 ms                 |
| Forward                   | 6.380 ms                  | 10.196 ms                 |
| Backward                  | 492.200 ms                | 987.794 ms                |
| Optimize                  | 1.337 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.152 us                 | 42.451 ms                 |
| BlockToStepN              | 18.960 us                 | 73.149 us                 |
| OneStep                   | 505.538 ms                | 997.689 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 75.499, sample: 0.213, forward: 0.629, backward: 74.144, update: 0.146
[proc 1] 200 steps, total: 75.499, sample: 0.200, forward: 0.560, backward: 71.482, update: 0.136
[proc 2] 200 steps, total: 75.499, sample: 0.197, forward: 0.450, backward: 34.053, update: 0.148
[proc 3] 200 steps, total: 75.499, sample: 0.192, forward: 0.538, backward: 68.908, update: 0.180
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.014 us                | 12.371 ms                 |
| Forward                   | 6.353 ms                  | 10.196 ms                 |
| Backward                  | 514.334 ms                | 1.010 s                   |
| Optimize                  | 1.339 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.205 us                 | 42.451 ms                 |
| BlockToStepN              | 19.426 us                 | 73.149 us                 |
| OneStep                   | 529.030 ms                | 1.022 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.014 us                | 12.371 ms                 |
| Forward                   | 6.353 ms                  | 10.196 ms                 |
| Backward                  | 524.109 ms                | 1.035 s                   |
| Optimize                  | 1.343 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.269 us                 | 42.451 ms                 |
| BlockToStepN              | 19.584 us                 | 73.149 us                 |
| OneStep                   | 543.733 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.661 us                | 12.371 ms                 |
| Forward                   | 6.347 ms                  | 10.196 ms                 |
| Backward                  | 536.373 ms                | 1.052 s                   |
| Optimize                  | 1.348 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.369 us                 | 42.451 ms                 |
| BlockToStepN              | 20.204 us                 | 73.149 us                 |
| OneStep                   | 549.750 ms                | 1.070 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.661 us                | 12.371 ms                 |
| Forward                   | 6.343 ms                  | 10.196 ms                 |
| Backward                  | 540.223 ms                | 1.070 s                   |
| Optimize                  | 1.367 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.529 us                 | 42.451 ms                 |
| BlockToStepN              | 20.217 us                 | 73.149 us                 |
| OneStep                   | 555.651 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.790 us                | 12.371 ms                 |
| Forward                   | 6.341 ms                  | 10.196 ms                 |
| Backward                  | 556.427 ms                | 1.098 s                   |
| Optimize                  | 1.359 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.565 us                 | 42.451 ms                 |
| BlockToStepN              | 20.742 us                 | 73.149 us                 |
| OneStep                   | 569.376 ms                | 1.121 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.014 us                | 12.371 ms                 |
| Forward                   | 6.343 ms                  | 10.196 ms                 |
| Backward                  | 561.000 ms                | 1.113 s                   |
| Optimize                  | 1.367 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.589 us                 | 42.451 ms                 |
| BlockToStepN              | 20.763 us                 | 73.149 us                 |
| OneStep                   | 584.159 ms                | 1.130 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.661 us                | 12.371 ms                 |
| Forward                   | 6.341 ms                  | 10.196 ms                 |
| Backward                  | 580.160 ms                | 1.158 s                   |
| Optimize                  | 1.367 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.565 us                 | 42.451 ms                 |
| BlockToStepN              | 20.980 us                 | 73.149 us                 |
| OneStep                   | 600.071 ms                | 1.172 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.661 us                | 12.371 ms                 |
| Forward                   | 6.341 ms                  | 10.196 ms                 |
| Backward                  | 591.025 ms                | 1.171 s                   |
| Optimize                  | 1.371 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.589 us                 | 42.451 ms                 |
| BlockToStepN              | 21.017 us                 | 73.149 us                 |
| OneStep                   | 603.249 ms                | 1.181 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.790 us                | 12.371 ms                 |
| Forward                   | 6.337 ms                  | 10.196 ms                 |
| Backward                  | 595.447 ms                | 1.187 s                   |
| Optimize                  | 1.367 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.589 us                 | 42.451 ms                 |
| BlockToStepN              | 21.190 us                 | 73.149 us                 |
| OneStep                   | 615.070 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.790 us                | 12.371 ms                 |
| Forward                   | 6.341 ms                  | 10.196 ms                 |
| Backward                  | 606.275 ms                | 1.212 s                   |
| Optimize                  | 1.367 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.589 us                 | 42.451 ms                 |
| BlockToStepN              | 21.316 us                 | 73.149 us                 |
| OneStep                   | 619.750 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.661 us                | 12.371 ms                 |
| Forward                   | 6.331 ms                  | 10.196 ms                 |
| Backward                  | 612.659 ms                | 1.224 s                   |
| Optimize                  | 1.371 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 33.774 us                 | 42.451 ms                 |
| BlockToStepN              | 21.407 us                 | 73.149 us                 |
| OneStep                   | 625.553 ms                | 1.233 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.790 us                | 12.123 ms                 |
| Forward                   | 6.329 ms                  | 9.081 ms                  |
| Backward                  | 617.024 ms                | 1.242 s                   |
| Optimize                  | 1.371 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.774 us                 | 36.783 ms                 |
| BlockToStepN              | 21.502 us                 | 72.499 us                 |
| OneStep                   | 644.898 ms                | 1.251 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.661 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 9.081 ms                  |
| Backward                  | 635.364 ms                | 1.270 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.850 us                 | 36.783 ms                 |
| BlockToStepN              | 21.569 us                 | 72.499 us                 |
| OneStep                   | 654.802 ms                | 1.279 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.304 us                | 12.123 ms                 |
| Forward                   | 6.329 ms                  | 9.081 ms                  |
| Backward                  | 644.946 ms                | 1.288 s                   |
| Optimize                  | 1.371 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.850 us                 | 36.783 ms                 |
| BlockToStepN              | 21.733 us                 | 72.499 us                 |
| OneStep                   | 663.339 ms                | 1.299 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.304 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 9.081 ms                  |
| Backward                  | 654.431 ms                | 1.308 s                   |
| Optimize                  | 1.371 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.774 us                 | 36.783 ms                 |
| BlockToStepN              | 21.827 us                 | 72.499 us                 |
| OneStep                   | 668.507 ms                | 1.317 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.847 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 9.081 ms                  |
| Backward                  | 664.708 ms                | 1.331 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.774 us                 | 36.783 ms                 |
| BlockToStepN              | 21.869 us                 | 72.499 us                 |
| OneStep                   | 683.072 ms                | 1.341 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 833.865 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 9.081 ms                  |
| Backward                  | 671.452 ms                | 1.344 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.774 us                 | 36.783 ms                 |
| BlockToStepN              | 21.869 us                 | 72.499 us                 |
| OneStep                   | 691.481 ms                | 1.353 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 833.911 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 9.081 ms                  |
| Backward                  | 673.833 ms                | 1.356 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.779 us                 | 36.783 ms                 |
| BlockToStepN              | 22.014 us                 | 72.499 us                 |
| OneStep                   | 694.226 ms                | 1.365 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 834.350 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 9.081 ms                  |
| Backward                  | 683.516 ms                | 1.374 s                   |
| Optimize                  | 1.386 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.850 us                 | 36.783 ms                 |
| BlockToStepN              | 22.071 us                 | 72.499 us                 |
| OneStep                   | 708.365 ms                | 1.384 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 833.911 us                | 12.123 ms                 |
| Forward                   | 6.312 ms                  | 9.081 ms                  |
| Backward                  | 686.577 ms                | 1.376 s                   |
| Optimize                  | 1.386 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.850 us                 | 36.783 ms                 |
| BlockToStepN              | 22.146 us                 | 72.499 us                 |
| OneStep                   | 725.897 ms                | 1.395 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 834.350 us                | 12.123 ms                 |
| Forward                   | 6.312 ms                  | 9.081 ms                  |
| Backward                  | 707.501 ms                | 1.418 s                   |
| Optimize                  | 1.386 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 33.977 us                 | 36.783 ms                 |
| BlockToStepN              | 22.417 us                 | 72.499 us                 |
| OneStep                   | 728.106 ms                | 1.427 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.136 us                | 12.123 ms                 |
| Forward                   | 6.312 ms                  | 9.081 ms                  |
| Backward                  | 715.551 ms                | 1.424 s                   |
| Optimize                  | 1.386 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 34.155 us                 | 36.783 ms                 |
| BlockToStepN              | 22.557 us                 | 82.406 us                 |
| OneStep                   | 734.424 ms                | 1.433 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.410 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 9.081 ms                  |
| Backward                  | 718.755 ms                | 1.453 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 34.270 us                 | 36.783 ms                 |
| BlockToStepN              | 22.695 us                 | 82.406 us                 |
| OneStep                   | 736.020 ms                | 1.462 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.136 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 9.081 ms                  |
| Backward                  | 726.066 ms                | 1.465 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 34.303 us                 | 36.783 ms                 |
| BlockToStepN              | 22.699 us                 | 82.406 us                 |
| OneStep                   | 753.968 ms                | 1.475 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.136 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 9.081 ms                  |
| Backward                  | 726.443 ms                | 1.470 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 34.303 us                 | 36.783 ms                 |
| BlockToStepN              | 22.946 us                 | 82.406 us                 |
| OneStep                   | 765.908 ms                | 1.480 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 125.411, sample: 0.201, forward: 0.520, backward: 112.486, update: 0.184
[proc 0] 300 steps, total: 125.411, sample: 0.205, forward: 0.614, backward: 124.272, update: 0.151
[proc 2] 300 steps, total: 125.411, sample: 0.181, forward: 0.452, backward: 55.971, update: 0.151
[proc 1] 300 steps, total: 125.411, sample: 0.195, forward: 0.555, backward: 117.338, update: 0.140
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.136 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 9.081 ms                  |
| Backward                  | 745.233 ms                | 1.496 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 34.303 us                 | 36.783 ms                 |
| BlockToStepN              | 22.946 us                 | 82.406 us                 |
| OneStep                   | 771.238 ms                | 1.505 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.410 us                | 12.123 ms                 |
| Forward                   | 6.329 ms                  | 9.081 ms                  |
| Backward                  | 758.504 ms                | 1.506 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 34.488 us                 | 36.783 ms                 |
| BlockToStepN              | 23.156 us                 | 82.406 us                 |
| OneStep                   | 774.023 ms                | 1.518 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.678 us                | 12.123 ms                 |
| Forward                   | 6.331 ms                  | 9.081 ms                  |
| Backward                  | 764.973 ms                | 1.533 s                   |
| Optimize                  | 1.385 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 34.380 us                 | 36.783 ms                 |
| BlockToStepN              | 23.359 us                 | 82.406 us                 |
| OneStep                   | 776.673 ms                | 1.544 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.893 us                | 12.123 ms                 |
| Forward                   | 6.337 ms                  | 9.081 ms                  |
| Backward                  | 769.492 ms                | 1.551 s                   |
| Optimize                  | 1.386 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 34.553 us                 | 36.783 ms                 |
| BlockToStepN              | 23.546 us                 | 82.406 us                 |
| OneStep                   | 792.167 ms                | 1.567 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 837.021 us                | 12.123 ms                 |
| Forward                   | 6.337 ms                  | 9.081 ms                  |
| Backward                  | 783.235 ms                | 1.569 s                   |
| Optimize                  | 1.386 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 34.676 us                 | 36.783 ms                 |
| BlockToStepN              | 23.669 us                 | 82.406 us                 |
| OneStep                   | 795.255 ms                | 1.578 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 837.860 us                | 12.123 ms                 |
| Forward                   | 6.340 ms                  | 9.081 ms                  |
| Backward                  | 785.182 ms                | 1.583 s                   |
| Optimize                  | 1.386 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 34.676 us                 | 36.783 ms                 |
| BlockToStepN              | 23.669 us                 | 82.406 us                 |
| OneStep                   | 795.276 ms                | 1.593 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.768 us                | 12.123 ms                 |
| Forward                   | 6.341 ms                  | 9.081 ms                  |
| Backward                  | 785.973 ms                | 1.584 s                   |
| Optimize                  | 1.386 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 34.951 us                 | 36.783 ms                 |
| BlockToStepN              | 23.768 us                 | 82.406 us                 |
| OneStep                   | 814.868 ms                | 1.593 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.400 us                | 12.123 ms                 |
| Forward                   | 6.341 ms                  | 9.081 ms                  |
| Backward                  | 786.675 ms                | 1.589 s                   |
| Optimize                  | 1.385 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 34.684 us                 | 36.783 ms                 |
| BlockToStepN              | 23.574 us                 | 82.406 us                 |
| OneStep                   | 815.904 ms                | 1.603 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.400 us                | 12.123 ms                 |
| Forward                   | 6.340 ms                  | 9.081 ms                  |
| Backward                  | 812.286 ms                | 1.610 s                   |
| Optimize                  | 1.386 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 34.951 us                 | 36.783 ms                 |
| BlockToStepN              | 23.669 us                 | 82.406 us                 |
| OneStep                   | 828.920 ms                | 1.620 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.755 us                | 12.123 ms                 |
| Forward                   | 6.340 ms                  | 9.081 ms                  |
| Backward                  | 817.009 ms                | 1.640 s                   |
| Optimize                  | 1.385 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 34.951 us                 | 36.783 ms                 |
| BlockToStepN              | 23.768 us                 | 82.406 us                 |
| OneStep                   | 830.181 ms                | 1.650 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.755 us                | 12.123 ms                 |
| Forward                   | 6.337 ms                  | 9.081 ms                  |
| Backward                  | 824.951 ms                | 1.653 s                   |
| Optimize                  | 1.385 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 35.058 us                 | 36.783 ms                 |
| BlockToStepN              | 23.860 us                 | 82.406 us                 |
| OneStep                   | 845.355 ms                | 1.662 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 842.325 us                | 12.123 ms                 |
| Forward                   | 6.340 ms                  | 9.081 ms                  |
| Backward                  | 835.463 ms                | 1.667 s                   |
| Optimize                  | 1.386 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 35.058 us                 | 36.783 ms                 |
| BlockToStepN              | 23.986 us                 | 82.406 us                 |
| OneStep                   | 846.847 ms                | 1.676 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 842.325 us                | 12.123 ms                 |
| Forward                   | 6.340 ms                  | 9.081 ms                  |
| Backward                  | 839.296 ms                | 1.684 s                   |
| Optimize                  | 1.386 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 35.089 us                 | 36.783 ms                 |
| BlockToStepN              | 24.056 us                 | 82.406 us                 |
| OneStep                   | 858.909 ms                | 1.694 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 842.589 us                | 12.123 ms                 |
| Forward                   | 6.340 ms                  | 9.081 ms                  |
| Backward                  | 848.571 ms                | 1.697 s                   |
| Optimize                  | 1.386 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 35.096 us                 | 36.783 ms                 |
| BlockToStepN              | 24.069 us                 | 82.406 us                 |
| OneStep                   | 862.688 ms                | 1.708 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 842.325 us                | 12.123 ms                 |
| Forward                   | 6.340 ms                  | 9.081 ms                  |
| Backward                  | 860.255 ms                | 1.699 s                   |
| Optimize                  | 1.393 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 35.143 us                 | 36.783 ms                 |
| BlockToStepN              | 24.240 us                 | 82.406 us                 |
| OneStep                   | 870.736 ms                | 1.709 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 842.325 us                | 12.123 ms                 |
| Forward                   | 6.341 ms                  | 9.081 ms                  |
| Backward                  | 860.870 ms                | 1.707 s                   |
| Optimize                  | 1.395 ms                  | 2.307 ms                  |
| BarrierTimeBeforeRank0    | 35.096 us                 | 36.783 ms                 |
| BlockToStepN              | 24.146 us                 | 82.406 us                 |
| OneStep                   | 882.584 ms                | 1.716 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 842.325 us                | 12.040 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 874.319 ms                | 1.718 s                   |
| Optimize                  | 1.399 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.143 us                 | 35.045 ms                 |
| BlockToStepN              | 24.240 us                 | 78.961 us                 |
| OneStep                   | 889.273 ms                | 1.728 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 842.589 us                | 12.040 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 877.898 ms                | 1.729 s                   |
| Optimize                  | 1.399 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.143 us                 | 35.045 ms                 |
| BlockToStepN              | 24.241 us                 | 78.961 us                 |
| OneStep                   | 893.939 ms                | 1.739 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.474 us                | 12.040 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 878.686 ms                | 1.740 s                   |
| Optimize                  | 1.399 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.143 us                 | 35.045 ms                 |
| BlockToStepN              | 24.373 us                 | 78.961 us                 |
| OneStep                   | 895.514 ms                | 1.750 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.857 us                | 12.040 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 886.815 ms                | 1.763 s                   |
| Optimize                  | 1.399 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.147 us                 | 35.045 ms                 |
| BlockToStepN              | 24.638 us                 | 78.961 us                 |
| OneStep                   | 907.912 ms                | 1.772 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.474 us                | 12.040 ms                 |
| Forward                   | 6.337 ms                  | 8.934 ms                  |
| Backward                  | 894.292 ms                | 1.780 s                   |
| Optimize                  | 1.399 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.143 us                 | 35.045 ms                 |
| BlockToStepN              | 24.768 us                 | 78.961 us                 |
| OneStep                   | 912.441 ms                | 1.788 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.074 us                | 12.040 ms                 |
| Forward                   | 6.337 ms                  | 8.934 ms                  |
| Backward                  | 909.558 ms                | 1.782 s                   |
| Optimize                  | 1.413 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.210 us                 | 35.045 ms                 |
| BlockToStepN              | 24.916 us                 | 78.961 us                 |
| OneStep                   | 920.070 ms                | 1.792 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.074 us                | 12.040 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 910.003 ms                | 1.795 s                   |
| Optimize                  | 1.415 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.210 us                 | 35.045 ms                 |
| BlockToStepN              | 24.933 us                 | 78.961 us                 |
| OneStep                   | 929.778 ms                | 1.805 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 849.200 us                | 12.040 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 916.277 ms                | 1.802 s                   |
| Optimize                  | 1.415 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.230 us                 | 36.783 ms                 |
| BlockToStepN              | 24.933 us                 | 78.961 us                 |
| OneStep                   | 936.268 ms                | 1.826 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 849.200 us                | 12.040 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 929.655 ms                | 1.831 s                   |
| Optimize                  | 1.421 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.241 us                 | 36.783 ms                 |
| BlockToStepN              | 24.937 us                 | 78.961 us                 |
| OneStep                   | 945.338 ms                | 1.846 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 852.159 us                | 12.040 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 933.712 ms                | 1.843 s                   |
| Optimize                  | 1.421 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.252 us                 | 36.783 ms                 |
| BlockToStepN              | 24.937 us                 | 78.961 us                 |
| OneStep                   | 950.256 ms                | 1.853 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 856.591 us                | 12.040 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 936.516 ms                | 1.853 s                   |
| Optimize                  | 1.421 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.325 us                 | 42.451 ms                 |
| BlockToStepN              | 24.937 us                 | 78.961 us                 |
| OneStep                   | 951.358 ms                | 1.871 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 856.591 us                | 12.040 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 958.641 ms                | 1.863 s                   |
| Optimize                  | 1.421 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.446 us                 | 42.451 ms                 |
| BlockToStepN              | 25.000 us                 | 78.961 us                 |
| OneStep                   | 973.137 ms                | 1.875 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 854.011 us                | 12.040 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 962.951 ms                | 1.875 s                   |
| Optimize                  | 1.432 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.446 us                 | 42.451 ms                 |
| BlockToStepN              | 25.075 us                 | 78.961 us                 |
| OneStep                   | 973.232 ms                | 1.893 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 856.591 us                | 12.040 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 963.351 ms                | 1.883 s                   |
| Optimize                  | 1.433 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.487 us                 | 42.451 ms                 |
| BlockToStepN              | 25.075 us                 | 78.961 us                 |
| OneStep                   | 985.909 ms                | 1.917 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 854.011 us                | 12.040 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 977.119 ms                | 1.910 s                   |
| Optimize                  | 1.433 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.487 us                 | 42.451 ms                 |
| BlockToStepN              | 25.115 us                 | 78.961 us                 |
| OneStep                   | 996.099 ms                | 1.922 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 856.591 us                | 12.040 ms                 |
| Forward                   | 6.337 ms                  | 8.934 ms                  |
| Backward                  | 987.598 ms                | 1.913 s                   |
| Optimize                  | 1.433 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.536 us                 | 42.451 ms                 |
| BlockToStepN              | 25.140 us                 | 78.961 us                 |
| OneStep                   | 996.640 ms                | 1.930 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 857.347 us                | 12.123 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 987.794 ms                | 1.924 s                   |
| Optimize                  | 1.433 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.536 us                 | 42.451 ms                 |
| BlockToStepN              | 25.140 us                 | 78.961 us                 |
| OneStep                   | 997.689 ms                | 1.951 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 857.347 us                | 12.163 ms                 |
| Forward                   | 6.337 ms                  | 8.934 ms                  |
| Backward                  | 988.149 ms                | 1.942 s                   |
| Optimize                  | 1.432 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.487 us                 | 42.451 ms                 |
| BlockToStepN              | 25.140 us                 | 78.961 us                 |
| OneStep                   | 1.004 s                   | 1.953 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 857.347 us                | 12.163 ms                 |
| Forward                   | 6.337 ms                  | 8.934 ms                  |
| Backward                  | 998.925 ms                | 1.964 s                   |
| Optimize                  | 1.433 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.544 us                 | 42.451 ms                 |
| BlockToStepN              | 25.202 us                 | 78.961 us                 |
| OneStep                   | 1.011 s                   | 1.972 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 174.732, sample: 0.223, forward: 0.630, backward: 173.417, update: 0.154
[proc 3] 400 steps, total: 174.732, sample: 0.196, forward: 0.529, backward: 158.681, update: 0.180
[proc 1] 400 steps, total: 174.732, sample: 0.192, forward: 0.550, backward: 162.789, update: 0.149
[proc 2] 400 steps, total: 174.732, sample: 0.185, forward: 0.459, backward: 77.572, update: 0.153
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 857.347 us                | 12.163 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 1.002 s                   | 1.965 s                   |
| Optimize                  | 1.433 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.548 us                 | 42.451 ms                 |
| BlockToStepN              | 25.221 us                 | 78.961 us                 |
| OneStep                   | 1.021 s                   | 1.976 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 857.751 us                | 12.163 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 1.010 s                   | 1.973 s                   |
| Optimize                  | 1.435 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.548 us                 | 42.451 ms                 |
| BlockToStepN              | 25.221 us                 | 78.961 us                 |
| OneStep                   | 1.022 s                   | 1.991 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 857.751 us                | 12.163 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 1.013 s                   | 1.986 s                   |
| Optimize                  | 1.435 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.548 us                 | 42.451 ms                 |
| BlockToStepN              | 25.328 us                 | 78.961 us                 |
| OneStep                   | 1.022 s                   | 1.995 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 857.347 us                | 12.163 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 1.017 s                   | 2.003 s                   |
| Optimize                  | 1.435 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.664 us                 | 42.451 ms                 |
| BlockToStepN              | 25.436 us                 | 78.961 us                 |
| OneStep                   | 1.041 s                   | 2.012 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 857.751 us                | 12.163 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 1.028 s                   | 2.012 s                   |
| Optimize                  | 1.435 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.753 us                 | 42.451 ms                 |
| BlockToStepN              | 25.461 us                 | 78.961 us                 |
| OneStep                   | 1.043 s                   | 2.022 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 859.213 us                | 12.163 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 1.031 s                   | 2.032 s                   |
| Optimize                  | 1.435 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.753 us                 | 42.451 ms                 |
| BlockToStepN              | 25.461 us                 | 78.961 us                 |
| OneStep                   | 1.045 s                   | 2.042 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 859.213 us                | 12.163 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 1.035 s                   | 2.047 s                   |
| Optimize                  | 1.436 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.753 us                 | 42.451 ms                 |
| BlockToStepN              | 25.520 us                 | 78.961 us                 |
| OneStep                   | 1.060 s                   | 2.057 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 859.213 us                | 12.163 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 1.036 s                   | 2.061 s                   |
| Optimize                  | 1.436 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.753 us                 | 42.451 ms                 |
| BlockToStepN              | 25.618 us                 | 78.961 us                 |
| OneStep                   | 1.060 s                   | 2.074 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 860.644 us                | 12.163 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 1.051 s                   | 2.072 s                   |
| Optimize                  | 1.449 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.764 us                 | 42.451 ms                 |
| BlockToStepN              | 25.636 us                 | 78.961 us                 |
| OneStep                   | 1.067 s                   | 2.082 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 859.213 us                | 12.163 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 1.052 s                   | 2.081 s                   |
| Optimize                  | 1.449 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.753 us                 | 42.451 ms                 |
| BlockToStepN              | 25.778 us                 | 78.961 us                 |
| OneStep                   | 1.070 s                   | 2.090 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 860.644 us                | 12.163 ms                 |
| Forward                   | 6.341 ms                  | 8.934 ms                  |
| Backward                  | 1.058 s                   | 2.098 s                   |
| Optimize                  | 1.449 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.753 us                 | 42.451 ms                 |
| BlockToStepN              | 25.827 us                 | 78.961 us                 |
| OneStep                   | 1.070 s                   | 2.108 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 860.644 us                | 12.163 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 1.061 s                   | 2.099 s                   |
| Optimize                  | 1.449 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.753 us                 | 42.451 ms                 |
| BlockToStepN              | 25.882 us                 | 78.961 us                 |
| OneStep                   | 1.080 s                   | 2.108 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 861.515 us                | 12.163 ms                 |
| Forward                   | 6.340 ms                  | 8.934 ms                  |
| Backward                  | 1.061 s                   | 2.105 s                   |
| Optimize                  | 1.450 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.764 us                 | 42.451 ms                 |
| BlockToStepN              | 25.898 us                 | 78.961 us                 |
| OneStep                   | 1.081 s                   | 2.114 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 861.515 us                | 12.163 ms                 |
| Forward                   | 6.337 ms                  | 8.934 ms                  |
| Backward                  | 1.071 s                   | 2.111 s                   |
| Optimize                  | 1.458 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.856 us                 | 42.451 ms                 |
| BlockToStepN              | 25.933 us                 | 78.961 us                 |
| OneStep                   | 1.095 s                   | 2.120 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 861.515 us                | 12.163 ms                 |
| Forward                   | 6.337 ms                  | 8.934 ms                  |
| Backward                  | 1.086 s                   | 2.139 s                   |
| Optimize                  | 1.458 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.880 us                 | 42.451 ms                 |
| BlockToStepN              | 25.933 us                 | 78.961 us                 |
| OneStep                   | 1.102 s                   | 2.150 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 861.515 us                | 12.163 ms                 |
| Forward                   | 6.331 ms                  | 8.934 ms                  |
| Backward                  | 1.091 s                   | 2.140 s                   |
| Optimize                  | 1.469 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.880 us                 | 42.451 ms                 |
| BlockToStepN              | 25.936 us                 | 78.961 us                 |
| OneStep                   | 1.106 s                   | 2.151 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 861.515 us                | 12.163 ms                 |
| Forward                   | 6.337 ms                  | 8.934 ms                  |
| Backward                  | 1.093 s                   | 2.170 s                   |
| Optimize                  | 1.458 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.880 us                 | 42.451 ms                 |
| BlockToStepN              | 25.936 us                 | 80.622 us                 |
| OneStep                   | 1.108 s                   | 2.180 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.178 us                | 12.163 ms                 |
| Forward                   | 6.331 ms                  | 8.934 ms                  |
| Backward                  | 1.097 s                   | 2.178 s                   |
| Optimize                  | 1.458 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.918 us                 | 42.451 ms                 |
| BlockToStepN              | 25.936 us                 | 81.573 us                 |
| OneStep                   | 1.110 s                   | 2.187 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.620 us                | 12.163 ms                 |
| Forward                   | 6.330 ms                  | 8.934 ms                  |
| Backward                  | 1.098 s                   | 2.183 s                   |
| Optimize                  | 1.469 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 35.918 us                 | 42.451 ms                 |
| BlockToStepN              | 25.936 us                 | 81.573 us                 |
| OneStep                   | 1.121 s                   | 2.192 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.620 us                | 12.163 ms                 |
| Forward                   | 6.329 ms                  | 8.934 ms                  |
| Backward                  | 1.111 s                   | 2.194 s                   |
| Optimize                  | 1.469 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.031 us                 | 42.451 ms                 |
| BlockToStepN              | 26.056 us                 | 81.573 us                 |
| OneStep                   | 1.121 s                   | 2.203 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.178 us                | 12.163 ms                 |
| Forward                   | 6.329 ms                  | 8.934 ms                  |
| Backward                  | 1.113 s                   | 2.210 s                   |
| Optimize                  | 1.477 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.031 us                 | 42.451 ms                 |
| BlockToStepN              | 26.077 us                 | 82.406 us                 |
| OneStep                   | 1.130 s                   | 2.220 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.620 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.115 s                   | 2.217 s                   |
| Optimize                  | 1.479 ms                  | 2.282 ms                  |
| BarrierTimeBeforeRank0    | 36.083 us                 | 36.783 ms                 |
| BlockToStepN              | 26.132 us                 | 81.573 us                 |
| OneStep                   | 1.139 s                   | 2.227 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.620 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.131 s                   | 2.228 s                   |
| Optimize                  | 1.477 ms                  | 2.282 ms                  |
| BarrierTimeBeforeRank0    | 36.083 us                 | 36.783 ms                 |
| BlockToStepN              | 26.250 us                 | 81.573 us                 |
| OneStep                   | 1.151 s                   | 2.237 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.620 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.141 s                   | 2.230 s                   |
| Optimize                  | 1.479 ms                  | 2.282 ms                  |
| BarrierTimeBeforeRank0    | 36.179 us                 | 36.783 ms                 |
| BlockToStepN              | 26.298 us                 | 81.573 us                 |
| OneStep                   | 1.152 s                   | 2.249 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.620 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.143 s                   | 2.240 s                   |
| Optimize                  | 1.479 ms                  | 2.282 ms                  |
| BarrierTimeBeforeRank0    | 36.179 us                 | 36.783 ms                 |
| BlockToStepN              | 26.333 us                 | 81.573 us                 |
| OneStep                   | 1.155 s                   | 2.250 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.906 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.146 s                   | 2.257 s                   |
| Optimize                  | 1.479 ms                  | 2.282 ms                  |
| BarrierTimeBeforeRank0    | 36.179 us                 | 36.783 ms                 |
| BlockToStepN              | 26.349 us                 | 81.573 us                 |
| OneStep                   | 1.167 s                   | 2.265 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.158 s                   | 2.274 s                   |
| Optimize                  | 1.480 ms                  | 2.282 ms                  |
| BarrierTimeBeforeRank0    | 36.083 us                 | 36.783 ms                 |
| BlockToStepN              | 26.349 us                 | 81.573 us                 |
| OneStep                   | 1.170 s                   | 2.283 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.160 s                   | 2.283 s                   |
| Optimize                  | 1.479 ms                  | 2.282 ms                  |
| BarrierTimeBeforeRank0    | 36.179 us                 | 36.783 ms                 |
| BlockToStepN              | 26.349 us                 | 81.573 us                 |
| OneStep                   | 1.172 s                   | 2.293 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.164 s                   | 2.299 s                   |
| Optimize                  | 1.479 ms                  | 2.282 ms                  |
| BarrierTimeBeforeRank0    | 36.179 us                 | 36.783 ms                 |
| BlockToStepN              | 26.354 us                 | 81.573 us                 |
| OneStep                   | 1.179 s                   | 2.308 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.170 s                   | 2.299 s                   |
| Optimize                  | 1.479 ms                  | 2.282 ms                  |
| BarrierTimeBeforeRank0    | 36.183 us                 | 36.783 ms                 |
| BlockToStepN              | 26.429 us                 | 81.573 us                 |
| OneStep                   | 1.181 s                   | 2.318 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.171 s                   | 2.321 s                   |
| Optimize                  | 1.480 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.183 us                 | 36.783 ms                 |
| BlockToStepN              | 26.508 us                 | 81.573 us                 |
| OneStep                   | 1.189 s                   | 2.331 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.906 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.172 s                   | 2.322 s                   |
| Optimize                  | 1.481 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.190 us                 | 36.783 ms                 |
| BlockToStepN              | 26.593 us                 | 81.573 us                 |
| OneStep                   | 1.189 s                   | 2.331 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.906 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.187 s                   | 2.344 s                   |
| Optimize                  | 1.490 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.215 us                 | 36.783 ms                 |
| BlockToStepN              | 26.593 us                 | 81.573 us                 |
| OneStep                   | 1.197 s                   | 2.355 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.188 s                   | 2.346 s                   |
| Optimize                  | 1.490 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.215 us                 | 36.783 ms                 |
| BlockToStepN              | 26.733 us                 | 81.573 us                 |
| OneStep                   | 1.209 s                   | 2.357 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.329 ms                  | 8.308 ms                  |
| Backward                  | 1.188 s                   | 2.352 s                   |
| Optimize                  | 1.494 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.267 us                 | 36.783 ms                 |
| BlockToStepN              | 26.804 us                 | 81.573 us                 |
| OneStep                   | 1.211 s                   | 2.363 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.199 s                   | 2.369 s                   |
| Optimize                  | 1.502 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.336 us                 | 36.783 ms                 |
| BlockToStepN              | 26.828 us                 | 81.573 us                 |
| OneStep                   | 1.212 s                   | 2.387 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.328 ms                  | 8.308 ms                  |
| Backward                  | 1.203 s                   | 2.378 s                   |
| Optimize                  | 1.502 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.336 us                 | 36.783 ms                 |
| BlockToStepN              | 26.828 us                 | 81.573 us                 |
| OneStep                   | 1.230 s                   | 2.388 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.212 s                   | 2.378 s                   |
| Optimize                  | 1.502 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.456 us                 | 36.783 ms                 |
| BlockToStepN              | 26.828 us                 | 81.573 us                 |
| OneStep                   | 1.230 s                   | 2.389 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.221 s                   | 2.380 s                   |
| Optimize                  | 1.502 ms                  | 2.303 ms                  |
| BarrierTimeBeforeRank0    | 36.456 us                 | 36.783 ms                 |
| BlockToStepN              | 26.828 us                 | 81.573 us                 |
| OneStep                   | 1.231 s                   | 2.389 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 864.938 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.221 s                   | 2.396 s                   |
| Optimize                  | 1.502 ms                  | 2.304 ms                  |
| BarrierTimeBeforeRank0    | 36.456 us                 | 36.783 ms                 |
| BlockToStepN              | 26.828 us                 | 81.573 us                 |
| OneStep                   | 1.232 s                   | 2.406 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.906 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.224 s                   | 2.402 s                   |
| Optimize                  | 1.502 ms                  | 2.304 ms                  |
| BarrierTimeBeforeRank0    | 36.497 us                 | 36.783 ms                 |
| BlockToStepN              | 27.116 us                 | 81.573 us                 |
| OneStep                   | 1.233 s                   | 2.410 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.906 us                | 12.123 ms                 |
| Forward                   | 6.323 ms                  | 8.308 ms                  |
| Backward                  | 1.228 s                   | 2.407 s                   |
| Optimize                  | 1.520 ms                  | 2.304 ms                  |
| BarrierTimeBeforeRank0    | 36.520 us                 | 36.783 ms                 |
| BlockToStepN              | 27.174 us                 | 81.573 us                 |
| OneStep                   | 1.237 s                   | 2.418 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.906 us                | 12.123 ms                 |
| Forward                   | 6.323 ms                  | 8.308 ms                  |
| Backward                  | 1.237 s                   | 2.438 s                   |
| Optimize                  | 1.520 ms                  | 2.304 ms                  |
| BarrierTimeBeforeRank0    | 36.520 us                 | 36.783 ms                 |
| BlockToStepN              | 27.327 us                 | 81.573 us                 |
| OneStep                   | 1.246 s                   | 2.448 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.906 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.242 s                   | 2.438 s                   |
| Optimize                  | 1.520 ms                  | 2.304 ms                  |
| BarrierTimeBeforeRank0    | 36.520 us                 | 36.783 ms                 |
| BlockToStepN              | 27.364 us                 | 81.573 us                 |
| OneStep                   | 1.251 s                   | 2.448 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 866.906 us                | 12.123 ms                 |
| Forward                   | 6.326 ms                  | 8.308 ms                  |
| Backward                  | 1.246 s                   | 2.441 s                   |
| Optimize                  | 1.520 ms                  | 2.304 ms                  |
| BarrierTimeBeforeRank0    | 36.529 us                 | 36.783 ms                 |
| BlockToStepN              | 27.470 us                 | 81.573 us                 |
| OneStep                   | 1.255 s                   | 2.451 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 223.885, sample: 0.208, forward: 0.466, backward: 98.918, update: 0.155
[proc 1] 500 steps, total: 223.885, sample: 0.191, forward: 0.554, backward: 208.872, update: 0.151
[proc 0] 500 steps, total: 223.885, sample: 0.208, forward: 0.625, backward: 222.784, update: 0.160
[proc 3] 500 steps, total: 223.885, sample: 0.188, forward: 0.543, backward: 202.358, update: 0.182
Successfully xmh. training takes 629.9115102291107 seconds
before call kg_cache_controller.StopThreads()
INFO [548631 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
INFO [548631 controller_process.py:421] call rank0 to StopThreads
