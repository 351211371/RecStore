WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 16:24:16.260702 487470 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_FB15k_33', no_save_emb=True, max_step=500, batch_size=1800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [487470 sampler.py:454] Start PreSampling
WARNING [487470 sampler.py:532] Before construct renumbering_dict
WARNING [487470 sampler.py:555] PreSampling done
W20240128 16:24:18.585525 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 16:24:18.585665 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 16:24:18.585693 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 16:24:18.585714 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 16:24:18.585733 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 16:24:18.585757 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 16:24:18.585779 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 16:24:18.585801 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 16:24:18.585821 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 16:24:18.585839 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 16:24:18.585867 487470 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 16:24:18.585886 487470 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 16:24:18.585909 487470 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 16:24:18.585997 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 16:24:18.586020 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 16:24:18.586040 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 16:24:18.586078 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 16:24:18.586099 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 16:24:18.586122 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 16:24:18.586141 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 16:24:18.586159 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 16:24:18.586179 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 16:24:18.586197 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 16:24:18.586215 487470 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 16:24:18.586230 487470 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 16:24:18.586248 487470 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 16:24:18.586287 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 16:24:18.586309 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 16:24:18.586328 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 16:24:18.586345 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 16:24:18.586366 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 16:24:18.586386 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 16:24:18.586406 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 16:24:18.586432 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 16:24:18.586454 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 16:24:18.586472 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 16:24:18.586489 487470 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 16:24:18.586504 487470 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 16:24:18.586519 487470 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 16:24:18.586555 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 16:24:18.586583 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 16:24:18.586602 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 16:24:18.586624 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 16:24:18.586643 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 16:24:18.586663 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 16:24:18.586680 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 16:24:18.586697 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 16:24:18.586719 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 16:24:18.586745 487470 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 16:24:18.586762 487470 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 16:24:18.586777 487470 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 16:24:18.586796 487470 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 16:24:18.734576 487470 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 16:24:18.734715 487470 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 845, 1052, 1123,  ..., 1789, 5385, 7252]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.504 seconds
[Rank1] pid = 487795
[Rank2] pid = 487859
INFO [487470 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [487859 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [487470 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [487795 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [487860 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [487859 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [487860 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [487795 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [487470 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [487860 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [487795 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [487470 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [487470 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [487860 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [487860 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [487795 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [487795 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [487859 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [487859 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [487859 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 16:24:22.034559 487924 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 16:24:22.034672 487925 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 16:24:22.034791 487796 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 16:24:22.034890 487861 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240128 16:24:22.419646 487861 recstore.cc:66] init folly done
E20240128 16:24:22.419725 487924 recstore.cc:66] init folly done
E20240128 16:24:22.419833 487925 recstore.cc:66] init folly done
E20240128 16:24:22.419906 487796 recstore.cc:66] init folly done
I20240128 16:24:22.486629 487925 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 16:24:22.500669 487924 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 16:24:22.502657 487861 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 16:24:22.506538 487796 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 812.695 us                | 9.890 ms                  |
| Forward                   | 5.875 ms                  | 571.685 ms                |
| Backward                  | 76.076 ms                 | 1.154 s                   |
| Optimize                  | 1.648 ms                  | 54.455 ms                 |
| BarrierTimeBeforeRank0    | 1.522 ms                  | 517.109 ms                |
| BlockToStepN              | 9.030 us                  | 157.114 us                |
| OneStep                   | 84.660 ms                 | 1.345 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 789.203 us                | 9.993 ms                  |
| Forward                   | 5.714 ms                  | 6.813 ms                  |
| Backward                  | 120.416 ms                | 212.611 ms                |
| Optimize                  | 1.494 ms                  | 3.791 ms                  |
| BarrierTimeBeforeRank0    | 47.207 us                 | 104.138 ms                |
| BlockToStepN              | 9.780 us                  | 61.604 us                 |
| OneStep                   | 134.712 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 764.712 us                | 9.993 ms                  |
| Forward                   | 5.629 ms                  | 6.813 ms                  |
| Backward                  | 156.816 ms                | 286.667 ms                |
| Optimize                  | 1.457 ms                  | 3.791 ms                  |
| BarrierTimeBeforeRank0    | 34.866 us                 | 104.138 ms                |
| BlockToStepN              | 9.833 us                  | 61.604 us                 |
| OneStep                   | 173.882 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 766.950 us                | 9.993 ms                  |
| Forward                   | 5.608 ms                  | 6.813 ms                  |
| Backward                  | 178.429 ms                | 345.446 ms                |
| Optimize                  | 1.436 ms                  | 3.791 ms                  |
| BarrierTimeBeforeRank0    | 32.719 us                 | 104.138 ms                |
| BlockToStepN              | 10.127 us                 | 61.604 us                 |
| OneStep                   | 190.669 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 23.681, sample: 0.193, forward: 1.305, backward: 20.125, update: 0.191
[Rank3] pid = 487860
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 7566,  3441,  8662,  6521,  9800,  3903,   626,  4456, 12950, 12457]) tensor([ 1123,  8524,  8742,   716,  6834,  7169, 14670,  7451,  7882,  8499])
-------Step 1-------
tensor([ 7566,  3441,  8662,  6521,  9800,  3903,   626,  4456, 12950, 12457]) tensor([ 9602,  9940,   997,  3211,  1648, 12353,  6332,  2657,  1970, 13034])
-------Step 2-------
tensor([10151,  6668,  5631,  6653,  1369,  6004,  9097,  2934, 14723,    97]) tensor([ 6858,  5312,  3603,  9679,  6610,   662,  3671, 12431, 12758,  3703])
-------Step 3-------
tensor([10151,  6668,  5631,  6653,  1369,  6004,  9097,  2934, 14723,    97]) tensor([ 8132,   276,  4463,   147, 12901, 11306, 14045,  9662, 12968,  6982])
-------Step 4-------
tensor([11740,  4661,   543,   115, 11381, 14158, 13201, 10083,  8318,  7094]) tensor([ 2541, 10751,  8393, 11574, 10256, 10987,  1211,  1978, 14512, 14219])
-------Step 5-------
tensor([11740,  4661,   543,   115, 11381, 14158, 13201, 10083,  8318,  7094]) tensor([11945,  7381, 12197,   572,  1414,  9173,  5869, 11802, 11626, 12956])
-------Step 6-------
tensor([   73,     4,  2661,  9329, 13190,    18,  7896,   139,  2493,   172]) tensor([ 6178, 12089,  7628, 11779,  6500,  1492,  9658, 12846, 10650, 11342])
-------Step 7-------
tensor([   73,     4,  2661,  9329, 13190,    18,  7896,   139,  2493,   172]) tensor([10071, 12545,  9323, 12479,  8399, 11976, 10937, 14039, 13488,  9686])
-------Step 8-------
tensor([ 6191,  7279, 13408,  9755,  3115, 11590,  7222,  8916,  5325,  6668]) tensor([ 9148, 14050, 12062,   424, 13695,  8729,  5517,  1657,  7524, 10595])
-------Step 9-------
tensor([ 6191,  7279, 13408,  9755,  3115, 11590,  7222,  8916,  5325,  6668]) tensor([ 9670, 13874,  6366,  7228,  4696,  5915, 13506,  7325,  5904, 12007])
before start barrier
start train
[proc 0] 100 steps, total: 23.665, sample: 0.184, forward: 1.121, backward: 21.288, update: 0.204
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 23.667, sample: 0.197, forward: 1.503, backward: 14.542, update: 0.197
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 23.661, sample: 0.200, forward: 1.437, backward: 14.984, update: 0.186
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 768.718 us                | 9.993 ms                  |
| Forward                   | 5.607 ms                  | 6.813 ms                  |
| Backward                  | 205.848 ms                | 403.734 ms                |
| Optimize                  | 1.433 ms                  | 3.791 ms                  |
| BarrierTimeBeforeRank0    | 30.879 us                 | 104.138 ms                |
| BlockToStepN              | 10.127 us                 | 61.604 us                 |
| OneStep                   | 217.932 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 766.950 us                | 10.038 ms                 |
| Forward                   | 5.586 ms                  | 6.813 ms                  |
| Backward                  | 228.198 ms                | 433.432 ms                |
| Optimize                  | 1.434 ms                  | 3.791 ms                  |
| BarrierTimeBeforeRank0    | 30.577 us                 | 104.138 ms                |
| BlockToStepN              | 10.129 us                 | 61.604 us                 |
| OneStep                   | 240.937 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 768.718 us                | 10.150 ms                 |
| Forward                   | 5.601 ms                  | 6.900 ms                  |
| Backward                  | 245.459 ms                | 486.451 ms                |
| Optimize                  | 1.434 ms                  | 3.791 ms                  |
| BarrierTimeBeforeRank0    | 30.577 us                 | 104.138 ms                |
| BlockToStepN              | 10.163 us                 | 61.604 us                 |
| OneStep                   | 256.630 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 769.480 us                | 10.150 ms                 |
| Forward                   | 5.607 ms                  | 6.900 ms                  |
| Backward                  | 266.124 ms                | 517.912 ms                |
| Optimize                  | 1.440 ms                  | 3.791 ms                  |
| BarrierTimeBeforeRank0    | 30.380 us                 | 104.138 ms                |
| BlockToStepN              | 10.369 us                 | 72.991 us                 |
| OneStep                   | 279.263 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 769.480 us                | 10.150 ms                 |
| Forward                   | 5.588 ms                  | 6.934 ms                  |
| Backward                  | 285.095 ms                | 546.991 ms                |
| Optimize                  | 1.441 ms                  | 3.791 ms                  |
| BarrierTimeBeforeRank0    | 30.380 us                 | 104.138 ms                |
| BlockToStepN              | 10.505 us                 | 72.991 us                 |
| OneStep                   | 295.699 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.445 us                | 10.038 ms                 |
| Forward                   | 5.586 ms                  | 6.900 ms                  |
| Backward                  | 302.950 ms                | 573.182 ms                |
| Optimize                  | 1.448 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.380 us                 | 20.963 ms                 |
| BlockToStepN              | 10.588 us                 | 61.604 us                 |
| OneStep                   | 313.193 ms                | 604.163 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 777.508 us                | 10.038 ms                 |
| Forward                   | 5.586 ms                  | 6.900 ms                  |
| Backward                  | 310.044 ms                | 606.103 ms                |
| Optimize                  | 1.448 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.362 us                 | 20.963 ms                 |
| BlockToStepN              | 10.715 us                 | 61.604 us                 |
| OneStep                   | 321.477 ms                | 628.940 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 781.487 us                | 10.038 ms                 |
| Forward                   | 5.585 ms                  | 6.900 ms                  |
| Backward                  | 329.160 ms                | 630.881 ms                |
| Optimize                  | 1.452 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.490 us                 | 20.963 ms                 |
| BlockToStepN              | 10.785 us                 | 61.604 us                 |
| OneStep                   | 341.282 ms                | 662.103 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 787.676 us                | 10.038 ms                 |
| Forward                   | 5.601 ms                  | 6.900 ms                  |
| Backward                  | 345.446 ms                | 662.621 ms                |
| Optimize                  | 1.459 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.574 us                 | 20.963 ms                 |
| BlockToStepN              | 10.976 us                 | 61.604 us                 |
| OneStep                   | 355.952 ms                | 685.131 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 788.197 us                | 10.038 ms                 |
| Forward                   | 5.585 ms                  | 6.900 ms                  |
| Backward                  | 356.294 ms                | 688.807 ms                |
| Optimize                  | 1.459 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.574 us                 | 20.963 ms                 |
| BlockToStepN              | 11.095 us                 | 61.604 us                 |
| OneStep                   | 366.629 ms                | 710.640 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 791.098 us                | 10.038 ms                 |
| Forward                   | 5.586 ms                  | 6.900 ms                  |
| Backward                  | 362.574 ms                | 717.421 ms                |
| Optimize                  | 1.459 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.577 us                 | 20.963 ms                 |
| BlockToStepN              | 11.279 us                 | 61.604 us                 |
| OneStep                   | 380.908 ms                | 736.411 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 794.642 us                | 10.423 ms                 |
| Forward                   | 5.585 ms                  | 6.900 ms                  |
| Backward                  | 380.299 ms                | 741.427 ms                |
| Optimize                  | 1.461 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.662 us                 | 70.548 ms                 |
| BlockToStepN              | 11.329 us                 | 61.604 us                 |
| OneStep                   | 407.531 ms                | 774.289 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 58.068, sample: 0.204, forward: 0.557, backward: 56.970, update: 0.150
[proc 1] 200 steps, total: 58.068, sample: 0.203, forward: 0.474, backward: 36.584, update: 0.137
[proc 3] 200 steps, total: 58.068, sample: 0.184, forward: 0.473, backward: 52.992, update: 0.158
[proc 2] 200 steps, total: 58.068, sample: 0.203, forward: 0.456, backward: 35.826, update: 0.155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 795.246 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.900 ms                  |
| Backward                  | 400.034 ms                | 754.083 ms                |
| Optimize                  | 1.463 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.879 us                 | 70.548 ms                 |
| BlockToStepN              | 11.481 us                 | 61.604 us                 |
| OneStep                   | 410.723 ms                | 787.029 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 795.559 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.900 ms                  |
| Backward                  | 404.239 ms                | 779.351 ms                |
| Optimize                  | 1.466 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.945 us                 | 70.548 ms                 |
| BlockToStepN              | 11.580 us                 | 61.604 us                 |
| OneStep                   | 414.648 ms                | 801.910 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 795.559 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.900 ms                  |
| Backward                  | 417.356 ms                | 806.231 ms                |
| Optimize                  | 1.463 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 30.945 us                 | 70.548 ms                 |
| BlockToStepN              | 11.893 us                 | 61.604 us                 |
| OneStep                   | 431.037 ms                | 823.220 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 795.559 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.900 ms                  |
| Backward                  | 425.434 ms                | 826.218 ms                |
| Optimize                  | 1.463 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 31.277 us                 | 70.548 ms                 |
| BlockToStepN              | 11.897 us                 | 61.604 us                 |
| OneStep                   | 438.268 ms                | 847.244 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.177 us                | 10.423 ms                 |
| Forward                   | 5.585 ms                  | 6.900 ms                  |
| Backward                  | 433.432 ms                | 856.496 ms                |
| Optimize                  | 1.466 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 31.347 us                 | 70.548 ms                 |
| BlockToStepN              | 12.146 us                 | 61.604 us                 |
| OneStep                   | 449.746 ms                | 872.997 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.349 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.900 ms                  |
| Backward                  | 448.422 ms                | 873.777 ms                |
| Optimize                  | 1.480 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 31.909 us                 | 70.548 ms                 |
| BlockToStepN              | 12.166 us                 | 61.604 us                 |
| OneStep                   | 465.033 ms                | 885.511 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.349 us                | 10.423 ms                 |
| Forward                   | 5.586 ms                  | 6.900 ms                  |
| Backward                  | 459.049 ms                | 888.902 ms                |
| Optimize                  | 1.490 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 31.979 us                 | 70.548 ms                 |
| BlockToStepN              | 12.381 us                 | 61.604 us                 |
| OneStep                   | 478.441 ms                | 907.545 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.859 us                | 10.423 ms                 |
| Forward                   | 5.586 ms                  | 6.900 ms                  |
| Backward                  | 469.915 ms                | 908.868 ms                |
| Optimize                  | 1.490 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 31.979 us                 | 70.548 ms                 |
| BlockToStepN              | 12.279 us                 | 61.604 us                 |
| OneStep                   | 483.069 ms                | 936.123 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.859 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.900 ms                  |
| Backward                  | 478.877 ms                | 944.683 ms                |
| Optimize                  | 1.490 ms                  | 3.412 ms                  |
| BarrierTimeBeforeRank0    | 31.979 us                 | 70.548 ms                 |
| BlockToStepN              | 12.606 us                 | 61.604 us                 |
| OneStep                   | 493.245 ms                | 964.893 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.859 us                | 10.234 ms                 |
| Forward                   | 5.568 ms                  | 6.813 ms                  |
| Backward                  | 487.210 ms                | 957.487 ms                |
| Optimize                  | 1.480 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.117 us                 | 30.047 ms                 |
| BlockToStepN              | 12.830 us                 | 61.604 us                 |
| OneStep                   | 496.517 ms                | 967.415 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.040 us                | 10.234 ms                 |
| Forward                   | 5.550 ms                  | 6.813 ms                  |
| Backward                  | 493.349 ms                | 970.796 ms                |
| Optimize                  | 1.480 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.117 us                 | 30.047 ms                 |
| BlockToStepN              | 12.860 us                 | 61.604 us                 |
| OneStep                   | 506.633 ms                | 979.680 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.859 us                | 10.234 ms                 |
| Forward                   | 5.568 ms                  | 6.813 ms                  |
| Backward                  | 508.432 ms                | 991.707 ms                |
| Optimize                  | 1.490 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.163 us                 | 30.047 ms                 |
| BlockToStepN              | 12.872 us                 | 61.604 us                 |
| OneStep                   | 523.890 ms                | 1.007 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.859 us                | 10.234 ms                 |
| Forward                   | 5.585 ms                  | 6.813 ms                  |
| Backward                  | 515.731 ms                | 1.002 s                   |
| Optimize                  | 1.490 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.163 us                 | 30.047 ms                 |
| BlockToStepN              | 13.150 us                 | 66.359 us                 |
| OneStep                   | 526.240 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.234 ms                 |
| Forward                   | 5.585 ms                  | 6.813 ms                  |
| Backward                  | 532.718 ms                | 1.018 s                   |
| Optimize                  | 1.491 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.259 us                 | 30.047 ms                 |
| BlockToStepN              | 13.212 us                 | 66.359 us                 |
| OneStep                   | 548.368 ms                | 1.043 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.234 ms                 |
| Forward                   | 5.586 ms                  | 6.813 ms                  |
| Backward                  | 540.353 ms                | 1.043 s                   |
| Optimize                  | 1.494 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.260 us                 | 30.047 ms                 |
| BlockToStepN              | 13.336 us                 | 66.359 us                 |
| OneStep                   | 552.371 ms                | 1.056 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.426 us                | 10.234 ms                 |
| Forward                   | 5.588 ms                  | 6.813 ms                  |
| Backward                  | 545.283 ms                | 1.061 s                   |
| Optimize                  | 1.491 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.266 us                 | 30.047 ms                 |
| BlockToStepN              | 13.524 us                 | 66.359 us                 |
| OneStep                   | 555.074 ms                | 1.076 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.426 us                | 10.302 ms                 |
| Forward                   | 5.586 ms                  | 6.813 ms                  |
| Backward                  | 552.589 ms                | 1.079 s                   |
| Optimize                  | 1.494 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.266 us                 | 30.047 ms                 |
| BlockToStepN              | 13.632 us                 | 66.359 us                 |
| OneStep                   | 561.569 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.302 ms                 |
| Forward                   | 5.584 ms                  | 6.813 ms                  |
| Backward                  | 562.617 ms                | 1.105 s                   |
| Optimize                  | 1.499 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.266 us                 | 30.047 ms                 |
| BlockToStepN              | 13.806 us                 | 66.359 us                 |
| OneStep                   | 571.257 ms                | 1.117 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.302 ms                 |
| Forward                   | 5.576 ms                  | 6.813 ms                  |
| Backward                  | 567.189 ms                | 1.117 s                   |
| Optimize                  | 1.494 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.260 us                 | 30.047 ms                 |
| BlockToStepN              | 14.052 us                 | 66.359 us                 |
| OneStep                   | 584.777 ms                | 1.126 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 300 steps, total: 95.110, sample: 0.197, forward: 0.466, backward: 87.021, update: 0.156
[proc 0] 300 steps, total: 95.110, sample: 0.191, forward: 0.550, backward: 94.040, update: 0.153
[proc 2] 300 steps, total: 95.110, sample: 0.185, forward: 0.466, backward: 58.245, update: 0.156
[proc 1] 300 steps, total: 95.110, sample: 0.186, forward: 0.466, backward: 59.556, update: 0.143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.426 us                | 10.302 ms                 |
| Forward                   | 5.584 ms                  | 6.813 ms                  |
| Backward                  | 576.458 ms                | 1.130 s                   |
| Optimize                  | 1.494 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.266 us                 | 30.047 ms                 |
| BlockToStepN              | 14.468 us                 | 66.359 us                 |
| OneStep                   | 593.633 ms                | 1.138 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.426 us                | 10.423 ms                 |
| Forward                   | 5.576 ms                  | 6.813 ms                  |
| Backward                  | 587.741 ms                | 1.149 s                   |
| Optimize                  | 1.491 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.260 us                 | 30.047 ms                 |
| BlockToStepN              | 14.525 us                 | 72.009 us                 |
| OneStep                   | 603.932 ms                | 1.159 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.426 us                | 10.423 ms                 |
| Forward                   | 5.576 ms                  | 6.813 ms                  |
| Backward                  | 590.886 ms                | 1.156 s                   |
| Optimize                  | 1.494 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.260 us                 | 30.047 ms                 |
| BlockToStepN              | 14.525 us                 | 72.009 us                 |
| OneStep                   | 606.705 ms                | 1.179 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.813 ms                  |
| Backward                  | 601.559 ms                | 1.181 s                   |
| Optimize                  | 1.499 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.504 us                 | 30.047 ms                 |
| BlockToStepN              | 14.553 us                 | 72.009 us                 |
| OneStep                   | 615.529 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.813 ms                  |
| Backward                  | 608.926 ms                | 1.192 s                   |
| Optimize                  | 1.499 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.504 us                 | 30.047 ms                 |
| BlockToStepN              | 14.688 us                 | 72.991 us                 |
| OneStep                   | 619.106 ms                | 1.209 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.426 us                | 10.423 ms                 |
| Forward                   | 5.548 ms                  | 6.813 ms                  |
| Backward                  | 613.054 ms                | 1.210 s                   |
| Optimize                  | 1.494 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.266 us                 | 30.047 ms                 |
| BlockToStepN              | 14.735 us                 | 72.991 us                 |
| OneStep                   | 628.940 ms                | 1.227 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.423 ms                 |
| Forward                   | 5.547 ms                  | 6.813 ms                  |
| Backward                  | 620.654 ms                | 1.234 s                   |
| Optimize                  | 1.491 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.266 us                 | 30.047 ms                 |
| BlockToStepN              | 14.853 us                 | 72.991 us                 |
| OneStep                   | 638.379 ms                | 1.263 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.426 us                | 10.423 ms                 |
| Forward                   | 5.547 ms                  | 6.813 ms                  |
| Backward                  | 630.277 ms                | 1.239 s                   |
| Optimize                  | 1.491 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.504 us                 | 30.047 ms                 |
| BlockToStepN              | 14.853 us                 | 72.991 us                 |
| OneStep                   | 639.968 ms                | 1.266 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.423 ms                 |
| Forward                   | 5.546 ms                  | 6.813 ms                  |
| Backward                  | 631.613 ms                | 1.258 s                   |
| Optimize                  | 1.491 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.504 us                 | 30.047 ms                 |
| BlockToStepN              | 14.889 us                 | 72.991 us                 |
| OneStep                   | 654.315 ms                | 1.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.423 ms                 |
| Forward                   | 5.535 ms                  | 6.813 ms                  |
| Backward                  | 649.371 ms                | 1.273 s                   |
| Optimize                  | 1.494 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.504 us                 | 30.047 ms                 |
| BlockToStepN              | 14.889 us                 | 72.991 us                 |
| OneStep                   | 662.103 ms                | 1.293 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.423 ms                 |
| Forward                   | 5.535 ms                  | 6.813 ms                  |
| Backward                  | 655.836 ms                | 1.285 s                   |
| Optimize                  | 1.499 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.521 us                 | 30.047 ms                 |
| BlockToStepN              | 15.029 us                 | 72.991 us                 |
| OneStep                   | 666.414 ms                | 1.302 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.426 us                | 10.423 ms                 |
| Forward                   | 5.535 ms                  | 6.813 ms                  |
| Backward                  | 657.632 ms                | 1.293 s                   |
| Optimize                  | 1.499 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.504 us                 | 30.047 ms                 |
| BlockToStepN              | 15.109 us                 | 72.991 us                 |
| OneStep                   | 671.190 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.392 ms                 |
| Forward                   | 5.535 ms                  | 6.794 ms                  |
| Backward                  | 667.778 ms                | 1.308 s                   |
| Optimize                  | 1.499 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.504 us                 | 30.047 ms                 |
| BlockToStepN              | 15.109 us                 | 72.991 us                 |
| OneStep                   | 679.195 ms                | 1.327 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.393 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 674.119 ms                | 1.320 s                   |
| Optimize                  | 1.499 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.266 us                 | 20.963 ms                 |
| BlockToStepN              | 15.221 us                 | 72.009 us                 |
| OneStep                   | 684.723 ms                | 1.345 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.193 us                | 10.393 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 676.264 ms                | 1.347 s                   |
| Optimize                  | 1.499 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.266 us                 | 20.963 ms                 |
| BlockToStepN              | 15.295 us                 | 72.009 us                 |
| OneStep                   | 688.768 ms                | 1.355 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.204 us                | 10.393 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 688.807 ms                | 1.351 s                   |
| Optimize                  | 1.519 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.266 us                 | 20.963 ms                 |
| BlockToStepN              | 15.443 us                 | 72.904 us                 |
| OneStep                   | 700.703 ms                | 1.362 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.040 us                | 10.393 ms                 |
| Forward                   | 5.535 ms                  | 6.794 ms                  |
| Backward                  | 693.769 ms                | 1.370 s                   |
| Optimize                  | 1.512 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.260 us                 | 20.963 ms                 |
| BlockToStepN              | 15.501 us                 | 72.904 us                 |
| OneStep                   | 710.288 ms                | 1.379 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.204 us                | 10.393 ms                 |
| Forward                   | 5.535 ms                  | 6.794 ms                  |
| Backward                  | 696.534 ms                | 1.376 s                   |
| Optimize                  | 1.499 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.260 us                 | 20.963 ms                 |
| BlockToStepN              | 15.508 us                 | 72.904 us                 |
| OneStep                   | 710.640 ms                | 1.386 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.204 us                | 10.393 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 699.165 ms                | 1.388 s                   |
| Optimize                  | 1.499 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.259 us                 | 20.963 ms                 |
| BlockToStepN              | 15.554 us                 | 72.904 us                 |
| OneStep                   | 721.395 ms                | 1.397 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.040 us                | 10.393 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 709.288 ms                | 1.403 s                   |
| Optimize                  | 1.512 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.260 us                 | 20.963 ms                 |
| BlockToStepN              | 15.642 us                 | 72.991 us                 |
| OneStep                   | 726.924 ms                | 1.412 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.040 us                | 10.393 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 716.525 ms                | 1.418 s                   |
| Optimize                  | 1.519 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.260 us                 | 20.963 ms                 |
| BlockToStepN              | 15.718 us                 | 72.991 us                 |
| OneStep                   | 736.411 ms                | 1.426 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.040 us                | 10.393 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 717.421 ms                | 1.433 s                   |
| Optimize                  | 1.519 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.259 us                 | 20.963 ms                 |
| BlockToStepN              | 15.805 us                 | 72.991 us                 |
| OneStep                   | 736.597 ms                | 1.441 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.040 us                | 10.393 ms                 |
| Forward                   | 5.533 ms                  | 6.794 ms                  |
| Backward                  | 720.195 ms                | 1.455 s                   |
| Optimize                  | 1.519 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.217 us                 | 20.963 ms                 |
| BlockToStepN              | 15.956 us                 | 72.991 us                 |
| OneStep                   | 751.119 ms                | 1.463 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.859 us                | 10.393 ms                 |
| Forward                   | 5.533 ms                  | 6.794 ms                  |
| Backward                  | 741.427 ms                | 1.462 s                   |
| Optimize                  | 1.519 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.217 us                 | 20.963 ms                 |
| BlockToStepN              | 16.001 us                 | 72.991 us                 |
| OneStep                   | 759.018 ms                | 1.470 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.376 us                | 10.393 ms                 |
| Forward                   | 5.525 ms                  | 6.794 ms                  |
| Backward                  | 745.908 ms                | 1.470 s                   |
| Optimize                  | 1.512 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.163 us                 | 20.963 ms                 |
| BlockToStepN              | 16.377 us                 | 72.991 us                 |
| OneStep                   | 761.591 ms                | 1.479 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.859 us                | 10.846 ms                 |
| Forward                   | 5.533 ms                  | 6.794 ms                  |
| Backward                  | 751.166 ms                | 1.481 s                   |
| Optimize                  | 1.499 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 32.124 us                 | 20.963 ms                 |
| BlockToStepN              | 16.406 us                 | 72.991 us                 |
| OneStep                   | 761.653 ms                | 1.494 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.376 us                | 10.846 ms                 |
| Forward                   | 5.533 ms                  | 6.794 ms                  |
| Backward                  | 753.564 ms                | 1.491 s                   |
| Optimize                  | 1.512 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.124 us                 | 20.963 ms                 |
| BlockToStepN              | 16.449 us                 | 72.991 us                 |
| OneStep                   | 772.453 ms                | 1.501 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 133.190, sample: 0.190, forward: 0.459, backward: 81.146, update: 0.153
[proc 1] 400 steps, total: 133.190, sample: 0.190, forward: 0.472, backward: 83.571, update: 0.147
[proc 3] 400 steps, total: 133.190, sample: 0.183, forward: 0.466, backward: 118.991, update: 0.153
[proc 0] 400 steps, total: 133.190, sample: 0.208, forward: 0.540, backward: 132.197, update: 0.155
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.376 us                | 10.846 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 754.083 ms                | 1.496 s                   |
| Optimize                  | 1.512 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.124 us                 | 20.963 ms                 |
| BlockToStepN              | 16.476 us                 | 72.991 us                 |
| OneStep                   | 774.289 ms                | 1.513 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.376 us                | 10.846 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 765.079 ms                | 1.522 s                   |
| Optimize                  | 1.519 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.124 us                 | 20.963 ms                 |
| BlockToStepN              | 16.487 us                 | 72.991 us                 |
| OneStep                   | 783.403 ms                | 1.530 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.349 us                | 10.846 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 774.762 ms                | 1.531 s                   |
| Optimize                  | 1.521 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.124 us                 | 20.963 ms                 |
| BlockToStepN              | 16.714 us                 | 72.991 us                 |
| OneStep                   | 787.434 ms                | 1.539 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.859 us                | 10.846 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 778.593 ms                | 1.548 s                   |
| Optimize                  | 1.521 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.124 us                 | 20.963 ms                 |
| BlockToStepN              | 16.760 us                 | 72.991 us                 |
| OneStep                   | 787.749 ms                | 1.565 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.376 us                | 10.846 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 783.914 ms                | 1.561 s                   |
| Optimize                  | 1.524 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.124 us                 | 20.963 ms                 |
| BlockToStepN              | 16.900 us                 | 72.991 us                 |
| OneStep                   | 801.910 ms                | 1.570 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.376 us                | 10.846 ms                 |
| Forward                   | 5.535 ms                  | 6.794 ms                  |
| Backward                  | 786.912 ms                | 1.568 s                   |
| Optimize                  | 1.524 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.117 us                 | 20.963 ms                 |
| BlockToStepN              | 16.900 us                 | 72.991 us                 |
| OneStep                   | 807.935 ms                | 1.576 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.349 us                | 10.846 ms                 |
| Forward                   | 5.546 ms                  | 6.794 ms                  |
| Backward                  | 795.215 ms                | 1.582 s                   |
| Optimize                  | 1.525 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.117 us                 | 20.963 ms                 |
| BlockToStepN              | 17.126 us                 | 72.991 us                 |
| OneStep                   | 811.058 ms                | 1.590 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.177 us                | 10.846 ms                 |
| Forward                   | 5.535 ms                  | 6.794 ms                  |
| Backward                  | 801.053 ms                | 1.593 s                   |
| Optimize                  | 1.525 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.124 us                 | 20.963 ms                 |
| BlockToStepN              | 17.216 us                 | 72.991 us                 |
| OneStep                   | 813.653 ms                | 1.603 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.349 us                | 10.846 ms                 |
| Forward                   | 5.535 ms                  | 6.794 ms                  |
| Backward                  | 806.231 ms                | 1.617 s                   |
| Optimize                  | 1.525 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.117 us                 | 20.963 ms                 |
| BlockToStepN              | 17.230 us                 | 72.991 us                 |
| OneStep                   | 817.694 ms                | 1.627 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.177 us                | 10.846 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 809.841 ms                | 1.626 s                   |
| Optimize                  | 1.525 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.117 us                 | 20.963 ms                 |
| BlockToStepN              | 17.242 us                 | 72.991 us                 |
| OneStep                   | 825.159 ms                | 1.635 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 801.177 us                | 10.846 ms                 |
| Forward                   | 5.535 ms                  | 6.794 ms                  |
| Backward                  | 812.601 ms                | 1.637 s                   |
| Optimize                  | 1.525 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.076 us                 | 20.963 ms                 |
| BlockToStepN              | 17.248 us                 | 72.991 us                 |
| OneStep                   | 833.224 ms                | 1.646 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.251 us                | 10.846 ms                 |
| Forward                   | 5.534 ms                  | 6.794 ms                  |
| Backward                  | 824.843 ms                | 1.660 s                   |
| Optimize                  | 1.525 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 32.076 us                 | 20.963 ms                 |
| BlockToStepN              | 17.337 us                 | 72.991 us                 |
| OneStep                   | 834.620 ms                | 1.668 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.251 us                | 10.846 ms                 |
| Forward                   | 5.535 ms                  | 6.794 ms                  |
| Backward                  | 826.000 ms                | 1.686 s                   |
| Optimize                  | 1.525 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 31.979 us                 | 20.963 ms                 |
| BlockToStepN              | 17.346 us                 | 72.991 us                 |
| OneStep                   | 837.372 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.251 us                | 10.846 ms                 |
| Forward                   | 5.535 ms                  | 6.794 ms                  |
| Backward                  | 827.053 ms                | 1.689 s                   |
| Optimize                  | 1.534 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 31.979 us                 | 20.963 ms                 |
| BlockToStepN              | 17.367 us                 | 72.991 us                 |
| OneStep                   | 847.244 ms                | 1.704 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.251 us                | 10.846 ms                 |
| Forward                   | 5.547 ms                  | 6.794 ms                  |
| Backward                  | 838.652 ms                | 1.708 s                   |
| Optimize                  | 1.566 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 31.909 us                 | 20.963 ms                 |
| BlockToStepN              | 17.409 us                 | 72.991 us                 |
| OneStep                   | 858.412 ms                | 1.716 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.088 us                | 10.846 ms                 |
| Forward                   | 5.547 ms                  | 6.794 ms                  |
| Backward                  | 851.591 ms                | 1.715 s                   |
| Optimize                  | 1.567 ms                  | 2.659 ms                  |
| BarrierTimeBeforeRank0    | 31.909 us                 | 20.963 ms                 |
| BlockToStepN              | 17.451 us                 | 72.991 us                 |
| OneStep                   | 861.570 ms                | 1.723 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.088 us                | 10.423 ms                 |
| Forward                   | 5.547 ms                  | 6.771 ms                  |
| Backward                  | 852.963 ms                | 1.712 s                   |
| Optimize                  | 1.590 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.909 us                 | 18.810 ms                 |
| BlockToStepN              | 17.552 us                 | 72.904 us                 |
| OneStep                   | 867.727 ms                | 1.721 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.088 us                | 10.423 ms                 |
| Forward                   | 5.548 ms                  | 6.771 ms                  |
| Backward                  | 856.496 ms                | 1.716 s                   |
| Optimize                  | 1.567 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.909 us                 | 18.810 ms                 |
| BlockToStepN              | 17.591 us                 | 72.904 us                 |
| OneStep                   | 872.997 ms                | 1.726 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.273 us                | 10.423 ms                 |
| Forward                   | 5.548 ms                  | 6.771 ms                  |
| Backward                  | 867.051 ms                | 1.732 s                   |
| Optimize                  | 1.590 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.909 us                 | 18.810 ms                 |
| BlockToStepN              | 17.664 us                 | 72.904 us                 |
| OneStep                   | 879.863 ms                | 1.749 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.251 us                | 10.423 ms                 |
| Forward                   | 5.548 ms                  | 6.771 ms                  |
| Backward                  | 867.401 ms                | 1.747 s                   |
| Optimize                  | 1.583 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.858 us                 | 18.810 ms                 |
| BlockToStepN              | 17.686 us                 | 72.904 us                 |
| OneStep                   | 881.949 ms                | 1.758 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.251 us                | 10.423 ms                 |
| Forward                   | 5.547 ms                  | 6.771 ms                  |
| Backward                  | 873.777 ms                | 1.750 s                   |
| Optimize                  | 1.590 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.858 us                 | 18.810 ms                 |
| BlockToStepN              | 17.803 us                 | 72.904 us                 |
| OneStep                   | 885.511 ms                | 1.761 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.251 us                | 10.423 ms                 |
| Forward                   | 5.548 ms                  | 6.771 ms                  |
| Backward                  | 875.760 ms                | 1.774 s                   |
| Optimize                  | 1.585 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.814 us                 | 18.810 ms                 |
| BlockToStepN              | 17.888 us                 | 72.904 us                 |
| OneStep                   | 893.039 ms                | 1.784 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.088 us                | 10.423 ms                 |
| Forward                   | 5.548 ms                  | 6.771 ms                  |
| Backward                  | 877.878 ms                | 1.790 s                   |
| Optimize                  | 1.585 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.710 us                 | 18.810 ms                 |
| BlockToStepN              | 17.911 us                 | 72.991 us                 |
| OneStep                   | 897.130 ms                | 1.799 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.273 us                | 10.423 ms                 |
| Forward                   | 5.547 ms                  | 6.771 ms                  |
| Backward                  | 888.546 ms                | 1.795 s                   |
| Optimize                  | 1.585 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.710 us                 | 18.810 ms                 |
| BlockToStepN              | 18.031 us                 | 72.991 us                 |
| OneStep                   | 897.488 ms                | 1.803 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.088 us                | 10.423 ms                 |
| Forward                   | 5.548 ms                  | 6.771 ms                  |
| Backward                  | 888.690 ms                | 1.803 s                   |
| Optimize                  | 1.583 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.615 us                 | 18.810 ms                 |
| BlockToStepN              | 18.070 us                 | 72.991 us                 |
| OneStep                   | 900.072 ms                | 1.812 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.273 us                | 10.423 ms                 |
| Forward                   | 5.550 ms                  | 6.771 ms                  |
| Backward                  | 891.708 ms                | 1.824 s                   |
| Optimize                  | 1.585 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.615 us                 | 18.810 ms                 |
| BlockToStepN              | 18.155 us                 | 72.991 us                 |
| OneStep                   | 914.874 ms                | 1.833 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.273 us                | 10.423 ms                 |
| Forward                   | 5.550 ms                  | 6.771 ms                  |
| Backward                  | 898.636 ms                | 1.830 s                   |
| Optimize                  | 1.585 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.615 us                 | 18.810 ms                 |
| BlockToStepN              | 18.176 us                 | 72.991 us                 |
| OneStep                   | 917.212 ms                | 1.838 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.088 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.771 ms                  |
| Backward                  | 901.635 ms                | 1.846 s                   |
| Optimize                  | 1.583 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.495 us                 | 18.810 ms                 |
| BlockToStepN              | 18.201 us                 | 74.073 us                 |
| OneStep                   | 924.955 ms                | 1.855 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.273 us                | 10.423 ms                 |
| Forward                   | 5.550 ms                  | 6.771 ms                  |
| Backward                  | 915.700 ms                | 1.863 s                   |
| Optimize                  | 1.583 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.615 us                 | 18.810 ms                 |
| BlockToStepN              | 18.279 us                 | 74.073 us                 |
| OneStep                   | 931.719 ms                | 1.873 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.273 us                | 10.423 ms                 |
| Forward                   | 5.548 ms                  | 6.771 ms                  |
| Backward                  | 919.648 ms                | 1.865 s                   |
| Optimize                  | 1.585 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.615 us                 | 18.810 ms                 |
| BlockToStepN              | 18.279 us                 | 74.073 us                 |
| OneStep                   | 936.123 ms                | 1.873 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.273 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.771 ms                  |
| Backward                  | 923.389 ms                | 1.876 s                   |
| Optimize                  | 1.590 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.495 us                 | 18.810 ms                 |
| BlockToStepN              | 18.311 us                 | 74.073 us                 |
| OneStep                   | 937.928 ms                | 1.884 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.273 us                | 10.423 ms                 |
| Forward                   | 5.550 ms                  | 6.771 ms                  |
| Backward                  | 931.603 ms                | 1.877 s                   |
| Optimize                  | 1.590 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.495 us                 | 18.810 ms                 |
| BlockToStepN              | 18.498 us                 | 74.073 us                 |
| OneStep                   | 953.207 ms                | 1.886 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 796.055 us                | 10.423 ms                 |
| Forward                   | 5.550 ms                  | 6.771 ms                  |
| Backward                  | 944.683 ms                | 1.897 s                   |
| Optimize                  | 1.585 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.466 us                 | 18.810 ms                 |
| BlockToStepN              | 18.611 us                 | 74.073 us                 |
| OneStep                   | 958.300 ms                | 1.906 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 796.055 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.771 ms                  |
| Backward                  | 949.869 ms                | 1.899 s                   |
| Optimize                  | 1.585 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.403 us                 | 18.810 ms                 |
| BlockToStepN              | 18.623 us                 | 74.073 us                 |
| OneStep                   | 964.727 ms                | 1.911 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 172.472, sample: 0.208, forward: 0.457, backward: 104.199, update: 0.156
[proc 0] 500 steps, total: 172.472, sample: 0.191, forward: 0.563, backward: 171.469, update: 0.158
[proc 3] 500 steps, total: 172.472, sample: 0.177, forward: 0.476, backward: 152.959, update: 0.149
[proc 1] 500 steps, total: 172.472, sample: 0.193, forward: 0.483, backward: 107.862, update: 0.151
Successfully xmh. training takes 482.50707960128784 seconds
before call kg_cache_controller.StopThreads()
INFO [487470 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
INFO [487470 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 796.055 us                | 10.423 ms                 |
| Forward                   | 5.568 ms                  | 6.771 ms                  |
| Backward                  | 955.125 ms                | 1.902 s                   |
| Optimize                  | 1.590 ms                  | 2.424 ms                  |
| BarrierTimeBeforeRank0    | 31.403 us                 | 18.810 ms                 |
| BlockToStepN              | 18.670 us                 | 74.073 us                 |
| OneStep                   | 964.893 ms                | 1.915 s                   |
+---------------------------+---------------------------+---------------------------+
