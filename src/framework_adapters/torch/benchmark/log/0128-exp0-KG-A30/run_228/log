WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 18:59:19.604877 665835 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_48', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [665835 sampler.py:454] Start PreSampling
WARNING [665835 sampler.py:532] Before construct renumbering_dict
WARNING [665835 sampler.py:555] PreSampling done
W20240128 18:59:21.831171 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 18:59:21.831346 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 18:59:21.831384 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 18:59:21.831429 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 18:59:21.831462 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 18:59:21.831506 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 18:59:21.831539 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 18:59:21.831584 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 18:59:21.831619 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 18:59:21.831638 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 18:59:21.831663 665835 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 18:59:21.831683 665835 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 18:59:21.831715 665835 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 18:59:21.831836 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 18:59:21.831862 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 18:59:21.831879 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 18:59:21.831915 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 18:59:21.831933 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 18:59:21.831966 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 18:59:21.832002 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 18:59:21.832020 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 18:59:21.832052 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 18:59:21.832088 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 18:59:21.832106 665835 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 18:59:21.832121 665835 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 18:59:21.832144 665835 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 18:59:21.832185 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 18:59:21.832206 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 18:59:21.832222 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 18:59:21.832239 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 18:59:21.832257 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 18:59:21.832279 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 18:59:21.832298 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 18:59:21.832329 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 18:59:21.832361 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 18:59:21.832387 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 18:59:21.832405 665835 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 18:59:21.832420 665835 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 18:59:21.832435 665835 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 18:59:21.832470 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 18:59:21.832489 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 18:59:21.832507 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 18:59:21.832552 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 18:59:21.832576 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 18:59:21.832593 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 18:59:21.832610 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 18:59:21.832628 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 18:59:21.832644 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 18:59:21.832671 665835 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 18:59:21.832688 665835 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 18:59:21.832703 665835 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 18:59:21.832736 665835 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 18:59:21.982587 665835 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 18:59:21.982715 665835 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([1619, 1806, 1871,  ..., 2546, 7350, 8193]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.409 seconds
[Rank1] pid = 666045
[Rank2] pid = 666110
INFO [665835 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [666045 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [666110 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [666110 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [666174 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [666174 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [666110 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [666174 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [666045 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [665835 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [666045 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [665835 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [666174 cache_common.py:139] TorchNativeStdEmb construct done
INFO [665835 cache_common.py:139] TorchNativeStdEmb construct done
INFO [666045 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [666045 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [665835 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [666174 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [666110 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [666110 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 18:59:24.507877 666175 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 18:59:24.507927 666046 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 18:59:24.508136 666111 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 18:59:24.508245 666176 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240128 18:59:25.947335 666046 recstore.cc:66] init folly done
E20240128 18:59:25.947373 666111 recstore.cc:66] init folly done
E20240128 18:59:25.947423 666176 recstore.cc:66] init folly done
E20240128 18:59:25.947423 666175 recstore.cc:66] init folly done
I20240128 18:59:25.981379 666111 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 18:59:26.022739 666046 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 18:59:26.027664 666176 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 18:59:26.031594 666175 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 860.782 us                | 11.463 ms                 |
| Forward                   | 4.464 ms                  | 880.440 ms                |
| Backward                  | 31.193 ms                 | 1.372 s                   |
| Optimize                  | 1.042 ms                  | 43.117 ms                 |
| BarrierTimeBeforeRank0    | 3.978 ms                  | 9.518 ms                  |
| BlockToStepN              | 8.460 us                  | 102.195 us                |
| OneStep                   | 42.802 ms                 | 1.383 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 820.620 us                | 10.054 ms                 |
| Forward                   | 4.397 ms                  | 9.952 ms                  |
| Backward                  | 78.915 ms                 | 334.689 ms                |
| Optimize                  | 1.153 ms                  | 2.667 ms                  |
| BarrierTimeBeforeRank0    | 10.037 ms                 | 40.598 ms                 |
| BlockToStepN              | 8.057 us                  | 67.094 us                 |
| OneStep                   | 95.074 ms                 | 1.260 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 806.241 us                | 10.054 ms                 |
| Forward                   | 4.351 ms                  | 9.952 ms                  |
| Backward                  | 102.104 ms                | 334.689 ms                |
| Optimize                  | 1.094 ms                  | 2.667 ms                  |
| BarrierTimeBeforeRank0    | 16.214 ms                 | 62.432 ms                 |
| BlockToStepN              | 7.644 us                  | 67.094 us                 |
| OneStep                   | 125.689 ms                | 1.260 s                   |
+---------------------------+---------------------------+---------------------------+
[Rank3] pid = 666174
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 8753,    24, 10502,  8048,  7374,  4843,  9410,  5132, 11871,    64]) tensor([ 1871,  7998, 10601,  1462,  9089,  8313, 12890,  8640,  8859,  9062])
-------Step 1-------
tensor([ 8753,    24, 10502,  8048,  7374,  4843,  9410,  5132, 11871,    64]) tensor([ 8465, 10000, 13691, 12238,  7161, 10426,  7011,  2468,  2464,  7959])
-------Step 2-------
tensor([ 8824,  2600,  4382,    38,   713,   209,    16, 10260, 12227, 10632]) tensor([12224,  4189,  4350, 12081,  2185,  3022, 13639,  6768, 10485,  7360])
-------Step 3-------
tensor([ 8824,  2600,  4382,    38,   713,   209,    16, 10260, 12227, 10632]) tensor([  568,  9672,  7507, 13995,   143,   517,  2292, 10153,  5692,   133])
-------Step 4-------
tensor([ 3339, 12324, 13587, 10394,  5347,  6678, 13368,  6378,  3897,  2242]) tensor([12651,   989, 11859, 12536,  3759,   679,  5968,  1098,  9321, 11395])
-------Step 5-------
tensor([ 3339, 12324, 13587, 10394,  5347,  6678, 13368,  6378,  3897,  2242]) tensor([ 6997,  7655,  9565, 12544,  1241, 10690,  3290, 14110,  8853,  6338])
-------Step 6-------
tensor([14195,   589,  6433,    72, 12735, 10361, 14358, 13587,  9544,  5905]) tensor([ 3565,  7981,  6482, 10182, 11159, 13059,  2064,  2723, 10835,  1353])
-------Step 7-------
tensor([14195,   589,  6433,    72, 12735, 10361, 14358, 13587,  9544,  5905]) tensor([ 5234, 13726,  8361,  8078,  5669,   890,  7086,   971, 12474, 13853])
-------Step 8-------
tensor([ 9469, 10980, 14303,  9626,  5697,  6060,  1829,  5431,  4984, 12197]) tensor([ 6433, 10359, 12910,  1807,  8924, 11861,  2238,  8388,  8491,  9361])
-------Step 9-------
tensor([ 9469, 10980, 14303,  9626,  5697,  6060,  1829,  5431,  4984, 12197]) tensor([ 8895, 11777,  1682,  4133,  2646,   617,  6864,  3052,  2464, 13280])
before start barrier
start train
[proc 0] 100 steps, total: 16.215, sample: 0.178, forward: 1.314, backward: 11.731, update: 0.148
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 16.265, sample: 0.165, forward: 1.224, backward: 13.795, update: 0.175
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 16.219, sample: 0.158, forward: 0.995, backward: 10.468, update: 0.158
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 16.224, sample: 0.174, forward: 1.215, backward: 14.188, update: 0.160
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 795.929 us                | 10.054 ms                 |
| Forward                   | 4.351 ms                  | 9.952 ms                  |
| Backward                  | 108.312 ms                | 334.689 ms                |
| Optimize                  | 1.086 ms                  | 2.667 ms                  |
| BarrierTimeBeforeRank0    | 20.730 ms                 | 73.574 ms                 |
| BlockToStepN              | 7.593 us                  | 67.094 us                 |
| OneStep                   | 149.962 ms                | 1.260 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 785.791 us                | 10.054 ms                 |
| Forward                   | 4.331 ms                  | 9.952 ms                  |
| Backward                  | 122.139 ms                | 334.689 ms                |
| Optimize                  | 1.086 ms                  | 2.667 ms                  |
| BarrierTimeBeforeRank0    | 34.721 ms                 | 84.235 ms                 |
| BlockToStepN              | 7.542 us                  | 67.094 us                 |
| OneStep                   | 170.607 ms                | 1.260 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 786.047 us                | 10.054 ms                 |
| Forward                   | 4.327 ms                  | 9.952 ms                  |
| Backward                  | 135.584 ms                | 334.689 ms                |
| Optimize                  | 1.084 ms                  | 2.667 ms                  |
| BarrierTimeBeforeRank0    | 43.380 ms                 | 98.623 ms                 |
| BlockToStepN              | 7.564 us                  | 67.094 us                 |
| OneStep                   | 184.435 ms                | 1.260 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 783.429 us                | 9.825 ms                  |
| Forward                   | 4.327 ms                  | 7.111 ms                  |
| Backward                  | 147.990 ms                | 328.592 ms                |
| Optimize                  | 1.086 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 47.319 ms                 | 110.106 ms                |
| BlockToStepN              | 7.510 us                  | 58.887 us                 |
| OneStep                   | 200.751 ms                | 392.324 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 782.680 us                | 9.825 ms                  |
| Forward                   | 4.323 ms                  | 7.111 ms                  |
| Backward                  | 154.915 ms                | 349.878 ms                |
| Optimize                  | 1.086 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 51.342 ms                 | 119.057 ms                |
| BlockToStepN              | 7.542 us                  | 58.887 us                 |
| OneStep                   | 220.942 ms                | 420.149 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 783.429 us                | 9.825 ms                  |
| Forward                   | 4.314 ms                  | 7.111 ms                  |
| Backward                  | 164.979 ms                | 349.878 ms                |
| Optimize                  | 1.089 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 54.700 ms                 | 127.795 ms                |
| BlockToStepN              | 7.593 us                  | 58.887 us                 |
| OneStep                   | 230.422 ms                | 474.149 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 785.791 us                | 9.825 ms                  |
| Forward                   | 4.317 ms                  | 7.111 ms                  |
| Backward                  | 173.590 ms                | 383.518 ms                |
| Optimize                  | 1.095 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 58.097 ms                 | 141.798 ms                |
| BlockToStepN              | 7.564 us                  | 58.887 us                 |
| OneStep                   | 242.068 ms                | 474.149 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 786.047 us                | 9.825 ms                  |
| Forward                   | 4.323 ms                  | 7.111 ms                  |
| Backward                  | 182.839 ms                | 411.811 ms                |
| Optimize                  | 1.105 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 61.765 ms                 | 162.060 ms                |
| BlockToStepN              | 7.668 us                  | 64.023 us                 |
| OneStep                   | 254.445 ms                | 513.100 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 38.220, sample: 0.176, forward: 0.430, backward: 27.792, update: 0.107
[proc 1] 200 steps, total: 38.220, sample: 0.167, forward: 0.385, backward: 37.446, update: 0.096
[proc 2] 200 steps, total: 38.220, sample: 0.165, forward: 0.365, backward: 35.913, update: 0.104
[proc 3] 200 steps, total: 38.220, sample: 0.162, forward: 0.359, backward: 25.067, update: 0.109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 785.791 us                | 9.825 ms                  |
| Forward                   | 4.323 ms                  | 7.111 ms                  |
| Backward                  | 192.966 ms                | 427.495 ms                |
| Optimize                  | 1.108 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 62.392 ms                 | 162.060 ms                |
| BlockToStepN              | 7.707 us                  | 64.023 us                 |
| OneStep                   | 271.048 ms                | 540.040 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 785.791 us                | 9.825 ms                  |
| Forward                   | 4.323 ms                  | 7.111 ms                  |
| Backward                  | 201.874 ms                | 444.599 ms                |
| Optimize                  | 1.109 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 62.537 ms                 | 172.152 ms                |
| BlockToStepN              | 7.735 us                  | 64.023 us                 |
| OneStep                   | 277.922 ms                | 572.229 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 783.429 us                | 9.825 ms                  |
| Forward                   | 4.331 ms                  | 7.111 ms                  |
| Backward                  | 211.348 ms                | 448.128 ms                |
| Optimize                  | 1.111 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 64.681 ms                 | 175.792 ms                |
| BlockToStepN              | 7.762 us                  | 64.023 us                 |
| OneStep                   | 287.856 ms                | 572.229 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 788.991 us                | 9.825 ms                  |
| Forward                   | 4.348 ms                  | 7.111 ms                  |
| Backward                  | 220.959 ms                | 474.702 ms                |
| Optimize                  | 1.113 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 66.331 ms                 | 186.993 ms                |
| BlockToStepN              | 7.784 us                  | 64.023 us                 |
| OneStep                   | 304.752 ms                | 597.097 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 789.465 us                | 9.825 ms                  |
| Forward                   | 4.351 ms                  | 7.111 ms                  |
| Backward                  | 224.007 ms                | 478.928 ms                |
| Optimize                  | 1.124 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 68.556 ms                 | 187.381 ms                |
| BlockToStepN              | 7.942 us                  | 64.023 us                 |
| OneStep                   | 309.434 ms                | 630.359 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 791.013 us                | 9.601 ms                  |
| Forward                   | 4.351 ms                  | 6.278 ms                  |
| Backward                  | 232.052 ms                | 478.928 ms                |
| Optimize                  | 1.125 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 70.755 ms                 | 189.455 ms                |
| BlockToStepN              | 7.996 us                  | 64.023 us                 |
| OneStep                   | 321.208 ms                | 630.359 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 792.242 us                | 9.601 ms                  |
| Forward                   | 4.351 ms                  | 6.278 ms                  |
| Backward                  | 242.410 ms                | 478.928 ms                |
| Optimize                  | 1.127 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 72.116 ms                 | 193.063 ms                |
| BlockToStepN              | 8.033 us                  | 58.887 us                 |
| OneStep                   | 330.091 ms                | 651.724 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 793.159 us                | 9.601 ms                  |
| Forward                   | 4.353 ms                  | 6.278 ms                  |
| Backward                  | 251.331 ms                | 525.191 ms                |
| Optimize                  | 1.131 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 76.066 ms                 | 196.736 ms                |
| BlockToStepN              | 8.070 us                  | 58.887 us                 |
| OneStep                   | 343.857 ms                | 670.598 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 795.889 us                | 9.601 ms                  |
| Forward                   | 4.360 ms                  | 6.278 ms                  |
| Backward                  | 258.552 ms                | 540.162 ms                |
| Optimize                  | 1.134 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 77.811 ms                 | 207.871 ms                |
| BlockToStepN              | 8.145 us                  | 58.887 us                 |
| OneStep                   | 351.033 ms                | 685.206 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 795.929 us                | 9.601 ms                  |
| Forward                   | 4.366 ms                  | 7.111 ms                  |
| Backward                  | 261.863 ms                | 547.695 ms                |
| Optimize                  | 1.135 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 80.769 ms                 | 207.871 ms                |
| BlockToStepN              | 8.177 us                  | 58.887 us                 |
| OneStep                   | 358.412 ms                | 704.325 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 797.772 us                | 9.601 ms                  |
| Forward                   | 4.369 ms                  | 7.111 ms                  |
| Backward                  | 268.883 ms                | 562.256 ms                |
| Optimize                  | 1.143 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 84.235 ms                 | 212.268 ms                |
| BlockToStepN              | 8.287 us                  | 58.887 us                 |
| OneStep                   | 368.417 ms                | 746.185 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.346 us                | 9.825 ms                  |
| Forward                   | 4.373 ms                  | 7.111 ms                  |
| Backward                  | 274.833 ms                | 616.674 ms                |
| Optimize                  | 1.145 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 85.177 ms                 | 213.537 ms                |
| BlockToStepN              | 8.348 us                  | 58.887 us                 |
| OneStep                   | 375.770 ms                | 746.185 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 63.385, sample: 0.151, forward: 0.354, backward: 59.832, update: 0.105
[proc 0] 300 steps, total: 63.385, sample: 0.172, forward: 0.449, backward: 46.228, update: 0.123
[proc 1] 300 steps, total: 63.385, sample: 0.155, forward: 0.387, backward: 62.594, update: 0.101
[proc 3] 300 steps, total: 63.385, sample: 0.159, forward: 0.357, backward: 41.316, update: 0.110
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.644 us                | 9.825 ms                  |
| Forward                   | 4.375 ms                  | 7.111 ms                  |
| Backward                  | 279.337 ms                | 620.093 ms                |
| Optimize                  | 1.146 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 87.371 ms                 | 216.578 ms                |
| BlockToStepN              | 8.447 us                  | 58.887 us                 |
| OneStep                   | 388.890 ms                | 754.775 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.644 us                | 9.825 ms                  |
| Forward                   | 4.369 ms                  | 7.111 ms                  |
| Backward                  | 284.048 ms                | 620.093 ms                |
| Optimize                  | 1.146 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 89.024 ms                 | 224.247 ms                |
| BlockToStepN              | 8.548 us                  | 58.887 us                 |
| OneStep                   | 395.228 ms                | 768.127 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.338 us                | 9.825 ms                  |
| Forward                   | 4.375 ms                  | 7.111 ms                  |
| Backward                  | 287.006 ms                | 628.502 ms                |
| Optimize                  | 1.148 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 92.082 ms                 | 229.870 ms                |
| BlockToStepN              | 8.572 us                  | 58.887 us                 |
| OneStep                   | 400.316 ms                | 781.702 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 803.897 us                | 9.825 ms                  |
| Forward                   | 4.391 ms                  | 7.111 ms                  |
| Backward                  | 290.370 ms                | 632.075 ms                |
| Optimize                  | 1.150 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 94.397 ms                 | 239.096 ms                |
| BlockToStepN              | 8.678 us                  | 58.887 us                 |
| OneStep                   | 411.135 ms                | 802.694 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.734 us                | 9.825 ms                  |
| Forward                   | 4.397 ms                  | 7.111 ms                  |
| Backward                  | 299.804 ms                | 636.553 ms                |
| Optimize                  | 1.153 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 96.667 ms                 | 244.167 ms                |
| BlockToStepN              | 8.943 us                  | 58.887 us                 |
| OneStep                   | 419.590 ms                | 826.716 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.734 us                | 9.825 ms                  |
| Forward                   | 4.398 ms                  | 7.111 ms                  |
| Backward                  | 306.542 ms                | 671.189 ms                |
| Optimize                  | 1.156 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 98.341 ms                 | 247.517 ms                |
| BlockToStepN              | 9.089 us                  | 58.887 us                 |
| OneStep                   | 427.032 ms                | 832.043 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.501 us                | 9.825 ms                  |
| Forward                   | 4.398 ms                  | 7.111 ms                  |
| Backward                  | 314.197 ms                | 690.486 ms                |
| Optimize                  | 1.157 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 99.260 ms                 | 259.909 ms                |
| BlockToStepN              | 9.345 us                  | 58.887 us                 |
| OneStep                   | 431.204 ms                | 865.402 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.501 us                | 9.825 ms                  |
| Forward                   | 4.398 ms                  | 7.111 ms                  |
| Backward                  | 325.403 ms                | 690.486 ms                |
| Optimize                  | 1.161 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 105.202 ms                | 259.946 ms                |
| BlockToStepN              | 9.501 us                  | 58.887 us                 |
| OneStep                   | 437.586 ms                | 865.402 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.734 us                | 9.825 ms                  |
| Forward                   | 4.399 ms                  | 7.111 ms                  |
| Backward                  | 328.894 ms                | 696.956 ms                |
| Optimize                  | 1.162 ms                  | 2.147 ms                  |
| BarrierTimeBeforeRank0    | 106.014 ms                | 261.930 ms                |
| BlockToStepN              | 9.575 us                  | 58.887 us                 |
| OneStep                   | 452.223 ms                | 874.210 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 805.088 us                | 9.612 ms                  |
| Forward                   | 4.403 ms                  | 6.278 ms                  |
| Backward                  | 332.966 ms                | 712.556 ms                |
| Optimize                  | 1.162 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 107.043 ms                | 263.612 ms                |
| BlockToStepN              | 9.675 us                  | 55.057 us                 |
| OneStep                   | 463.368 ms                | 886.186 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 806.276 us                | 9.612 ms                  |
| Forward                   | 4.403 ms                  | 6.278 ms                  |
| Backward                  | 336.593 ms                | 714.108 ms                |
| Optimize                  | 1.162 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 108.258 ms                | 264.515 ms                |
| BlockToStepN              | 9.675 us                  | 55.057 us                 |
| OneStep                   | 466.501 ms                | 901.014 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 806.641 us                | 9.612 ms                  |
| Forward                   | 4.404 ms                  | 6.278 ms                  |
| Backward                  | 337.905 ms                | 714.642 ms                |
| Optimize                  | 1.164 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 110.106 ms                | 279.685 ms                |
| BlockToStepN              | 9.795 us                  | 55.057 us                 |
| OneStep                   | 470.444 ms                | 909.865 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 806.276 us                | 9.612 ms                  |
| Forward                   | 4.406 ms                  | 6.278 ms                  |
| Backward                  | 341.211 ms                | 724.776 ms                |
| Optimize                  | 1.164 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 113.164 ms                | 281.411 ms                |
| BlockToStepN              | 9.834 us                  | 55.057 us                 |
| OneStep                   | 474.149 ms                | 923.867 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 806.641 us                | 9.612 ms                  |
| Forward                   | 4.408 ms                  | 6.278 ms                  |
| Backward                  | 349.878 ms                | 742.213 ms                |
| Optimize                  | 1.165 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 114.458 ms                | 281.977 ms                |
| BlockToStepN              | 9.883 us                  | 55.057 us                 |
| OneStep                   | 487.829 ms                | 943.826 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.393 us                | 9.612 ms                  |
| Forward                   | 4.411 ms                  | 6.278 ms                  |
| Backward                  | 352.906 ms                | 757.080 ms                |
| Optimize                  | 1.165 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 115.243 ms                | 283.945 ms                |
| BlockToStepN              | 10.112 us                 | 55.057 us                 |
| OneStep                   | 491.015 ms                | 951.511 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 806.641 us                | 9.612 ms                  |
| Forward                   | 4.408 ms                  | 6.278 ms                  |
| Backward                  | 355.133 ms                | 763.432 ms                |
| Optimize                  | 1.166 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 118.449 ms                | 294.567 ms                |
| BlockToStepN              | 10.114 us                 | 55.057 us                 |
| OneStep                   | 500.528 ms                | 963.719 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.393 us                | 9.612 ms                  |
| Forward                   | 4.411 ms                  | 6.278 ms                  |
| Backward                  | 361.001 ms                | 771.086 ms                |
| Optimize                  | 1.166 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 119.428 ms                | 294.685 ms                |
| BlockToStepN              | 10.138 us                 | 55.057 us                 |
| OneStep                   | 509.684 ms                | 979.255 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.393 us                | 9.612 ms                  |
| Forward                   | 4.412 ms                  | 6.278 ms                  |
| Backward                  | 362.792 ms                | 773.983 ms                |
| Optimize                  | 1.174 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 122.465 ms                | 297.317 ms                |
| BlockToStepN              | 10.206 us                 | 55.057 us                 |
| OneStep                   | 513.100 ms                | 990.713 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 87.987, sample: 0.151, forward: 0.356, backward: 57.219, update: 0.112
[proc 1] 400 steps, total: 87.987, sample: 0.167, forward: 0.378, backward: 87.224, update: 0.102
[proc 2] 400 steps, total: 87.987, sample: 0.148, forward: 0.347, backward: 83.385, update: 0.115
[proc 0] 400 steps, total: 87.987, sample: 0.177, forward: 0.451, backward: 65.286, update: 0.125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.539 us                | 9.612 ms                  |
| Forward                   | 4.426 ms                  | 6.278 ms                  |
| Backward                  | 368.300 ms                | 784.159 ms                |
| Optimize                  | 1.175 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 126.822 ms                | 305.239 ms                |
| BlockToStepN              | 10.251 us                 | 55.057 us                 |
| OneStep                   | 517.425 ms                | 1.001 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.393 us                | 9.612 ms                  |
| Forward                   | 4.418 ms                  | 6.278 ms                  |
| Backward                  | 373.963 ms                | 818.709 ms                |
| Optimize                  | 1.176 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 127.795 ms                | 306.198 ms                |
| BlockToStepN              | 10.371 us                 | 55.057 us                 |
| OneStep                   | 523.031 ms                | 1.019 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.539 us                | 9.612 ms                  |
| Forward                   | 4.427 ms                  | 6.278 ms                  |
| Backward                  | 381.264 ms                | 834.335 ms                |
| Optimize                  | 1.176 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 129.742 ms                | 306.762 ms                |
| BlockToStepN              | 10.499 us                 | 55.057 us                 |
| OneStep                   | 532.143 ms                | 1.028 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.539 us                | 9.612 ms                  |
| Forward                   | 4.429 ms                  | 6.278 ms                  |
| Backward                  | 383.518 ms                | 844.498 ms                |
| Optimize                  | 1.179 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 132.466 ms                | 313.624 ms                |
| BlockToStepN              | 10.596 us                 | 55.057 us                 |
| OneStep                   | 532.965 ms                | 1.041 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.539 us                | 9.612 ms                  |
| Forward                   | 4.433 ms                  | 6.278 ms                  |
| Backward                  | 389.855 ms                | 851.615 ms                |
| Optimize                  | 1.179 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 133.139 ms                | 314.903 ms                |
| BlockToStepN              | 10.600 us                 | 55.057 us                 |
| OneStep                   | 538.168 ms                | 1.051 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.539 us                | 9.612 ms                  |
| Forward                   | 4.433 ms                  | 6.278 ms                  |
| Backward                  | 393.689 ms                | 851.615 ms                |
| Optimize                  | 1.180 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 134.516 ms                | 321.756 ms                |
| BlockToStepN              | 10.858 us                 | 55.057 us                 |
| OneStep                   | 553.518 ms                | 1.062 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.393 us                | 9.612 ms                  |
| Forward                   | 4.449 ms                  | 6.278 ms                  |
| Backward                  | 402.194 ms                | 866.997 ms                |
| Optimize                  | 1.180 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 136.018 ms                | 324.855 ms                |
| BlockToStepN              | 10.863 us                 | 55.057 us                 |
| OneStep                   | 556.862 ms                | 1.077 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.393 us                | 9.612 ms                  |
| Forward                   | 4.452 ms                  | 6.278 ms                  |
| Backward                  | 403.040 ms                | 866.997 ms                |
| Optimize                  | 1.180 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 137.144 ms                | 329.797 ms                |
| BlockToStepN              | 10.974 us                 | 55.057 us                 |
| OneStep                   | 559.729 ms                | 1.084 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.101 us                | 9.612 ms                  |
| Forward                   | 4.453 ms                  | 6.278 ms                  |
| Backward                  | 405.299 ms                | 872.985 ms                |
| Optimize                  | 1.180 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 140.837 ms                | 332.287 ms                |
| BlockToStepN              | 11.086 us                 | 55.057 us                 |
| OneStep                   | 562.298 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.477 us                | 9.612 ms                  |
| Forward                   | 4.453 ms                  | 6.278 ms                  |
| Backward                  | 412.860 ms                | 885.577 ms                |
| Optimize                  | 1.180 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 143.321 ms                | 337.127 ms                |
| BlockToStepN              | 11.172 us                 | 55.057 us                 |
| OneStep                   | 570.176 ms                | 1.109 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.477 us                | 9.612 ms                  |
| Forward                   | 4.453 ms                  | 6.278 ms                  |
| Backward                  | 416.660 ms                | 905.221 ms                |
| Optimize                  | 1.180 ms                  | 2.064 ms                  |
| BarrierTimeBeforeRank0    | 143.672 ms                | 340.000 ms                |
| BlockToStepN              | 11.280 us                 | 55.057 us                 |
| OneStep                   | 572.229 ms                | 1.120 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.567 us                | 9.601 ms                  |
| Forward                   | 4.455 ms                  | 5.974 ms                  |
| Backward                  | 419.855 ms                | 905.221 ms                |
| Optimize                  | 1.180 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 144.437 ms                | 340.451 ms                |
| BlockToStepN              | 11.446 us                 | 52.363 us                 |
| OneStep                   | 586.922 ms                | 1.127 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.567 us                | 9.601 ms                  |
| Forward                   | 4.464 ms                  | 5.974 ms                  |
| Backward                  | 421.229 ms                | 920.291 ms                |
| Optimize                  | 1.180 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 145.963 ms                | 341.992 ms                |
| BlockToStepN              | 11.581 us                 | 52.363 us                 |
| OneStep                   | 587.478 ms                | 1.140 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.625 us                | 9.601 ms                  |
| Forward                   | 4.467 ms                  | 5.974 ms                  |
| Backward                  | 427.495 ms                | 930.404 ms                |
| Optimize                  | 1.180 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 146.963 ms                | 345.985 ms                |
| BlockToStepN              | 11.820 us                 | 52.363 us                 |
| OneStep                   | 590.546 ms                | 1.150 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.567 us                | 9.601 ms                  |
| Forward                   | 4.467 ms                  | 5.974 ms                  |
| Backward                  | 431.696 ms                | 940.726 ms                |
| Optimize                  | 1.180 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 147.462 ms                | 347.105 ms                |
| BlockToStepN              | 11.921 us                 | 52.363 us                 |
| OneStep                   | 594.178 ms                | 1.163 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.625 us                | 9.601 ms                  |
| Forward                   | 4.469 ms                  | 5.974 ms                  |
| Backward                  | 436.034 ms                | 940.726 ms                |
| Optimize                  | 1.181 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 147.723 ms                | 354.870 ms                |
| BlockToStepN              | 11.922 us                 | 52.363 us                 |
| OneStep                   | 600.429 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.625 us                | 9.601 ms                  |
| Forward                   | 4.469 ms                  | 5.974 ms                  |
| Backward                  | 440.861 ms                | 955.175 ms                |
| Optimize                  | 1.184 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 149.785 ms                | 360.904 ms                |
| BlockToStepN              | 11.970 us                 | 52.363 us                 |
| OneStep                   | 601.589 ms                | 1.181 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.625 us                | 9.601 ms                  |
| Forward                   | 4.469 ms                  | 5.974 ms                  |
| Backward                  | 444.179 ms                | 956.899 ms                |
| Optimize                  | 1.184 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 152.881 ms                | 370.255 ms                |
| BlockToStepN              | 12.181 us                 | 52.363 us                 |
| OneStep                   | 613.795 ms                | 1.197 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 810.431 us                | 9.601 ms                  |
| Forward                   | 4.469 ms                  | 5.974 ms                  |
| Backward                  | 444.599 ms                | 959.193 ms                |
| Optimize                  | 1.186 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 154.387 ms                | 374.428 ms                |
| BlockToStepN              | 12.325 us                 | 52.363 us                 |
| OneStep                   | 616.961 ms                | 1.205 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 810.629 us                | 9.601 ms                  |
| Forward                   | 4.469 ms                  | 5.974 ms                  |
| Backward                  | 447.457 ms                | 960.634 ms                |
| Optimize                  | 1.189 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 154.427 ms                | 377.703 ms                |
| BlockToStepN              | 12.447 us                 | 52.363 us                 |
| OneStep                   | 622.746 ms                | 1.217 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 811.290 us                | 9.601 ms                  |
| Forward                   | 4.472 ms                  | 5.974 ms                  |
| Backward                  | 449.768 ms                | 962.933 ms                |
| Optimize                  | 1.189 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 156.071 ms                | 378.554 ms                |
| BlockToStepN              | 12.474 us                 | 52.363 us                 |
| OneStep                   | 625.899 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 811.290 us                | 9.601 ms                  |
| Forward                   | 4.476 ms                  | 5.974 ms                  |
| Backward                  | 455.241 ms                | 973.233 ms                |
| Optimize                  | 1.189 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 156.749 ms                | 384.292 ms                |
| BlockToStepN              | 12.536 us                 | 52.363 us                 |
| OneStep                   | 630.359 ms                | 1.235 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 811.290 us                | 9.601 ms                  |
| Forward                   | 4.476 ms                  | 5.974 ms                  |
| Backward                  | 459.959 ms                | 979.187 ms                |
| Optimize                  | 1.190 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 157.982 ms                | 385.281 ms                |
| BlockToStepN              | 12.611 us                 | 52.363 us                 |
| OneStep                   | 637.471 ms                | 1.245 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 500 steps, total: 113.074, sample: 0.154, forward: 0.359, backward: 72.936, update: 0.113
[proc 2] 500 steps, total: 113.074, sample: 0.165, forward: 0.351, backward: 107.368, update: 0.113
[proc 1] 500 steps, total: 113.074, sample: 0.151, forward: 0.377, backward: 112.280, update: 0.100
[proc 0] 500 steps, total: 113.074, sample: 0.173, forward: 0.456, backward: 85.656, update: 0.122
Successfully xmh. training takes 318.8821427822113 seconds
before call kg_cache_controller.StopThreads()
INFO [665835 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
INFO [665835 controller_process.py:421] call rank0 to StopThreads
