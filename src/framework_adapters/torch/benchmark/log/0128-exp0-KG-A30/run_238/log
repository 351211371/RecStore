WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 19:20:59.619472 691765 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_58', no_save_emb=True, max_step=500, batch_size=2400, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [691765 sampler.py:454] Start PreSampling
WARNING [691765 sampler.py:532] Before construct renumbering_dict
WARNING [691765 sampler.py:555] PreSampling done
W20240128 19:21:02.107731 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 19:21:02.107882 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 19:21:02.107913 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 19:21:02.107933 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 19:21:02.107954 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 19:21:02.107975 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 19:21:02.108000 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 19:21:02.108021 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 19:21:02.108039 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 19:21:02.108065 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 19:21:02.108089 691765 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 19:21:02.108110 691765 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 19:21:02.108131 691765 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 19:21:02.108217 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 19:21:02.108239 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 19:21:02.108258 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 19:21:02.108290 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 19:21:02.108310 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 19:21:02.108328 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 19:21:02.108350 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 19:21:02.108372 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 19:21:02.108393 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 19:21:02.108415 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 19:21:02.108435 691765 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 19:21:02.108451 691765 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 19:21:02.108469 691765 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 19:21:02.108506 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 19:21:02.108529 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 19:21:02.108546 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 19:21:02.108563 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 19:21:02.108583 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 19:21:02.108608 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 19:21:02.108628 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 19:21:02.108649 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 19:21:02.108670 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 19:21:02.108697 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 19:21:02.108718 691765 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 19:21:02.108733 691765 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 19:21:02.108747 691765 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 19:21:02.108783 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 19:21:02.108801 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 19:21:02.108829 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 19:21:02.108850 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 19:21:02.108865 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 19:21:02.108882 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 19:21:02.108899 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 19:21:02.108919 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 19:21:02.108939 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 19:21:02.108963 691765 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 19:21:02.108980 691765 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 19:21:02.108994 691765 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 19:21:02.109009 691765 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 19:21:02.241839 691765 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 19:21:02.241967 691765 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([1677, 1981, 2094,  ..., 2605, 5633, 7815]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.645 seconds
[Rank1] pid = 692086
[Rank2] pid = 692151
INFO [691765 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [692086 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [692151 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [692216 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [692151 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [692216 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [692151 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [692086 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [692216 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [692151 cache_common.py:139] TorchNativeStdEmb construct done
INFO [692086 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
WARNING [692151 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [692216 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [692216 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [692086 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [692086 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [691765 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [691765 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [691765 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [691765 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 19:21:05.418226 692217 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 19:21:05.418327 692152 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 19:21:05.418411 692243 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 19:21:05.418506 692087 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240128 19:21:05.726415 692152 recstore.cc:66] init folly done
E20240128 19:21:05.726547 692217 recstore.cc:66] init folly done
E20240128 19:21:05.726639 692243 recstore.cc:66] init folly done
E20240128 19:21:05.726677 692087 recstore.cc:66] init folly done
I20240128 19:21:05.797382 692152 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 19:21:05.807665 692243 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 19:21:05.813776 692217 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 19:21:05.816884 692087 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 743.302 us                | 11.220 ms                 |
| Forward                   | 6.248 ms                  | 589.264 ms                |
| Backward                  | 80.007 ms                 | 744.050 ms                |
| Optimize                  | 1.696 ms                  | 50.187 ms                 |
| BarrierTimeBeforeRank0    | 41.825 us                 | 836.132 ms                |
| BlockToStepN              | 9.489 us                  | 46.349 us                 |
| OneStep                   | 88.892 ms                 | 1.770 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 751.114 us                | 11.563 ms                 |
| Forward                   | 6.248 ms                  | 589.264 ms                |
| Backward                  | 140.796 ms                | 744.050 ms                |
| Optimize                  | 1.604 ms                  | 50.187 ms                 |
| BarrierTimeBeforeRank0    | 34.509 us                 | 836.132 ms                |
| BlockToStepN              | 10.232 us                 | 52.338 us                 |
| OneStep                   | 149.448 ms                | 1.770 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 763.805 us                | 11.446 ms                 |
| Forward                   | 6.301 ms                  | 8.588 ms                  |
| Backward                  | 179.337 ms                | 320.566 ms                |
| Optimize                  | 1.603 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 33.267 us                 | 56.147 ms                 |
| BlockToStepN              | 10.867 us                 | 52.338 us                 |
| OneStep                   | 188.481 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 769.605 us                | 11.685 ms                 |
| Forward                   | 6.311 ms                  | 8.588 ms                  |
| Backward                  | 208.136 ms                | 389.667 ms                |
| Optimize                  | 1.584 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 33.267 us                 | 56.147 ms                 |
| BlockToStepN              | 11.395 us                 | 52.338 us                 |
| OneStep                   | 221.703 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 779.708 us                | 11.764 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 238.987 ms                | 445.305 ms                |
| Optimize                  | 1.587 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 32.590 us                 | 56.147 ms                 |
| BlockToStepN              | 12.757 us                 | 56.685 us                 |
| OneStep                   | 251.835 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 29.197, sample: 0.200, forward: 1.193, backward: 25.322, update: 0.208
[Rank3] pid = 692216
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
train_sampler.Prefill()
-------Step 0-------
tensor([11464,   343, 10099,  8218,  7463,  6462, 11139,  5171, 12947,   286]) tensor([ 2094,  9027, 10179,  1142,  6917, 10965, 13340, 11316,  8401,  1175])
-------Step 1-------
tensor([11464,   343, 10099,  8218,  7463,  6462, 11139,  5171, 12947,   286]) tensor([ 2873,   779,  6433,  5322, 13512,    37,   565,  5994,  6652,  8103])
-------Step 2-------
tensor([ 4351, 14546, 11157, 10947,  6243,  6577, 12567,  7383,  4400,  2196]) tensor([14666,  1050, 12464, 11120,  4531,   525,  6929,   928,  4900, 13145])
-------Step 3-------
tensor([ 4351, 14546, 11157, 10947,  6243,  6577, 12567,  7383,  4400,  2196]) tensor([ 9446, 13561,  6964,  7818,  4181,  7486, 13625,  7870,  7202, 13153])
-------Step 4-------
tensor([ 4961, 11618, 13887, 10639,  2919,  7375,  1810,  6153,  5427, 14894]) tensor([  772, 11101, 14936,  1817, 11604, 10958,  2371,  9926,  8061, 10127])
-------Step 5-------
tensor([ 4961, 11618, 13887, 10639,  2919,  7375,  1810,  6153,  5427, 14894]) tensor([ 4777, 12232,  4360, 10047,  8311,  4874,  1038,  1611, 13818,  2186])
-------Step 6-------
tensor([ 6181,   517, 13107, 10971,  4229, 11801,  8759,   133,  5976, 10084]) tensor([13303, 12082, 10942,   906, 12503, 10372,  8740,  2503,  7790, 11425])
-------Step 7-------
tensor([ 6181,   517, 13107, 10971,  4229, 11801,  8759,   133,  5976, 10084]) tensor([ 6447,  6448,  9899, 12844,  6605,  4205,  7702,   604, 13570,  7130])
-------Step 8-------
tensor([ 4518, 13186,  6439,  6941,  2666,  7605,  4356,  2987,   644,  7789]) tensor([ 8276, 11951, 10087, 14240,  7799,  9474,  7088,  1812,  2807, 10418])
-------Step 9-------
tensor([ 4518, 13186,  6439,  6941,  2666,  7605,  4356,  2987,   644,  7789]) tensor([ 2629, 13397,  4163, 13366,  1978,   580,  3840,  1824, 14830, 14179])
before start barrier
start train
[proc 0] 100 steps, total: 29.200, sample: 0.208, forward: 1.212, backward: 26.508, update: 0.214
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 29.206, sample: 0.223, forward: 1.880, backward: 17.782, update: 0.210
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 29.216, sample: 0.230, forward: 1.892, backward: 17.972, update: 0.251
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 793.139 us                | 11.764 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 270.038 ms                | 492.380 ms                |
| Optimize                  | 1.584 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 31.955 us                 | 56.147 ms                 |
| BlockToStepN              | 13.118 us                 | 56.685 us                 |
| OneStep                   | 279.039 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.381 us                | 11.764 ms                 |
| Forward                   | 6.302 ms                  | 8.588 ms                  |
| Backward                  | 285.773 ms                | 552.975 ms                |
| Optimize                  | 1.582 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 31.819 us                 | 56.147 ms                 |
| BlockToStepN              | 14.619 us                 | 56.685 us                 |
| OneStep                   | 301.296 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.381 us                | 11.764 ms                 |
| Forward                   | 6.302 ms                  | 8.588 ms                  |
| Backward                  | 309.357 ms                | 582.970 ms                |
| Optimize                  | 1.580 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 31.864 us                 | 56.147 ms                 |
| BlockToStepN              | 15.372 us                 | 64.422 us                 |
| OneStep                   | 318.593 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 802.591 us                | 11.785 ms                 |
| Forward                   | 6.301 ms                  | 8.588 ms                  |
| Backward                  | 320.566 ms                | 625.050 ms                |
| Optimize                  | 1.580 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 31.955 us                 | 56.147 ms                 |
| BlockToStepN              | 16.210 us                 | 64.422 us                 |
| OneStep                   | 342.130 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 806.291 us                | 11.785 ms                 |
| Forward                   | 6.301 ms                  | 8.588 ms                  |
| Backward                  | 342.508 ms                | 664.913 ms                |
| Optimize                  | 1.580 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 31.864 us                 | 56.147 ms                 |
| BlockToStepN              | 16.210 us                 | 64.422 us                 |
| OneStep                   | 360.648 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.835 us                | 13.434 ms                 |
| Forward                   | 6.294 ms                  | 8.588 ms                  |
| Backward                  | 360.492 ms                | 690.065 ms                |
| Optimize                  | 1.572 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 31.955 us                 | 56.147 ms                 |
| BlockToStepN              | 17.217 us                 | 64.422 us                 |
| OneStep                   | 380.540 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 808.944 us                | 13.434 ms                 |
| Forward                   | 6.311 ms                  | 8.588 ms                  |
| Backward                  | 377.560 ms                | 716.826 ms                |
| Optimize                  | 1.580 ms                  | 7.183 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 56.147 ms                 |
| BlockToStepN              | 17.217 us                 | 64.422 us                 |
| OneStep                   | 392.383 ms                | 816.339 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 811.275 us                | 12.874 ms                 |
| Forward                   | 6.319 ms                  | 7.866 ms                  |
| Backward                  | 389.667 ms                | 751.631 ms                |
| Optimize                  | 1.584 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 36.926 ms                 |
| BlockToStepN              | 17.419 us                 | 63.231 us                 |
| OneStep                   | 411.124 ms                | 773.083 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.598 us                | 12.874 ms                 |
| Forward                   | 6.311 ms                  | 7.866 ms                  |
| Backward                  | 406.877 ms                | 777.829 ms                |
| Optimize                  | 1.587 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 36.926 ms                 |
| BlockToStepN              | 17.889 us                 | 64.422 us                 |
| OneStep                   | 420.446 ms                | 810.696 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 815.068 us                | 12.874 ms                 |
| Forward                   | 6.311 ms                  | 7.866 ms                  |
| Backward                  | 423.720 ms                | 809.244 ms                |
| Optimize                  | 1.603 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.083 us                 | 36.926 ms                 |
| BlockToStepN              | 17.889 us                 | 64.422 us                 |
| OneStep                   | 449.862 ms                | 821.900 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 816.325 us                | 12.874 ms                 |
| Forward                   | 6.302 ms                  | 7.866 ms                  |
| Backward                  | 440.610 ms                | 840.065 ms                |
| Optimize                  | 1.608 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.083 us                 | 36.926 ms                 |
| BlockToStepN              | 17.935 us                 | 64.422 us                 |
| OneStep                   | 452.101 ms                | 863.904 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 818.603 us                | 12.874 ms                 |
| Forward                   | 6.311 ms                  | 7.866 ms                  |
| Backward                  | 443.514 ms                | 866.066 ms                |
| Optimize                  | 1.608 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 36.926 ms                 |
| BlockToStepN              | 18.197 us                 | 64.422 us                 |
| OneStep                   | 457.428 ms                | 884.340 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 821.457 us                | 12.874 ms                 |
| Forward                   | 6.311 ms                  | 7.866 ms                  |
| Backward                  | 459.036 ms                | 897.848 ms                |
| Optimize                  | 1.614 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.083 us                 | 36.926 ms                 |
| BlockToStepN              | 18.320 us                 | 64.422 us                 |
| OneStep                   | 470.221 ms                | 919.970 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.006 us                | 12.874 ms                 |
| Forward                   | 6.311 ms                  | 7.866 ms                  |
| Backward                  | 473.408 ms                | 925.163 ms                |
| Optimize                  | 1.608 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 36.926 ms                 |
| BlockToStepN              | 18.440 us                 | 66.212 us                 |
| OneStep                   | 487.385 ms                | 950.751 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.006 us                | 12.874 ms                 |
| Forward                   | 6.311 ms                  | 7.866 ms                  |
| Backward                  | 488.424 ms                | 951.818 ms                |
| Optimize                  | 1.614 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.265 us                 | 36.926 ms                 |
| BlockToStepN              | 18.624 us                 | 66.212 us                 |
| OneStep                   | 499.182 ms                | 962.870 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 200 steps, total: 74.824, sample: 0.237, forward: 0.632, backward: 73.608, update: 0.176
[proc 2] 200 steps, total: 74.824, sample: 0.233, forward: 0.528, backward: 46.383, update: 0.190
[proc 3] 200 steps, total: 74.824, sample: 0.219, forward: 0.516, backward: 46.007, update: 0.155
[proc 1] 200 steps, total: 74.824, sample: 0.226, forward: 0.588, backward: 69.848, update: 0.170
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.887 us                | 12.874 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 492.380 ms                | 974.218 ms                |
| Optimize                  | 1.626 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.325 us                 | 36.926 ms                 |
| BlockToStepN              | 18.661 us                 | 66.212 us                 |
| OneStep                   | 520.492 ms                | 989.899 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.887 us                | 13.016 ms                 |
| Forward                   | 6.311 ms                  | 8.588 ms                  |
| Backward                  | 513.118 ms                | 994.989 ms                |
| Optimize                  | 1.627 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.325 us                 | 36.926 ms                 |
| BlockToStepN              | 18.967 us                 | 66.212 us                 |
| OneStep                   | 525.998 ms                | 1.015 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.861 us                | 13.016 ms                 |
| Forward                   | 6.311 ms                  | 8.588 ms                  |
| Backward                  | 517.532 ms                | 1.029 s                   |
| Optimize                  | 1.627 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.325 us                 | 36.926 ms                 |
| BlockToStepN              | 19.536 us                 | 66.212 us                 |
| OneStep                   | 527.669 ms                | 1.052 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.136 us                | 13.016 ms                 |
| Forward                   | 6.311 ms                  | 8.588 ms                  |
| Backward                  | 529.553 ms                | 1.050 s                   |
| Optimize                  | 1.626 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.265 us                 | 36.926 ms                 |
| BlockToStepN              | 19.798 us                 | 66.212 us                 |
| OneStep                   | 548.969 ms                | 1.073 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.887 us                | 13.016 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 539.829 ms                | 1.072 s                   |
| Optimize                  | 1.626 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.325 us                 | 36.926 ms                 |
| BlockToStepN              | 19.951 us                 | 66.212 us                 |
| OneStep                   | 561.517 ms                | 1.082 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.861 us                | 13.016 ms                 |
| Forward                   | 6.311 ms                  | 8.588 ms                  |
| Backward                  | 547.706 ms                | 1.099 s                   |
| Optimize                  | 1.626 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.265 us                 | 36.926 ms                 |
| BlockToStepN              | 19.924 us                 | 66.212 us                 |
| OneStep                   | 573.657 ms                | 1.110 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.066 us                | 13.016 ms                 |
| Forward                   | 6.311 ms                  | 8.588 ms                  |
| Backward                  | 565.464 ms                | 1.103 s                   |
| Optimize                  | 1.627 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.325 us                 | 36.926 ms                 |
| BlockToStepN              | 19.924 us                 | 66.212 us                 |
| OneStep                   | 575.707 ms                | 1.123 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.861 us                | 13.016 ms                 |
| Forward                   | 6.303 ms                  | 8.588 ms                  |
| Backward                  | 579.289 ms                | 1.128 s                   |
| Optimize                  | 1.628 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.336 us                 | 36.926 ms                 |
| BlockToStepN              | 20.165 us                 | 66.212 us                 |
| OneStep                   | 594.469 ms                | 1.145 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.421 us                | 13.434 ms                 |
| Forward                   | 6.303 ms                  | 8.588 ms                  |
| Backward                  | 585.056 ms                | 1.140 s                   |
| Optimize                  | 1.628 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.325 us                 | 36.926 ms                 |
| BlockToStepN              | 20.650 us                 | 66.212 us                 |
| OneStep                   | 601.235 ms                | 1.166 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.421 us                | 13.434 ms                 |
| Forward                   | 6.311 ms                  | 8.720 ms                  |
| Backward                  | 598.272 ms                | 1.162 s                   |
| Optimize                  | 1.630 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.325 us                 | 36.926 ms                 |
| BlockToStepN              | 20.672 us                 | 66.212 us                 |
| OneStep                   | 615.028 ms                | 1.186 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.421 us                | 13.434 ms                 |
| Forward                   | 6.311 ms                  | 8.720 ms                  |
| Backward                  | 605.587 ms                | 1.190 s                   |
| Optimize                  | 1.630 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.325 us                 | 36.926 ms                 |
| BlockToStepN              | 21.125 us                 | 66.212 us                 |
| OneStep                   | 622.857 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.899 us                | 13.434 ms                 |
| Forward                   | 6.319 ms                  | 8.720 ms                  |
| Backward                  | 612.730 ms                | 1.204 s                   |
| Optimize                  | 1.631 ms                  | 3.367 ms                  |
| BarrierTimeBeforeRank0    | 32.325 us                 | 36.926 ms                 |
| BlockToStepN              | 21.149 us                 | 66.849 us                 |
| OneStep                   | 630.804 ms                | 1.220 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.899 us                | 13.016 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 622.074 ms                | 1.218 s                   |
| Optimize                  | 1.658 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.265 us                 | 23.668 ms                 |
| BlockToStepN              | 21.149 us                 | 66.212 us                 |
| OneStep                   | 643.486 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.899 us                | 13.016 ms                 |
| Forward                   | 6.320 ms                  | 8.588 ms                  |
| Backward                  | 634.100 ms                | 1.241 s                   |
| Optimize                  | 1.679 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.265 us                 | 23.668 ms                 |
| BlockToStepN              | 21.149 us                 | 66.212 us                 |
| OneStep                   | 646.607 ms                | 1.259 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.899 us                | 13.016 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 637.045 ms                | 1.259 s                   |
| Optimize                  | 1.669 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.265 us                 | 23.668 ms                 |
| BlockToStepN              | 21.149 us                 | 66.212 us                 |
| OneStep                   | 658.514 ms                | 1.274 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.016 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 658.439 ms                | 1.285 s                   |
| Optimize                  | 1.679 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.155 us                 | 23.668 ms                 |
| BlockToStepN              | 21.149 us                 | 66.212 us                 |
| OneStep                   | 673.054 ms                | 1.298 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.016 ms                 |
| Forward                   | 6.320 ms                  | 8.588 ms                  |
| Backward                  | 664.913 ms                | 1.299 s                   |
| Optimize                  | 1.669 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.155 us                 | 23.668 ms                 |
| BlockToStepN              | 21.292 us                 | 66.212 us                 |
| OneStep                   | 680.073 ms                | 1.314 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.016 ms                 |
| Forward                   | 6.323 ms                  | 8.588 ms                  |
| Backward                  | 674.151 ms                | 1.319 s                   |
| Optimize                  | 1.679 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.155 us                 | 23.668 ms                 |
| BlockToStepN              | 21.316 us                 | 66.212 us                 |
| OneStep                   | 693.207 ms                | 1.335 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.016 ms                 |
| Forward                   | 6.323 ms                  | 8.588 ms                  |
| Backward                  | 679.291 ms                | 1.331 s                   |
| Optimize                  | 1.679 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.151 us                 | 23.668 ms                 |
| BlockToStepN              | 21.316 us                 | 66.212 us                 |
| OneStep                   | 698.570 ms                | 1.353 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.016 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 681.058 ms                | 1.357 s                   |
| Optimize                  | 1.679 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.155 us                 | 23.668 ms                 |
| BlockToStepN              | 21.809 us                 | 66.212 us                 |
| OneStep                   | 702.295 ms                | 1.368 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.016 ms                 |
| Forward                   | 6.320 ms                  | 8.588 ms                  |
| Backward                  | 699.510 ms                | 1.383 s                   |
| Optimize                  | 1.690 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.151 us                 | 23.668 ms                 |
| BlockToStepN              | 21.893 us                 | 66.212 us                 |
| OneStep                   | 714.477 ms                | 1.394 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.016 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 707.046 ms                | 1.394 s                   |
| Optimize                  | 1.709 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.155 us                 | 23.668 ms                 |
| BlockToStepN              | 21.910 us                 | 66.212 us                 |
| OneStep                   | 723.678 ms                | 1.410 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 713.751 ms                | 1.402 s                   |
| Optimize                  | 1.709 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.151 us                 | 23.668 ms                 |
| BlockToStepN              | 21.908 us                 | 66.212 us                 |
| OneStep                   | 726.245 ms                | 1.418 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.619 ms                 |
| Forward                   | 6.320 ms                  | 8.588 ms                  |
| Backward                  | 716.826 ms                | 1.434 s                   |
| Optimize                  | 1.709 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.151 us                 | 23.668 ms                 |
| BlockToStepN              | 21.910 us                 | 66.212 us                 |
| OneStep                   | 736.220 ms                | 1.446 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.619 ms                 |
| Forward                   | 6.311 ms                  | 8.588 ms                  |
| Backward                  | 730.517 ms                | 1.471 s                   |
| Optimize                  | 1.709 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.151 us                 | 23.668 ms                 |
| BlockToStepN              | 21.910 us                 | 66.212 us                 |
| OneStep                   | 747.089 ms                | 1.502 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 123.905, sample: 0.225, forward: 0.528, backward: 75.070, update: 0.193
[proc 1] 300 steps, total: 123.905, sample: 0.208, forward: 0.580, backward: 114.589, update: 0.183
[proc 3] 300 steps, total: 123.905, sample: 0.242, forward: 0.524, backward: 75.262, update: 0.151
[proc 0] 300 steps, total: 123.905, sample: 0.243, forward: 0.636, backward: 122.726, update: 0.184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.619 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 737.865 ms                | 1.479 s                   |
| Optimize                  | 1.714 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.151 us                 | 23.668 ms                 |
| BlockToStepN              | 22.145 us                 | 66.849 us                 |
| OneStep                   | 761.887 ms                | 1.503 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.619 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 744.050 ms                | 1.488 s                   |
| Optimize                  | 1.714 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 23.668 ms                 |
| BlockToStepN              | 22.145 us                 | 66.849 us                 |
| OneStep                   | 768.325 ms                | 1.503 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.619 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 756.867 ms                | 1.493 s                   |
| Optimize                  | 1.716 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.151 us                 | 23.668 ms                 |
| BlockToStepN              | 22.235 us                 | 66.849 us                 |
| OneStep                   | 773.083 ms                | 1.510 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.619 ms                 |
| Forward                   | 6.319 ms                  | 8.588 ms                  |
| Backward                  | 763.450 ms                | 1.511 s                   |
| Optimize                  | 1.715 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 23.668 ms                 |
| BlockToStepN              | 22.235 us                 | 66.849 us                 |
| OneStep                   | 788.923 ms                | 1.530 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.619 ms                 |
| Forward                   | 6.320 ms                  | 8.588 ms                  |
| Backward                  | 766.658 ms                | 1.526 s                   |
| Optimize                  | 1.714 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.083 us                 | 23.668 ms                 |
| BlockToStepN              | 22.235 us                 | 66.849 us                 |
| OneStep                   | 789.549 ms                | 1.554 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.619 ms                 |
| Forward                   | 6.320 ms                  | 8.588 ms                  |
| Backward                  | 777.829 ms                | 1.545 s                   |
| Optimize                  | 1.714 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.083 us                 | 23.668 ms                 |
| BlockToStepN              | 22.235 us                 | 66.849 us                 |
| OneStep                   | 798.311 ms                | 1.583 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.619 ms                 |
| Forward                   | 6.323 ms                  | 8.588 ms                  |
| Backward                  | 779.931 ms                | 1.573 s                   |
| Optimize                  | 1.714 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 31.955 us                 | 23.668 ms                 |
| BlockToStepN              | 22.235 us                 | 66.849 us                 |
| OneStep                   | 803.058 ms                | 1.588 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.619 ms                 |
| Forward                   | 6.323 ms                  | 8.588 ms                  |
| Backward                  | 793.023 ms                | 1.580 s                   |
| Optimize                  | 1.714 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 23.668 ms                 |
| BlockToStepN              | 22.332 us                 | 66.849 us                 |
| OneStep                   | 810.696 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.619 ms                 |
| Forward                   | 6.325 ms                  | 8.588 ms                  |
| Backward                  | 797.234 ms                | 1.612 s                   |
| Optimize                  | 1.709 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 23.668 ms                 |
| BlockToStepN              | 22.332 us                 | 66.849 us                 |
| OneStep                   | 816.339 ms                | 1.631 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.619 ms                 |
| Forward                   | 6.325 ms                  | 8.588 ms                  |
| Backward                  | 809.244 ms                | 1.621 s                   |
| Optimize                  | 1.709 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.093 us                 | 23.668 ms                 |
| BlockToStepN              | 22.408 us                 | 66.849 us                 |
| OneStep                   | 821.900 ms                | 1.632 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.619 ms                 |
| Forward                   | 6.326 ms                  | 8.588 ms                  |
| Backward                  | 812.966 ms                | 1.623 s                   |
| Optimize                  | 1.709 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.083 us                 | 23.668 ms                 |
| BlockToStepN              | 22.408 us                 | 66.849 us                 |
| OneStep                   | 824.197 ms                | 1.637 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.619 ms                 |
| Forward                   | 6.330 ms                  | 8.588 ms                  |
| Backward                  | 826.671 ms                | 1.637 s                   |
| Optimize                  | 1.714 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 32.083 us                 | 23.668 ms                 |
| BlockToStepN              | 22.383 us                 | 66.849 us                 |
| OneStep                   | 837.892 ms                | 1.656 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.619 ms                 |
| Forward                   | 6.330 ms                  | 8.588 ms                  |
| Backward                  | 827.231 ms                | 1.647 s                   |
| Optimize                  | 1.714 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 31.955 us                 | 23.668 ms                 |
| BlockToStepN              | 22.332 us                 | 66.849 us                 |
| OneStep                   | 844.552 ms                | 1.664 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.619 ms                 |
| Forward                   | 6.332 ms                  | 8.588 ms                  |
| Backward                  | 839.827 ms                | 1.673 s                   |
| Optimize                  | 1.714 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 31.955 us                 | 23.668 ms                 |
| BlockToStepN              | 22.408 us                 | 66.849 us                 |
| OneStep                   | 858.840 ms                | 1.694 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.619 ms                 |
| Forward                   | 6.332 ms                  | 8.588 ms                  |
| Backward                  | 840.065 ms                | 1.693 s                   |
| Optimize                  | 1.715 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 31.903 us                 | 23.668 ms                 |
| BlockToStepN              | 22.383 us                 | 66.849 us                 |
| OneStep                   | 861.239 ms                | 1.719 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.619 ms                 |
| Forward                   | 6.332 ms                  | 8.658 ms                  |
| Backward                  | 852.981 ms                | 1.709 s                   |
| Optimize                  | 1.715 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 31.903 us                 | 23.668 ms                 |
| BlockToStepN              | 22.408 us                 | 66.849 us                 |
| OneStep                   | 863.904 ms                | 1.736 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.332 ms                  | 8.588 ms                  |
| Backward                  | 854.882 ms                | 1.744 s                   |
| Optimize                  | 1.715 ms                  | 3.206 ms                  |
| BarrierTimeBeforeRank0    | 31.864 us                 | 23.668 ms                 |
| BlockToStepN              | 22.408 us                 | 66.849 us                 |
| OneStep                   | 875.974 ms                | 1.770 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.332 ms                  | 8.588 ms                  |
| Backward                  | 866.066 ms                | 1.759 s                   |
| Optimize                  | 1.716 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.864 us                 | 22.546 ms                 |
| BlockToStepN              | 22.511 us                 | 66.212 us                 |
| OneStep                   | 884.340 ms                | 1.771 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.434 ms                 |
| Forward                   | 6.338 ms                  | 8.588 ms                  |
| Backward                  | 866.752 ms                | 1.764 s                   |
| Optimize                  | 1.723 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.864 us                 | 22.546 ms                 |
| BlockToStepN              | 22.408 us                 | 66.212 us                 |
| OneStep                   | 886.463 ms                | 1.776 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 875.591 ms                | 1.771 s                   |
| Optimize                  | 1.723 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.864 us                 | 22.546 ms                 |
| BlockToStepN              | 22.408 us                 | 66.212 us                 |
| OneStep                   | 891.790 ms                | 1.783 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 897.633 ms                | 1.777 s                   |
| Optimize                  | 1.755 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.864 us                 | 22.546 ms                 |
| BlockToStepN              | 22.552 us                 | 66.212 us                 |
| OneStep                   | 907.915 ms                | 1.787 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.344 ms                  | 8.588 ms                  |
| Backward                  | 897.848 ms                | 1.802 s                   |
| Optimize                  | 1.755 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.819 us                 | 22.546 ms                 |
| BlockToStepN              | 22.511 us                 | 66.212 us                 |
| OneStep                   | 919.091 ms                | 1.812 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 911.123 ms                | 1.818 s                   |
| Optimize                  | 1.760 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.819 us                 | 23.668 ms                 |
| BlockToStepN              | 22.552 us                 | 66.212 us                 |
| OneStep                   | 921.979 ms                | 1.829 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 911.874 ms                | 1.822 s                   |
| Optimize                  | 1.760 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.819 us                 | 23.668 ms                 |
| BlockToStepN              | 22.552 us                 | 66.212 us                 |
| OneStep                   | 924.669 ms                | 1.832 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 914.885 ms                | 1.828 s                   |
| Optimize                  | 1.755 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.734 us                 | 23.668 ms                 |
| BlockToStepN              | 22.691 us                 | 66.212 us                 |
| OneStep                   | 929.149 ms                | 1.838 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 921.975 ms                | 1.865 s                   |
| Optimize                  | 1.755 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.734 us                 | 23.668 ms                 |
| BlockToStepN              | 22.706 us                 | 66.849 us                 |
| OneStep                   | 934.337 ms                | 1.874 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.338 ms                  | 8.588 ms                  |
| Backward                  | 925.163 ms                | 1.880 s                   |
| Optimize                  | 1.723 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.734 us                 | 23.668 ms                 |
| BlockToStepN              | 22.706 us                 | 69.880 us                 |
| OneStep                   | 950.751 ms                | 1.890 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.338 ms                  | 8.588 ms                  |
| Backward                  | 929.881 ms                | 1.890 s                   |
| Optimize                  | 1.723 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.734 us                 | 23.668 ms                 |
| BlockToStepN              | 22.706 us                 | 69.880 us                 |
| OneStep                   | 950.951 ms                | 1.900 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.338 ms                  | 8.588 ms                  |
| Backward                  | 950.428 ms                | 1.902 s                   |
| Optimize                  | 1.760 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.734 us                 | 23.668 ms                 |
| BlockToStepN              | 22.736 us                 | 72.130 us                 |
| OneStep                   | 960.622 ms                | 1.912 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.333 ms                  | 8.588 ms                  |
| Backward                  | 951.419 ms                | 1.913 s                   |
| Optimize                  | 1.755 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.734 us                 | 23.668 ms                 |
| BlockToStepN              | 22.933 us                 | 72.130 us                 |
| OneStep                   | 960.670 ms                | 1.923 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.338 ms                  | 8.588 ms                  |
| Backward                  | 951.818 ms                | 1.941 s                   |
| Optimize                  | 1.755 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.698 us                 | 23.668 ms                 |
| BlockToStepN              | 22.946 us                 | 73.105 us                 |
| OneStep                   | 962.870 ms                | 1.950 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 953.071 ms                | 1.945 s                   |
| Optimize                  | 1.755 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.698 us                 | 23.668 ms                 |
| BlockToStepN              | 22.949 us                 | 73.105 us                 |
| OneStep                   | 968.179 ms                | 1.955 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 973.657 ms                | 1.963 s                   |
| Optimize                  | 1.769 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.698 us                 | 23.668 ms                 |
| BlockToStepN              | 22.960 us                 | 73.105 us                 |
| OneStep                   | 983.933 ms                | 1.977 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 974.218 ms                | 1.975 s                   |
| Optimize                  | 1.769 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.734 us                 | 23.668 ms                 |
| BlockToStepN              | 23.177 us                 | 73.105 us                 |
| OneStep                   | 989.899 ms                | 1.985 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.341 ms                  | 8.588 ms                  |
| Backward                  | 980.010 ms                | 1.981 s                   |
| Optimize                  | 1.760 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.698 us                 | 23.668 ms                 |
| BlockToStepN              | 23.177 us                 | 73.105 us                 |
| OneStep                   | 994.619 ms                | 1.991 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 174.891, sample: 0.228, forward: 0.536, backward: 103.788, update: 0.195
[proc 0] 400 steps, total: 174.891, sample: 0.229, forward: 0.651, backward: 173.683, update: 0.182
[proc 3] 400 steps, total: 174.891, sample: 0.216, forward: 0.531, backward: 104.556, update: 0.155
[proc 1] 400 steps, total: 174.891, sample: 0.237, forward: 0.594, backward: 159.818, update: 0.184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.343 ms                  | 8.588 ms                  |
| Backward                  | 982.067 ms                | 1.988 s                   |
| Optimize                  | 1.760 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.698 us                 | 23.668 ms                 |
| BlockToStepN              | 23.333 us                 | 73.105 us                 |
| OneStep                   | 996.148 ms                | 1.997 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.338 ms                  | 8.588 ms                  |
| Backward                  | 994.039 ms                | 2.002 s                   |
| Optimize                  | 1.769 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.698 us                 | 23.668 ms                 |
| BlockToStepN              | 23.356 us                 | 73.105 us                 |
| OneStep                   | 1.015 s                   | 2.012 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.338 ms                  | 8.588 ms                  |
| Backward                  | 994.989 ms                | 2.007 s                   |
| Optimize                  | 1.769 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.698 us                 | 23.668 ms                 |
| BlockToStepN              | 23.356 us                 | 73.105 us                 |
| OneStep                   | 1.015 s                   | 2.016 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.338 ms                  | 8.588 ms                  |
| Backward                  | 997.014 ms                | 2.039 s                   |
| Optimize                  | 1.769 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.677 us                 | 23.668 ms                 |
| BlockToStepN              | 23.333 us                 | 73.105 us                 |
| OneStep                   | 1.019 s                   | 2.056 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.995 us                | 13.434 ms                 |
| Forward                   | 6.333 ms                  | 8.588 ms                  |
| Backward                  | 1.006 s                   | 2.055 s                   |
| Optimize                  | 1.769 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.356 us                 | 73.105 us                 |
| OneStep                   | 1.026 s                   | 2.069 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.333 ms                  | 8.588 ms                  |
| Backward                  | 1.023 s                   | 2.076 s                   |
| Optimize                  | 1.781 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.677 us                 | 23.668 ms                 |
| BlockToStepN              | 23.367 us                 | 73.105 us                 |
| OneStep                   | 1.038 s                   | 2.087 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.333 ms                  | 8.588 ms                  |
| Backward                  | 1.027 s                   | 2.077 s                   |
| Optimize                  | 1.781 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.677 us                 | 23.668 ms                 |
| BlockToStepN              | 23.449 us                 | 73.573 us                 |
| OneStep                   | 1.040 s                   | 2.088 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.643 us                | 13.434 ms                 |
| Forward                   | 6.338 ms                  | 8.588 ms                  |
| Backward                  | 1.029 s                   | 2.079 s                   |
| Optimize                  | 1.781 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.677 us                 | 23.668 ms                 |
| BlockToStepN              | 23.463 us                 | 73.573 us                 |
| OneStep                   | 1.052 s                   | 2.089 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.434 ms                 |
| Forward                   | 6.343 ms                  | 8.588 ms                  |
| Backward                  | 1.043 s                   | 2.100 s                   |
| Optimize                  | 1.781 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.677 us                 | 23.668 ms                 |
| BlockToStepN              | 23.463 us                 | 73.573 us                 |
| OneStep                   | 1.055 s                   | 2.110 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.434 ms                 |
| Forward                   | 6.343 ms                  | 8.588 ms                  |
| Backward                  | 1.045 s                   | 2.117 s                   |
| Optimize                  | 1.769 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.498 us                 | 73.573 us                 |
| OneStep                   | 1.057 s                   | 2.128 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.344 ms                  | 8.588 ms                  |
| Backward                  | 1.046 s                   | 2.128 s                   |
| Optimize                  | 1.781 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.541 us                 | 73.573 us                 |
| OneStep                   | 1.057 s                   | 2.148 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.434 ms                 |
| Forward                   | 6.344 ms                  | 8.588 ms                  |
| Backward                  | 1.050 s                   | 2.161 s                   |
| Optimize                  | 1.781 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.606 us                 | 73.573 us                 |
| OneStep                   | 1.073 s                   | 2.172 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.348 ms                  | 8.588 ms                  |
| Backward                  | 1.064 s                   | 2.168 s                   |
| Optimize                  | 1.782 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.606 us                 | 73.573 us                 |
| OneStep                   | 1.077 s                   | 2.178 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.349 ms                  | 8.588 ms                  |
| Backward                  | 1.065 s                   | 2.179 s                   |
| Optimize                  | 1.782 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.633 us                 | 23.668 ms                 |
| BlockToStepN              | 23.629 us                 | 73.573 us                 |
| OneStep                   | 1.081 s                   | 2.188 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.354 ms                  | 8.588 ms                  |
| Backward                  | 1.068 s                   | 2.184 s                   |
| Optimize                  | 1.781 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.633 us                 | 23.668 ms                 |
| BlockToStepN              | 23.629 us                 | 73.573 us                 |
| OneStep                   | 1.082 s                   | 2.194 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.355 ms                  | 8.588 ms                  |
| Backward                  | 1.072 s                   | 2.195 s                   |
| Optimize                  | 1.782 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.724 us                 | 73.573 us                 |
| OneStep                   | 1.086 s                   | 2.205 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.358 ms                  | 8.588 ms                  |
| Backward                  | 1.072 s                   | 2.198 s                   |
| Optimize                  | 1.788 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.769 us                 | 73.573 us                 |
| OneStep                   | 1.090 s                   | 2.208 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.358 ms                  | 8.588 ms                  |
| Backward                  | 1.074 s                   | 2.224 s                   |
| Optimize                  | 1.792 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.633 us                 | 23.668 ms                 |
| BlockToStepN              | 23.832 us                 | 73.573 us                 |
| OneStep                   | 1.094 s                   | 2.234 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.619 ms                 |
| Forward                   | 6.358 ms                  | 8.588 ms                  |
| Backward                  | 1.098 s                   | 2.225 s                   |
| Optimize                  | 1.824 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.833 us                 | 73.573 us                 |
| OneStep                   | 1.108 s                   | 2.235 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.619 ms                 |
| Forward                   | 6.359 ms                  | 8.588 ms                  |
| Backward                  | 1.098 s                   | 2.228 s                   |
| Optimize                  | 1.818 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.884 us                 | 73.573 us                 |
| OneStep                   | 1.109 s                   | 2.237 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.619 ms                 |
| Forward                   | 6.359 ms                  | 8.588 ms                  |
| Backward                  | 1.099 s                   | 2.228 s                   |
| Optimize                  | 1.824 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.642 us                 | 23.668 ms                 |
| BlockToStepN              | 23.911 us                 | 73.573 us                 |
| OneStep                   | 1.110 s                   | 2.238 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.050 us                | 13.619 ms                 |
| Forward                   | 6.358 ms                  | 8.588 ms                  |
| Backward                  | 1.101 s                   | 2.244 s                   |
| Optimize                  | 1.824 ms                  | 3.054 ms                  |
| BarrierTimeBeforeRank0    | 31.633 us                 | 23.668 ms                 |
| BlockToStepN              | 23.967 us                 | 73.573 us                 |
| OneStep                   | 1.110 s                   | 2.261 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.101 s                   | 2.252 s                   |
| Optimize                  | 1.845 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 22.546 ms                 |
| BlockToStepN              | 24.016 us                 | 73.105 us                 |
| OneStep                   | 1.116 s                   | 2.270 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.359 ms                  | 8.330 ms                  |
| Backward                  | 1.103 s                   | 2.262 s                   |
| Optimize                  | 1.845 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 23.418 ms                 |
| BlockToStepN              | 24.020 us                 | 73.573 us                 |
| OneStep                   | 1.123 s                   | 2.272 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.359 ms                  | 8.330 ms                  |
| Backward                  | 1.106 s                   | 2.272 s                   |
| Optimize                  | 1.845 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 23.418 ms                 |
| BlockToStepN              | 24.029 us                 | 73.573 us                 |
| OneStep                   | 1.127 s                   | 2.283 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.358 ms                  | 8.330 ms                  |
| Backward                  | 1.117 s                   | 2.285 s                   |
| Optimize                  | 1.852 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.571 us                 | 23.418 ms                 |
| BlockToStepN              | 24.047 us                 | 73.573 us                 |
| OneStep                   | 1.136 s                   | 2.302 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.355 ms                  | 8.330 ms                  |
| Backward                  | 1.126 s                   | 2.293 s                   |
| Optimize                  | 1.852 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 23.418 ms                 |
| BlockToStepN              | 24.261 us                 | 73.573 us                 |
| OneStep                   | 1.139 s                   | 2.304 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.355 ms                  | 8.330 ms                  |
| Backward                  | 1.136 s                   | 2.298 s                   |
| Optimize                  | 1.859 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 23.418 ms                 |
| BlockToStepN              | 24.422 us                 | 73.573 us                 |
| OneStep                   | 1.147 s                   | 2.309 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.358 ms                  | 8.330 ms                  |
| Backward                  | 1.137 s                   | 2.303 s                   |
| Optimize                  | 1.876 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 23.418 ms                 |
| BlockToStepN              | 24.478 us                 | 73.573 us                 |
| OneStep                   | 1.149 s                   | 2.313 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.358 ms                  | 8.330 ms                  |
| Backward                  | 1.140 s                   | 2.334 s                   |
| Optimize                  | 1.876 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 23.418 ms                 |
| BlockToStepN              | 24.585 us                 | 73.573 us                 |
| OneStep                   | 1.150 s                   | 2.344 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.224 us                | 13.434 ms                 |
| Forward                   | 6.358 ms                  | 8.330 ms                  |
| Backward                  | 1.140 s                   | 2.338 s                   |
| Optimize                  | 1.876 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.633 us                 | 23.418 ms                 |
| BlockToStepN              | 24.635 us                 | 73.573 us                 |
| OneStep                   | 1.166 s                   | 2.347 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.359 ms                  | 8.330 ms                  |
| Backward                  | 1.146 s                   | 2.344 s                   |
| Optimize                  | 1.876 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.633 us                 | 23.418 ms                 |
| BlockToStepN              | 24.645 us                 | 73.573 us                 |
| OneStep                   | 1.168 s                   | 2.357 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.343 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.159 s                   | 2.357 s                   |
| Optimize                  | 1.881 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 23.418 ms                 |
| BlockToStepN              | 24.651 us                 | 73.684 us                 |
| OneStep                   | 1.171 s                   | 2.367 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.343 us                | 13.434 ms                 |
| Forward                   | 6.359 ms                  | 8.330 ms                  |
| Backward                  | 1.161 s                   | 2.363 s                   |
| Optimize                  | 1.881 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 23.418 ms                 |
| BlockToStepN              | 24.668 us                 | 73.684 us                 |
| OneStep                   | 1.178 s                   | 2.373 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.343 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.162 s                   | 2.367 s                   |
| Optimize                  | 1.885 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.597 us                 | 23.418 ms                 |
| BlockToStepN              | 24.703 us                 | 73.684 us                 |
| OneStep                   | 1.178 s                   | 2.377 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.359 ms                  | 8.330 ms                  |
| Backward                  | 1.167 s                   | 2.390 s                   |
| Optimize                  | 1.885 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.571 us                 | 23.418 ms                 |
| BlockToStepN              | 24.703 us                 | 73.684 us                 |
| OneStep                   | 1.186 s                   | 2.412 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.168 s                   | 2.412 s                   |
| Optimize                  | 1.885 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.571 us                 | 23.418 ms                 |
| BlockToStepN              | 24.827 us                 | 73.684 us                 |
| OneStep                   | 1.196 s                   | 2.423 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.173 s                   | 2.429 s                   |
| Optimize                  | 1.885 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.508 us                 | 23.418 ms                 |
| BlockToStepN              | 24.849 us                 | 73.684 us                 |
| OneStep                   | 1.199 s                   | 2.425 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.187 s                   | 2.432 s                   |
| Optimize                  | 1.885 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.508 us                 | 23.418 ms                 |
| BlockToStepN              | 24.967 us                 | 73.684 us                 |
| OneStep                   | 1.201 s                   | 2.442 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.367 ms                  | 8.330 ms                  |
| Backward                  | 1.190 s                   | 2.443 s                   |
| Optimize                  | 1.885 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.508 us                 | 23.418 ms                 |
| BlockToStepN              | 24.975 us                 | 73.684 us                 |
| OneStep                   | 1.206 s                   | 2.453 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.190 s                   | 2.445 s                   |
| Optimize                  | 1.885 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.508 us                 | 23.418 ms                 |
| BlockToStepN              | 25.013 us                 | 73.684 us                 |
| OneStep                   | 1.207 s                   | 2.455 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.343 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.195 s                   | 2.454 s                   |
| Optimize                  | 1.888 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.571 us                 | 23.418 ms                 |
| BlockToStepN              | 25.035 us                 | 75.180 us                 |
| OneStep                   | 1.215 s                   | 2.465 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.343 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.204 s                   | 2.473 s                   |
| Optimize                  | 1.888 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.571 us                 | 23.418 ms                 |
| BlockToStepN              | 25.059 us                 | 80.527 us                 |
| OneStep                   | 1.220 s                   | 2.485 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.343 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.209 s                   | 2.473 s                   |
| Optimize                  | 1.888 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.571 us                 | 23.418 ms                 |
| BlockToStepN              | 25.110 us                 | 80.707 us                 |
| OneStep                   | 1.227 s                   | 2.485 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.343 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.209 s                   | 2.475 s                   |
| Optimize                  | 1.888 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.571 us                 | 23.418 ms                 |
| BlockToStepN              | 25.144 us                 | 82.974 us                 |
| OneStep                   | 1.229 s                   | 2.486 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 226.285, sample: 0.217, forward: 0.604, backward: 206.045, update: 0.189
[proc 2] 500 steps, total: 226.285, sample: 0.232, forward: 0.547, backward: 132.701, update: 0.202
[proc 3] 500 steps, total: 226.285, sample: 0.228, forward: 0.540, backward: 133.550, update: 0.156
[proc 0] 500 steps, total: 226.285, sample: 0.241, forward: 0.646, backward: 225.042, update: 0.190
Successfully xmh. training takes 629.1046116352081 seconds
before call kg_cache_controller.StopThreads()
INFO [691765 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
INFO [691765 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.716 us                | 13.434 ms                 |
| Forward                   | 6.361 ms                  | 8.330 ms                  |
| Backward                  | 1.218 s                   | 2.475 s                   |
| Optimize                  | 1.910 ms                  | 2.845 ms                  |
| BarrierTimeBeforeRank0    | 31.571 us                 | 23.418 ms                 |
| BlockToStepN              | 25.273 us                 | 82.974 us                 |
| OneStep                   | 1.231 s                   | 2.486 s                   |
+---------------------------+---------------------------+---------------------------+
