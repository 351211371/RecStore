WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 16:14:35.435513 472147 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_FB15k_28', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [472147 sampler.py:454] Start PreSampling
WARNING [472147 sampler.py:532] Before construct renumbering_dict
WARNING [472147 sampler.py:555] PreSampling done
W20240128 16:14:37.720034 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 16:14:37.720155 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 16:14:37.720178 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 16:14:37.720199 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 16:14:37.720214 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 16:14:37.720229 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 16:14:37.720249 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 16:14:37.720268 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 16:14:37.720283 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 16:14:37.720302 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 16:14:37.720321 472147 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 16:14:37.720337 472147 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 16:14:37.720350 472147 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 16:14:37.720428 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 16:14:37.720458 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 16:14:37.720482 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 16:14:37.720512 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 16:14:37.720533 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 16:14:37.720551 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 16:14:37.720571 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 16:14:37.720590 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 16:14:37.720610 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 16:14:37.720626 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 16:14:37.720641 472147 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 16:14:37.720654 472147 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 16:14:37.720667 472147 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 16:14:37.720702 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 16:14:37.720722 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 16:14:37.720737 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 16:14:37.720755 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 16:14:37.720769 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 16:14:37.720790 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 16:14:37.720809 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 16:14:37.720826 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 16:14:37.720844 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 16:14:37.720860 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 16:14:37.720875 472147 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 16:14:37.720887 472147 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 16:14:37.720899 472147 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 16:14:37.720932 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 16:14:37.720953 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 16:14:37.720968 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 16:14:37.720986 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 16:14:37.721000 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 16:14:37.721019 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 16:14:37.721033 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 16:14:37.721052 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 16:14:37.721068 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 16:14:37.721082 472147 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 16:14:37.721100 472147 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 16:14:37.721113 472147 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 16:14:37.721125 472147 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 16:14:37.835458 472147 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 16:14:37.835582 472147 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 874, 1119, 1205,  ..., 1540, 5285, 6311]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.432 seconds
[Rank1] pid = 472466
[Rank2] pid = 472530
INFO [472147 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [472466 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [472147 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [472530 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [472530 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [472531 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [472147 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [472466 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [472531 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [472466 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [472530 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [472147 cache_common.py:139] TorchNativeStdEmb construct done
INFO [472466 cache_common.py:139] TorchNativeStdEmb construct done
INFO [472531 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
WARNING [472466 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [472147 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [472530 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [472530 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [472531 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [472531 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 16:14:41.037600 472467 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 16:14:41.037726 472582 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 16:14:41.037827 472532 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 16:14:41.037931 472544 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240128 16:14:42.395409 472582 recstore.cc:66] init folly done
E20240128 16:14:42.395537 472467 recstore.cc:66] init folly done
E20240128 16:14:42.395534 472532 recstore.cc:66] init folly done
E20240128 16:14:42.395542 472544 recstore.cc:66] init folly done
I20240128 16:14:42.468390 472582 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 16:14:42.468595 472544 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 16:14:42.473852 472532 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 16:14:42.474085 472467 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.462 us                | 9.699 ms                  |
| Forward                   | 4.663 ms                  | 734.529 ms                |
| Backward                  | 29.170 ms                 | 1.450 s                   |
| Optimize                  | 1.186 ms                  | 81.427 ms                 |
| BarrierTimeBeforeRank0    | 10.538 ms                 | 115.133 ms                |
| BlockToStepN              | 7.279 us                  | 221.344 us                |
| OneStep                   | 46.991 ms                 | 1.461 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.211 us                | 9.885 ms                  |
| Forward                   | 4.613 ms                  | 7.327 ms                  |
| Backward                  | 75.570 ms                 | 266.955 ms                |
| Optimize                  | 1.282 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 20.521 ms                 | 42.113 ms                 |
| BlockToStepN              | 8.443 us                  | 45.034 us                 |
| OneStep                   | 99.090 ms                 | 1.200 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 816.667 us                | 9.885 ms                  |
| Forward                   | 4.557 ms                  | 7.327 ms                  |
| Backward                  | 95.775 ms                 | 266.955 ms                |
| Optimize                  | 1.251 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 26.140 ms                 | 79.996 ms                 |
| BlockToStepN              | 8.852 us                  | 45.034 us                 |
| OneStep                   | 132.385 ms                | 1.200 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 17.123, sample: 0.173, forward: 1.180, backward: 15.334, update: 0.151
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 17.129, sample: 0.165, forward: 1.118, backward: 10.467, update: 0.159
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 17.129, sample: 0.165, forward: 1.186, backward: 14.821, update: 0.155
[Rank3] pid = 472531
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 9577,  3723,  8021,  6348, 10138,  4882,   710,  4701, 14735, 10979]) tensor([ 1205, 11010,  8109,   666,  6709,  9076, 11465,  9433,  6847,  6752])
-------Step 1-------
tensor([ 9577,  3723,  8021,  6348, 10138,  4882,   710,  4701, 14735, 10979]) tensor([ 7468, 12036, 10653, 13454,  6114,  7702,  6150,  1691,  2243,  9105])
-------Step 2-------
tensor([ 9594,  2550,  3061,    16,  9938,  7612,  4175, 11514,  9426,  7240]) tensor([ 9410,  3961,  3015, 14224,  1610,  1875, 10390,  5917, 14185,  7865])
-------Step 3-------
tensor([ 9594,  2550,  3061,    16,  9938,  7612,  4175, 11514,  9426,  7240]) tensor([ 4226, 11842,  5614, 11685,  2907, 13833,  1780, 11637,  5346,    47])
-------Step 4-------
tensor([  158, 14208,  9757,  9092,  6851,  4933, 13970,  7158,  3922,  1325]) tensor([13719,  5019,  8994,  9653,  3302, 10337,  6817,   530, 10341, 13649])
-------Step 5-------
tensor([  158, 14208,  9757,  9092,  6851,  4933, 13970,  7158,  3922,  1325]) tensor([ 7423,  5579,  7180, 14330,  8907, 11516,  3215, 11967,  6739,  6565])
-------Step 6-------
tensor([10076,  5813,   379,    78,  9925, 11155, 12744,  9757, 10605,  6285]) tensor([ 2524,  9340,  7362, 12154,  8114, 10463,  1202,  2277, 11741, 14320])
-------Step 7-------
tensor([10076,  5813,   379,    78,  9925, 11155, 12744,  9757, 10605,  6285]) tensor([ 3938, 14934, 10472,  6200,  5292,   456,  8862,  7075,  9597, 11534])
-------Step 8-------
tensor([10514,  8263, 13999, 10550,  4838,  6453,   987,  5962,  3971, 13648]) tensor([  379, 12421, 14468,  1000, 10867,  9317,  1756, 10503,  6406,  7017])
-------Step 9-------
tensor([10514,  8263, 13999, 10550,  4838,  6453,   987,  5962,  3971, 13648]) tensor([11181,  9514,   964,  2871,  1841, 12677,  6675,  2678,  2243, 14392])
before start barrier
start train
[proc 0] 100 steps, total: 17.124, sample: 0.184, forward: 1.193, backward: 11.606, update: 0.197
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.128 us                | 9.885 ms                  |
| Forward                   | 4.530 ms                  | 7.327 ms                  |
| Backward                  | 113.134 ms                | 266.955 ms                |
| Optimize                  | 1.266 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 32.620 ms                 | 86.023 ms                 |
| BlockToStepN              | 8.443 us                  | 45.034 us                 |
| OneStep                   | 160.782 ms                | 1.200 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 812.334 us                | 9.885 ms                  |
| Forward                   | 4.518 ms                  | 7.327 ms                  |
| Backward                  | 123.129 ms                | 266.955 ms                |
| Optimize                  | 1.282 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 39.734 ms                 | 99.008 ms                 |
| BlockToStepN              | 8.253 us                  | 45.034 us                 |
| OneStep                   | 171.819 ms                | 1.200 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 812.334 us                | 10.053 ms                 |
| Forward                   | 4.535 ms                  | 7.327 ms                  |
| Backward                  | 128.952 ms                | 299.697 ms                |
| Optimize                  | 1.288 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 51.669 ms                 | 115.133 ms                |
| BlockToStepN              | 8.530 us                  | 54.106 us                 |
| OneStep                   | 189.924 ms                | 1.200 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.250 us                | 10.053 ms                 |
| Forward                   | 4.535 ms                  | 7.327 ms                  |
| Backward                  | 141.588 ms                | 311.299 ms                |
| Optimize                  | 1.297 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 57.686 ms                 | 126.115 ms                |
| BlockToStepN              | 8.530 us                  | 54.106 us                 |
| OneStep                   | 206.640 ms                | 1.200 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 808.889 us                | 9.885 ms                  |
| Forward                   | 4.535 ms                  | 7.023 ms                  |
| Backward                  | 153.390 ms                | 307.211 ms                |
| Optimize                  | 1.308 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 62.199 ms                 | 134.180 ms                |
| BlockToStepN              | 8.530 us                  | 45.034 us                 |
| OneStep                   | 222.225 ms                | 420.175 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.250 us                | 9.885 ms                  |
| Forward                   | 4.555 ms                  | 7.023 ms                  |
| Backward                  | 158.851 ms                | 325.801 ms                |
| Optimize                  | 1.315 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 66.749 ms                 | 144.122 ms                |
| BlockToStepN              | 8.744 us                  | 45.034 us                 |
| OneStep                   | 242.623 ms                | 459.688 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.250 us                | 9.885 ms                  |
| Forward                   | 4.558 ms                  | 7.023 ms                  |
| Backward                  | 166.264 ms                | 381.006 ms                |
| Optimize                  | 1.320 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 69.902 ms                 | 151.653 ms                |
| BlockToStepN              | 8.665 us                  | 45.034 us                 |
| OneStep                   | 251.660 ms                | 485.391 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 809.250 us                | 9.885 ms                  |
| Forward                   | 4.573 ms                  | 7.023 ms                  |
| Backward                  | 174.478 ms                | 386.090 ms                |
| Optimize                  | 1.327 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 73.836 ms                 | 161.322 ms                |
| BlockToStepN              | 9.249 us                  | 45.034 us                 |
| OneStep                   | 261.453 ms                | 504.043 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 200 steps, total: 39.558, sample: 0.163, forward: 0.405, backward: 37.696, update: 0.100
[proc 1] 200 steps, total: 39.558, sample: 0.163, forward: 0.413, backward: 38.795, update: 0.090
[proc 0] 200 steps, total: 39.558, sample: 0.180, forward: 0.459, backward: 27.622, update: 0.130
[proc 2] 200 steps, total: 39.558, sample: 0.163, forward: 0.378, backward: 24.156, update: 0.124
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 810.475 us                | 9.885 ms                  |
| Forward                   | 4.590 ms                  | 7.023 ms                  |
| Backward                  | 187.915 ms                | 403.671 ms                |
| Optimize                  | 1.333 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 76.761 ms                 | 170.491 ms                |
| BlockToStepN              | 9.862 us                  | 54.106 us                 |
| OneStep                   | 277.819 ms                | 540.751 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 811.546 us                | 9.885 ms                  |
| Forward                   | 4.597 ms                  | 7.023 ms                  |
| Backward                  | 198.682 ms                | 426.543 ms                |
| Optimize                  | 1.334 ms                  | 1.877 ms                  |
| BarrierTimeBeforeRank0    | 77.674 ms                 | 178.822 ms                |
| BlockToStepN              | 9.930 us                  | 61.964 us                 |
| OneStep                   | 284.477 ms                | 553.936 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 811.561 us                | 9.885 ms                  |
| Forward                   | 4.593 ms                  | 7.023 ms                  |
| Backward                  | 214.564 ms                | 432.665 ms                |
| Optimize                  | 1.334 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 80.563 ms                 | 185.589 ms                |
| BlockToStepN              | 10.232 us                 | 61.964 us                 |
| OneStep                   | 302.624 ms                | 571.779 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.128 us                | 9.885 ms                  |
| Forward                   | 4.599 ms                  | 7.023 ms                  |
| Backward                  | 217.949 ms                | 446.969 ms                |
| Optimize                  | 1.337 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 82.397 ms                 | 192.208 ms                |
| BlockToStepN              | 10.369 us                 | 61.964 us                 |
| OneStep                   | 306.766 ms                | 603.785 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.461 us                | 9.885 ms                  |
| Forward                   | 4.601 ms                  | 7.023 ms                  |
| Backward                  | 224.611 ms                | 474.112 ms                |
| Optimize                  | 1.338 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 85.561 ms                 | 198.269 ms                |
| BlockToStepN              | 10.769 us                 | 61.964 us                 |
| OneStep                   | 322.210 ms                | 617.229 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.333 us                | 9.885 ms                  |
| Forward                   | 4.601 ms                  | 7.023 ms                  |
| Backward                  | 229.964 ms                | 493.078 ms                |
| Optimize                  | 1.344 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 87.196 ms                 | 205.577 ms                |
| BlockToStepN              | 11.046 us                 | 61.964 us                 |
| OneStep                   | 328.538 ms                | 639.599 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.466 us                | 9.856 ms                  |
| Forward                   | 4.606 ms                  | 6.560 ms                  |
| Backward                  | 234.525 ms                | 497.114 ms                |
| Optimize                  | 1.347 ms                  | 1.908 ms                  |
| BarrierTimeBeforeRank0    | 90.308 ms                 | 209.908 ms                |
| BlockToStepN              | 11.428 us                 | 58.030 us                 |
| OneStep                   | 338.370 ms                | 652.724 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.547 us                | 9.856 ms                  |
| Forward                   | 4.608 ms                  | 6.560 ms                  |
| Backward                  | 239.982 ms                | 516.917 ms                |
| Optimize                  | 1.353 ms                  | 1.908 ms                  |
| BarrierTimeBeforeRank0    | 94.897 ms                 | 213.766 ms                |
| BlockToStepN              | 11.947 us                 | 58.030 us                 |
| OneStep                   | 357.873 ms                | 671.357 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 820.226 us                | 9.856 ms                  |
| Forward                   | 4.611 ms                  | 6.560 ms                  |
| Backward                  | 250.592 ms                | 549.858 ms                |
| Optimize                  | 1.362 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 98.304 ms                 | 220.304 ms                |
| BlockToStepN              | 12.057 us                 | 58.030 us                 |
| OneStep                   | 363.657 ms                | 687.354 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 820.226 us                | 9.856 ms                  |
| Forward                   | 4.612 ms                  | 6.560 ms                  |
| Backward                  | 253.854 ms                | 556.926 ms                |
| Optimize                  | 1.364 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 102.330 ms                | 223.486 ms                |
| BlockToStepN              | 12.193 us                 | 58.030 us                 |
| OneStep                   | 368.369 ms                | 704.253 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 828.049 us                | 9.856 ms                  |
| Forward                   | 4.614 ms                  | 6.560 ms                  |
| Backward                  | 260.502 ms                | 570.044 ms                |
| Optimize                  | 1.364 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 103.895 ms                | 232.082 ms                |
| BlockToStepN              | 12.310 us                 | 58.030 us                 |
| OneStep                   | 375.573 ms                | 723.910 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 828.049 us                | 9.856 ms                  |
| Forward                   | 4.616 ms                  | 6.560 ms                  |
| Backward                  | 268.360 ms                | 570.044 ms                |
| Optimize                  | 1.365 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 104.918 ms                | 245.223 ms                |
| BlockToStepN              | 12.977 us                 | 58.030 us                 |
| OneStep                   | 383.761 ms                | 745.179 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.638 us                | 9.856 ms                  |
| Forward                   | 4.619 ms                  | 6.560 ms                  |
| Backward                  | 268.647 ms                | 580.422 ms                |
| Optimize                  | 1.364 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 105.996 ms                | 252.089 ms                |
| BlockToStepN              | 12.977 us                 | 58.030 us                 |
| OneStep                   | 393.376 ms                | 759.834 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 64.855, sample: 0.151, forward: 0.404, backward: 64.072, update: 0.091
[proc 3] 300 steps, total: 64.855, sample: 0.158, forward: 0.394, backward: 62.518, update: 0.100
[proc 0] 300 steps, total: 64.855, sample: 0.175, forward: 0.476, backward: 45.595, update: 0.138
[proc 2] 300 steps, total: 64.855, sample: 0.153, forward: 0.370, backward: 39.648, update: 0.125
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.677 us                | 9.856 ms                  |
| Forward                   | 4.631 ms                  | 6.560 ms                  |
| Backward                  | 277.378 ms                | 586.357 ms                |
| Optimize                  | 1.364 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 106.741 ms                | 254.017 ms                |
| BlockToStepN              | 13.204 us                 | 58.030 us                 |
| OneStep                   | 403.865 ms                | 777.094 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.028 us                | 9.856 ms                  |
| Forward                   | 4.640 ms                  | 6.560 ms                  |
| Backward                  | 288.223 ms                | 628.733 ms                |
| Optimize                  | 1.365 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 107.290 ms                | 257.283 ms                |
| BlockToStepN              | 13.744 us                 | 58.030 us                 |
| OneStep                   | 409.741 ms                | 791.668 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.759 us                | 9.856 ms                  |
| Forward                   | 4.641 ms                  | 6.560 ms                  |
| Backward                  | 290.952 ms                | 635.174 ms                |
| Optimize                  | 1.366 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 109.118 ms                | 261.216 ms                |
| BlockToStepN              | 14.028 us                 | 58.030 us                 |
| OneStep                   | 416.086 ms                | 809.548 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 830.759 us                | 9.856 ms                  |
| Forward                   | 4.655 ms                  | 6.560 ms                  |
| Backward                  | 296.040 ms                | 637.374 ms                |
| Optimize                  | 1.367 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 112.971 ms                | 263.407 ms                |
| BlockToStepN              | 14.249 us                 | 58.030 us                 |
| OneStep                   | 424.995 ms                | 823.882 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.387 us                | 9.856 ms                  |
| Forward                   | 4.662 ms                  | 6.560 ms                  |
| Backward                  | 299.697 ms                | 649.159 ms                |
| Optimize                  | 1.368 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 114.726 ms                | 268.456 ms                |
| BlockToStepN              | 14.467 us                 | 58.030 us                 |
| OneStep                   | 433.242 ms                | 841.413 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.387 us                | 9.856 ms                  |
| Forward                   | 4.662 ms                  | 6.560 ms                  |
| Backward                  | 304.032 ms                | 657.907 ms                |
| Optimize                  | 1.368 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 115.234 ms                | 271.518 ms                |
| BlockToStepN              | 14.548 us                 | 58.030 us                 |
| OneStep                   | 443.619 ms                | 851.652 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.387 us                | 9.856 ms                  |
| Forward                   | 4.662 ms                  | 6.560 ms                  |
| Backward                  | 307.211 ms                | 681.228 ms                |
| Optimize                  | 1.371 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 117.196 ms                | 277.715 ms                |
| BlockToStepN              | 14.548 us                 | 58.030 us                 |
| OneStep                   | 444.898 ms                | 866.775 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.391 us                | 9.856 ms                  |
| Forward                   | 4.662 ms                  | 6.560 ms                  |
| Backward                  | 311.299 ms                | 681.228 ms                |
| Optimize                  | 1.372 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 119.105 ms                | 286.280 ms                |
| BlockToStepN              | 14.684 us                 | 58.030 us                 |
| OneStep                   | 455.116 ms                | 886.271 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.387 us                | 9.701 ms                  |
| Forward                   | 4.663 ms                  | 6.361 ms                  |
| Backward                  | 315.335 ms                | 696.110 ms                |
| Optimize                  | 1.374 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 121.906 ms                | 289.042 ms                |
| BlockToStepN              | 14.978 us                 | 58.030 us                 |
| OneStep                   | 459.688 ms                | 901.548 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.387 us                | 9.701 ms                  |
| Forward                   | 4.663 ms                  | 6.361 ms                  |
| Backward                  | 321.445 ms                | 696.707 ms                |
| Optimize                  | 1.374 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 124.910 ms                | 297.581 ms                |
| BlockToStepN              | 15.088 us                 | 54.106 us                 |
| OneStep                   | 469.600 ms                | 906.803 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.627 us                | 9.701 ms                  |
| Forward                   | 4.663 ms                  | 6.361 ms                  |
| Backward                  | 328.013 ms                | 707.605 ms                |
| Optimize                  | 1.376 ms                  | 1.975 ms                  |
| BarrierTimeBeforeRank0    | 126.115 ms                | 302.717 ms                |
| BlockToStepN              | 15.194 us                 | 54.106 us                 |
| OneStep                   | 478.888 ms                | 927.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.627 us                | 9.701 ms                  |
| Forward                   | 4.666 ms                  | 6.361 ms                  |
| Backward                  | 333.201 ms                | 719.045 ms                |
| Optimize                  | 1.376 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 127.090 ms                | 303.479 ms                |
| BlockToStepN              | 15.368 us                 | 54.106 us                 |
| OneStep                   | 483.822 ms                | 936.561 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.391 us                | 9.701 ms                  |
| Forward                   | 4.667 ms                  | 6.361 ms                  |
| Backward                  | 342.745 ms                | 724.641 ms                |
| Optimize                  | 1.377 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 129.346 ms                | 308.242 ms                |
| BlockToStepN              | 15.420 us                 | 54.106 us                 |
| OneStep                   | 490.415 ms                | 952.873 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 834.043 us                | 9.701 ms                  |
| Forward                   | 4.669 ms                  | 6.361 ms                  |
| Backward                  | 346.927 ms                | 739.521 ms                |
| Optimize                  | 1.378 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 132.433 ms                | 320.856 ms                |
| BlockToStepN              | 15.420 us                 | 54.106 us                 |
| OneStep                   | 495.526 ms                | 962.999 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.391 us                | 9.701 ms                  |
| Forward                   | 4.669 ms                  | 6.361 ms                  |
| Backward                  | 347.212 ms                | 749.678 ms                |
| Optimize                  | 1.378 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 133.388 ms                | 321.660 ms                |
| BlockToStepN              | 15.420 us                 | 54.106 us                 |
| OneStep                   | 504.043 ms                | 977.682 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.391 us                | 9.701 ms                  |
| Forward                   | 4.670 ms                  | 6.361 ms                  |
| Backward                  | 351.705 ms                | 768.343 ms                |
| Optimize                  | 1.380 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 134.180 ms                | 329.627 ms                |
| BlockToStepN              | 15.495 us                 | 54.106 us                 |
| OneStep                   | 508.506 ms                | 984.198 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.391 us                | 9.701 ms                  |
| Forward                   | 4.670 ms                  | 6.361 ms                  |
| Backward                  | 354.398 ms                | 770.635 ms                |
| Optimize                  | 1.380 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 135.484 ms                | 330.601 ms                |
| BlockToStepN              | 15.705 us                 | 54.106 us                 |
| OneStep                   | 512.420 ms                | 997.908 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.391 us                | 9.701 ms                  |
| Forward                   | 4.675 ms                  | 6.361 ms                  |
| Backward                  | 362.070 ms                | 777.228 ms                |
| Optimize                  | 1.380 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 136.238 ms                | 330.684 ms                |
| BlockToStepN              | 15.705 us                 | 54.106 us                 |
| OneStep                   | 520.462 ms                | 1.014 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 400 steps, total: 90.228, sample: 0.175, forward: 0.476, backward: 65.067, update: 0.143
[proc 3] 400 steps, total: 90.228, sample: 0.153, forward: 0.385, backward: 86.984, update: 0.102
[proc 1] 400 steps, total: 90.228, sample: 0.166, forward: 0.398, backward: 89.496, update: 0.093
[proc 2] 400 steps, total: 90.228, sample: 0.155, forward: 0.375, backward: 55.250, update: 0.126
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 831.391 us                | 9.701 ms                  |
| Forward                   | 4.675 ms                  | 6.361 ms                  |
| Backward                  | 366.354 ms                | 786.106 ms                |
| Optimize                  | 1.380 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 138.226 ms                | 332.533 ms                |
| BlockToStepN              | 15.705 us                 | 54.106 us                 |
| OneStep                   | 531.543 ms                | 1.024 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 834.043 us                | 9.701 ms                  |
| Forward                   | 4.677 ms                  | 6.361 ms                  |
| Backward                  | 368.374 ms                | 802.256 ms                |
| Optimize                  | 1.378 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 139.001 ms                | 338.133 ms                |
| BlockToStepN              | 15.705 us                 | 54.106 us                 |
| OneStep                   | 536.506 ms                | 1.039 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.627 us                | 9.701 ms                  |
| Forward                   | 4.688 ms                  | 6.361 ms                  |
| Backward                  | 372.991 ms                | 806.900 ms                |
| Optimize                  | 1.380 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 141.780 ms                | 341.156 ms                |
| BlockToStepN              | 15.705 us                 | 54.106 us                 |
| OneStep                   | 540.751 ms                | 1.051 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.627 us                | 9.701 ms                  |
| Forward                   | 4.698 ms                  | 6.361 ms                  |
| Backward                  | 375.741 ms                | 818.321 ms                |
| Optimize                  | 1.380 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 144.367 ms                | 348.398 ms                |
| BlockToStepN              | 15.718 us                 | 54.106 us                 |
| OneStep                   | 543.474 ms                | 1.067 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 834.043 us                | 9.701 ms                  |
| Forward                   | 4.702 ms                  | 6.361 ms                  |
| Backward                  | 382.777 ms                | 824.828 ms                |
| Optimize                  | 1.381 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 146.396 ms                | 349.276 ms                |
| BlockToStepN              | 15.777 us                 | 54.106 us                 |
| OneStep                   | 553.936 ms                | 1.073 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 834.043 us                | 9.701 ms                  |
| Forward                   | 4.702 ms                  | 6.361 ms                  |
| Backward                  | 387.454 ms                | 838.255 ms                |
| Optimize                  | 1.382 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 149.343 ms                | 354.472 ms                |
| BlockToStepN              | 15.851 us                 | 54.106 us                 |
| OneStep                   | 562.648 ms                | 1.087 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.880 us                | 9.701 ms                  |
| Forward                   | 4.702 ms                  | 6.361 ms                  |
| Backward                  | 392.464 ms                | 841.696 ms                |
| Optimize                  | 1.382 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 150.821 ms                | 354.817 ms                |
| BlockToStepN              | 15.936 us                 | 54.106 us                 |
| OneStep                   | 565.868 ms                | 1.098 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.880 us                | 9.701 ms                  |
| Forward                   | 4.708 ms                  | 6.429 ms                  |
| Backward                  | 398.491 ms                | 870.884 ms                |
| Optimize                  | 1.381 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 151.512 ms                | 365.163 ms                |
| BlockToStepN              | 15.851 us                 | 57.170 us                 |
| OneStep                   | 566.143 ms                | 1.109 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.880 us                | 9.701 ms                  |
| Forward                   | 4.711 ms                  | 7.005 ms                  |
| Backward                  | 401.253 ms                | 875.914 ms                |
| Optimize                  | 1.381 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 152.927 ms                | 367.683 ms                |
| BlockToStepN              | 15.911 us                 | 57.170 us                 |
| OneStep                   | 571.779 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.880 us                | 9.701 ms                  |
| Forward                   | 4.711 ms                  | 7.023 ms                  |
| Backward                  | 403.671 ms                | 880.642 ms                |
| Optimize                  | 1.383 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 153.305 ms                | 381.002 ms                |
| BlockToStepN              | 15.911 us                 | 57.170 us                 |
| OneStep                   | 578.225 ms                | 1.158 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.880 us                | 9.701 ms                  |
| Forward                   | 4.711 ms                  | 7.023 ms                  |
| Backward                  | 408.426 ms                | 880.642 ms                |
| Optimize                  | 1.382 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 155.231 ms                | 381.640 ms                |
| BlockToStepN              | 15.936 us                 | 57.170 us                 |
| OneStep                   | 583.965 ms                | 1.171 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 832.880 us                | 9.699 ms                  |
| Forward                   | 4.712 ms                  | 7.005 ms                  |
| Backward                  | 412.357 ms                | 881.897 ms                |
| Optimize                  | 1.382 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 157.216 ms                | 397.429 ms                |
| BlockToStepN              | 16.049 us                 | 54.106 us                 |
| OneStep                   | 594.161 ms                | 1.177 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 834.043 us                | 9.699 ms                  |
| Forward                   | 4.711 ms                  | 7.005 ms                  |
| Backward                  | 414.410 ms                | 899.947 ms                |
| Optimize                  | 1.381 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 159.052 ms                | 397.469 ms                |
| BlockToStepN              | 15.938 us                 | 54.106 us                 |
| OneStep                   | 602.156 ms                | 1.179 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 834.043 us                | 9.699 ms                  |
| Forward                   | 4.712 ms                  | 7.005 ms                  |
| Backward                  | 415.656 ms                | 901.823 ms                |
| Optimize                  | 1.381 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 160.208 ms                | 399.808 ms                |
| BlockToStepN              | 15.938 us                 | 54.106 us                 |
| OneStep                   | 603.869 ms                | 1.181 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.047 us                | 9.699 ms                  |
| Forward                   | 4.712 ms                  | 7.005 ms                  |
| Backward                  | 417.329 ms                | 915.768 ms                |
| Optimize                  | 1.381 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 161.322 ms                | 402.104 ms                |
| BlockToStepN              | 15.938 us                 | 54.106 us                 |
| OneStep                   | 607.880 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.047 us                | 9.699 ms                  |
| Forward                   | 4.721 ms                  | 7.005 ms                  |
| Backward                  | 419.983 ms                | 918.530 ms                |
| Optimize                  | 1.380 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 163.348 ms                | 402.241 ms                |
| BlockToStepN              | 15.994 us                 | 54.106 us                 |
| OneStep                   | 610.534 ms                | 1.204 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.047 us                | 9.699 ms                  |
| Forward                   | 4.721 ms                  | 7.005 ms                  |
| Backward                  | 422.746 ms                | 918.530 ms                |
| Optimize                  | 1.380 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 164.104 ms                | 408.558 ms                |
| BlockToStepN              | 15.994 us                 | 54.106 us                 |
| OneStep                   | 617.229 ms                | 1.222 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.047 us                | 9.699 ms                  |
| Forward                   | 4.721 ms                  | 7.005 ms                  |
| Backward                  | 426.675 ms                | 935.731 ms                |
| Optimize                  | 1.380 ms                  | 1.993 ms                  |
| BarrierTimeBeforeRank0    | 167.492 ms                | 408.957 ms                |
| BlockToStepN              | 15.994 us                 | 54.106 us                 |
| OneStep                   | 620.296 ms                | 1.224 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.047 us                | 9.699 ms                  |
| Forward                   | 4.731 ms                  | 7.023 ms                  |
| Backward                  | 431.767 ms                | 953.600 ms                |
| Optimize                  | 1.380 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 168.296 ms                | 410.293 ms                |
| BlockToStepN              | 16.049 us                 | 57.170 us                 |
| OneStep                   | 626.199 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.637 us                | 9.699 ms                  |
| Forward                   | 4.736 ms                  | 7.023 ms                  |
| Backward                  | 433.071 ms                | 958.248 ms                |
| Optimize                  | 1.381 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 170.421 ms                | 412.885 ms                |
| BlockToStepN              | 16.057 us                 | 57.170 us                 |
| OneStep                   | 629.627 ms                | 1.261 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.649 us                | 9.699 ms                  |
| Forward                   | 4.736 ms                  | 7.023 ms                  |
| Backward                  | 434.472 ms                | 966.716 ms                |
| Optimize                  | 1.382 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 171.131 ms                | 419.414 ms                |
| BlockToStepN              | 16.049 us                 | 57.170 us                 |
| OneStep                   | 639.599 ms                | 1.261 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.649 us                | 9.699 ms                  |
| Forward                   | 4.741 ms                  | 7.023 ms                  |
| Backward                  | 438.369 ms                | 981.631 ms                |
| Optimize                  | 1.383 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 176.835 ms                | 419.414 ms                |
| BlockToStepN              | 16.057 us                 | 57.170 us                 |
| OneStep                   | 644.991 ms                | 1.263 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.842 us                | 9.699 ms                  |
| Forward                   | 4.741 ms                  | 7.023 ms                  |
| Backward                  | 442.067 ms                | 985.507 ms                |
| Optimize                  | 1.383 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 178.211 ms                | 423.350 ms                |
| BlockToStepN              | 16.084 us                 | 57.170 us                 |
| OneStep                   | 647.126 ms                | 1.266 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 116.343, sample: 0.170, forward: 0.376, backward: 71.084, update: 0.127
[proc 3] 500 steps, total: 116.343, sample: 0.153, forward: 0.387, backward: 110.081, update: 0.108
[proc 1] 500 steps, total: 116.343, sample: 0.158, forward: 0.413, backward: 115.592, update: 0.106
[proc 0] 500 steps, total: 116.343, sample: 0.175, forward: 0.491, backward: 84.786, update: 0.140
Successfully xmh. training takes 328.1082122325897 seconds
before call kg_cache_controller.StopThreads()
INFO [472147 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
INFO [472147 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 835.842 us                | 9.699 ms                  |
| Forward                   | 4.736 ms                  | 7.023 ms                  |
| Backward                  | 446.969 ms                | 993.103 ms                |
| Optimize                  | 1.386 ms                  | 2.015 ms                  |
| BarrierTimeBeforeRank0    | 178.822 ms                | 423.350 ms                |
| BlockToStepN              | 16.057 us                 | 57.170 us                 |
| OneStep                   | 649.662 ms                | 1.272 s                   |
+---------------------------+---------------------------+---------------------------+
