WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 18:16:23.089970 627058 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_28', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [627058 sampler.py:454] Start PreSampling
WARNING [627058 sampler.py:532] Before construct renumbering_dict
WARNING [627058 sampler.py:555] PreSampling done
W20240128 18:16:25.600515 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 18:16:25.600651 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 18:16:25.600674 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 18:16:25.600692 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 18:16:25.600713 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 18:16:25.600731 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 18:16:25.600747 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 18:16:25.600773 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 18:16:25.600790 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 18:16:25.600807 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 18:16:25.600829 627058 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 18:16:25.600847 627058 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 18:16:25.600865 627058 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 18:16:25.600946 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 18:16:25.600967 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 18:16:25.600982 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 18:16:25.601013 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 18:16:25.601028 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 18:16:25.601043 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 18:16:25.601064 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 18:16:25.601083 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 18:16:25.601097 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 18:16:25.601114 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 18:16:25.601136 627058 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 18:16:25.601150 627058 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 18:16:25.601166 627058 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 18:16:25.601207 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 18:16:25.601231 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 18:16:25.601246 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 18:16:25.601261 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 18:16:25.601279 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 18:16:25.601294 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 18:16:25.601312 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 18:16:25.601336 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 18:16:25.601356 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 18:16:25.601375 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 18:16:25.601392 627058 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 18:16:25.601405 627058 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 18:16:25.601420 627058 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 18:16:25.601456 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 18:16:25.601482 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 18:16:25.601498 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 18:16:25.601512 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 18:16:25.601531 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 18:16:25.601552 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 18:16:25.601567 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 18:16:25.601580 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 18:16:25.601598 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 18:16:25.601621 627058 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 18:16:25.601639 627058 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 18:16:25.601651 627058 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 18:16:25.601665 627058 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 18:16:25.730399 627058 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 18:16:25.730532 627058 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 186
Rank1: cached key size 186
Rank2: cached key size 186
Rank3: cached key size 186
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 892, 1159, 1245,  ..., 1750, 5514, 6916]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.674 seconds
[Rank1] pid = 627268
[Rank2] pid = 627333
INFO [627058 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [627333 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [627268 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [627397 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [627397 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [627397 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [627397 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [627397 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [627058 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [627333 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [627058 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [627268 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [627268 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [627333 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [627058 cache_common.py:139] TorchNativeStdEmb construct done
INFO [627268 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [627268 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [627058 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [627333 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [627333 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 18:16:28.971359 627334 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 18:16:28.971467 627269 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 18:16:28.971581 627399 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 18:16:28.971697 627398 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240128 18:16:29.339393 627399 recstore.cc:66] init folly done
E20240128 18:16:29.339411 627398 recstore.cc:66] init folly done
E20240128 18:16:29.339524 627269 recstore.cc:66] init folly done
E20240128 18:16:29.339576 627334 recstore.cc:66] init folly done
I20240128 18:16:29.391417 627399 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 18:16:29.395078 627269 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 18:16:29.409621 627334 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 18:16:29.415611 627398 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 777.104 us                | 10.955 ms                 |
| Forward                   | 4.498 ms                  | 754.689 ms                |
| Backward                  | 58.495 ms                 | 1.525 s                   |
| Optimize                  | 1.234 ms                  | 70.308 ms                 |
| BarrierTimeBeforeRank0    | 46.495 us                 | 5.126 ms                  |
| BlockToStepN              | 9.308 us                  | 48.333 us                 |
| OneStep                   | 65.173 ms                 | 1.539 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 730.100 us                | 9.594 ms                  |
| Forward                   | 4.372 ms                  | 9.958 ms                  |
| Backward                  | 95.549 ms                 | 342.371 ms                |
| Optimize                  | 1.118 ms                  | 2.355 ms                  |
| BarrierTimeBeforeRank0    | 39.852 us                 | 7.678 ms                  |
| BlockToStepN              | 9.631 us                  | 56.009 us                 |
| OneStep                   | 107.524 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 728.692 us                | 9.594 ms                  |
| Forward                   | 4.344 ms                  | 9.958 ms                  |
| Backward                  | 128.974 ms                | 342.371 ms                |
| Optimize                  | 1.109 ms                  | 2.355 ms                  |
| BarrierTimeBeforeRank0    | 36.398 us                 | 11.101 ms                 |
| BlockToStepN              | 9.781 us                  | 56.009 us                 |
| OneStep                   | 137.526 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
[Rank3] pid = 627397
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241), (2241, 2988)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 9534,  3879,  9473,  7716,  6847,  4907,   734,  4521, 11044,  8803]) tensor([ 1245,  7145,  9545,   678,  7032,  9053, 13971,  9415,  7492,  8094])
-------Step 1-------
tensor([ 9534,  3879,  9473,  7716,  6847,  4907,   734,  4521, 11044,  8803]) tensor([ 6271, 12309, 11173, 14829,  7447,  9264,  5189,  1837,  2124,  7702])
-------Step 2-------
tensor([ 8201,  1901,  3625,    52,  8253,  9003,  4755,  9730, 11565,  9662]) tensor([11119,  3200,  3439, 12443,  1696,  2136, 12504,  6815, 10192,  7872])
-------Step 3-------
tensor([ 8201,  1901,  3625,    52,  8253,  9003,  4755,  9730, 11565,  9662]) tensor([ 5076, 10822,  6555, 13808,  2125, 11708,  1621, 13432,  5092,    53])
-------Step 4-------
tensor([  154, 14266, 13222, 11148,  4529,  5762, 11370,  6116,  3359,  1470]) tensor([13378,  4576, 11342, 11437,  3280,  8743,  5672,   542,  8711, 13839])
-------Step 5-------
tensor([  154, 14266, 13222, 11148,  4529,  5762, 11370,  6116,  3359,  1470]) tensor([ 6232,  7038,  8535, 12996,  8125, 11121,  2768, 14085,  7870,  5571])
-------Step 6-------
tensor([11969,  3885,   379,    29, 11738, 10708, 14112, 13222, 10561,  7190]) tensor([ 2874,  7528,  6003, 10334,  9759, 11803,  1225,  1905, 11333, 12971])
-------Step 7-------
tensor([11969,  3885,   379,    29, 11738, 10708, 14112, 13222, 10561,  7190]) tensor([ 4603, 12980, 10191,  6799,  5059,   469,  7369,  6789, 11369, 13745])
-------Step 8-------
tensor([ 8858, 10361, 12104,  9043,  5539,  7437,  1041,  4878,  4838, 13716]) tensor([  379, 10033, 13257,  1040,  9921, 10194,  1565, 10233,  7418,  8831])
-------Step 9-------
tensor([ 8858, 10361, 12104,  9043,  5539,  7437,  1041,  4878,  4838, 13716]) tensor([10967, 11771,   975,  3300,  2007, 10890,  6352,  2308,  2124, 12987])
before start barrier
start train
[proc 0] 100 steps, total: 17.281, sample: 0.164, forward: 1.195, backward: 15.525, update: 0.175
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 17.306, sample: 0.162, forward: 1.136, backward: 15.089, update: 0.150
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 17.302, sample: 0.168, forward: 1.194, backward: 11.366, update: 0.131
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 17.287, sample: 0.168, forward: 1.159, backward: 11.089, update: 0.162
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 730.100 us                | 9.594 ms                  |
| Forward                   | 4.327 ms                  | 9.958 ms                  |
| Backward                  | 148.505 ms                | 342.371 ms                |
| Optimize                  | 1.098 ms                  | 2.355 ms                  |
| BarrierTimeBeforeRank0    | 33.989 us                 | 11.101 ms                 |
| BlockToStepN              | 9.903 us                  | 56.009 us                 |
| OneStep                   | 159.605 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 732.272 us                | 9.594 ms                  |
| Forward                   | 4.335 ms                  | 9.958 ms                  |
| Backward                  | 168.615 ms                | 342.371 ms                |
| Optimize                  | 1.099 ms                  | 2.355 ms                  |
| BarrierTimeBeforeRank0    | 33.096 us                 | 11.101 ms                 |
| BlockToStepN              | 10.102 us                 | 61.620 us                 |
| OneStep                   | 177.062 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 736.825 us                | 9.594 ms                  |
| Forward                   | 4.337 ms                  | 9.958 ms                  |
| Backward                  | 189.856 ms                | 373.247 ms                |
| Optimize                  | 1.107 ms                  | 2.355 ms                  |
| BarrierTimeBeforeRank0    | 31.598 us                 | 11.101 ms                 |
| BlockToStepN              | 10.218 us                 | 61.620 us                 |
| OneStep                   | 198.259 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.095 us                | 8.071 ms                  |
| Forward                   | 4.337 ms                  | 8.441 ms                  |
| Backward                  | 201.462 ms                | 401.877 ms                |
| Optimize                  | 1.107 ms                  | 2.355 ms                  |
| BarrierTimeBeforeRank0    | 30.376 us                 | 11.101 ms                 |
| BlockToStepN              | 10.311 us                 | 61.620 us                 |
| OneStep                   | 210.524 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.272 us                | 8.071 ms                  |
| Forward                   | 4.337 ms                  | 8.441 ms                  |
| Backward                  | 218.592 ms                | 422.717 ms                |
| Optimize                  | 1.107 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.455 us                 | 8.097 ms                  |
| BlockToStepN              | 10.461 us                 | 56.009 us                 |
| OneStep                   | 227.333 ms                | 437.594 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.272 us                | 8.071 ms                  |
| Forward                   | 4.335 ms                  | 8.441 ms                  |
| Backward                  | 234.803 ms                | 456.507 ms                |
| Optimize                  | 1.107 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.376 us                 | 8.097 ms                  |
| BlockToStepN              | 10.639 us                 | 56.009 us                 |
| OneStep                   | 245.088 ms                | 469.962 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 743.917 us                | 8.071 ms                  |
| Forward                   | 4.344 ms                  | 8.441 ms                  |
| Backward                  | 246.226 ms                | 475.819 ms                |
| Optimize                  | 1.112 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.376 us                 | 8.097 ms                  |
| BlockToStepN              | 10.675 us                 | 56.009 us                 |
| OneStep                   | 253.131 ms                | 489.275 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 744.772 us                | 8.071 ms                  |
| Forward                   | 4.359 ms                  | 8.441 ms                  |
| Backward                  | 262.735 ms                | 510.516 ms                |
| Optimize                  | 1.112 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.158 us                 | 8.097 ms                  |
| BlockToStepN              | 10.675 us                 | 56.009 us                 |
| OneStep                   | 269.641 ms                | 532.048 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 40.305, sample: 0.165, forward: 0.371, backward: 25.336, update: 0.111
[proc 1] 200 steps, total: 40.305, sample: 0.167, forward: 0.379, backward: 25.972, update: 0.090
[proc 3] 200 steps, total: 40.305, sample: 0.160, forward: 0.365, backward: 36.539, update: 0.117
[proc 0] 200 steps, total: 40.305, sample: 0.172, forward: 0.436, backward: 39.508, update: 0.109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 744.910 us                | 8.071 ms                  |
| Forward                   | 4.359 ms                  | 8.441 ms                  |
| Backward                  | 274.895 ms                | 538.332 ms                |
| Optimize                  | 1.117 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.075 us                 | 8.097 ms                  |
| BlockToStepN              | 10.818 us                 | 56.009 us                 |
| OneStep                   | 282.632 ms                | 551.900 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 744.772 us                | 8.071 ms                  |
| Forward                   | 4.359 ms                  | 8.441 ms                  |
| Backward                  | 286.061 ms                | 566.405 ms                |
| Optimize                  | 1.113 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.285 us                 | 8.097 ms                  |
| BlockToStepN              | 10.931 us                 | 56.009 us                 |
| OneStep                   | 292.275 ms                | 584.771 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 747.335 us                | 8.071 ms                  |
| Forward                   | 4.359 ms                  | 8.441 ms                  |
| Backward                  | 296.553 ms                | 588.955 ms                |
| Optimize                  | 1.119 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.376 us                 | 8.097 ms                  |
| BlockToStepN              | 11.008 us                 | 56.009 us                 |
| OneStep                   | 303.288 ms                | 604.590 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 747.335 us                | 8.071 ms                  |
| Forward                   | 4.344 ms                  | 8.441 ms                  |
| Backward                  | 308.653 ms                | 596.566 ms                |
| Optimize                  | 1.119 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.285 us                 | 8.097 ms                  |
| BlockToStepN              | 11.206 us                 | 59.861 us                 |
| OneStep                   | 315.334 ms                | 604.590 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 747.635 us                | 8.071 ms                  |
| Forward                   | 4.364 ms                  | 8.441 ms                  |
| Backward                  | 318.896 ms                | 625.681 ms                |
| Optimize                  | 1.122 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.158 us                 | 8.097 ms                  |
| BlockToStepN              | 11.397 us                 | 59.861 us                 |
| OneStep                   | 329.201 ms                | 636.215 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 747.593 us                | 8.071 ms                  |
| Forward                   | 4.364 ms                  | 8.441 ms                  |
| Backward                  | 327.844 ms                | 640.529 ms                |
| Optimize                  | 1.122 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.075 us                 | 8.097 ms                  |
| BlockToStepN              | 11.553 us                 | 59.861 us                 |
| OneStep                   | 334.559 ms                | 648.009 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 747.831 us                | 8.006 ms                  |
| Forward                   | 4.372 ms                  | 7.108 ms                  |
| Backward                  | 342.371 ms                | 651.588 ms                |
| Optimize                  | 1.123 ms                  | 1.618 ms                  |
| BarrierTimeBeforeRank0    | 30.132 us                 | 7.678 ms                  |
| BlockToStepN              | 11.694 us                 | 56.009 us                 |
| OneStep                   | 349.663 ms                | 671.591 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 750.825 us                | 8.006 ms                  |
| Forward                   | 4.373 ms                  | 7.108 ms                  |
| Backward                  | 345.836 ms                | 682.053 ms                |
| Optimize                  | 1.127 ms                  | 1.618 ms                  |
| BarrierTimeBeforeRank0    | 30.075 us                 | 7.678 ms                  |
| BlockToStepN              | 11.930 us                 | 59.861 us                 |
| OneStep                   | 353.370 ms                | 690.805 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 752.002 us                | 8.006 ms                  |
| Forward                   | 4.393 ms                  | 7.108 ms                  |
| Backward                  | 356.593 ms                | 685.390 ms                |
| Optimize                  | 1.134 ms                  | 1.618 ms                  |
| BarrierTimeBeforeRank0    | 30.109 us                 | 7.678 ms                  |
| BlockToStepN              | 12.239 us                 | 59.861 us                 |
| OneStep                   | 367.179 ms                | 699.428 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 752.902 us                | 8.006 ms                  |
| Forward                   | 4.398 ms                  | 7.108 ms                  |
| Backward                  | 364.666 ms                | 710.749 ms                |
| Optimize                  | 1.136 ms                  | 1.618 ms                  |
| BarrierTimeBeforeRank0    | 30.132 us                 | 7.678 ms                  |
| BlockToStepN              | 12.380 us                 | 59.861 us                 |
| OneStep                   | 377.239 ms                | 719.110 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 752.902 us                | 8.006 ms                  |
| Forward                   | 4.399 ms                  | 7.108 ms                  |
| Backward                  | 372.445 ms                | 726.834 ms                |
| Optimize                  | 1.142 ms                  | 1.618 ms                  |
| BarrierTimeBeforeRank0    | 30.132 us                 | 7.678 ms                  |
| BlockToStepN              | 12.867 us                 | 59.861 us                 |
| OneStep                   | 382.988 ms                | 737.965 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 756.889 us                | 8.006 ms                  |
| Forward                   | 4.404 ms                  | 7.108 ms                  |
| Backward                  | 382.300 ms                | 743.608 ms                |
| Optimize                  | 1.152 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 30.158 us                 | 7.678 ms                  |
| BlockToStepN              | 13.282 us                 | 59.861 us                 |
| OneStep                   | 389.985 ms                | 763.821 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 761.258 us                | 8.978 ms                  |
| Forward                   | 4.408 ms                  | 7.108 ms                  |
| Backward                  | 385.280 ms                | 759.812 ms                |
| Optimize                  | 1.152 ms                  | 1.626 ms                  |
| BarrierTimeBeforeRank0    | 30.285 us                 | 7.678 ms                  |
| BlockToStepN              | 13.711 us                 | 59.861 us                 |
| OneStep                   | 403.870 ms                | 775.543 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 66.021, sample: 0.163, forward: 0.446, backward: 65.214, update: 0.115
[proc 3] 300 steps, total: 66.021, sample: 0.151, forward: 0.358, backward: 59.856, update: 0.117
[proc 2] 300 steps, total: 66.022, sample: 0.155, forward: 0.366, backward: 41.407, update: 0.112
[proc 1] 300 steps, total: 66.022, sample: 0.155, forward: 0.380, backward: 42.510, update: 0.097
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 761.258 us                | 8.978 ms                  |
| Forward                   | 4.425 ms                  | 7.108 ms                  |
| Backward                  | 399.433 ms                | 782.260 ms                |
| Optimize                  | 1.154 ms                  | 1.627 ms                  |
| BarrierTimeBeforeRank0    | 30.376 us                 | 7.678 ms                  |
| BlockToStepN              | 13.989 us                 | 61.620 us                 |
| OneStep                   | 408.813 ms                | 791.973 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 761.258 us                | 8.978 ms                  |
| Forward                   | 4.436 ms                  | 7.108 ms                  |
| Backward                  | 406.773 ms                | 787.659 ms                |
| Optimize                  | 1.156 ms                  | 1.627 ms                  |
| BarrierTimeBeforeRank0    | 30.455 us                 | 7.678 ms                  |
| BlockToStepN              | 14.056 us                 | 61.620 us                 |
| OneStep                   | 415.662 ms                | 795.759 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 761.492 us                | 8.978 ms                  |
| Forward                   | 4.448 ms                  | 7.108 ms                  |
| Backward                  | 411.087 ms                | 806.549 ms                |
| Optimize                  | 1.165 ms                  | 1.627 ms                  |
| BarrierTimeBeforeRank0    | 30.533 us                 | 7.678 ms                  |
| BlockToStepN              | 14.083 us                 | 64.424 us                 |
| OneStep                   | 419.560 ms                | 817.747 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 761.971 us                | 8.978 ms                  |
| Forward                   | 4.451 ms                  | 7.108 ms                  |
| Backward                  | 420.961 ms                | 822.921 ms                |
| Optimize                  | 1.165 ms                  | 1.627 ms                  |
| BarrierTimeBeforeRank0    | 30.533 us                 | 7.678 ms                  |
| BlockToStepN              | 14.242 us                 | 64.424 us                 |
| OneStep                   | 429.310 ms                | 832.489 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 762.951 us                | 8.978 ms                  |
| Forward                   | 4.455 ms                  | 7.108 ms                  |
| Backward                  | 429.289 ms                | 845.478 ms                |
| Optimize                  | 1.167 ms                  | 1.627 ms                  |
| BarrierTimeBeforeRank0    | 30.762 us                 | 7.678 ms                  |
| BlockToStepN              | 14.285 us                 | 64.424 us                 |
| OneStep                   | 437.594 ms                | 858.042 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 763.424 us                | 8.978 ms                  |
| Forward                   | 4.459 ms                  | 7.108 ms                  |
| Backward                  | 436.032 ms                | 852.139 ms                |
| Optimize                  | 1.167 ms                  | 1.627 ms                  |
| BarrierTimeBeforeRank0    | 30.762 us                 | 7.678 ms                  |
| BlockToStepN              | 14.418 us                 | 64.424 us                 |
| OneStep                   | 446.450 ms                | 866.586 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 763.424 us                | 8.978 ms                  |
| Forward                   | 4.455 ms                  | 7.108 ms                  |
| Backward                  | 442.595 ms                | 868.735 ms                |
| Optimize                  | 1.165 ms                  | 1.627 ms                  |
| BarrierTimeBeforeRank0    | 30.533 us                 | 7.678 ms                  |
| BlockToStepN              | 14.664 us                 | 64.424 us                 |
| OneStep                   | 454.758 ms                | 886.619 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 763.773 us                | 8.978 ms                  |
| Forward                   | 4.459 ms                  | 7.108 ms                  |
| Backward                  | 451.077 ms                | 889.374 ms                |
| Optimize                  | 1.167 ms                  | 1.627 ms                  |
| BarrierTimeBeforeRank0    | 30.762 us                 | 7.678 ms                  |
| BlockToStepN              | 14.770 us                 | 64.424 us                 |
| OneStep                   | 459.225 ms                | 898.096 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 763.895 us                | 8.978 ms                  |
| Forward                   | 4.459 ms                  | 7.108 ms                  |
| Backward                  | 459.428 ms                | 896.447 ms                |
| Optimize                  | 1.167 ms                  | 1.627 ms                  |
| BarrierTimeBeforeRank0    | 30.589 us                 | 7.678 ms                  |
| BlockToStepN              | 15.000 us                 | 64.424 us                 |
| OneStep                   | 469.929 ms                | 906.223 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 763.895 us                | 8.296 ms                  |
| Forward                   | 4.462 ms                  | 5.714 ms                  |
| Backward                  | 464.010 ms                | 911.958 ms                |
| Optimize                  | 1.167 ms                  | 1.626 ms                  |
| BarrierTimeBeforeRank0    | 30.762 us                 | 7.649 ms                  |
| BlockToStepN              | 15.099 us                 | 61.620 us                 |
| OneStep                   | 474.670 ms                | 922.428 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 765.078 us                | 8.296 ms                  |
| Forward                   | 4.466 ms                  | 5.714 ms                  |
| Backward                  | 472.568 ms                | 920.841 ms                |
| Optimize                  | 1.167 ms                  | 1.646 ms                  |
| BarrierTimeBeforeRank0    | 30.810 us                 | 7.649 ms                  |
| BlockToStepN              | 15.261 us                 | 61.620 us                 |
| OneStep                   | 486.306 ms                | 941.107 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 765.358 us                | 8.296 ms                  |
| Forward                   | 4.467 ms                  | 5.714 ms                  |
| Backward                  | 475.819 ms                | 940.815 ms                |
| Optimize                  | 1.167 ms                  | 1.646 ms                  |
| BarrierTimeBeforeRank0    | 30.765 us                 | 7.649 ms                  |
| BlockToStepN              | 15.261 us                 | 61.620 us                 |
| OneStep                   | 489.275 ms                | 949.565 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 767.148 us                | 8.296 ms                  |
| Forward                   | 4.467 ms                  | 5.714 ms                  |
| Backward                  | 482.692 ms                | 943.912 ms                |
| Optimize                  | 1.167 ms                  | 1.647 ms                  |
| BarrierTimeBeforeRank0    | 30.810 us                 | 7.649 ms                  |
| BlockToStepN              | 15.423 us                 | 61.620 us                 |
| OneStep                   | 496.490 ms                | 956.201 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 768.154 us                | 8.296 ms                  |
| Forward                   | 4.473 ms                  | 5.714 ms                  |
| Backward                  | 493.763 ms                | 965.654 ms                |
| Optimize                  | 1.165 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.810 us                 | 7.649 ms                  |
| BlockToStepN              | 15.555 us                 | 61.620 us                 |
| OneStep                   | 504.085 ms                | 984.258 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 768.154 us                | 8.296 ms                  |
| Forward                   | 4.470 ms                  | 5.714 ms                  |
| Backward                  | 501.084 ms                | 977.981 ms                |
| Optimize                  | 1.165 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.906 us                 | 7.649 ms                  |
| BlockToStepN              | 15.688 us                 | 61.620 us                 |
| OneStep                   | 508.026 ms                | 986.220 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 769.157 us                | 8.296 ms                  |
| Forward                   | 4.473 ms                  | 5.714 ms                  |
| Backward                  | 504.446 ms                | 986.920 ms                |
| Optimize                  | 1.164 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.893 us                 | 7.649 ms                  |
| BlockToStepN              | 15.775 us                 | 61.620 us                 |
| OneStep                   | 516.260 ms                | 995.714 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 769.263 us                | 8.296 ms                  |
| Forward                   | 4.470 ms                  | 5.714 ms                  |
| Backward                  | 511.426 ms                | 998.804 ms                |
| Optimize                  | 1.164 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.906 us                 | 7.649 ms                  |
| BlockToStepN              | 16.112 us                 | 61.620 us                 |
| OneStep                   | 525.053 ms                | 1.005 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 770.339 us                | 8.296 ms                  |
| Forward                   | 4.473 ms                  | 5.714 ms                  |
| Backward                  | 522.044 ms                | 1.011 s                   |
| Optimize                  | 1.164 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.893 us                 | 7.649 ms                  |
| BlockToStepN              | 16.151 us                 | 61.620 us                 |
| OneStep                   | 532.048 ms                | 1.022 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 769.263 us                | 8.296 ms                  |
| Forward                   | 4.470 ms                  | 5.714 ms                  |
| Backward                  | 529.820 ms                | 1.036 s                   |
| Optimize                  | 1.165 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.893 us                 | 7.649 ms                  |
| BlockToStepN              | 16.193 us                 | 61.620 us                 |
| OneStep                   | 539.990 ms                | 1.046 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 91.549, sample: 0.146, forward: 0.355, backward: 83.063, update: 0.117
[proc 2] 400 steps, total: 91.549, sample: 0.156, forward: 0.368, backward: 57.410, update: 0.114
[proc 1] 400 steps, total: 91.549, sample: 0.168, forward: 0.377, backward: 58.991, update: 0.100
[proc 0] 400 steps, total: 91.549, sample: 0.163, forward: 0.453, backward: 90.730, update: 0.117
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 769.263 us                | 8.296 ms                  |
| Forward                   | 4.470 ms                  | 5.714 ms                  |
| Backward                  | 534.469 ms                | 1.051 s                   |
| Optimize                  | 1.165 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.893 us                 | 7.649 ms                  |
| BlockToStepN              | 16.193 us                 | 61.620 us                 |
| OneStep                   | 541.486 ms                | 1.058 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 769.263 us                | 8.296 ms                  |
| Forward                   | 4.467 ms                  | 5.714 ms                  |
| Backward                  | 537.848 ms                | 1.055 s                   |
| Optimize                  | 1.165 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.765 us                 | 7.649 ms                  |
| BlockToStepN              | 16.307 us                 | 61.620 us                 |
| OneStep                   | 545.788 ms                | 1.069 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 770.339 us                | 8.296 ms                  |
| Forward                   | 4.466 ms                  | 5.714 ms                  |
| Backward                  | 539.632 ms                | 1.064 s                   |
| Optimize                  | 1.165 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.765 us                 | 7.649 ms                  |
| BlockToStepN              | 16.542 us                 | 61.620 us                 |
| OneStep                   | 553.918 ms                | 1.071 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 770.339 us                | 8.296 ms                  |
| Forward                   | 4.467 ms                  | 5.714 ms                  |
| Backward                  | 547.513 ms                | 1.076 s                   |
| Optimize                  | 1.165 ms                  | 1.650 ms                  |
| BarrierTimeBeforeRank0    | 30.765 us                 | 7.649 ms                  |
| BlockToStepN              | 16.542 us                 | 61.620 us                 |
| OneStep                   | 566.432 ms                | 1.085 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 771.794 us                | 8.296 ms                  |
| Forward                   | 4.470 ms                  | 5.714 ms                  |
| Backward                  | 559.756 ms                | 1.081 s                   |
| Optimize                  | 1.165 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.810 us                 | 7.649 ms                  |
| BlockToStepN              | 16.593 us                 | 61.620 us                 |
| OneStep                   | 570.511 ms                | 1.091 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 771.794 us                | 8.296 ms                  |
| Forward                   | 4.466 ms                  | 5.714 ms                  |
| Backward                  | 565.082 ms                | 1.098 s                   |
| Optimize                  | 1.167 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.810 us                 | 7.649 ms                  |
| BlockToStepN              | 16.878 us                 | 61.620 us                 |
| OneStep                   | 574.404 ms                | 1.106 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.019 us                | 8.296 ms                  |
| Forward                   | 4.466 ms                  | 5.714 ms                  |
| Backward                  | 567.334 ms                | 1.110 s                   |
| Optimize                  | 1.176 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.765 us                 | 7.649 ms                  |
| BlockToStepN              | 16.886 us                 | 64.424 us                 |
| OneStep                   | 579.100 ms                | 1.120 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.430 us                | 8.296 ms                  |
| Forward                   | 4.466 ms                  | 5.714 ms                  |
| Backward                  | 573.484 ms                | 1.117 s                   |
| Optimize                  | 1.167 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.810 us                 | 7.649 ms                  |
| BlockToStepN              | 17.059 us                 | 64.424 us                 |
| OneStep                   | 581.301 ms                | 1.131 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.430 us                | 8.296 ms                  |
| Forward                   | 4.470 ms                  | 5.714 ms                  |
| Backward                  | 578.428 ms                | 1.133 s                   |
| Optimize                  | 1.176 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.873 us                 | 7.649 ms                  |
| BlockToStepN              | 17.155 us                 | 64.424 us                 |
| OneStep                   | 589.800 ms                | 1.146 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.430 us                | 8.296 ms                  |
| Forward                   | 4.466 ms                  | 5.714 ms                  |
| Backward                  | 583.488 ms                | 1.138 s                   |
| Optimize                  | 1.177 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.893 us                 | 7.649 ms                  |
| BlockToStepN              | 17.201 us                 | 64.424 us                 |
| OneStep                   | 595.829 ms                | 1.147 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.430 us                | 8.296 ms                  |
| Forward                   | 4.463 ms                  | 5.714 ms                  |
| Backward                  | 589.725 ms                | 1.156 s                   |
| Optimize                  | 1.177 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.893 us                 | 7.649 ms                  |
| BlockToStepN              | 17.400 us                 | 64.424 us                 |
| OneStep                   | 602.644 ms                | 1.163 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.430 us                | 8.130 ms                  |
| Forward                   | 4.462 ms                  | 5.686 ms                  |
| Backward                  | 594.886 ms                | 1.157 s                   |
| Optimize                  | 1.181 ms                  | 1.661 ms                  |
| BarrierTimeBeforeRank0    | 30.873 us                 | 6.149 ms                  |
| BlockToStepN              | 17.473 us                 | 61.620 us                 |
| OneStep                   | 604.590 ms                | 1.169 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.430 us                | 8.130 ms                  |
| Forward                   | 4.462 ms                  | 5.686 ms                  |
| Backward                  | 596.566 ms                | 1.167 s                   |
| Optimize                  | 1.181 ms                  | 1.661 ms                  |
| BarrierTimeBeforeRank0    | 30.873 us                 | 6.149 ms                  |
| BlockToStepN              | 17.685 us                 | 64.424 us                 |
| OneStep                   | 608.459 ms                | 1.174 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.608 us                | 8.130 ms                  |
| Forward                   | 4.462 ms                  | 5.686 ms                  |
| Backward                  | 601.487 ms                | 1.179 s                   |
| Optimize                  | 1.185 ms                  | 1.661 ms                  |
| BarrierTimeBeforeRank0    | 30.893 us                 | 6.149 ms                  |
| BlockToStepN              | 17.901 us                 | 64.424 us                 |
| OneStep                   | 608.713 ms                | 1.186 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 772.628 us                | 8.130 ms                  |
| Forward                   | 4.460 ms                  | 5.686 ms                  |
| Backward                  | 608.884 ms                | 1.194 s                   |
| Optimize                  | 1.185 ms                  | 1.661 ms                  |
| BarrierTimeBeforeRank0    | 30.873 us                 | 6.149 ms                  |
| BlockToStepN              | 17.988 us                 | 64.424 us                 |
| OneStep                   | 616.325 ms                | 1.201 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 774.074 us                | 8.130 ms                  |
| Forward                   | 4.460 ms                  | 5.686 ms                  |
| Backward                  | 617.472 ms                | 1.203 s                   |
| Optimize                  | 1.192 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.873 us                 | 6.149 ms                  |
| BlockToStepN              | 18.142 us                 | 64.424 us                 |
| OneStep                   | 627.251 ms                | 1.212 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 774.167 us                | 8.130 ms                  |
| Forward                   | 4.459 ms                  | 5.686 ms                  |
| Backward                  | 625.681 ms                | 1.211 s                   |
| Optimize                  | 1.192 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.873 us                 | 6.149 ms                  |
| BlockToStepN              | 18.250 us                 | 64.424 us                 |
| OneStep                   | 633.993 ms                | 1.218 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 774.167 us                | 8.130 ms                  |
| Forward                   | 4.459 ms                  | 5.686 ms                  |
| Backward                  | 628.946 ms                | 1.225 s                   |
| Optimize                  | 1.185 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.873 us                 | 6.149 ms                  |
| BlockToStepN              | 18.413 us                 | 64.424 us                 |
| OneStep                   | 637.967 ms                | 1.234 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 774.167 us                | 8.130 ms                  |
| Forward                   | 4.459 ms                  | 5.686 ms                  |
| Backward                  | 631.233 ms                | 1.240 s                   |
| Optimize                  | 1.193 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.873 us                 | 6.149 ms                  |
| BlockToStepN              | 18.532 us                 | 64.424 us                 |
| OneStep                   | 639.811 ms                | 1.247 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 774.239 us                | 8.130 ms                  |
| Forward                   | 4.459 ms                  | 5.686 ms                  |
| Backward                  | 638.265 ms                | 1.251 s                   |
| Optimize                  | 1.193 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.906 us                 | 6.149 ms                  |
| BlockToStepN              | 18.544 us                 | 64.424 us                 |
| OneStep                   | 645.575 ms                | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 774.239 us                | 8.130 ms                  |
| Forward                   | 4.458 ms                  | 5.686 ms                  |
| Backward                  | 640.529 ms                | 1.262 s                   |
| Optimize                  | 1.194 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.906 us                 | 6.149 ms                  |
| BlockToStepN              | 18.589 us                 | 64.424 us                 |
| OneStep                   | 648.009 ms                | 1.269 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 774.740 us                | 8.130 ms                  |
| Forward                   | 4.459 ms                  | 5.686 ms                  |
| Backward                  | 641.773 ms                | 1.272 s                   |
| Optimize                  | 1.194 ms                  | 1.664 ms                  |
| BarrierTimeBeforeRank0    | 30.965 us                 | 6.149 ms                  |
| BlockToStepN              | 18.700 us                 | 64.424 us                 |
| OneStep                   | 652.303 ms                | 1.279 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 774.239 us                | 8.130 ms                  |
| Forward                   | 4.458 ms                  | 5.686 ms                  |
| Backward                  | 645.096 ms                | 1.275 s                   |
| Optimize                  | 1.194 ms                  | 1.676 ms                  |
| BarrierTimeBeforeRank0    | 30.965 us                 | 6.149 ms                  |
| BlockToStepN              | 18.969 us                 | 64.424 us                 |
| OneStep                   | 658.597 ms                | 1.283 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 117.094, sample: 0.160, forward: 0.383, backward: 75.649, update: 0.102
[proc 2] 500 steps, total: 117.094, sample: 0.175, forward: 0.375, backward: 73.531, update: 0.113
[proc 3] 500 steps, total: 117.094, sample: 0.145, forward: 0.354, backward: 106.204, update: 0.116
[proc 0] 500 steps, total: 117.094, sample: 0.161, forward: 0.436, backward: 116.290, update: 0.121
Successfully xmh. training takes 332.25097942352295 seconds
before call kg_cache_controller.StopThreads()
INFO [627058 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
INFO [627058 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 774.167 us                | 8.130 ms                  |
| Forward                   | 4.455 ms                  | 5.686 ms                  |
| Backward                  | 651.588 ms                | 1.284 s                   |
| Optimize                  | 1.194 ms                  | 1.678 ms                  |
| BarrierTimeBeforeRank0    | 30.906 us                 | 6.149 ms                  |
| BlockToStepN              | 18.969 us                 | 64.424 us                 |
| OneStep                   | 659.989 ms                | 1.292 s                   |
+---------------------------+---------------------------+---------------------------+
