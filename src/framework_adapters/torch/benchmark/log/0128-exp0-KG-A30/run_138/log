WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 15:53:19.200170 439416 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_FB15k_18', no_save_emb=True, max_step=500, batch_size=2400, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.01, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [439416 sampler.py:454] Start PreSampling
WARNING [439416 sampler.py:532] Before construct renumbering_dict
WARNING [439416 sampler.py:555] PreSampling done
W20240128 15:53:21.116955 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 15:53:21.117069 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 15:53:21.117090 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 15:53:21.117115 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 15:53:21.117130 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 15:53:21.117146 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 15:53:21.117161 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 15:53:21.117180 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 15:53:21.117197 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 15:53:21.117213 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 15:53:21.117235 439416 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 15:53:21.117252 439416 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 15:53:21.117266 439416 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 15:53:21.117347 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 15:53:21.117374 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 15:53:21.117390 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 15:53:21.117419 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 15:53:21.117435 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 15:53:21.117451 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 15:53:21.117466 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 15:53:21.117482 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 15:53:21.117497 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 15:53:21.117511 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 15:53:21.117527 439416 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 15:53:21.117540 439416 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 15:53:21.117553 439416 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 15:53:21.117587 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 15:53:21.117605 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 15:53:21.117620 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 15:53:21.117636 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 15:53:21.117651 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 15:53:21.117666 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 15:53:21.117681 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 15:53:21.117698 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 15:53:21.117713 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 15:53:21.117727 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 15:53:21.117743 439416 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 15:53:21.117755 439416 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 15:53:21.117769 439416 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 15:53:21.117798 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 15:53:21.117815 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 15:53:21.117830 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 15:53:21.117844 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 15:53:21.117859 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 15:53:21.117877 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 15:53:21.117892 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 15:53:21.117905 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 15:53:21.117920 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 15:53:21.117935 439416 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 15:53:21.117949 439416 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 15:53:21.117962 439416 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 15:53:21.117975 439416 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 15:53:21.242575 439416 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 15:53:21.242712 439416 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 37
Rank1: cached key size 37
Rank2: cached key size 37
Rank3: cached key size 37
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 334,  626,  747,  ..., 1090, 5343, 6393]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.072 seconds
[Rank1] pid = 439628
[Rank2] pid = 439692
INFO [439416 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [439628 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [439708 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [439416 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [439708 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [439628 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [439708 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [439416 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [439628 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [439708 cache_common.py:139] TorchNativeStdEmb construct done
INFO [439416 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [439708 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [439628 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [439416 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [439628 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [439692 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [439692 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [439692 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [439692 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [439692 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 15:53:24.438211 439694 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 15:53:24.438283 439821 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 15:53:24.438361 439758 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 15:53:24.438521 439629 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240128 15:53:25.802520 439629 recstore.cc:66] init folly done
E20240128 15:53:25.802583 439821 recstore.cc:66] init folly done
E20240128 15:53:25.802659 439758 recstore.cc:66] init folly done
E20240128 15:53:25.802728 439694 recstore.cc:66] init folly done
I20240128 15:53:25.851513 439694 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 15:53:25.863058 439758 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 15:53:25.863724 439629 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 15:53:25.899087 439821 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 968.340 us                | 14.860 ms                 |
| Forward                   | 6.539 ms                  | 748.022 ms                |
| Backward                  | 60.491 ms                 | 1.425 s                   |
| Optimize                  | 1.807 ms                  | 34.986 ms                 |
| BarrierTimeBeforeRank0    | 4.054 ms                  | 164.317 ms                |
| BlockToStepN              | 8.496 us                  | 114.882 us                |
| OneStep                   | 75.496 ms                 | 1.439 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 943.709 us                | 16.584 ms                 |
| Forward                   | 6.539 ms                  | 748.022 ms                |
| Backward                  | 109.992 ms                | 1.425 s                   |
| Optimize                  | 1.791 ms                  | 34.986 ms                 |
| BarrierTimeBeforeRank0    | 17.360 ms                 | 164.317 ms                |
| BlockToStepN              | 8.978 us                  | 114.882 us                |
| OneStep                   | 159.622 ms                | 1.439 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 907.400 us                | 15.921 ms                 |
| Forward                   | 6.332 ms                  | 8.835 ms                  |
| Backward                  | 135.336 ms                | 267.502 ms                |
| Optimize                  | 1.730 ms                  | 2.762 ms                  |
| BarrierTimeBeforeRank0    | 38.905 ms                 | 93.839 ms                 |
| BlockToStepN              | 9.325 us                  | 56.084 us                 |
| OneStep                   | 186.549 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 907.400 us                | 15.921 ms                 |
| Forward                   | 6.291 ms                  | 8.835 ms                  |
| Backward                  | 154.428 ms                | 281.719 ms                |
| Optimize                  | 1.780 ms                  | 2.762 ms                  |
| BarrierTimeBeforeRank0    | 53.463 ms                 | 107.650 ms                |
| BlockToStepN              | 10.494 us                 | 56.084 us                 |
| OneStep                   | 222.946 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 904.265 us                | 15.921 ms                 |
| Forward                   | 6.258 ms                  | 8.835 ms                  |
| Backward                  | 169.193 ms                | 354.979 ms                |
| Optimize                  | 1.780 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 55.596 ms                 | 124.567 ms                |
| BlockToStepN              | 11.549 us                 | 56.084 us                 |
| OneStep                   | 246.719 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 902.352 us                | 15.921 ms                 |
| Forward                   | 6.205 ms                  | 8.835 ms                  |
| Backward                  | 176.741 ms                | 399.117 ms                |
| Optimize                  | 1.762 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 62.531 ms                 | 135.027 ms                |
| BlockToStepN              | 12.271 us                 | 56.084 us                 |
| OneStep                   | 260.164 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 28.732, sample: 0.216, forward: 1.198, backward: 25.922, update: 0.195
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 28.744, sample: 0.215, forward: 1.437, backward: 26.358, update: 0.223
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 28.696, sample: 0.200, forward: 1.387, backward: 18.170, update: 0.214
[Rank3] pid = 439708
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 149), (149, 298), (298, 447), (447, 596)]
train_sampler.Prefill()
-------Step 0-------
tensor([10837,  3987,  8822,  6895,  8188,  5111,  9604,  3896, 12662,  8924]) tensor([  747,  7859,  8915,  3090,  7039, 10151, 13293, 10675,  6946,  7119])
-------Step 1-------
tensor([10837,  3987,  8822,  6895,  8188,  5111,  9604,  3896, 12662,  8924]) tensor([ 1503,   219,  5096,  3663, 14083,    21, 13148,  5019,  4785,  6807])
-------Step 2-------
tensor([ 2934, 14918, 10626,    13,  4653,  4990, 11869,  5893,  2924,   831]) tensor([13607,  4421,  9955, 10750,  2912,  9002,  5743,    98,  8908, 13007])
-------Step 3-------
tensor([ 2934, 14918, 10626,    13,  4653,  4990, 11869,  5893,  2924,   831]) tensor([ 8129, 13979,  5451,  6575,  3595,  5655,    22,  6831,  6388, 12373])
-------Step 4-------
tensor([ 9075,  9098, 13262,  9488,  3919,  7777,   453,  4677,  4096, 14773]) tensor([ 6832, 10180, 14239,   480, 10032,  9800,  1031,  9014,  7579,  7599])
-------Step 5-------
tensor([ 9075,  9098, 13262,  9488,  3919,  7777,   453,  4677,  4096, 14773]) tensor([ 3696, 11188,  2920,  9351,  5852,  8852,  3281,   255, 13742,   847])
-------Step 6-------
tensor([ 4318, 10356, 12273,  9897,    28, 11117,  7140,  9134,  4568,  8558]) tensor([12144, 10644, 13109,   106, 14747,  9535,  7695,  1136,  6250,  8902])
-------Step 7-------
tensor([ 4318, 10356, 12273,  9897,    28, 11117,  7140,  9134,  4568,  8558]) tensor([ 4882,  5003,  9208, 12556,  5092,  7118,  6066, 12655, 13579,  5702])
-------Step 8-------
tensor([ 8111, 13422,    24,  5628,  1520,  7933,  2826,  2017,  2028,  6404]) tensor([ 6608, 14268, 11797, 14926,  6719,  8165,  5387,   974,  1451,  7835])
-------Step 9-------
tensor([ 8111, 13422,    24,  5628,  1520,  7933,  2826,  2017,  2028,  6404]) tensor([ 1478, 12066,    54, 13325,  1403,  4608,  2259,   454, 14702, 12958])
before start barrier
start train
[proc 0] 100 steps, total: 28.732, sample: 0.241, forward: 1.371, backward: 20.443, update: 0.208
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 902.352 us                | 15.921 ms                 |
| Forward                   | 6.151 ms                  | 8.835 ms                  |
| Backward                  | 203.930 ms                | 424.252 ms                |
| Optimize                  | 1.762 ms                  | 4.592 ms                  |
| BarrierTimeBeforeRank0    | 70.036 ms                 | 164.317 ms                |
| BlockToStepN              | 12.728 us                 | 84.531 us                 |
| OneStep                   | 291.593 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 903.772 us                | 15.921 ms                 |
| Forward                   | 6.109 ms                  | 8.835 ms                  |
| Backward                  | 211.293 ms                | 456.380 ms                |
| Optimize                  | 1.762 ms                  | 4.592 ms                  |
| BarrierTimeBeforeRank0    | 71.898 ms                 | 166.473 ms                |
| BlockToStepN              | 12.668 us                 | 84.531 us                 |
| OneStep                   | 303.590 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 903.772 us                | 15.921 ms                 |
| Forward                   | 6.109 ms                  | 8.835 ms                  |
| Backward                  | 234.516 ms                | 522.111 ms                |
| Optimize                  | 1.780 ms                  | 4.592 ms                  |
| BarrierTimeBeforeRank0    | 75.333 ms                 | 182.450 ms                |
| BlockToStepN              | 13.694 us                 | 84.531 us                 |
| OneStep                   | 319.285 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 907.400 us                | 15.921 ms                 |
| Forward                   | 6.109 ms                  | 8.835 ms                  |
| Backward                  | 243.394 ms                | 522.111 ms                |
| Optimize                  | 1.781 ms                  | 4.592 ms                  |
| BarrierTimeBeforeRank0    | 79.262 ms                 | 193.134 ms                |
| BlockToStepN              | 14.067 us                 | 84.531 us                 |
| OneStep                   | 339.920 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.285 us                | 15.921 ms                 |
| Forward                   | 6.152 ms                  | 8.835 ms                  |
| Backward                  | 262.528 ms                | 555.304 ms                |
| Optimize                  | 1.780 ms                  | 4.592 ms                  |
| BarrierTimeBeforeRank0    | 83.228 ms                 | 201.143 ms                |
| BlockToStepN              | 14.280 us                 | 84.531 us                 |
| OneStep                   | 363.497 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 913.032 us                | 15.921 ms                 |
| Forward                   | 6.182 ms                  | 8.835 ms                  |
| Backward                  | 272.985 ms                | 577.837 ms                |
| Optimize                  | 1.768 ms                  | 4.592 ms                  |
| BarrierTimeBeforeRank0    | 88.120 ms                 | 212.521 ms                |
| BlockToStepN              | 15.013 us                 | 84.531 us                 |
| OneStep                   | 377.971 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.285 us                | 14.860 ms                 |
| Forward                   | 6.205 ms                  | 8.732 ms                  |
| Backward                  | 277.018 ms                | 589.144 ms                |
| Optimize                  | 1.768 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 91.026 ms                 | 227.729 ms                |
| BlockToStepN              | 15.013 us                 | 56.084 us                 |
| OneStep                   | 399.543 ms                | 760.115 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.873 us                | 14.860 ms                 |
| Forward                   | 6.231 ms                  | 8.732 ms                  |
| Backward                  | 286.226 ms                | 620.287 ms                |
| Optimize                  | 1.778 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 92.997 ms                 | 233.241 ms                |
| BlockToStepN              | 15.356 us                 | 56.084 us                 |
| OneStep                   | 409.462 ms                | 815.932 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.285 us                | 14.860 ms                 |
| Forward                   | 6.258 ms                  | 8.732 ms                  |
| Backward                  | 304.006 ms                | 647.824 ms                |
| Optimize                  | 1.780 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 94.315 ms                 | 248.639 ms                |
| BlockToStepN              | 15.511 us                 | 65.269 us                 |
| OneStep                   | 422.690 ms                | 815.932 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.285 us                | 14.860 ms                 |
| Forward                   | 6.258 ms                  | 8.732 ms                  |
| Backward                  | 311.908 ms                | 649.543 ms                |
| Optimize                  | 1.781 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 103.557 ms                | 253.408 ms                |
| BlockToStepN              | 15.576 us                 | 65.269 us                 |
| OneStep                   | 440.800 ms                | 835.035 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.873 us                | 14.860 ms                 |
| Forward                   | 6.291 ms                  | 8.732 ms                  |
| Backward                  | 322.905 ms                | 687.838 ms                |
| Optimize                  | 1.781 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 107.650 ms                | 269.951 ms                |
| BlockToStepN              | 15.667 us                 | 65.269 us                 |
| OneStep                   | 450.308 ms                | 855.760 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.873 us                | 14.860 ms                 |
| Forward                   | 6.323 ms                  | 8.732 ms                  |
| Backward                  | 331.157 ms                | 726.856 ms                |
| Optimize                  | 1.780 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 116.889 ms                | 282.938 ms                |
| BlockToStepN              | 16.301 us                 | 65.269 us                 |
| OneStep                   | 458.660 ms                | 896.008 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.285 us                | 14.860 ms                 |
| Forward                   | 6.292 ms                  | 8.732 ms                  |
| Backward                  | 341.994 ms                | 726.856 ms                |
| Optimize                  | 1.782 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 117.703 ms                | 283.012 ms                |
| BlockToStepN              | 16.301 us                 | 65.269 us                 |
| OneStep                   | 474.214 ms                | 905.323 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.873 us                | 14.860 ms                 |
| Forward                   | 6.291 ms                  | 8.732 ms                  |
| Backward                  | 352.880 ms                | 745.463 ms                |
| Optimize                  | 1.782 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 122.882 ms                | 294.407 ms                |
| BlockToStepN              | 16.634 us                 | 65.269 us                 |
| OneStep                   | 490.841 ms                | 951.521 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 72.235, sample: 0.214, forward: 0.545, backward: 69.512, update: 0.150
[proc 1] 200 steps, total: 72.235, sample: 0.229, forward: 0.568, backward: 70.654, update: 0.141
[proc 3] 200 steps, total: 72.235, sample: 0.215, forward: 0.527, backward: 46.451, update: 0.172
[proc 0] 200 steps, total: 72.235, sample: 0.248, forward: 0.623, backward: 52.230, update: 0.187
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.285 us                | 14.860 ms                 |
| Forward                   | 6.323 ms                  | 8.732 ms                  |
| Backward                  | 353.716 ms                | 767.115 ms                |
| Optimize                  | 1.786 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 122.943 ms                | 301.081 ms                |
| BlockToStepN              | 16.678 us                 | 65.269 us                 |
| OneStep                   | 509.364 ms                | 952.798 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.873 us                | 14.860 ms                 |
| Forward                   | 6.323 ms                  | 8.732 ms                  |
| Backward                  | 364.900 ms                | 770.425 ms                |
| Optimize                  | 1.791 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 126.565 ms                | 301.087 ms                |
| BlockToStepN              | 16.678 us                 | 65.269 us                 |
| OneStep                   | 512.340 ms                | 1.043 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.285 us                | 14.860 ms                 |
| Forward                   | 6.323 ms                  | 8.732 ms                  |
| Backward                  | 374.660 ms                | 784.580 ms                |
| Optimize                  | 1.791 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 127.858 ms                | 309.588 ms                |
| BlockToStepN              | 16.678 us                 | 65.269 us                 |
| OneStep                   | 537.050 ms                | 1.043 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.873 us                | 14.860 ms                 |
| Forward                   | 6.292 ms                  | 8.732 ms                  |
| Backward                  | 383.187 ms                | 785.127 ms                |
| Optimize                  | 1.793 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 130.369 ms                | 322.398 ms                |
| BlockToStepN              | 16.989 us                 | 65.269 us                 |
| OneStep                   | 538.320 ms                | 1.043 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.873 us                | 14.860 ms                 |
| Forward                   | 6.292 ms                  | 8.732 ms                  |
| Backward                  | 399.117 ms                | 802.238 ms                |
| Optimize                  | 1.793 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 132.153 ms                | 330.684 ms                |
| BlockToStepN              | 16.989 us                 | 65.269 us                 |
| OneStep                   | 543.059 ms                | 1.052 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 915.873 us                | 14.860 ms                 |
| Forward                   | 6.292 ms                  | 8.732 ms                  |
| Backward                  | 403.637 ms                | 808.719 ms                |
| Optimize                  | 1.793 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 133.617 ms                | 339.293 ms                |
| BlockToStepN              | 16.989 us                 | 65.269 us                 |
| OneStep                   | 559.554 ms                | 1.077 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.285 us                | 14.860 ms                 |
| Forward                   | 6.323 ms                  | 8.732 ms                  |
| Backward                  | 408.246 ms                | 857.889 ms                |
| Optimize                  | 1.793 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 136.634 ms                | 339.293 ms                |
| BlockToStepN              | 16.678 us                 | 65.269 us                 |
| OneStep                   | 566.635 ms                | 1.090 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.419 us                | 14.860 ms                 |
| Forward                   | 6.332 ms                  | 8.732 ms                  |
| Backward                  | 410.278 ms                | 860.158 ms                |
| Optimize                  | 1.792 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 139.237 ms                | 351.637 ms                |
| BlockToStepN              | 16.989 us                 | 65.269 us                 |
| OneStep                   | 584.346 ms                | 1.115 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.419 us                | 14.860 ms                 |
| Forward                   | 6.332 ms                  | 8.732 ms                  |
| Backward                  | 424.252 ms                | 903.489 ms                |
| Optimize                  | 1.797 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 139.312 ms                | 353.204 ms                |
| BlockToStepN              | 16.678 us                 | 65.269 us                 |
| OneStep                   | 589.079 ms                | 1.138 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.285 us                | 14.860 ms                 |
| Forward                   | 6.337 ms                  | 8.732 ms                  |
| Backward                  | 433.384 ms                | 914.329 ms                |
| Optimize                  | 1.797 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 144.650 ms                | 357.612 ms                |
| BlockToStepN              | 16.989 us                 | 65.269 us                 |
| OneStep                   | 605.677 ms                | 1.156 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.419 us                | 14.860 ms                 |
| Forward                   | 6.337 ms                  | 8.732 ms                  |
| Backward                  | 433.813 ms                | 935.925 ms                |
| Optimize                  | 1.797 ms                  | 2.978 ms                  |
| BarrierTimeBeforeRank0    | 145.980 ms                | 365.660 ms                |
| BlockToStepN              | 16.989 us                 | 65.269 us                 |
| OneStep                   | 615.266 ms                | 1.171 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 924.857 us                | 14.570 ms                 |
| Forward                   | 6.341 ms                  | 8.465 ms                  |
| Backward                  | 444.995 ms                | 935.925 ms                |
| Optimize                  | 1.797 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 146.980 ms                | 372.786 ms                |
| BlockToStepN              | 17.038 us                 | 64.359 us                 |
| OneStep                   | 626.417 ms                | 1.193 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.419 us                | 14.570 ms                 |
| Forward                   | 6.341 ms                  | 8.465 ms                  |
| Backward                  | 450.812 ms                | 940.853 ms                |
| Optimize                  | 1.802 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 147.596 ms                | 373.462 ms                |
| BlockToStepN              | 16.989 us                 | 64.359 us                 |
| OneStep                   | 631.318 ms                | 1.208 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 918.419 us                | 14.570 ms                 |
| Forward                   | 6.344 ms                  | 8.465 ms                  |
| Backward                  | 452.468 ms                | 977.720 ms                |
| Optimize                  | 1.802 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 152.203 ms                | 382.944 ms                |
| BlockToStepN              | 17.038 us                 | 64.359 us                 |
| OneStep                   | 637.334 ms                | 1.226 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 924.857 us                | 14.570 ms                 |
| Forward                   | 6.341 ms                  | 8.465 ms                  |
| Backward                  | 456.380 ms                | 986.658 ms                |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 153.855 ms                | 394.481 ms                |
| BlockToStepN              | 17.038 us                 | 64.359 us                 |
| OneStep                   | 651.247 ms                | 1.237 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 926.046 us                | 14.570 ms                 |
| Forward                   | 6.337 ms                  | 8.465 ms                  |
| Backward                  | 464.551 ms                | 989.450 ms                |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 158.482 ms                | 395.401 ms                |
| BlockToStepN              | 16.989 us                 | 64.359 us                 |
| OneStep                   | 656.291 ms                | 1.259 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 926.046 us                | 14.570 ms                 |
| Forward                   | 6.344 ms                  | 8.465 ms                  |
| Backward                  | 469.582 ms                | 1.004 s                   |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 159.494 ms                | 398.347 ms                |
| BlockToStepN              | 16.989 us                 | 64.359 us                 |
| OneStep                   | 666.583 ms                | 1.275 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 927.505 us                | 14.570 ms                 |
| Forward                   | 6.355 ms                  | 8.465 ms                  |
| Backward                  | 484.704 ms                | 1.007 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 163.586 ms                | 407.910 ms                |
| BlockToStepN              | 16.989 us                 | 64.359 us                 |
| OneStep                   | 675.798 ms                | 1.303 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 926.046 us                | 14.570 ms                 |
| Forward                   | 6.344 ms                  | 8.465 ms                  |
| Backward                  | 494.133 ms                | 1.057 s                   |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 164.317 ms                | 408.336 ms                |
| BlockToStepN              | 16.989 us                 | 64.359 us                 |
| OneStep                   | 683.847 ms                | 1.320 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 929.434 us                | 14.570 ms                 |
| Forward                   | 6.355 ms                  | 8.465 ms                  |
| Backward                  | 496.289 ms                | 1.082 s                   |
| Optimize                  | 1.802 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 166.241 ms                | 414.787 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 684.228 ms                | 1.327 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 929.891 us                | 14.570 ms                 |
| Forward                   | 6.355 ms                  | 8.465 ms                  |
| Backward                  | 498.927 ms                | 1.085 s                   |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 166.542 ms                | 415.392 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 704.270 ms                | 1.351 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 930.603 us                | 14.570 ms                 |
| Forward                   | 6.355 ms                  | 8.465 ms                  |
| Backward                  | 507.801 ms                | 1.092 s                   |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 173.987 ms                | 425.165 ms                |
| BlockToStepN              | 16.678 us                 | 64.359 us                 |
| OneStep                   | 715.410 ms                | 1.372 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 930.603 us                | 14.570 ms                 |
| Forward                   | 6.357 ms                  | 8.465 ms                  |
| Backward                  | 516.239 ms                | 1.110 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 174.951 ms                | 437.083 ms                |
| BlockToStepN              | 16.678 us                 | 64.359 us                 |
| OneStep                   | 725.092 ms                | 1.382 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 929.891 us                | 14.570 ms                 |
| Forward                   | 6.357 ms                  | 8.465 ms                  |
| Backward                  | 520.639 ms                | 1.118 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 180.232 ms                | 450.220 ms                |
| BlockToStepN              | 16.678 us                 | 64.359 us                 |
| OneStep                   | 728.126 ms                | 1.406 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 118.525, sample: 0.202, forward: 0.558, backward: 117.487, update: 0.136
[proc 3] 300 steps, total: 118.525, sample: 0.244, forward: 0.533, backward: 75.905, update: 0.176
[proc 2] 300 steps, total: 118.525, sample: 0.210, forward: 0.548, backward: 113.672, update: 0.151
[proc 0] 300 steps, total: 118.525, sample: 0.254, forward: 0.641, backward: 88.407, update: 0.193
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 929.891 us                | 14.570 ms                 |
| Forward                   | 6.367 ms                  | 8.465 ms                  |
| Backward                  | 520.935 ms                | 1.126 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 182.450 ms                | 456.165 ms                |
| BlockToStepN              | 16.678 us                 | 64.359 us                 |
| OneStep                   | 728.542 ms                | 1.415 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 930.603 us                | 14.570 ms                 |
| Forward                   | 6.379 ms                  | 8.465 ms                  |
| Backward                  | 522.111 ms                | 1.162 s                   |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 183.802 ms                | 457.396 ms                |
| BlockToStepN              | 16.678 us                 | 64.359 us                 |
| OneStep                   | 750.961 ms                | 1.430 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 930.603 us                | 14.570 ms                 |
| Forward                   | 6.379 ms                  | 8.732 ms                  |
| Backward                  | 525.663 ms                | 1.162 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 185.375 ms                | 460.314 ms                |
| BlockToStepN              | 16.678 us                 | 64.359 us                 |
| OneStep                   | 759.344 ms                | 1.449 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 930.603 us                | 14.570 ms                 |
| Forward                   | 6.379 ms                  | 8.810 ms                  |
| Backward                  | 532.939 ms                | 1.177 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 187.577 ms                | 473.201 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 761.099 ms                | 1.465 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 933.399 us                | 14.570 ms                 |
| Forward                   | 6.384 ms                  | 8.810 ms                  |
| Backward                  | 535.860 ms                | 1.177 s                   |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 187.616 ms                | 475.820 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 767.522 ms                | 1.477 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 930.603 us                | 14.570 ms                 |
| Forward                   | 6.384 ms                  | 8.810 ms                  |
| Backward                  | 547.142 ms                | 1.221 s                   |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 188.954 ms                | 485.165 ms                |
| BlockToStepN              | 16.678 us                 | 64.359 us                 |
| OneStep                   | 774.405 ms                | 1.492 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 933.399 us                | 14.570 ms                 |
| Forward                   | 6.383 ms                  | 8.810 ms                  |
| Backward                  | 555.304 ms                | 1.229 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 189.555 ms                | 485.664 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 790.056 ms                | 1.504 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 935.226 us                | 14.570 ms                 |
| Forward                   | 6.384 ms                  | 8.810 ms                  |
| Backward                  | 563.268 ms                | 1.255 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 193.134 ms                | 486.884 ms                |
| BlockToStepN              | 16.469 us                 | 64.359 us                 |
| OneStep                   | 795.827 ms                | 1.522 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 935.226 us                | 14.570 ms                 |
| Forward                   | 6.384 ms                  | 8.810 ms                  |
| Backward                  | 574.023 ms                | 1.264 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 196.352 ms                | 491.309 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 804.999 ms                | 1.534 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 935.511 us                | 14.570 ms                 |
| Forward                   | 6.385 ms                  | 8.810 ms                  |
| Backward                  | 580.789 ms                | 1.264 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 196.382 ms                | 494.936 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 806.632 ms                | 1.555 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 935.226 us                | 14.570 ms                 |
| Forward                   | 6.392 ms                  | 8.810 ms                  |
| Backward                  | 582.826 ms                | 1.264 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 198.426 ms                | 496.887 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 813.985 ms                | 1.571 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 935.511 us                | 14.570 ms                 |
| Forward                   | 6.388 ms                  | 8.810 ms                  |
| Backward                  | 589.144 ms                | 1.275 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 201.768 ms                | 500.625 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 817.942 ms                | 1.584 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 938.346 us                | 14.570 ms                 |
| Forward                   | 6.392 ms                  | 8.810 ms                  |
| Backward                  | 589.514 ms                | 1.276 s                   |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 204.662 ms                | 508.689 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 823.579 ms                | 1.600 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 938.346 us                | 14.570 ms                 |
| Forward                   | 6.394 ms                  | 8.810 ms                  |
| Backward                  | 593.335 ms                | 1.312 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 204.956 ms                | 520.414 ms                |
| BlockToStepN              | 16.634 us                 | 64.359 us                 |
| OneStep                   | 843.406 ms                | 1.608 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 938.346 us                | 14.570 ms                 |
| Forward                   | 6.407 ms                  | 8.810 ms                  |
| Backward                  | 593.503 ms                | 1.315 s                   |
| Optimize                  | 1.803 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 208.132 ms                | 520.414 ms                |
| BlockToStepN              | 16.678 us                 | 64.359 us                 |
| OneStep                   | 844.714 ms                | 1.630 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 938.346 us                | 14.271 ms                 |
| Forward                   | 6.406 ms                  | 8.732 ms                  |
| Backward                  | 605.496 ms                | 1.315 s                   |
| Optimize                  | 1.803 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 209.833 ms                | 520.414 ms                |
| BlockToStepN              | 16.989 us                 | 56.084 us                 |
| OneStep                   | 847.249 ms                | 1.641 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 940.808 us                | 14.271 ms                 |
| Forward                   | 6.406 ms                  | 8.732 ms                  |
| Backward                  | 607.700 ms                | 1.368 s                   |
| Optimize                  | 1.803 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 210.809 ms                | 525.322 ms                |
| BlockToStepN              | 17.038 us                 | 56.084 us                 |
| OneStep                   | 853.507 ms                | 1.656 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 940.808 us                | 14.271 ms                 |
| Forward                   | 6.406 ms                  | 8.732 ms                  |
| Backward                  | 617.265 ms                | 1.377 s                   |
| Optimize                  | 1.803 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 212.521 ms                | 525.322 ms                |
| BlockToStepN              | 17.299 us                 | 56.084 us                 |
| OneStep                   | 858.842 ms                | 1.667 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 940.808 us                | 14.271 ms                 |
| Forward                   | 6.408 ms                  | 8.732 ms                  |
| Backward                  | 620.287 ms                | 1.389 s                   |
| Optimize                  | 1.803 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 213.069 ms                | 528.536 ms                |
| BlockToStepN              | 17.380 us                 | 56.084 us                 |
| OneStep                   | 865.634 ms                | 1.680 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 940.808 us                | 14.271 ms                 |
| Forward                   | 6.407 ms                  | 8.732 ms                  |
| Backward                  | 631.060 ms                | 1.397 s                   |
| Optimize                  | 1.803 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 214.697 ms                | 530.431 ms                |
| BlockToStepN              | 17.533 us                 | 64.359 us                 |
| OneStep                   | 873.532 ms                | 1.698 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 943.709 us                | 14.271 ms                 |
| Forward                   | 6.408 ms                  | 8.732 ms                  |
| Backward                  | 631.139 ms                | 1.411 s                   |
| Optimize                  | 1.803 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 217.267 ms                | 532.632 ms                |
| BlockToStepN              | 17.585 us                 | 65.269 us                 |
| OneStep                   | 877.228 ms                | 1.715 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 943.709 us                | 14.271 ms                 |
| Forward                   | 6.408 ms                  | 8.732 ms                  |
| Backward                  | 645.755 ms                | 1.416 s                   |
| Optimize                  | 1.803 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 217.468 ms                | 543.210 ms                |
| BlockToStepN              | 17.585 us                 | 65.269 us                 |
| OneStep                   | 882.009 ms                | 1.722 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 943.749 us                | 14.271 ms                 |
| Forward                   | 6.408 ms                  | 8.732 ms                  |
| Backward                  | 646.108 ms                | 1.425 s                   |
| Optimize                  | 1.803 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 223.473 ms                | 551.364 ms                |
| BlockToStepN              | 17.665 us                 | 65.269 us                 |
| OneStep                   | 894.601 ms                | 1.740 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 944.536 us                | 14.271 ms                 |
| Forward                   | 6.416 ms                  | 8.732 ms                  |
| Backward                  | 647.824 ms                | 1.458 s                   |
| Optimize                  | 1.803 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 223.899 ms                | 568.185 ms                |
| BlockToStepN              | 17.615 us                 | 65.269 us                 |
| OneStep                   | 896.008 ms                | 1.746 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 943.749 us                | 14.271 ms                 |
| Forward                   | 6.408 ms                  | 8.732 ms                  |
| Backward                  | 651.703 ms                | 1.462 s                   |
| Optimize                  | 1.804 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 226.310 ms                | 568.271 ms                |
| BlockToStepN              | 17.665 us                 | 65.269 us                 |
| OneStep                   | 902.682 ms                | 1.757 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 944.536 us                | 14.271 ms                 |
| Forward                   | 6.416 ms                  | 8.732 ms                  |
| Backward                  | 656.175 ms                | 1.469 s                   |
| Optimize                  | 1.804 ms                  | 2.837 ms                  |
| BarrierTimeBeforeRank0    | 226.501 ms                | 573.638 ms                |
| BlockToStepN              | 17.822 us                 | 65.269 us                 |
| OneStep                   | 905.323 ms                | 1.787 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 944.536 us                | 14.271 ms                 |
| Forward                   | 6.416 ms                  | 8.732 ms                  |
| Backward                  | 663.308 ms                | 1.474 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 227.842 ms                | 573.639 ms                |
| BlockToStepN              | 17.881 us                 | 65.269 us                 |
| OneStep                   | 927.812 ms                | 1.788 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 944.536 us                | 14.271 ms                 |
| Forward                   | 6.426 ms                  | 8.732 ms                  |
| Backward                  | 670.832 ms                | 1.474 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 228.284 ms                | 576.989 ms                |
| BlockToStepN              | 17.881 us                 | 65.269 us                 |
| OneStep                   | 928.025 ms                | 1.799 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 945.503 us                | 14.271 ms                 |
| Forward                   | 6.428 ms                  | 8.732 ms                  |
| Backward                  | 678.451 ms                | 1.481 s                   |
| Optimize                  | 1.804 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 228.459 ms                | 584.639 ms                |
| BlockToStepN              | 17.881 us                 | 65.269 us                 |
| OneStep                   | 929.952 ms                | 1.817 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 945.503 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 687.838 ms                | 1.483 s                   |
| Optimize                  | 1.807 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 230.164 ms                | 585.424 ms                |
| BlockToStepN              | 17.881 us                 | 65.269 us                 |
| OneStep                   | 947.463 ms                | 1.832 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 947.811 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 689.408 ms                | 1.502 s                   |
| Optimize                  | 1.807 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 230.222 ms                | 588.871 ms                |
| BlockToStepN              | 18.106 us                 | 65.269 us                 |
| OneStep                   | 948.947 ms                | 1.836 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 947.811 us                | 14.271 ms                 |
| Forward                   | 6.444 ms                  | 8.732 ms                  |
| Backward                  | 691.826 ms                | 1.502 s                   |
| Optimize                  | 1.807 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 231.133 ms                | 590.138 ms                |
| BlockToStepN              | 18.117 us                 | 65.269 us                 |
| OneStep                   | 949.412 ms                | 1.850 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 945.503 us                | 14.271 ms                 |
| Forward                   | 6.444 ms                  | 8.732 ms                  |
| Backward                  | 693.535 ms                | 1.507 s                   |
| Optimize                  | 1.807 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 232.334 ms                | 600.787 ms                |
| BlockToStepN              | 18.117 us                 | 65.269 us                 |
| OneStep                   | 952.798 ms                | 1.866 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 165.565, sample: 0.214, forward: 0.544, backward: 159.139, update: 0.154
[proc 3] 400 steps, total: 165.565, sample: 0.215, forward: 0.536, backward: 105.048, update: 0.179
[proc 1] 400 steps, total: 165.565, sample: 0.227, forward: 0.566, backward: 164.513, update: 0.142
[proc 0] 400 steps, total: 165.565, sample: 0.238, forward: 0.669, backward: 125.481, update: 0.190
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 945.503 us                | 14.271 ms                 |
| Forward                   | 6.444 ms                  | 8.732 ms                  |
| Backward                  | 712.348 ms                | 1.527 s                   |
| Optimize                  | 1.807 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 233.241 ms                | 600.787 ms                |
| BlockToStepN              | 18.117 us                 | 65.269 us                 |
| OneStep                   | 959.417 ms                | 1.877 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 947.850 us                | 14.271 ms                 |
| Forward                   | 6.444 ms                  | 8.732 ms                  |
| Backward                  | 712.577 ms                | 1.528 s                   |
| Optimize                  | 1.806 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 233.684 ms                | 600.787 ms                |
| BlockToStepN              | 18.106 us                 | 65.269 us                 |
| OneStep                   | 964.349 ms                | 1.888 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 947.850 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 722.510 ms                | 1.571 s                   |
| Optimize                  | 1.807 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 235.797 ms                | 607.211 ms                |
| BlockToStepN              | 18.117 us                 | 69.039 us                 |
| OneStep                   | 982.804 ms                | 1.909 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 947.811 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 726.379 ms                | 1.574 s                   |
| Optimize                  | 1.808 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 236.177 ms                | 607.211 ms                |
| BlockToStepN              | 18.190 us                 | 69.039 us                 |
| OneStep                   | 985.743 ms                | 1.915 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 947.811 us                | 14.271 ms                 |
| Forward                   | 6.444 ms                  | 8.732 ms                  |
| Backward                  | 726.856 ms                | 1.578 s                   |
| Optimize                  | 1.807 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 236.349 ms                | 614.158 ms                |
| BlockToStepN              | 18.106 us                 | 69.039 us                 |
| OneStep                   | 996.933 ms                | 1.927 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 947.850 us                | 14.271 ms                 |
| Forward                   | 6.444 ms                  | 8.732 ms                  |
| Backward                  | 735.474 ms                | 1.579 s                   |
| Optimize                  | 1.808 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 241.906 ms                | 614.279 ms                |
| BlockToStepN              | 18.106 us                 | 69.039 us                 |
| OneStep                   | 998.150 ms                | 1.938 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 947.850 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 738.460 ms                | 1.579 s                   |
| Optimize                  | 1.808 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 242.701 ms                | 614.279 ms                |
| BlockToStepN              | 18.106 us                 | 69.039 us                 |
| OneStep                   | 1.006 s                   | 1.947 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 948.719 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 738.607 ms                | 1.581 s                   |
| Optimize                  | 1.809 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 242.837 ms                | 614.279 ms                |
| BlockToStepN              | 18.106 us                 | 69.039 us                 |
| OneStep                   | 1.007 s                   | 1.959 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 948.719 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 739.212 ms                | 1.595 s                   |
| Optimize                  | 1.809 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 243.292 ms                | 614.279 ms                |
| BlockToStepN              | 17.868 us                 | 69.039 us                 |
| OneStep                   | 1.010 s                   | 1.972 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 948.719 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 745.463 ms                | 1.622 s                   |
| Optimize                  | 1.809 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 244.815 ms                | 622.848 ms                |
| BlockToStepN              | 17.822 us                 | 69.039 us                 |
| OneStep                   | 1.021 s                   | 1.984 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 948.719 us                | 14.271 ms                 |
| Forward                   | 6.428 ms                  | 8.732 ms                  |
| Backward                  | 753.247 ms                | 1.623 s                   |
| Optimize                  | 1.809 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 245.543 ms                | 634.510 ms                |
| BlockToStepN              | 17.822 us                 | 69.039 us                 |
| OneStep                   | 1.026 s                   | 2.003 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 949.126 us                | 14.271 ms                 |
| Forward                   | 6.428 ms                  | 8.732 ms                  |
| Backward                  | 755.553 ms                | 1.628 s                   |
| Optimize                  | 1.809 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 246.884 ms                | 634.510 ms                |
| BlockToStepN              | 17.868 us                 | 69.039 us                 |
| OneStep                   | 1.027 s                   | 2.015 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 951.153 us                | 14.271 ms                 |
| Forward                   | 6.428 ms                  | 8.732 ms                  |
| Backward                  | 758.419 ms                | 1.628 s                   |
| Optimize                  | 1.809 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 246.971 ms                | 634.510 ms                |
| BlockToStepN              | 17.868 us                 | 69.039 us                 |
| OneStep                   | 1.038 s                   | 2.027 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 951.153 us                | 14.271 ms                 |
| Forward                   | 6.428 ms                  | 8.732 ms                  |
| Backward                  | 763.471 ms                | 1.658 s                   |
| Optimize                  | 1.810 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 247.099 ms                | 634.510 ms                |
| BlockToStepN              | 17.881 us                 | 69.039 us                 |
| OneStep                   | 1.040 s                   | 2.030 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 951.396 us                | 14.271 ms                 |
| Forward                   | 6.428 ms                  | 8.732 ms                  |
| Backward                  | 765.825 ms                | 1.693 s                   |
| Optimize                  | 1.811 ms                  | 2.927 ms                  |
| BarrierTimeBeforeRank0    | 248.346 ms                | 634.510 ms                |
| BlockToStepN              | 17.881 us                 | 69.039 us                 |
| OneStep                   | 1.049 s                   | 2.046 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 951.396 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 767.115 ms                | 1.694 s                   |
| Optimize                  | 1.812 ms                  | 2.927 ms                  |
| BarrierTimeBeforeRank0    | 248.561 ms                | 634.510 ms                |
| BlockToStepN              | 17.881 us                 | 69.039 us                 |
| OneStep                   | 1.052 s                   | 2.052 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 951.821 us                | 14.469 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 768.782 ms                | 1.694 s                   |
| Optimize                  | 1.812 ms                  | 2.927 ms                  |
| BarrierTimeBeforeRank0    | 248.639 ms                | 634.510 ms                |
| BlockToStepN              | 17.881 us                 | 70.133 us                 |
| OneStep                   | 1.057 s                   | 2.058 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 951.821 us                | 14.469 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 770.425 ms                | 1.696 s                   |
| Optimize                  | 1.812 ms                  | 2.927 ms                  |
| BarrierTimeBeforeRank0    | 248.964 ms                | 640.007 ms                |
| BlockToStepN              | 17.881 us                 | 70.133 us                 |
| OneStep                   | 1.058 s                   | 2.103 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 952.660 us                | 14.469 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 771.452 ms                | 1.696 s                   |
| Optimize                  | 1.814 ms                  | 2.927 ms                  |
| BarrierTimeBeforeRank0    | 250.534 ms                | 642.434 ms                |
| BlockToStepN              | 18.106 us                 | 70.133 us                 |
| OneStep                   | 1.066 s                   | 2.103 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 952.660 us                | 14.469 ms                 |
| Forward                   | 6.431 ms                  | 8.732 ms                  |
| Backward                  | 776.198 ms                | 1.749 s                   |
| Optimize                  | 1.816 ms                  | 2.927 ms                  |
| BarrierTimeBeforeRank0    | 251.012 ms                | 642.434 ms                |
| BlockToStepN              | 18.106 us                 | 70.133 us                 |
| OneStep                   | 1.073 s                   | 2.105 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 951.821 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.465 ms                  |
| Backward                  | 784.580 ms                | 1.747 s                   |
| Optimize                  | 1.814 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 251.350 ms                | 642.434 ms                |
| BlockToStepN              | 18.117 us                 | 69.039 us                 |
| OneStep                   | 1.085 s                   | 2.112 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 951.821 us                | 14.271 ms                 |
| Forward                   | 6.428 ms                  | 8.465 ms                  |
| Backward                  | 785.127 ms                | 1.749 s                   |
| Optimize                  | 1.814 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 253.225 ms                | 651.028 ms                |
| BlockToStepN              | 18.190 us                 | 70.133 us                 |
| OneStep                   | 1.088 s                   | 2.115 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 952.770 us                | 14.271 ms                 |
| Forward                   | 6.428 ms                  | 8.465 ms                  |
| Backward                  | 788.588 ms                | 1.751 s                   |
| Optimize                  | 1.814 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 253.408 ms                | 651.746 ms                |
| BlockToStepN              | 18.190 us                 | 70.133 us                 |
| OneStep                   | 1.089 s                   | 2.135 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 953.299 us                | 14.271 ms                 |
| Forward                   | 6.428 ms                  | 8.465 ms                  |
| Backward                  | 790.820 ms                | 1.751 s                   |
| Optimize                  | 1.816 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 255.801 ms                | 651.746 ms                |
| BlockToStepN              | 18.208 us                 | 70.133 us                 |
| OneStep                   | 1.090 s                   | 2.144 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 953.299 us                | 14.271 ms                 |
| Forward                   | 6.431 ms                  | 8.465 ms                  |
| Backward                  | 794.766 ms                | 1.756 s                   |
| Optimize                  | 1.816 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 255.989 ms                | 651.746 ms                |
| BlockToStepN              | 18.208 us                 | 70.133 us                 |
| OneStep                   | 1.098 s                   | 2.148 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 954.315 us                | 14.271 ms                 |
| Forward                   | 6.439 ms                  | 8.465 ms                  |
| Backward                  | 795.498 ms                | 1.763 s                   |
| Optimize                  | 1.820 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 256.095 ms                | 652.968 ms                |
| BlockToStepN              | 18.208 us                 | 70.133 us                 |
| OneStep                   | 1.100 s                   | 2.163 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 954.315 us                | 14.271 ms                 |
| Forward                   | 6.444 ms                  | 8.465 ms                  |
| Backward                  | 802.238 ms                | 1.764 s                   |
| Optimize                  | 1.820 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 259.127 ms                | 665.358 ms                |
| BlockToStepN              | 18.242 us                 | 70.133 us                 |
| OneStep                   | 1.107 s                   | 2.173 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 954.315 us                | 14.271 ms                 |
| Forward                   | 6.444 ms                  | 8.465 ms                  |
| Backward                  | 802.281 ms                | 1.780 s                   |
| Optimize                  | 1.817 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 260.262 ms                | 665.358 ms                |
| BlockToStepN              | 18.242 us                 | 70.133 us                 |
| OneStep                   | 1.115 s                   | 2.181 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 954.315 us                | 14.271 ms                 |
| Forward                   | 6.444 ms                  | 8.465 ms                  |
| Backward                  | 808.719 ms                | 1.781 s                   |
| Optimize                  | 1.820 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 260.264 ms                | 666.381 ms                |
| BlockToStepN              | 18.242 us                 | 70.133 us                 |
| OneStep                   | 1.119 s                   | 2.189 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 956.199 us                | 14.271 ms                 |
| Forward                   | 6.445 ms                  | 8.465 ms                  |
| Backward                  | 817.047 ms                | 1.805 s                   |
| Optimize                  | 1.817 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 260.412 ms                | 672.085 ms                |
| BlockToStepN              | 18.242 us                 | 70.133 us                 |
| OneStep                   | 1.128 s                   | 2.202 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 958.544 us                | 14.271 ms                 |
| Forward                   | 6.445 ms                  | 8.465 ms                  |
| Backward                  | 822.216 ms                | 1.806 s                   |
| Optimize                  | 1.820 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 261.228 ms                | 672.085 ms                |
| BlockToStepN              | 18.242 us                 | 70.133 us                 |
| OneStep                   | 1.132 s                   | 2.236 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 958.544 us                | 14.271 ms                 |
| Forward                   | 6.448 ms                  | 8.465 ms                  |
| Backward                  | 830.470 ms                | 1.816 s                   |
| Optimize                  | 1.820 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 261.497 ms                | 672.085 ms                |
| BlockToStepN              | 18.330 us                 | 70.133 us                 |
| OneStep                   | 1.138 s                   | 2.263 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 956.512 us                | 14.271 ms                 |
| Forward                   | 6.448 ms                  | 8.465 ms                  |
| Backward                  | 836.254 ms                | 1.837 s                   |
| Optimize                  | 1.822 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 262.873 ms                | 672.085 ms                |
| BlockToStepN              | 18.330 us                 | 70.133 us                 |
| OneStep                   | 1.147 s                   | 2.263 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 958.544 us                | 14.271 ms                 |
| Forward                   | 6.448 ms                  | 8.465 ms                  |
| Backward                  | 839.317 ms                | 1.838 s                   |
| Optimize                  | 1.822 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 263.102 ms                | 673.455 ms                |
| BlockToStepN              | 18.372 us                 | 70.133 us                 |
| OneStep                   | 1.151 s                   | 2.278 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 956.512 us                | 14.271 ms                 |
| Forward                   | 6.449 ms                  | 8.465 ms                  |
| Backward                  | 848.291 ms                | 1.843 s                   |
| Optimize                  | 1.822 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 263.622 ms                | 673.455 ms                |
| BlockToStepN              | 18.372 us                 | 70.133 us                 |
| OneStep                   | 1.152 s                   | 2.278 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 956.512 us                | 14.271 ms                 |
| Forward                   | 6.449 ms                  | 8.465 ms                  |
| Backward                  | 850.241 ms                | 1.845 s                   |
| Optimize                  | 1.822 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 264.202 ms                | 686.140 ms                |
| BlockToStepN              | 18.416 us                 | 70.133 us                 |
| OneStep                   | 1.156 s                   | 2.279 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 956.512 us                | 14.271 ms                 |
| Forward                   | 6.449 ms                  | 8.465 ms                  |
| Backward                  | 856.861 ms                | 1.846 s                   |
| Optimize                  | 1.822 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 264.956 ms                | 686.140 ms                |
| BlockToStepN              | 18.416 us                 | 70.133 us                 |
| OneStep                   | 1.159 s                   | 2.279 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 958.544 us                | 14.271 ms                 |
| Forward                   | 6.449 ms                  | 8.465 ms                  |
| Backward                  | 857.889 ms                | 1.851 s                   |
| Optimize                  | 1.823 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 265.574 ms                | 686.140 ms                |
| BlockToStepN              | 18.416 us                 | 70.133 us                 |
| OneStep                   | 1.167 s                   | 2.302 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 958.544 us                | 14.271 ms                 |
| Forward                   | 6.449 ms                  | 8.465 ms                  |
| Backward                  | 860.158 ms                | 1.867 s                   |
| Optimize                  | 1.822 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 265.617 ms                | 686.140 ms                |
| BlockToStepN              | 18.452 us                 | 70.133 us                 |
| OneStep                   | 1.168 s                   | 2.302 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 958.544 us                | 14.271 ms                 |
| Forward                   | 6.448 ms                  | 8.465 ms                  |
| Backward                  | 868.361 ms                | 1.878 s                   |
| Optimize                  | 1.823 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 265.681 ms                | 687.851 ms                |
| BlockToStepN              | 18.452 us                 | 70.133 us                 |
| OneStep                   | 1.171 s                   | 2.313 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 959.591 us                | 14.271 ms                 |
| Forward                   | 6.449 ms                  | 8.465 ms                  |
| Backward                  | 879.563 ms                | 1.878 s                   |
| Optimize                  | 1.826 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 266.601 ms                | 687.851 ms                |
| BlockToStepN              | 18.469 us                 | 70.133 us                 |
| OneStep                   | 1.174 s                   | 2.314 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 959.908 us                | 14.271 ms                 |
| Forward                   | 6.449 ms                  | 8.465 ms                  |
| Backward                  | 880.382 ms                | 1.900 s                   |
| Optimize                  | 1.827 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 267.541 ms                | 695.785 ms                |
| BlockToStepN              | 18.500 us                 | 70.133 us                 |
| OneStep                   | 1.183 s                   | 2.320 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 213.045, sample: 0.217, forward: 0.548, backward: 202.619, update: 0.165
[proc 3] 500 steps, total: 213.045, sample: 0.221, forward: 0.555, backward: 135.093, update: 0.186
[proc 1] 500 steps, total: 213.045, sample: 0.212, forward: 0.579, backward: 211.546, update: 0.158
[proc 0] 500 steps, total: 213.045, sample: 0.250, forward: 0.657, backward: 164.040, update: 0.205
Successfully xmh. training takes 598.1036703586578 seconds
before call kg_cache_controller.StopThreads()
INFO [439416 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
INFO [439416 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 959.591 us                | 14.271 ms                 |
| Forward                   | 6.449 ms                  | 8.465 ms                  |
| Backward                  | 882.795 ms                | 1.913 s                   |
| Optimize                  | 1.833 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 267.541 ms                | 695.785 ms                |
| BlockToStepN              | 18.469 us                 | 70.133 us                 |
| OneStep                   | 1.193 s                   | 2.322 s                   |
+---------------------------+---------------------------+---------------------------+
