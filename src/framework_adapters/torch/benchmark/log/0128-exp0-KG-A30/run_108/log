WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 13:56:16.778698 226014 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='DistMult', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/DistMult_FB15k_48', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [226014 sampler.py:454] Start PreSampling
WARNING [226014 sampler.py:532] Before construct renumbering_dict
WARNING [226014 sampler.py:555] PreSampling done
W20240128 13:56:19.184360 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 13:56:19.184517 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 13:56:19.184541 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 13:56:19.184572 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 13:56:19.184593 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 13:56:19.184618 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 13:56:19.184645 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 13:56:19.184674 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 13:56:19.184695 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 13:56:19.184718 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 13:56:19.184749 226014 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 13:56:19.184770 226014 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 13:56:19.184793 226014 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 13:56:19.184881 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 13:56:19.184909 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 13:56:19.184928 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 13:56:19.184963 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 13:56:19.184981 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 13:56:19.185000 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 13:56:19.185019 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 13:56:19.185042 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 13:56:19.185070 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 13:56:19.185097 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 13:56:19.185119 226014 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 13:56:19.185135 226014 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 13:56:19.185150 226014 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 13:56:19.185197 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 13:56:19.185223 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 13:56:19.185240 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 13:56:19.185257 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 13:56:19.185274 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 13:56:19.185297 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 13:56:19.185314 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 13:56:19.185343 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 13:56:19.185361 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 13:56:19.185379 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 13:56:19.185395 226014 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 13:56:19.185411 226014 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 13:56:19.185425 226014 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 13:56:19.185465 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 13:56:19.185487 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 13:56:19.185505 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 13:56:19.185523 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 13:56:19.185539 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 13:56:19.185561 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 13:56:19.185578 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 13:56:19.185595 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 13:56:19.185623 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 13:56:19.185642 226014 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 13:56:19.185660 226014 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 13:56:19.185674 226014 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 13:56:19.185689 226014 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 13:56:19.316807 226014 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 13:56:19.316939 226014 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([1615, 1835, 1884,  ..., 2108, 5115, 6445]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.570 seconds
[Rank1] pid = 226337
[Rank2] pid = 226402
INFO [226014 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [226337 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [226466 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [226402 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [226466 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [226402 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [226402 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [226466 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [226402 cache_common.py:139] TorchNativeStdEmb construct done
INFO [226466 cache_common.py:139] TorchNativeStdEmb construct done
INFO [226337 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [226014 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
WARNING [226402 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [226466 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [226337 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [226014 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [226337 cache_common.py:139] TorchNativeStdEmb construct done
INFO [226014 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [226337 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [226014 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 13:56:22.535389 226467 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 13:56:22.535490 226338 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 13:56:22.535714 226468 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 13:56:22.535902 226403 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 13:56:23.977054 226338 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 13:56:23.996984 226403 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 13:56:23.998056 226468 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 13:56:23.999325 226467 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 773.377 us                | 11.515 ms                 |
| Forward                   | 4.058 ms                  | 727.994 ms                |
| Backward                  | 35.048 ms                 | 1.513 s                   |
| Optimize                  | 1.075 ms                  | 38.402 ms                 |
| BarrierTimeBeforeRank0    | 49.612 us                 | 79.362 ms                 |
| BlockToStepN              | 7.949 us                  | 114.290 us                |
| OneStep                   | 40.906 ms                 | 1.525 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 760.048 us                | 9.590 ms                  |
| Forward                   | 4.039 ms                  | 8.987 ms                  |
| Backward                  | 84.634 ms                 | 289.562 ms                |
| Optimize                  | 1.022 ms                  | 4.495 ms                  |
| BarrierTimeBeforeRank0    | 40.842 us                 | 15.839 ms                 |
| BlockToStepN              | 8.990 us                  | 114.290 us                |
| OneStep                   | 93.784 ms                 | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 749.313 us                | 9.590 ms                  |
| Forward                   | 3.985 ms                  | 8.987 ms                  |
| Backward                  | 109.406 ms                | 289.562 ms                |
| Optimize                  | 1.004 ms                  | 4.495 ms                  |
| BarrierTimeBeforeRank0    | 36.205 us                 | 15.839 ms                 |
| BlockToStepN              | 8.198 us                  | 114.290 us                |
| OneStep                   | 115.793 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
[Rank3] pid = 226466
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 8552,   151,  8643,  6166, 10461,  4899, 11081,  5816, 13801,   112]) tensor([ 1884, 10640,  8723,  1471,  6142,  8146, 11448,  8432,  6965,  7160])
-------Step 1-------
tensor([ 8552,   151,  8643,  6166, 10461,  4899, 11081,  5816, 13801,   112]) tensor([ 9888, 13392,  9290, 11225,  6322,  8009,  8301,  2106,  3079, 10348])
-------Step 2-------
tensor([11611,  3223,  3674,    23,   728,   323,   261, 13371, 10254,  7393]) tensor([ 8954,  5305,  3398, 14369,  2084,  2634, 10689,  5006, 13500,  7211])
-------Step 3-------
tensor([11611,  3223,  3674,    23,   728,   323,   261, 13371, 10254,  7393]) tensor([  497, 13442,  6048, 11067,    74,   602,  2933,  9149,  6536,   294])
-------Step 4-------
tensor([ 3357, 14774,  9839,  9140,  7028,  5434, 14333,  7231,  4158,  1979]) tensor([13538,   949,  8207,  9148,  4231,   722,  8571,  1047, 12664, 13999])
-------Step 5-------
tensor([ 3357, 14774,  9839,  9140,  7028,  5434, 14333,  7231,  4158,  1979]) tensor([ 9218,  5532,  7486, 13206,  1295, 12333,  3813, 12148,  6589,  8360])
-------Step 6-------
tensor([ 9960,   607,  9051,   132, 10103, 12096, 11824,  9839,  9362,  5429]) tensor([ 2964, 10779,  8726, 11634,  8422,  9847,  1851,  3377, 12464,  1282])
-------Step 7-------
tensor([ 9960,   607,  9051,   132, 10103, 12096, 11824,  9839,  9362,  5429]) tensor([ 4219, 14764, 11761,  6330,  6500,   925,  8794,  1060,  9100, 11672])
-------Step 8-------
tensor([12765,  7584, 14644, 12322,  4266,  5550,  1762,  7199,  4520, 12077]) tensor([ 9051, 13032, 14282,  1705, 12874,  9261,  2642, 11790,  6410,  6631])
-------Step 9-------
tensor([12765,  7584, 14644, 12322,  4266,  5550,  1762,  7199,  4520, 12077]) tensor([12265,  8896,  1760,  3428,  2206,   671,  8045,  3787,  3079, 14903])
before start barrier
start train
[proc 0] 100 steps, total: 13.610, sample: 0.173, forward: 1.124, backward: 11.954, update: 0.135
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 13.611, sample: 0.171, forward: 1.084, backward: 11.079, update: 0.140
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 13.632, sample: 0.161, forward: 1.095, backward: 11.561, update: 0.141
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 13.612, sample: 0.155, forward: 1.075, backward: 10.570, update: 0.170
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 748.196 us                | 9.590 ms                  |
| Forward                   | 3.962 ms                  | 8.987 ms                  |
| Backward                  | 119.320 ms                | 289.562 ms                |
| Optimize                  | 1.006 ms                  | 4.495 ms                  |
| BarrierTimeBeforeRank0    | 35.976 us                 | 28.623 ms                 |
| BlockToStepN              | 8.133 us                  | 114.290 us                |
| OneStep                   | 127.083 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 736.330 us                | 9.590 ms                  |
| Forward                   | 3.954 ms                  | 8.987 ms                  |
| Backward                  | 136.745 ms                | 289.562 ms                |
| Optimize                  | 1.005 ms                  | 4.495 ms                  |
| BarrierTimeBeforeRank0    | 35.648 us                 | 32.823 ms                 |
| BlockToStepN              | 8.057 us                  | 114.290 us                |
| OneStep                   | 142.685 ms                | 1.137 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 737.719 us                | 9.580 ms                  |
| Forward                   | 3.959 ms                  | 6.517 ms                  |
| Backward                  | 155.468 ms                | 305.024 ms                |
| Optimize                  | 1.006 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 35.651 us                 | 28.623 ms                 |
| BlockToStepN              | 8.148 us                  | 59.395 us                 |
| OneStep                   | 162.265 ms                | 316.308 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.189 us                | 9.580 ms                  |
| Forward                   | 3.949 ms                  | 6.517 ms                  |
| Backward                  | 165.954 ms                | 343.440 ms                |
| Optimize                  | 1.005 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 35.328 us                 | 28.623 ms                 |
| BlockToStepN              | 8.133 us                  | 59.395 us                 |
| OneStep                   | 171.680 ms                | 353.179 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 736.069 us                | 9.580 ms                  |
| Forward                   | 3.949 ms                  | 6.517 ms                  |
| Backward                  | 178.622 ms                | 388.119 ms                |
| Optimize                  | 1.006 ms                  | 1.672 ms                  |
| BarrierTimeBeforeRank0    | 34.791 us                 | 32.823 ms                 |
| BlockToStepN              | 8.148 us                  | 59.395 us                 |
| OneStep                   | 184.581 ms                | 397.881 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 200 steps, total: 29.082, sample: 0.161, forward: 0.349, backward: 26.860, update: 0.098
[proc 0] 200 steps, total: 29.082, sample: 0.167, forward: 0.385, backward: 28.132, update: 0.100
[proc 3] 200 steps, total: 29.082, sample: 0.165, forward: 0.336, backward: 25.437, update: 0.087
[proc 2] 200 steps, total: 29.082, sample: 0.163, forward: 0.335, backward: 24.949, update: 0.107
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 733.920 us                | 9.580 ms                  |
| Forward                   | 3.936 ms                  | 6.517 ms                  |
| Backward                  | 192.010 ms                | 391.660 ms                |
| Optimize                  | 1.005 ms                  | 1.672 ms                  |
| BarrierTimeBeforeRank0    | 34.434 us                 | 32.823 ms                 |
| BlockToStepN              | 8.226 us                  | 59.395 us                 |
| OneStep                   | 204.057 ms                | 417.577 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 733.920 us                | 9.580 ms                  |
| Forward                   | 3.936 ms                  | 6.517 ms                  |
| Backward                  | 204.636 ms                | 411.733 ms                |
| Optimize                  | 1.009 ms                  | 1.672 ms                  |
| BarrierTimeBeforeRank0    | 34.400 us                 | 32.823 ms                 |
| BlockToStepN              | 8.412 us                  | 62.860 us                 |
| OneStep                   | 212.539 ms                | 426.185 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 733.920 us                | 9.580 ms                  |
| Forward                   | 3.936 ms                  | 6.517 ms                  |
| Backward                  | 213.909 ms                | 453.132 ms                |
| Optimize                  | 1.010 ms                  | 1.672 ms                  |
| BarrierTimeBeforeRank0    | 34.269 us                 | 32.823 ms                 |
| BlockToStepN              | 8.430 us                  | 62.860 us                 |
| OneStep                   | 221.466 ms                | 469.908 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 732.953 us                | 9.580 ms                  |
| Forward                   | 3.934 ms                  | 6.517 ms                  |
| Backward                  | 224.490 ms                | 463.694 ms                |
| Optimize                  | 1.010 ms                  | 1.672 ms                  |
| BarrierTimeBeforeRank0    | 34.008 us                 | 32.823 ms                 |
| BlockToStepN              | 8.552 us                  | 62.860 us                 |
| OneStep                   | 234.650 ms                | 472.490 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 733.920 us                | 9.580 ms                  |
| Forward                   | 3.934 ms                  | 6.517 ms                  |
| Backward                  | 235.918 ms                | 486.426 ms                |
| Optimize                  | 1.006 ms                  | 1.672 ms                  |
| BarrierTimeBeforeRank0    | 33.839 us                 | 32.823 ms                 |
| BlockToStepN              | 8.615 us                  | 62.860 us                 |
| OneStep                   | 243.361 ms                | 500.985 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 733.340 us                | 9.508 ms                  |
| Forward                   | 3.925 ms                  | 5.564 ms                  |
| Backward                  | 242.865 ms                | 510.318 ms                |
| Optimize                  | 1.006 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.687 us                 | 32.733 ms                 |
| BlockToStepN              | 8.637 us                  | 59.395 us                 |
| OneStep                   | 254.753 ms                | 517.204 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 733.920 us                | 9.508 ms                  |
| Forward                   | 3.921 ms                  | 5.564 ms                  |
| Backward                  | 249.894 ms                | 514.633 ms                |
| Optimize                  | 1.011 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.656 us                 | 32.733 ms                 |
| BlockToStepN              | 8.681 us                  | 59.395 us                 |
| OneStep                   | 261.298 ms                | 538.804 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.161 us                | 9.508 ms                  |
| Forward                   | 3.925 ms                  | 5.564 ms                  |
| Backward                  | 262.459 ms                | 526.653 ms                |
| Optimize                  | 1.011 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.590 us                 | 32.733 ms                 |
| BlockToStepN              | 8.691 us                  | 59.395 us                 |
| OneStep                   | 270.662 ms                | 542.947 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.161 us                | 9.508 ms                  |
| Forward                   | 3.925 ms                  | 6.102 ms                  |
| Backward                  | 271.945 ms                | 556.208 ms                |
| Optimize                  | 1.013 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.429 us                 | 32.733 ms                 |
| BlockToStepN              | 8.691 us                  | 59.395 us                 |
| OneStep                   | 284.907 ms                | 569.096 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.385 us                | 9.508 ms                  |
| Forward                   | 3.934 ms                  | 6.102 ms                  |
| Backward                  | 278.092 ms                | 568.537 ms                |
| Optimize                  | 1.015 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.330 us                 | 32.733 ms                 |
| BlockToStepN              | 8.691 us                  | 62.860 us                 |
| OneStep                   | 288.531 ms                | 582.665 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 47.841, sample: 0.160, forward: 0.335, backward: 40.828, update: 0.108
[proc 3] 300 steps, total: 47.841, sample: 0.162, forward: 0.336, backward: 41.352, update: 0.090
[proc 0] 300 steps, total: 47.841, sample: 0.158, forward: 0.390, backward: 47.042, update: 0.104
[proc 1] 300 steps, total: 47.841, sample: 0.151, forward: 0.343, backward: 43.975, update: 0.097
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.161 us                | 9.508 ms                  |
| Forward                   | 3.925 ms                  | 6.102 ms                  |
| Backward                  | 286.427 ms                | 592.951 ms                |
| Optimize                  | 1.016 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.327 us                 | 32.733 ms                 |
| BlockToStepN              | 8.691 us                  | 62.860 us                 |
| OneStep                   | 296.638 ms                | 605.277 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.272 us                | 9.508 ms                  |
| Forward                   | 3.925 ms                  | 6.102 ms                  |
| Backward                  | 292.506 ms                | 603.373 ms                |
| Optimize                  | 1.016 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.330 us                 | 32.733 ms                 |
| BlockToStepN              | 8.770 us                  | 62.860 us                 |
| OneStep                   | 302.102 ms                | 614.629 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.272 us                | 9.508 ms                  |
| Forward                   | 3.928 ms                  | 6.102 ms                  |
| Backward                  | 300.261 ms                | 617.664 ms                |
| Optimize                  | 1.022 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.330 us                 | 32.733 ms                 |
| BlockToStepN              | 8.771 us                  | 62.860 us                 |
| OneStep                   | 310.879 ms                | 630.456 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.385 us                | 9.508 ms                  |
| Forward                   | 3.925 ms                  | 6.102 ms                  |
| Backward                  | 305.024 ms                | 631.810 ms                |
| Optimize                  | 1.023 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.327 us                 | 32.733 ms                 |
| BlockToStepN              | 8.801 us                  | 62.860 us                 |
| OneStep                   | 313.405 ms                | 650.434 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.385 us                | 9.508 ms                  |
| Forward                   | 3.934 ms                  | 6.102 ms                  |
| Backward                  | 310.338 ms                | 636.699 ms                |
| Optimize                  | 1.023 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.327 us                 | 32.733 ms                 |
| BlockToStepN              | 8.771 us                  | 62.860 us                 |
| OneStep                   | 322.342 ms                | 671.601 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.189 us                | 9.508 ms                  |
| Forward                   | 3.934 ms                  | 6.102 ms                  |
| Backward                  | 318.479 ms                | 682.279 ms                |
| Optimize                  | 1.024 ms                  | 1.658 ms                  |
| BarrierTimeBeforeRank0    | 33.249 us                 | 32.733 ms                 |
| BlockToStepN              | 8.801 us                  | 62.860 us                 |
| OneStep                   | 328.982 ms                | 689.973 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.189 us                | 9.443 ms                  |
| Forward                   | 3.934 ms                  | 5.564 ms                  |
| Backward                  | 331.578 ms                | 683.621 ms                |
| Optimize                  | 1.025 ms                  | 1.641 ms                  |
| BarrierTimeBeforeRank0    | 33.075 us                 | 28.623 ms                 |
| BlockToStepN              | 8.821 us                  | 59.395 us                 |
| OneStep                   | 340.726 ms                | 697.048 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 736.069 us                | 9.443 ms                  |
| Forward                   | 3.934 ms                  | 5.564 ms                  |
| Backward                  | 343.440 ms                | 710.542 ms                |
| Optimize                  | 1.027 ms                  | 1.641 ms                  |
| BarrierTimeBeforeRank0    | 32.776 us                 | 28.623 ms                 |
| BlockToStepN              | 8.877 us                  | 59.395 us                 |
| OneStep                   | 353.179 ms                | 717.488 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 736.330 us                | 9.443 ms                  |
| Forward                   | 3.936 ms                  | 5.564 ms                  |
| Backward                  | 347.165 ms                | 717.446 ms                |
| Optimize                  | 1.031 ms                  | 1.641 ms                  |
| BarrierTimeBeforeRank0    | 33.032 us                 | 28.623 ms                 |
| BlockToStepN              | 8.985 us                  | 59.395 us                 |
| OneStep                   | 359.081 ms                | 725.324 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.718 us                | 9.443 ms                  |
| Forward                   | 3.949 ms                  | 5.564 ms                  |
| Backward                  | 352.703 ms                | 721.679 ms                |
| Optimize                  | 1.032 ms                  | 1.641 ms                  |
| BarrierTimeBeforeRank0    | 33.032 us                 | 28.623 ms                 |
| BlockToStepN              | 8.985 us                  | 59.395 us                 |
| OneStep                   | 367.508 ms                | 738.279 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.058 us                | 9.443 ms                  |
| Forward                   | 3.949 ms                  | 5.564 ms                  |
| Backward                  | 358.515 ms                | 734.942 ms                |
| Optimize                  | 1.034 ms                  | 1.641 ms                  |
| BarrierTimeBeforeRank0    | 32.877 us                 | 28.623 ms                 |
| BlockToStepN              | 8.995 us                  | 59.395 us                 |
| OneStep                   | 371.242 ms                | 751.635 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.058 us                | 9.443 ms                  |
| Forward                   | 3.954 ms                  | 5.564 ms                  |
| Backward                  | 365.444 ms                | 747.543 ms                |
| Optimize                  | 1.037 ms                  | 1.647 ms                  |
| BarrierTimeBeforeRank0    | 32.877 us                 | 30.265 ms                 |
| BlockToStepN              | 9.022 us                  | 59.395 us                 |
| OneStep                   | 375.884 ms                | 767.181 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.058 us                | 9.443 ms                  |
| Forward                   | 3.954 ms                  | 5.564 ms                  |
| Backward                  | 369.445 ms                | 760.977 ms                |
| Optimize                  | 1.037 ms                  | 1.647 ms                  |
| BarrierTimeBeforeRank0    | 32.776 us                 | 30.265 ms                 |
| BlockToStepN              | 9.044 us                  | 59.395 us                 |
| OneStep                   | 384.403 ms                | 770.587 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 67.030, sample: 0.156, forward: 0.339, backward: 61.890, update: 0.097
[proc 0] 400 steps, total: 67.030, sample: 0.161, forward: 0.393, backward: 66.096, update: 0.107
[proc 2] 400 steps, total: 67.030, sample: 0.152, forward: 0.328, backward: 56.334, update: 0.111
[proc 3] 400 steps, total: 67.030, sample: 0.152, forward: 0.331, backward: 57.399, update: 0.090
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.058 us                | 9.443 ms                  |
| Forward                   | 3.959 ms                  | 5.564 ms                  |
| Backward                  | 377.321 ms                | 772.156 ms                |
| Optimize                  | 1.039 ms                  | 1.647 ms                  |
| BarrierTimeBeforeRank0    | 32.776 us                 | 30.265 ms                 |
| BlockToStepN              | 9.078 us                  | 59.395 us                 |
| OneStep                   | 394.692 ms                | 784.552 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 737.719 us                | 9.443 ms                  |
| Forward                   | 3.959 ms                  | 5.564 ms                  |
| Backward                  | 385.525 ms                | 796.470 ms                |
| Optimize                  | 1.039 ms                  | 1.647 ms                  |
| BarrierTimeBeforeRank0    | 32.690 us                 | 30.265 ms                 |
| BlockToStepN              | 9.089 us                  | 59.395 us                 |
| OneStep                   | 396.338 ms                | 808.924 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 737.719 us                | 9.443 ms                  |
| Forward                   | 3.960 ms                  | 5.564 ms                  |
| Backward                  | 388.442 ms                | 805.135 ms                |
| Optimize                  | 1.039 ms                  | 1.647 ms                  |
| BarrierTimeBeforeRank0    | 32.690 us                 | 30.265 ms                 |
| BlockToStepN              | 9.117 us                  | 59.395 us                 |
| OneStep                   | 398.049 ms                | 813.985 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.519 us                | 9.443 ms                  |
| Forward                   | 3.960 ms                  | 5.564 ms                  |
| Backward                  | 391.660 ms                | 830.374 ms                |
| Optimize                  | 1.043 ms                  | 1.702 ms                  |
| BarrierTimeBeforeRank0    | 32.776 us                 | 30.265 ms                 |
| BlockToStepN              | 9.119 us                  | 62.860 us                 |
| OneStep                   | 402.392 ms                | 873.976 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.103 us                | 9.443 ms                  |
| Forward                   | 3.961 ms                  | 5.564 ms                  |
| Backward                  | 397.161 ms                | 902.614 ms                |
| Optimize                  | 1.043 ms                  | 1.702 ms                  |
| BarrierTimeBeforeRank0    | 32.776 us                 | 32.823 ms                 |
| BlockToStepN              | 9.158 us                  | 62.860 us                 |
| OneStep                   | 404.150 ms                | 924.922 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.103 us                | 9.443 ms                  |
| Forward                   | 3.961 ms                  | 5.564 ms                  |
| Backward                  | 399.188 ms                | 902.614 ms                |
| Optimize                  | 1.043 ms                  | 1.702 ms                  |
| BarrierTimeBeforeRank0    | 32.778 us                 | 32.823 ms                 |
| BlockToStepN              | 9.208 us                  | 66.310 us                 |
| OneStep                   | 407.127 ms                | 924.922 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.208 us                | 9.443 ms                  |
| Forward                   | 3.962 ms                  | 5.564 ms                  |
| Backward                  | 409.275 ms                | 902.614 ms                |
| Optimize                  | 1.043 ms                  | 1.702 ms                  |
| BarrierTimeBeforeRank0    | 33.075 us                 | 58.786 ms                 |
| BlockToStepN              | 9.208 us                  | 66.310 us                 |
| OneStep                   | 417.577 ms                | 924.922 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.208 us                | 9.443 ms                  |
| Forward                   | 3.962 ms                  | 5.564 ms                  |
| Backward                  | 412.639 ms                | 902.614 ms                |
| Optimize                  | 1.043 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.075 us                 | 62.714 ms                 |
| BlockToStepN              | 9.217 us                  | 66.310 us                 |
| OneStep                   | 426.185 ms                | 924.922 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.208 us                | 9.443 ms                  |
| Forward                   | 3.962 ms                  | 5.564 ms                  |
| Backward                  | 419.861 ms                | 902.614 ms                |
| Optimize                  | 1.045 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.249 us                 | 62.714 ms                 |
| BlockToStepN              | 9.221 us                  | 66.310 us                 |
| OneStep                   | 428.050 ms                | 924.922 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.499 us                | 9.433 ms                  |
| Forward                   | 3.963 ms                  | 5.502 ms                  |
| Backward                  | 423.063 ms                | 901.997 ms                |
| Optimize                  | 1.045 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.327 us                 | 58.786 ms                 |
| BlockToStepN              | 9.255 us                  | 62.860 us                 |
| OneStep                   | 432.891 ms                | 922.962 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.208 us                | 9.433 ms                  |
| Forward                   | 3.962 ms                  | 5.502 ms                  |
| Backward                  | 431.721 ms                | 912.563 ms                |
| Optimize                  | 1.046 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.327 us                 | 58.786 ms                 |
| BlockToStepN              | 9.294 us                  | 66.310 us                 |
| OneStep                   | 439.612 ms                | 927.382 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.208 us                | 9.433 ms                  |
| Forward                   | 3.962 ms                  | 5.502 ms                  |
| Backward                  | 434.753 ms                | 920.793 ms                |
| Optimize                  | 1.046 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.327 us                 | 58.786 ms                 |
| BlockToStepN              | 9.300 us                  | 66.310 us                 |
| OneStep                   | 446.943 ms                | 931.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 742.730 us                | 9.433 ms                  |
| Forward                   | 3.962 ms                  | 5.502 ms                  |
| Backward                  | 442.890 ms                | 925.656 ms                |
| Optimize                  | 1.046 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.249 us                 | 58.786 ms                 |
| BlockToStepN              | 9.367 us                  | 66.310 us                 |
| OneStep                   | 451.118 ms                | 941.519 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 742.730 us                | 9.433 ms                  |
| Forward                   | 3.961 ms                  | 5.502 ms                  |
| Backward                  | 445.326 ms                | 935.289 ms                |
| Optimize                  | 1.045 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.177 us                 | 58.786 ms                 |
| BlockToStepN              | 9.367 us                  | 66.310 us                 |
| OneStep                   | 457.944 ms                | 964.074 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 742.749 us                | 9.433 ms                  |
| Forward                   | 3.963 ms                  | 5.502 ms                  |
| Backward                  | 454.964 ms                | 957.999 ms                |
| Optimize                  | 1.048 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.249 us                 | 58.786 ms                 |
| BlockToStepN              | 9.404 us                  | 66.310 us                 |
| OneStep                   | 463.114 ms                | 971.006 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 742.749 us                | 9.433 ms                  |
| Forward                   | 3.962 ms                  | 5.502 ms                  |
| Backward                  | 458.937 ms                | 964.838 ms                |
| Optimize                  | 1.051 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.177 us                 | 58.786 ms                 |
| BlockToStepN              | 9.413 us                  | 71.098 us                 |
| OneStep                   | 466.655 ms                | 978.066 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 743.879 us                | 9.433 ms                  |
| Forward                   | 3.965 ms                  | 5.502 ms                  |
| Backward                  | 463.694 ms                | 964.838 ms                |
| Optimize                  | 1.052 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.249 us                 | 58.786 ms                 |
| BlockToStepN              | 9.425 us                  | 71.098 us                 |
| OneStep                   | 472.490 ms                | 978.066 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 745.019 us                | 9.433 ms                  |
| Forward                   | 3.965 ms                  | 5.502 ms                  |
| Backward                  | 468.492 ms                | 964.838 ms                |
| Optimize                  | 1.053 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.308 us                 | 58.786 ms                 |
| BlockToStepN              | 9.425 us                  | 71.098 us                 |
| OneStep                   | 476.291 ms                | 978.066 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 87.870, sample: 0.163, forward: 0.399, backward: 86.485, update: 0.112
[proc 2] 500 steps, total: 87.870, sample: 0.169, forward: 0.333, backward: 72.283, update: 0.111
[proc 3] 500 steps, total: 87.870, sample: 0.157, forward: 0.338, backward: 74.848, update: 0.100
[proc 1] 500 steps, total: 87.870, sample: 0.155, forward: 0.356, backward: 80.007, update: 0.107
Successfully xmh. training takes 245.43273305892944 seconds
before call kg_cache_controller.StopThreads()
INFO [226014 controller_process.py:414] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
INFO [226014 controller_process.py:414] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 744.373 us                | 9.433 ms                  |
| Forward                   | 3.965 ms                  | 5.502 ms                  |
| Backward                  | 470.777 ms                | 971.639 ms                |
| Optimize                  | 1.053 ms                  | 1.707 ms                  |
| BarrierTimeBeforeRank0    | 33.308 us                 | 58.786 ms                 |
| BlockToStepN              | 9.432 us                  | 71.098 us                 |
| OneStep                   | 477.963 ms                | 982.093 ms                |
+---------------------------+---------------------------+---------------------------+
