WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 17:55:36.108644 608347 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_18', no_save_emb=True, max_step=500, batch_size=2400, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.01, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [608347 sampler.py:454] Start PreSampling
WARNING [608347 sampler.py:532] Before construct renumbering_dict
WARNING [608347 sampler.py:555] PreSampling done
W20240128 17:55:38.305846 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 17:55:38.305967 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 17:55:38.305989 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 17:55:38.306008 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 17:55:38.306025 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 17:55:38.306041 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 17:55:38.306058 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 17:55:38.306082 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 17:55:38.306107 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 17:55:38.306128 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 17:55:38.306151 608347 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 17:55:38.306174 608347 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 17:55:38.306191 608347 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 17:55:38.306277 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 17:55:38.306298 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 17:55:38.306313 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 17:55:38.306342 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 17:55:38.306357 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 17:55:38.306377 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 17:55:38.306396 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 17:55:38.306411 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 17:55:38.306429 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 17:55:38.306459 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 17:55:38.306476 608347 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 17:55:38.306490 608347 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 17:55:38.306505 608347 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 17:55:38.306543 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 17:55:38.306571 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 17:55:38.306591 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 17:55:38.306604 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 17:55:38.306619 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 17:55:38.306635 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 17:55:38.306653 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 17:55:38.306675 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 17:55:38.306695 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 17:55:38.306712 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 17:55:38.306730 608347 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 17:55:38.306741 608347 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 17:55:38.306757 608347 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 17:55:38.306789 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 17:55:38.306813 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 17:55:38.306828 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 17:55:38.306842 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 17:55:38.306864 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 17:55:38.306879 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 17:55:38.306897 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 17:55:38.306913 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 17:55:38.306928 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 17:55:38.306942 608347 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 17:55:38.306958 608347 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 17:55:38.306972 608347 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 17:55:38.306983 608347 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 17:55:38.455965 608347 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 17:55:38.456091 608347 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 37
Rank1: cached key size 37
Rank2: cached key size 37
Rank3: cached key size 37
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 307,  611,  703,  ..., 1126, 5722, 6606]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.379 seconds
[Rank1] pid = 608559
[Rank2] pid = 608624
INFO [608347 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [608559 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [608688 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [608624 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [608688 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [608347 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [608624 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [608347 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [608624 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [608347 cache_common.py:139] TorchNativeStdEmb construct done
INFO [608559 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [608624 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [608347 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [608559 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
WARNING [608624 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [608559 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [608559 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [608688 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [608688 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [608688 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 17:55:41.554250 608560 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 17:55:41.554360 608690 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 17:55:41.554472 608625 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 17:55:41.554564 608689 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240128 17:55:41.942754 608625 recstore.cc:66] init folly done
E20240128 17:55:41.942761 608689 recstore.cc:66] init folly done
E20240128 17:55:41.942772 608690 recstore.cc:66] init folly done
E20240128 17:55:41.942790 608560 recstore.cc:66] init folly done
I20240128 17:55:42.025188 608625 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 17:55:42.027134 608690 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 17:55:42.031554 608560 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 17:55:42.035213 608689 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 817.303 us                | 14.926 ms                 |
| Forward                   | 6.318 ms                  | 1.145 s                   |
| Backward                  | 79.212 ms                 | 1.028 s                   |
| Optimize                  | 1.516 ms                  | 46.543 ms                 |
| BarrierTimeBeforeRank0    | 36.997 us                 | 104.759 us                |
| BlockToStepN              | 8.390 us                  | 119.336 us                |
| OneStep                   | 88.155 ms                 | 1.573 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 14.926 ms                 |
| Forward                   | 6.295 ms                  | 1.145 s                   |
| Backward                  | 149.846 ms                | 1.028 s                   |
| Optimize                  | 1.555 ms                  | 46.543 ms                 |
| BarrierTimeBeforeRank0    | 34.902 us                 | 104.759 us                |
| BlockToStepN              | 9.111 us                  | 119.336 us                |
| OneStep                   | 159.492 ms                | 1.573 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 829.887 us                | 14.834 ms                 |
| Forward                   | 6.255 ms                  | 16.426 ms                 |
| Backward                  | 185.781 ms                | 378.991 ms                |
| Optimize                  | 1.555 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 9.714 us                  | 71.780 us                 |
| OneStep                   | 196.092 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.275 us                | 14.834 ms                 |
| Forward                   | 6.255 ms                  | 16.426 ms                 |
| Backward                  | 207.901 ms                | 388.817 ms                |
| Optimize                  | 1.548 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 104.759 us                |
| BlockToStepN              | 9.735 us                  | 71.780 us                 |
| OneStep                   | 220.402 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 837.499 us                | 14.834 ms                 |
| Forward                   | 6.239 ms                  | 16.426 ms                 |
| Backward                  | 237.154 ms                | 457.913 ms                |
| Optimize                  | 1.534 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.328 us                 | 1.108 ms                  |
| BlockToStepN              | 10.063 us                 | 71.780 us                 |
| OneStep                   | 246.125 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 29.064, sample: 0.195, forward: 1.125, backward: 23.714, update: 0.209
[Rank3] pid = 608688
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 149), (149, 298), (298, 447), (447, 596)]
train_sampler.Prefill()
-------Step 0-------
tensor([10724,  3050,  9174,  6387,  7608,  5142,  9819,  3744, 11899,  8795]) tensor([  703,  7494,  9276,  3063,  7491, 10038, 13691, 10567,  7215,  6752])
-------Step 1-------
tensor([10724,  3050,  9174,  6387,  7608,  5142,  9819,  3744, 11899,  8795]) tensor([ 1552,   245,  5077,  3531, 13388,    12, 13980,  4845,  4808,  7256])
-------Step 2-------
tensor([ 2914, 13939, 10640,    28,  4457,  5927, 12011,  6266,  3069,   791]) tensor([14090,  4580, 10400, 10065,  2976,  8875,  5851,   104,  9221, 13254])
-------Step 3-------
tensor([ 2914, 13939, 10640,    28,  4457,  5927, 12011,  6266,  3069,   791]) tensor([ 7800, 12968,  5766,  6406,  3405,  5915,    27,  6955,  6098, 12550])
-------Step 4-------
tensor([ 9365,  9453, 13578,  9141,  3935,  6263,   429,  4518,  4226, 14843]) tensor([ 6376, 10007, 13929,   445, 10673, 10208,  1000,  9226,  7230,  7959])
-------Step 5-------
tensor([ 9365,  9453, 13578,  9141,  3935,  6263,   429,  4518,  4226, 14843]) tensor([ 3540, 10733,  3477,  9587,  6175,  9147,  3094,   253, 14884,   835])
-------Step 6-------
tensor([ 4355, 10249, 13059,  9990,    22, 13088,  7211,  9281,  4677, 10524]) tensor([14782, 10901, 13828,   107, 12482,  8769,  7667,  1122,  5924,  9228])
-------Step 7-------
tensor([ 4355, 10249, 13059,  9990,    22, 13088,  7211,  9281,  4677, 10524]) tensor([ 5129,  4800,  9472, 12808,  5201,  7332,  7302, 12972, 14058,  5520])
-------Step 8-------
tensor([ 8232, 12523,     1,  5462,  1187,  6028,  2746,  2037,  2022,  5963]) tensor([ 6615, 10872, 12417, 14607,  6906,  7836,  5332,   995,  1483,  7797])
-------Step 9-------
tensor([ 8232, 12523,     1,  5462,  1187,  6028,  2746,  2037,  2022,  5963]) tensor([ 1151, 12479,    50, 13718,  1400,  4606,  2339,   436, 14777, 13770])
before start barrier
start train
[proc 0] 100 steps, total: 29.054, sample: 0.227, forward: 1.770, backward: 26.756, update: 0.203
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 29.062, sample: 0.220, forward: 1.676, backward: 17.888, update: 0.203
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 29.058, sample: 0.215, forward: 1.143, backward: 17.632, update: 0.170
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 836.275 us                | 14.834 ms                 |
| Forward                   | 6.195 ms                  | 16.426 ms                 |
| Backward                  | 256.029 ms                | 501.753 ms                |
| Optimize                  | 1.548 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.328 us                 | 1.108 ms                  |
| BlockToStepN              | 10.172 us                 | 71.780 us                 |
| OneStep                   | 264.480 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 837.499 us                | 14.834 ms                 |
| Forward                   | 6.150 ms                  | 16.426 ms                 |
| Backward                  | 280.171 ms                | 538.433 ms                |
| Optimize                  | 1.555 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.116 us                 | 1.108 ms                  |
| BlockToStepN              | 10.833 us                 | 71.780 us                 |
| OneStep                   | 294.048 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.328 us                | 14.834 ms                 |
| Forward                   | 6.144 ms                  | 16.426 ms                 |
| Backward                  | 302.261 ms                | 692.381 ms                |
| Optimize                  | 1.556 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.116 us                 | 8.952 ms                  |
| BlockToStepN              | 11.084 us                 | 71.780 us                 |
| OneStep                   | 311.350 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.328 us                | 14.834 ms                 |
| Forward                   | 6.123 ms                  | 16.426 ms                 |
| Backward                  | 324.333 ms                | 692.381 ms                |
| Optimize                  | 1.555 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 8.952 ms                  |
| BlockToStepN              | 11.431 us                 | 71.780 us                 |
| OneStep                   | 333.417 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 838.434 us                | 14.834 ms                 |
| Forward                   | 6.139 ms                  | 16.426 ms                 |
| Backward                  | 336.385 ms                | 692.381 ms                |
| Optimize                  | 1.559 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 8.952 ms                  |
| BlockToStepN              | 11.859 us                 | 71.780 us                 |
| OneStep                   | 345.562 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.586 us                | 14.834 ms                 |
| Forward                   | 6.139 ms                  | 16.426 ms                 |
| Backward                  | 359.611 ms                | 702.863 ms                |
| Optimize                  | 1.566 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.753 us                 | 8.952 ms                  |
| BlockToStepN              | 12.102 us                 | 84.401 us                 |
| OneStep                   | 374.550 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 839.668 us                | 14.834 ms                 |
| Forward                   | 6.144 ms                  | 16.426 ms                 |
| Backward                  | 376.756 ms                | 719.573 ms                |
| Optimize                  | 1.566 ms                  | 5.125 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 8.952 ms                  |
| BlockToStepN              | 12.479 us                 | 84.401 us                 |
| OneStep                   | 385.930 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 841.400 us                | 14.693 ms                 |
| Forward                   | 6.144 ms                  | 10.189 ms                 |
| Backward                  | 388.817 ms                | 774.173 ms                |
| Optimize                  | 1.574 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.347 us                 | 1.108 ms                  |
| BlockToStepN              | 13.290 us                 | 84.221 us                 |
| OneStep                   | 404.615 ms                | 835.345 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.822 us                | 14.693 ms                 |
| Forward                   | 6.139 ms                  | 10.189 ms                 |
| Backward                  | 401.510 ms                | 792.730 ms                |
| Optimize                  | 1.569 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.162 us                 | 1.108 ms                  |
| BlockToStepN              | 13.468 us                 | 84.221 us                 |
| OneStep                   | 413.316 ms                | 835.345 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.989 us                | 14.693 ms                 |
| Forward                   | 6.139 ms                  | 10.189 ms                 |
| Backward                  | 414.206 ms                | 810.675 ms                |
| Optimize                  | 1.574 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.347 us                 | 1.108 ms                  |
| BlockToStepN              | 14.034 us                 | 84.221 us                 |
| OneStep                   | 437.252 ms                | 835.345 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.047 us                | 14.693 ms                 |
| Forward                   | 6.139 ms                  | 10.189 ms                 |
| Backward                  | 428.629 ms                | 835.836 ms                |
| Optimize                  | 1.574 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.347 us                 | 1.108 ms                  |
| BlockToStepN              | 14.201 us                 | 84.221 us                 |
| OneStep                   | 443.378 ms                | 848.037 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.913 us                | 14.693 ms                 |
| Forward                   | 6.150 ms                  | 10.189 ms                 |
| Backward                  | 444.895 ms                | 856.826 ms                |
| Optimize                  | 1.569 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.363 us                 | 1.108 ms                  |
| BlockToStepN              | 14.219 us                 | 84.221 us                 |
| OneStep                   | 457.985 ms                | 881.110 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 14.693 ms                 |
| Forward                   | 6.154 ms                  | 10.189 ms                 |
| Backward                  | 457.913 ms                | 887.065 ms                |
| Optimize                  | 1.574 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.494 us                 | 1.108 ms                  |
| BlockToStepN              | 14.561 us                 | 84.221 us                 |
| OneStep                   | 474.533 ms                | 907.795 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.268 us                | 14.693 ms                 |
| Forward                   | 6.154 ms                  | 10.189 ms                 |
| Backward                  | 467.524 ms                | 919.022 ms                |
| Optimize                  | 1.569 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.494 us                 | 1.108 ms                  |
| BlockToStepN              | 15.019 us                 | 84.221 us                 |
| OneStep                   | 484.331 ms                | 943.264 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.407 us                | 14.693 ms                 |
| Forward                   | 6.154 ms                  | 10.189 ms                 |
| Backward                  | 485.429 ms                | 941.669 ms                |
| Optimize                  | 1.569 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.520 us                 | 1.108 ms                  |
| BlockToStepN              | 15.648 us                 | 84.221 us                 |
| OneStep                   | 506.644 ms                | 952.365 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 74.444, sample: 0.207, forward: 0.537, backward: 67.204, update: 0.174
[proc 3] 200 steps, total: 74.444, sample: 0.226, forward: 0.525, backward: 46.418, update: 0.157
[proc 1] 200 steps, total: 74.444, sample: 0.236, forward: 0.545, backward: 48.364, update: 0.141
[proc 0] 200 steps, total: 74.444, sample: 0.233, forward: 0.614, backward: 73.332, update: 0.171
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.407 us                | 14.693 ms                 |
| Forward                   | 6.165 ms                  | 10.189 ms                 |
| Backward                  | 501.203 ms                | 976.962 ms                |
| Optimize                  | 1.574 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.700 us                 | 1.108 ms                  |
| BlockToStepN              | 15.771 us                 | 84.221 us                 |
| OneStep                   | 516.499 ms                | 1.004 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.693 ms                 |
| Forward                   | 6.157 ms                  | 10.189 ms                 |
| Backward                  | 504.141 ms                | 1.004 s                   |
| Optimize                  | 1.574 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.700 us                 | 1.108 ms                  |
| BlockToStepN              | 16.393 us                 | 84.221 us                 |
| OneStep                   | 520.356 ms                | 1.025 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.693 ms                 |
| Forward                   | 6.154 ms                  | 10.189 ms                 |
| Backward                  | 527.408 ms                | 1.020 s                   |
| Optimize                  | 1.569 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.745 us                 | 1.108 ms                  |
| BlockToStepN              | 16.510 us                 | 84.221 us                 |
| OneStep                   | 538.979 ms                | 1.044 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.693 ms                 |
| Forward                   | 6.154 ms                  | 10.189 ms                 |
| Backward                  | 532.910 ms                | 1.029 s                   |
| Optimize                  | 1.585 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.779 us                 | 1.108 ms                  |
| BlockToStepN              | 16.641 us                 | 84.221 us                 |
| OneStep                   | 547.127 ms                | 1.045 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 851.648 us                | 14.693 ms                 |
| Forward                   | 6.150 ms                  | 10.189 ms                 |
| Backward                  | 544.351 ms                | 1.050 s                   |
| Optimize                  | 1.585 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.779 us                 | 1.108 ms                  |
| BlockToStepN              | 16.993 us                 | 84.221 us                 |
| OneStep                   | 571.984 ms                | 1.066 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.693 ms                 |
| Forward                   | 6.157 ms                  | 10.189 ms                 |
| Backward                  | 564.171 ms                | 1.076 s                   |
| Optimize                  | 1.586 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.779 us                 | 1.108 ms                  |
| BlockToStepN              | 17.083 us                 | 84.221 us                 |
| OneStep                   | 583.818 ms                | 1.095 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.693 ms                 |
| Forward                   | 6.165 ms                  | 10.189 ms                 |
| Backward                  | 567.313 ms                | 1.115 s                   |
| Optimize                  | 1.587 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.779 us                 | 1.108 ms                  |
| BlockToStepN              | 17.167 us                 | 84.221 us                 |
| OneStep                   | 596.958 ms                | 1.132 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.693 ms                 |
| Forward                   | 6.166 ms                  | 10.189 ms                 |
| Backward                  | 596.252 ms                | 1.126 s                   |
| Optimize                  | 1.587 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 34.102 us                 | 1.108 ms                  |
| BlockToStepN              | 17.172 us                 | 84.221 us                 |
| OneStep                   | 608.733 ms                | 1.136 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 852.587 us                | 14.693 ms                 |
| Forward                   | 6.176 ms                  | 10.189 ms                 |
| Backward                  | 600.339 ms                | 1.132 s                   |
| Optimize                  | 1.587 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.779 us                 | 1.108 ms                  |
| BlockToStepN              | 17.323 us                 | 84.401 us                 |
| OneStep                   | 613.344 ms                | 1.148 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 852.587 us                | 14.693 ms                 |
| Forward                   | 6.173 ms                  | 10.189 ms                 |
| Backward                  | 604.662 ms                | 1.157 s                   |
| Optimize                  | 1.589 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 34.184 us                 | 1.108 ms                  |
| BlockToStepN              | 17.769 us                 | 84.401 us                 |
| OneStep                   | 620.552 ms                | 1.174 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 851.648 us                | 14.693 ms                 |
| Forward                   | 6.173 ms                  | 10.189 ms                 |
| Backward                  | 615.063 ms                | 1.186 s                   |
| Optimize                  | 1.589 ms                  | 3.340 ms                  |
| BarrierTimeBeforeRank0    | 34.102 us                 | 1.108 ms                  |
| BlockToStepN              | 17.796 us                 | 84.401 us                 |
| OneStep                   | 624.854 ms                | 1.213 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 852.587 us                | 14.498 ms                 |
| Forward                   | 6.176 ms                  | 9.058 ms                  |
| Backward                  | 619.666 ms                | 1.203 s                   |
| Optimize                  | 1.593 ms                  | 3.340 ms                  |
| BarrierTimeBeforeRank0    | 34.102 us                 | 1.108 ms                  |
| BlockToStepN              | 17.852 us                 | 84.401 us                 |
| OneStep                   | 635.267 ms                | 1.229 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 853.017 us                | 14.498 ms                 |
| Forward                   | 6.179 ms                  | 9.058 ms                  |
| Backward                  | 625.929 ms                | 1.220 s                   |
| Optimize                  | 1.595 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.779 us                 | 104.759 us                |
| BlockToStepN              | 18.026 us                 | 84.221 us                 |
| OneStep                   | 637.768 ms                | 1.238 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 852.587 us                | 14.498 ms                 |
| Forward                   | 6.176 ms                  | 9.058 ms                  |
| Backward                  | 633.411 ms                | 1.232 s                   |
| Optimize                  | 1.595 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.745 us                 | 104.759 us                |
| BlockToStepN              | 19.102 us                 | 84.221 us                 |
| OneStep                   | 650.896 ms                | 1.257 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 852.587 us                | 14.498 ms                 |
| Forward                   | 6.179 ms                  | 9.058 ms                  |
| Backward                  | 641.713 ms                | 1.274 s                   |
| Optimize                  | 1.595 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.745 us                 | 104.759 us                |
| BlockToStepN              | 19.132 us                 | 84.221 us                 |
| OneStep                   | 660.604 ms                | 1.286 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 851.648 us                | 14.498 ms                 |
| Forward                   | 6.176 ms                  | 9.058 ms                  |
| Backward                  | 656.427 ms                | 1.279 s                   |
| Optimize                  | 1.595 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.745 us                 | 104.759 us                |
| BlockToStepN              | 19.459 us                 | 84.221 us                 |
| OneStep                   | 667.544 ms                | 1.299 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 851.648 us                | 14.498 ms                 |
| Forward                   | 6.176 ms                  | 9.058 ms                  |
| Backward                  | 670.975 ms                | 1.293 s                   |
| Optimize                  | 1.595 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.745 us                 | 104.759 us                |
| BlockToStepN              | 20.195 us                 | 84.221 us                 |
| OneStep                   | 682.179 ms                | 1.307 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 851.648 us                | 14.498 ms                 |
| Forward                   | 6.179 ms                  | 9.058 ms                  |
| Backward                  | 674.233 ms                | 1.307 s                   |
| Optimize                  | 1.601 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.745 us                 | 104.759 us                |
| BlockToStepN              | 20.209 us                 | 84.221 us                 |
| OneStep                   | 695.901 ms                | 1.327 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 850.039 us                | 14.498 ms                 |
| Forward                   | 6.176 ms                  | 9.058 ms                  |
| Backward                  | 684.307 ms                | 1.319 s                   |
| Optimize                  | 1.614 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.745 us                 | 104.759 us                |
| BlockToStepN              | 20.469 us                 | 84.221 us                 |
| OneStep                   | 699.133 ms                | 1.338 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.498 ms                 |
| Forward                   | 6.176 ms                  | 9.058 ms                  |
| Backward                  | 692.381 ms                | 1.354 s                   |
| Optimize                  | 1.614 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.700 us                 | 104.759 us                |
| BlockToStepN              | 20.669 us                 | 84.221 us                 |
| OneStep                   | 710.263 ms                | 1.373 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 850.039 us                | 14.498 ms                 |
| Forward                   | 6.173 ms                  | 9.058 ms                  |
| Backward                  | 702.863 ms                | 1.362 s                   |
| Optimize                  | 1.614 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.645 us                 | 104.759 us                |
| BlockToStepN              | 20.670 us                 | 84.221 us                 |
| OneStep                   | 713.274 ms                | 1.375 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 850.039 us                | 14.498 ms                 |
| Forward                   | 6.176 ms                  | 9.058 ms                  |
| Backward                  | 703.026 ms                | 1.369 s                   |
| Optimize                  | 1.620 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.645 us                 | 104.759 us                |
| BlockToStepN              | 20.725 us                 | 84.221 us                 |
| OneStep                   | 719.130 ms                | 1.389 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 852.587 us                | 14.498 ms                 |
| Forward                   | 6.176 ms                  | 9.058 ms                  |
| Backward                  | 710.175 ms                | 1.384 s                   |
| Optimize                  | 1.620 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.645 us                 | 104.759 us                |
| BlockToStepN              | 21.321 us                 | 84.221 us                 |
| OneStep                   | 725.065 ms                | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 851.648 us                | 14.498 ms                 |
| Forward                   | 6.177 ms                  | 9.058 ms                  |
| Backward                  | 716.551 ms                | 1.419 s                   |
| Optimize                  | 1.637 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.700 us                 | 104.759 us                |
| BlockToStepN              | 21.746 us                 | 84.221 us                 |
| OneStep                   | 729.112 ms                | 1.439 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 850.039 us                | 14.498 ms                 |
| Forward                   | 6.176 ms                  | 9.058 ms                  |
| Backward                  | 725.128 ms                | 1.428 s                   |
| Optimize                  | 1.648 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.700 us                 | 104.759 us                |
| BlockToStepN              | 21.946 us                 | 84.221 us                 |
| OneStep                   | 741.773 ms                | 1.445 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 122.307, sample: 0.209, forward: 0.531, backward: 109.031, update: 0.172
[proc 3] 300 steps, total: 122.307, sample: 0.255, forward: 0.520, backward: 75.631, update: 0.158
[proc 1] 300 steps, total: 122.307, sample: 0.215, forward: 0.537, backward: 77.914, update: 0.141
[proc 0] 300 steps, total: 122.307, sample: 0.235, forward: 0.615, backward: 121.189, update: 0.180
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 850.039 us                | 14.498 ms                 |
| Forward                   | 6.177 ms                  | 9.058 ms                  |
| Backward                  | 732.055 ms                | 1.448 s                   |
| Optimize                  | 1.637 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.645 us                 | 104.759 us                |
| BlockToStepN              | 22.002 us                 | 84.221 us                 |
| OneStep                   | 763.533 ms                | 1.467 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.498 ms                 |
| Forward                   | 6.177 ms                  | 9.058 ms                  |
| Backward                  | 753.685 ms                | 1.465 s                   |
| Optimize                  | 1.648 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.645 us                 | 104.759 us                |
| BlockToStepN              | 22.097 us                 | 84.221 us                 |
| OneStep                   | 773.362 ms                | 1.475 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.498 ms                 |
| Forward                   | 6.179 ms                  | 9.058 ms                  |
| Backward                  | 767.887 ms                | 1.495 s                   |
| Optimize                  | 1.648 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.520 us                 | 104.759 us                |
| BlockToStepN              | 22.360 us                 | 84.221 us                 |
| OneStep                   | 780.601 ms                | 1.508 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.493 us                | 14.498 ms                 |
| Forward                   | 6.189 ms                  | 9.058 ms                  |
| Backward                  | 771.825 ms                | 1.505 s                   |
| Optimize                  | 1.648 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.520 us                 | 104.759 us                |
| BlockToStepN              | 22.139 us                 | 84.221 us                 |
| OneStep                   | 783.442 ms                | 1.519 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.268 us                | 14.498 ms                 |
| Forward                   | 6.179 ms                  | 9.058 ms                  |
| Backward                  | 776.322 ms                | 1.537 s                   |
| Optimize                  | 1.648 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.520 us                 | 104.759 us                |
| BlockToStepN              | 22.406 us                 | 84.221 us                 |
| OneStep                   | 787.298 ms                | 1.559 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.268 us                | 14.498 ms                 |
| Forward                   | 6.189 ms                  | 9.058 ms                  |
| Backward                  | 782.661 ms                | 1.547 s                   |
| Optimize                  | 1.648 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.520 us                 | 104.759 us                |
| BlockToStepN              | 22.446 us                 | 84.221 us                 |
| OneStep                   | 801.905 ms                | 1.563 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.268 us                | 14.498 ms                 |
| Forward                   | 6.194 ms                  | 9.058 ms                  |
| Backward                  | 792.730 ms                | 1.566 s                   |
| Optimize                  | 1.637 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.494 us                 | 104.759 us                |
| BlockToStepN              | 22.446 us                 | 84.221 us                 |
| OneStep                   | 803.815 ms                | 1.576 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.268 us                | 14.498 ms                 |
| Forward                   | 6.189 ms                  | 9.058 ms                  |
| Backward                  | 801.121 ms                | 1.571 s                   |
| Optimize                  | 1.648 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.494 us                 | 104.759 us                |
| BlockToStepN              | 22.625 us                 | 84.221 us                 |
| OneStep                   | 813.058 ms                | 1.580 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.268 us                | 14.498 ms                 |
| Forward                   | 6.194 ms                  | 9.058 ms                  |
| Backward                  | 803.405 ms                | 1.588 s                   |
| Optimize                  | 1.648 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.363 us                 | 104.759 us                |
| BlockToStepN              | 22.659 us                 | 84.221 us                 |
| OneStep                   | 813.875 ms                | 1.605 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.407 us                | 14.498 ms                 |
| Forward                   | 6.195 ms                  | 9.058 ms                  |
| Backward                  | 810.675 ms                | 1.605 s                   |
| Optimize                  | 1.654 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.363 us                 | 104.759 us                |
| BlockToStepN              | 22.935 us                 | 84.221 us                 |
| OneStep                   | 828.447 ms                | 1.615 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.407 us                | 14.498 ms                 |
| Forward                   | 6.210 ms                  | 9.058 ms                  |
| Backward                  | 818.898 ms                | 1.612 s                   |
| Optimize                  | 1.654 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.363 us                 | 104.759 us                |
| BlockToStepN              | 22.936 us                 | 84.221 us                 |
| OneStep                   | 835.345 ms                | 1.622 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.762 us                | 14.498 ms                 |
| Forward                   | 6.195 ms                  | 9.058 ms                  |
| Backward                  | 824.359 ms                | 1.653 s                   |
| Optimize                  | 1.667 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.363 us                 | 104.759 us                |
| BlockToStepN              | 23.338 us                 | 84.221 us                 |
| OneStep                   | 844.773 ms                | 1.661 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.268 us                | 14.498 ms                 |
| Forward                   | 6.210 ms                  | 9.058 ms                  |
| Backward                  | 828.361 ms                | 1.670 s                   |
| Optimize                  | 1.667 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.347 us                 | 104.759 us                |
| BlockToStepN              | 23.338 us                 | 84.221 us                 |
| OneStep                   | 845.349 ms                | 1.681 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.407 us                | 14.498 ms                 |
| Forward                   | 6.210 ms                  | 9.058 ms                  |
| Backward                  | 838.756 ms                | 1.684 s                   |
| Optimize                  | 1.667 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.347 us                 | 104.759 us                |
| BlockToStepN              | 23.357 us                 | 84.221 us                 |
| OneStep                   | 849.647 ms                | 1.694 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 848.268 us                | 14.498 ms                 |
| Forward                   | 6.210 ms                  | 9.058 ms                  |
| Backward                  | 839.340 ms                | 1.696 s                   |
| Optimize                  | 1.667 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.310 us                 | 104.759 us                |
| BlockToStepN              | 23.357 us                 | 84.221 us                 |
| OneStep                   | 861.286 ms                | 1.705 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.407 us                | 14.498 ms                 |
| Forward                   | 6.212 ms                  | 9.058 ms                  |
| Backward                  | 852.734 ms                | 1.720 s                   |
| Optimize                  | 1.667 ms                  | 3.324 ms                  |
| BarrierTimeBeforeRank0    | 33.310 us                 | 104.759 us                |
| BlockToStepN              | 23.466 us                 | 84.221 us                 |
| OneStep                   | 866.579 ms                | 1.729 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.407 us                | 13.532 ms                 |
| Forward                   | 6.212 ms                  | 8.229 ms                  |
| Backward                  | 855.296 ms                | 1.720 s                   |
| Optimize                  | 1.667 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 33.236 us                 | 97.188 us                 |
| BlockToStepN              | 23.546 us                 | 83.573 us                 |
| OneStep                   | 874.745 ms                | 1.729 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.407 us                | 13.532 ms                 |
| Forward                   | 6.212 ms                  | 8.229 ms                  |
| Backward                  | 867.620 ms                | 1.724 s                   |
| Optimize                  | 1.671 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 33.236 us                 | 97.188 us                 |
| BlockToStepN              | 23.949 us                 | 83.573 us                 |
| OneStep                   | 881.110 ms                | 1.733 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 847.407 us                | 13.532 ms                 |
| Forward                   | 6.210 ms                  | 8.229 ms                  |
| Backward                  | 872.004 ms                | 1.744 s                   |
| Optimize                  | 1.680 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 33.190 us                 | 97.188 us                 |
| BlockToStepN              | 23.949 us                 | 83.573 us                 |
| OneStep                   | 885.061 ms                | 1.753 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.762 us                | 13.532 ms                 |
| Forward                   | 6.195 ms                  | 8.229 ms                  |
| Backward                  | 875.745 ms                | 1.763 s                   |
| Optimize                  | 1.680 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 33.162 us                 | 97.188 us                 |
| BlockToStepN              | 24.147 us                 | 83.573 us                 |
| OneStep                   | 885.515 ms                | 1.774 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 13.532 ms                 |
| Forward                   | 6.189 ms                  | 8.229 ms                  |
| Backward                  | 880.822 ms                | 1.770 s                   |
| Optimize                  | 1.685 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 33.162 us                 | 97.188 us                 |
| BlockToStepN              | 24.250 us                 | 83.573 us                 |
| OneStep                   | 896.675 ms                | 1.778 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 13.532 ms                 |
| Forward                   | 6.189 ms                  | 8.229 ms                  |
| Backward                  | 887.065 ms                | 1.795 s                   |
| Optimize                  | 1.685 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 24.769 us                 | 83.573 us                 |
| OneStep                   | 902.158 ms                | 1.808 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.030 us                | 13.532 ms                 |
| Forward                   | 6.189 ms                  | 8.229 ms                  |
| Backward                  | 898.233 ms                | 1.810 s                   |
| Optimize                  | 1.685 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 24.932 us                 | 83.573 us                 |
| OneStep                   | 909.183 ms                | 1.819 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 13.532 ms                 |
| Forward                   | 6.189 ms                  | 8.229 ms                  |
| Backward                  | 898.744 ms                | 1.813 s                   |
| Optimize                  | 1.686 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 24.976 us                 | 83.573 us                 |
| OneStep                   | 918.561 ms                | 1.822 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 13.532 ms                 |
| Forward                   | 6.189 ms                  | 8.229 ms                  |
| Backward                  | 908.436 ms                | 1.822 s                   |
| Optimize                  | 1.685 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 25.010 us                 | 83.573 us                 |
| OneStep                   | 925.957 ms                | 1.831 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 13.532 ms                 |
| Forward                   | 6.182 ms                  | 8.229 ms                  |
| Backward                  | 919.022 ms                | 1.850 s                   |
| Optimize                  | 1.699 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 25.072 us                 | 83.573 us                 |
| OneStep                   | 938.326 ms                | 1.863 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 13.532 ms                 |
| Forward                   | 6.179 ms                  | 8.229 ms                  |
| Backward                  | 923.725 ms                | 1.854 s                   |
| Optimize                  | 1.699 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.975 us                 | 97.188 us                 |
| BlockToStepN              | 25.072 us                 | 83.573 us                 |
| OneStep                   | 943.264 ms                | 1.874 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 13.532 ms                 |
| Forward                   | 6.179 ms                  | 8.229 ms                  |
| Backward                  | 927.363 ms                | 1.873 s                   |
| Optimize                  | 1.699 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 25.081 us                 | 83.573 us                 |
| OneStep                   | 946.206 ms                | 1.882 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.030 us                | 13.532 ms                 |
| Forward                   | 6.177 ms                  | 8.229 ms                  |
| Backward                  | 941.669 ms                | 1.885 s                   |
| Optimize                  | 1.702 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 25.315 us                 | 83.573 us                 |
| OneStep                   | 952.365 ms                | 1.894 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 13.532 ms                 |
| Forward                   | 6.176 ms                  | 8.229 ms                  |
| Backward                  | 943.139 ms                | 1.900 s                   |
| Optimize                  | 1.702 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 25.382 us                 | 83.573 us                 |
| OneStep                   | 954.091 ms                | 1.911 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.236 us                | 13.532 ms                 |
| Forward                   | 6.176 ms                  | 8.229 ms                  |
| Backward                  | 943.675 ms                | 1.918 s                   |
| Optimize                  | 1.702 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.975 us                 | 97.188 us                 |
| BlockToStepN              | 25.447 us                 | 83.573 us                 |
| OneStep                   | 954.379 ms                | 1.928 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.030 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 953.181 ms                | 1.932 s                   |
| Optimize                  | 1.702 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 25.902 us                 | 83.573 us                 |
| OneStep                   | 975.765 ms                | 1.942 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.030 us                | 13.532 ms                 |
| Forward                   | 6.173 ms                  | 8.229 ms                  |
| Backward                  | 965.988 ms                | 1.942 s                   |
| Optimize                  | 1.702 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 26.151 us                 | 83.573 us                 |
| OneStep                   | 985.999 ms                | 1.951 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.030 us                | 13.532 ms                 |
| Forward                   | 6.176 ms                  | 8.229 ms                  |
| Backward                  | 974.750 ms                | 1.945 s                   |
| Optimize                  | 1.699 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 26.164 us                 | 83.573 us                 |
| OneStep                   | 986.838 ms                | 1.955 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 172.012, sample: 0.243, forward: 0.553, backward: 108.692, update: 0.150
[proc 3] 400 steps, total: 172.012, sample: 0.216, forward: 0.530, backward: 105.480, update: 0.160
[proc 2] 400 steps, total: 172.012, sample: 0.211, forward: 0.540, backward: 150.801, update: 0.170
[proc 0] 400 steps, total: 172.012, sample: 0.222, forward: 0.623, backward: 170.898, update: 0.178
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.030 us                | 13.532 ms                 |
| Forward                   | 6.177 ms                  | 8.229 ms                  |
| Backward                  | 975.135 ms                | 1.950 s                   |
| Optimize                  | 1.702 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 26.207 us                 | 83.573 us                 |
| OneStep                   | 995.003 ms                | 1.958 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 846.030 us                | 13.532 ms                 |
| Forward                   | 6.176 ms                  | 8.229 ms                  |
| Backward                  | 988.000 ms                | 1.963 s                   |
| Optimize                  | 1.708 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 26.327 us                 | 83.573 us                 |
| OneStep                   | 1.004 s                   | 1.973 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.913 us                | 13.532 ms                 |
| Forward                   | 6.173 ms                  | 8.229 ms                  |
| Backward                  | 994.825 ms                | 1.988 s                   |
| Optimize                  | 1.702 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 26.327 us                 | 83.573 us                 |
| OneStep                   | 1.006 s                   | 1.997 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.913 us                | 13.532 ms                 |
| Forward                   | 6.173 ms                  | 8.229 ms                  |
| Backward                  | 996.234 ms                | 1.996 s                   |
| Optimize                  | 1.702 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 26.683 us                 | 83.573 us                 |
| OneStep                   | 1.012 s                   | 2.006 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.913 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.003 s                   | 2.005 s                   |
| Optimize                  | 1.708 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 26.683 us                 | 83.573 us                 |
| OneStep                   | 1.019 s                   | 2.013 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.010 s                   | 2.011 s                   |
| Optimize                  | 1.709 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 26.683 us                 | 83.573 us                 |
| OneStep                   | 1.025 s                   | 2.019 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.013 s                   | 2.014 s                   |
| Optimize                  | 1.709 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 33.162 us                 | 97.188 us                 |
| BlockToStepN              | 26.924 us                 | 83.573 us                 |
| OneStep                   | 1.028 s                   | 2.034 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.173 ms                  | 8.229 ms                  |
| Backward                  | 1.018 s                   | 2.065 s                   |
| Optimize                  | 1.709 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 27.419 us                 | 83.573 us                 |
| OneStep                   | 1.029 s                   | 2.074 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.020 s                   | 2.089 s                   |
| Optimize                  | 1.708 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 27.597 us                 | 83.573 us                 |
| OneStep                   | 1.033 s                   | 2.098 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.047 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.028 s                   | 2.091 s                   |
| Optimize                  | 1.709 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 28.052 us                 | 83.573 us                 |
| OneStep                   | 1.044 s                   | 2.108 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.029 s                   | 2.098 s                   |
| Optimize                  | 1.709 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 28.204 us                 | 83.573 us                 |
| OneStep                   | 1.045 s                   | 2.110 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.036 s                   | 2.098 s                   |
| Optimize                  | 1.710 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 28.212 us                 | 83.573 us                 |
| OneStep                   | 1.046 s                   | 2.117 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.037 s                   | 2.110 s                   |
| Optimize                  | 1.710 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 28.450 us                 | 83.573 us                 |
| OneStep                   | 1.052 s                   | 2.121 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.047 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.042 s                   | 2.128 s                   |
| Optimize                  | 1.713 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 28.619 us                 | 83.573 us                 |
| OneStep                   | 1.054 s                   | 2.138 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.045 s                   | 2.154 s                   |
| Optimize                  | 1.713 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 28.721 us                 | 83.573 us                 |
| OneStep                   | 1.059 s                   | 2.163 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.165 ms                  | 8.229 ms                  |
| Backward                  | 1.050 s                   | 2.160 s                   |
| Optimize                  | 1.715 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 29.273 us                 | 83.573 us                 |
| OneStep                   | 1.069 s                   | 2.169 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.532 ms                 |
| Forward                   | 6.165 ms                  | 8.229 ms                  |
| Backward                  | 1.057 s                   | 2.161 s                   |
| Optimize                  | 1.715 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.991 us                 | 97.188 us                 |
| BlockToStepN              | 29.462 us                 | 83.573 us                 |
| OneStep                   | 1.077 s                   | 2.170 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.913 us                | 13.532 ms                 |
| Forward                   | 6.165 ms                  | 8.229 ms                  |
| Backward                  | 1.068 s                   | 2.172 s                   |
| Optimize                  | 1.719 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 29.475 us                 | 83.573 us                 |
| OneStep                   | 1.086 s                   | 2.181 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.913 us                | 13.532 ms                 |
| Forward                   | 6.165 ms                  | 8.229 ms                  |
| Backward                  | 1.075 s                   | 2.181 s                   |
| Optimize                  | 1.713 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 29.529 us                 | 83.573 us                 |
| OneStep                   | 1.090 s                   | 2.195 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.913 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.076 s                   | 2.182 s                   |
| Optimize                  | 1.713 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 29.932 us                 | 83.573 us                 |
| OneStep                   | 1.091 s                   | 2.200 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.913 us                | 13.532 ms                 |
| Forward                   | 6.166 ms                  | 8.229 ms                  |
| Backward                  | 1.081 s                   | 2.191 s                   |
| Optimize                  | 1.713 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 97.188 us                 |
| BlockToStepN              | 30.038 us                 | 83.573 us                 |
| OneStep                   | 1.095 s                   | 2.203 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.188 ms                 |
| Forward                   | 6.166 ms                  | 7.830 ms                  |
| Backward                  | 1.082 s                   | 2.225 s                   |
| Optimize                  | 1.713 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.975 us                 | 97.188 us                 |
| BlockToStepN              | 30.315 us                 | 83.573 us                 |
| OneStep                   | 1.118 s                   | 2.235 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.047 us                | 13.188 ms                 |
| Forward                   | 6.173 ms                  | 7.830 ms                  |
| Backward                  | 1.109 s                   | 2.237 s                   |
| Optimize                  | 1.719 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.975 us                 | 58.730 us                 |
| BlockToStepN              | 30.370 us                 | 81.599 us                 |
| OneStep                   | 1.124 s                   | 2.246 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.047 us                | 13.188 ms                 |
| Forward                   | 6.173 ms                  | 7.830 ms                  |
| Backward                  | 1.115 s                   | 2.238 s                   |
| Optimize                  | 1.719 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.975 us                 | 58.730 us                 |
| BlockToStepN              | 30.496 us                 | 81.599 us                 |
| OneStep                   | 1.131 s                   | 2.247 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.670 us                | 13.188 ms                 |
| Forward                   | 6.176 ms                  | 7.830 ms                  |
| Backward                  | 1.121 s                   | 2.239 s                   |
| Optimize                  | 1.719 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.982 us                 | 58.730 us                 |
| BlockToStepN              | 30.526 us                 | 81.599 us                 |
| OneStep                   | 1.132 s                   | 2.249 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.047 us                | 13.188 ms                 |
| Forward                   | 6.176 ms                  | 7.830 ms                  |
| Backward                  | 1.121 s                   | 2.262 s                   |
| Optimize                  | 1.726 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.975 us                 | 58.730 us                 |
| BlockToStepN              | 30.545 us                 | 81.599 us                 |
| OneStep                   | 1.135 s                   | 2.272 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.047 us                | 13.188 ms                 |
| Forward                   | 6.173 ms                  | 7.830 ms                  |
| Backward                  | 1.123 s                   | 2.263 s                   |
| Optimize                  | 1.729 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.975 us                 | 58.730 us                 |
| BlockToStepN              | 30.617 us                 | 81.599 us                 |
| OneStep                   | 1.136 s                   | 2.272 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.047 us                | 13.188 ms                 |
| Forward                   | 6.176 ms                  | 7.830 ms                  |
| Backward                  | 1.126 s                   | 2.281 s                   |
| Optimize                  | 1.726 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.939 us                 | 58.730 us                 |
| BlockToStepN              | 30.617 us                 | 81.599 us                 |
| OneStep                   | 1.138 s                   | 2.291 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 845.047 us                | 13.188 ms                 |
| Forward                   | 6.177 ms                  | 7.830 ms                  |
| Backward                  | 1.126 s                   | 2.283 s                   |
| Optimize                  | 1.726 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.939 us                 | 58.730 us                 |
| BlockToStepN              | 30.716 us                 | 81.599 us                 |
| OneStep                   | 1.140 s                   | 2.302 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.179 ms                  | 7.830 ms                  |
| Backward                  | 1.129 s                   | 2.294 s                   |
| Optimize                  | 1.726 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.753 us                 | 58.730 us                 |
| BlockToStepN              | 30.785 us                 | 83.573 us                 |
| OneStep                   | 1.142 s                   | 2.304 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.179 ms                  | 7.830 ms                  |
| Backward                  | 1.131 s                   | 2.303 s                   |
| Optimize                  | 1.729 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.753 us                 | 58.730 us                 |
| BlockToStepN              | 30.995 us                 | 83.573 us                 |
| OneStep                   | 1.142 s                   | 2.313 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.179 ms                  | 7.830 ms                  |
| Backward                  | 1.132 s                   | 2.311 s                   |
| Optimize                  | 1.729 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.753 us                 | 58.730 us                 |
| BlockToStepN              | 31.171 us                 | 83.573 us                 |
| OneStep                   | 1.148 s                   | 2.320 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.182 ms                  | 7.830 ms                  |
| Backward                  | 1.148 s                   | 2.319 s                   |
| Optimize                  | 1.730 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.753 us                 | 58.730 us                 |
| BlockToStepN              | 31.263 us                 | 83.573 us                 |
| OneStep                   | 1.165 s                   | 2.329 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.989 us                | 13.188 ms                 |
| Forward                   | 6.182 ms                  | 7.830 ms                  |
| Backward                  | 1.154 s                   | 2.329 s                   |
| Optimize                  | 1.730 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.527 us                 | 58.730 us                 |
| BlockToStepN              | 31.529 us                 | 83.573 us                 |
| OneStep                   | 1.171 s                   | 2.338 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.989 us                | 13.188 ms                 |
| Forward                   | 6.179 ms                  | 7.830 ms                  |
| Backward                  | 1.157 s                   | 2.331 s                   |
| Optimize                  | 1.730 ms                  | 2.488 ms                  |
| BarrierTimeBeforeRank0    | 32.527 us                 | 58.730 us                 |
| BlockToStepN              | 31.622 us                 | 83.573 us                 |
| OneStep                   | 1.174 s                   | 2.346 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.989 us                | 13.188 ms                 |
| Forward                   | 6.179 ms                  | 7.830 ms                  |
| Backward                  | 1.162 s                   | 2.336 s                   |
| Optimize                  | 1.730 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.527 us                 | 58.730 us                 |
| BlockToStepN              | 31.633 us                 | 83.573 us                 |
| OneStep                   | 1.177 s                   | 2.351 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.822 us                | 13.188 ms                 |
| Forward                   | 6.179 ms                  | 7.830 ms                  |
| Backward                  | 1.166 s                   | 2.353 s                   |
| Optimize                  | 1.729 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.484 us                 | 58.730 us                 |
| BlockToStepN              | 31.641 us                 | 83.573 us                 |
| OneStep                   | 1.182 s                   | 2.373 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.822 us                | 13.188 ms                 |
| Forward                   | 6.179 ms                  | 7.830 ms                  |
| Backward                  | 1.174 s                   | 2.365 s                   |
| Optimize                  | 1.730 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.484 us                 | 58.730 us                 |
| BlockToStepN              | 31.668 us                 | 83.573 us                 |
| OneStep                   | 1.192 s                   | 2.373 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 843.989 us                | 13.188 ms                 |
| Forward                   | 6.182 ms                  | 8.037 ms                  |
| Backward                  | 1.181 s                   | 2.372 s                   |
| Optimize                  | 1.730 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.484 us                 | 58.730 us                 |
| BlockToStepN              | 31.668 us                 | 83.573 us                 |
| OneStep                   | 1.195 s                   | 2.381 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.189 ms                  | 8.037 ms                  |
| Backward                  | 1.186 s                   | 2.392 s                   |
| Optimize                  | 1.730 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.484 us                 | 58.730 us                 |
| BlockToStepN              | 31.703 us                 | 83.573 us                 |
| OneStep                   | 1.209 s                   | 2.401 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.182 ms                  | 8.037 ms                  |
| Backward                  | 1.198 s                   | 2.397 s                   |
| Optimize                  | 1.730 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.484 us                 | 58.730 us                 |
| BlockToStepN              | 31.836 us                 | 83.573 us                 |
| OneStep                   | 1.210 s                   | 2.406 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.189 ms                  | 8.037 ms                  |
| Backward                  | 1.199 s                   | 2.405 s                   |
| Optimize                  | 1.732 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.527 us                 | 58.730 us                 |
| BlockToStepN              | 31.869 us                 | 84.221 us                 |
| OneStep                   | 1.212 s                   | 2.416 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.182 ms                  | 8.037 ms                  |
| Backward                  | 1.202 s                   | 2.425 s                   |
| Optimize                  | 1.732 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.527 us                 | 58.730 us                 |
| BlockToStepN              | 31.871 us                 | 84.221 us                 |
| OneStep                   | 1.213 s                   | 2.442 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.182 ms                  | 8.037 ms                  |
| Backward                  | 1.203 s                   | 2.440 s                   |
| Optimize                  | 1.732 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.527 us                 | 58.730 us                 |
| BlockToStepN              | 31.933 us                 | 84.221 us                 |
| OneStep                   | 1.229 s                   | 2.449 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 221.563, sample: 0.214, forward: 0.537, backward: 193.350, update: 0.179
[proc 0] 500 steps, total: 221.563, sample: 0.233, forward: 0.622, backward: 220.437, update: 0.178
[proc 3] 500 steps, total: 221.563, sample: 0.224, forward: 0.545, backward: 135.174, update: 0.172
Successfully xmh. training takes 619.3810949325562 seconds
before call kg_cache_controller.StopThreads()
[proc 1] 500 steps, total: 221.563, sample: 0.221, forward: 0.561, backward: 139.377, update: 0.149
INFO [608347 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
INFO [608347 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 844.609 us                | 13.188 ms                 |
| Forward                   | 6.179 ms                  | 8.037 ms                  |
| Backward                  | 1.208 s                   | 2.442 s                   |
| Optimize                  | 1.732 ms                  | 2.491 ms                  |
| BarrierTimeBeforeRank0    | 32.527 us                 | 58.730 us                 |
| BlockToStepN              | 31.966 us                 | 84.221 us                 |
| OneStep                   | 1.230 s                   | 2.451 s                   |
+---------------------------+---------------------------+---------------------------+
