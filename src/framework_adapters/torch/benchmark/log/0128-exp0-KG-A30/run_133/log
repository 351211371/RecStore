WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 15:40:43.338717 420827 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='ComplEx', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/ComplEx_FB15k_13', no_save_emb=True, max_step=500, batch_size=1800, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.01, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [420827 sampler.py:454] Start PreSampling
WARNING [420827 sampler.py:532] Before construct renumbering_dict
WARNING [420827 sampler.py:555] PreSampling done
W20240128 15:40:45.608266 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240128 15:40:45.608413 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240128 15:40:45.608443 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240128 15:40:45.608465 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240128 15:40:45.608484 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240128 15:40:45.608505 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240128 15:40:45.608528 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240128 15:40:45.608551 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240128 15:40:45.608572 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240128 15:40:45.608590 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240128 15:40:45.608618 420827 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240128 15:40:45.608645 420827 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240128 15:40:45.608662 420827 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240128 15:40:45.608763 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240128 15:40:45.608788 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240128 15:40:45.608804 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240128 15:40:45.608837 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240128 15:40:45.608855 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240128 15:40:45.608872 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240128 15:40:45.608889 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240128 15:40:45.608911 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240128 15:40:45.608933 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240128 15:40:45.608954 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240128 15:40:45.608973 420827 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240128 15:40:45.608987 420827 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240128 15:40:45.609002 420827 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240128 15:40:45.609040 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240128 15:40:45.609063 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240128 15:40:45.609081 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240128 15:40:45.609097 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240128 15:40:45.609117 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240128 15:40:45.609136 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240128 15:40:45.609158 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240128 15:40:45.609177 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240128 15:40:45.609197 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240128 15:40:45.609220 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240128 15:40:45.609241 420827 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240128 15:40:45.609256 420827 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240128 15:40:45.609269 420827 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240128 15:40:45.609305 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240128 15:40:45.609328 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240128 15:40:45.609345 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240128 15:40:45.609362 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240128 15:40:45.609382 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240128 15:40:45.609403 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240128 15:40:45.609421 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240128 15:40:45.609442 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240128 15:40:45.609463 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240128 15:40:45.609484 420827 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240128 15:40:45.609501 420827 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240128 15:40:45.609516 420827 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240128 15:40:45.609530 420827 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240128 15:40:45.745790 420827 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240128 15:40:45.745913 420827 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 37
Rank1: cached key size 37
Rank2: cached key size 37
Rank3: cached key size 37
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([ 268,  481,  554,  ..., 1233, 5821, 7744]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.429 seconds
[Rank1] pid = 421146
[Rank2] pid = 421211
INFO [420827 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [421146 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [421146 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [421275 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [421275 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [421146 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [421275 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [421146 cache_common.py:139] TorchNativeStdEmb construct done
INFO [421275 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [421275 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [421146 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [421211 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [421211 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [421211 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [420827 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [420827 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [420827 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [420827 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [421211 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [421211 DistTensor.py:56] The tensor name already exists in the kvstore
I20240128 15:40:48.699313 421276 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240128 15:40:48.699580 421277 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 15:40:48.699692 421147 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240128 15:40:48.699860 421212 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240128 15:40:49.088685 421147 recstore.cc:66] init folly done
E20240128 15:40:49.088683 421277 recstore.cc:66] init folly done
E20240128 15:40:49.088696 421276 recstore.cc:66] init folly done
E20240128 15:40:49.089195 421212 recstore.cc:66] init folly done
I20240128 15:40:49.181391 421277 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 15:40:49.181478 421212 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 15:40:49.186944 421147 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 15:40:49.187870 421276 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 840.164 us                | 12.546 ms                 |
| Forward                   | 5.609 ms                  | 769.200 ms                |
| Backward                  | 66.833 ms                 | 1.657 s                   |
| Optimize                  | 1.536 ms                  | 42.326 ms                 |
| BarrierTimeBeforeRank0    | 43.044 us                 | 11.917 ms                 |
| BlockToStepN              | 10.256 us                 | 66.090 us                 |
| OneStep                   | 75.071 ms                 | 1.671 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.253 ms                 |
| Forward                   | 5.460 ms                  | 8.394 ms                  |
| Backward                  | 114.577 ms                | 221.052 ms                |
| Optimize                  | 1.756 ms                  | 5.014 ms                  |
| BarrierTimeBeforeRank0    | 52.159 us                 | 15.860 ms                 |
| BlockToStepN              | 10.632 us                 | 60.309 us                 |
| OneStep                   | 130.808 ms                | 1.040 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.231 us                | 12.546 ms                 |
| Forward                   | 5.450 ms                  | 8.394 ms                  |
| Backward                  | 147.928 ms                | 305.255 ms                |
| Optimize                  | 1.702 ms                  | 5.014 ms                  |
| BarrierTimeBeforeRank0    | 38.313 us                 | 15.860 ms                 |
| BlockToStepN              | 11.061 us                 | 60.309 us                 |
| OneStep                   | 174.692 ms                | 1.040 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.664 us                | 12.546 ms                 |
| Forward                   | 5.406 ms                  | 8.394 ms                  |
| Backward                  | 184.032 ms                | 340.262 ms                |
| Optimize                  | 1.542 ms                  | 5.014 ms                  |
| BarrierTimeBeforeRank0    | 37.023 us                 | 15.860 ms                 |
| BlockToStepN              | 11.208 us                 | 60.309 us                 |
| OneStep                   | 192.151 ms                | 1.040 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 23.452, sample: 0.195, forward: 1.270, backward: 20.798, update: 0.192
[Rank3] pid = 421275
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 149), (149, 298), (298, 447), (447, 596)]
train_sampler.Prefill()
-------Step 0-------
tensor([   16,  2574,  7841,  7430,  6502,  3661,  8051,  4468, 12697, 10251]) tensor([  554,  8193,  7921,  3247,  7608,  7249, 11138,  7622,  8454,  7522])
-------Step 1-------
tensor([   16,  2574,  7841,  7430,  6502,  3661,  8051,  4468, 12697, 10251]) tensor([10730, 11710,   422,  2863,  1357, 12322,  6676,  2263,  1612, 14092])
-------Step 2-------
tensor([10340,  6609,  5501,  6665,   980,  6399,  6107,  2038, 11283,  6843]) tensor([ 7643,  5401,  2146, 11295,  7089,  2181,  3394, 12807, 13646,  3016])
-------Step 3-------
tensor([10340,  6609,  5501,  6665,   980,  6399,  6107,  2038, 11283,  6843]) tensor([ 9401,  5040,  4068,  8736, 10182, 10271, 13926,  9604, 14236,  4103])
-------Step 4-------
tensor([12198,  4153,  5444,  1916, 11725,  9049, 14665, 11432,  8549,  6725]) tensor([ 2462,  8687,  6637, 12533,  9219, 12689,   769,  1570,  9546, 13908])
-------Step 5-------
tensor([12198,  4153,  5444,  1916, 11725,  9049, 14665, 11432,  8549,  6725]) tensor([12993,  6187, 12305, 14177,   908, 10309,  5732, 13407, 11735, 13934])
-------Step 6-------
tensor([11864, 11389,  2631,  7839, 10441,  8183,  8677,  1676,  1983,  9281]) tensor([ 5864, 12353,  7702, 11888,  6512,  1008, 10604, 10111, 12461, 12495])
-------Step 7-------
tensor([11864, 11389,  2631,  7839, 10441,  8183,  8677,  1676,  1983,  9281]) tensor([11195, 13872,  5530, 12443,  6313, 12122, 10990, 14363, 12395, 10645])
-------Step 8-------
tensor([ 3580,  7397, 14287, 10798,    34, 11923,  7847, 10180,  5488,  6609]) tensor([ 9400,  8916, 13414,   110, 13209, 10194,  5525,  1196,  6574, 10599])
-------Step 9-------
tensor([ 3580,  7397, 14287, 10798,    34, 11923,  7847, 10180,  5488,  6609]) tensor([ 8646, 13582,  6720,  7746,  2908,  6401,    23,  7114,  6648, 13086])
before start barrier
start train
[proc 0] 100 steps, total: 23.451, sample: 0.205, forward: 1.307, backward: 21.434, update: 0.197
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 23.458, sample: 0.192, forward: 1.218, backward: 14.688, update: 0.190
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 23.458, sample: 0.197, forward: 1.197, backward: 14.689, update: 0.184
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.664 us                | 12.546 ms                 |
| Forward                   | 5.382 ms                  | 8.394 ms                  |
| Backward                  | 201.819 ms                | 392.742 ms                |
| Optimize                  | 1.526 ms                  | 5.014 ms                  |
| BarrierTimeBeforeRank0    | 36.050 us                 | 15.860 ms                 |
| BlockToStepN              | 11.328 us                 | 60.309 us                 |
| OneStep                   | 209.380 ms                | 1.040 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.701 us                | 12.546 ms                 |
| Forward                   | 5.364 ms                  | 8.394 ms                  |
| Backward                  | 225.982 ms                | 438.383 ms                |
| Optimize                  | 1.524 ms                  | 5.014 ms                  |
| BarrierTimeBeforeRank0    | 34.771 us                 | 15.860 ms                 |
| BlockToStepN              | 11.960 us                 | 60.309 us                 |
| OneStep                   | 234.577 ms                | 1.040 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.517 us                | 12.546 ms                 |
| Forward                   | 5.334 ms                  | 8.394 ms                  |
| Backward                  | 246.057 ms                | 487.680 ms                |
| Optimize                  | 1.513 ms                  | 5.014 ms                  |
| BarrierTimeBeforeRank0    | 34.771 us                 | 15.860 ms                 |
| BlockToStepN              | 12.055 us                 | 60.309 us                 |
| OneStep                   | 257.357 ms                | 1.040 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.213 us                | 12.546 ms                 |
| Forward                   | 5.328 ms                  | 8.394 ms                  |
| Backward                  | 260.578 ms                | 514.759 ms                |
| Optimize                  | 1.507 ms                  | 5.014 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.860 ms                 |
| BlockToStepN              | 12.533 us                 | 60.309 us                 |
| OneStep                   | 298.617 ms                | 1.040 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.365 us                | 12.546 ms                 |
| Forward                   | 5.328 ms                  | 8.394 ms                  |
| Backward                  | 291.091 ms                | 552.461 ms                |
| Optimize                  | 1.503 ms                  | 5.014 ms                  |
| BarrierTimeBeforeRank0    | 33.635 us                 | 16.748 ms                 |
| BlockToStepN              | 12.936 us                 | 60.309 us                 |
| OneStep                   | 304.230 ms                | 1.040 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.365 us                | 12.475 ms                 |
| Forward                   | 5.316 ms                  | 7.870 ms                  |
| Backward                  | 305.255 ms                | 568.920 ms                |
| Optimize                  | 1.513 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.846 us                 | 15.860 ms                 |
| BlockToStepN              | 13.159 us                 | 56.907 us                 |
| OneStep                   | 316.887 ms                | 584.915 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 799.188 us                | 12.475 ms                 |
| Forward                   | 5.311 ms                  | 7.870 ms                  |
| Backward                  | 313.428 ms                | 613.061 ms                |
| Optimize                  | 1.507 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.421 us                 | 15.860 ms                 |
| BlockToStepN              | 13.804 us                 | 56.907 us                 |
| OneStep                   | 324.379 ms                | 629.173 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.213 us                | 12.475 ms                 |
| Forward                   | 5.296 ms                  | 7.870 ms                  |
| Backward                  | 324.822 ms                | 631.173 ms                |
| Optimize                  | 1.507 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.421 us                 | 15.860 ms                 |
| BlockToStepN              | 13.804 us                 | 56.907 us                 |
| OneStep                   | 342.220 ms                | 665.093 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 800.213 us                | 12.475 ms                 |
| Forward                   | 5.289 ms                  | 7.870 ms                  |
| Backward                  | 340.262 ms                | 663.363 ms                |
| Optimize                  | 1.507 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.421 us                 | 15.860 ms                 |
| BlockToStepN              | 13.838 us                 | 56.907 us                 |
| OneStep                   | 356.730 ms                | 684.868 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.188 us                | 12.475 ms                 |
| Forward                   | 5.289 ms                  | 7.870 ms                  |
| Backward                  | 352.582 ms                | 704.298 ms                |
| Optimize                  | 1.507 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.635 us                 | 15.860 ms                 |
| BlockToStepN              | 13.966 us                 | 56.907 us                 |
| OneStep                   | 362.756 ms                | 713.606 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.036 us                | 12.475 ms                 |
| Forward                   | 5.289 ms                  | 7.870 ms                  |
| Backward                  | 368.310 ms                | 734.553 ms                |
| Optimize                  | 1.513 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.812 us                 | 15.860 ms                 |
| BlockToStepN              | 13.966 us                 | 56.907 us                 |
| OneStep                   | 379.419 ms                | 751.021 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.188 us                | 12.475 ms                 |
| Forward                   | 5.289 ms                  | 7.870 ms                  |
| Backward                  | 376.522 ms                | 742.881 ms                |
| Optimize                  | 1.517 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.812 us                 | 15.860 ms                 |
| BlockToStepN              | 14.243 us                 | 60.309 us                 |
| OneStep                   | 394.196 ms                | 757.461 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 57.667, sample: 0.200, forward: 0.452, backward: 35.843, update: 0.151
[proc 1] 200 steps, total: 57.667, sample: 0.194, forward: 0.474, backward: 53.912, update: 0.150
[proc 0] 200 steps, total: 57.667, sample: 0.207, forward: 0.522, backward: 56.662, update: 0.146
[proc 3] 200 steps, total: 57.667, sample: 0.189, forward: 0.456, backward: 36.053, update: 0.123
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.850 us                | 12.475 ms                 |
| Forward                   | 5.289 ms                  | 7.870 ms                  |
| Backward                  | 392.493 ms                | 765.901 ms                |
| Optimize                  | 1.513 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 15.860 ms                 |
| BlockToStepN              | 14.404 us                 | 60.309 us                 |
| OneStep                   | 404.976 ms                | 783.287 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.345 us                | 12.475 ms                 |
| Forward                   | 5.296 ms                  | 7.870 ms                  |
| Backward                  | 409.688 ms                | 791.339 ms                |
| Optimize                  | 1.513 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 15.860 ms                 |
| BlockToStepN              | 14.441 us                 | 60.309 us                 |
| OneStep                   | 419.076 ms                | 811.690 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.345 us                | 12.475 ms                 |
| Forward                   | 5.296 ms                  | 7.870 ms                  |
| Backward                  | 415.687 ms                | 830.991 ms                |
| Optimize                  | 1.513 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.635 us                 | 15.860 ms                 |
| BlockToStepN              | 14.488 us                 | 64.059 us                 |
| OneStep                   | 426.580 ms                | 849.454 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 804.850 us                | 12.475 ms                 |
| Forward                   | 5.290 ms                  | 7.870 ms                  |
| Backward                  | 425.914 ms                | 847.787 ms                |
| Optimize                  | 1.507 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.635 us                 | 15.860 ms                 |
| BlockToStepN              | 14.910 us                 | 64.059 us                 |
| OneStep                   | 435.266 ms                | 862.656 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 807.345 us                | 12.475 ms                 |
| Forward                   | 5.296 ms                  | 7.870 ms                  |
| Backward                  | 438.383 ms                | 865.153 ms                |
| Optimize                  | 1.513 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.635 us                 | 15.860 ms                 |
| BlockToStepN              | 15.048 us                 | 64.059 us                 |
| OneStep                   | 448.952 ms                | 895.730 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 811.651 us                | 12.475 ms                 |
| Forward                   | 5.296 ms                  | 7.870 ms                  |
| Backward                  | 450.872 ms                | 877.402 ms                |
| Optimize                  | 1.513 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 15.860 ms                 |
| BlockToStepN              | 15.209 us                 | 64.059 us                 |
| OneStep                   | 461.169 ms                | 895.730 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 811.651 us                | 12.475 ms                 |
| Forward                   | 5.296 ms                  | 7.870 ms                  |
| Backward                  | 457.651 ms                | 889.335 ms                |
| Optimize                  | 1.517 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.812 us                 | 15.860 ms                 |
| BlockToStepN              | 15.209 us                 | 64.059 us                 |
| OneStep                   | 469.491 ms                | 898.551 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.701 us                | 12.475 ms                 |
| Forward                   | 5.298 ms                  | 7.870 ms                  |
| Backward                  | 471.573 ms                | 927.115 ms                |
| Optimize                  | 1.519 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.812 us                 | 16.748 ms                 |
| BlockToStepN              | 15.133 us                 | 64.059 us                 |
| OneStep                   | 484.820 ms                | 943.152 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 813.701 us                | 12.253 ms                 |
| Forward                   | 5.299 ms                  | 7.260 ms                  |
| Backward                  | 477.419 ms                | 941.452 ms                |
| Optimize                  | 1.517 ms                  | 2.882 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 16.748 ms                 |
| BlockToStepN              | 15.133 us                 | 64.059 us                 |
| OneStep                   | 488.515 ms                | 959.385 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.397 us                | 12.253 ms                 |
| Forward                   | 5.299 ms                  | 7.260 ms                  |
| Backward                  | 485.559 ms                | 949.479 ms                |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.812 us                 | 15.860 ms                 |
| BlockToStepN              | 15.209 us                 | 60.309 us                 |
| OneStep                   | 495.187 ms                | 959.385 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 816.647 us                | 12.253 ms                 |
| Forward                   | 5.311 ms                  | 7.260 ms                  |
| Backward                  | 489.159 ms                | 971.194 ms                |
| Optimize                  | 1.522 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 15.860 ms                 |
| BlockToStepN              | 15.301 us                 | 63.591 us                 |
| OneStep                   | 517.753 ms                | 982.500 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.664 us                | 12.253 ms                 |
| Forward                   | 5.299 ms                  | 7.260 ms                  |
| Backward                  | 510.359 ms                | 980.487 ms                |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 15.860 ms                 |
| BlockToStepN              | 15.454 us                 | 63.591 us                 |
| OneStep                   | 519.147 ms                | 1.001 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.664 us                | 12.253 ms                 |
| Forward                   | 5.307 ms                  | 7.260 ms                  |
| Backward                  | 512.017 ms                | 998.657 ms                |
| Optimize                  | 1.517 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.812 us                 | 15.860 ms                 |
| BlockToStepN              | 15.556 us                 | 64.059 us                 |
| OneStep                   | 521.996 ms                | 1.017 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.664 us                | 12.253 ms                 |
| Forward                   | 5.304 ms                  | 7.260 ms                  |
| Backward                  | 514.759 ms                | 1.023 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 15.860 ms                 |
| BlockToStepN              | 15.779 us                 | 64.059 us                 |
| OneStep                   | 532.468 ms                | 1.040 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.664 us                | 12.253 ms                 |
| Forward                   | 5.304 ms                  | 7.260 ms                  |
| Backward                  | 523.882 ms                | 1.048 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 15.860 ms                 |
| BlockToStepN              | 15.779 us                 | 64.059 us                 |
| OneStep                   | 542.113 ms                | 1.060 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.397 us                | 12.253 ms                 |
| Forward                   | 5.302 ms                  | 7.260 ms                  |
| Backward                  | 549.652 ms                | 1.060 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 15.860 ms                 |
| BlockToStepN              | 15.885 us                 | 64.059 us                 |
| OneStep                   | 558.226 ms                | 1.068 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.664 us                | 12.253 ms                 |
| Forward                   | 5.306 ms                  | 7.260 ms                  |
| Backward                  | 552.461 ms                | 1.076 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.812 us                 | 15.860 ms                 |
| BlockToStepN              | 16.017 us                 | 64.059 us                 |
| OneStep                   | 561.091 ms                | 1.084 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 814.664 us                | 12.253 ms                 |
| Forward                   | 5.304 ms                  | 7.260 ms                  |
| Backward                  | 559.382 ms                | 1.093 s                   |
| Optimize                  | 1.517 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.682 us                 | 15.860 ms                 |
| BlockToStepN              | 16.018 us                 | 64.059 us                 |
| OneStep                   | 576.431 ms                | 1.102 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 816.647 us                | 12.253 ms                 |
| Forward                   | 5.306 ms                  | 7.260 ms                  |
| Backward                  | 562.642 ms                | 1.104 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.812 us                 | 15.860 ms                 |
| BlockToStepN              | 16.018 us                 | 64.059 us                 |
| OneStep                   | 577.301 ms                | 1.113 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 94.725, sample: 0.198, forward: 0.541, backward: 93.718, update: 0.151
[proc 1] 300 steps, total: 94.725, sample: 0.181, forward: 0.462, backward: 87.925, update: 0.160
[proc 3] 300 steps, total: 94.725, sample: 0.205, forward: 0.450, backward: 59.297, update: 0.126
[proc 2] 300 steps, total: 94.725, sample: 0.179, forward: 0.447, backward: 58.918, update: 0.152
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 816.647 us                | 12.253 ms                 |
| Forward                   | 5.306 ms                  | 7.260 ms                  |
| Backward                  | 575.315 ms                | 1.120 s                   |
| Optimize                  | 1.517 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.846 us                 | 15.860 ms                 |
| BlockToStepN              | 16.444 us                 | 64.059 us                 |
| OneStep                   | 583.919 ms                | 1.128 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 817.182 us                | 12.253 ms                 |
| Forward                   | 5.307 ms                  | 7.260 ms                  |
| Backward                  | 576.586 ms                | 1.140 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.860 ms                 |
| BlockToStepN              | 16.444 us                 | 64.059 us                 |
| OneStep                   | 590.203 ms                | 1.149 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 817.182 us                | 12.253 ms                 |
| Forward                   | 5.306 ms                  | 7.260 ms                  |
| Backward                  | 584.900 ms                | 1.156 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.860 ms                 |
| BlockToStepN              | 16.468 us                 | 64.059 us                 |
| OneStep                   | 597.867 ms                | 1.167 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.231 us                | 12.253 ms                 |
| Forward                   | 5.304 ms                  | 7.260 ms                  |
| Backward                  | 594.075 ms                | 1.164 s                   |
| Optimize                  | 1.522 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.860 ms                 |
| BlockToStepN              | 16.468 us                 | 64.059 us                 |
| OneStep                   | 605.720 ms                | 1.173 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.231 us                | 12.253 ms                 |
| Forward                   | 5.306 ms                  | 7.260 ms                  |
| Backward                  | 604.337 ms                | 1.188 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.860 ms                 |
| BlockToStepN              | 16.468 us                 | 66.090 us                 |
| OneStep                   | 620.916 ms                | 1.196 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.249 us                | 12.253 ms                 |
| Forward                   | 5.304 ms                  | 7.260 ms                  |
| Backward                  | 613.257 ms                | 1.198 s                   |
| Optimize                  | 1.517 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.860 ms                 |
| BlockToStepN              | 16.468 us                 | 66.090 us                 |
| OneStep                   | 623.109 ms                | 1.210 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.249 us                | 12.253 ms                 |
| Forward                   | 5.306 ms                  | 7.260 ms                  |
| Backward                  | 619.969 ms                | 1.222 s                   |
| Optimize                  | 1.517 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.860 ms                 |
| BlockToStepN              | 16.479 us                 | 66.090 us                 |
| OneStep                   | 636.700 ms                | 1.231 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.249 us                | 12.253 ms                 |
| Forward                   | 5.302 ms                  | 7.260 ms                  |
| Backward                  | 630.112 ms                | 1.233 s                   |
| Optimize                  | 1.514 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.860 ms                 |
| BlockToStepN              | 16.520 us                 | 66.090 us                 |
| OneStep                   | 639.438 ms                | 1.240 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 820.805 us                | 12.253 ms                 |
| Forward                   | 5.301 ms                  | 7.260 ms                  |
| Backward                  | 632.618 ms                | 1.253 s                   |
| Optimize                  | 1.517 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.860 ms                 |
| BlockToStepN              | 16.608 us                 | 66.090 us                 |
| OneStep                   | 647.901 ms                | 1.262 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 820.805 us                | 12.253 ms                 |
| Forward                   | 5.301 ms                  | 7.260 ms                  |
| Backward                  | 643.985 ms                | 1.268 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.860 ms                 |
| BlockToStepN              | 16.690 us                 | 66.090 us                 |
| OneStep                   | 653.724 ms                | 1.275 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 820.805 us                | 12.253 ms                 |
| Forward                   | 5.302 ms                  | 7.260 ms                  |
| Backward                  | 647.875 ms                | 1.285 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 34.021 us                 | 15.860 ms                 |
| BlockToStepN              | 16.802 us                 | 66.090 us                 |
| OneStep                   | 665.093 ms                | 1.303 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.249 us                | 12.253 ms                 |
| Forward                   | 5.302 ms                  | 7.260 ms                  |
| Backward                  | 653.062 ms                | 1.306 s                   |
| Optimize                  | 1.519 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 34.021 us                 | 15.860 ms                 |
| BlockToStepN              | 16.893 us                 | 66.090 us                 |
| OneStep                   | 669.873 ms                | 1.313 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 819.249 us                | 12.171 ms                 |
| Forward                   | 5.304 ms                  | 6.960 ms                  |
| Backward                  | 663.363 ms                | 1.307 s                   |
| Optimize                  | 1.519 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 34.045 us                 | 15.214 ms                 |
| BlockToStepN              | 17.212 us                 | 64.059 us                 |
| OneStep                   | 673.876 ms                | 1.316 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 820.805 us                | 12.171 ms                 |
| Forward                   | 5.306 ms                  | 6.960 ms                  |
| Backward                  | 674.660 ms                | 1.319 s                   |
| Optimize                  | 1.524 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 34.052 us                 | 15.214 ms                 |
| BlockToStepN              | 17.430 us                 | 64.059 us                 |
| OneStep                   | 685.098 ms                | 1.330 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.306 ms                  | 6.960 ms                  |
| Backward                  | 682.372 ms                | 1.328 s                   |
| Optimize                  | 1.522 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 34.045 us                 | 15.214 ms                 |
| BlockToStepN              | 17.495 us                 | 64.059 us                 |
| OneStep                   | 695.849 ms                | 1.338 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.304 ms                  | 6.960 ms                  |
| Backward                  | 685.064 ms                | 1.345 s                   |
| Optimize                  | 1.519 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 34.021 us                 | 15.214 ms                 |
| BlockToStepN              | 17.501 us                 | 64.059 us                 |
| OneStep                   | 700.109 ms                | 1.353 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 820.805 us                | 12.171 ms                 |
| Forward                   | 5.306 ms                  | 6.960 ms                  |
| Backward                  | 695.531 ms                | 1.367 s                   |
| Optimize                  | 1.522 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 17.605 us                 | 64.059 us                 |
| OneStep                   | 705.556 ms                | 1.376 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.307 ms                  | 6.960 ms                  |
| Backward                  | 701.146 ms                | 1.386 s                   |
| Optimize                  | 1.522 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 17.643 us                 | 66.090 us                 |
| OneStep                   | 710.754 ms                | 1.394 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.306 ms                  | 6.960 ms                  |
| Backward                  | 704.298 ms                | 1.402 s                   |
| Optimize                  | 1.522 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 17.721 us                 | 66.090 us                 |
| OneStep                   | 713.606 ms                | 1.414 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.306 ms                  | 6.960 ms                  |
| Backward                  | 708.807 ms                | 1.406 s                   |
| Optimize                  | 1.522 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 34.021 us                 | 15.214 ms                 |
| BlockToStepN              | 17.920 us                 | 66.090 us                 |
| OneStep                   | 733.024 ms                | 1.419 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.307 ms                  | 6.960 ms                  |
| Backward                  | 717.945 ms                | 1.424 s                   |
| Optimize                  | 1.522 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 17.940 us                 | 66.090 us                 |
| OneStep                   | 737.470 ms                | 1.432 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.306 ms                  | 6.960 ms                  |
| Backward                  | 731.697 ms                | 1.440 s                   |
| Optimize                  | 1.522 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 18.028 us                 | 66.090 us                 |
| OneStep                   | 741.392 ms                | 1.448 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.306 ms                  | 6.960 ms                  |
| Backward                  | 734.553 ms                | 1.452 s                   |
| Optimize                  | 1.522 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 18.043 us                 | 66.090 us                 |
| OneStep                   | 751.021 ms                | 1.461 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.307 ms                  | 6.960 ms                  |
| Backward                  | 738.008 ms                | 1.463 s                   |
| Optimize                  | 1.519 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 18.135 us                 | 66.090 us                 |
| OneStep                   | 757.020 ms                | 1.472 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.311 ms                  | 6.960 ms                  |
| Backward                  | 748.140 ms                | 1.472 s                   |
| Optimize                  | 1.522 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 18.349 us                 | 66.183 us                 |
| OneStep                   | 757.461 ms                | 1.481 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.311 ms                  | 6.960 ms                  |
| Backward                  | 753.445 ms                | 1.475 s                   |
| Optimize                  | 1.524 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 18.397 us                 | 67.182 us                 |
| OneStep                   | 764.827 ms                | 1.490 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 132.185, sample: 0.180, forward: 0.468, backward: 121.827, update: 0.170
[proc 2] 400 steps, total: 132.185, sample: 0.184, forward: 0.451, backward: 81.288, update: 0.152
[proc 3] 400 steps, total: 132.185, sample: 0.191, forward: 0.449, backward: 82.632, update: 0.124
[proc 0] 400 steps, total: 132.185, sample: 0.212, forward: 0.534, backward: 131.192, update: 0.154
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.321 ms                  | 6.960 ms                  |
| Backward                  | 761.675 ms                | 1.495 s                   |
| Optimize                  | 1.524 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 18.541 us                 | 67.182 us                 |
| OneStep                   | 773.926 ms                | 1.504 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.321 ms                  | 6.960 ms                  |
| Backward                  | 765.901 ms                | 1.524 s                   |
| Optimize                  | 1.524 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.214 ms                 |
| BlockToStepN              | 18.610 us                 | 67.182 us                 |
| OneStep                   | 778.645 ms                | 1.532 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.321 ms                  | 6.960 ms                  |
| Backward                  | 770.920 ms                | 1.526 s                   |
| Optimize                  | 1.526 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.214 ms                 |
| BlockToStepN              | 18.684 us                 | 67.182 us                 |
| OneStep                   | 786.580 ms                | 1.533 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.321 ms                  | 6.960 ms                  |
| Backward                  | 772.529 ms                | 1.531 s                   |
| Optimize                  | 1.526 ms                  | 2.545 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.214 ms                 |
| BlockToStepN              | 18.711 us                 | 67.182 us                 |
| OneStep                   | 786.852 ms                | 1.539 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.321 ms                  | 6.960 ms                  |
| Backward                  | 778.889 ms                | 1.545 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.214 ms                 |
| BlockToStepN              | 18.774 us                 | 67.182 us                 |
| OneStep                   | 796.770 ms                | 1.554 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.324 ms                  | 6.960 ms                  |
| Backward                  | 791.339 ms                | 1.545 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 18.826 us                 | 67.182 us                 |
| OneStep                   | 808.026 ms                | 1.563 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.324 ms                  | 6.960 ms                  |
| Backward                  | 793.644 ms                | 1.565 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 18.826 us                 | 67.182 us                 |
| OneStep                   | 808.284 ms                | 1.573 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.099 us                | 12.171 ms                 |
| Forward                   | 5.324 ms                  | 6.960 ms                  |
| Backward                  | 800.094 ms                | 1.596 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 19.070 us                 | 67.182 us                 |
| OneStep                   | 817.382 ms                | 1.605 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.324 ms                  | 6.960 ms                  |
| Backward                  | 809.410 ms                | 1.596 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 19.125 us                 | 67.182 us                 |
| OneStep                   | 819.597 ms                | 1.605 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.321 ms                  | 6.960 ms                  |
| Backward                  | 816.923 ms                | 1.602 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 19.271 us                 | 67.182 us                 |
| OneStep                   | 834.435 ms                | 1.614 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.325 ms                  | 6.960 ms                  |
| Backward                  | 825.078 ms                | 1.617 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.214 ms                 |
| BlockToStepN              | 19.271 us                 | 67.182 us                 |
| OneStep                   | 834.478 ms                | 1.626 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.171 ms                 |
| Forward                   | 5.325 ms                  | 6.960 ms                  |
| Backward                  | 826.005 ms                | 1.625 s                   |
| Optimize                  | 1.527 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 19.419 us                 | 67.182 us                 |
| OneStep                   | 838.999 ms                | 1.635 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.325 ms                  | 6.960 ms                  |
| Backward                  | 830.991 ms                | 1.635 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 19.454 us                 | 67.182 us                 |
| OneStep                   | 843.693 ms                | 1.642 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.328 ms                  | 6.960 ms                  |
| Backward                  | 841.571 ms                | 1.643 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 19.586 us                 | 67.182 us                 |
| OneStep                   | 851.632 ms                | 1.651 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 823.347 us                | 12.171 ms                 |
| Forward                   | 5.328 ms                  | 6.960 ms                  |
| Backward                  | 842.947 ms                | 1.657 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.214 ms                 |
| BlockToStepN              | 19.753 us                 | 67.182 us                 |
| OneStep                   | 855.109 ms                | 1.669 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.171 ms                 |
| Forward                   | 5.328 ms                  | 6.960 ms                  |
| Backward                  | 850.992 ms                | 1.660 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 19.859 us                 | 67.182 us                 |
| OneStep                   | 861.520 ms                | 1.675 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 823.347 us                | 12.168 ms                 |
| Forward                   | 5.328 ms                  | 6.881 ms                  |
| Backward                  | 854.075 ms                | 1.679 s                   |
| Optimize                  | 1.526 ms                  | 2.872 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.214 ms                 |
| BlockToStepN              | 20.034 us                 | 70.570 us                 |
| OneStep                   | 862.656 ms                | 1.689 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 823.347 us                | 12.168 ms                 |
| Forward                   | 5.328 ms                  | 6.881 ms                  |
| Backward                  | 863.359 ms                | 1.681 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.094 ms                 |
| BlockToStepN              | 20.109 us                 | 67.282 us                 |
| OneStep                   | 875.488 ms                | 1.689 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 823.347 us                | 12.168 ms                 |
| Forward                   | 5.328 ms                  | 6.881 ms                  |
| Backward                  | 865.153 ms                | 1.694 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.094 ms                 |
| BlockToStepN              | 20.115 us                 | 67.282 us                 |
| OneStep                   | 880.777 ms                | 1.703 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.070 us                | 12.168 ms                 |
| Forward                   | 5.330 ms                  | 6.881 ms                  |
| Backward                  | 872.792 ms                | 1.701 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.965 us                 | 15.094 ms                 |
| BlockToStepN              | 20.115 us                 | 67.282 us                 |
| OneStep                   | 884.674 ms                | 1.708 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 825.131 us                | 12.168 ms                 |
| Forward                   | 5.330 ms                  | 6.881 ms                  |
| Backward                  | 876.975 ms                | 1.718 s                   |
| Optimize                  | 1.524 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.094 ms                 |
| BlockToStepN              | 20.109 us                 | 67.282 us                 |
| OneStep                   | 885.871 ms                | 1.730 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.070 us                | 12.168 ms                 |
| Forward                   | 5.330 ms                  | 6.881 ms                  |
| Backward                  | 877.630 ms                | 1.725 s                   |
| Optimize                  | 1.524 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.094 ms                 |
| BlockToStepN              | 20.341 us                 | 67.282 us                 |
| OneStep                   | 890.941 ms                | 1.736 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.070 us                | 12.168 ms                 |
| Forward                   | 5.330 ms                  | 6.881 ms                  |
| Backward                  | 878.949 ms                | 1.741 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.941 us                 | 15.094 ms                 |
| BlockToStepN              | 20.341 us                 | 67.282 us                 |
| OneStep                   | 892.828 ms                | 1.748 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.070 us                | 12.168 ms                 |
| Forward                   | 5.333 ms                  | 6.881 ms                  |
| Backward                  | 881.132 ms                | 1.746 s                   |
| Optimize                  | 1.524 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.094 ms                 |
| BlockToStepN              | 20.446 us                 | 67.282 us                 |
| OneStep                   | 895.730 ms                | 1.760 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 823.347 us                | 12.168 ms                 |
| Forward                   | 5.330 ms                  | 6.881 ms                  |
| Backward                  | 883.425 ms                | 1.774 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.860 us                 | 15.094 ms                 |
| BlockToStepN              | 20.461 us                 | 67.282 us                 |
| OneStep                   | 898.551 ms                | 1.782 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.070 us                | 12.168 ms                 |
| Forward                   | 5.330 ms                  | 6.881 ms                  |
| Backward                  | 888.831 ms                | 1.790 s                   |
| Optimize                  | 1.524 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.846 us                 | 15.094 ms                 |
| BlockToStepN              | 20.446 us                 | 67.994 us                 |
| OneStep                   | 902.378 ms                | 1.803 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 824.070 us                | 12.168 ms                 |
| Forward                   | 5.333 ms                  | 6.881 ms                  |
| Backward                  | 889.335 ms                | 1.796 s                   |
| Optimize                  | 1.524 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.846 us                 | 15.094 ms                 |
| BlockToStepN              | 20.461 us                 | 70.201 us                 |
| OneStep                   | 906.428 ms                | 1.805 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 823.347 us                | 12.168 ms                 |
| Forward                   | 5.330 ms                  | 6.881 ms                  |
| Backward                  | 894.396 ms                | 1.812 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.846 us                 | 15.094 ms                 |
| BlockToStepN              | 20.500 us                 | 70.201 us                 |
| OneStep                   | 916.538 ms                | 1.820 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 823.347 us                | 12.168 ms                 |
| Forward                   | 5.334 ms                  | 6.881 ms                  |
| Backward                  | 899.105 ms                | 1.836 s                   |
| Optimize                  | 1.524 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.828 us                 | 15.094 ms                 |
| BlockToStepN              | 20.500 us                 | 70.201 us                 |
| OneStep                   | 927.966 ms                | 1.844 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.168 ms                 |
| Forward                   | 5.334 ms                  | 6.881 ms                  |
| Backward                  | 921.236 ms                | 1.838 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.828 us                 | 15.094 ms                 |
| BlockToStepN              | 20.782 us                 | 70.201 us                 |
| OneStep                   | 933.182 ms                | 1.847 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.168 ms                 |
| Forward                   | 5.334 ms                  | 6.881 ms                  |
| Backward                  | 924.656 ms                | 1.838 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.812 us                 | 15.094 ms                 |
| BlockToStepN              | 20.782 us                 | 70.201 us                 |
| OneStep                   | 935.384 ms                | 1.847 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.952 us                | 12.168 ms                 |
| Forward                   | 5.334 ms                  | 6.881 ms                  |
| Backward                  | 927.115 ms                | 1.856 s                   |
| Optimize                  | 1.524 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.705 us                 | 15.094 ms                 |
| BlockToStepN              | 20.844 us                 | 70.201 us                 |
| OneStep                   | 943.152 ms                | 1.868 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.168 ms                 |
| Forward                   | 5.334 ms                  | 6.881 ms                  |
| Backward                  | 937.104 ms                | 1.866 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.705 us                 | 15.094 ms                 |
| BlockToStepN              | 20.919 us                 | 70.201 us                 |
| OneStep                   | 945.179 ms                | 1.875 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.168 ms                 |
| Forward                   | 5.334 ms                  | 6.881 ms                  |
| Backward                  | 937.511 ms                | 1.879 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.705 us                 | 15.094 ms                 |
| BlockToStepN              | 20.919 us                 | 70.201 us                 |
| OneStep                   | 949.599 ms                | 1.888 s                   |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 170.874, sample: 0.183, forward: 0.480, backward: 156.181, update: 0.176
[proc 0] 500 steps, total: 170.874, sample: 0.198, forward: 0.542, backward: 169.864, update: 0.155
[proc 2] 500 steps, total: 170.874, sample: 0.203, forward: 0.452, backward: 103.428, update: 0.153
[proc 3] 500 steps, total: 170.874, sample: 0.182, forward: 0.452, backward: 104.284, update: 0.125
Successfully xmh. training takes 478.9031777381897 seconds
before call kg_cache_controller.StopThreads()
INFO [420827 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
INFO [420827 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 822.846 us                | 12.168 ms                 |
| Forward                   | 5.338 ms                  | 6.881 ms                  |
| Backward                  | 941.452 ms                | 1.880 s                   |
| Optimize                  | 1.526 ms                  | 2.784 ms                  |
| BarrierTimeBeforeRank0    | 33.705 us                 | 15.094 ms                 |
| BlockToStepN              | 20.924 us                 | 70.201 us                 |
| OneStep                   | 954.482 ms                | 1.890 s                   |
+---------------------------+---------------------------+---------------------------+
