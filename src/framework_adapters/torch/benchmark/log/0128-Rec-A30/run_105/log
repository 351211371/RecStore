WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240130 21:31:42.795769 209715 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240130 21:31:42.797493 209715 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:151: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [209715 perf_rec_model.py:151] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f8391635120>==========
Worker 1 pid=209860
Worker 2 pid=209862
INFO [209715 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [209860 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [209862 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [209862 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [209860 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [209864 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [209715 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240130 21:31:46.058249 209862 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 21:31:46.058414 209860 IPCTensor.h:348] IPCTensor full_emb already exists
E20240130 21:31:46.058777 209715 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [209864 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240130 21:31:46.059718 209864 IPCTensor.h:348] IPCTensor full_emb already exists
W20240130 21:31:46.066812 209860 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [472460, 32]; dev=1; size=57.67 MB
W20240130 21:31:46.067003 209715 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [472460, 32]; dev=0; size=57.67 MB
W20240130 21:31:46.067174 209862 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [472460, 32]; dev=2; size=57.67 MB
W20240130 21:31:46.067879 209864 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [472460, 32]; dev=3; size=57.67 MB
W20240130 21:31:46.068449 209860 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x10004817d000 7.629 MB
W20240130 21:31:46.068715 209860 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100048924000 7.629 MB
W20240130 21:31:46.068742 209715 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x1000490c7000 7.629 MB
W20240130 21:31:46.068768 209862 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10004986a000 7.629 MB
W20240130 21:31:46.068868 209860 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x10004a00f000 122.1 MB
W20240130 21:31:46.068939 209715 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x100051a23000 7.629 MB
W20240130 21:31:46.068975 209860 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x1000521c6000 122.1 MB
W20240130 21:31:46.069013 209862 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100059bda000 7.629 MB
W20240130 21:31:46.069027 209715 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x10005a37d000 122.1 MB
W20240130 21:31:46.069067 209860 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240130 21:31:46.069110 209715 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x100061d91000 122.1 MB
W20240130 21:31:46.069137 209862 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1000697a5000 122.1 MB
W20240130 21:31:46.069183 209715 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 21:31:46.069186 209864 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000711b9000 7.629 MB
W20240130 21:31:46.069221 209862 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10007195c000 122.1 MB
W20240130 21:31:46.069358 209862 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240130 21:31:46.069449 209864 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x100079370000 7.629 MB
W20240130 21:31:46.069550 209864 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100079b13000 122.1 MB
W20240130 21:31:46.069622 209864 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x100081527000 122.1 MB
W20240130 21:31:46.069681 209864 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240130 21:31:46.071331 209715 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240130 21:31:46.071377 209860 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240130 21:31:46.071390 209862 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240130 21:31:46.071398 209864 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
Worker 3 pid=209864
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 472460), (472460, 944920), (944920, 1417380), (1417380, 1889840)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
W20240130 21:31:49.988513 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100088f4b000 7.629 MB
W20240130 21:31:49.988682 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000896ee000 7.629 MB
W20240130 21:31:49.988709 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100089e91000 7.629 MB
W20240130 21:31:49.988732 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10008a634000 7.629 MB
W20240130 21:31:49.988760 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10008add7000 7.629 MB
W20240130 21:31:49.988795 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10008b57a000 7.629 MB
W20240130 21:31:49.988817 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10008bd1d000 7.629 MB
W20240130 21:31:49.988853 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10008c4c0000 7.629 MB
W20240130 21:31:49.988875 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10008cc63000 7.629 MB
W20240130 21:31:49.988900 209864 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x10008d406000 7.629 MB
W20240130 21:31:49.988926 209864 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10008dba9000 80 B 
W20240130 21:31:49.988950 209864 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10008dbab000 8 B 
W20240130 21:31:49.988966 209864 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10008dbad000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240130 21:31:49.989274 209864 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240130 21:31:50.302855 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10008dbaf000 7.629 MB
W20240130 21:31:50.302978 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10008e352000 7.629 MB
W20240130 21:31:50.303006 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10008eaf5000 7.629 MB
W20240130 21:31:50.303031 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10008f298000 7.629 MB
W20240130 21:31:50.303056 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10008fa3b000 7.629 MB
W20240130 21:31:50.303084 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000901de000 7.629 MB
W20240130 21:31:50.303107 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x100090981000 7.629 MB
W20240130 21:31:50.303157 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100091124000 7.629 MB
W20240130 21:31:50.303182 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000918c7000 7.629 MB
W20240130 21:31:50.303226 209862 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10009206a000 7.629 MB
W20240130 21:31:50.303249 209862 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10009280d000 80 B 
W20240130 21:31:50.303272 209862 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10009280f000 8 B 
W20240130 21:31:50.303290 209862 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100092811000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240130 21:31:50.303529 209862 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 21:31:50.330440 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100092813000 7.629 MB
W20240130 21:31:50.330575 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100092fb6000 7.629 MB
W20240130 21:31:50.330600 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100093759000 7.629 MB
W20240130 21:31:50.330626 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100093efc000 7.629 MB
W20240130 21:31:50.330648 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10009469f000 7.629 MB
W20240130 21:31:50.330675 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100094e42000 7.629 MB
W20240130 21:31:50.330704 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000955e5000 7.629 MB
W20240130 21:31:50.330741 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100095d88000 7.629 MB
W20240130 21:31:50.330761 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10009652b000 7.629 MB
W20240130 21:31:50.330785 209860 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100096cce000 7.629 MB
W20240130 21:31:50.330808 209860 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x100097471000 80 B 
W20240130 21:31:50.330832 209860 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x100097473000 8 B 
W20240130 21:31:50.330848 209860 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100097475000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240130 21:31:50.331077 209860 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 21:31:50.439054 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100097477000 7.629 MB
W20240130 21:31:50.439204 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100097c1a000 7.629 MB
W20240130 21:31:50.439239 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000983bd000 7.629 MB
W20240130 21:31:50.439267 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100098b60000 7.629 MB
W20240130 21:31:50.439291 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100099303000 7.629 MB
W20240130 21:31:50.439312 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100099aa6000 7.629 MB
W20240130 21:31:50.439332 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10009a249000 7.629 MB
W20240130 21:31:50.439363 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10009a9ec000 7.629 MB
W20240130 21:31:50.439383 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10009b18f000 7.629 MB
W20240130 21:31:50.439407 209715 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10009b932000 7.629 MB
W20240130 21:31:50.439445 209715 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10009c0d5000 80 B 
W20240130 21:31:50.439479 209715 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10009c0d7000 8 B 
W20240130 21:31:50.439530 209715 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10009c0d9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240130 21:31:50.439872 209715 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240130 21:31:50.441356 209715 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.05,
        "backgrad_init": "both",
        "update_pq_use_omp": 2,
        "kUpdatePqWorkerNum": 8
    }
W20240130 21:31:50.441473 209715 grad_base.h:184] Init GradProcessingBase done
I20240130 21:31:51.118446 209715 grad_async_v2.h:43] Use main thread to update emb.
W20240130 21:31:51.118711 209715 kg_controller.h:78] after init GradAsyncProcessingV2
I20240130 21:31:51.118721 209715 kg_controller.h:84] Construct KGCacheController done
E20240130 21:31:51.490669 209860 recstore.cc:66] init folly done
E20240130 21:31:51.490671 209715 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
E20240130 21:31:51.490882 209862 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
E20240130 21:31:51.490940 209864 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
I20240130 21:31:51.491616 209715 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240130 21:31:52.268680 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 21:31:52.276235 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 21:31:53.276043 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:31:53.370312 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
E20240130 21:31:54.276018 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240130 21:31:54.447597 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
E20240130 21:31:55.276363 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:31:55.561225 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
E20240130 21:31:56.276074 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=74
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 135.679 us                | 241.577 us                |
+---------------------------+---------------------------+---------------------------+
W20240130 21:31:56.718937 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240130 21:31:57.276245 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
Before Training
Before Training
Before Training
I20240130 21:31:58.480958 209862 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240130 21:31:58.480991 209860 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240130 21:31:58.481032 209715 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240130 21:31:58.481220 209864 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
W20240130 21:31:58.494001 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
E20240130 21:31:58.494307 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240130 21:31:59.863461 211520 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:00.321687 209715 grad_async_v2.h:269] Sleep in <BlockToStepN>, step_no=1, pq.top=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 184.686 us                | 184.686 us                |
| GenInput                  | 27.887 ms                 | 27.887 ms                 |
| NN                        | 119.393 ms                | 119.393 ms                |
| Forward                   | 121.906 ms                | 121.906 ms                |
| Backward                  | 132.624 ms                | 132.624 ms                |
| Optimize                  | 9.241 ms                  | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 34.411 ms                 | 34.411 ms                 |
| AfterBackward             | 1.513 s                   | 1.513 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240130 21:32:00.573770 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
INFO [209715 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [209864 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [209862 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [209860 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
E20240130 21:32:00.863073 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:32:01.407742 209715 grad_async_v2.h:256] pq is empty
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 141.048 us                | 1.480 ms                  |
| ProcessBack:Shuffle       | 347.423 ms                | 698.890 ms                |
| ProcessBack:UpdateCache   | 1.982 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 62.567 us                 | 458.673 ms                |
| ProcessOneStep            | 701.031 ms                | 1.512 s                   |
| BlockToStepN              | 82.453 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
W20240130 21:32:01.732637 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
E20240130 21:32:01.863037 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
E20240130 21:32:02.863190 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:02.978873 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end7
W20240130 21:32:03.008762 209715 grad_async_v2.h:256] pq is empty
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
E20240130 21:32:03.863073 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:03.982173 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end9
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240130 21:32:04.863044 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.241 us                | 264.933 us                |
| GenInput                  | 36.164 ms                 | 46.080 ms                 |
| NN                        | 598.636 us                | 119.393 ms                |
| Forward                   | 862.815 us                | 121.906 ms                |
| Backward                  | 3.222 ms                  | 132.624 ms                |
| Optimize                  | 199.243 us                | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 352.997 us                | 34.411 ms                 |
| AfterBackward             | 260.002 ms                | 1.513 s                   |
| BlockToStepN              | 148.191 us                | 228.064 ms                |
| OneStep                   | 303.160 ms                | 2.069 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:05.630636 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end4
E20240130 21:32:05.863106 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 131.706 us                | 293.806 us                |
| ProcessBack:Shuffle       | 259.041 ms                | 1.307 s                   |
| ProcessBack:UpdateCache   | 1.520 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 51.717 us                 | 458.673 ms                |
| ProcessOneStep            | 259.960 ms                | 1.512 s                   |
| BlockToStepN              | 57.367 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240130 21:32:06.863306 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=128
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
W20240130 21:32:06.970168 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end9
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
E20240130 21:32:07.863059 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=146
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
E20240130 21:32:08.863054 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:09.039261 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end2
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
E20240130 21:32:09.863320 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:10.004447 209715 grad_async_v2.h:256] pq is empty
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
W20240130 21:32:10.157974 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.241 us                | 264.933 us                |
| GenInput                  | 36.164 ms                 | 46.080 ms                 |
| NN                        | 596.282 us                | 119.393 ms                |
| Forward                   | 862.815 us                | 121.906 ms                |
| Backward                  | 1.867 ms                  | 132.624 ms                |
| Optimize                  | 196.650 us                | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 556.479 us                | 34.411 ms                 |
| AfterBackward             | 160.883 ms                | 1.513 s                   |
| BlockToStepN              | 148.191 us                | 228.064 ms                |
| OneStep                   | 200.769 ms                | 2.069 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:10.863112 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:11.272512 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
W20240130 21:32:11.360296 209715 grad_async_v2.h:256] pq is empty
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 127.100 us                | 227.170 us                |
| ProcessBack:Shuffle       | 159.162 ms                | 1.307 s                   |
| ProcessBack:UpdateCache   | 1.982 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 59.177 us                 | 458.673 ms                |
| ProcessOneStep            | 250.324 ms                | 1.512 s                   |
| BlockToStepN              | 81.211 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
E20240130 21:32:11.863021 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=283
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
E20240130 21:32:12.863118 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=50
W20240130 21:32:12.957051 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end2
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
W20240130 21:32:13.775382 209715 grad_async_v2.h:256] pq is empty
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
E20240130 21:32:13.863097 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:14.785179 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end6
E20240130 21:32:14.863029 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:15.152961 209715 grad_async_v2.h:256] pq is empty
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 153.623 us                | 264.933 us                |
| GenInput                  | 36.095 ms                 | 46.080 ms                 |
| NN                        | 565.336 us                | 119.393 ms                |
| Forward                   | 833.525 us                | 121.906 ms                |
| Backward                  | 1.873 ms                  | 132.624 ms                |
| Optimize                  | 203.454 us                | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 435.553 us                | 34.411 ms                 |
| AfterBackward             | 160.883 ms                | 1.513 s                   |
| BlockToStepN              | 150.099 us                | 228.064 ms                |
| OneStep                   | 200.769 ms                | 2.069 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:15.863124 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:15.892622 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 98.130 us                 | 11.752 ms                 |
| ProcessBack:Shuffle       | 146.753 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.940 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 57.072 us                 | 458.673 ms                |
| ProcessOneStep            | 160.859 ms                | 1.512 s                   |
| BlockToStepN              | 91.184 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
E20240130 21:32:16.863065 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:17.440901 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end9
E20240130 21:32:17.863329 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:18.052050 209715 grad_async_v2.h:256] pq is empty
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
W20240130 21:32:18.570124 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
E20240130 21:32:18.863199 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:19.144217 209715 grad_async_v2.h:256] pq is empty
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
W20240130 21:32:19.583372 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240130 21:32:19.741433 209715 grad_async_v2.h:256] pq is empty
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
E20240130 21:32:19.863039 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:32:20.252332 209715 grad_async_v2.h:256] pq is empty
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 155.172 us                | 264.933 us                |
| GenInput                  | 36.095 ms                 | 46.080 ms                 |
| NN                        | 598.193 us                | 119.393 ms                |
| Forward                   | 865.062 us                | 121.906 ms                |
| Backward                  | 1.922 ms                  | 132.624 ms                |
| Optimize                  | 213.922 us                | 9.241 ms                  |
| BarrierTimeBeforeRank0    | 435.553 us                | 34.411 ms                 |
| AfterBackward             | 207.057 ms                | 1.513 s                   |
| BlockToStepN              | 159.975 us                | 228.064 ms                |
| OneStep                   | 250.183 ms                | 2.069 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:20.563292 209715 grad_async_v2.h:256] pq is empty
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
W20240130 21:32:20.628405 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
E20240130 21:32:20.863124 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:21.227722 209715 grad_async_v2.h:256] pq is empty
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.646 us                | 5.548 ms                  |
| ProcessBack:Shuffle       | 201.088 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.738 ms                  | 671.984 ms                |
| ProcessBack:UpsertPq      | 58.254 us                 | 458.673 ms                |
| ProcessOneStep            | 250.324 ms                | 1.512 s                   |
| BlockToStepN              | 98.969 us                 | 227.748 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
W20240130 21:32:21.807698 209715 grad_async_v2.h:256] pq is empty
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
E20240130 21:32:21.865823 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240130 21:32:21.891196 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end9
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
E20240130 21:32:22.865134 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:22.954874 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end0
E20240130 21:32:23.865018 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:23.980258 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
W20240130 21:32:24.756696 209715 grad_async_v2.h:256] pq is empty
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
E20240130 21:32:24.865228 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=60
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
W20240130 21:32:25.022991 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 157.347 us                | 258.448 us                |
| GenInput                  | 36.027 ms                 | 42.207 ms                 |
| NN                        | 598.193 us                | 4.624 ms                  |
| Forward                   | 865.571 us                | 4.877 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 216.044 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 254.236 us                | 3.467 ms                  |
| AfterBackward             | 250.350 ms                | 1.331 s                   |
| BlockToStepN              | 165.530 us                | 3.419 ms                  |
| OneStep                   | 289.600 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:25.865099 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=42
W20240130 21:32:25.892335 209715 grad_async_v2.h:256] pq is empty
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240130 21:32:26.029984 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end4
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 130.932 us                | 11.671 ms                 |
| ProcessBack:Shuffle       | 245.652 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.520 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 86.286 us                 |
| ProcessOneStep            | 259.960 ms                | 1.331 s                   |
| BlockToStepN              | 100.873 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
E20240130 21:32:26.865044 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=69
W20240130 21:32:27.089236 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240130 21:32:27.347600 209715 grad_async_v2.h:256] pq is empty
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
E20240130 21:32:27.865129 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:28.099434 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end8
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
W20240130 21:32:28.859696 209715 grad_async_v2.h:256] pq is empty
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
E20240130 21:32:28.869335 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:29.127327 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end0
W20240130 21:32:29.398296 209715 grad_async_v2.h:256] pq is empty
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240130 21:32:29.869060 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:32:29.925318 209715 grad_async_v2.h:256] pq is empty
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240130 21:32:30.316959 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.971 us                | 258.448 us                |
| GenInput                  | 36.094 ms                 | 46.080 ms                 |
| NN                        | 598.772 us                | 4.624 ms                  |
| Forward                   | 889.512 us                | 6.421 ms                  |
| Backward                  | 1.917 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 221.526 us                | 4.492 ms                  |
| AfterBackward             | 260.002 ms                | 1.331 s                   |
| BlockToStepN              | 195.696 us                | 3.419 ms                  |
| OneStep                   | 303.160 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
E20240130 21:32:30.869117 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:31.414161 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 114.573 us                | 11.707 ms                 |
| ProcessBack:Shuffle       | 259.041 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.169 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.559 us                 | 86.286 us                 |
| ProcessOneStep            | 277.068 ms                | 1.331 s                   |
| BlockToStepN              | 114.571 us                | 3.357 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:31.869460 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
W20240130 21:32:32.416639 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
E20240130 21:32:32.869241 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:32.908464 209715 grad_async_v2.h:256] pq is empty
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
W20240130 21:32:33.517230 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240130 21:32:33.869153 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:32:34.005162 209715 grad_async_v2.h:256] pq is empty
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
W20240130 21:32:34.507587 209715 grad_async_v2.h:256] pq is empty
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
W20240130 21:32:34.519248 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
E20240130 21:32:34.869082 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 161.971 us                | 263.333 us                |
| GenInput                  | 36.094 ms                 | 51.682 ms                 |
| NN                        | 603.899 us                | 4.624 ms                  |
| Forward                   | 895.230 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 306.883 us                | 4.492 ms                  |
| AfterBackward             | 285.492 ms                | 1.331 s                   |
| BlockToStepN              | 207.617 us                | 3.419 ms                  |
| OneStep                   | 325.248 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
W20240130 21:32:35.639099 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
E20240130 21:32:35.869077 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=14
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 136.803 us                | 15.844 ms                 |
| ProcessBack:Shuffle       | 245.652 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 259.960 ms                | 1.331 s                   |
| BlockToStepN              | 120.024 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:36.785697 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end9
E20240130 21:32:36.869122 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
E20240130 21:32:37.869159 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
W20240130 21:32:38.483968 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end1
W20240130 21:32:38.524556 209715 grad_async_v2.h:256] pq is empty
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
E20240130 21:32:38.869016 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
E20240130 21:32:39.869025 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
W20240130 21:32:40.107018 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end6
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.151 us                | 263.333 us                |
| GenInput                  | 36.027 ms                 | 51.682 ms                 |
| NN                        | 598.193 us                | 4.624 ms                  |
| Forward                   | 885.046 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 211.266 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 221.526 us                | 4.492 ms                  |
| AfterBackward             | 245.087 ms                | 1.331 s                   |
| BlockToStepN              | 219.825 us                | 4.706 ms                  |
| OneStep                   | 280.847 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
E20240130 21:32:40.869171 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:41.162906 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end1
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 109.372 us                | 219.951 us                |
| ProcessBack:Shuffle       | 223.785 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 245.061 ms                | 1.331 s                   |
| BlockToStepN              | 130.411 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:41.869071 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:42.347841 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
W20240130 21:32:42.523243 209715 grad_async_v2.h:256] pq is empty
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
E20240130 21:32:42.869069 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
W20240130 21:32:43.361377 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end5
E20240130 21:32:43.869048 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:44.084669 209715 grad_async_v2.h:256] pq is empty
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
W20240130 21:32:44.444093 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end6
W20240130 21:32:44.581440 209715 grad_async_v2.h:256] pq is empty
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
E20240130 21:32:44.869057 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.527 us                | 264.933 us                |
| GenInput                  | 35.924 ms                 | 51.682 ms                 |
| NN                        | 598.636 us                | 4.624 ms                  |
| Forward                   | 889.512 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 212.100 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 112.726 us                | 4.492 ms                  |
| AfterBackward             | 250.350 ms                | 1.331 s                   |
| BlockToStepN              | 224.874 us                | 5.433 ms                  |
| OneStep                   | 289.600 ms                | 1.378 s                   |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:45.649093 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
E20240130 21:32:45.869244 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 132.905 us                | 4.367 ms                  |
| ProcessBack:Shuffle       | 230.402 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 57.737 us                 | 107.479 us                |
| ProcessOneStep            | 250.324 ms                | 1.331 s                   |
| BlockToStepN              | 133.924 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:32:46.532948 209715 grad_async_v2.h:256] pq is empty
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
Step99:rank2, time: 60.010, per_step: 0.600104
Step99:rank1, time: 60.010, per_step: 0.600102
Step99:rank0, time: 60.010, per_step: 0.600105
Step99:rank3, time: 60.010, per_step: 0.600103
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.527 us                | 264.933 us                |
| GenInput                  | 35.643 ms                 | 51.682 ms                 |
| NN                        | 598.636 us                | 4.624 ms                  |
| Forward                   | 889.512 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 212.100 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 110.137 us                | 4.492 ms                  |
| AfterBackward             | 250.350 ms                | 1.331 s                   |
| BlockToStepN              | 230.998 us                | 5.433 ms                  |
| OneStep                   | 303.160 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 100 ========== 
W20240130 21:32:46.663648 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
E20240130 21:32:46.869300 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240130 21:32:47.869092 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:47.989427 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end3
W20240130 21:32:48.619036 209715 grad_async_v2.h:256] pq is empty
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
E20240130 21:32:48.869104 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:49.221302 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end5
W20240130 21:32:49.594219 209715 grad_async_v2.h:256] pq is empty
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
E20240130 21:32:49.869251 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:50.086123 209715 grad_async_v2.h:256] pq is empty
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
W20240130 21:32:50.241995 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.151 us                | 264.933 us                |
| GenInput                  | 35.333 ms                 | 51.682 ms                 |
| NN                        | 598.636 us                | 4.624 ms                  |
| Forward                   | 889.512 us                | 6.421 ms                  |
| Backward                  | 1.922 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 112.726 us                | 4.492 ms                  |
| AfterBackward             | 260.002 ms                | 1.331 s                   |
| BlockToStepN              | 240.938 us                | 5.433 ms                  |
| OneStep                   | 303.160 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
E20240130 21:32:50.869832 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:51.431916 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 112.541 us                | 587.451 us                |
| ProcessBack:Shuffle       | 241.779 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 57.737 us                 | 128.614 us                |
| ProcessOneStep            | 259.960 ms                | 1.331 s                   |
| BlockToStepN              | 147.787 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
E20240130 21:32:51.869072 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:32:52.182971 209715 grad_async_v2.h:256] pq is empty
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
W20240130 21:32:52.422165 209715 grad_async_v2.h:256] pq is empty
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
W20240130 21:32:52.490789 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end4
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
E20240130 21:32:52.869060 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
W20240130 21:32:53.567466 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end5
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
E20240130 21:32:53.869442 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
E20240130 21:32:54.869103 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240130 21:32:55.165043 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end9
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 162.730 us                | 264.933 us                |
| GenInput                  | 35.945 ms                 | 51.682 ms                 |
| NN                        | 598.772 us                | 4.624 ms                  |
| Forward                   | 898.001 us                | 6.421 ms                  |
| Backward                  | 1.941 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 101.250 us                | 4.492 ms                  |
| AfterBackward             | 260.002 ms                | 1.331 s                   |
| BlockToStepN              | 255.937 us                | 5.433 ms                  |
| OneStep                   | 303.160 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:32:55.869047 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
W20240130 21:32:56.449082 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 118.886 us                | 5.889 ms                  |
| ProcessBack:Shuffle       | 241.779 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 57.737 us                 | 128.614 us                |
| ProcessOneStep            | 259.960 ms                | 1.331 s                   |
| BlockToStepN              | 154.183 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
E20240130 21:32:56.869618 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=47
W20240130 21:32:57.618333 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end2
E20240130 21:32:57.869350 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
W20240130 21:32:58.715503 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 21:32:58.867688 209715 grad_async_v2.h:256] pq is empty
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
E20240130 21:32:58.875022 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240130 21:32:59.364383 209715 grad_async_v2.h:256] pq is empty
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
W20240130 21:32:59.831818 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
E20240130 21:32:59.875800 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 163.744 us                | 264.933 us                |
| GenInput                  | 35.945 ms                 | 51.682 ms                 |
| NN                        | 603.899 us                | 4.624 ms                  |
| Forward                   | 908.123 us                | 6.421 ms                  |
| Backward                  | 1.945 ms                  | 11.807 ms                 |
| Optimize                  | 216.044 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 112.726 us                | 4.492 ms                  |
| AfterBackward             | 284.812 ms                | 1.366 s                   |
| BlockToStepN              | 261.136 us                | 5.433 ms                  |
| OneStep                   | 325.248 ms                | 1.405 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
E20240130 21:33:00.875252 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:01.283208 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 96.911 us                 | 4.666 ms                  |
| ProcessBack:Shuffle       | 259.041 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.170 us                 | 128.614 us                |
| ProcessOneStep            | 284.776 ms                | 1.366 s                   |
| BlockToStepN              | 170.085 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:33:01.875108 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
W20240130 21:33:02.383136 210657 grad_async_v2.h:139] Detect new sample comes, old_end0, new_end1
W20240130 21:33:02.743494 209715 grad_async_v2.h:256] pq is empty
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
E20240130 21:33:02.875178 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:03.221974 209715 grad_async_v2.h:256] pq is empty
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
W20240130 21:33:03.497695 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
E20240130 21:33:03.875013 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
W20240130 21:33:04.590409 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end6
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
E20240130 21:33:04.875025 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=33
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.198 us                | 5.969 ms                  |
| GenInput                  | 35.333 ms                 | 51.682 ms                 |
| NN                        | 603.899 us                | 4.624 ms                  |
| Forward                   | 908.123 us                | 6.421 ms                  |
| Backward                  | 1.956 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 97.246 us                 | 4.492 ms                  |
| AfterBackward             | 285.175 ms                | 1.366 s                   |
| BlockToStepN              | 266.612 us                | 5.433 ms                  |
| OneStep                   | 327.579 ms                | 1.405 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
W20240130 21:33:05.822202 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end9
E20240130 21:33:05.875120 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 106.144 us                | 12.814 ms                 |
| ProcessBack:Shuffle       | 279.211 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 128.614 us                |
| ProcessOneStep            | 285.466 ms                | 1.366 s                   |
| BlockToStepN              | 178.137 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
E20240130 21:33:06.875140 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:06.952148 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
E20240130 21:33:07.875034 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
W20240130 21:33:08.453126 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end4
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240130 21:33:08.875159 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:09.521629 210657 grad_async_v2.h:139] Detect new sample comes, old_end4, new_end5
W20240130 21:33:09.664395 209715 grad_async_v2.h:256] pq is empty
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
E20240130 21:33:09.875339 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.485 us                | 5.969 ms                  |
| GenInput                  | 35.333 ms                 | 51.682 ms                 |
| NN                        | 619.604 us                | 4.624 ms                  |
| Forward                   | 918.049 us                | 6.421 ms                  |
| Backward                  | 1.958 ms                  | 11.807 ms                 |
| Optimize                  | 213.922 us                | 692.616 us                |
| BarrierTimeBeforeRank0    | 94.561 us                 | 4.492 ms                  |
| AfterBackward             | 285.175 ms                | 1.366 s                   |
| BlockToStepN              | 278.179 us                | 5.433 ms                  |
| OneStep                   | 326.976 ms                | 1.405 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240130 21:33:10.746599 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end0
E20240130 21:33:10.875356 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=4
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 84.657 us                 | 11.534 ms                 |
| ProcessBack:Shuffle       | 275.954 ms                | 1.323 s                   |
| ProcessBack:UpdateCache   | 1.347 ms                  | 19.261 ms                 |
| ProcessBack:UpsertPq      | 57.737 us                 | 128.614 us                |
| ProcessOneStep            | 285.085 ms                | 1.366 s                   |
| BlockToStepN              | 189.314 us                | 5.328 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240130 21:33:11.875064 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240130 21:33:12.208235 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end1
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
E20240130 21:33:12.875108 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:13.091265 209715 grad_async_v2.h:256] pq is empty
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
W20240130 21:33:13.209002 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end3
W20240130 21:33:13.662954 209715 grad_async_v2.h:256] pq is empty
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
E20240130 21:33:13.875082 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=59
W20240130 21:33:14.402382 210657 grad_async_v2.h:139] Detect new sample comes, old_end3, new_end6
E20240130 21:33:14.875165 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:15.185740 209715 grad_async_v2.h:256] pq is empty
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
W20240130 21:33:15.433267 210657 grad_async_v2.h:139] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.441 us                | 4.346 ms                  |
| GenInput                  | 35.284 ms                 | 46.713 ms                 |
| NN                        | 620.935 us                | 1.846 ms                  |
| Forward                   | 918.654 us                | 6.177 ms                  |
| Backward                  | 1.941 ms                  | 6.700 ms                  |
| Optimize                  | 213.922 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 101.250 us                | 4.492 ms                  |
| AfterBackward             | 285.492 ms                | 1.331 s                   |
| BlockToStepN              | 284.356 us                | 4.706 ms                  |
| OneStep                   | 327.579 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:15.710600 209715 grad_async_v2.h:256] pq is empty
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
E20240130 21:33:15.875244 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:16.249895 209715 grad_async_v2.h:256] pq is empty
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 105.275 us                | 5.951 ms                  |
| ProcessBack:Shuffle       | 282.573 ms                | 1.318 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 288.098 ms                | 1.331 s                   |
| BlockToStepN              | 209.678 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:16.604100 210657 grad_async_v2.h:139] Detect new sample comes, old_end8, new_end0
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
E20240130 21:33:16.875119 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=59
W20240130 21:33:17.977339 209715 grad_async_v2.h:256] pq is empty
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240130 21:33:17.990366 210657 grad_async_v2.h:139] Detect new sample comes, old_end1, new_end2
E20240130 21:33:17.997385 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
E20240130 21:33:18.997668 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240130 21:33:19.227147 210657 grad_async_v2.h:139] Detect new sample comes, old_end2, new_end4
W20240130 21:33:19.497786 209715 grad_async_v2.h:256] pq is empty
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240130 21:33:19.986498 209715 grad_async_v2.h:256] pq is empty
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
E20240130 21:33:19.997229 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
W20240130 21:33:20.244483 210657 grad_async_v2.h:139] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 166.198 us                | 4.346 ms                  |
| GenInput                  | 35.282 ms                 | 46.713 ms                 |
| NN                        | 620.935 us                | 1.846 ms                  |
| Forward                   | 918.654 us                | 6.177 ms                  |
| Backward                  | 1.934 ms                  | 6.700 ms                  |
| Optimize                  | 213.922 us                | 560.148 us                |
| BarrierTimeBeforeRank0    | 110.137 us                | 4.492 ms                  |
| AfterBackward             | 285.492 ms                | 1.331 s                   |
| BlockToStepN              | 293.725 us                | 4.706 ms                  |
| OneStep                   | 327.579 ms                | 1.378 s                   |
| E2E-100                   | 48.146 s                  | 48.146 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
E20240130 21:33:20.997270 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240130 21:33:21.452551 210657 grad_async_v2.h:139] Detect new sample comes, old_end7, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 107.915 us                | 5.443 ms                  |
| ProcessBack:Shuffle       | 279.211 ms                | 1.322 s                   |
| ProcessBack:UpdateCache   | 1.334 ms                  | 16.378 ms                 |
| ProcessBack:UpsertPq      | 58.254 us                 | 107.479 us                |
| ProcessOneStep            | 285.466 ms                | 1.331 s                   |
| BlockToStepN              | 215.351 us                | 4.642 ms                  |
+---------------------------+---------------------------+---------------------------+
W20240130 21:33:21.979282 209715 grad_async_v2.h:256] pq is empty
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
E20240130 21:33:21.997045 210657 parallel_pq_v2.h:76] insert failed, size(hashtable)=30
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
W20240130 21:33:22.742107 210657 grad_async_v2.h:139] Detect new sample comes, old_end9, new_end3
