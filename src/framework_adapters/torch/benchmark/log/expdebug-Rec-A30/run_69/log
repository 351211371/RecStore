WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 01:51:56.012939 3944957 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240128 01:51:56.014964 3944957 IPCTensor.h:368] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:151: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [3944957 perf_rec_model.py:151] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f73c6d20fe0>==========
Worker 1 pid=3945102
Worker 2 pid=3945104
INFO [3945102 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3944957 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3945104 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [3945104 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240128 01:51:59.440883 3945104 IPCTensor.h:347] IPCTensor full_emb already exists
INFO [3945106 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [3945102 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [3945106 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240128 01:51:59.441972 3945102 IPCTensor.h:347] IPCTensor full_emb already exists
INFO [3944957 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240128 01:51:59.442346 3944957 IPCTensor.h:347] IPCTensor full_emb already exists
E20240128 01:51:59.442575 3945106 IPCTensor.h:347] IPCTensor full_emb already exists
W20240128 01:51:59.445919 3944957 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_0 [3376257, 32]; dev=0; size=412.1 MB
W20240128 01:51:59.445945 3945102 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_1 [3376257, 32]; dev=1; size=412.1 MB
W20240128 01:51:59.447300 3945102 IPCTensor.h:368] NewIPCTensor: input_keys_1 [1000000]0x100101970000 7.629 MB
W20240128 01:51:59.447378 3944957 IPCTensor.h:368] NewIPCTensor: input_keys_0 [1000000]0x100102113000 7.629 MB
W20240128 01:51:59.447422 3945102 IPCTensor.h:368] NewIPCTensor: input_keys_neg_1 [1000000]0x1001028b6000 7.629 MB
W20240128 01:51:59.447460 3944957 IPCTensor.h:368] NewIPCTensor: input_keys_neg_0 [1000000]0x100103059000 7.629 MB
W20240128 01:51:59.447471 3945102 IPCTensor.h:368] NewIPCTensor: backward_grads_1 [1000000, 32]0x1001037fc000 122.1 MB
W20240128 01:51:59.447494 3944957 IPCTensor.h:368] NewIPCTensor: backward_grads_0 [1000000, 32]0x10010b210000 122.1 MB
W20240128 01:51:59.447505 3945102 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100112c24000 122.1 MB
W20240128 01:51:59.447522 3944957 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10011a638000 122.1 MB
W20240128 01:51:59.447537 3945102 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240128 01:51:59.447561 3944957 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240128 01:51:59.447541 3945104 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_2 [3376257, 32]; dev=2; size=412.1 MB
W20240128 01:51:59.448426 3945106 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_3 [3376257, 32]; dev=3; size=412.1 MB
W20240128 01:51:59.450345 3945102 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240128 01:51:59.450443 3944957 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240128 01:51:59.450742 3945104 IPCTensor.h:368] NewIPCTensor: input_keys_2 [1000000]0x100122052000 7.629 MB
W20240128 01:51:59.450909 3945104 IPCTensor.h:368] NewIPCTensor: input_keys_neg_2 [1000000]0x1001227fb000 7.629 MB
W20240128 01:51:59.450999 3945104 IPCTensor.h:368] NewIPCTensor: backward_grads_2 [1000000, 32]0x100123741000 122.1 MB
W20240128 01:51:59.450982 3945106 IPCTensor.h:368] NewIPCTensor: input_keys_3 [1000000]0x100122f9e000 7.629 MB
W20240128 01:51:59.451084 3945104 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10012b155000 122.1 MB
W20240128 01:51:59.451159 3945104 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240128 01:51:59.451221 3945106 IPCTensor.h:368] NewIPCTensor: input_keys_neg_3 [1000000]0x100132b69000 7.629 MB
W20240128 01:51:59.451318 3945106 IPCTensor.h:368] NewIPCTensor: backward_grads_3 [1000000, 32]0x10013330c000 122.1 MB
W20240128 01:51:59.451396 3945106 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10013ad20000 122.1 MB
W20240128 01:51:59.451478 3945106 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240128 01:51:59.452322 3945104 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240128 01:51:59.452380 3945106 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
Worker 3 pid=3945106
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 3376257), (3376257, 6752514), (6752514, 10128771), (10128771, 13505028)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
W20240128 01:52:05.306109 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10014273c000 7.629 MB
W20240128 01:52:05.306253 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100142edf000 7.629 MB
W20240128 01:52:05.306283 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100143682000 7.629 MB
W20240128 01:52:05.306305 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100143e25000 7.629 MB
W20240128 01:52:05.306330 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1001445c8000 7.629 MB
W20240128 01:52:05.306355 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x100144d6b000 7.629 MB
W20240128 01:52:05.306412 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10014550e000 7.629 MB
W20240128 01:52:05.306444 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100145cb1000 7.629 MB
W20240128 01:52:05.306468 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x100146454000 7.629 MB
W20240128 01:52:05.306485 3945104 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x100146bf7000 7.629 MB
W20240128 01:52:05.306509 3945104 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10014739a000 80 B 
W20240128 01:52:05.306531 3945104 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10014739c000 8 B 
W20240128 01:52:05.306546 3945104 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10014739e000 8 B 
W20240128 01:52:05.306557 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1001473a0000 7.629 MB
W20240128 01:52:05.306661 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100147b43000 7.629 MB
W20240128 01:52:05.306694 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1001482e6000 7.629 MB
W20240128 01:52:05.306716 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100148a89000 7.629 MB
W20240128 01:52:05.306738 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10014922c000 7.629 MB
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
W20240128 01:52:05.306761 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1001499cf000 7.629 MB
W20240128 01:52:05.306783 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10014a172000 7.629 MB
I20240128 01:52:05.306815 3945104 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240128 01:52:05.306830 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x10014a915000 7.629 MB
W20240128 01:52:05.306852 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10014b0b8000 7.629 MB
W20240128 01:52:05.306869 3945102 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10014b85b000 7.629 MB
W20240128 01:52:05.306893 3945102 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x10014bffe000 80 B 
W20240128 01:52:05.306913 3945102 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x10014c000000 8 B 
W20240128 01:52:05.306928 3945102 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10014c002000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240128 01:52:05.307114 3945102 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240128 01:52:05.643640 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10014c004000 7.629 MB
W20240128 01:52:05.643811 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10014c7a7000 7.629 MB
W20240128 01:52:05.643851 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10014cf4a000 7.629 MB
W20240128 01:52:05.643872 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10014d6ed000 7.629 MB
W20240128 01:52:05.643894 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x10014de90000 7.629 MB
W20240128 01:52:05.643918 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x10014e633000 7.629 MB
W20240128 01:52:05.643939 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x10014edd6000 7.629 MB
W20240128 01:52:05.643973 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x10014f579000 7.629 MB
W20240128 01:52:05.643997 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x10014fd1c000 7.629 MB
W20240128 01:52:05.644016 3945106 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1001504bf000 7.629 MB
W20240128 01:52:05.644042 3945106 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x100150c62000 80 B 
W20240128 01:52:05.644066 3945106 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x100150c64000 8 B 
W20240128 01:52:05.644088 3945106 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100150c66000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240128 01:52:05.644342 3945106 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240128 01:52:06.157394 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100150c68000 7.629 MB
W20240128 01:52:06.157521 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10015140b000 7.629 MB
W20240128 01:52:06.157541 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100151bae000 7.629 MB
W20240128 01:52:06.157563 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100152351000 7.629 MB
W20240128 01:52:06.157586 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100152af4000 7.629 MB
W20240128 01:52:06.157611 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100153297000 7.629 MB
W20240128 01:52:06.157634 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100153a3a000 7.629 MB
W20240128 01:52:06.157663 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1001541dd000 7.629 MB
W20240128 01:52:06.157680 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100154980000 7.629 MB
W20240128 01:52:06.157701 3944957 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x100155123000 7.629 MB
W20240128 01:52:06.157723 3944957 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x1001558c6000 80 B 
W20240128 01:52:06.157755 3944957 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x1001558c8000 8 B 
W20240128 01:52:06.157778 3944957 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1001558ca000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240128 01:52:06.158007 3944957 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240128 01:52:06.159209 3944957 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240128 01:52:06.159286 3944957 grad_base.h:184] Init GradProcessingBase done
I20240128 01:52:08.317818 3944957 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=16
W20240128 01:52:08.317930 3944957 kg_controller.h:78] after init GradAsyncProcessingV2
I20240128 01:52:08.317934 3944957 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240128 01:52:08.632385 3944957 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240128 01:52:09.706512 3945518 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240128 01:52:09.707027 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240128 01:52:10.707011 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=3
W20240128 01:52:10.726552 3945518 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
Before Training
Before Training
I20240128 01:52:12.125468 3945102 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240128 01:52:12.125501 3944957 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240128 01:52:12.125936 3945106 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240128 01:52:12.126435 3945104 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
W20240128 01:52:12.127705 3945518 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240128 01:52:12.127766 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240128 01:52:13.469300 3945172 parallel_pq_v2.h:76] insert failed, size(hashtable)=9
W20240128 01:52:13.497645 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=0
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240128 01:52:13.575752 3945518 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
INFO [3945106 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3945104 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3945102 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3944957 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 205.545 ms                | 205.545 ms                |
| ProcessBack:UpdateCache   | 761.526 ms                | 761.526 ms                |
| ProcessBack:UpsertPq      | 27.757 ms                 | 27.757 ms                 |
| ProcessOneStep            | 1.101 s                   | 1.101 s                   |
| BlockToStepN              | 77.006 ms                 | 77.006 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240128 01:52:14.470338 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=613
W20240128 01:52:14.497006 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=2, pq.top=2
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
W20240128 01:52:14.580379 3945518 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
E20240128 01:52:15.476469 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=35198
W20240128 01:52:15.497005 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=11, pq.top=11
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
W20240128 01:52:15.628010 3945518 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 91.647 us                 | 154.325 us                |
| GenInput                  | 399.512 us                | 862.957 us                |
| NN                        | 485.786 us                | 123.085 ms                |
| Forward                   | 654.539 us                | 124.064 ms                |
| Backward                  | 1.936 ms                  | 854.163 ms                |
| Optimize                  | 157.662 us                | 7.872 ms                  |
| BarrierTimeBeforeRank0    | 462.178 us                | 21.471 ms                 |
| AfterBackward             | 25.202 ms                 | 1.102 s                   |
| BlockToStepN              | 82.171 ms                 | 92.066 ms                 |
| OneStep                   | 111.317 ms                | 1.448 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
E20240128 01:52:16.476011 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=451
W20240128 01:52:16.497005 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=20, pq.top=19
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
W20240128 01:52:16.681563 3945518 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
E20240128 01:52:17.478717 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=80179
W20240128 01:52:17.497018 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=28, pq.top=27
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240128 01:52:17.687659 3945518 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
E20240128 01:52:18.479018 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=97418
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
W20240128 01:52:18.507462 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=36, pq.top=35
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.349 ms                  | 205.545 ms                |
| ProcessBack:UpdateCache   | 1.038 ms                  | 761.526 ms                |
| ProcessBack:UpsertPq      | 21.506 ms                 | 27.757 ms                 |
| ProcessOneStep            | 25.054 ms                 | 1.101 s                   |
| BlockToStepN              | 89.434 ms                 | 122.403 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
W20240128 01:52:18.740713 3945518 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
E20240128 01:52:19.479012 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=1279
W20240128 01:52:19.507020 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=44, pq.top=43
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
W20240128 01:52:19.774974 3945518 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
E20240128 01:52:20.479008 3944957 parallel_pq_v2.h:76] insert failed, size(hashtable)=1291
W20240128 01:52:20.507012 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=53, pq.top=52
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
W20240128 01:52:20.812361 3945518 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 89.729 us                 | 120.499 us                |
| GenInput                  | 403.181 us                | 575.934 us                |
| NN                        | 432.038 us                | 1.511 ms                  |
| Forward                   | 594.823 us                | 1.790 ms                  |
| Backward                  | 1.763 ms                  | 113.355 ms                |
| Optimize                  | 160.388 us                | 523.553 us                |
| BarrierTimeBeforeRank0    | 383.980 us                | 1.170 ms                  |
| AfterBackward             | 22.389 ms                 | 29.138 ms                 |
| BlockToStepN              | 93.169 ms                 | 108.399 ms                |
| OneStep                   | 115.488 ms                | 959.950 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240128 01:52:21.481161 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=152798
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240128 01:52:21.516091 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=62, pq.top=61
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240128 01:52:21.836925 3945518 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
E20240128 01:52:22.483736 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=170160
W20240128 01:52:22.516052 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=70, pq.top=70
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
W20240128 01:52:22.875442 3945518 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
E20240128 01:52:23.483008 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=786
W20240128 01:52:23.516045 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=79, pq.top=78
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.313 ms                  | 3.161 ms                  |
| ProcessBack:UpdateCache   | 949.419 us                | 1.467 ms                  |
| ProcessBack:UpsertPq      | 15.964 ms                 | 25.623 ms                 |
| ProcessOneStep            | 19.306 ms                 | 29.120 ms                 |
| BlockToStepN              | 93.652 ms                 | 108.364 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
W20240128 01:52:23.909104 3945518 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
E20240128 01:52:24.484333 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=202378
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
W20240128 01:52:24.536285 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=88, pq.top=87
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
W20240128 01:52:24.914399 3945518 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
E20240128 01:52:25.486122 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=214757
W20240128 01:52:25.536083 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=95, pq.top=94
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
W20240128 01:52:25.929108 3945518 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 90.577 us                 | 154.325 us                |
| GenInput                  | 414.719 us                | 856.138 us                |
| NN                        | 432.706 us                | 1.511 ms                  |
| Forward                   | 602.461 us                | 1.790 ms                  |
| Backward                  | 1.763 ms                  | 113.355 ms                |
| Optimize                  | 157.662 us                | 523.553 us                |
| BarrierTimeBeforeRank0    | 252.987 us                | 1.170 ms                  |
| AfterBackward             | 19.473 ms                 | 29.138 ms                 |
| BlockToStepN              | 95.384 ms                 | 118.083 ms                |
| OneStep                   | 115.612 ms                | 959.950 ms                |
+---------------------------+---------------------------+---------------------------+
Step99:rank3, time: 25.485, per_step: 0.254849
Step99:rank2, time: 25.485, per_step: 0.254850
Step99:rank0, time: 25.485, per_step: 0.254849
Step99:rank1, time: 25.485, per_step: 0.254850
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240128 01:52:26.486019 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=229625
W20240128 01:52:26.536141 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=103, pq.top=102
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
W20240128 01:52:26.931488 3945518 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
E20240128 01:52:27.486017 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=1132
W20240128 01:52:27.536126 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=111, pq.top=110
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
W20240128 01:52:27.933192 3945518 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
E20240128 01:52:28.486009 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=1584
W20240128 01:52:28.536139 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=119, pq.top=118
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.326 ms                  | 3.161 ms                  |
| ProcessBack:UpdateCache   | 996.471 us                | 1.467 ms                  |
| ProcessBack:UpsertPq      | 17.685 ms                 | 25.651 ms                 |
| ProcessOneStep            | 21.209 ms                 | 29.523 ms                 |
| BlockToStepN              | 94.454 ms                 | 118.028 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
W20240128 01:52:28.943670 3945518 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
E20240128 01:52:29.487748 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=273482
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240128 01:52:29.562784 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=128, pq.top=127
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
W20240128 01:52:29.996788 3945518 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
E20240128 01:52:30.487051 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=813
W20240128 01:52:30.562096 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=136, pq.top=135
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
W20240128 01:52:31.022202 3945518 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 89.998 us                 | 154.325 us                |
| GenInput                  | 425.719 us                | 862.957 us                |
| NN                        | 439.959 us                | 1.511 ms                  |
| Forward                   | 615.280 us                | 1.790 ms                  |
| Backward                  | 1.980 ms                  | 113.355 ms                |
| Optimize                  | 161.577 us                | 523.553 us                |
| BarrierTimeBeforeRank0    | 73.063 us                 | 1.170 ms                  |
| AfterBackward             | 20.541 ms                 | 29.565 ms                 |
| BlockToStepN              | 94.457 ms                 | 118.083 ms                |
| OneStep                   | 116.957 ms                | 959.950 ms                |
| E2E-100                   | 14.063 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
E20240128 01:52:31.487012 3945181 parallel_pq_v2.h:76] insert failed, size(hashtable)=545
W20240128 01:52:31.562178 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=145, pq.top=144
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
W20240128 01:52:32.053483 3945518 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
E20240128 01:52:32.487116 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=317747
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
W20240128 01:52:32.562081 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=154, pq.top=153
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
W20240128 01:52:33.099470 3945518 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
E20240128 01:52:33.487018 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=332617
W20240128 01:52:33.562040 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=162, pq.top=162
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.331 ms                  | 3.773 ms                  |
| ProcessBack:UpdateCache   | 927.044 us                | 1.425 ms                  |
| ProcessBack:UpsertPq      | 16.228 ms                 | 25.647 ms                 |
| ProcessOneStep            | 19.781 ms                 | 29.416 ms                 |
| BlockToStepN              | 94.679 ms                 | 117.995 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
W20240128 01:52:34.154106 3945518 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
E20240128 01:52:34.488616 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=346058
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
W20240128 01:52:34.562170 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=171, pq.top=170
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
W20240128 01:52:35.205780 3945518 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
E20240128 01:52:35.488088 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=361335
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
W20240128 01:52:35.582383 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=180, pq.top=179
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 91.624 us                 | 131.062 us                |
| GenInput                  | 431.109 us                | 902.594 us                |
| NN                        | 441.604 us                | 900.181 us                |
| Forward                   | 619.363 us                | 1.386 ms                  |
| Backward                  | 1.849 ms                  | 7.433 ms                  |
| Optimize                  | 161.677 us                | 393.764 us                |
| BarrierTimeBeforeRank0    | 237.763 us                | 1.191 ms                  |
| AfterBackward             | 19.415 ms                 | 29.435 ms                 |
| BlockToStepN              | 95.036 ms                 | 118.065 ms                |
| OneStep                   | 116.752 ms                | 151.654 ms                |
| E2E-100                   | 14.063 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
W20240128 01:52:36.208670 3945518 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
E20240128 01:52:36.488032 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=373968
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
W20240128 01:52:36.582099 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=188, pq.top=187
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240128 01:52:37.208843 3945518 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
E20240128 01:52:37.488025 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=388534
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
W20240128 01:52:37.587239 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=197, pq.top=197
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
Step199:rank1, time: 11.850, per_step: 0.117329
Step199:rank0, time: 11.850, per_step: 0.117329
Step199:rank2, time: 11.850, per_step: 0.117330
Step199:rank3, time: 11.850, per_step: 0.117330
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
W20240128 01:52:38.213986 3945518 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
E20240128 01:52:38.493582 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=400883
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
W20240128 01:52:38.587046 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=205, pq.top=204
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.318 ms                  | 3.773 ms                  |
| ProcessBack:UpdateCache   | 889.328 us                | 1.467 ms                  |
| ProcessBack:UpsertPq      | 15.304 ms                 | 25.647 ms                 |
| ProcessOneStep            | 19.094 ms                 | 29.416 ms                 |
| BlockToStepN              | 95.486 ms                 | 117.995 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
W20240128 01:52:39.244782 3945518 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
E20240128 01:52:39.493007 3944957 parallel_pq_v2.h:76] insert failed, size(hashtable)=1245
W20240128 01:52:39.587270 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=213, pq.top=212
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
W20240128 01:52:40.308173 3945518 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
E20240128 01:52:40.494693 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=427711
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
W20240128 01:52:40.587311 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=222, pq.top=221
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 91.922 us                 | 131.062 us                |
| GenInput                  | 432.487 us                | 937.713 us                |
| NN                        | 440.482 us                | 900.181 us                |
| Forward                   | 618.558 us                | 1.386 ms                  |
| Backward                  | 1.749 ms                  | 7.433 ms                  |
| Optimize                  | 162.073 us                | 393.764 us                |
| BarrierTimeBeforeRank0    | 367.393 us                | 1.191 ms                  |
| AfterBackward             | 19.202 ms                 | 29.435 ms                 |
| BlockToStepN              | 95.468 ms                 | 118.065 ms                |
| OneStep                   | 117.315 ms                | 151.654 ms                |
| E2E-100                   | 11.850 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
W20240128 01:52:41.376613 3945518 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
E20240128 01:52:41.494007 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=442537
W20240128 01:52:41.587294 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=230, pq.top=230
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
W20240128 01:52:42.433624 3945518 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240128 01:52:42.494015 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=454730
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
W20240128 01:52:42.587208 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=239, pq.top=239
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
E20240128 01:52:43.494009 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=468807
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
W20240128 01:52:43.495983 3945518 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240128 01:52:43.587015 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=247, pq.top=247
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.310 ms                  | 3.773 ms                  |
| ProcessBack:UpdateCache   | 876.460 us                | 1.467 ms                  |
| ProcessBack:UpsertPq      | 15.119 ms                 | 25.647 ms                 |
| ProcessOneStep            | 18.622 ms                 | 29.416 ms                 |
| BlockToStepN              | 96.008 ms                 | 117.995 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
E20240128 01:52:44.494035 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=480867
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
W20240128 01:52:44.558156 3945518 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240128 01:52:44.587069 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=256, pq.top=256
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
E20240128 01:52:45.495795 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=493192
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
W20240128 01:52:45.559280 3945518 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240128 01:52:45.587234 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=264, pq.top=263
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 91.656 us                 | 128.017 us                |
| GenInput                  | 432.898 us                | 902.594 us                |
| NN                        | 440.482 us                | 858.366 us                |
| Forward                   | 618.677 us                | 1.229 ms                  |
| Backward                  | 1.702 ms                  | 3.782 ms                  |
| Optimize                  | 161.642 us                | 317.225 us                |
| BarrierTimeBeforeRank0    | 573.734 us                | 1.170 ms                  |
| AfterBackward             | 18.583 ms                 | 29.431 ms                 |
| BlockToStepN              | 96.262 ms                 | 109.710 ms                |
| OneStep                   | 117.482 ms                | 142.625 ms                |
| E2E-100                   | 11.850 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
E20240128 01:52:46.495023 3945172 parallel_pq_v2.h:76] insert failed, size(hashtable)=94
W20240128 01:52:46.587157 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=272, pq.top=271
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
W20240128 01:52:46.605368 3945518 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
E20240128 01:52:47.495043 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=518626
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
W20240128 01:52:47.587220 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=280
W20240128 01:52:47.614907 3945518 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
E20240128 01:52:48.495265 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=532324
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
W20240128 01:52:48.587134 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=289, pq.top=288
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.307 ms                  | 3.687 ms                  |
| ProcessBack:UpdateCache   | 893.860 us                | 1.425 ms                  |
| ProcessBack:UpsertPq      | 15.397 ms                 | 25.623 ms                 |
| ProcessOneStep            | 18.908 ms                 | 29.411 ms                 |
| BlockToStepN              | 96.496 ms                 | 109.613 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
W20240128 01:52:48.661384 3945518 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
E20240128 01:52:49.495085 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=544185
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
W20240128 01:52:49.587136 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=297, pq.top=297
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
W20240128 01:52:49.662977 3945518 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
Step299:rank3, time: 11.972, per_step: 0.118537
Step299:rank1, time: 11.972, per_step: 0.118538
Step299:rank0, time: 11.972, per_step: 0.118538
Step299:rank2, time: 11.972, per_step: 0.118538
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
E20240128 01:52:50.495721 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=556152
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
W20240128 01:52:50.587386 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=305, pq.top=304
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
W20240128 01:52:50.669044 3945518 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 91.624 us                 | 128.017 us                |
| GenInput                  | 433.315 us                | 902.594 us                |
| NN                        | 440.916 us                | 858.366 us                |
| Forward                   | 619.254 us                | 1.285 ms                  |
| Backward                  | 1.651 ms                  | 3.782 ms                  |
| Optimize                  | 161.578 us                | 317.225 us                |
| BarrierTimeBeforeRank0    | 640.314 us                | 1.170 ms                  |
| AfterBackward             | 19.116 ms                 | 29.431 ms                 |
| BlockToStepN              | 96.827 ms                 | 109.710 ms                |
| OneStep                   | 118.353 ms                | 142.625 ms                |
| E2E-100                   | 11.972 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
E20240128 01:52:51.495008 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=565839
W20240128 01:52:51.587011 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=313, pq.top=313
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
W20240128 01:52:51.716120 3945518 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
E20240128 01:52:52.495020 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=576324
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
W20240128 01:52:52.587338 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=322, pq.top=321
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
W20240128 01:52:52.720825 3945518 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
E20240128 01:52:53.497638 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=589657
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
W20240128 01:52:53.587392 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=330, pq.top=329
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.307 ms                  | 3.687 ms                  |
| ProcessBack:UpdateCache   | 899.158 us                | 1.425 ms                  |
| ProcessBack:UpsertPq      | 15.542 ms                 | 25.623 ms                 |
| ProcessOneStep            | 18.950 ms                 | 29.411 ms                 |
| BlockToStepN              | 97.067 ms                 | 109.613 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
W20240128 01:52:53.753369 3945518 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
E20240128 01:52:54.497007 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=602622
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
W20240128 01:52:54.605580 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=339, pq.top=338
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
W20240128 01:52:54.819327 3945518 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
E20240128 01:52:55.498946 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=614042
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
W20240128 01:52:55.605216 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=347, pq.top=346
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
W20240128 01:52:55.889557 3945518 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 91.902 us                 | 127.817 us                |
| GenInput                  | 436.336 us                | 875.053 us                |
| NN                        | 441.066 us                | 653.911 us                |
| Forward                   | 619.363 us                | 1.229 ms                  |
| Backward                  | 1.629 ms                  | 3.606 ms                  |
| Optimize                  | 160.708 us                | 278.596 us                |
| BarrierTimeBeforeRank0    | 649.037 us                | 1.170 ms                  |
| AfterBackward             | 18.800 ms                 | 29.138 ms                 |
| BlockToStepN              | 97.328 ms                 | 109.449 ms                |
| OneStep                   | 118.547 ms                | 138.059 ms                |
| E2E-100                   | 11.972 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
E20240128 01:52:56.498008 3944957 parallel_pq_v2.h:76] insert failed, size(hashtable)=3442
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
W20240128 01:52:56.623831 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=356, pq.top=355
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
W20240128 01:52:56.953342 3945518 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
E20240128 01:52:57.500104 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=639879
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
W20240128 01:52:57.623272 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=364, pq.top=364
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
W20240128 01:52:58.014402 3945518 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
E20240128 01:52:58.500006 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=653920
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.309 ms                  | 3.395 ms                  |
| ProcessBack:UpdateCache   | 877.595 us                | 1.413 ms                  |
| ProcessBack:UpsertPq      | 15.275 ms                 | 25.585 ms                 |
| ProcessOneStep            | 18.774 ms                 | 29.120 ms                 |
| BlockToStepN              | 97.136 ms                 | 109.396 ms                |
+---------------------------+---------------------------+---------------------------+
W20240128 01:52:58.636246 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=373, pq.top=372
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
W20240128 01:52:59.024299 3945518 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
E20240128 01:52:59.500006 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=665482
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
W20240128 01:52:59.642428 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=380
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
W20240128 01:53:00.025465 3945518 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
E20240128 01:53:00.500010 3945172 parallel_pq_v2.h:76] insert failed, size(hashtable)=3178
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
W20240128 01:53:00.642417 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=389, pq.top=388
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
W20240128 01:53:01.027767 3945518 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 92.199 us                 | 127.817 us                |
| GenInput                  | 439.400 us                | 875.053 us                |
| NN                        | 441.299 us                | 653.911 us                |
| Forward                   | 620.318 us                | 1.229 ms                  |
| Backward                  | 1.633 ms                  | 3.606 ms                  |
| Optimize                  | 160.708 us                | 278.596 us                |
| BarrierTimeBeforeRank0    | 600.019 us                | 1.170 ms                  |
| AfterBackward             | 18.993 ms                 | 29.138 ms                 |
| BlockToStepN              | 97.366 ms                 | 109.449 ms                |
| OneStep                   | 119.063 ms                | 138.059 ms                |
| E2E-100                   | 11.972 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
E20240128 01:53:01.500022 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=687743
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
W20240128 01:53:01.642246 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=397, pq.top=396
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
Step399:rank3, time: 12.062, per_step: 0.119428
Step399:rank1, time: 12.062, per_step: 0.119428
Step399:rank0, time: 12.062, per_step: 0.119428
Step399:rank2, time: 12.062, per_step: 0.119428
========== Step 400 ========== 
========== Step 400 ========== 
========== Step 400 ========== 
========== Step 400 ========== 
W20240128 01:53:02.073835 3945518 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
E20240128 01:53:02.502372 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=698627
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
W20240128 01:53:02.642058 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=405, pq.top=404
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
W20240128 01:53:03.081827 3945518 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
E20240128 01:53:03.503423 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=710661
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.308 ms                  | 3.395 ms                  |
| ProcessBack:UpdateCache   | 895.982 us                | 1.413 ms                  |
| ProcessBack:UpsertPq      | 15.620 ms                 | 25.585 ms                 |
| ProcessOneStep            | 19.025 ms                 | 29.120 ms                 |
| BlockToStepN              | 97.504 ms                 | 110.081 ms                |
+---------------------------+---------------------------+---------------------------+
W20240128 01:53:03.642048 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=413, pq.top=412
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
W20240128 01:53:04.083503 3945518 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
E20240128 01:53:04.504508 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=722001
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
W20240128 01:53:04.642235 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=420
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
W20240128 01:53:05.083911 3945518 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
E20240128 01:53:05.505110 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=734081
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
W20240128 01:53:05.642200 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=429, pq.top=428
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
W20240128 01:53:06.137470 3945518 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 92.312 us                 | 127.817 us                |
| GenInput                  | 442.058 us                | 875.053 us                |
| NN                        | 440.937 us                | 653.911 us                |
| Forward                   | 620.318 us                | 1.229 ms                  |
| Backward                  | 1.655 ms                  | 3.630 ms                  |
| Optimize                  | 160.241 us                | 278.596 us                |
| BarrierTimeBeforeRank0    | 428.262 us                | 1.170 ms                  |
| AfterBackward             | 19.152 ms                 | 29.431 ms                 |
| BlockToStepN              | 97.595 ms                 | 110.165 ms                |
| OneStep                   | 119.412 ms                | 138.059 ms                |
| E2E-100                   | 11.972 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
E20240128 01:53:06.505012 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=27
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
W20240128 01:53:06.643695 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=438, pq.top=437
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
W20240128 01:53:07.140712 3945518 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
E20240128 01:53:07.505016 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=1128
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
W20240128 01:53:07.643610 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=446, pq.top=445
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
W20240128 01:53:08.185035 3945518 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
E20240128 01:53:08.506261 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=768854
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.309 ms                  | 3.320 ms                  |
| ProcessBack:UpdateCache   | 910.948 us                | 1.407 ms                  |
| ProcessBack:UpsertPq      | 15.802 ms                 | 25.623 ms                 |
| ProcessOneStep            | 19.181 ms                 | 29.411 ms                 |
| BlockToStepN              | 97.382 ms                 | 109.613 ms                |
+---------------------------+---------------------------+---------------------------+
W20240128 01:53:08.643251 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=454, pq.top=453
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
W20240128 01:53:09.188556 3945518 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
E20240128 01:53:09.506057 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=780392
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
W20240128 01:53:09.662099 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=463, pq.top=462
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
W20240128 01:53:10.233004 3945518 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
E20240128 01:53:10.506006 3945518 parallel_pq_v2.h:76] insert failed, size(hashtable)=1182
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
W20240128 01:53:10.662324 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=471, pq.top=470
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 92.762 us                 | 127.817 us                |
| GenInput                  | 443.238 us                | 862.957 us                |
| NN                        | 441.066 us                | 626.226 us                |
| Forward                   | 620.843 us                | 950.043 us                |
| Backward                  | 1.717 ms                  | 3.630 ms                  |
| Optimize                  | 160.708 us                | 259.596 us                |
| BarrierTimeBeforeRank0    | 489.739 us                | 1.241 ms                  |
| AfterBackward             | 19.341 ms                 | 29.431 ms                 |
| BlockToStepN              | 97.201 ms                 | 109.710 ms                |
| OneStep                   | 119.439 ms                | 137.936 ms                |
| E2E-100                   | 11.972 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
W20240128 01:53:11.232950 3945518 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
E20240128 01:53:11.509567 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=803893
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
W20240128 01:53:11.662072 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=479, pq.top=479
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
W20240128 01:53:12.269361 3945518 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
E20240128 01:53:12.509014 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=816927
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
W20240128 01:53:12.662684 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=487
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
W20240128 01:53:13.275674 3945518 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
E20240128 01:53:13.509024 3945517 parallel_pq_v2.h:76] insert failed, size(hashtable)=827166
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 2.310 ms                  | 3.320 ms                  |
| ProcessBack:UpdateCache   | 923.668 us                | 1.407 ms                  |
| ProcessBack:UpsertPq      | 15.969 ms                 | 25.623 ms                 |
| ProcessOneStep            | 19.314 ms                 | 29.411 ms                 |
| BlockToStepN              | 97.097 ms                 | 109.613 ms                |
+---------------------------+---------------------------+---------------------------+
W20240128 01:53:13.662521 3944957 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=496, pq.top=495
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
Step499:rank3, time: 12.117, per_step: 0.119968
Step499:rank0, time: 12.117, per_step: 0.119968
Step499:rank1, time: 12.117, per_step: 0.119968
Step499:rank2, time: 12.117, per_step: 0.119968
timer name is E2E-100timer name is 
E2E-100
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
ERROR [3944957 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 92.811 us                 | 127.817 us                |
| GenInput                  | 443.154 us                | 875.053 us                |
| NN                        | 440.916 us                | 626.226 us                |
| Forward                   | 620.510 us                | 950.043 us                |
| Backward                  | 1.734 ms                  | 3.630 ms                  |
| Optimize                  | 161.029 us                | 259.596 us                |
| BarrierTimeBeforeRank0    | 408.110 us                | 1.258 ms                  |
| AfterBackward             | 19.342 ms                 | 29.431 ms                 |
| BlockToStepN              | 97.106 ms                 | 109.710 ms                |
| OneStep                   | 119.460 ms                | 137.936 ms                |
| E2E-100                   | 12.062 s                  | 14.063 s                  |
+---------------------------+---------------------------+---------------------------+
