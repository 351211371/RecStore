WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240128 02:00:45.436686 3952762 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240128 02:00:45.438068 3952762 IPCTensor.h:368] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:151: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [3952762 perf_rec_model.py:151] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f88aad24fe0>==========
Worker 1 pid=3952903
Worker 2 pid=3952905
INFO [3952762 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3952903 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3952907 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [3952907 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [3952762 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240128 02:00:48.629384 3952907 IPCTensor.h:347] IPCTensor full_emb already exists
INFO [3952905 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
E20240128 02:00:48.629640 3952762 IPCTensor.h:347] IPCTensor full_emb already exists
INFO [3952905 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240128 02:00:48.630928 3952905 IPCTensor.h:347] IPCTensor full_emb already exists
INFO [3952903 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
E20240128 02:00:48.634076 3952903 IPCTensor.h:347] IPCTensor full_emb already exists
W20240128 02:00:48.637792 3952907 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_3 [3376257, 32]; dev=3; size=412.1 MB
W20240128 02:00:48.637823 3952762 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_0 [3376257, 32]; dev=0; size=412.1 MB
W20240128 02:00:48.639197 3952762 IPCTensor.h:368] NewIPCTensor: input_keys_0 [1000000]0x100101970000 7.629 MB
W20240128 02:00:48.639222 3952907 IPCTensor.h:368] NewIPCTensor: input_keys_3 [1000000]0x100102113000 7.629 MB
W20240128 02:00:48.639297 3952762 IPCTensor.h:368] NewIPCTensor: input_keys_neg_0 [1000000]0x1001028b6000 7.629 MB
W20240128 02:00:48.639335 3952762 IPCTensor.h:368] NewIPCTensor: backward_grads_0 [1000000, 32]0x100103059000 122.1 MB
W20240128 02:00:48.639371 3952762 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10010b210000 122.1 MB
W20240128 02:00:48.639370 3952907 IPCTensor.h:368] NewIPCTensor: input_keys_neg_3 [1000000]0x10010aa6d000 7.629 MB
W20240128 02:00:48.639408 3952762 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240128 02:00:48.639436 3952907 IPCTensor.h:368] NewIPCTensor: backward_grads_3 [1000000, 32]0x100112c24000 122.1 MB
W20240128 02:00:48.639483 3952907 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10011a638000 122.1 MB
W20240128 02:00:48.639529 3952907 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240128 02:00:48.640004 3952762 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240128 02:00:48.640022 3952907 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240128 02:00:48.640823 3952903 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_1 [3376257, 32]; dev=1; size=412.1 MB
W20240128 02:00:48.640841 3952905 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_2 [3376257, 32]; dev=2; size=412.1 MB
W20240128 02:00:48.644027 3952903 IPCTensor.h:368] NewIPCTensor: input_keys_1 [1000000]0x100122058000 7.629 MB
W20240128 02:00:48.644057 3952905 IPCTensor.h:368] NewIPCTensor: input_keys_2 [1000000]0x1001227fb000 7.629 MB
W20240128 02:00:48.644331 3952905 IPCTensor.h:368] NewIPCTensor: input_keys_neg_2 [1000000]0x100122f9e000 7.629 MB
W20240128 02:00:48.644358 3952903 IPCTensor.h:368] NewIPCTensor: input_keys_neg_1 [1000000]0x100123741000 7.629 MB
W20240128 02:00:48.644474 3952903 IPCTensor.h:368] NewIPCTensor: backward_grads_1 [1000000, 32]0x100123ee4000 122.1 MB
W20240128 02:00:48.644483 3952905 IPCTensor.h:368] NewIPCTensor: backward_grads_2 [1000000, 32]0x10012b8f8000 122.1 MB
W20240128 02:00:48.644565 3952903 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10013330c000 122.1 MB
W20240128 02:00:48.644589 3952905 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10013ad20000 122.1 MB
W20240128 02:00:48.644663 3952903 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240128 02:00:48.644673 3952905 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240128 02:00:48.645943 3952903 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240128 02:00:48.645979 3952905 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
Worker 3 pid=3952907
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 3376257), (3376257, 6752514), (6752514, 10128771), (10128771, 13505028)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240128 02:00:54.111634 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x10014273c000 7.629 MB
W20240128 02:00:54.111855 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x100142edf000 7.629 MB
W20240128 02:00:54.111886 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x100143682000 7.629 MB
W20240128 02:00:54.111907 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x100143e25000 7.629 MB
W20240128 02:00:54.111927 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1001445c8000 7.629 MB
W20240128 02:00:54.111950 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x100144d6b000 7.629 MB
W20240128 02:00:54.111972 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10014550e000 7.629 MB
W20240128 02:00:54.112004 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x100145cb1000 7.629 MB
W20240128 02:00:54.112023 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x100146454000 7.629 MB
W20240128 02:00:54.112042 3952905 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x100146bf7000 7.629 MB
W20240128 02:00:54.112068 3952905 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10014739a000 80 B 
W20240128 02:00:54.112089 3952905 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10014739c000 8 B 
W20240128 02:00:54.112113 3952905 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10014739e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240128 02:00:54.112386 3952905 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
W20240128 02:00:54.126498 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1001473a0000 7.629 MB
W20240128 02:00:54.126637 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100147b43000 7.629 MB
W20240128 02:00:54.126667 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1001482e6000 7.629 MB
W20240128 02:00:54.126685 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100148a89000 7.629 MB
W20240128 02:00:54.126708 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x10014922c000 7.629 MB
W20240128 02:00:54.126731 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1001499cf000 7.629 MB
W20240128 02:00:54.126768 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10014a172000 7.629 MB
W20240128 02:00:54.126803 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x10014a915000 7.629 MB
W20240128 02:00:54.126821 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10014b0b8000 7.629 MB
W20240128 02:00:54.126837 3952903 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10014b85b000 7.629 MB
W20240128 02:00:54.126866 3952903 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x10014bffe000 80 B 
W20240128 02:00:54.126885 3952903 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x10014c000000 8 B 
W20240128 02:00:54.126910 3952903 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10014c002000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240128 02:00:54.127144 3952903 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240128 02:00:55.023334 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x10014c004000 7.629 MB
W20240128 02:00:55.023479 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x10014c7a7000 7.629 MB
W20240128 02:00:55.023507 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x10014cf4a000 7.629 MB
W20240128 02:00:55.023533 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x10014d6ed000 7.629 MB
W20240128 02:00:55.023552 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x10014de90000 7.629 MB
W20240128 02:00:55.023577 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x10014e633000 7.629 MB
W20240128 02:00:55.023591 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10014edd6000 7.629 MB
W20240128 02:00:55.023635 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10014f579000 7.629 MB
W20240128 02:00:55.023658 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10014fd1c000 7.629 MB
W20240128 02:00:55.023676 3952762 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1001504bf000 7.629 MB
W20240128 02:00:55.023696 3952762 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100150c62000 80 B 
W20240128 02:00:55.023716 3952762 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100150c64000 8 B 
W20240128 02:00:55.023736 3952762 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100150c66000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240128 02:00:55.024003 3952762 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240128 02:00:55.037031 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x100150c68000 7.629 MB
W20240128 02:00:55.037174 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10015140b000 7.629 MB
W20240128 02:00:55.037206 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100151bae000 7.629 MB
W20240128 02:00:55.037232 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x100152351000 7.629 MB
W20240128 02:00:55.037254 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x100152af4000 7.629 MB
W20240128 02:00:55.037276 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100153297000 7.629 MB
W20240128 02:00:55.037297 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100153a3a000 7.629 MB
W20240128 02:00:55.037325 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1001541dd000 7.629 MB
W20240128 02:00:55.037343 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100154980000 7.629 MB
W20240128 02:00:55.037360 3952907 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x100155123000 7.629 MB
W20240128 02:00:55.037386 3952907 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x1001558c6000 80 B 
W20240128 02:00:55.037418 3952907 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x1001558c8000 8 B 
W20240128 02:00:55.037442 3952907 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1001558ca000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
I20240128 02:00:55.037657 3952907 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240128 02:00:55.039017 3952762 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "kForwardItersPerStep": 1,
        "clr": 1,
        "backwardMode": "CppAsyncV2",
        "nr_background_threads": 16, 
        "cache_ratio": 0.1,
        "backgrad_init": "both"
    }
W20240128 02:00:55.039098 3952762 grad_base.h:184] Init GradProcessingBase done
I20240128 02:00:57.112329 3952762 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=16
W20240128 02:00:57.112435 3952762 kg_controller.h:78] after init GradAsyncProcessingV2
I20240128 02:00:57.112440 3952762 kg_controller.h:84] Construct KGCacheController done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
I20240128 02:00:57.436014 3952762 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240128 02:00:58.456804 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240128 02:00:58.457054 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240128 02:00:59.457027 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240128 02:00:59.474047 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
Before Training
I20240128 02:01:01.438747 3952907 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
Before Training
Before Training
I20240128 02:01:01.439029 3952905 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240128 02:01:01.439054 3952903 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
Before Training
I20240128 02:01:01.446692 3952762 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
========== Step 0 ========== 
W20240128 02:01:01.448077 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240128 02:01:01.448159 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 261.617 ms                | 261.617 ms                |
+---------------------------+---------------------------+---------------------------+
E20240128 02:01:02.672499 3952985 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
W20240128 02:01:02.713850 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=0
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
========== Step 1 ========== 
W20240128 02:01:02.913779 3953318 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
INFO [3952903 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3952905 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3952907 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [3952762 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
E20240128 02:01:03.672014 3952988 parallel_pq_v2.h:76] insert failed, size(hashtable)=603
W20240128 02:01:03.713007 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=2, pq.top=1
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
========== Step 2 ========== 
W20240128 02:01:03.913350 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
========== Step 4 ========== 
E20240128 02:01:04.674273 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=28190
W20240128 02:01:04.713003 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=5, pq.top=5
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
========== Step 6 ========== 
W20240128 02:01:04.966070 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 122.350 us                | 201.449 us                |
| GenInput                  | 493.715 us                | 780.880 us                |
| NN                        | 652.451 us                | 116.670 ms                |
| Forward                   | 887.682 us                | 117.698 ms                |
| Backward                  | 1.726 ms                  | 728.794 ms                |
| Optimize                  | 225.975 us                | 8.296 ms                  |
| BarrierTimeBeforeRank0    | 81.641 us                 | 43.615 ms                 |
| AfterBackward             | 60.171 ms                 | 963.778 ms                |
| BlockToStepN              | 199.887 ms                | 213.277 ms                |
| OneStep                   | 263.507 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
========== Step 8 ========== 
E20240128 02:01:05.676295 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=50373
W20240128 02:01:05.713004 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=9, pq.top=9
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
========== Step 10 ========== 
W20240128 02:01:06.012861 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
========== Step 12 ========== 
E20240128 02:01:06.676074 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=69872
W20240128 02:01:06.713007 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=13, pq.top=12
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
========== Step 14 ========== 
W20240128 02:01:07.097491 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
========== Step 15 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 11.004 ms                 | 261.617 ms                |
| ProcessBack:UpdateCache   | 907.717 us                | 622.331 ms                |
| ProcessBack:UpsertPq      | 40.867 ms                 | 51.464 ms                 |
| ProcessOneStep            | 54.415 ms                 | 963.538 ms                |
| BlockToStepN              | 207.574 ms                | 243.958 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
========== Step 16 ========== 
E20240128 02:01:07.676007 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=95172
W20240128 02:01:07.739118 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=17, pq.top=16
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
========== Step 18 ========== 
W20240128 02:01:08.404764 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240128 02:01:08.684489 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=2294
W20240128 02:01:08.739012 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=19, pq.top=19
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
========== Step 21 ========== 
W20240128 02:01:09.426398 3953318 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240128 02:01:09.684036 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=3682
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
========== Step 22 ========== 
W20240128 02:01:09.837343 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=23, pq.top=22
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 102.480 us                | 201.449 us                |
| GenInput                  | 534.060 us                | 1.625 ms                  |
| NN                        | 533.795 us                | 116.670 ms                |
| Forward                   | 753.974 us                | 117.698 ms                |
| Backward                  | 2.119 ms                  | 728.794 ms                |
| Optimize                  | 209.743 us                | 8.296 ms                  |
| BarrierTimeBeforeRank0    | 23.452 us                 | 43.615 ms                 |
| AfterBackward             | 60.662 ms                 | 963.778 ms                |
| BlockToStepN              | 204.753 ms                | 371.284 ms                |
| OneStep                   | 270.923 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
========== Step 24 ========== 
W20240128 02:01:10.433109 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
========== Step 25 ========== 
E20240128 02:01:10.684011 3952985 parallel_pq_v2.h:76] insert failed, size(hashtable)=1036
W20240128 02:01:10.837028 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=26, pq.top=26
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
========== Step 28 ========== 
W20240128 02:01:11.497895 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240128 02:01:11.684007 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=33505
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
========== Step 29 ========== 
W20240128 02:01:11.837015 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=30, pq.top=29
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
========== Step 31 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 14.695 ms                 | 261.617 ms                |
| ProcessBack:UpdateCache   | 976.834 us                | 622.331 ms                |
| ProcessBack:UpsertPq      | 40.240 ms                 | 51.464 ms                 |
| ProcessOneStep            | 60.627 ms                 | 963.538 ms                |
| BlockToStepN              | 206.986 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
========== Step 32 ========== 
W20240128 02:01:12.531692 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240128 02:01:12.699424 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=58412
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
========== Step 33 ========== 
W20240128 02:01:12.899295 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=34, pq.top=33
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
========== Step 36 ========== 
W20240128 02:01:13.670768 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240128 02:01:13.699005 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=85466
W20240128 02:01:13.899013 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=37, pq.top=37
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
========== Step 38 ========== 
E20240128 02:01:14.700394 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=12325
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
========== Step 39 ========== 
W20240128 02:01:14.725493 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240128 02:01:14.899029 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=40, pq.top=40
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
========== Step 40 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 108.296 us                | 201.449 us                |
| GenInput                  | 530.611 us                | 1.625 ms                  |
| NN                        | 529.275 us                | 116.670 ms                |
| Forward                   | 729.340 us                | 117.698 ms                |
| Backward                  | 2.137 ms                  | 728.794 ms                |
| Optimize                  | 200.035 us                | 8.296 ms                  |
| BarrierTimeBeforeRank0    | 22.252 us                 | 43.615 ms                 |
| AfterBackward             | 62.461 ms                 | 963.778 ms                |
| BlockToStepN              | 203.372 ms                | 371.284 ms                |
| OneStep                   | 281.556 ms                | 1.466 s                   |
+---------------------------+---------------------------+---------------------------+
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
========== Step 42 ========== 
E20240128 02:01:15.700011 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=888
W20240128 02:01:15.740128 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240128 02:01:15.899030 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=43, pq.top=43
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
========== Step 45 ========== 
E20240128 02:01:16.700109 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=29286
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
========== Step 46 ========== 
W20240128 02:01:16.751009 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240128 02:01:16.899031 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=47, pq.top=47
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
========== Step 48 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.388 ms                 | 261.617 ms                |
| ProcessBack:UpdateCache   | 978.624 us                | 622.331 ms                |
| ProcessBack:UpsertPq      | 39.468 ms                 | 51.464 ms                 |
| ProcessOneStep            | 61.481 ms                 | 963.538 ms                |
| BlockToStepN              | 207.574 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
========== Step 49 ========== 
E20240128 02:01:17.700054 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=52866
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
========== Step 50 ========== 
W20240128 02:01:17.861805 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240128 02:01:17.911224 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=51, pq.top=50
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
========== Step 52 ========== 
E20240128 02:01:18.700013 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=73387
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
========== Step 53 ========== 
W20240128 02:01:18.911027 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=54, pq.top=54
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
========== Step 54 ========== 
W20240128 02:01:18.992087 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
========== Step 56 ========== 
E20240128 02:01:19.707314 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=90028
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
========== Step 57 ========== 
W20240128 02:01:19.911015 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=58, pq.top=57
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 102.591 us                | 184.031 us                |
| GenInput                  | 458.365 us                | 1.094 ms                  |
| NN                        | 505.289 us                | 1.643 ms                  |
| Forward                   | 710.562 us                | 1.969 ms                  |
| Backward                  | 1.972 ms                  | 130.738 ms                |
| Optimize                  | 188.704 us                | 635.948 us                |
| BarrierTimeBeforeRank0    | 27.510 us                 | 1.173 ms                  |
| AfterBackward             | 59.065 ms                 | 110.180 ms                |
| BlockToStepN              | 212.402 ms                | 305.545 ms                |
| OneStep                   | 280.030 ms                | 999.604 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
========== Step 58 ========== 
W20240128 02:01:20.093524 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
========== Step 60 ========== 
E20240128 02:01:20.707051 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=1605
W20240128 02:01:20.911043 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=61, pq.top=61
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
========== Step 61 ========== 
W20240128 02:01:21.101500 3953318 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
========== Step 63 ========== 
E20240128 02:01:21.707085 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=582
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
========== Step 64 ========== 
W20240128 02:01:21.983268 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=65, pq.top=64
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
========== Step 65 ========== 
W20240128 02:01:22.180768 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.667 ms                 | 66.149 ms                 |
| ProcessBack:UpdateCache   | 905.766 us                | 7.569 ms                  |
| ProcessBack:UpsertPq      | 38.277 ms                 | 49.264 ms                 |
| ProcessOneStep            | 58.693 ms                 | 110.137 ms                |
| BlockToStepN              | 212.697 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
========== Step 66 ========== 
E20240128 02:01:22.707011 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=19448
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
========== Step 67 ========== 
W20240128 02:01:22.983068 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=68, pq.top=68
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
========== Step 69 ========== 
W20240128 02:01:23.303485 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
========== Step 70 ========== 
E20240128 02:01:23.707008 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=13338
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
========== Step 71 ========== 
W20240128 02:01:23.983008 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=72, pq.top=71
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
========== Step 73 ========== 
W20240128 02:01:24.395589 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
========== Step 74 ========== 
E20240128 02:01:24.707019 3952988 parallel_pq_v2.h:76] insert failed, size(hashtable)=1987
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
========== Step 75 ========== 
W20240128 02:01:24.983079 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=76, pq.top=75
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 104.465 us                | 184.031 us                |
| GenInput                  | 458.365 us                | 1.625 ms                  |
| NN                        | 495.647 us                | 1.643 ms                  |
| Forward                   | 701.895 us                | 1.969 ms                  |
| Backward                  | 1.862 ms                  | 130.738 ms                |
| Optimize                  | 187.494 us                | 635.948 us                |
| BarrierTimeBeforeRank0    | 161.104 us                | 1.173 ms                  |
| AfterBackward             | 59.720 ms                 | 110.180 ms                |
| BlockToStepN              | 212.402 ms                | 371.284 ms                |
| OneStep                   | 279.961 ms                | 999.604 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
========== Step 77 ========== 
W20240128 02:01:25.407625 3953318 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
========== Step 78 ========== 
E20240128 02:01:25.707010 3952985 parallel_pq_v2.h:76] insert failed, size(hashtable)=1016
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
========== Step 79 ========== 
W20240128 02:01:26.015066 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=80, pq.top=80
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
========== Step 81 ========== 
W20240128 02:01:26.593459 3953318 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240128 02:01:26.707069 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=2602
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
========== Step 82 ========== 
W20240128 02:01:27.015010 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=83, pq.top=83
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
========== Step 83 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 23.198 ms                 | 66.149 ms                 |
| ProcessBack:UpdateCache   | 905.766 us                | 7.569 ms                  |
| ProcessBack:UpsertPq      | 38.421 ms                 | 49.264 ms                 |
| ProcessOneStep            | 60.627 ms                 | 110.137 ms                |
| BlockToStepN              | 211.492 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
========== Step 84 ========== 
E20240128 02:01:27.712029 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=29859
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
========== Step 85 ========== 
W20240128 02:01:27.742827 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240128 02:01:28.015084 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=86, pq.top=85
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
========== Step 88 ========== 
E20240128 02:01:28.712011 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=52268
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
========== Step 89 ========== 
W20240128 02:01:28.894162 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240128 02:01:29.015075 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=90, pq.top=89
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 90 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
========== Step 91 ========== 
E20240128 02:01:29.716429 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=4999
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
========== Step 92 ========== 
W20240128 02:01:29.909202 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240128 02:01:30.015024 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=93, pq.top=93
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 104.465 us                | 184.031 us                |
| GenInput                  | 500.742 us                | 1.625 ms                  |
| NN                        | 492.867 us                | 1.643 ms                  |
| Forward                   | 698.288 us                | 1.969 ms                  |
| Backward                  | 1.869 ms                  | 130.738 ms                |
| Optimize                  | 187.428 us                | 635.948 us                |
| BarrierTimeBeforeRank0    | 327.944 us                | 1.370 ms                  |
| AfterBackward             | 61.516 ms                 | 110.180 ms                |
| BlockToStepN              | 211.552 ms                | 371.284 ms                |
| OneStep                   | 279.961 ms                | 999.604 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 93 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 94 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
========== Step 95 ========== 
E20240128 02:01:30.716018 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=18437
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
========== Step 96 ========== 
W20240128 02:01:30.911056 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240128 02:01:31.015049 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=97, pq.top=96
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 97 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 98 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
========== Step 99 ========== 
E20240128 02:01:31.716013 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=46821
W20240128 02:01:32.015065 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=100, pq.top=100
Step99:rank3, time: 42.322, per_step: 0.423218
Step99:rank0, time: 42.322, per_step: 0.423219
Step99:rank1, time: 42.322, per_step: 0.423219
Step99:rank2, time: 42.322, per_step: 0.423219
========== Step 100 ========== 
========== Step 100 ========== 
========== Step 100 ========== 
W20240128 02:01:32.024140 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 100 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
========== Step 101 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 24.828 ms                 | 66.149 ms                 |
| ProcessBack:UpdateCache   | 894.856 us                | 7.569 ms                  |
| ProcessBack:UpsertPq      | 38.421 ms                 | 51.464 ms                 |
| ProcessOneStep            | 61.121 ms                 | 110.137 ms                |
| BlockToStepN              | 212.338 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
========== Step 102 ========== 
E20240128 02:01:32.716106 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=10944
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
========== Step 103 ========== 
W20240128 02:01:33.015105 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=104, pq.top=103
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
========== Step 104 ========== 
W20240128 02:01:33.114552 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 105 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
========== Step 106 ========== 
E20240128 02:01:33.716063 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=32734
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
========== Step 107 ========== 
W20240128 02:01:34.015034 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=108, pq.top=107
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
========== Step 108 ========== 
W20240128 02:01:34.123359 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 109 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
========== Step 110 ========== 
E20240128 02:01:34.716115 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=51044
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
========== Step 111 ========== 
W20240128 02:01:35.015046 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=112, pq.top=111
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 104.465 us                | 184.031 us                |
| GenInput                  | 509.425 us                | 1.625 ms                  |
| NN                        | 496.697 us                | 1.643 ms                  |
| Forward                   | 703.406 us                | 1.969 ms                  |
| Backward                  | 1.834 ms                  | 130.738 ms                |
| Optimize                  | 187.029 us                | 635.948 us                |
| BarrierTimeBeforeRank0    | 327.944 us                | 1.370 ms                  |
| AfterBackward             | 60.662 ms                 | 110.180 ms                |
| BlockToStepN              | 209.553 ms                | 371.284 ms                |
| OneStep                   | 276.441 ms                | 999.604 ms                |
| E2E-100                   | 30.577 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
========== Step 112 ========== 
W20240128 02:01:35.195991 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
========== Step 113 ========== 
E20240128 02:01:35.717180 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=69859
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 114 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
========== Step 115 ========== 
W20240128 02:01:36.048481 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=116, pq.top=115
========== Step 116 ========== 
========== Step 116 ========== 
========== Step 116 ========== 
W20240128 02:01:36.257601 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 116 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
========== Step 117 ========== 
E20240128 02:01:36.724200 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=86121
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 118 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
========== Step 119 ========== 
W20240128 02:01:37.085095 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=120, pq.top=119
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
========== Step 120 ========== 
W20240128 02:01:37.289541 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.820 ms                 | 66.149 ms                 |
| ProcessBack:UpdateCache   | 903.817 us                | 7.569 ms                  |
| ProcessBack:UpsertPq      | 38.628 ms                 | 56.159 ms                 |
| ProcessOneStep            | 59.698 ms                 | 110.137 ms                |
| BlockToStepN              | 209.313 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
========== Step 121 ========== 
E20240128 02:01:37.730834 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=101711
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 122 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
========== Step 123 ========== 
W20240128 02:01:38.131947 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=124, pq.top=123
========== Step 124 ========== 
========== Step 124 ========== 
========== Step 124 ========== 
W20240128 02:01:38.336894 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 124 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
========== Step 125 ========== 
E20240128 02:01:38.731689 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=118742
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 126 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
========== Step 127 ========== 
W20240128 02:01:39.183100 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=128, pq.top=127
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
========== Step 128 ========== 
W20240128 02:01:39.388162 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
========== Step 129 ========== 
E20240128 02:01:39.731014 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=133891
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
========== Step 130 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.082 us                | 184.031 us                |
| GenInput                  | 546.062 us                | 1.625 ms                  |
| NN                        | 496.697 us                | 1.643 ms                  |
| Forward                   | 700.759 us                | 1.969 ms                  |
| Backward                  | 1.806 ms                  | 130.738 ms                |
| Optimize                  | 185.729 us                | 635.948 us                |
| BarrierTimeBeforeRank0    | 187.339 us                | 1.370 ms                  |
| AfterBackward             | 58.763 ms                 | 110.180 ms                |
| BlockToStepN              | 209.331 ms                | 371.284 ms                |
| OneStep                   | 272.123 ms                | 999.604 ms                |
| E2E-100                   | 30.577 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
========== Step 131 ========== 
W20240128 02:01:40.228384 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=132, pq.top=131
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
========== Step 132 ========== 
W20240128 02:01:40.436931 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
========== Step 133 ========== 
E20240128 02:01:40.731022 3952981 parallel_pq_v2.h:76] insert failed, size(hashtable)=565
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 134 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
========== Step 135 ========== 
W20240128 02:01:41.267513 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=136, pq.top=135
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
========== Step 136 ========== 
W20240128 02:01:41.474792 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240128 02:01:41.731365 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=164613
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 137 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 138 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
========== Step 139 ========== 
W20240128 02:01:42.315193 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=140, pq.top=139
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.483 ms                 | 66.149 ms                 |
| ProcessBack:UpdateCache   | 892.960 us                | 7.569 ms                  |
| ProcessBack:UpsertPq      | 38.306 ms                 | 56.159 ms                 |
| ProcessOneStep            | 56.860 ms                 | 110.137 ms                |
| BlockToStepN              | 209.071 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
========== Step 140 ========== 
W20240128 02:01:42.525540 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240128 02:01:42.735320 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=179725
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 141 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
========== Step 142 ========== 
W20240128 02:01:43.315141 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=143, pq.top=143
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 143 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
========== Step 144 ========== 
W20240128 02:01:43.612190 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240128 02:01:43.735009 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=193922
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 145 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
========== Step 146 ========== 
W20240128 02:01:44.315032 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=147, pq.top=146
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 147 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
========== Step 148 ========== 
W20240128 02:01:44.667950 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240128 02:01:44.735023 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=1422
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
========== Step 149 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.339 us                | 184.031 us                |
| GenInput                  | 557.020 us                | 1.625 ms                  |
| NN                        | 492.935 us                | 1.643 ms                  |
| Forward                   | 694.492 us                | 1.969 ms                  |
| Backward                  | 1.797 ms                  | 130.738 ms                |
| Optimize                  | 184.396 us                | 635.948 us                |
| BarrierTimeBeforeRank0    | 242.304 us                | 1.370 ms                  |
| AfterBackward             | 55.978 ms                 | 110.180 ms                |
| BlockToStepN              | 209.483 ms                | 371.284 ms                |
| OneStep                   | 270.159 ms                | 999.604 ms                |
| E2E-100                   | 30.577 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
========== Step 150 ========== 
W20240128 02:01:45.315142 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=151, pq.top=150
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 151 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
========== Step 152 ========== 
W20240128 02:01:45.723269 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240128 02:01:45.735004 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=227005
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 153 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
========== Step 154 ========== 
W20240128 02:01:46.315048 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=155, pq.top=154
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
========== Step 155 ========== 
E20240128 02:01:46.737856 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=235013
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
========== Step 156 ========== 
W20240128 02:01:46.800632 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
========== Step 157 ========== 
W20240128 02:01:47.315183 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=158, pq.top=157
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
========== Step 158 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 16.460 ms                 | 64.265 ms                 |
| ProcessBack:UpdateCache   | 887.992 us                | 7.563 ms                  |
| ProcessBack:UpsertPq      | 37.956 ms                 | 52.319 ms                 |
| ProcessOneStep            | 54.793 ms                 | 109.751 ms                |
| BlockToStepN              | 210.189 ms                | 305.435 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
========== Step 159 ========== 
E20240128 02:01:47.737052 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=1682
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
========== Step 160 ========== 
W20240128 02:01:47.880396 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
========== Step 161 ========== 
W20240128 02:01:48.315099 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=162, pq.top=161
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 162 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
========== Step 163 ========== 
E20240128 02:01:48.737010 3952988 parallel_pq_v2.h:76] insert failed, size(hashtable)=1187
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
========== Step 164 ========== 
W20240128 02:01:48.994602 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
========== Step 165 ========== 
W20240128 02:01:49.315184 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=166, pq.top=165
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
========== Step 166 ========== 
E20240128 02:01:49.737269 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=275121
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
========== Step 167 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 105.468 us                | 168.700 us                |
| GenInput                  | 561.363 us                | 1.329 ms                  |
| NN                        | 491.497 us                | 1.263 ms                  |
| Forward                   | 693.419 us                | 1.923 ms                  |
| Backward                  | 1.801 ms                  | 4.313 ms                  |
| Optimize                  | 181.765 us                | 533.287 us                |
| BarrierTimeBeforeRank0    | 197.990 us                | 1.370 ms                  |
| AfterBackward             | 54.056 ms                 | 109.789 ms                |
| BlockToStepN              | 211.361 ms                | 305.545 ms                |
| OneStep                   | 270.449 ms                | 474.738 ms                |
| E2E-100                   | 30.577 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
========== Step 168 ========== 
W20240128 02:01:50.092236 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240128 02:01:50.315197 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=169, pq.top=168
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 169 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
========== Step 170 ========== 
E20240128 02:01:50.737100 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=287271
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 171 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
========== Step 172 ========== 
W20240128 02:01:51.163619 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240128 02:01:51.315235 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=173, pq.top=172
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
========== Step 173 ========== 
E20240128 02:01:51.737641 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=304597
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 174 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
========== Step 175 ========== 
W20240128 02:01:52.173877 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240128 02:01:52.315258 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=176, pq.top=176
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
========== Step 176 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 15.302 ms                 | 64.265 ms                 |
| ProcessBack:UpdateCache   | 883.859 us                | 7.563 ms                  |
| ProcessBack:UpsertPq      | 37.951 ms                 | 52.319 ms                 |
| ProcessOneStep            | 54.204 ms                 | 109.751 ms                |
| BlockToStepN              | 211.299 ms                | 305.435 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
========== Step 177 ========== 
E20240128 02:01:52.737011 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=318498
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 178 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
========== Step 179 ========== 
W20240128 02:01:53.281664 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240128 02:01:53.344601 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=180, pq.top=179
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
========== Step 180 ========== 
E20240128 02:01:53.747135 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=333521
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 181 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
========== Step 182 ========== 
W20240128 02:01:54.315085 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240128 02:01:54.344069 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=182
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
========== Step 183 ========== 
E20240128 02:01:54.751164 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=352678
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 184 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
========== Step 185 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 106.964 us                | 168.700 us                |
| GenInput                  | 565.828 us                | 1.329 ms                  |
| NN                        | 494.096 us                | 1.263 ms                  |
| Forward                   | 698.288 us                | 1.923 ms                  |
| Backward                  | 1.819 ms                  | 4.313 ms                  |
| Optimize                  | 182.099 us                | 533.287 us                |
| BarrierTimeBeforeRank0    | 176.046 us                | 1.401 ms                  |
| AfterBackward             | 54.817 ms                 | 109.789 ms                |
| BlockToStepN              | 212.129 ms                | 305.545 ms                |
| OneStep                   | 272.070 ms                | 474.738 ms                |
| E2E-100                   | 30.577 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
========== Step 186 ========== 
W20240128 02:01:55.322525 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240128 02:01:55.356751 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=187, pq.top=186
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
========== Step 187 ========== 
E20240128 02:01:55.751282 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=365678
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 188 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
========== Step 189 ========== 
W20240128 02:01:56.356165 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=190, pq.top=190
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
========== Step 190 ========== 
W20240128 02:01:56.375110 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
========== Step 191 ========== 
E20240128 02:01:56.751017 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=370621
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 192 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
========== Step 193 ========== 
W20240128 02:01:57.356184 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=194, pq.top=193
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
========== Step 194 ========== 
W20240128 02:01:57.411038 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 15.872 ms                 | 64.265 ms                 |
| ProcessBack:UpdateCache   | 876.477 us                | 7.563 ms                  |
| ProcessBack:UpsertPq      | 37.382 ms                 | 52.319 ms                 |
| ProcessOneStep            | 54.415 ms                 | 109.751 ms                |
| BlockToStepN              | 211.492 ms                | 305.435 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
========== Step 195 ========== 
E20240128 02:01:57.751009 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=379956
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 196 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
========== Step 197 ========== 
W20240128 02:01:58.356062 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=198, pq.top=197
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
========== Step 198 ========== 
W20240128 02:01:58.438577 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
========== Step 199 ========== 
E20240128 02:01:58.751008 3952762 parallel_pq_v2.h:76] insert failed, size(hashtable)=1271
Step199:rank2, time: 26.939, per_step: 0.266724
Step199:rank3, time: 26.939, per_step: 0.266725
Step199:rank1, time: 26.939, per_step: 0.266725
Step199:rank0, time: 26.939, per_step: 0.266725
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 200 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
========== Step 201 ========== 
W20240128 02:01:59.376816 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=202, pq.top=201
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
========== Step 202 ========== 
W20240128 02:01:59.579715 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240128 02:01:59.752218 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=412396
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
========== Step 203 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.339 us                | 184.031 us                |
| GenInput                  | 565.415 us                | 1.329 ms                  |
| NN                        | 496.697 us                | 1.263 ms                  |
| Forward                   | 700.759 us                | 1.923 ms                  |
| Backward                  | 1.835 ms                  | 4.313 ms                  |
| Optimize                  | 181.765 us                | 533.287 us                |
| BarrierTimeBeforeRank0    | 161.104 us                | 1.483 ms                  |
| AfterBackward             | 54.227 ms                 | 109.789 ms                |
| BlockToStepN              | 211.224 ms                | 305.545 ms                |
| OneStep                   | 270.449 ms                | 474.738 ms                |
| E2E-100                   | 26.939 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
========== Step 204 ========== 
W20240128 02:02:00.376219 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=205, pq.top=205
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
========== Step 205 ========== 
W20240128 02:02:00.611923 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240128 02:02:00.752053 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=428864
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 206 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
========== Step 207 ========== 
W20240128 02:02:01.376154 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=208, pq.top=208
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 208 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
========== Step 209 ========== 
W20240128 02:02:01.715925 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240128 02:02:01.752014 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=439335
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 210 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
========== Step 211 ========== 
W20240128 02:02:02.416113 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=212, pq.top=211
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 16.467 ms                 | 64.265 ms                 |
| ProcessBack:UpdateCache   | 878.088 us                | 7.563 ms                  |
| ProcessBack:UpsertPq      | 37.890 ms                 | 52.319 ms                 |
| ProcessOneStep            | 55.259 ms                 | 109.751 ms                |
| BlockToStepN              | 211.299 ms                | 305.435 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
========== Step 212 ========== 
E20240128 02:02:02.752017 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=444049
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
========== Step 213 ========== 
W20240128 02:02:02.934428 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
========== Step 214 ========== 
W20240128 02:02:03.416127 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=214
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
========== Step 215 ========== 
E20240128 02:02:03.753134 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=455457
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 216 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
========== Step 217 ========== 
W20240128 02:02:04.073504 3953318 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
========== Step 218 ========== 
W20240128 02:02:04.438424 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=219, pq.top=218
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
========== Step 219 ========== 
E20240128 02:02:04.753015 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=466243
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
========== Step 220 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.371 us                | 184.031 us                |
| GenInput                  | 565.828 us                | 1.431 ms                  |
| NN                        | 497.550 us                | 1.263 ms                  |
| Forward                   | 703.436 us                | 1.923 ms                  |
| Backward                  | 1.845 ms                  | 4.313 ms                  |
| Optimize                  | 183.838 us                | 533.287 us                |
| BarrierTimeBeforeRank0    | 187.339 us                | 1.483 ms                  |
| AfterBackward             | 55.978 ms                 | 109.789 ms                |
| BlockToStepN              | 211.552 ms                | 305.545 ms                |
| OneStep                   | 272.445 ms                | 474.738 ms                |
| E2E-100                   | 26.939 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
========== Step 221 ========== 
W20240128 02:02:05.189445 3953318 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240128 02:02:05.438292 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=222, pq.top=222
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
========== Step 222 ========== 
E20240128 02:02:05.753012 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=484097
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 223 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 224 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
========== Step 225 ========== 
W20240128 02:02:06.283485 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240128 02:02:06.438037 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=226, pq.top=226
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
========== Step 226 ========== 
E20240128 02:02:06.754070 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=492277
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 227 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 228 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
========== Step 229 ========== 
W20240128 02:02:07.324404 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240128 02:02:07.438326 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=230, pq.top=229
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.558 ms                 | 64.265 ms                 |
| ProcessBack:UpdateCache   | 875.324 us                | 7.563 ms                  |
| ProcessBack:UpsertPq      | 37.606 ms                 | 52.319 ms                 |
| ProcessOneStep            | 56.304 ms                 | 109.751 ms                |
| BlockToStepN              | 210.917 ms                | 305.435 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
========== Step 230 ========== 
E20240128 02:02:07.754009 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=505104
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 231 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 232 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
========== Step 233 ========== 
W20240128 02:02:08.431924 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240128 02:02:08.489899 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=234, pq.top=233
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
========== Step 234 ========== 
E20240128 02:02:08.754010 3952988 parallel_pq_v2.h:76] insert failed, size(hashtable)=94
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 235 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
========== Step 236 ========== 
W20240128 02:02:09.489171 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=237, pq.top=237
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
========== Step 237 ========== 
W20240128 02:02:09.542131 3953318 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240128 02:02:09.754035 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=526382
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
========== Step 238 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.445 us                | 184.031 us                |
| GenInput                  | 570.504 us                | 1.431 ms                  |
| NN                        | 498.650 us                | 1.263 ms                  |
| Forward                   | 704.736 us                | 1.923 ms                  |
| Backward                  | 1.845 ms                  | 4.313 ms                  |
| Optimize                  | 185.104 us                | 533.287 us                |
| BarrierTimeBeforeRank0    | 306.374 us                | 1.483 ms                  |
| AfterBackward             | 56.329 ms                 | 109.789 ms                |
| BlockToStepN              | 210.968 ms                | 305.545 ms                |
| OneStep                   | 272.123 ms                | 474.738 ms                |
| E2E-100                   | 26.939 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 239 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
========== Step 240 ========== 
W20240128 02:02:10.489149 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=241, pq.top=241
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
========== Step 241 ========== 
W20240128 02:02:10.607591 3953318 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240128 02:02:10.754015 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=2271
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 242 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 243 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
========== Step 244 ========== 
W20240128 02:02:11.489365 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=245, pq.top=244
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
========== Step 245 ========== 
W20240128 02:02:11.644726 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240128 02:02:11.754017 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=1379
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 246 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
========== Step 247 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.558 ms                 | 64.265 ms                 |
| ProcessBack:UpdateCache   | 873.196 us                | 7.563 ms                  |
| ProcessBack:UpsertPq      | 37.382 ms                 | 52.319 ms                 |
| ProcessOneStep            | 55.946 ms                 | 109.751 ms                |
| BlockToStepN              | 211.150 ms                | 305.435 ms                |
+---------------------------+---------------------------+---------------------------+
W20240128 02:02:12.489307 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=247
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
========== Step 248 ========== 
W20240128 02:02:12.654606 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240128 02:02:12.754005 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=556808
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 249 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 250 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
========== Step 251 ========== 
W20240128 02:02:13.489146 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=252, pq.top=252
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
========== Step 252 ========== 
W20240128 02:02:13.677357 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240128 02:02:13.754011 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=558688
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 253 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 254 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
========== Step 255 ========== 
W20240128 02:02:14.582414 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=256, pq.top=255
E20240128 02:02:14.764672 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=578920
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
========== Step 256 ========== 
W20240128 02:02:14.818848 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.339 us                | 168.700 us                |
| GenInput                  | 570.504 us                | 1.329 ms                  |
| NN                        | 498.650 us                | 1.138 ms                  |
| Forward                   | 705.697 us                | 1.782 ms                  |
| Backward                  | 1.836 ms                  | 3.303 ms                  |
| Optimize                  | 185.231 us                | 480.495 us                |
| BarrierTimeBeforeRank0    | 414.025 us                | 1.411 ms                  |
| AfterBackward             | 55.844 ms                 | 108.035 ms                |
| BlockToStepN              | 210.968 ms                | 266.026 ms                |
| OneStep                   | 272.123 ms                | 425.185 ms                |
| E2E-100                   | 26.939 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 257 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
========== Step 258 ========== 
W20240128 02:02:15.582101 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=259, pq.top=259
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
========== Step 259 ========== 
E20240128 02:02:15.764014 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=575110
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
========== Step 260 ========== 
W20240128 02:02:15.900768 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 261 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
========== Step 262 ========== 
W20240128 02:02:16.582338 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=263, pq.top=262
E20240128 02:02:16.764055 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=583095
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 263 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
========== Step 264 ========== 
W20240128 02:02:17.052659 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
========== Step 265 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 17.181 ms                 | 64.163 ms                 |
| ProcessBack:UpdateCache   | 873.196 us                | 7.386 ms                  |
| ProcessBack:UpsertPq      | 37.333 ms                 | 51.464 ms                 |
| ProcessOneStep            | 55.259 ms                 | 107.980 ms                |
| BlockToStepN              | 211.492 ms                | 265.946 ms                |
+---------------------------+---------------------------+---------------------------+
W20240128 02:02:17.582252 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=266, pq.top=266
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
========== Step 266 ========== 
E20240128 02:02:17.764016 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=615413
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 267 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
========== Step 268 ========== 
W20240128 02:02:18.245489 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
========== Step 269 ========== 
W20240128 02:02:18.608837 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=270, pq.top=269
E20240128 02:02:18.764997 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=624816
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 270 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 271 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
========== Step 272 ========== 
W20240128 02:02:19.322588 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
========== Step 273 ========== 
W20240128 02:02:19.634188 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=274, pq.top=273
E20240128 02:02:19.770857 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=621245
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
========== Step 274 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.371 us                | 168.700 us                |
| GenInput                  | 573.077 us                | 1.329 ms                  |
| NN                        | 498.650 us                | 1.138 ms                  |
| Forward                   | 704.736 us                | 1.782 ms                  |
| Backward                  | 1.835 ms                  | 3.303 ms                  |
| Optimize                  | 185.530 us                | 480.495 us                |
| BarrierTimeBeforeRank0    | 463.850 us                | 1.483 ms                  |
| AfterBackward             | 54.951 ms                 | 108.035 ms                |
| BlockToStepN              | 210.968 ms                | 266.026 ms                |
| OneStep                   | 272.445 ms                | 425.185 ms                |
| E2E-100                   | 26.939 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 275 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
========== Step 276 ========== 
W20240128 02:02:20.404873 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 276 ========== 
W20240128 02:02:20.634294 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=276
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
========== Step 277 ========== 
E20240128 02:02:20.770009 3952981 parallel_pq_v2.h:76] insert failed, size(hashtable)=995
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 278 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 279 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
========== Step 280 ========== 
W20240128 02:02:21.506860 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240128 02:02:21.634297 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=281
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
========== Step 281 ========== 
E20240128 02:02:21.770009 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=651234
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 282 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
========== Step 283 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 17.007 ms                 | 64.163 ms                 |
| ProcessBack:UpdateCache   | 875.267 us                | 7.386 ms                  |
| ProcessBack:UpsertPq      | 37.179 ms                 | 51.464 ms                 |
| ProcessOneStep            | 54.793 ms                 | 107.980 ms                |
| BlockToStepN              | 210.795 ms                | 265.946 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
========== Step 284 ========== 
W20240128 02:02:22.585562 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240128 02:02:22.642958 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=285, pq.top=284
E20240128 02:02:22.772889 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=659317
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 285 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 286 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
========== Step 287 ========== 
W20240128 02:02:23.642010 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=288, pq.top=288
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
========== Step 288 ========== 
W20240128 02:02:23.650483 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240128 02:02:23.773523 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=667535
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 289 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 290 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
========== Step 291 ========== 
W20240128 02:02:24.642390 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=292, pq.top=291
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
========== Step 292 ========== 
W20240128 02:02:24.759722 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240128 02:02:24.773011 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=689590
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.636 us                | 184.031 us                |
| GenInput                  | 574.380 us                | 1.329 ms                  |
| NN                        | 499.430 us                | 1.263 ms                  |
| Forward                   | 706.192 us                | 1.923 ms                  |
| Backward                  | 1.829 ms                  | 3.303 ms                  |
| Optimize                  | 185.104 us                | 480.495 us                |
| BarrierTimeBeforeRank0    | 414.025 us                | 1.483 ms                  |
| AfterBackward             | 54.545 ms                 | 108.035 ms                |
| BlockToStepN              | 210.968 ms                | 266.026 ms                |
| OneStep                   | 272.445 ms                | 425.185 ms                |
| E2E-100                   | 26.939 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 293 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
========== Step 294 ========== 
W20240128 02:02:25.642254 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=295, pq.top=295
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
========== Step 295 ========== 
W20240128 02:02:25.771389 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240128 02:02:25.773005 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=700808
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 296 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 297 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
========== Step 298 ========== 
W20240128 02:02:26.642107 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=299, pq.top=298
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
========== Step 299 ========== 
E20240128 02:02:26.773010 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=708809
W20240128 02:02:26.773054 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
Step299:rank1, time: 28.052, per_step: 0.277738
Step299:rank2, time: 28.052, per_step: 0.277739
Step299:rank0, time: 28.052, per_step: 0.277738
Step299:rank3, time: 28.052, per_step: 0.277739
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 300 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
========== Step 301 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 16.719 ms                 | 64.163 ms                 |
| ProcessBack:UpdateCache   | 876.477 us                | 7.386 ms                  |
| ProcessBack:UpsertPq      | 37.258 ms                 | 52.319 ms                 |
| ProcessOneStep            | 54.782 ms                 | 107.980 ms                |
| BlockToStepN              | 210.549 ms                | 265.946 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
========== Step 302 ========== 
W20240128 02:02:27.642086 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=303, pq.top=302
E20240128 02:02:27.773360 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=718132
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
========== Step 303 ========== 
W20240128 02:02:27.836079 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 304 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
========== Step 305 ========== 
W20240128 02:02:28.642055 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=306, pq.top=306
E20240128 02:02:28.778419 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=2933
W20240128 02:02:29.642248 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=306, pq.top=306
E20240128 02:02:29.778636 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=7812
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.539 us                | 184.031 us                |
| GenInput                  | 577.009 us                | 1.329 ms                  |
| NN                        | 500.437 us                | 1.263 ms                  |
| Forward                   | 708.407 us                | 1.923 ms                  |
| Backward                  | 1.829 ms                  | 3.303 ms                  |
| Optimize                  | 184.914 us                | 480.495 us                |
| BarrierTimeBeforeRank0    | 474.089 us                | 1.483 ms                  |
| AfterBackward             | 54.951 ms                 | 108.035 ms                |
| BlockToStepN              | 210.534 ms                | 266.026 ms                |
| OneStep                   | 272.893 ms                | 425.185 ms                |
| E2E-100                   | 28.052 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
W20240128 02:02:30.642387 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=306, pq.top=306
E20240128 02:02:30.834234 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=12086
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
========== Step 306 ========== 
W20240128 02:02:30.864198 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
========== Step 307 ========== 
W20240128 02:02:31.642226 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=308, pq.top=307
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
========== Step 308 ========== 
E20240128 02:02:31.834021 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=11836
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
========== Step 309 ========== 
W20240128 02:02:31.983598 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
========== Step 310 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 17.031 ms                 | 64.163 ms                 |
| ProcessBack:UpdateCache   | 876.477 us                | 7.386 ms                  |
| ProcessBack:UpsertPq      | 37.333 ms                 | 52.319 ms                 |
| ProcessOneStep            | 54.987 ms                 | 107.980 ms                |
| BlockToStepN              | 210.452 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
========== Step 311 ========== 
W20240128 02:02:32.642048 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=312, pq.top=311
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
========== Step 312 ========== 
E20240128 02:02:32.834012 3952762 parallel_pq_v2.h:76] insert failed, size(hashtable)=1386
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
========== Step 313 ========== 
W20240128 02:02:33.083436 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
========== Step 314 ========== 
W20240128 02:02:33.642325 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=315, pq.top=315
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
========== Step 315 ========== 
E20240128 02:02:33.834059 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=44472
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 316 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
========== Step 317 ========== 
W20240128 02:02:34.258567 3953318 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
========== Step 318 ========== 
W20240128 02:02:34.677101 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=319, pq.top=318
E20240128 02:02:34.837227 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=5336
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
========== Step 319 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.755 us                | 201.449 us                |
| GenInput                  | 579.263 us                | 1.431 ms                  |
| NN                        | 501.803 us                | 1.263 ms                  |
| Forward                   | 709.760 us                | 1.923 ms                  |
| Backward                  | 1.823 ms                  | 3.303 ms                  |
| Optimize                  | 185.231 us                | 480.495 us                |
| BarrierTimeBeforeRank0    | 474.089 us                | 1.483 ms                  |
| AfterBackward             | 55.034 ms                 | 108.035 ms                |
| BlockToStepN              | 210.968 ms                | 371.284 ms                |
| OneStep                   | 273.313 ms                | 569.924 ms                |
| E2E-100                   | 28.052 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
========== Step 320 ========== 
W20240128 02:02:35.269191 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
========== Step 321 ========== 
W20240128 02:02:35.677372 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=322, pq.top=322
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
========== Step 322 ========== 
E20240128 02:02:35.837077 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=1899
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 323 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
========== Step 324 ========== 
W20240128 02:02:36.321480 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
========== Step 325 ========== 
W20240128 02:02:36.677011 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=326, pq.top=326
E20240128 02:02:36.842079 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=20248
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 326 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 327 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
========== Step 328 ========== 
W20240128 02:02:37.433256 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 17.755 ms                 | 64.163 ms                 |
| ProcessBack:UpdateCache   | 878.088 us                | 7.386 ms                  |
| ProcessBack:UpsertPq      | 37.183 ms                 | 52.319 ms                 |
| ProcessOneStep            | 55.649 ms                 | 107.980 ms                |
| BlockToStepN              | 210.029 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
========== Step 329 ========== 
W20240128 02:02:37.763696 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=330, pq.top=329
E20240128 02:02:37.842018 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=1059
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 330 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 331 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
========== Step 332 ========== 
W20240128 02:02:38.529423 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240128 02:02:38.763016 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=333, pq.top=333
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
========== Step 333 ========== 
E20240128 02:02:38.842005 3952762 parallel_pq_v2.h:76] insert failed, size(hashtable)=2336
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 334 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 335 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
========== Step 336 ========== 
W20240128 02:02:39.637260 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240128 02:02:39.763200 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=337, pq.top=336
E20240128 02:02:39.842242 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=2674
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
========== Step 337 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.339 us                | 201.449 us                |
| GenInput                  | 582.073 us                | 1.431 ms                  |
| NN                        | 500.437 us                | 1.263 ms                  |
| Forward                   | 709.041 us                | 1.923 ms                  |
| Backward                  | 1.826 ms                  | 3.303 ms                  |
| Optimize                  | 185.182 us                | 480.495 us                |
| BarrierTimeBeforeRank0    | 555.615 us                | 1.525 ms                  |
| AfterBackward             | 55.844 ms                 | 109.789 ms                |
| BlockToStepN              | 210.083 ms                | 371.284 ms                |
| OneStep                   | 273.605 ms                | 569.924 ms                |
| E2E-100                   | 28.052 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 338 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
========== Step 339 ========== 
W20240128 02:02:40.645017 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240128 02:02:40.763127 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=340, pq.top=340
E20240128 02:02:40.842018 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=26159
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 340 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 341 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
========== Step 342 ========== 
W20240128 02:02:41.672444 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240128 02:02:41.763468 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
E20240128 02:02:41.853157 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=45155
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 343 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
========== Step 344 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 18.558 ms                 | 64.163 ms                 |
| ProcessBack:UpdateCache   | 881.450 us                | 7.386 ms                  |
| ProcessBack:UpsertPq      | 37.179 ms                 | 54.224 ms                 |
| ProcessOneStep            | 56.304 ms                 | 109.751 ms                |
| BlockToStepN              | 210.189 ms                | 371.172 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
========== Step 345 ========== 
W20240128 02:02:42.763558 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=346, pq.top=346
E20240128 02:02:42.858000 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=6966
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
========== Step 346 ========== 
W20240128 02:02:42.904006 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 347 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
========== Step 348 ========== 
W20240128 02:02:43.763301 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=349, pq.top=349
E20240128 02:02:43.860934 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=28231
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
========== Step 349 ========== 
W20240128 02:02:43.942982 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 350 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
========== Step 351 ========== 
W20240128 02:02:44.763263 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=352, pq.top=352
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
========== Step 352 ========== 
E20240128 02:02:44.860013 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=9408
W20240128 02:02:44.961486 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.089 us                | 184.031 us                |
| GenInput                  | 582.919 us                | 1.329 ms                  |
| NN                        | 500.286 us                | 1.221 ms                  |
| Forward                   | 709.016 us                | 1.782 ms                  |
| Backward                  | 1.829 ms                  | 3.282 ms                  |
| Optimize                  | 184.914 us                | 471.821 us                |
| BarrierTimeBeforeRank0    | 644.327 us                | 1.512 ms                  |
| AfterBackward             | 56.736 ms                 | 109.789 ms                |
| BlockToStepN              | 210.616 ms                | 312.941 ms                |
| OneStep                   | 274.375 ms                | 474.738 ms                |
| E2E-100                   | 28.052 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 353 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 354 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
========== Step 355 ========== 
E20240128 02:02:45.860011 3952985 parallel_pq_v2.h:76] insert failed, size(hashtable)=321
W20240128 02:02:45.867161 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=356, pq.top=355
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
========== Step 356 ========== 
W20240128 02:02:46.066421 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 357 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
========== Step 358 ========== 
E20240128 02:02:46.860019 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=3084
W20240128 02:02:46.867609 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=359, pq.top=359
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
========== Step 359 ========== 
W20240128 02:02:47.082588 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
========== Step 360 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.364 ms                 | 61.815 ms                 |
| ProcessBack:UpdateCache   | 887.161 us                | 6.696 ms                  |
| ProcessBack:UpsertPq      | 37.144 ms                 | 54.224 ms                 |
| ProcessOneStep            | 56.842 ms                 | 109.751 ms                |
| BlockToStepN              | 210.189 ms                | 312.845 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 361 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
========== Step 362 ========== 
E20240128 02:02:47.860013 3952985 parallel_pq_v2.h:76] insert failed, size(hashtable)=633
W20240128 02:02:47.891808 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=362
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
========== Step 363 ========== 
W20240128 02:02:48.101612 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 364 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
========== Step 365 ========== 
E20240128 02:02:48.863291 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=16700
W20240128 02:02:48.891265 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=366, pq.top=366
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 366 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
========== Step 367 ========== 
W20240128 02:02:49.222527 3953318 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 368 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
========== Step 369 ========== 
E20240128 02:02:49.863031 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=37507
W20240128 02:02:49.891526 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=370, pq.top=369
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
========== Step 370 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 107.082 us                | 184.031 us                |
| GenInput                  | 587.984 us                | 1.329 ms                  |
| NN                        | 501.180 us                | 1.221 ms                  |
| Forward                   | 709.414 us                | 1.782 ms                  |
| Backward                  | 1.839 ms                  | 3.291 ms                  |
| Optimize                  | 185.104 us                | 471.821 us                |
| BarrierTimeBeforeRank0    | 656.064 us                | 1.512 ms                  |
| AfterBackward             | 56.736 ms                 | 110.180 ms                |
| BlockToStepN              | 210.128 ms                | 312.941 ms                |
| OneStep                   | 274.846 ms                | 474.738 ms                |
| E2E-100                   | 28.052 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
========== Step 371 ========== 
W20240128 02:02:50.261075 3953318 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 372 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
========== Step 373 ========== 
E20240128 02:02:50.863160 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
W20240128 02:02:50.911547 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=374, pq.top=373
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 374 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
========== Step 375 ========== 
W20240128 02:02:51.392014 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
========== Step 376 ========== 
E20240128 02:02:51.874929 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=80782
W20240128 02:02:51.911640 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=377, pq.top=377
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 377 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
========== Step 378 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 19.483 ms                 | 61.815 ms                 |
| ProcessBack:UpdateCache   | 887.992 us                | 6.696 ms                  |
| ProcessBack:UpsertPq      | 37.167 ms                 | 54.224 ms                 |
| ProcessOneStep            | 56.856 ms                 | 110.137 ms                |
| BlockToStepN              | 209.600 ms                | 312.845 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
========== Step 379 ========== 
W20240128 02:02:52.565157 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
========== Step 380 ========== 
E20240128 02:02:52.874053 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=98741
W20240128 02:02:52.958472 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=381, pq.top=380
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 381 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
========== Step 382 ========== 
W20240128 02:02:53.602391 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240128 02:02:53.877192 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=5322
W20240128 02:02:53.958447 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=383, pq.top=383
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 383 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 384 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
========== Step 385 ========== 
W20240128 02:02:54.621104 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
========== Step 386 ========== 
E20240128 02:02:54.877305 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240128 02:02:54.958489 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=387, pq.top=386
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 106.185 us                | 184.031 us                |
| GenInput                  | 590.694 us                | 1.431 ms                  |
| NN                        | 501.626 us                | 1.221 ms                  |
| Forward                   | 709.773 us                | 1.782 ms                  |
| Backward                  | 1.835 ms                  | 3.291 ms                  |
| Optimize                  | 184.781 us                | 471.821 us                |
| BarrierTimeBeforeRank0    | 647.495 us                | 1.512 ms                  |
| AfterBackward             | 57.093 ms                 | 110.180 ms                |
| BlockToStepN              | 209.587 ms                | 345.652 ms                |
| OneStep                   | 276.378 ms                | 474.738 ms                |
| E2E-100                   | 28.052 s                  | 30.577 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 387 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 388 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
========== Step 389 ========== 
W20240128 02:02:55.748003 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240128 02:02:55.877034 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=23480
W20240128 02:02:55.958256 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=390, pq.top=390
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 390 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 391 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 392 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
========== Step 393 ========== 
W20240128 02:02:56.847983 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240128 02:02:56.877013 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=53538
W20240128 02:02:56.958323 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=394, pq.top=393
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 394 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
========== Step 395 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 20.293 ms                 | 61.815 ms                 |
| ProcessBack:UpdateCache   | 892.165 us                | 6.696 ms                  |
| ProcessBack:UpsertPq      | 37.167 ms                 | 54.224 ms                 |
| ProcessOneStep            | 57.832 ms                 | 110.137 ms                |
| BlockToStepN              | 209.313 ms                | 345.557 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
========== Step 396 ========== 
W20240128 02:02:57.867669 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240128 02:02:57.877010 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=8228
W20240128 02:02:57.958472 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=397, pq.top=397
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 397 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 398 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
========== Step 399 ========== 
Step399:rank1, time: 31.828, per_step: 0.315125
Step399:rank2, time: 31.828, per_step: 0.315125
Step399:rank0, time: 31.828, per_step: 0.315125
Step399:rank3, time: 31.828, per_step: 0.315125
========== Step 400 ========== 
========== Step 400 ========== 
========== Step 400 ========== 
========== Step 400 ========== 
E20240128 02:02:58.877010 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=32053
W20240128 02:02:58.877266 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240128 02:02:58.958485 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=401, pq.top=400
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 401 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 402 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
========== Step 403 ========== 
E20240128 02:02:59.877107 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=49309
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
========== Step 404 ========== 
W20240128 02:02:59.947942 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240128 02:03:00.002054 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=405, pq.top=404
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 105.468 us                | 184.031 us                |
| GenInput                  | 593.119 us                | 1.515 ms                  |
| NN                        | 501.626 us                | 1.221 ms                  |
| Forward                   | 709.773 us                | 1.782 ms                  |
| Backward                  | 1.845 ms                  | 3.291 ms                  |
| Optimize                  | 184.279 us                | 471.821 us                |
| BarrierTimeBeforeRank0    | 547.441 us                | 1.512 ms                  |
| AfterBackward             | 57.157 ms                 | 110.180 ms                |
| BlockToStepN              | 209.352 ms                | 345.652 ms                |
| OneStep                   | 276.523 ms                | 474.738 ms                |
| E2E-100                   | 28.052 s                  | 31.828 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 405 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 406 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
========== Step 407 ========== 
E20240128 02:03:00.877012 3952985 parallel_pq_v2.h:76] insert failed, size(hashtable)=2123
W20240128 02:03:01.002497 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=408, pq.top=408
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
========== Step 408 ========== 
W20240128 02:03:01.083539 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 409 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
========== Step 410 ========== 
E20240128 02:03:01.888106 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=89293
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
========== Step 411 ========== 
W20240128 02:03:02.071187 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=412, pq.top=411
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
========== Step 412 ========== 
W20240128 02:03:02.250491 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 20.639 ms                 | 61.815 ms                 |
| ProcessBack:UpdateCache   | 892.960 us                | 6.696 ms                  |
| ProcessBack:UpsertPq      | 37.183 ms                 | 54.224 ms                 |
| ProcessOneStep            | 58.002 ms                 | 110.137 ms                |
| BlockToStepN              | 208.840 ms                | 345.557 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 413 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
========== Step 414 ========== 
E20240128 02:03:02.888062 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=110194
W20240128 02:03:03.071585 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=415, pq.top=415
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 415 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
========== Step 416 ========== 
W20240128 02:03:03.417757 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
========== Step 417 ========== 
E20240128 02:03:03.894102 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=117486
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
========== Step 418 ========== 
W20240128 02:03:04.071126 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=419, pq.top=419
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 419 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
========== Step 420 ========== 
W20240128 02:03:04.505509 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
========== Step 421 ========== 
E20240128 02:03:04.894009 3952762 parallel_pq_v2.h:76] insert failed, size(hashtable)=4096
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 104.751 us                | 184.031 us                |
| GenInput                  | 594.390 us                | 1.515 ms                  |
| NN                        | 500.875 us                | 1.221 ms                  |
| Forward                   | 709.446 us                | 1.782 ms                  |
| Backward                  | 1.855 ms                  | 3.291 ms                  |
| Optimize                  | 183.413 us                | 471.821 us                |
| BarrierTimeBeforeRank0    | 436.330 us                | 1.512 ms                  |
| AfterBackward             | 58.763 ms                 | 110.180 ms                |
| BlockToStepN              | 208.503 ms                | 345.652 ms                |
| OneStep                   | 278.253 ms                | 474.738 ms                |
| E2E-100                   | 28.052 s                  | 31.828 s                  |
+---------------------------+---------------------------+---------------------------+
W20240128 02:03:05.071542 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=422, pq.top=422
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 422 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 423 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
========== Step 424 ========== 
W20240128 02:03:05.605387 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
========== Step 425 ========== 
E20240128 02:03:05.894039 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=136215
W20240128 02:03:06.071527 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=426, pq.top=426
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 426 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 427 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
========== Step 428 ========== 
W20240128 02:03:06.643832 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
E20240128 02:03:06.900748 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=160150
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
========== Step 429 ========== 
W20240128 02:03:07.071580 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=430, pq.top=430
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
========== Step 430 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 20.945 ms                 | 61.815 ms                 |
| ProcessBack:UpdateCache   | 896.001 us                | 6.696 ms                  |
| ProcessBack:UpsertPq      | 37.382 ms                 | 54.224 ms                 |
| ProcessOneStep            | 58.824 ms                 | 110.137 ms                |
| BlockToStepN              | 208.247 ms                | 345.557 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 431 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
========== Step 432 ========== 
W20240128 02:03:07.793026 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240128 02:03:07.900031 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=925
W20240128 02:03:08.071462 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=433, pq.top=433
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 433 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 434 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
========== Step 435 ========== 
W20240128 02:03:08.821910 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240128 02:03:08.901057 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=183121
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
========== Step 436 ========== 
W20240128 02:03:09.097864 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=437, pq.top=436
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 437 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 438 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
========== Step 439 ========== 
W20240128 02:03:09.834553 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240128 02:03:09.901048 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=189573
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 104.473 us                | 184.031 us                |
| GenInput                  | 596.108 us                | 1.515 ms                  |
| NN                        | 500.631 us                | 1.221 ms                  |
| Forward                   | 709.672 us                | 1.918 ms                  |
| Backward                  | 1.860 ms                  | 3.291 ms                  |
| Optimize                  | 182.934 us                | 480.495 us                |
| BarrierTimeBeforeRank0    | 463.850 us                | 1.512 ms                  |
| AfterBackward             | 59.028 ms                 | 110.180 ms                |
| BlockToStepN              | 208.293 ms                | 345.652 ms                |
| OneStep                   | 278.331 ms                | 474.738 ms                |
| E2E-100                   | 28.052 s                  | 31.828 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
========== Step 440 ========== 
W20240128 02:03:10.133152 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=441, pq.top=440
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 441 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
========== Step 442 ========== 
E20240128 02:03:10.901012 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=196841
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
========== Step 443 ========== 
W20240128 02:03:10.909909 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240128 02:03:11.133291 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=444, pq.top=444
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 444 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 445 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
========== Step 446 ========== 
E20240128 02:03:11.903568 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=220340
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
========== Step 447 ========== 
W20240128 02:03:12.061116 3953318 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240128 02:03:12.169880 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=448, pq.top=447
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
========== Step 448 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.213 ms                 | 61.815 ms                 |
| ProcessBack:UpdateCache   | 897.525 us                | 6.774 ms                  |
| ProcessBack:UpsertPq      | 37.504 ms                 | 54.224 ms                 |
| ProcessOneStep            | 59.000 ms                 | 110.137 ms                |
| BlockToStepN              | 208.202 ms                | 345.557 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
========== Step 449 ========== 
E20240128 02:03:12.905156 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=233545
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
========== Step 450 ========== 
W20240128 02:03:13.073120 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240128 02:03:13.169759 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=451
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 451 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 452 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
========== Step 453 ========== 
E20240128 02:03:13.905011 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=251037
W20240128 02:03:14.169122 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=454, pq.top=454
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
========== Step 454 ========== 
W20240128 02:03:14.176734 3953318 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 455 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
========== Step 456 ========== 
E20240128 02:03:14.905009 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=1355
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 104.563 us                | 168.700 us                |
| GenInput                  | 600.249 us                | 1.431 ms                  |
| NN                        | 501.547 us                | 1.188 ms                  |
| Forward                   | 709.946 us                | 1.782 ms                  |
| Backward                  | 1.878 ms                  | 3.282 ms                  |
| Optimize                  | 183.024 us                | 471.821 us                |
| BarrierTimeBeforeRank0    | 404.540 us                | 1.483 ms                  |
| AfterBackward             | 59.940 ms                 | 109.789 ms                |
| BlockToStepN              | 207.993 ms                | 312.941 ms                |
| OneStep                   | 279.961 ms                | 443.416 ms                |
| E2E-100                   | 28.052 s                  | 31.828 s                  |
+---------------------------+---------------------------+---------------------------+
W20240128 02:03:15.169389 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=457, pq.top=457
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
========== Step 457 ========== 
W20240128 02:03:15.764685 3953318 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240128 02:03:15.905092 3953318 parallel_pq_v2.h:76] insert failed, size(hashtable)=339
W20240128 02:03:16.169378 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=458, pq.top=457
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 458 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
========== Step 459 ========== 
E20240128 02:03:16.907406 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=3695
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
========== Step 460 ========== 
W20240128 02:03:16.929981 3953318 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240128 02:03:17.169039 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=461
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
========== Step 461 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 21.888 ms                 | 61.795 ms                 |
| ProcessBack:UpdateCache   | 900.798 us                | 6.774 ms                  |
| ProcessBack:UpsertPq      | 37.622 ms                 | 54.224 ms                 |
| ProcessOneStep            | 60.131 ms                 | 110.137 ms                |
| BlockToStepN              | 208.202 ms                | 345.557 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
========== Step 462 ========== 
E20240128 02:03:17.907907 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=24418
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
========== Step 463 ========== 
W20240128 02:03:17.968271 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240128 02:03:18.169147 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=464, pq.top=464
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 464 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
========== Step 465 ========== 
E20240128 02:03:18.908120 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=35608
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
========== Step 466 ========== 
W20240128 02:03:18.999563 3953318 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240128 02:03:19.169543 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=467, pq.top=467
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 467 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
========== Step 468 ========== 
E20240128 02:03:19.919380 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=56943
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
========== Step 469 ========== 
W20240128 02:03:20.039005 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 104.500 us                | 168.700 us                |
| GenInput                  | 602.136 us                | 1.625 ms                  |
| NN                        | 501.118 us                | 1.188 ms                  |
| Forward                   | 709.760 us                | 1.782 ms                  |
| Backward                  | 1.881 ms                  | 3.282 ms                  |
| Optimize                  | 183.413 us                | 471.821 us                |
| BarrierTimeBeforeRank0    | 413.685 us                | 1.512 ms                  |
| AfterBackward             | 60.720 ms                 | 110.180 ms                |
| BlockToStepN              | 208.477 ms                | 345.652 ms                |
| OneStep                   | 281.295 ms                | 476.499 ms                |
| E2E-100                   | 28.052 s                  | 31.828 s                  |
+---------------------------+---------------------------+---------------------------+
W20240128 02:03:20.169742 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=470, pq.top=470
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 470 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
========== Step 471 ========== 
E20240128 02:03:20.924506 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=68885
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
========== Step 472 ========== 
W20240128 02:03:21.063692 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240128 02:03:21.169412 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=472
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 473 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
========== Step 474 ========== 
E20240128 02:03:21.929913 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=80387
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
========== Step 475 ========== 
W20240128 02:03:22.096547 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240128 02:03:22.169669 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=476, pq.top=476
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
========== Step 476 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 23.198 ms                 | 61.795 ms                 |
| ProcessBack:UpdateCache   | 903.939 us                | 6.774 ms                  |
| ProcessBack:UpsertPq      | 37.755 ms                 | 54.224 ms                 |
| ProcessOneStep            | 61.226 ms                 | 110.137 ms                |
| BlockToStepN              | 208.449 ms                | 345.557 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
========== Step 477 ========== 
E20240128 02:03:22.930742 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=94450
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
========== Step 478 ========== 
W20240128 02:03:23.110327 3953318 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240128 02:03:23.169478 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=479, pq.top=478
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 479 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
========== Step 480 ========== 
E20240128 02:03:23.931566 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=105857
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
========== Step 481 ========== 
W20240128 02:03:24.169041 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=482, pq.top=482
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
========== Step 482 ========== 
W20240128 02:03:24.332700 3953318 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
========== Step 483 ========== 
E20240128 02:03:24.931247 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=117107
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
========== Step 484 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 104.473 us                | 168.700 us                |
| GenInput                  | 605.183 us                | 1.625 ms                  |
| NN                        | 500.875 us                | 1.188 ms                  |
| Forward                   | 709.560 us                | 1.782 ms                  |
| Backward                  | 1.882 ms                  | 3.291 ms                  |
| Optimize                  | 183.838 us                | 471.821 us                |
| BarrierTimeBeforeRank0    | 463.850 us                | 1.525 ms                  |
| AfterBackward             | 61.516 ms                 | 110.180 ms                |
| BlockToStepN              | 209.121 ms                | 345.652 ms                |
| OneStep                   | 281.842 ms                | 476.499 ms                |
| E2E-100                   | 28.052 s                  | 31.828 s                  |
+---------------------------+---------------------------+---------------------------+
W20240128 02:03:25.169193 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=485, pq.top=485
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
========== Step 485 ========== 
W20240128 02:03:25.354760 3953318 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 486 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
========== Step 487 ========== 
E20240128 02:03:25.931016 3952981 parallel_pq_v2.h:76] insert failed, size(hashtable)=4105
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
========== Step 488 ========== 
W20240128 02:03:26.219688 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=489, pq.top=488
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
========== Step 489 ========== 
W20240128 02:03:26.434062 3953318 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
========== Step 490 ========== 
E20240128 02:03:26.932500 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=133155
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
========== Step 491 ========== 
W20240128 02:03:27.219408 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=492, pq.top=492
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
========== Step 492 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 23.259 ms                 | 61.795 ms                 |
| ProcessBack:UpdateCache   | 903.996 us                | 6.774 ms                  |
| ProcessBack:UpsertPq      | 37.934 ms                 | 54.224 ms                 |
| ProcessOneStep            | 61.481 ms                 | 110.137 ms                |
| BlockToStepN              | 209.313 ms                | 345.557 ms                |
+---------------------------+---------------------------+---------------------------+
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
========== Step 493 ========== 
W20240128 02:03:27.618089 3953318 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
========== Step 494 ========== 
E20240128 02:03:27.932009 3952988 parallel_pq_v2.h:76] insert failed, size(hashtable)=3314
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
========== Step 495 ========== 
W20240128 02:03:28.219507 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=496, pq.top=495
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 496 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
========== Step 497 ========== 
W20240128 02:03:28.732288 3953318 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
E20240128 02:03:28.936002 3953317 parallel_pq_v2.h:76] insert failed, size(hashtable)=157523
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
========== Step 498 ========== 
W20240128 02:03:29.219627 3952762 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=499, pq.top=498
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
========== Step 499 ========== 
Step499:rank3, time: 30.795, per_step: 0.304905
Step499:rank0, time: 30.795, per_step: 0.304905
Step499:rank2, time: 30.795, per_step: 0.304905
Step499:rank1, time: 30.795, per_step: 0.304905
timer name is timer name is E2E-100E2E-100

[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
timer name is E2E-100
timer name is E2E-100
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 104.345 us                | 168.700 us                |
| GenInput                  | 606.840 us                | 1.625 ms                  |
| NN                        | 500.506 us                | 1.188 ms                  |
| Forward                   | 709.446 us                | 1.782 ms                  |
| Backward                  | 1.882 ms                  | 3.291 ms                  |
| Optimize                  | 184.279 us                | 471.821 us                |
| BarrierTimeBeforeRank0    | 467.677 us                | 1.633 ms                  |
| AfterBackward             | 61.467 ms                 | 110.180 ms                |
| BlockToStepN              | 209.440 ms                | 345.652 ms                |
| OneStep                   | 282.032 ms                | 476.499 ms                |
| E2E-100                   | 30.577 s                  | 31.828 s                  |
+---------------------------+---------------------------+---------------------------+
ERROR [3952762 PsKvstore.py:89] Delete tensor failed, not found
Successfully xmh
