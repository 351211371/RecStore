perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f1b746beee0>==========
Worker 0 pid=22971
Worker 1 pid=22972
Worker 2 pid=22973
Worker 3 pid=22974
Worker 4 pid=22975
Worker 5 pid=22976
Worker 6 pid=22977
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [distributed_c10d.py:466] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
Step99:rank3, time: 578.426, per_step: 5.784260
Step99:rank7, time: 579.703, per_step: 5.797029
Step99:rank6, time: 584.790, per_step: 5.847896
Step99:rank2, time: 594.453, per_step: 5.944530
Step99:rank0, time: 597.436, per_step: 5.974364
Step99:rank1, time: 601.745, per_step: 6.017453
Step99:rank5, time: 606.515, per_step: 6.065150
Step99:rank4, time: 627.633, per_step: 6.276334
Step199:rank3, time: 524.438, per_step: 5.192458
Step199:rank7, time: 590.846, per_step: 5.849961
Step199:rank4, time: 572.562, per_step: 5.668930
Step199:rank0, time: 606.945, per_step: 6.009359
Step199:rank2, time: 611.514, per_step: 6.054594
Step199:rank6, time: 621.262, per_step: 6.151114
Step199:rank1, time: 613.832, per_step: 6.077547
Step199:rank5, time: 624.887, per_step: 6.187002
Step299:rank3, time: 545.801, per_step: 5.403974
Step299:rank7, time: 586.991, per_step: 5.811793
Step299:rank0, time: 554.515, per_step: 5.490251
Step299:rank4, time: 561.923, per_step: 5.563591
Step299:rank1, time: 575.395, per_step: 5.696983
Step299:rank6, time: 588.630, per_step: 5.828023
Step299:rank2, time: 596.199, per_step: 5.902958
Step299:rank5, time: 570.940, per_step: 5.652866
Step399:rank3, time: 583.896, per_step: 5.781147
Step399:rank0, time: 543.200, per_step: 5.378221
Step399:rank4, time: 556.847, per_step: 5.513337
Step399:rank7, time: 570.150, per_step: 5.645046
Step399:rank6, time: 551.382, per_step: 5.459230
Step399:rank2, time: 566.682, per_step: 5.610709
Step399:rank1, time: 607.080, per_step: 6.010688
Step399:rank5, time: 607.551, per_step: 6.015354
Step499:rank3, time: 564.666, per_step: 5.590752
Step499:rank0, time: 552.295, per_step: 5.468269
Step499:rank4, time: 550.541, per_step: 5.450900
Step499:rank6, time: 535.162, per_step: 5.298634
Step499:rank7, time: 556.303, per_step: 5.507950
Step499:rank1, time: 508.796, per_step: 5.037583
Step499:rank2, time: 543.064, per_step: 5.376875
Step499:rank5, time: 520.975, per_step: 5.158166
Worker 7 pid=22978
Successfully xmh
