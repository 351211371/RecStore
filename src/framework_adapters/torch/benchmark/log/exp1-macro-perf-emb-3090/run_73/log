perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f842cb47e50>==========
Worker 0 pid=48966
Worker 1 pid=48967
Worker 2 pid=48968
Worker 3 pid=48969
Worker 4 pid=48970
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<10:40,  1.56it/s]  0%|          | 1/1000 [00:00<09:46,  1.70it/s]  0%|          | 1/1000 [00:00<09:52,  1.68it/s]  0%|          | 1/1000 [00:00<11:57,  1.39it/s]  0%|          | 1/1000 [00:00<09:08,  1.82it/s]  0%|          | 1/1000 [00:00<09:49,  1.69it/s]  1%|          | 9/1000 [00:00<01:02, 15.82it/s]  1%|          | 10/1000 [00:00<01:02, 15.87it/s]  1%|          | 10/1000 [00:00<00:52, 18.71it/s]  1%|          | 10/1000 [00:00<00:53, 18.66it/s]  1%|          | 10/1000 [00:00<00:50, 19.68it/s]  1%|          | 10/1000 [00:00<00:53, 18.50it/s]  2%|▏         | 21/1000 [00:00<00:26, 36.86it/s]  2%|▏         | 22/1000 [00:00<00:27, 35.24it/s]  2%|▏         | 22/1000 [00:00<00:24, 40.05it/s]  2%|▏         | 22/1000 [00:00<00:24, 40.11it/s]  2%|▏         | 22/1000 [00:00<00:24, 39.77it/s]  2%|▏         | 22/1000 [00:00<00:23, 41.69it/s]  3%|▎         | 34/1000 [00:00<00:16, 57.41it/s]  4%|▎         | 35/1000 [00:00<00:15, 60.71it/s]  4%|▎         | 35/1000 [00:01<00:17, 54.88it/s]  4%|▎         | 35/1000 [00:00<00:15, 62.53it/s]  4%|▎         | 35/1000 [00:00<00:16, 60.31it/s]  4%|▎         | 35/1000 [00:00<00:15, 60.62it/s]  5%|▍         | 46/1000 [00:01<00:13, 72.17it/s]  5%|▍         | 47/1000 [00:01<00:13, 69.65it/s]  5%|▍         | 47/1000 [00:01<00:12, 75.14it/s]  5%|▍         | 47/1000 [00:01<00:12, 75.06it/s]  5%|▍         | 47/1000 [00:01<00:12, 74.77it/s]  5%|▍         | 47/1000 [00:00<00:12, 76.80it/s]  6%|▋         | 63/1000 [00:01<00:09, 96.01it/s]  6%|▋         | 64/1000 [00:01<00:10, 93.15it/s]  6%|▋         | 64/1000 [00:01<00:09, 98.45it/s]  6%|▋         | 64/1000 [00:01<00:09, 98.49it/s]  6%|▋         | 64/1000 [00:01<00:09, 98.15it/s]  6%|▋         | 64/1000 [00:01<00:09, 100.07it/s]  8%|▊         | 80/1000 [00:01<00:08, 114.14it/s]  8%|▊         | 81/1000 [00:01<00:07, 116.43it/s]  8%|▊         | 81/1000 [00:01<00:07, 116.48it/s]  8%|▊         | 81/1000 [00:01<00:07, 116.18it/s]  8%|▊         | 81/1000 [00:01<00:07, 117.82it/s]  8%|▊         | 81/1000 [00:01<00:08, 111.74it/s] 10%|▉         | 97/1000 [00:01<00:07, 128.43it/s] 10%|▉         | 98/1000 [00:01<00:07, 126.55it/s] 10%|▉         | 98/1000 [00:01<00:06, 130.31it/s] 10%|▉         | 98/1000 [00:01<00:06, 130.24it/s] 10%|▉         | 98/1000 [00:01<00:06, 131.37it/s] 10%|▉         | 98/1000 [00:01<00:06, 130.04it/s]Step99:rank0, time: 1.482, per_step: 0.014816
Step99:rank5, time: 1.347, per_step: 0.013472
Step99:rank1, time: 1.370, per_step: 0.013699
Step99:rank2, time: 1.304, per_step: 0.013037
Step99:rank4, time: 1.344, per_step: 0.013436
Step99:rank3, time: 1.401, per_step: 0.014007
 11%|█         | 112/1000 [00:01<00:06, 130.77it/s] 11%|█▏        | 113/1000 [00:01<00:06, 129.46it/s] 11%|█▏        | 113/1000 [00:01<00:06, 132.15it/s] 11%|█▏        | 113/1000 [00:01<00:06, 132.10it/s] 11%|█▏        | 113/1000 [00:01<00:06, 132.90it/s] 11%|█▏        | 113/1000 [00:01<00:06, 131.95it/s] 13%|█▎        | 130/1000 [00:01<00:06, 142.41it/s] 13%|█▎        | 131/1000 [00:01<00:06, 141.41it/s] 13%|█▎        | 131/1000 [00:01<00:06, 143.45it/s] 13%|█▎        | 131/1000 [00:01<00:06, 143.47it/s] 13%|█▎        | 131/1000 [00:01<00:06, 144.08it/s] 13%|█▎        | 131/1000 [00:01<00:06, 143.34it/s] 15%|█▍        | 148/1000 [00:01<00:05, 150.85it/s] 15%|█▍        | 149/1000 [00:01<00:05, 150.09it/s] 15%|█▍        | 149/1000 [00:01<00:05, 151.64it/s] 15%|█▍        | 149/1000 [00:01<00:05, 151.57it/s] 15%|█▍        | 149/1000 [00:01<00:05, 151.61it/s] 15%|█▍        | 149/1000 [00:01<00:05, 152.08it/s] 17%|█▋        | 166/1000 [00:01<00:05, 154.55it/s] 17%|█▋        | 166/1000 [00:01<00:05, 155.73it/s] 17%|█▋        | 166/1000 [00:01<00:05, 155.72it/s] 17%|█▋        | 166/1000 [00:01<00:05, 155.43it/s] 17%|█▋        | 166/1000 [00:01<00:05, 155.62it/s] 17%|█▋        | 166/1000 [00:01<00:05, 156.00it/s] 18%|█▊        | 183/1000 [00:01<00:05, 151.56it/s] 18%|█▊        | 183/1000 [00:01<00:05, 152.35it/s] 18%|█▊        | 183/1000 [00:01<00:05, 152.30it/s] 18%|█▊        | 183/1000 [00:01<00:05, 152.15it/s] 18%|█▊        | 183/1000 [00:01<00:05, 152.29it/s] 18%|█▊        | 183/1000 [00:01<00:05, 152.52it/s] 20%|█▉        | 199/1000 [00:02<00:05, 153.29it/s] 20%|█▉        | 199/1000 [00:01<00:05, 153.79it/s] 20%|█▉        | 199/1000 [00:01<00:05, 153.80it/s] 20%|█▉        | 199/1000 [00:01<00:05, 153.78it/s] 20%|█▉        | 199/1000 [00:02<00:05, 153.66it/s] 20%|█▉        | 199/1000 [00:01<00:05, 153.97it/s]Step199:rank0, time: 0.628, per_step: 0.006217
Step199:rank4, time: 0.628, per_step: 0.006215
Step199:rank5, time: 0.628, per_step: 0.006217
Step199:rank2, time: 0.628, per_step: 0.006216
Step199:rank3, time: 0.624, per_step: 0.006179
Step199:rank1, time: 0.628, per_step: 0.006218
 22%|██▏       | 216/1000 [00:02<00:04, 157.92it/s] 22%|██▏       | 216/1000 [00:02<00:04, 158.31it/s] 22%|██▏       | 216/1000 [00:02<00:04, 158.20it/s] 22%|██▏       | 216/1000 [00:02<00:04, 158.30it/s] 22%|██▏       | 216/1000 [00:02<00:04, 158.43it/s] 22%|██▏       | 216/1000 [00:02<00:04, 158.27it/s] 23%|██▎       | 234/1000 [00:02<00:04, 162.34it/s] 23%|██▎       | 234/1000 [00:02<00:04, 162.65it/s] 23%|██▎       | 234/1000 [00:02<00:04, 162.56it/s] 23%|██▎       | 234/1000 [00:02<00:04, 162.62it/s] 23%|██▎       | 234/1000 [00:02<00:04, 162.64it/s] 23%|██▎       | 234/1000 [00:02<00:04, 162.75it/s] 25%|██▌       | 251/1000 [00:02<00:04, 163.60it/s] 25%|██▌       | 251/1000 [00:02<00:04, 163.81it/s] 25%|██▌       | 251/1000 [00:02<00:04, 163.78it/s] 25%|██▌       | 251/1000 [00:02<00:04, 163.79it/s] 25%|██▌       | 251/1000 [00:02<00:04, 163.69it/s] 25%|██▌       | 251/1000 [00:02<00:04, 163.84it/s] 27%|██▋       | 268/1000 [00:02<00:04, 160.69it/s] 27%|██▋       | 268/1000 [00:02<00:04, 160.70it/s] 27%|██▋       | 268/1000 [00:02<00:04, 160.46it/s] 27%|██▋       | 268/1000 [00:02<00:04, 160.67it/s] 27%|██▋       | 268/1000 [00:02<00:04, 160.73it/s] 27%|██▋       | 268/1000 [00:02<00:04, 160.59it/s] 29%|██▊       | 287/1000 [00:02<00:04, 167.45it/s] 29%|██▊       | 287/1000 [00:02<00:04, 167.26it/s] 29%|██▊       | 287/1000 [00:02<00:04, 167.35it/s] 29%|██▊       | 287/1000 [00:02<00:04, 167.44it/s] 29%|██▊       | 287/1000 [00:02<00:04, 167.34it/s] 29%|██▊       | 287/1000 [00:02<00:04, 167.35it/s]Step299:rank5, time: 0.587, per_step: 0.005809
Step299:rank0, time: 0.587, per_step: 0.005811
Step299:rank3, time: 0.587, per_step: 0.005810
Step299:rank4, time: 0.587, per_step: 0.005811
Step299:rank2, time: 0.587, per_step: 0.005810
Step299:rank1, time: 0.587, per_step: 0.005810
 31%|███       | 306/1000 [00:02<00:04, 172.54it/s] 31%|███       | 306/1000 [00:02<00:04, 172.51it/s] 31%|███       | 306/1000 [00:02<00:04, 172.37it/s] 31%|███       | 306/1000 [00:02<00:04, 172.45it/s] 31%|███       | 306/1000 [00:02<00:04, 172.50it/s] 31%|███       | 306/1000 [00:02<00:04, 172.48it/s] 32%|███▎      | 325/1000 [00:02<00:03, 176.59it/s] 32%|███▎      | 325/1000 [00:02<00:03, 176.61it/s] 32%|███▎      | 325/1000 [00:02<00:03, 176.59it/s] 32%|███▎      | 325/1000 [00:02<00:03, 176.63it/s] 32%|███▎      | 325/1000 [00:02<00:03, 176.62it/s] 32%|███▎      | 325/1000 [00:02<00:03, 176.55it/s] 34%|███▍      | 344/1000 [00:02<00:03, 178.50it/s] 34%|███▍      | 344/1000 [00:02<00:03, 178.42it/s] 34%|███▍      | 344/1000 [00:02<00:03, 178.52it/s] 34%|███▍      | 344/1000 [00:02<00:03, 178.46it/s] 34%|███▍      | 344/1000 [00:02<00:03, 178.52it/s] 34%|███▍      | 344/1000 [00:02<00:03, 178.46it/s] 36%|███▌      | 362/1000 [00:03<00:03, 177.45it/s] 36%|███▌      | 362/1000 [00:02<00:03, 177.43it/s] 36%|███▌      | 362/1000 [00:02<00:03, 177.47it/s] 36%|███▌      | 362/1000 [00:02<00:03, 177.40it/s] 36%|███▌      | 362/1000 [00:02<00:03, 177.44it/s] 36%|███▌      | 362/1000 [00:02<00:03, 177.43it/s] 38%|███▊      | 382/1000 [00:02<00:03, 181.54it/s] 38%|███▊      | 382/1000 [00:02<00:03, 181.54it/s] 38%|███▊      | 382/1000 [00:03<00:03, 181.55it/s] 38%|███▊      | 382/1000 [00:03<00:03, 181.44it/s] 38%|███▊      | 382/1000 [00:03<00:03, 181.52it/s] 38%|███▊      | 382/1000 [00:02<00:03, 181.52it/s]Step399:rank0, time: 0.557, per_step: 0.005514
Step399:rank2, time: 0.557, per_step: 0.005514
Step399:rank5, time: 0.557, per_step: 0.005516
Step399:rank4, time: 0.557, per_step: 0.005516
Step399:rank1, time: 0.557, per_step: 0.005516
Step399:rank3, time: 0.557, per_step: 0.005517
 40%|████      | 401/1000 [00:03<00:03, 174.81it/s] 40%|████      | 401/1000 [00:03<00:03, 174.78it/s] 40%|████      | 401/1000 [00:03<00:03, 174.87it/s] 40%|████      | 401/1000 [00:03<00:03, 174.80it/s] 40%|████      | 401/1000 [00:03<00:03, 174.78it/s] 40%|████      | 401/1000 [00:03<00:03, 174.77it/s] 42%|████▏     | 419/1000 [00:03<00:03, 170.25it/s] 42%|████▏     | 419/1000 [00:03<00:03, 170.20it/s] 42%|████▏     | 419/1000 [00:03<00:03, 170.16it/s] 42%|████▏     | 419/1000 [00:03<00:03, 170.15it/s] 42%|████▏     | 419/1000 [00:03<00:03, 170.15it/s] 42%|████▏     | 419/1000 [00:03<00:03, 170.11it/s] 44%|████▍     | 438/1000 [00:03<00:03, 175.53it/s] 44%|████▍     | 438/1000 [00:03<00:03, 175.15it/s] 44%|████▍     | 439/1000 [00:03<00:03, 175.22it/s] 44%|████▍     | 439/1000 [00:03<00:03, 175.17it/s] 44%|████▍     | 439/1000 [00:03<00:03, 175.18it/s] 44%|████▍     | 439/1000 [00:03<00:03, 175.17it/s] 46%|████▌     | 456/1000 [00:03<00:03, 170.98it/s] 46%|████▌     | 456/1000 [00:03<00:03, 170.56it/s] 46%|████▌     | 457/1000 [00:03<00:03, 170.73it/s] 46%|████▌     | 457/1000 [00:03<00:03, 170.73it/s] 46%|████▌     | 457/1000 [00:03<00:03, 170.65it/s] 46%|████▌     | 457/1000 [00:03<00:03, 170.67it/s] 47%|████▋     | 474/1000 [00:03<00:03, 155.99it/s] 47%|████▋     | 474/1000 [00:03<00:03, 155.80it/s] 48%|████▊     | 475/1000 [00:03<00:03, 155.77it/s] 48%|████▊     | 475/1000 [00:03<00:03, 155.78it/s] 48%|████▊     | 475/1000 [00:03<00:03, 155.79it/s] 48%|████▊     | 475/1000 [00:03<00:03, 155.61it/s] 49%|████▉     | 491/1000 [00:03<00:03, 157.93it/s] 49%|████▉     | 491/1000 [00:03<00:03, 157.97it/s] 49%|████▉     | 492/1000 [00:03<00:03, 158.03it/s] 49%|████▉     | 492/1000 [00:03<00:03, 158.06it/s] 49%|████▉     | 492/1000 [00:03<00:03, 158.04it/s] 49%|████▉     | 492/1000 [00:03<00:03, 157.96it/s]Step499:rank0, time: 0.629, per_step: 0.006227
Step499:rank5, time: 0.629, per_step: 0.006226
Step499:rank4, time: 0.629, per_step: 0.006226
Step499:rank1, time: 0.629, per_step: 0.006226
Step499:rank3, time: 0.629, per_step: 0.006226
Step499:rank2, time: 0.629, per_step: 0.006231
 51%|█████     | 508/1000 [00:03<00:03, 159.47it/s] 51%|█████     | 508/1000 [00:03<00:03, 159.51it/s] 51%|█████     | 509/1000 [00:03<00:03, 159.60it/s] 51%|█████     | 509/1000 [00:03<00:03, 159.61it/s] 51%|█████     | 509/1000 [00:03<00:03, 159.59it/s] 51%|█████     | 509/1000 [00:03<00:03, 159.51it/s] 52%|█████▎    | 525/1000 [00:04<00:02, 161.25it/s] 52%|█████▎    | 525/1000 [00:03<00:02, 161.23it/s] 53%|█████▎    | 526/1000 [00:03<00:02, 158.69it/s] 53%|█████▎    | 526/1000 [00:03<00:02, 158.70it/s] 53%|█████▎    | 526/1000 [00:03<00:02, 158.67it/s] 53%|█████▎    | 526/1000 [00:03<00:02, 158.16it/s] 54%|█████▍    | 543/1000 [00:04<00:02, 164.08it/s] 54%|█████▍    | 543/1000 [00:04<00:02, 164.12it/s] 55%|█████▍    | 545/1000 [00:03<00:02, 166.15it/s] 55%|█████▍    | 545/1000 [00:04<00:02, 165.80it/s] 55%|█████▍    | 545/1000 [00:04<00:02, 165.82it/s] 55%|█████▍    | 545/1000 [00:04<00:02, 165.74it/s] 56%|█████▋    | 563/1000 [00:04<00:02, 173.35it/s] 56%|█████▋    | 563/1000 [00:04<00:02, 173.40it/s] 56%|█████▋    | 565/1000 [00:04<00:02, 174.44it/s] 56%|█████▋    | 565/1000 [00:04<00:02, 174.18it/s] 56%|█████▋    | 565/1000 [00:04<00:02, 174.17it/s] 56%|█████▋    | 565/1000 [00:04<00:02, 174.13it/s] 58%|█████▊    | 583/1000 [00:04<00:02, 180.59it/s] 58%|█████▊    | 583/1000 [00:04<00:02, 180.58it/s] 58%|█████▊    | 585/1000 [00:04<00:02, 181.65it/s] 58%|█████▊    | 585/1000 [00:04<00:02, 181.50it/s] 58%|█████▊    | 585/1000 [00:04<00:02, 181.46it/s] 58%|█████▊    | 585/1000 [00:04<00:02, 181.44it/s]Step599:rank0, time: 0.585, per_step: 0.005795
Step599:rank2, time: 0.585, per_step: 0.005790
Step599:rank5, time: 0.585, per_step: 0.005795
Step599:rank4, time: 0.585, per_step: 0.005795
Step599:rank1, time: 0.585, per_step: 0.005795
Step599:rank3, time: 0.585, per_step: 0.005795
 60%|██████    | 602/1000 [00:04<00:02, 166.39it/s] 60%|██████    | 602/1000 [00:04<00:02, 166.35it/s] 60%|██████    | 604/1000 [00:04<00:02, 167.23it/s] 60%|██████    | 604/1000 [00:04<00:02, 167.20it/s] 60%|██████    | 604/1000 [00:04<00:02, 167.20it/s] 60%|██████    | 604/1000 [00:04<00:02, 167.26it/s] 62%|██████▏   | 623/1000 [00:04<00:02, 177.48it/s] 62%|██████▏   | 623/1000 [00:04<00:02, 177.48it/s] 62%|██████▎   | 625/1000 [00:04<00:02, 178.07it/s] 62%|██████▎   | 625/1000 [00:04<00:02, 178.05it/s] 62%|██████▎   | 625/1000 [00:04<00:02, 178.03it/s] 62%|██████▎   | 625/1000 [00:04<00:02, 178.09it/s] 64%|██████▍   | 644/1000 [00:04<00:01, 185.22it/s] 64%|██████▍   | 644/1000 [00:04<00:01, 185.23it/s] 65%|██████▍   | 646/1000 [00:04<00:01, 185.55it/s] 65%|██████▍   | 646/1000 [00:04<00:01, 185.58it/s] 65%|██████▍   | 646/1000 [00:04<00:01, 185.49it/s] 65%|██████▍   | 646/1000 [00:04<00:01, 185.47it/s] 66%|██████▋   | 663/1000 [00:04<00:01, 181.01it/s] 66%|██████▋   | 663/1000 [00:04<00:01, 180.88it/s] 66%|██████▋   | 665/1000 [00:04<00:01, 181.29it/s] 66%|██████▋   | 665/1000 [00:04<00:01, 181.26it/s] 66%|██████▋   | 665/1000 [00:04<00:01, 181.24it/s] 66%|██████▋   | 665/1000 [00:04<00:01, 181.19it/s] 68%|██████▊   | 682/1000 [00:04<00:01, 175.54it/s] 68%|██████▊   | 682/1000 [00:04<00:01, 175.53it/s] 68%|██████▊   | 684/1000 [00:04<00:01, 175.04it/s] 68%|██████▊   | 684/1000 [00:04<00:01, 175.04it/s] 68%|██████▊   | 684/1000 [00:04<00:01, 175.05it/s] 68%|██████▊   | 684/1000 [00:04<00:01, 174.93it/s]Step699:rank0, time: 0.552, per_step: 0.005463
Step699:rank1, time: 0.552, per_step: 0.005463
 70%|███████   | 700/1000 [00:05<00:01, 171.85it/s]Step699:rank4, time: 0.552, per_step: 0.005464
Step699:rank3, time: 0.552, per_step: 0.005463
 70%|███████   | 700/1000 [00:04<00:01, 171.79it/s]Step699:rank2, time: 0.552, per_step: 0.005468
Step699:rank5, time: 0.552, per_step: 0.005469
 70%|███████   | 702/1000 [00:04<00:01, 171.29it/s] 70%|███████   | 702/1000 [00:04<00:01, 171.24it/s] 70%|███████   | 702/1000 [00:04<00:01, 171.23it/s] 70%|███████   | 702/1000 [00:04<00:01, 171.12it/s] 72%|███████▏  | 718/1000 [00:05<00:01, 170.94it/s] 72%|███████▏  | 718/1000 [00:05<00:01, 170.96it/s] 72%|███████▏  | 720/1000 [00:04<00:01, 170.91it/s] 72%|███████▏  | 720/1000 [00:04<00:01, 170.90it/s] 72%|███████▏  | 720/1000 [00:04<00:01, 170.88it/s] 72%|███████▏  | 720/1000 [00:04<00:01, 170.88it/s] 74%|███████▎  | 736/1000 [00:05<00:01, 164.26it/s] 74%|███████▎  | 736/1000 [00:05<00:01, 164.26it/s] 74%|███████▍  | 738/1000 [00:05<00:01, 162.37it/s] 74%|███████▍  | 738/1000 [00:05<00:01, 162.37it/s] 74%|███████▍  | 738/1000 [00:05<00:01, 161.90it/s] 74%|███████▍  | 738/1000 [00:05<00:01, 161.79it/s] 75%|███████▌  | 753/1000 [00:05<00:01, 156.64it/s] 75%|███████▌  | 753/1000 [00:05<00:01, 156.58it/s] 76%|███████▌  | 755/1000 [00:05<00:01, 157.00it/s] 76%|███████▌  | 755/1000 [00:05<00:01, 156.94it/s] 76%|███████▌  | 755/1000 [00:05<00:01, 157.19it/s] 76%|███████▌  | 755/1000 [00:05<00:01, 157.00it/s] 77%|███████▋  | 769/1000 [00:05<00:01, 152.42it/s] 77%|███████▋  | 769/1000 [00:05<00:01, 151.65it/s] 77%|███████▋  | 771/1000 [00:05<00:01, 149.64it/s] 77%|███████▋  | 771/1000 [00:05<00:01, 149.81it/s] 77%|███████▋  | 771/1000 [00:05<00:01, 149.57it/s] 77%|███████▋  | 771/1000 [00:05<00:01, 149.69it/s] 79%|███████▉  | 788/1000 [00:05<00:01, 160.66it/s] 79%|███████▉  | 788/1000 [00:05<00:01, 160.87it/s] 79%|███████▉  | 791/1000 [00:05<00:01, 162.96it/s] 79%|███████▉  | 791/1000 [00:05<00:01, 163.09it/s] 79%|███████▉  | 791/1000 [00:05<00:01, 162.91it/s] 79%|███████▉  | 791/1000 [00:05<00:01, 163.04it/s]Step799:rank0, time: 0.627, per_step: 0.006208
Step799:rank5, time: 0.626, per_step: 0.006203
Step799:rank1, time: 0.627, per_step: 0.006209
Step799:rank3, time: 0.627, per_step: 0.006208
Step799:rank4, time: 0.627, per_step: 0.006208
Step799:rank2, time: 0.627, per_step: 0.006206
 81%|████████  | 807/1000 [00:05<00:01, 168.40it/s] 81%|████████  | 807/1000 [00:05<00:01, 168.58it/s] 81%|████████  | 810/1000 [00:05<00:01, 170.10it/s] 81%|████████  | 810/1000 [00:05<00:01, 169.98it/s] 81%|████████  | 810/1000 [00:05<00:01, 169.94it/s] 81%|████████  | 810/1000 [00:05<00:01, 170.04it/s] 83%|████████▎ | 827/1000 [00:05<00:00, 173.81it/s] 83%|████████▎ | 827/1000 [00:05<00:00, 173.91it/s] 83%|████████▎ | 829/1000 [00:05<00:00, 174.65it/s] 83%|████████▎ | 829/1000 [00:05<00:00, 174.61it/s] 83%|████████▎ | 829/1000 [00:05<00:00, 174.66it/s] 83%|████████▎ | 829/1000 [00:05<00:00, 174.64it/s] 85%|████████▍ | 847/1000 [00:05<00:00, 179.37it/s] 85%|████████▍ | 847/1000 [00:05<00:00, 179.52it/s] 85%|████████▍ | 849/1000 [00:05<00:00, 180.14it/s] 85%|████████▍ | 849/1000 [00:05<00:00, 180.11it/s] 85%|████████▍ | 849/1000 [00:05<00:00, 180.17it/s] 85%|████████▍ | 849/1000 [00:05<00:00, 180.20it/s] 87%|████████▋ | 867/1000 [00:05<00:00, 184.56it/s] 87%|████████▋ | 867/1000 [00:05<00:00, 184.62it/s] 87%|████████▋ | 869/1000 [00:05<00:00, 185.07it/s] 87%|████████▋ | 869/1000 [00:05<00:00, 185.11it/s] 87%|████████▋ | 869/1000 [00:05<00:00, 185.06it/s] 87%|████████▋ | 869/1000 [00:05<00:00, 185.07it/s] 89%|████████▊ | 887/1000 [00:06<00:00, 185.22it/s] 89%|████████▊ | 887/1000 [00:06<00:00, 185.28it/s] 89%|████████▉ | 888/1000 [00:05<00:00, 185.29it/s] 89%|████████▉ | 888/1000 [00:05<00:00, 185.32it/s] 89%|████████▉ | 888/1000 [00:05<00:00, 185.29it/s] 89%|████████▉ | 888/1000 [00:05<00:00, 185.33it/s]Step899:rank0, time: 0.528, per_step: 0.005229
Step899:rank4, time: 0.528, per_step: 0.005229
Step899:rank5, time: 0.528, per_step: 0.005230
Step899:rank1, time: 0.528, per_step: 0.005229
Step899:rank2, time: 0.528, per_step: 0.005228
Step899:rank3, time: 0.528, per_step: 0.005230
 91%|█████████ | 907/1000 [00:06<00:00, 186.85it/s] 91%|█████████ | 907/1000 [00:06<00:00, 186.85it/s] 91%|█████████ | 908/1000 [00:06<00:00, 186.74it/s] 91%|█████████ | 908/1000 [00:06<00:00, 186.69it/s] 91%|█████████ | 908/1000 [00:06<00:00, 186.71it/s] 91%|█████████ | 908/1000 [00:06<00:00, 186.71it/s] 93%|█████████▎| 926/1000 [00:06<00:00, 186.42it/s] 93%|█████████▎| 926/1000 [00:06<00:00, 186.47it/s] 93%|█████████▎| 927/1000 [00:06<00:00, 186.54it/s] 93%|█████████▎| 927/1000 [00:06<00:00, 186.52it/s] 93%|█████████▎| 927/1000 [00:06<00:00, 186.51it/s] 93%|█████████▎| 927/1000 [00:06<00:00, 186.51it/s] 95%|█████████▍| 946/1000 [00:06<00:00, 189.47it/s] 95%|█████████▍| 946/1000 [00:06<00:00, 189.45it/s] 95%|█████████▍| 947/1000 [00:06<00:00, 189.40it/s] 95%|█████████▍| 947/1000 [00:06<00:00, 189.42it/s] 95%|█████████▍| 947/1000 [00:06<00:00, 189.38it/s] 95%|█████████▍| 947/1000 [00:06<00:00, 189.43it/s] 96%|█████████▋| 965/1000 [00:06<00:00, 187.32it/s] 96%|█████████▋| 965/1000 [00:06<00:00, 187.39it/s] 97%|█████████▋| 966/1000 [00:06<00:00, 186.88it/s] 97%|█████████▋| 966/1000 [00:06<00:00, 186.82it/s] 97%|█████████▋| 966/1000 [00:06<00:00, 186.86it/s] 97%|█████████▋| 966/1000 [00:06<00:00, 186.51it/s] 98%|█████████▊| 984/1000 [00:06<00:00, 185.11it/s] 98%|█████████▊| 984/1000 [00:06<00:00, 185.14it/s] 98%|█████████▊| 985/1000 [00:06<00:00, 185.24it/s] 98%|█████████▊| 985/1000 [00:06<00:00, 185.24it/s] 98%|█████████▊| 985/1000 [00:06<00:00, 185.22it/s] 98%|█████████▊| 985/1000 [00:06<00:00, 185.30it/s]Step999:rank0, time: 0.530, per_step: 0.005247
Step999:rank5, time: 0.530, per_step: 0.005247
Step999:rank1, time: 0.530, per_step: 0.005247
Step999:rank3, time: 0.530, per_step: 0.005246
Step999:rank2, time: 0.530, per_step: 0.005247
Step999:rank4, time: 0.530, per_step: 0.005248
100%|██████████| 1000/1000 [00:06<00:00, 149.43it/s]100%|██████████| 1000/1000 [00:06<00:00, 152.42it/s]100%|██████████| 1000/1000 [00:06<00:00, 152.27it/s]100%|██████████| 1000/1000 [00:06<00:00, 153.31it/s]100%|██████████| 1000/1000 [00:06<00:00, 151.17it/s]100%|██████████| 1000/1000 [00:06<00:00, 152.42it/s]





Worker 5 pid=48976
Successfully xmh
