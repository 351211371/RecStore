perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f0e6f8d9e50>==========
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<01:57,  8.54it/s]  2%|▏         | 16/1000 [00:00<00:11, 83.70it/s]  3%|▎         | 33/1000 [00:00<00:08, 119.61it/s]  5%|▍         | 48/1000 [00:00<00:07, 130.03it/s]  6%|▋         | 64/1000 [00:00<00:06, 138.48it/s]  8%|▊         | 81/1000 [00:00<00:06, 148.29it/s] 10%|▉         | 98/1000 [00:00<00:05, 154.11it/s]Step99:rank0, time: 0.767, per_step: 0.007674
 11%|█▏        | 114/1000 [00:00<00:05, 155.45it/s] 13%|█▎        | 131/1000 [00:00<00:05, 157.54it/s] 15%|█▍        | 148/1000 [00:01<00:05, 160.43it/s] 16%|█▋        | 165/1000 [00:01<00:05, 160.50it/s] 18%|█▊        | 182/1000 [00:01<00:05, 161.23it/s] 20%|█▉        | 199/1000 [00:01<00:05, 158.96it/s]Step199:rank0, time: 0.622, per_step: 0.006162
 22%|██▏       | 215/1000 [00:01<00:05, 155.96it/s] 23%|██▎       | 232/1000 [00:01<00:04, 159.19it/s] 25%|██▍       | 249/1000 [00:01<00:04, 160.65it/s] 27%|██▋       | 266/1000 [00:01<00:04, 162.07it/s] 28%|██▊       | 283/1000 [00:01<00:04, 162.71it/s]Step299:rank0, time: 0.615, per_step: 0.006090
 30%|███       | 300/1000 [00:01<00:04, 163.68it/s] 32%|███▏      | 317/1000 [00:02<00:04, 163.08it/s] 33%|███▎      | 334/1000 [00:02<00:04, 163.24it/s] 35%|███▌      | 351/1000 [00:02<00:03, 164.11it/s] 37%|███▋      | 368/1000 [00:02<00:03, 164.69it/s] 38%|███▊      | 385/1000 [00:02<00:03, 155.85it/s]Step399:rank0, time: 0.625, per_step: 0.006191
 40%|████      | 402/1000 [00:02<00:03, 158.85it/s] 42%|████▏     | 418/1000 [00:02<00:03, 150.43it/s] 44%|████▎     | 435/1000 [00:02<00:03, 154.29it/s] 45%|████▌     | 452/1000 [00:02<00:03, 157.70it/s] 47%|████▋     | 469/1000 [00:03<00:03, 158.83it/s] 48%|████▊     | 485/1000 [00:03<00:03, 157.70it/s]Step499:rank0, time: 0.646, per_step: 0.006393
 50%|█████     | 501/1000 [00:03<00:03, 156.76it/s] 52%|█████▏    | 518/1000 [00:03<00:03, 157.96it/s] 54%|█████▎    | 535/1000 [00:03<00:02, 159.43it/s] 55%|█████▌    | 551/1000 [00:03<00:02, 153.85it/s] 57%|█████▋    | 567/1000 [00:03<00:02, 149.83it/s] 58%|█████▊    | 584/1000 [00:03<00:02, 153.37it/s]Step599:rank0, time: 0.647, per_step: 0.006407
 60%|██████    | 601/1000 [00:03<00:02, 155.57it/s] 62%|██████▏   | 618/1000 [00:04<00:02, 157.95it/s] 63%|██████▎   | 634/1000 [00:04<00:02, 158.07it/s] 65%|██████▌   | 650/1000 [00:04<00:02, 156.68it/s] 67%|██████▋   | 667/1000 [00:04<00:02, 158.91it/s] 68%|██████▊   | 684/1000 [00:04<00:01, 159.95it/s]Step699:rank0, time: 0.623, per_step: 0.006170
 70%|███████   | 701/1000 [00:04<00:01, 160.20it/s] 72%|███████▏  | 718/1000 [00:04<00:01, 156.45it/s] 74%|███████▎  | 735/1000 [00:04<00:01, 157.68it/s] 75%|███████▌  | 752/1000 [00:04<00:01, 159.60it/s] 77%|███████▋  | 769/1000 [00:04<00:01, 161.08it/s] 79%|███████▊  | 786/1000 [00:05<00:01, 160.51it/s]Step799:rank0, time: 0.625, per_step: 0.006190
 80%|████████  | 803/1000 [00:05<00:01, 161.62it/s] 82%|████████▏ | 820/1000 [00:05<00:01, 158.96it/s] 84%|████████▎ | 837/1000 [00:05<00:01, 159.94it/s] 85%|████████▌ | 854/1000 [00:05<00:00, 160.86it/s] 87%|████████▋ | 871/1000 [00:05<00:00, 160.61it/s] 89%|████████▉ | 888/1000 [00:05<00:00, 160.09it/s]Step899:rank0, time: 0.670, per_step: 0.006633
 90%|█████████ | 905/1000 [00:05<00:00, 141.27it/s] 92%|█████████▏| 922/1000 [00:05<00:00, 146.67it/s] 94%|█████████▍| 938/1000 [00:06<00:00, 148.07it/s] 96%|█████████▌| 955/1000 [00:06<00:00, 151.28it/s] 97%|█████████▋| 971/1000 [00:06<00:00, 152.32it/s] 99%|█████████▊| 987/1000 [00:06<00:00, 154.40it/s]Step999:rank0, time: 0.634, per_step: 0.006273
100%|██████████| 1000/1000 [00:06<00:00, 154.90it/s]
Worker 0 pid=37720
Successfully xmh
