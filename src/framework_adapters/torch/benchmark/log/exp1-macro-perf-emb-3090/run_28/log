perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f228d5ade50>==========
Worker 0 pid=52727
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<02:46,  6.00it/s]  0%|          | 1/1000 [00:00<04:54,  3.39it/s]  2%|▏         | 17/1000 [00:00<00:13, 75.58it/s]  2%|▏         | 17/1000 [00:00<00:18, 53.77it/s]  3%|▎         | 34/1000 [00:00<00:08, 111.23it/s]  3%|▎         | 34/1000 [00:00<00:10, 89.44it/s]  5%|▌         | 53/1000 [00:00<00:06, 138.24it/s]  5%|▌         | 53/1000 [00:00<00:07, 119.62it/s]  7%|▋         | 73/1000 [00:00<00:05, 157.94it/s]  7%|▋         | 73/1000 [00:00<00:06, 143.28it/s]  9%|▉         | 93/1000 [00:00<00:05, 169.59it/s]  9%|▉         | 93/1000 [00:00<00:05, 158.71it/s]Step99:rank0, time: 0.720, per_step: 0.007202
Step99:rank1, time: 0.850, per_step: 0.008498
 12%|█▏        | 115/1000 [00:00<00:05, 175.40it/s] 12%|█▏        | 115/1000 [00:00<00:04, 183.17it/s] 14%|█▍        | 138/1000 [00:01<00:04, 190.39it/s] 14%|█▍        | 138/1000 [00:00<00:04, 196.47it/s] 16%|█▌        | 162/1000 [00:01<00:04, 203.78it/s] 16%|█▌        | 162/1000 [00:00<00:04, 208.33it/s] 19%|█▊        | 187/1000 [00:01<00:03, 219.89it/s] 19%|█▊        | 187/1000 [00:01<00:03, 216.35it/s]Step199:rank0, time: 0.427, per_step: 0.004232
Step199:rank1, time: 0.427, per_step: 0.004232
 21%|██        | 211/1000 [00:01<00:03, 223.95it/s] 21%|██        | 211/1000 [00:01<00:03, 221.48it/s] 24%|██▎       | 235/1000 [00:01<00:03, 228.36it/s] 24%|██▎       | 235/1000 [00:01<00:03, 226.67it/s] 26%|██▌       | 261/1000 [00:01<00:03, 236.53it/s] 26%|██▌       | 262/1000 [00:01<00:03, 237.81it/s] 29%|██▉       | 288/1000 [00:01<00:02, 246.24it/s] 29%|██▉       | 290/1000 [00:01<00:02, 248.06it/s]Step299:rank0, time: 0.395, per_step: 0.003909
Step299:rank1, time: 0.395, per_step: 0.003910
 31%|███▏      | 313/1000 [00:01<00:02, 242.10it/s] 32%|███▏      | 315/1000 [00:01<00:02, 242.96it/s] 34%|███▍      | 340/1000 [00:01<00:02, 249.89it/s] 34%|███▍      | 343/1000 [00:01<00:02, 251.52it/s] 37%|███▋      | 370/1000 [00:01<00:02, 263.47it/s] 37%|███▋      | 373/1000 [00:01<00:02, 264.02it/s] 40%|███▉      | 399/1000 [00:02<00:02, 270.67it/s]Step399:rank0, time: 0.370, per_step: 0.003666
Step399:rank1, time: 0.370, per_step: 0.003665
 40%|████      | 403/1000 [00:01<00:02, 271.33it/s] 43%|████▎     | 431/1000 [00:02<00:02, 283.15it/s] 43%|████▎     | 434/1000 [00:02<00:02, 280.96it/s] 46%|████▌     | 460/1000 [00:02<00:01, 281.39it/s] 46%|████▋     | 463/1000 [00:02<00:01, 282.13it/s] 49%|████▉     | 489/1000 [00:02<00:01, 282.00it/s] 49%|████▉     | 492/1000 [00:02<00:01, 281.73it/s]Step499:rank0, time: 0.353, per_step: 0.003492
Step499:rank1, time: 0.353, per_step: 0.003496
 52%|█████▏    | 518/1000 [00:02<00:01, 280.35it/s] 52%|█████▏    | 521/1000 [00:02<00:01, 282.14it/s] 55%|█████▍    | 548/1000 [00:02<00:01, 284.81it/s] 55%|█████▌    | 551/1000 [00:02<00:01, 285.49it/s] 58%|█████▊    | 577/1000 [00:02<00:01, 280.81it/s] 58%|█████▊    | 580/1000 [00:02<00:01, 281.91it/s]Step599:rank0, time: 0.340, per_step: 0.003366
Step599:rank1, time: 0.340, per_step: 0.003364
 61%|██████    | 609/1000 [00:02<00:01, 291.66it/s] 61%|██████    | 612/1000 [00:02<00:01, 289.89it/s] 64%|██████▍   | 639/1000 [00:02<00:01, 289.93it/s] 64%|██████▍   | 642/1000 [00:02<00:01, 291.50it/s] 67%|██████▋   | 672/1000 [00:02<00:01, 301.09it/s] 68%|██████▊   | 675/1000 [00:02<00:01, 302.39it/s]Step699:rank0, time: 0.325, per_step: 0.003222
Step699:rank1, time: 0.326, per_step: 0.003225
 70%|███████   | 703/1000 [00:03<00:00, 301.79it/s] 71%|███████   | 706/1000 [00:02<00:00, 301.96it/s] 74%|███████▎  | 736/1000 [00:03<00:00, 308.74it/s] 74%|███████▍  | 739/1000 [00:03<00:00, 308.96it/s] 77%|███████▋  | 770/1000 [00:03<00:00, 316.35it/s] 77%|███████▋  | 773/1000 [00:03<00:00, 316.42it/s]Step799:rank0, time: 0.314, per_step: 0.003109
Step799:rank1, time: 0.314, per_step: 0.003110
 80%|████████  | 802/1000 [00:03<00:00, 308.29it/s] 80%|████████  | 805/1000 [00:03<00:00, 308.74it/s] 83%|████████▎ | 833/1000 [00:03<00:00, 307.46it/s] 84%|████████▎ | 836/1000 [00:03<00:00, 308.17it/s] 86%|████████▋ | 865/1000 [00:03<00:00, 310.97it/s] 87%|████████▋ | 868/1000 [00:03<00:00, 311.38it/s] 90%|████████▉ | 899/1000 [00:03<00:00, 319.19it/s]Step899:rank1, time: 0.313, per_step: 0.003101
Step899:rank0, time: 0.314, per_step: 0.003110
 90%|█████████ | 902/1000 [00:03<00:00, 318.39it/s] 93%|█████████▎| 933/1000 [00:03<00:00, 324.47it/s] 94%|█████████▎| 936/1000 [00:03<00:00, 324.60it/s] 97%|█████████▋| 967/1000 [00:03<00:00, 327.22it/s] 97%|█████████▋| 970/1000 [00:03<00:00, 327.87it/s]Step999:rank0, time: 0.303, per_step: 0.002998
100%|██████████| 1000/1000 [00:03<00:00, 259.22it/s]Step999:rank1, time: 0.303, per_step: 0.003004
100%|██████████| 1000/1000 [00:03<00:00, 324.60it/s]100%|██████████| 1000/1000 [00:03<00:00, 250.88it/s]

Worker 1 pid=52728
Successfully xmh
