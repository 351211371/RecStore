perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f654dfe2ee0>==========
Worker 0 pid=36781
Worker 1 pid=36782
Worker 2 pid=36783
Worker 3 pid=36784
Worker 4 pid=36785
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
Step99:rank1, time: 447.499, per_step: 4.474993
Step99:rank2, time: 459.118, per_step: 4.591184
Step99:rank0, time: 462.401, per_step: 4.624006
Step99:rank3, time: 463.913, per_step: 4.639126
Step99:rank4, time: 465.894, per_step: 4.658942
Step99:rank5, time: 477.999, per_step: 4.779994
Step199:rank1, time: 472.521, per_step: 4.678426
Step199:rank2, time: 466.453, per_step: 4.618349
Step199:rank0, time: 466.728, per_step: 4.621067
Step199:rank4, time: 468.441, per_step: 4.638033
Step199:rank5, time: 460.762, per_step: 4.561995
Step199:rank3, time: 477.396, per_step: 4.726690
Step299:rank2, time: 459.372, per_step: 4.548233
Step299:rank1, time: 472.146, per_step: 4.674710
Step299:rank0, time: 476.650, per_step: 4.719306
Step299:rank3, time: 464.837, per_step: 4.602343
Step299:rank4, time: 479.276, per_step: 4.745311
Step299:rank5, time: 482.520, per_step: 4.777428
Step399:rank1, time: 443.462, per_step: 4.390714
Step399:rank3, time: 442.078, per_step: 4.377015
Step399:rank2, time: 466.687, per_step: 4.620660
Step399:rank0, time: 453.118, per_step: 4.486320
Step399:rank4, time: 467.254, per_step: 4.626275
Step399:rank5, time: 461.302, per_step: 4.567349
Step499:rank3, time: 431.553, per_step: 4.272798
Step499:rank1, time: 446.685, per_step: 4.422625
Step499:rank2, time: 450.828, per_step: 4.463646
Step499:rank0, time: 451.766, per_step: 4.472934
Step499:rank4, time: 434.610, per_step: 4.303066
Step499:rank5, time: 437.989, per_step: 4.336526
Worker 5 pid=36786
Successfully xmh
