perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f8d62638ee0>==========
Worker 0 pid=51135
Worker 1 pid=51136
Worker 2 pid=51137
Worker 3 pid=51138
Worker 4 pid=51139
Worker 5 pid=51140
Worker 6 pid=51144
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [distributed_c10d.py:466] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
Step99:rank4, time: 85.936, per_step: 0.859363
Step99:rank5, time: 89.999, per_step: 0.899995
Step99:rank3, time: 91.077, per_step: 0.910767
Step99:rank7, time: 96.340, per_step: 0.963397
Step99:rank2, time: 96.531, per_step: 0.965311
Step99:rank1, time: 97.820, per_step: 0.978203
Step99:rank6, time: 101.061, per_step: 1.010609
Step99:rank0, time: 103.884, per_step: 1.038839
Step199:rank4, time: 86.601, per_step: 0.857441
Step199:rank5, time: 89.855, per_step: 0.889656
Step199:rank3, time: 89.889, per_step: 0.889990
Step199:rank2, time: 88.462, per_step: 0.875865
Step199:rank7, time: 91.597, per_step: 0.906905
Step199:rank1, time: 90.966, per_step: 0.900657
Step199:rank6, time: 93.686, per_step: 0.927585
Step199:rank0, time: 104.357, per_step: 1.033234
Step299:rank4, time: 84.082, per_step: 0.832494
Step299:rank5, time: 87.466, per_step: 0.866003
Step299:rank3, time: 89.424, per_step: 0.885386
Step299:rank2, time: 89.645, per_step: 0.887570
Step299:rank1, time: 88.892, per_step: 0.880115
Step299:rank7, time: 94.936, per_step: 0.939964
Step299:rank6, time: 90.625, per_step: 0.897281
Step299:rank0, time: 98.651, per_step: 0.976741
Step399:rank4, time: 81.120, per_step: 0.803167
Step399:rank5, time: 82.240, per_step: 0.814262
Step399:rank2, time: 84.841, per_step: 0.840006
Step399:rank3, time: 90.337, per_step: 0.894426
Step399:rank1, time: 93.819, per_step: 0.928904
Step399:rank6, time: 93.010, per_step: 0.920891
Step399:rank7, time: 95.579, per_step: 0.946322
Step399:rank0, time: 100.130, per_step: 0.991383
Step499:rank4, time: 85.234, per_step: 0.843901
Step499:rank5, time: 85.167, per_step: 0.843240
Step499:rank2, time: 82.997, per_step: 0.821753
Step499:rank3, time: 83.152, per_step: 0.823287
Step499:rank1, time: 81.658, per_step: 0.808500
Step499:rank6, time: 80.300, per_step: 0.795052
Step499:rank7, time: 82.754, per_step: 0.819346
Step499:rank0, time: 61.727, per_step: 0.611163
Worker 7 pid=51148
Successfully xmh
