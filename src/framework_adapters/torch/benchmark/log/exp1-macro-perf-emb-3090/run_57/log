perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fda54913ee0>==========
Worker 0 pid=6052
Worker 1 pid=6053
Worker 2 pid=6054
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
Step99:rank1, time: 342.108, per_step: 3.421080
Step99:rank2, time: 344.381, per_step: 3.443806
Step99:rank3, time: 345.891, per_step: 3.458912
Step99:rank0, time: 347.824, per_step: 3.478244
Step199:rank1, time: 335.766, per_step: 3.324417
Step199:rank3, time: 342.868, per_step: 3.394731
Step199:rank0, time: 347.074, per_step: 3.436377
Step199:rank2, time: 357.487, per_step: 3.539472
Step299:rank1, time: 341.259, per_step: 3.378807
Step299:rank3, time: 356.123, per_step: 3.525971
Step299:rank0, time: 363.561, per_step: 3.599612
Step299:rank2, time: 362.165, per_step: 3.585795
Step399:rank1, time: 339.958, per_step: 3.365917
Step399:rank3, time: 350.892, per_step: 3.474180
Step399:rank0, time: 339.228, per_step: 3.358695
Step399:rank2, time: 343.795, per_step: 3.403907
Step499:rank1, time: 354.516, per_step: 3.510062
Step499:rank3, time: 339.184, per_step: 3.358253
Step499:rank0, time: 342.866, per_step: 3.394712
Step499:rank2, time: 347.400, per_step: 3.439603
Worker 3 pid=6055
Successfully xmh
