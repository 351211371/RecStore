perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fb0d1120ee0>==========
Worker 0 pid=12855
Worker 1 pid=12856
Worker 2 pid=12857
Worker 3 pid=12864
Worker 4 pid=12865
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
Step99:rank2, time: 79.287, per_step: 0.792867
Step99:rank4, time: 79.434, per_step: 0.794335
Step99:rank0, time: 79.950, per_step: 0.799497
Step99:rank1, time: 81.427, per_step: 0.814268
Step99:rank5, time: 82.274, per_step: 0.822739
Step99:rank3, time: 87.233, per_step: 0.872329
Step199:rank2, time: 76.381, per_step: 0.756246
Step199:rank0, time: 77.138, per_step: 0.763740
Step199:rank4, time: 79.126, per_step: 0.783430
Step199:rank5, time: 78.681, per_step: 0.779023
Step199:rank1, time: 79.895, per_step: 0.791038
Step199:rank3, time: 81.104, per_step: 0.803014
Step299:rank0, time: 75.901, per_step: 0.751491
Step299:rank2, time: 78.423, per_step: 0.776469
Step299:rank4, time: 78.432, per_step: 0.776552
Step299:rank1, time: 78.762, per_step: 0.779821
Step299:rank5, time: 79.338, per_step: 0.785526
Step299:rank3, time: 80.743, per_step: 0.799432
Step399:rank0, time: 76.846, per_step: 0.760852
Step399:rank2, time: 78.129, per_step: 0.773557
Step399:rank1, time: 76.898, per_step: 0.761370
Step399:rank4, time: 81.311, per_step: 0.805063
Step399:rank5, time: 79.413, per_step: 0.786268
Step399:rank3, time: 79.107, per_step: 0.783239
Step499:rank2, time: 77.234, per_step: 0.764692
Step499:rank0, time: 79.685, per_step: 0.788960
Step499:rank5, time: 71.674, per_step: 0.709646
Step499:rank4, time: 74.590, per_step: 0.738513
Step499:rank1, time: 78.090, per_step: 0.773168
Step499:rank3, time: 71.227, per_step: 0.705220
Worker 5 pid=12866
Successfully xmh
