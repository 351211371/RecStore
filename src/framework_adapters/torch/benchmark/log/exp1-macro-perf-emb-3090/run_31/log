perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f53453d2e50>==========
Worker 0 pid=58632
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:00<05:15,  3.16it/s]  0%|          | 1/1000 [00:00<03:52,  4.30it/s]  1%|          | 6/1000 [00:00<00:56, 17.65it/s]  1%|          | 9/1000 [00:00<00:31, 31.29it/s]  1%|          | 11/1000 [00:00<00:36, 27.44it/s]  1%|▏         | 14/1000 [00:00<00:27, 36.26it/s]  2%|▏         | 16/1000 [00:00<00:28, 34.07it/s]  2%|▏         | 19/1000 [00:00<00:25, 39.15it/s]  2%|▏         | 23/1000 [00:00<00:21, 44.83it/s]  3%|▎         | 27/1000 [00:00<00:19, 50.36it/s]  3%|▎         | 29/1000 [00:00<00:21, 45.78it/s]  3%|▎         | 33/1000 [00:00<00:18, 51.88it/s]  4%|▎         | 36/1000 [00:00<00:19, 50.38it/s]  4%|▍         | 39/1000 [00:00<00:18, 50.94it/s]  4%|▍         | 42/1000 [00:01<00:21, 45.14it/s]  4%|▍         | 45/1000 [00:01<00:19, 49.62it/s]  5%|▍         | 49/1000 [00:01<00:18, 50.49it/s]  5%|▌         | 51/1000 [00:01<00:18, 50.98it/s]  6%|▌         | 55/1000 [00:01<00:19, 48.17it/s]  6%|▌         | 57/1000 [00:01<00:20, 44.99it/s]  6%|▌         | 61/1000 [00:01<00:21, 43.31it/s]  6%|▌         | 62/1000 [00:01<00:21, 43.15it/s]  7%|▋         | 68/1000 [00:01<00:20, 46.35it/s]  7%|▋         | 68/1000 [00:01<00:20, 44.50it/s]  7%|▋         | 73/1000 [00:01<00:22, 42.09it/s]  7%|▋         | 73/1000 [00:01<00:22, 41.12it/s]  8%|▊         | 78/1000 [00:01<00:24, 37.53it/s]  8%|▊         | 78/1000 [00:01<00:25, 36.80it/s]  8%|▊         | 82/1000 [00:02<00:24, 36.99it/s]  8%|▊         | 82/1000 [00:01<00:25, 36.71it/s]  9%|▊         | 86/1000 [00:02<00:26, 34.99it/s]  9%|▊         | 86/1000 [00:02<00:26, 34.24it/s]  9%|▉         | 90/1000 [00:02<00:26, 34.44it/s]  9%|▉         | 91/1000 [00:02<00:27, 33.06it/s]  9%|▉         | 94/1000 [00:02<00:28, 32.16it/s] 10%|▉         | 95/1000 [00:02<00:29, 30.74it/s] 10%|▉         | 98/1000 [00:02<00:28, 31.95it/s]Step99:rank0, time: 2.571, per_step: 0.025707
 10%|█         | 100/1000 [00:02<00:26, 34.44it/s]Step99:rank1, time: 2.693, per_step: 0.026933
 10%|█         | 102/1000 [00:02<00:28, 31.71it/s] 10%|█         | 104/1000 [00:02<00:27, 32.82it/s] 11%|█         | 106/1000 [00:02<00:28, 31.85it/s] 11%|█         | 108/1000 [00:02<00:26, 33.95it/s] 11%|█         | 112/1000 [00:03<00:24, 36.66it/s] 11%|█▏        | 113/1000 [00:02<00:23, 37.65it/s] 12%|█▏        | 116/1000 [00:03<00:27, 32.01it/s] 12%|█▏        | 117/1000 [00:03<00:31, 28.38it/s] 12%|█▏        | 120/1000 [00:03<00:27, 31.63it/s] 12%|█▏        | 123/1000 [00:03<00:25, 34.36it/s] 13%|█▎        | 126/1000 [00:03<00:23, 36.79it/s] 13%|█▎        | 128/1000 [00:03<00:23, 36.54it/s] 13%|█▎        | 130/1000 [00:03<00:24, 35.75it/s] 13%|█▎        | 132/1000 [00:03<00:26, 32.90it/s] 13%|█▎        | 134/1000 [00:03<00:29, 29.46it/s] 14%|█▎        | 136/1000 [00:03<00:30, 27.95it/s] 14%|█▍        | 138/1000 [00:03<00:31, 27.06it/s] 14%|█▍        | 140/1000 [00:03<00:31, 27.26it/s] 14%|█▍        | 141/1000 [00:04<00:32, 26.76it/s] 14%|█▍        | 144/1000 [00:04<00:30, 28.29it/s] 14%|█▍        | 145/1000 [00:04<00:29, 28.72it/s] 15%|█▍        | 147/1000 [00:04<00:33, 25.21it/s] 15%|█▍        | 148/1000 [00:04<00:32, 25.88it/s] 15%|█▌        | 150/1000 [00:04<00:35, 24.28it/s] 15%|█▌        | 151/1000 [00:04<00:34, 24.34it/s] 15%|█▌        | 154/1000 [00:04<00:32, 26.22it/s] 16%|█▌        | 155/1000 [00:04<00:30, 27.60it/s] 16%|█▌        | 159/1000 [00:04<00:27, 30.98it/s] 16%|█▌        | 160/1000 [00:04<00:27, 30.53it/s] 16%|█▋        | 163/1000 [00:04<00:28, 29.63it/s] 16%|█▋        | 164/1000 [00:04<00:29, 28.53it/s] 17%|█▋        | 167/1000 [00:04<00:31, 26.77it/s] 17%|█▋        | 167/1000 [00:05<00:31, 26.24it/s] 17%|█▋        | 172/1000 [00:05<00:26, 31.63it/s] 17%|█▋        | 172/1000 [00:04<00:26, 31.39it/s] 18%|█▊        | 176/1000 [00:05<00:24, 33.59it/s] 18%|█▊        | 176/1000 [00:05<00:25, 32.21it/s] 18%|█▊        | 180/1000 [00:05<00:24, 33.78it/s] 18%|█▊        | 181/1000 [00:05<00:24, 33.72it/s] 18%|█▊        | 184/1000 [00:05<00:26, 31.08it/s] 18%|█▊        | 185/1000 [00:05<00:26, 31.29it/s] 19%|█▉        | 188/1000 [00:05<00:29, 27.83it/s] 19%|█▉        | 189/1000 [00:05<00:28, 28.17it/s] 19%|█▉        | 191/1000 [00:05<00:28, 27.93it/s] 19%|█▉        | 193/1000 [00:05<00:28, 28.07it/s] 20%|█▉        | 195/1000 [00:05<00:28, 28.74it/s] 20%|█▉        | 198/1000 [00:05<00:24, 32.29it/s]Step199:rank1, time: 3.284, per_step: 0.032510
Step199:rank0, time: 3.292, per_step: 0.032591
 20%|██        | 202/1000 [00:06<00:21, 37.55it/s] 20%|██        | 205/1000 [00:05<00:19, 39.96it/s] 21%|██        | 207/1000 [00:06<00:21, 37.53it/s] 21%|██        | 210/1000 [00:06<00:24, 32.75it/s] 21%|██        | 211/1000 [00:06<00:23, 33.18it/s] 22%|██▏       | 217/1000 [00:06<00:19, 39.88it/s] 22%|██▏       | 218/1000 [00:06<00:19, 40.94it/s] 22%|██▏       | 222/1000 [00:06<00:23, 33.23it/s] 22%|██▏       | 223/1000 [00:06<00:23, 33.28it/s] 23%|██▎       | 228/1000 [00:06<00:20, 38.06it/s] 23%|██▎       | 229/1000 [00:06<00:20, 37.75it/s] 23%|██▎       | 233/1000 [00:06<00:22, 34.16it/s] 23%|██▎       | 234/1000 [00:06<00:22, 34.10it/s] 24%|██▍       | 238/1000 [00:06<00:20, 36.69it/s] 24%|██▍       | 239/1000 [00:07<00:20, 37.21it/s] 24%|██▍       | 243/1000 [00:07<00:21, 35.79it/s] 24%|██▍       | 244/1000 [00:07<00:20, 36.04it/s] 25%|██▍       | 247/1000 [00:07<00:20, 36.59it/s] 25%|██▍       | 249/1000 [00:07<00:20, 36.49it/s] 25%|██▌       | 251/1000 [00:07<00:21, 35.31it/s] 25%|██▌       | 253/1000 [00:07<00:21, 35.13it/s] 26%|██▌       | 255/1000 [00:07<00:22, 33.82it/s] 26%|██▌       | 257/1000 [00:07<00:20, 35.98it/s] 26%|██▌       | 260/1000 [00:07<00:19, 37.66it/s] 26%|██▋       | 263/1000 [00:07<00:17, 41.01it/s] 26%|██▋       | 264/1000 [00:07<00:19, 37.60it/s] 27%|██▋       | 268/1000 [00:07<00:20, 35.65it/s] 27%|██▋       | 268/1000 [00:07<00:20, 36.56it/s] 27%|██▋       | 272/1000 [00:07<00:19, 36.46it/s] 27%|██▋       | 272/1000 [00:07<00:19, 37.40it/s] 28%|██▊       | 278/1000 [00:08<00:17, 41.93it/s] 28%|██▊       | 278/1000 [00:07<00:16, 43.01it/s] 28%|██▊       | 283/1000 [00:08<00:20, 34.32it/s] 28%|██▊       | 283/1000 [00:08<00:21, 33.77it/s] 29%|██▊       | 287/1000 [00:08<00:20, 34.32it/s] 29%|██▉       | 288/1000 [00:08<00:20, 34.24it/s] 29%|██▉       | 291/1000 [00:08<00:21, 33.32it/s] 29%|██▉       | 292/1000 [00:08<00:21, 33.24it/s] 30%|██▉       | 295/1000 [00:08<00:20, 33.82it/s] 30%|██▉       | 296/1000 [00:08<00:20, 34.44it/s] 30%|██▉       | 299/1000 [00:08<00:21, 32.81it/s]Step299:rank1, time: 2.847, per_step: 0.028184
Step299:rank0, time: 2.884, per_step: 0.028556
 30%|███       | 300/1000 [00:08<00:25, 27.81it/s] 30%|███       | 303/1000 [00:09<00:31, 22.13it/s] 30%|███       | 304/1000 [00:09<00:34, 20.15it/s] 31%|███       | 306/1000 [00:09<00:34, 20.32it/s] 31%|███       | 307/1000 [00:09<00:35, 19.74it/s] 31%|███       | 309/1000 [00:09<00:36, 18.69it/s] 31%|███       | 310/1000 [00:09<00:33, 20.89it/s] 32%|███▏      | 315/1000 [00:09<00:26, 25.97it/s] 32%|███▏      | 316/1000 [00:09<00:25, 26.92it/s] 32%|███▏      | 319/1000 [00:09<00:24, 27.84it/s] 32%|███▏      | 320/1000 [00:09<00:23, 29.08it/s] 32%|███▏      | 323/1000 [00:09<00:23, 28.57it/s] 32%|███▏      | 324/1000 [00:09<00:22, 30.05it/s] 33%|███▎      | 327/1000 [00:10<00:26, 25.03it/s] 33%|███▎      | 328/1000 [00:09<00:26, 25.10it/s] 33%|███▎      | 330/1000 [00:10<00:29, 22.87it/s] 33%|███▎      | 331/1000 [00:10<00:29, 22.64it/s] 33%|███▎      | 333/1000 [00:10<00:29, 22.54it/s] 33%|███▎      | 334/1000 [00:10<00:28, 23.37it/s] 34%|███▎      | 336/1000 [00:10<00:32, 20.65it/s] 34%|███▎      | 337/1000 [00:10<00:32, 20.22it/s] 34%|███▍      | 339/1000 [00:10<00:34, 19.37it/s] 34%|███▍      | 340/1000 [00:10<00:34, 19.14it/s] 34%|███▍      | 342/1000 [00:10<00:39, 16.49it/s] 34%|███▍      | 343/1000 [00:10<00:40, 16.35it/s] 34%|███▍      | 344/1000 [00:11<00:40, 16.07it/s] 34%|███▍      | 345/1000 [00:11<00:41, 15.96it/s] 35%|███▍      | 346/1000 [00:11<00:43, 15.02it/s] 35%|███▍      | 347/1000 [00:11<00:41, 15.64it/s] 35%|███▍      | 349/1000 [00:11<00:39, 16.52it/s] 35%|███▍      | 349/1000 [00:11<00:42, 15.20it/s] 35%|███▌      | 352/1000 [00:11<00:33, 19.29it/s] 35%|███▌      | 353/1000 [00:11<00:33, 19.17it/s] 36%|███▌      | 357/1000 [00:11<00:25, 25.44it/s] 36%|███▌      | 360/1000 [00:11<00:24, 25.82it/s] 36%|███▌      | 360/1000 [00:11<00:24, 25.95it/s] 37%|███▋      | 366/1000 [00:11<00:19, 32.85it/s] 37%|███▋      | 366/1000 [00:11<00:18, 33.39it/s] 37%|███▋      | 373/1000 [00:11<00:15, 41.03it/s] 37%|███▋      | 373/1000 [00:11<00:14, 42.37it/s] 38%|███▊      | 381/1000 [00:11<00:12, 49.15it/s] 38%|███▊      | 381/1000 [00:12<00:12, 50.75it/s] 39%|███▉      | 389/1000 [00:12<00:11, 55.00it/s] 39%|███▉      | 389/1000 [00:12<00:10, 56.50it/s] 40%|███▉      | 395/1000 [00:12<00:12, 49.64it/s] 40%|███▉      | 395/1000 [00:12<00:12, 48.04it/s]Step399:rank1, time: 3.683, per_step: 0.036465
Step399:rank0, time: 3.661, per_step: 0.036250
 40%|████      | 401/1000 [00:12<00:15, 39.45it/s] 40%|████      | 401/1000 [00:12<00:15, 39.09it/s] 41%|████      | 406/1000 [00:12<00:14, 39.83it/s] 41%|████      | 406/1000 [00:12<00:14, 39.97it/s] 41%|████      | 412/1000 [00:12<00:13, 42.69it/s] 41%|████      | 412/1000 [00:12<00:13, 42.86it/s] 42%|████▏     | 417/1000 [00:12<00:14, 39.45it/s] 42%|████▏     | 417/1000 [00:12<00:15, 38.44it/s] 42%|████▏     | 422/1000 [00:13<00:16, 35.17it/s] 42%|████▏     | 422/1000 [00:12<00:16, 35.17it/s] 43%|████▎     | 426/1000 [00:13<00:16, 34.91it/s] 43%|████▎     | 426/1000 [00:13<00:16, 34.65it/s] 43%|████▎     | 430/1000 [00:13<00:16, 35.60it/s] 43%|████▎     | 430/1000 [00:13<00:16, 35.14it/s] 43%|████▎     | 434/1000 [00:13<00:16, 33.51it/s] 43%|████▎     | 434/1000 [00:13<00:17, 33.10it/s] 44%|████▍     | 442/1000 [00:13<00:12, 43.86it/s] 44%|████▍     | 442/1000 [00:13<00:12, 43.64it/s] 45%|████▍     | 447/1000 [00:13<00:12, 43.60it/s] 45%|████▍     | 447/1000 [00:13<00:12, 43.52it/s] 45%|████▌     | 454/1000 [00:13<00:10, 50.09it/s] 45%|████▌     | 454/1000 [00:13<00:10, 49.87it/s] 46%|████▌     | 461/1000 [00:13<00:09, 54.79it/s] 46%|████▌     | 461/1000 [00:13<00:09, 54.63it/s] 47%|████▋     | 467/1000 [00:13<00:09, 55.68it/s] 47%|████▋     | 468/1000 [00:14<00:09, 55.95it/s] 47%|████▋     | 473/1000 [00:14<00:09, 54.90it/s] 47%|████▋     | 474/1000 [00:14<00:09, 55.56it/s] 48%|████▊     | 480/1000 [00:14<00:08, 57.92it/s] 48%|████▊     | 481/1000 [00:14<00:08, 58.45it/s] 49%|████▊     | 486/1000 [00:14<00:09, 56.50it/s] 49%|████▊     | 487/1000 [00:14<00:09, 56.77it/s] 49%|████▉     | 492/1000 [00:14<00:10, 47.74it/s] 49%|████▉     | 493/1000 [00:14<00:10, 47.05it/s] 50%|████▉     | 498/1000 [00:14<00:10, 46.17it/s] 50%|████▉     | 499/1000 [00:14<00:10, 45.95it/s]Step499:rank0, time: 2.194, per_step: 0.021726
Step499:rank1, time: 2.218, per_step: 0.021960
 50%|█████     | 503/1000 [00:14<00:11, 41.74it/s] 50%|█████     | 504/1000 [00:14<00:11, 42.29it/s] 51%|█████     | 511/1000 [00:14<00:09, 50.00it/s] 51%|█████     | 512/1000 [00:14<00:09, 50.09it/s] 52%|█████▏    | 517/1000 [00:14<00:09, 50.08it/s] 52%|█████▏    | 518/1000 [00:15<00:10, 47.66it/s] 52%|█████▏    | 523/1000 [00:15<00:09, 48.74it/s] 52%|█████▏    | 524/1000 [00:15<00:09, 49.91it/s] 53%|█████▎    | 530/1000 [00:15<00:08, 52.33it/s] 53%|█████▎    | 530/1000 [00:15<00:09, 52.13it/s] 54%|█████▎    | 537/1000 [00:15<00:08, 56.48it/s] 54%|█████▎    | 537/1000 [00:15<00:08, 56.53it/s] 54%|█████▍    | 543/1000 [00:15<00:08, 56.37it/s] 54%|█████▍    | 543/1000 [00:15<00:08, 56.39it/s] 55%|█████▍    | 549/1000 [00:15<00:08, 51.40it/s] 55%|█████▍    | 549/1000 [00:15<00:08, 51.17it/s] 56%|█████▌    | 555/1000 [00:15<00:09, 46.00it/s] 56%|█████▌    | 555/1000 [00:15<00:09, 45.21it/s] 56%|█████▌    | 560/1000 [00:15<00:11, 37.55it/s] 56%|█████▌    | 560/1000 [00:16<00:11, 37.34it/s] 57%|█████▋    | 567/1000 [00:15<00:09, 43.46it/s] 57%|█████▋    | 567/1000 [00:16<00:10, 43.22it/s] 57%|█████▋    | 572/1000 [00:16<00:11, 38.61it/s] 57%|█████▋    | 572/1000 [00:16<00:11, 37.92it/s] 58%|█████▊    | 577/1000 [00:16<00:11, 37.64it/s] 58%|█████▊    | 577/1000 [00:16<00:11, 36.43it/s] 58%|█████▊    | 581/1000 [00:16<00:12, 32.62it/s] 58%|█████▊    | 582/1000 [00:16<00:12, 32.49it/s] 58%|█████▊    | 585/1000 [00:16<00:12, 32.59it/s] 59%|█████▊    | 586/1000 [00:16<00:12, 32.27it/s] 59%|█████▉    | 589/1000 [00:16<00:12, 31.65it/s] 59%|█████▉    | 590/1000 [00:16<00:12, 32.04it/s] 59%|█████▉    | 593/1000 [00:16<00:12, 33.11it/s] 59%|█████▉    | 594/1000 [00:16<00:12, 33.71it/s] 60%|█████▉    | 597/1000 [00:16<00:11, 34.44it/s] 60%|█████▉    | 598/1000 [00:17<00:12, 33.44it/s]Step599:rank1, time: 2.480, per_step: 0.024557
Step599:rank0, time: 2.489, per_step: 0.024648
 60%|██████    | 601/1000 [00:17<00:12, 31.21it/s] 60%|██████    | 602/1000 [00:17<00:12, 31.41it/s] 60%|██████    | 605/1000 [00:17<00:12, 30.44it/s] 61%|██████    | 606/1000 [00:17<00:12, 30.51it/s] 61%|██████    | 610/1000 [00:17<00:11, 33.58it/s] 61%|██████    | 611/1000 [00:17<00:11, 34.49it/s] 62%|██████▏   | 615/1000 [00:17<00:10, 36.39it/s] 62%|██████▏   | 616/1000 [00:17<00:10, 36.03it/s] 62%|██████▏   | 619/1000 [00:17<00:12, 30.90it/s] 62%|██████▏   | 620/1000 [00:17<00:12, 30.65it/s] 62%|██████▏   | 623/1000 [00:17<00:11, 31.95it/s] 62%|██████▏   | 624/1000 [00:17<00:12, 30.70it/s] 63%|██████▎   | 627/1000 [00:17<00:11, 31.98it/s] 63%|██████▎   | 628/1000 [00:18<00:12, 30.01it/s] 63%|██████▎   | 631/1000 [00:18<00:12, 28.56it/s] 63%|██████▎   | 632/1000 [00:18<00:12, 28.86it/s] 64%|██████▎   | 635/1000 [00:18<00:12, 30.31it/s] 64%|██████▎   | 636/1000 [00:18<00:12, 30.24it/s] 64%|██████▍   | 639/1000 [00:18<00:12, 28.19it/s] 64%|██████▍   | 640/1000 [00:18<00:12, 29.28it/s] 64%|██████▍   | 643/1000 [00:18<00:11, 30.52it/s] 64%|██████▍   | 645/1000 [00:18<00:11, 31.65it/s] 65%|██████▍   | 648/1000 [00:18<00:10, 35.20it/s] 65%|██████▍   | 649/1000 [00:18<00:10, 32.12it/s] 65%|██████▌   | 652/1000 [00:18<00:12, 28.95it/s] 65%|██████▌   | 653/1000 [00:18<00:11, 30.71it/s] 66%|██████▌   | 660/1000 [00:18<00:08, 39.13it/s] 66%|██████▌   | 661/1000 [00:19<00:08, 38.99it/s] 66%|██████▋   | 665/1000 [00:19<00:09, 35.13it/s] 66%|██████▋   | 665/1000 [00:19<00:10, 33.20it/s] 67%|██████▋   | 669/1000 [00:19<00:10, 31.71it/s] 67%|██████▋   | 669/1000 [00:19<00:10, 30.97it/s] 67%|██████▋   | 673/1000 [00:19<00:10, 32.57it/s] 67%|██████▋   | 673/1000 [00:19<00:10, 32.68it/s] 68%|██████▊   | 677/1000 [00:19<00:09, 32.37it/s] 68%|██████▊   | 677/1000 [00:19<00:09, 32.95it/s] 68%|██████▊   | 682/1000 [00:19<00:09, 33.55it/s] 68%|██████▊   | 682/1000 [00:19<00:09, 32.84it/s] 69%|██████▊   | 687/1000 [00:19<00:08, 35.22it/s] 69%|██████▊   | 687/1000 [00:19<00:09, 34.28it/s] 69%|██████▉   | 691/1000 [00:19<00:09, 32.17it/s] 69%|██████▉   | 691/1000 [00:20<00:09, 31.43it/s] 70%|██████▉   | 695/1000 [00:20<00:10, 29.34it/s] 70%|██████▉   | 695/1000 [00:20<00:10, 28.87it/s] 70%|██████▉   | 699/1000 [00:20<00:10, 29.97it/s] 70%|██████▉   | 699/1000 [00:20<00:10, 29.01it/s]Step699:rank0, time: 3.161, per_step: 0.031299
Step699:rank1, time: 3.173, per_step: 0.031412
 70%|███████   | 702/1000 [00:20<00:10, 28.47it/s] 70%|███████   | 703/1000 [00:20<00:10, 28.44it/s] 70%|███████   | 705/1000 [00:20<00:10, 28.67it/s] 71%|███████   | 707/1000 [00:20<00:09, 30.72it/s] 71%|███████   | 710/1000 [00:20<00:09, 30.41it/s] 71%|███████   | 711/1000 [00:20<00:09, 30.67it/s] 72%|███████▏  | 717/1000 [00:20<00:07, 38.48it/s] 72%|███████▏  | 717/1000 [00:20<00:07, 37.12it/s] 72%|███████▏  | 724/1000 [00:20<00:06, 44.99it/s] 72%|███████▏  | 724/1000 [00:20<00:06, 45.75it/s] 73%|███████▎  | 730/1000 [00:20<00:05, 48.78it/s] 73%|███████▎  | 730/1000 [00:21<00:05, 49.00it/s] 74%|███████▍  | 738/1000 [00:21<00:04, 54.16it/s] 74%|███████▍  | 738/1000 [00:21<00:04, 54.03it/s] 74%|███████▍  | 744/1000 [00:21<00:04, 53.29it/s] 74%|███████▍  | 744/1000 [00:21<00:04, 53.75it/s] 75%|███████▌  | 752/1000 [00:21<00:04, 58.42it/s] 75%|███████▌  | 752/1000 [00:21<00:04, 58.74it/s] 76%|███████▌  | 760/1000 [00:21<00:03, 61.88it/s] 76%|███████▌  | 760/1000 [00:21<00:03, 62.11it/s] 77%|███████▋  | 768/1000 [00:21<00:03, 64.41it/s] 77%|███████▋  | 768/1000 [00:21<00:03, 64.58it/s] 78%|███████▊  | 775/1000 [00:21<00:03, 65.57it/s] 78%|███████▊  | 775/1000 [00:21<00:03, 65.66it/s] 78%|███████▊  | 782/1000 [00:21<00:03, 65.79it/s] 78%|███████▊  | 782/1000 [00:21<00:03, 65.87it/s] 79%|███████▉  | 789/1000 [00:21<00:03, 66.15it/s] 79%|███████▉  | 789/1000 [00:21<00:03, 65.98it/s] 80%|███████▉  | 796/1000 [00:21<00:03, 65.81it/s] 80%|███████▉  | 796/1000 [00:22<00:03, 65.35it/s]Step799:rank0, time: 1.698, per_step: 0.016812
Step799:rank1, time: 1.692, per_step: 0.016750
 81%|████████  | 806/1000 [00:22<00:02, 68.24it/s] 81%|████████  | 806/1000 [00:22<00:02, 67.62it/s] 82%|████████▏ | 816/1000 [00:22<00:02, 74.19it/s] 82%|████████▏ | 816/1000 [00:22<00:02, 74.56it/s] 82%|████████▏ | 824/1000 [00:22<00:02, 67.47it/s] 82%|████████▏ | 824/1000 [00:22<00:02, 66.64it/s] 83%|████████▎ | 831/1000 [00:22<00:02, 66.85it/s] 83%|████████▎ | 831/1000 [00:22<00:02, 67.34it/s] 84%|████████▍ | 838/1000 [00:22<00:02, 68.04it/s] 84%|████████▍ | 839/1000 [00:22<00:02, 67.69it/s] 85%|████████▍ | 846/1000 [00:22<00:02, 68.65it/s] 85%|████████▍ | 847/1000 [00:22<00:02, 68.38it/s] 85%|████████▌ | 853/1000 [00:22<00:02, 65.80it/s] 85%|████████▌ | 854/1000 [00:22<00:02, 65.66it/s] 86%|████████▌ | 860/1000 [00:22<00:02, 65.04it/s] 86%|████████▌ | 861/1000 [00:22<00:02, 65.12it/s] 87%|████████▋ | 867/1000 [00:23<00:02, 65.63it/s] 87%|████████▋ | 868/1000 [00:22<00:02, 65.92it/s] 87%|████████▋ | 874/1000 [00:23<00:02, 61.32it/s] 88%|████████▊ | 875/1000 [00:23<00:01, 62.57it/s] 88%|████████▊ | 883/1000 [00:23<00:01, 66.29it/s] 88%|████████▊ | 883/1000 [00:23<00:01, 64.64it/s] 89%|████████▉ | 891/1000 [00:23<00:01, 68.19it/s] 89%|████████▉ | 891/1000 [00:23<00:01, 67.35it/s] 90%|████████▉ | 898/1000 [00:23<00:01, 64.14it/s] 90%|████████▉ | 898/1000 [00:23<00:01, 63.05it/s]Step899:rank0, time: 1.546, per_step: 0.015307
Step899:rank1, time: 1.563, per_step: 0.015475
 90%|█████████ | 905/1000 [00:23<00:01, 52.55it/s] 90%|█████████ | 905/1000 [00:23<00:01, 52.22it/s] 91%|█████████ | 911/1000 [00:23<00:01, 48.73it/s] 91%|█████████ | 911/1000 [00:23<00:01, 48.12it/s] 92%|█████████▏| 917/1000 [00:23<00:01, 51.25it/s] 92%|█████████▏| 917/1000 [00:23<00:01, 50.74it/s] 92%|█████████▏| 924/1000 [00:24<00:01, 52.97it/s] 92%|█████████▏| 924/1000 [00:24<00:01, 51.98it/s] 93%|█████████▎| 930/1000 [00:24<00:01, 47.08it/s] 93%|█████████▎| 930/1000 [00:24<00:01, 47.33it/s] 94%|█████████▎| 935/1000 [00:24<00:01, 45.03it/s] 94%|█████████▎| 935/1000 [00:24<00:01, 44.19it/s] 94%|█████████▍| 943/1000 [00:24<00:01, 53.05it/s] 94%|█████████▍| 944/1000 [00:24<00:01, 53.98it/s] 95%|█████████▌| 950/1000 [00:24<00:00, 52.44it/s] 95%|█████████▌| 950/1000 [00:24<00:00, 52.74it/s] 96%|█████████▌| 958/1000 [00:24<00:00, 58.33it/s] 96%|█████████▌| 958/1000 [00:24<00:00, 58.39it/s] 97%|█████████▋| 967/1000 [00:24<00:00, 65.66it/s] 97%|█████████▋| 967/1000 [00:24<00:00, 65.78it/s] 97%|█████████▋| 974/1000 [00:24<00:00, 64.53it/s] 97%|█████████▋| 974/1000 [00:24<00:00, 64.62it/s] 98%|█████████▊| 981/1000 [00:25<00:00, 63.26it/s] 98%|█████████▊| 981/1000 [00:24<00:00, 61.54it/s] 99%|█████████▉| 988/1000 [00:25<00:00, 62.91it/s] 99%|█████████▉| 988/1000 [00:25<00:00, 62.23it/s]100%|█████████▉| 996/1000 [00:25<00:00, 65.45it/s]100%|█████████▉| 996/1000 [00:25<00:00, 64.87it/s]Step999:rank0, time: 1.770, per_step: 0.017521
100%|██████████| 1000/1000 [00:25<00:00, 39.59it/s]
Step999:rank1, time: 1.752, per_step: 0.017344
100%|██████████| 1000/1000 [00:25<00:00, 39.40it/s]
Worker 1 pid=58633
Successfully xmh
