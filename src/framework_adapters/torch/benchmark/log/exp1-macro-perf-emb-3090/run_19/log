perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f5b10ae2e50>==========
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
weight.shape torch.Size([10000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 4/1000 [00:00<00:25, 39.53it/s]  2%|▏         | 22/1000 [00:00<00:08, 121.56it/s]  4%|▍         | 43/1000 [00:00<00:05, 161.21it/s]  7%|▋         | 68/1000 [00:00<00:04, 194.62it/s]  9%|▉         | 94/1000 [00:00<00:04, 216.15it/s]Step99:rank0, time: 0.541, per_step: 0.005413
 12%|█▏        | 120/1000 [00:00<00:03, 229.05it/s] 14%|█▍        | 144/1000 [00:00<00:03, 230.21it/s] 17%|█▋        | 170/1000 [00:00<00:03, 237.81it/s] 20%|█▉        | 197/1000 [00:00<00:03, 245.22it/s]Step199:rank0, time: 0.404, per_step: 0.004002
 22%|██▏       | 222/1000 [00:01<00:03, 246.46it/s] 25%|██▍       | 248/1000 [00:01<00:03, 250.13it/s] 27%|██▋       | 274/1000 [00:01<00:02, 248.28it/s] 30%|██▉       | 299/1000 [00:01<00:02, 248.65it/s]Step299:rank0, time: 0.395, per_step: 0.003913
 32%|███▏      | 324/1000 [00:01<00:02, 246.62it/s] 35%|███▍      | 349/1000 [00:01<00:02, 239.80it/s] 37%|███▋      | 374/1000 [00:01<00:02, 236.70it/s]Step399:rank0, time: 0.418, per_step: 0.004140
 40%|████      | 401/1000 [00:01<00:02, 244.32it/s] 43%|████▎     | 428/1000 [00:01<00:02, 249.78it/s] 46%|████▌     | 455/1000 [00:01<00:02, 254.48it/s] 48%|████▊     | 482/1000 [00:02<00:02, 257.56it/s]Step499:rank0, time: 0.378, per_step: 0.003742
 51%|█████     | 509/1000 [00:02<00:01, 258.46it/s] 54%|█████▎    | 535/1000 [00:02<00:01, 257.09it/s] 56%|█████▌    | 562/1000 [00:02<00:01, 260.03it/s] 59%|█████▉    | 589/1000 [00:02<00:01, 257.88it/s]Step599:rank0, time: 0.388, per_step: 0.003846
 62%|██████▏   | 616/1000 [00:02<00:01, 259.50it/s] 64%|██████▍   | 642/1000 [00:02<00:01, 233.27it/s] 67%|██████▋   | 669/1000 [00:02<00:01, 241.49it/s] 70%|██████▉   | 696/1000 [00:02<00:01, 248.73it/s]Step699:rank0, time: 0.420, per_step: 0.004155
 72%|███████▏  | 722/1000 [00:03<00:01, 251.44it/s] 75%|███████▍  | 748/1000 [00:03<00:00, 252.84it/s] 77%|███████▋  | 774/1000 [00:03<00:00, 253.96it/s]Step799:rank0, time: 0.390, per_step: 0.003865
 80%|████████  | 800/1000 [00:03<00:00, 252.59it/s] 83%|████████▎ | 826/1000 [00:03<00:00, 250.61it/s] 85%|████████▌ | 852/1000 [00:03<00:00, 251.70it/s] 88%|████████▊ | 878/1000 [00:03<00:00, 249.04it/s]Step899:rank0, time: 0.411, per_step: 0.004072
 90%|█████████ | 903/1000 [00:03<00:00, 243.61it/s] 93%|█████████▎| 928/1000 [00:03<00:00, 234.04it/s] 95%|█████████▌| 953/1000 [00:03<00:00, 236.43it/s] 98%|█████████▊| 977/1000 [00:04<00:00, 237.01it/s]Step999:rank0, time: 0.424, per_step: 0.004194
100%|██████████| 1000/1000 [00:04<00:00, 240.42it/s]
Worker 0 pid=29314
Successfully xmh
