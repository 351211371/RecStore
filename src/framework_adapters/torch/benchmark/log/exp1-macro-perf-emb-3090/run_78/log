perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7faa92e89ee0>==========
Worker 0 pid=42144
Worker 1 pid=42145
Worker 2 pid=42146
Worker 3 pid=42147
Worker 4 pid=42148
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 6 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
Step99:rank4, time: 445.456, per_step: 4.454556
Step99:rank1, time: 448.641, per_step: 4.486407
Step99:rank2, time: 451.376, per_step: 4.513764
Step99:rank3, time: 460.929, per_step: 4.609287
Step99:rank5, time: 463.952, per_step: 4.639522
Step99:rank0, time: 464.036, per_step: 4.640358
Step199:rank2, time: 459.971, per_step: 4.554169
Step199:rank3, time: 452.230, per_step: 4.477524
Step199:rank4, time: 469.143, per_step: 4.644978
Step199:rank1, time: 470.293, per_step: 4.656365
Step199:rank5, time: 457.730, per_step: 4.531982
Step199:rank0, time: 466.532, per_step: 4.619129
Step299:rank2, time: 443.051, per_step: 4.386643
Step299:rank1, time: 451.524, per_step: 4.470536
Step299:rank4, time: 457.684, per_step: 4.531524
Step299:rank3, time: 463.750, per_step: 4.591584
Step299:rank0, time: 449.308, per_step: 4.448590
Step299:rank5, time: 462.636, per_step: 4.580551
Step399:rank0, time: 441.311, per_step: 4.369418
Step399:rank2, time: 466.905, per_step: 4.622822
Step399:rank1, time: 459.468, per_step: 4.549192
Step399:rank3, time: 457.818, per_step: 4.532851
Step399:rank4, time: 466.994, per_step: 4.623700
Step399:rank5, time: 468.150, per_step: 4.635151
Step499:rank4, time: 431.081, per_step: 4.268132
Step499:rank1, time: 444.145, per_step: 4.397478
Step499:rank2, time: 459.978, per_step: 4.554240
Step499:rank3, time: 455.834, per_step: 4.513211
Step499:rank0, time: 470.954, per_step: 4.662907
Step499:rank5, time: 452.701, per_step: 4.482184
Worker 5 pid=42149
Successfully xmh
