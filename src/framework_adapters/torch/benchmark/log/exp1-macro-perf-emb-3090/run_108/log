perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f093f244ee0>==========
Worker 0 pid=36735
Worker 1 pid=36736
Worker 2 pid=36737
Worker 3 pid=36738
Worker 4 pid=36741
Worker 5 pid=36746
Worker 6 pid=36747
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
weight.shape torch.Size([10000000, 32])
Step99:rank0, time: 90.241, per_step: 0.902406
Step99:rank5, time: 91.997, per_step: 0.919967
Step99:rank4, time: 92.227, per_step: 0.922266
Step99:rank3, time: 93.268, per_step: 0.932678
Step99:rank2, time: 93.776, per_step: 0.937759
Step99:rank1, time: 95.219, per_step: 0.952193
Step99:rank7, time: 97.916, per_step: 0.979160
Step99:rank6, time: 98.334, per_step: 0.983337
Step199:rank0, time: 90.844, per_step: 0.899442
Step199:rank2, time: 89.223, per_step: 0.883392
Step199:rank4, time: 92.737, per_step: 0.918187
Step199:rank5, time: 93.662, per_step: 0.927347
Step199:rank1, time: 91.090, per_step: 0.901877
Step199:rank6, time: 88.316, per_step: 0.874413
Step199:rank3, time: 96.046, per_step: 0.950953
Step199:rank7, time: 93.386, per_step: 0.924616
Step299:rank2, time: 88.719, per_step: 0.878410
Step299:rank1, time: 85.806, per_step: 0.849560
Step299:rank0, time: 92.037, per_step: 0.911258
Step299:rank4, time: 89.015, per_step: 0.881333
Step299:rank5, time: 89.780, per_step: 0.888916
Step299:rank6, time: 95.479, per_step: 0.945334
Step299:rank7, time: 93.001, per_step: 0.920803
Step299:rank3, time: 96.918, per_step: 0.959581
Step399:rank1, time: 89.710, per_step: 0.888216
Step399:rank2, time: 90.187, per_step: 0.892945
Step399:rank0, time: 89.105, per_step: 0.882223
Step399:rank4, time: 88.365, per_step: 0.874901
Step399:rank5, time: 97.873, per_step: 0.969036
Step399:rank7, time: 93.454, per_step: 0.925291
Step399:rank6, time: 97.055, per_step: 0.960940
Step399:rank3, time: 93.379, per_step: 0.924542
Step499:rank2, time: 85.689, per_step: 0.848403
Step499:rank4, time: 86.951, per_step: 0.860897
Step499:rank1, time: 88.701, per_step: 0.878223
Step499:rank0, time: 91.727, per_step: 0.908191
Step499:rank5, time: 86.254, per_step: 0.854003
Step499:rank7, time: 85.873, per_step: 0.850228
Step499:rank6, time: 85.468, per_step: 0.846218
Step499:rank3, time: 86.165, per_step: 0.853114
Worker 7 pid=36748
Successfully xmh
