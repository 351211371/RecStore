perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f078bc3cee0>==========
Worker 0 pid=25746
Worker 1 pid=25747
Worker 2 pid=25748
Worker 3 pid=25749
Worker 4 pid=25750
Worker 5 pid=25751
Worker 6 pid=25752
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [distributed_c10d.py:466] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([100000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([100000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([100000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([100000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([100000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([100000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([100000000, 32])
cudaHostRegister cudaError.success, type(r)=<class 'torch._C._cudart.cudaError'>
weight.shape torch.Size([100000000, 32])
Step99:rank7, time: 26.850, per_step: 0.268501
Step99:rank3, time: 22.983, per_step: 0.229832
Step99:rank4, time: 22.894, per_step: 0.228944
Step99:rank6, time: 23.051, per_step: 0.230513
Step99:rank1, time: 22.764, per_step: 0.227638
Step99:rank2, time: 22.760, per_step: 0.227597
Step99:rank5, time: 22.963, per_step: 0.229629
Step99:rank0, time: 22.890, per_step: 0.228900
Step199:rank1, time: 20.960, per_step: 0.207523
Step199:rank5, time: 20.960, per_step: 0.207525
Step199:rank7, time: 20.989, per_step: 0.207810
Step199:rank6, time: 20.972, per_step: 0.207643
Step199:rank4, time: 20.978, per_step: 0.207705
Step199:rank2, time: 20.977, per_step: 0.207696
Step199:rank3, time: 20.993, per_step: 0.207854
Step199:rank0, time: 20.996, per_step: 0.207879
Step299:rank7, time: 20.617, per_step: 0.204130
Step299:rank6, time: 20.614, per_step: 0.204094
Step299:rank5, time: 20.625, per_step: 0.204208
Step299:rank3, time: 20.609, per_step: 0.204052
Step299:rank1, time: 20.633, per_step: 0.204284
Step299:rank4, time: 20.615, per_step: 0.204109
Step299:rank2, time: 20.640, per_step: 0.204353
Step299:rank0, time: 20.633, per_step: 0.204282
Step399:rank6, time: 20.330, per_step: 0.201288
Step399:rank5, time: 20.328, per_step: 0.201264
Step399:rank7, time: 20.334, per_step: 0.201325
Step399:rank4, time: 20.341, per_step: 0.201400
Step399:rank1, time: 20.370, per_step: 0.201679
Step399:rank2, time: 20.345, per_step: 0.201433
Step399:rank3, time: 20.398, per_step: 0.201964
Step399:rank0, time: 20.342, per_step: 0.201403
Step499:rank4, time: 21.112, per_step: 0.209031
Step499:rank1, time: 21.092, per_step: 0.208829
Step499:rank3, time: 21.069, per_step: 0.208601
Step499:rank6, time: 21.147, per_step: 0.209372
Step499:rank2, time: 21.100, per_step: 0.208914
Step499:rank5, time: 21.149, per_step: 0.209392
Step499:rank7, time: 21.154, per_step: 0.209449
Step499:rank0, time: 21.173, per_step: 0.209636
Worker 7 pid=25753
Successfully xmh
