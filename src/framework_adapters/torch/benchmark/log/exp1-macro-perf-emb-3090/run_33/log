perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7faa00523e50>==========
Worker 0 pid=2453
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 1/1000 [00:01<23:52,  1.43s/it]  1%|          | 10/1000 [00:01<01:52,  8.76it/s]  0%|          | 1/1000 [00:01<25:45,  1.55s/it]  3%|▎         | 26/1000 [00:01<00:37, 25.86it/s]  1%|          | 7/1000 [00:01<02:55,  5.66it/s]  4%|▍         | 38/1000 [00:01<00:24, 38.86it/s]  2%|▏         | 15/1000 [00:01<01:12, 13.57it/s]  6%|▌         | 56/1000 [00:01<00:15, 61.81it/s]  2%|▏         | 24/1000 [00:01<00:41, 23.45it/s]  8%|▊         | 84/1000 [00:01<00:08, 103.00it/s]  4%|▎         | 35/1000 [00:01<00:26, 37.07it/s]Step99:rank1, time: 1.996, per_step: 0.019957
 13%|█▎        | 127/1000 [00:02<00:05, 172.44it/s]  5%|▌         | 52/1000 [00:02<00:15, 61.24it/s] 18%|█▊        | 179/1000 [00:02<00:03, 252.58it/s]  8%|▊         | 75/1000 [00:02<00:09, 95.35it/s]Step199:rank1, time: 0.208, per_step: 0.002063
Step99:rank0, time: 2.254, per_step: 0.022544
 24%|██▎       | 236/1000 [00:02<00:02, 330.72it/s] 11%|█         | 107/1000 [00:02<00:06, 145.78it/s] 30%|██▉       | 299/1000 [00:02<00:01, 408.69it/s]Step299:rank1, time: 0.163, per_step: 0.001613
 16%|█▌        | 155/1000 [00:02<00:03, 227.35it/s] 35%|███▍      | 347/1000 [00:02<00:01, 425.05it/s]Step199:rank0, time: 0.219, per_step: 0.002165
 20%|██        | 205/1000 [00:02<00:02, 297.05it/s]Step399:rank1, time: 0.180, per_step: 0.001783
 41%|████▏     | 414/1000 [00:02<00:01, 491.76it/s] 26%|██▋       | 265/1000 [00:02<00:01, 378.27it/s]Step299:rank0, time: 0.164, per_step: 0.001627
 48%|████▊     | 475/1000 [00:02<00:01, 524.02it/s] 33%|███▎      | 330/1000 [00:02<00:01, 453.00it/s]Step499:rank1, time: 0.164, per_step: 0.001624
 53%|█████▎    | 534/1000 [00:02<00:00, 541.89it/s] 40%|███▉      | 398/1000 [00:02<00:01, 515.49it/s]Step399:rank0, time: 0.149, per_step: 0.001478
 45%|████▌     | 453/1000 [00:02<00:01, 524.68it/s] 59%|█████▉    | 591/1000 [00:02<00:00, 528.42it/s]Step599:rank1, time: 0.188, per_step: 0.001859
Step499:rank0, time: 0.171, per_step: 0.001691
 52%|█████▏    | 518/1000 [00:02<00:00, 560.99it/s] 66%|██████▌   | 657/1000 [00:02<00:00, 563.65it/s]Step699:rank1, time: 0.155, per_step: 0.001538
 59%|█████▊    | 586/1000 [00:03<00:00, 593.51it/s] 72%|███████▏  | 720/1000 [00:03<00:00, 582.12it/s]Step599:rank0, time: 0.149, per_step: 0.001474
 65%|██████▌   | 650/1000 [00:03<00:00, 606.44it/s] 78%|███████▊  | 780/1000 [00:03<00:00, 583.34it/s]Step799:rank1, time: 0.165, per_step: 0.001631
Step699:rank0, time: 0.153, per_step: 0.001517
 72%|███████▏  | 717/1000 [00:03<00:00, 620.78it/s] 84%|████████▍ | 845/1000 [00:03<00:00, 600.34it/s]Step899:rank1, time: 0.165, per_step: 0.001638
 78%|███████▊  | 781/1000 [00:03<00:00, 624.44it/s] 91%|█████████ | 906/1000 [00:03<00:00, 597.65it/s]Step799:rank0, time: 0.169, per_step: 0.001670
 84%|████████▍ | 844/1000 [00:03<00:00, 619.34it/s] 97%|█████████▋| 968/1000 [00:03<00:00, 602.28it/s]Step999:rank1, time: 0.166, per_step: 0.001648
100%|██████████| 1000/1000 [00:03<00:00, 282.32it/s]
Step899:rank0, time: 0.161, per_step: 0.001596
 91%|█████████ | 907/1000 [00:03<00:00, 609.94it/s] 97%|█████████▋| 969/1000 [00:03<00:00, 609.65it/s]Step999:rank0, time: 0.159, per_step: 0.001570
100%|██████████| 1000/1000 [00:03<00:00, 267.41it/s]
Worker 1 pid=2454
Successfully xmh
