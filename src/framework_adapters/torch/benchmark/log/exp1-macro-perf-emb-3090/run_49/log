perf_emb.py:126: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("Before init DistEmbedding")
WARNING [perf_emb.py:126] Before init DistEmbedding
perf_emb.py:129: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  logging.warn("After init DistEmbedding")
WARNING [perf_emb.py:129] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fe9ce4beee0>==========
Worker 0 pid=35224
Worker 1 pid=35225
Worker 2 pid=35226
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [distributed_c10d.py:466] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [distributed_c10d.py:432] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [distributed_c10d.py:466] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [distributed_c10d.py:466] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [distributed_c10d.py:466] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
weight.shape torch.Size([100000000, 32])
Step99:rank2, time: 18.859, per_step: 0.188587
Step99:rank1, time: 18.969, per_step: 0.189690
Step99:rank3, time: 18.893, per_step: 0.188928
Step99:rank0, time: 18.894, per_step: 0.188943
Step199:rank3, time: 18.552, per_step: 0.183688
Step199:rank1, time: 18.554, per_step: 0.183706
Step199:rank2, time: 18.555, per_step: 0.183713
Step199:rank0, time: 18.563, per_step: 0.183797
Step299:rank2, time: 17.551, per_step: 0.173772
Step299:rank1, time: 17.552, per_step: 0.173786
Step299:rank3, time: 17.560, per_step: 0.173862
Step299:rank0, time: 17.567, per_step: 0.173934
Step399:rank3, time: 17.616, per_step: 0.174416
Step399:rank2, time: 17.626, per_step: 0.174512
Step399:rank1, time: 17.627, per_step: 0.174522
Step399:rank0, time: 17.610, per_step: 0.174354
Step499:rank1, time: 17.546, per_step: 0.173723
Step499:rank3, time: 17.549, per_step: 0.173756
Step499:rank2, time: 17.551, per_step: 0.173770
Step499:rank0, time: 17.560, per_step: 0.173864
Worker 3 pid=35227
Successfully xmh
