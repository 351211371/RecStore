WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240207 22:38:33.077405 490548 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_148', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=2, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=2, gpu=[0, 1], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, nr_background_threads=32, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [490548 sampler.py:454] Start PreSampling
WARNING [490548 sampler.py:532] Before construct renumbering_dict
WARNING [490548 sampler.py:555] PreSampling done
W20240207 22:38:35.049818 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240207 22:38:35.049983 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240207 22:38:35.050007 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240207 22:38:35.050026 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240207 22:38:35.050046 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240207 22:38:35.050065 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240207 22:38:35.050081 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240207 22:38:35.050103 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240207 22:38:35.050122 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240207 22:38:35.050143 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240207 22:38:35.050168 490548 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240207 22:38:35.050185 490548 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240207 22:38:35.050199 490548 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240207 22:38:35.050284 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240207 22:38:35.050312 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240207 22:38:35.050328 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240207 22:38:35.050356 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240207 22:38:35.050374 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240207 22:38:35.050390 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240207 22:38:35.050411 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240207 22:38:35.050431 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240207 22:38:35.050449 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240207 22:38:35.050469 490548 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240207 22:38:35.050487 490548 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240207 22:38:35.050501 490548 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240207 22:38:35.050513 490548 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240207 22:38:35.187449 490548 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x1000098ca000 22.81 MB
W20240207 22:38:35.215086 490548 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10000af9c000 58.4 kB
{0: Graph(num_nodes=13458, num_edges=276636,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=12796, num_edges=383671,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 13458 N 276636 E
MertisPartition: part 1 has 12796 N 383671 E
Rank0: cached key size 373
Rank1: cached key size 373
Before renumbering graph:  {'_ID': tensor([    0,     2,     6,  ..., 11079,  2237, 14365]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
After renumbering graph:  {'_ID': tensor([  754,   817,   967,  ..., 12870, 10544,  9563]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 1, 1])}
part_g: DGLGraph(num_nodes=13458, num_edges=276636,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=13458, num_edges=276636,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.167 seconds
INFO [490759 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [490759 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
INFO [490548 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [490548 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
W20240207 22:38:36.776362 490760 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240207 22:38:36.776855 490760 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10000afae000 7.629 MB
W20240207 22:38:36.776993 490760 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10000b751000 7.629 MB
W20240207 22:38:36.777068 490760 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10000bef4000 1.49 GB
W20240207 22:38:36.777119 490760 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x10006b4d7000 1.49 GB
W20240207 22:38:36.777179 490760 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 22:38:36.781311 490760 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240207 22:38:36.781845 490800 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240207 22:38:36.785288 490800 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000caac0000 7.629 MB
W20240207 22:38:36.785426 490800 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000cb263000 7.629 MB
W20240207 22:38:36.785485 490800 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1000cba06000 1.49 GB
W20240207 22:38:36.785516 490800 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10012afe9000 1.49 GB
W20240207 22:38:36.785555 490800 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240207 22:38:36.788414 490800 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
cudaHostRegister 0x1000098ca000
1: KnownLocalCachedEmbedding init done
WARNING [490759 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank1] pid = 490759
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494)]
cudaHostRegister 0x1000098ca000
0: KnownLocalCachedEmbedding init done
WARNING [490548 DistTensor.py:59] The tensor name already exists in the kvstore
I20240207 22:38:37.587170 490760 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 2
I20240207 22:38:37.587252 490800 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 2
W20240207 22:38:37.588042 490760 grad_base.h:55] KGCacheController, config={
        "num_gpus": 2,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 0.01,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240207 22:38:37.588120 490760 grad_base.h:184] Init GradProcessingBase done
I20240207 22:38:37.591311 490760 grad_async_v2.h:42] Use main thread to update emb.
W20240207 22:38:37.591331 490760 kg_controller.h:78] after init GradAsyncProcessingV2
I20240207 22:38:37.591333 490760 kg_controller.h:84] Construct KGCacheController done
E20240207 22:38:37.788741 490760 recstore.cc:66] init folly done
E20240207 22:38:37.788848 490800 recstore.cc:66] init folly done
I20240207 22:38:37.789299 490760 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240207 22:38:38.007454 491023 grad_async_v2.h:137] Detect new sample comes, old_end0, new_end1
E20240207 22:38:38.007738 491023 parallel_pq_v2.h:79] insert failed, size(hashtable)=1
I20240207 22:38:38.037954 490760 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 2
I20240207 22:38:38.078641 490800 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 2
E20240207 22:38:39.258469 490925 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240207 22:38:39.270455 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=1, pq.top=0
W20240207 22:38:39.273583 491023 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
E20240207 22:38:39.945436 490760 grad_async_v2.h:404] Stalled in ProcessBackward: rank=1, step_no=25, sample_step_cpp_seen_[rank]=24
E20240207 22:38:40.258145 491023 parallel_pq_v2.h:79] insert failed, size(hashtable)=0
W20240207 22:38:40.270007 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=38, pq.top=38
W20240207 22:38:40.286170 491023 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
E20240207 22:38:41.258006 490925 parallel_pq_v2.h:79] insert failed, size(hashtable)=319
W20240207 22:38:41.287446 491023 grad_async_v2.h:137] Detect new sample comes, old_end4, new_end5
W20240207 22:38:41.316848 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=76, pq.top=76
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 3.834, sample: 0.202, forward: 0.891, backward: 0.795, update: 0.145
train_sampler.Prefill()
-------Step 0-------
tensor([10991,  9756, 11115, 14423,  1954,  1710,  1932,  8830,  1652,  6933]) tensor([  999,  3380,  5786,  7213, 13969,  7969,  8980, 12132,  3854, 14846])
-------Step 1-------
tensor([10991,  9756, 11115, 14423,  1954,  1710,  1932,  8830,  1652,  6933]) tensor([13399,  5654, 12331,  6127, 11868,  1693,  5587,  2384,  1454, 11737])
-------Step 2-------
tensor([  184,  2224, 12039,   191,  5696,  8739,  1613,     6,     0,    36]) tensor([  292,  6066,   598, 10006, 13999, 14263,  7000,  6847,  3606,  3917])
-------Step 3-------
tensor([  184,  2224, 12039,   191,  5696,  8739,  1613,     6,     0,    36]) tensor([ 2321,   424,  4769,  7046, 10302, 14949,  6277,  2654, 11789,  4252])
-------Step 4-------
tensor([ 7247,  6176,  8970, 10388, 12355,  4676, 11690, 11178,   284,  6937]) tensor([ 2595, 12482,  4202,  7990,  7559, 10471,  1981, 14046,  7565, 10446])
-------Step 5-------
tensor([ 7247,  6176,  8970, 10388, 12355,  4676, 11690, 11178,   284,  6937]) tensor([ 4919,  3697,   942, 12266, 13985,  3588,  5107,  4725,  9850,  4822])
-------Step 6-------
tensor([12492,   235, 10000, 10266,  5294,  8768, 10830,   282,  9371,    53]) tensor([ 7806,  7420,  8744, 11808, 14672,  2300, 11122, 11978, 14811,  6174])
-------Step 7-------
tensor([12492,   235, 10000, 10266,  5294,  8768, 10830,   282,  9371,    53]) tensor([ 2385,  6819, 13004, 14136,  4220,  9865, 12716, 12243, 13407,  9280])
-------Step 8-------
tensor([ 5671,  8894,  6893,     1, 14423,  4902,  2812,   421,  9753, 12740]) tensor([ 2026,  7883,  2660, 13441,  5751,   801,  5374,  7972,  9680, 10186])
-------Step 9-------
tensor([ 5671,  8894,  6893,     1, 14423,  4902,  2812,   421,  9753, 12740]) tensor([ 8463,  9624,  8043, 14200,   655,  2011, 10049, 11991,  6687,  5598])
before start barrier
start train
[proc 0] 100 steps, total: 3.875, sample: 0.289, forward: 0.935, backward: 0.691, update: 0.180
E20240207 22:38:42.258026 491047 parallel_pq_v2.h:79] insert failed, size(hashtable)=7786
W20240207 22:38:42.287272 491023 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end3
W20240207 22:38:42.319284 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=114, pq.top=114
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 898.985 us                | 19.000 ms                 |
| Forward                   | 3.281 ms                  | 15.797 ms                 |
| Backward                  | 3.174 ms                  | 94.704 ms                 |
| Optimize                  | 1.487 ms                  | 3.207 ms                  |
| BarrierTimeBeforeRank0    | 1.035 ms                  | 5.633 ms                  |
| AfterBackward             | 11.270 ms                 | 71.721 ms                 |
| BlockToStepN              | 397.989 us                | 2.128 ms                  |
| OneStep                   | 23.539 ms                 | 129.022 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 303.736 us                | 2.042 ms                  |
| ProcessBack:Shuffle       | 671.537 us                | 1.177 ms                  |
| ProcessBack:UpdateCache   | 335.059 us                | 729.427 us                |
| ProcessBack:UpsertPq      | 9.211 ms                  | 13.318 ms                 |
| ProcessOneStep            | 11.042 ms                 | 71.690 ms                 |
| BlockToStepN              | 384.636 us                | 2.093 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240207 22:38:43.258284 491036 parallel_pq_v2.h:79] insert failed, size(hashtable)=8219
W20240207 22:38:43.308800 491023 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240207 22:38:43.332330 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=152, pq.top=152
E20240207 22:38:44.258868 491054 parallel_pq_v2.h:79] insert failed, size(hashtable)=31
W20240207 22:38:44.308226 491023 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240207 22:38:44.333828 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=186, pq.top=186
[proc 1] 200 steps, total: 2.827, sample: 0.314, forward: 0.347, backward: 0.389, update: 0.132
[proc 0] 200 steps, total: 2.827, sample: 0.387, forward: 0.366, backward: 0.300, update: 0.162
E20240207 22:38:45.258020 490760 parallel_pq_v2.h:79] insert failed, size(hashtable)=987
W20240207 22:38:45.322758 491023 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240207 22:38:45.346850 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=222, pq.top=222
E20240207 22:38:46.258008 490760 parallel_pq_v2.h:79] insert failed, size(hashtable)=627
W20240207 22:38:46.328585 491023 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240207 22:38:46.379104 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=257, pq.top=257
E20240207 22:38:47.258023 491037 parallel_pq_v2.h:79] insert failed, size(hashtable)=9900
W20240207 22:38:47.334992 491023 grad_async_v2.h:137] Detect new sample comes, old_end8, new_end9
W20240207 22:38:47.419255 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=291, pq.top=291
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.587 ms                  | 22.238 ms                 |
| Forward                   | 3.657 ms                  | 7.655 ms                  |
| Backward                  | 3.094 ms                  | 6.321 ms                  |
| Optimize                  | 1.485 ms                  | 3.256 ms                  |
| BarrierTimeBeforeRank0    | 20.646 us                 | 12.078 ms                 |
| AfterBackward             | 12.690 ms                 | 61.273 ms                 |
| BlockToStepN              | 1.010 ms                  | 5.165 ms                  |
| OneStep                   | 25.986 ms                 | 83.178 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 2.980, sample: 0.286, forward: 0.362, backward: 0.288, update: 0.134
[proc 0] 300 steps, total: 2.980, sample: 0.401, forward: 0.369, backward: 0.343, update: 0.137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 431.095 us                | 4.242 ms                  |
| ProcessBack:Shuffle       | 700.478 us                | 1.307 ms                  |
| ProcessBack:UpdateCache   | 295.219 us                | 625.941 us                |
| ProcessBack:UpsertPq      | 10.003 ms                 | 15.983 ms                 |
| ProcessOneStep            | 12.702 ms                 | 61.252 ms                 |
| BlockToStepN              | 989.646 us                | 5.098 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240207 22:38:48.258018 491029 parallel_pq_v2.h:79] insert failed, size(hashtable)=7725
W20240207 22:38:48.343314 491023 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240207 22:38:48.419224 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=324, pq.top=324
E20240207 22:38:49.258178 491042 parallel_pq_v2.h:79] insert failed, size(hashtable)=10540
W20240207 22:38:49.344997 491023 grad_async_v2.h:137] Detect new sample comes, old_end3, new_end4
W20240207 22:38:49.447976 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240207 22:38:50.258008 490925 parallel_pq_v2.h:79] insert failed, size(hashtable)=1372
W20240207 22:38:50.351347 491023 grad_async_v2.h:137] Detect new sample comes, old_end5, new_end6
W20240207 22:38:50.467197 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=389, pq.top=389
[proc 1] 400 steps, total: 3.104, sample: 0.297, forward: 0.355, backward: 0.294, update: 0.130
[proc 0] 400 steps, total: 3.104, sample: 0.391, forward: 0.363, backward: 0.315, update: 0.137
E20240207 22:38:51.258014 490760 parallel_pq_v2.h:79] insert failed, size(hashtable)=389
W20240207 22:38:51.355237 491023 grad_async_v2.h:137] Detect new sample comes, old_end7, new_end8
W20240207 22:38:51.477892 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=421, pq.top=421
E20240207 22:38:52.258656 491047 parallel_pq_v2.h:79] insert failed, size(hashtable)=8710
W20240207 22:38:52.366837 491023 grad_async_v2.h:137] Detect new sample comes, old_end9, new_end0
W20240207 22:38:52.492449 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=453, pq.top=453
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.673 ms                  | 21.122 ms                 |
| Forward                   | 3.725 ms                  | 5.450 ms                  |
| Backward                  | 3.101 ms                  | 6.311 ms                  |
| Optimize                  | 1.467 ms                  | 3.207 ms                  |
| BarrierTimeBeforeRank0    | 19.190 us                 | 13.643 ms                 |
| AfterBackward             | 13.786 ms                 | 18.354 ms                 |
| BlockToStepN              | 1.574 ms                  | 5.377 ms                  |
| OneStep                   | 27.303 ms                 | 50.680 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| clean                     | 449.205 us                | 4.086 ms                  |
| ProcessBack:Shuffle       | 706.613 us                | 1.379 ms                  |
| ProcessBack:UpdateCache   | 284.184 us                | 608.060 us                |
| ProcessBack:UpsertPq      | 10.369 ms                 | 16.212 ms                 |
| ProcessOneStep            | 13.777 ms                 | 18.334 ms                 |
| BlockToStepN              | 1.534 ms                  | 5.318 ms                  |
+---------------------------+---------------------------+---------------------------+
E20240207 22:38:53.258008 490760 parallel_pq_v2.h:79] insert failed, size(hashtable)=2785
W20240207 22:38:53.378316 491023 grad_async_v2.h:137] Detect new sample comes, old_end1, new_end2
W20240207 22:38:53.499696 490760 grad_async_v2.h:270] Sleep in <BlockToStepN>, step_no=485, pq.top=485
[proc 1] 500 steps, total: 3.147, sample: 0.291, forward: 0.357, backward: 0.294, update: 0.121
[proc 0] 500 steps, total: 3.147, sample: 0.414, forward: 0.364, backward: 0.303, update: 0.138
Successfully xmh. training takes 15.933274030685425 seconds
before call kg_cache_controller.StopThreads()
W20240207 22:38:53.971280 490760 grad_async_v2.h:84] call StopThreads. PID = 490548
W20240207 22:38:53.971312 490760 grad_base.h:212] before processOneStepNegThread_.join();
W20240207 22:38:53.971539 490760 grad_base.h:214] after processOneStepNegThread_.join();
W20240207 22:38:53.971544 490760 grad_async_v2.h:86] call GradProcessingBase::StopThreads.
W20240207 22:38:53.973626 490760 grad_async_v2.h:105] StopThreads done.
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
