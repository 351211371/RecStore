WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240201 01:11:15.322760 3384074 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_269', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=3, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=3, gpu=[0, 1, 2], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [3384074 sampler.py:454] Start PreSampling
WARNING [3384074 sampler.py:532] Before construct renumbering_dict
WARNING [3384074 sampler.py:555] PreSampling done
W20240201 01:11:17.430598 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240201 01:11:17.430716 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240201 01:11:17.430745 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240201 01:11:17.430763 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240201 01:11:17.430779 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240201 01:11:17.430794 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240201 01:11:17.430809 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240201 01:11:17.430828 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240201 01:11:17.430845 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240201 01:11:17.430861 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240201 01:11:17.430879 3384074 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240201 01:11:17.430896 3384074 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240201 01:11:17.430915 3384074 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240201 01:11:17.431013 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240201 01:11:17.431035 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240201 01:11:17.431051 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240201 01:11:17.431079 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240201 01:11:17.431097 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240201 01:11:17.431113 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240201 01:11:17.431128 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240201 01:11:17.431144 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240201 01:11:17.431159 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240201 01:11:17.431177 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240201 01:11:17.431193 3384074 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240201 01:11:17.431206 3384074 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240201 01:11:17.431221 3384074 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240201 01:11:17.431255 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240201 01:11:17.431273 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240201 01:11:17.431288 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240201 01:11:17.431310 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240201 01:11:17.431326 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240201 01:11:17.431341 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240201 01:11:17.431355 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240201 01:11:17.431370 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240201 01:11:17.431385 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240201 01:11:17.431407 3384074 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240201 01:11:17.431424 3384074 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240201 01:11:17.431438 3384074 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240201 01:11:17.431452 3384074 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240201 01:11:17.542523 3384074 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10000e52e000 22.81 MB
W20240201 01:11:17.569356 3384074 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10000fc00000 58.4 kB
{0: Graph(num_nodes=11296, num_edges=176344,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=12898, num_edges=253277,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12169, num_edges=314310,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 11296 N 176344 E
MertisPartition: part 1 has 12898 N 253277 E
MertisPartition: part 2 has 12169 N 314310 E
Rank0: cached key size 249
Rank1: cached key size 249
Rank2: cached key size 249
Before renumbering graph:  {'_ID': tensor([    0,     2,    10,  ...,  8580,   176, 12835]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 752,  820, 1042,  ..., 6302, 5935, 7076]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 2, 2])}
part_g: DGLGraph(num_nodes=11296, num_edges=176344,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=11296, num_edges=176344,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.277 seconds
[Rank1] pid = 3384286
INFO [3384074 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3384286 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3384351 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [3384351 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
W20240201 01:11:20.412318 3384389 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [747, 400]; dev=2; size=1.14 MB
W20240201 01:11:20.412843 3384389 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x10000fc12000 7.629 MB
W20240201 01:11:20.412982 3384389 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1000103b5000 7.629 MB
W20240201 01:11:20.413038 3384389 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 400]0x100010b58000 1.49 GB
W20240201 01:11:20.413074 3384389 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x10007013b000 1.49 GB
W20240201 01:11:20.413112 3384389 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240201 01:11:20.415325 3384389 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
INFO [3384286 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
W20240201 01:11:20.419171 3384287 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [747, 400]; dev=1; size=1.14 MB
W20240201 01:11:20.419471 3384287 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000cf724000 7.629 MB
W20240201 01:11:20.419557 3384287 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x1000cfec7000 7.629 MB
INFO [3384074 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
W20240201 01:11:20.419595 3384287 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 400]0x1000d066a000 1.49 GB
W20240201 01:11:20.419626 3384287 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x10012fc4d000 1.49 GB
W20240201 01:11:20.419656 3384287 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240201 01:11:20.420256 3384352 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [747, 400]; dev=0; size=1.14 MB
W20240201 01:11:20.422147 3384287 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240201 01:11:20.422329 3384352 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x10018f234000 7.629 MB
W20240201 01:11:20.422472 3384352 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10018f9d7000 7.629 MB
W20240201 01:11:20.422555 3384352 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 400]0x10019017a000 1.49 GB
W20240201 01:11:20.422626 3384352 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1001ef75d000 1.49 GB
W20240201 01:11:20.422693 3384352 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240201 01:11:20.428776 3384352 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
cudaHostRegister 0x10000e52e000
2: KnownLocalCachedEmbedding init done
WARNING [3384351 DistTensor.py:59] The tensor name already exists in the kvstore
[Rank2] pid = 3384351
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241)]
cudaHostRegister 0x10000e52e000
0: KnownLocalCachedEmbedding init done
WARNING [3384074 DistTensor.py:59] The tensor name already exists in the kvstore
cudaHostRegister 0x10000e52e000
1: KnownLocalCachedEmbedding init done
WARNING [3384286 DistTensor.py:59] The tensor name already exists in the kvstore
I20240201 01:11:21.399420 3384287 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 3
I20240201 01:11:21.399461 3384352 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
I20240201 01:11:21.399575 3384389 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
E20240201 01:11:21.686688 3384352 recstore.cc:66] init folly done
E20240201 01:11:21.686720 3384287 recstore.cc:66] init folly done
E20240201 01:11:21.686803 3384389 recstore.cc:66] init folly done
I20240201 01:11:21.756228 3384287 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 3
I20240201 01:11:21.769518 3384352 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
I20240201 01:11:21.772414 3384389 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.475 ms                  | 27.815 ms                 |
| Forward                   | 5.405 ms                  | 935.502 ms                |
| Backward                  | 55.667 ms                 | 2.401 s                   |
| Optimize                  | 18.360 ms                 | 35.917 ms                 |
| BarrierTimeBeforeRank0    | 75.933 us                 | 104.492 us                |
| BlockToStepN              | 15.844 us                 | 70.496 us                 |
| OneStep                   | 91.019 ms                 | 3.356 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.863 ms                  | 34.268 ms                 |
| Forward                   | 6.435 ms                  | 10.003 ms                 |
| Backward                  | 54.968 ms                 | 70.137 ms                 |
| Optimize                  | 20.391 ms                 | 38.013 ms                 |
| BarrierTimeBeforeRank0    | 63.940 us                 | 104.492 us                |
| BlockToStepN              | 17.835 us                 | 93.220 us                 |
| OneStep                   | 90.406 ms                 | 111.948 ms                |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 12.355, sample: 0.301, forward: 1.307, backward: 7.321, update: 0.174
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 12.339, sample: 0.325, forward: 1.180, backward: 7.424, update: 0.171
train_sampler.Prefill()
-------Step 0-------
tensor([  126, 13497,    96, 11336,  9996,  1721, 13210, 13437, 13461,   583]) tensor([1042, 7280, 5832, 9368, 9940, 8170, 5979, 4408, 4647, 9637])
-------Step 1-------
tensor([  126, 13497,    96, 11336,  9996,  1721, 13210, 13437, 13461,   583]) tensor([ 2025,  6499,  8468,  2809, 10728,  8898,  8261, 13494, 14790, 14895])
-------Step 2-------
tensor([ 9234,  7613, 14672,    19, 14699,  4378,  6878,  5842,  9025,  1549]) tensor([6930, 7282,  697, 7369, 4455, 3032, 1478, 1048, 5433, 4325])
-------Step 3-------
tensor([ 9234,  7613, 14672,    19, 14699,  4378,  6878,  5842,  9025,  1549]) tensor([ 7095,  7451,  9902, 10105,  6621,  7482, 14793,  6320,  7653,  5145])
-------Step 4-------
tensor([11748,  5988,  7494,   199,  8481,  1171, 12872, 11034,   246,  5161]) tensor([12664,  4817,  2863,  4615,  6453,  1940, 10399,  1964,  5040, 11156])
-------Step 5-------
tensor([11748,  5988,  7494,   199,  8481,  1171, 12872, 11034,   246,  5161]) tensor([12730, 10291, 12922, 11001,  8005,  7509,  3227,  4499,  9106,  9955])
-------Step 6-------
tensor([ 6927,  9018,  1721,  2480, 12269,  7023,  2668,    36,   171,  7039]) tensor([12855,   588, 10511,  1604,  7488,  4341,  9320,  9454, 12236, 14077])
-------Step 7-------
tensor([ 6927,  9018,  1721,  2480, 12269,  7023,  2668,    36,   171,  7039]) tensor([14919,  7144,    93, 13301, 13798,  8134, 14808,  7837, 10186, 10049])
-------Step 8-------
tensor([ 1310,  7633,  5518, 11197,  5341,  1241,  1859, 14797,  8506,  7528]) tensor([ 7368,  8858,  6451,  4527,  2370, 11963,  8784,  4999,  7955,   619])
-------Step 9-------
tensor([ 1310,  7633,  5518, 11197,  5341,  1241,  1859, 14797,  8506,  7528]) tensor([ 5575,  2209,  1765, 14731,  7634,  7978, 11729,  4228,  6746, 12010])
before start barrier
start train
[proc 0] 100 steps, total: 12.342, sample: 0.497, forward: 1.564, backward: 7.978, update: 2.183
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.897 ms                  | 34.373 ms                 |
| Forward                   | 6.712 ms                  | 10.003 ms                 |
| Backward                  | 54.968 ms                 | 70.137 ms                 |
| Optimize                  | 18.866 ms                 | 38.013 ms                 |
| BarrierTimeBeforeRank0    | 63.604 us                 | 105.848 us                |
| BlockToStepN              | 19.071 us                 | 99.338 us                 |
| OneStep                   | 89.022 ms                 | 115.876 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.911 ms                  | 34.373 ms                 |
| Forward                   | 6.805 ms                  | 10.110 ms                 |
| Backward                  | 55.919 ms                 | 71.776 ms                 |
| Optimize                  | 18.844 ms                 | 38.013 ms                 |
| BarrierTimeBeforeRank0    | 63.314 us                 | 104.492 us                |
| BlockToStepN              | 19.834 us                 | 112.782 us                |
| OneStep                   | 89.061 ms                 | 117.542 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 9.040, sample: 0.474, forward: 0.472, backward: 5.012, update: 0.221
[proc 0] 200 steps, total: 9.040, sample: 0.593, forward: 0.677, backward: 5.754, update: 1.888
[proc 1] 200 steps, total: 9.040, sample: 0.407, forward: 0.435, backward: 4.984, update: 0.214
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.918 ms                  | 34.450 ms                 |
| Forward                   | 6.826 ms                  | 10.110 ms                 |
| Backward                  | 56.923 ms                 | 73.930 ms                 |
| Optimize                  | 18.556 ms                 | 38.013 ms                 |
| BarrierTimeBeforeRank0    | 62.867 us                 | 104.492 us                |
| BlockToStepN              | 20.484 us                 | 193.549 us                |
| OneStep                   | 89.813 ms                 | 117.542 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.926 ms                  | 34.450 ms                 |
| Forward                   | 6.855 ms                  | 10.003 ms                 |
| Backward                  | 58.031 ms                 | 93.160 ms                 |
| Optimize                  | 18.556 ms                 | 37.319 ms                 |
| BarrierTimeBeforeRank0    | 62.600 us                 | 103.102 us                |
| BlockToStepN              | 20.815 us                 | 112.782 us                |
| OneStep                   | 90.364 ms                 | 125.769 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 300 steps, total: 9.656, sample: 0.424, forward: 0.465, backward: 5.585, update: 0.219
[proc 1] 300 steps, total: 9.656, sample: 0.440, forward: 0.469, backward: 5.573, update: 0.238
[proc 0] 300 steps, total: 9.656, sample: 0.531, forward: 0.663, backward: 6.405, update: 1.930
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.930 ms                  | 34.638 ms                 |
| Forward                   | 6.859 ms                  | 10.003 ms                 |
| Backward                  | 58.553 ms                 | 94.188 ms                 |
| Optimize                  | 18.551 ms                 | 37.319 ms                 |
| BarrierTimeBeforeRank0    | 61.060 us                 | 103.102 us                |
| BlockToStepN              | 21.250 us                 | 112.782 us                |
| OneStep                   | 90.480 ms                 | 129.758 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.930 ms                  | 34.638 ms                 |
| Forward                   | 6.858 ms                  | 9.980 ms                  |
| Backward                  | 58.587 ms                 | 98.118 ms                 |
| Optimize                  | 18.608 ms                 | 38.013 ms                 |
| BarrierTimeBeforeRank0    | 60.542 us                 | 102.570 us                |
| BlockToStepN              | 21.346 us                 | 112.782 us                |
| OneStep                   | 91.053 ms                 | 131.939 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 400 steps, total: 9.732, sample: 0.432, forward: 0.468, backward: 5.634, update: 0.225
[proc 1] 400 steps, total: 9.732, sample: 0.385, forward: 0.448, backward: 5.724, update: 0.212
[proc 0] 400 steps, total: 9.732, sample: 0.542, forward: 0.654, backward: 6.395, update: 2.015
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.939 ms                  | 34.663 ms                 |
| Forward                   | 6.859 ms                  | 10.003 ms                 |
| Backward                  | 58.761 ms                 | 98.118 ms                 |
| Optimize                  | 18.595 ms                 | 38.013 ms                 |
| BarrierTimeBeforeRank0    | 60.033 us                 | 102.570 us                |
| BlockToStepN              | 21.726 us                 | 155.196 us                |
| OneStep                   | 91.440 ms                 | 131.939 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.939 ms                  | 34.638 ms                 |
| Forward                   | 6.855 ms                  | 9.980 ms                  |
| Backward                  | 59.074 ms                 | 98.118 ms                 |
| Optimize                  | 18.595 ms                 | 38.013 ms                 |
| BarrierTimeBeforeRank0    | 59.873 us                 | 101.910 us                |
| BlockToStepN              | 21.876 us                 | 193.549 us                |
| OneStep                   | 91.915 ms                 | 130.914 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 500 steps, total: 9.879, sample: 0.546, forward: 0.669, backward: 6.578, update: 1.958
[proc 2] 500 steps, total: 9.879, sample: 0.500, forward: 0.474, backward: 5.790, update: 0.225
[proc 1] 500 steps, total: 9.879, sample: 0.488, forward: 0.466, backward: 5.800, update: 0.229
Successfully xmh. training takes 50.64901518821716 seconds
before call kg_cache_controller.StopThreads()
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
INFO [3384074 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.937 ms                  | 34.638 ms                 |
| Forward                   | 6.855 ms                  | 9.980 ms                  |
| Backward                  | 59.166 ms                 | 98.118 ms                 |
| Optimize                  | 18.592 ms                 | 38.013 ms                 |
| BarrierTimeBeforeRank0    | 59.873 us                 | 101.910 us                |
| BlockToStepN              | 21.871 us                 | 193.549 us                |
| OneStep                   | 92.146 ms                 | 130.914 ms                |
+---------------------------+---------------------------+---------------------------+
