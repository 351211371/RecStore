WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240201 01:14:08.155666 3388108 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_272', no_save_emb=True, max_step=500, batch_size=2000, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=3, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=3, gpu=[0, 1, 2], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KGExternelEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [3388108 sampler.py:454] Start PreSampling
WARNING [3388108 sampler.py:532] Before construct renumbering_dict
WARNING [3388108 sampler.py:555] PreSampling done
W20240201 01:14:10.266049 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240201 01:14:10.266194 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240201 01:14:10.266218 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240201 01:14:10.266238 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240201 01:14:10.266259 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240201 01:14:10.266283 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240201 01:14:10.266306 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240201 01:14:10.266335 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240201 01:14:10.266356 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240201 01:14:10.266376 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240201 01:14:10.266417 3388108 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240201 01:14:10.266438 3388108 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240201 01:14:10.266455 3388108 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240201 01:14:10.266556 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240201 01:14:10.266583 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240201 01:14:10.266602 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240201 01:14:10.266634 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240201 01:14:10.266652 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240201 01:14:10.266670 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240201 01:14:10.266695 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240201 01:14:10.266718 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240201 01:14:10.266739 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240201 01:14:10.266762 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240201 01:14:10.266781 3388108 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240201 01:14:10.266796 3388108 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240201 01:14:10.266811 3388108 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240201 01:14:10.266847 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240201 01:14:10.266873 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240201 01:14:10.266891 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240201 01:14:10.266912 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240201 01:14:10.266930 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240201 01:14:10.266947 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240201 01:14:10.266964 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240201 01:14:10.266985 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240201 01:14:10.267002 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240201 01:14:10.267024 3388108 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240201 01:14:10.267041 3388108 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240201 01:14:10.267056 3388108 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240201 01:14:10.267071 3388108 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240201 01:14:10.387782 3388108 IPCTensor.h:369] NewIPCTensor: full_emb [14951, 400]0x10000e52e000 22.81 MB
W20240201 01:14:10.414707 3388108 IPCTensor.h:369] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x10000fc00000 58.4 kB
{0: Graph(num_nodes=11296, num_edges=176344,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=12898, num_edges=253277,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12169, num_edges=314310,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 11296 N 176344 E
MertisPartition: part 1 has 12898 N 253277 E
MertisPartition: part 2 has 12169 N 314310 E
Rank0: cached key size 249
Rank1: cached key size 249
Rank2: cached key size 249
Before renumbering graph:  {'_ID': tensor([    0,     2,    10,  ...,  8580,   176, 12835]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 2, 2])}
After renumbering graph:  {'_ID': tensor([ 752,  828, 1102,  ..., 5980, 7308, 7236]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 1, 2, 2])}
part_g: DGLGraph(num_nodes=11296, num_edges=176344,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=11296, num_edges=176344,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.288 seconds
[Rank1] pid = 3388335
INFO [3388108 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [3388335 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [3388108 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
INFO [3388400 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
WARNING [3388108 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [3388400 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
WARNING [3388400 DistTensor.py:59] The tensor name already exists in the kvstore
INFO [3388335 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 3 nodes.
WARNING [3388335 DistTensor.py:59] The tensor name already exists in the kvstore
I20240201 01:14:13.172554 3388336 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 3
I20240201 01:14:13.172621 3388401 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
I20240201 01:14:13.172951 3388424 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 3
E20240201 01:14:14.451846 3388336 recstore.cc:66] init folly done
E20240201 01:14:14.451859 3388401 recstore.cc:66] init folly done
E20240201 01:14:14.452039 3388424 recstore.cc:66] init folly done
I20240201 01:14:14.531659 3388336 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 3
I20240201 01:14:14.531733 3388401 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
I20240201 01:14:14.539139 3388424 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.977 ms                  | 35.209 ms                 |
| Forward                   | 10.155 ms                 | 807.878 ms                |
| Backward                  | 56.564 ms                 | 1.018 s                   |
| Optimize                  | 2.529 ms                  | 4.585 ms                  |
| BarrierTimeBeforeRank0    | 4.329 ms                  | 167.140 ms                |
| BlockToStepN              | 17.785 us                 | 21.528 us                 |
| OneStep                   | 76.193 ms                 | 1.258 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.067 ms                  | 36.282 ms                 |
| Forward                   | 10.050 ms                 | 21.228 ms                 |
| Backward                  | 56.777 ms                 | 278.650 ms                |
| Optimize                  | 2.693 ms                  | 4.972 ms                  |
| BarrierTimeBeforeRank0    | 3.305 ms                  | 22.181 ms                 |
| BlockToStepN              | 17.990 us                 | 29.700 us                 |
| OneStep                   | 75.707 ms                 | 1.048 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 10.282, sample: 0.581, forward: 1.900, backward: 7.314, update: 0.266
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 10.290, sample: 0.611, forward: 1.862, backward: 7.314, update: 0.238
[Rank2] pid = 3388400
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KGExternelEmbedding
fixed cache_range is [(0, 747), (747, 1494), (1494, 2241)]
train_sampler.Prefill()
-------Step 0-------
tensor([  142, 13805,   114,  9824, 10888,  1606, 12338, 14254, 14122,   556]) tensor([1102, 7677, 6264, 9301, 9885, 9837, 5582, 5107, 4275, 9690])
-------Step 1-------
tensor([  142, 13805,   114,  9824, 10888,  1606, 12338, 14254, 14122,   556]) tensor([ 1864,  5979,  9248,  2978, 10674,  8236,  7548, 14285, 13108, 14514])
-------Step 2-------
tensor([11064,  7317, 13122,   107, 14151,  4399,  6745,  6121,  9182,  1634]) tensor([7690, 7185,  672, 7524, 5178, 2696, 1486,  981, 5011, 4434])
-------Step 3-------
tensor([11064,  7317, 13122,   107, 14151,  4399,  6745,  6121,  9182,  1634]) tensor([ 7470,  7592,  9997, 10500,  6090,  7376, 14676,  6350,  7328,  5227])
-------Step 4-------
tensor([11962,  6133,  7527,    57,  7232,  1125, 11902, 13284,   225,  4759]) tensor([12790,  4855,  3007,  4252,  6186,  1926,  9668,  1875,  5066, 11257])
-------Step 5-------
tensor([11962,  6133,  7527,    57,  7232,  1125, 11902, 13284,   225,  4759]) tensor([12926, 10173, 10849, 11273,  8086,  7397,  2959,  4219,  9639, 10118])
-------Step 6-------
tensor([ 6635, 10736,  1606,  2229, 12170,  7613,  2735,   179,   198,  8524]) tensor([12981,   566, 11749,  1470,  6841,  4213,  9352,  8886, 12810, 13483])
-------Step 7-------
tensor([ 6635, 10736,  1606,  2229, 12170,  7613,  2735,   179,   198,  8524]) tensor([14614,  7252,   243, 12316, 14114,  7383, 14700,  9273, 10587, 10696])
-------Step 8-------
tensor([ 1379,  8052,  4934, 11487,  5676,  1230,  1855, 14234,  7872,  7247]) tensor([ 6280,  8932,  6666,  4315,  2163, 12225,  9855,  6039,  7804,   617])
-------Step 9-------
tensor([ 1379,  8052,  4934, 11487,  5676,  1230,  1855, 14234,  7872,  7247]) tensor([ 5813,  2194,  1809, 14600,  7762,  7562, 12089,  4095,  6244, 12268])
before start barrier
start train
[proc 0] 100 steps, total: 10.290, sample: 0.584, forward: 1.816, backward: 6.952, update: 0.272
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.057 ms                  | 36.370 ms                 |
| Forward                   | 9.995 ms                  | 21.228 ms                 |
| Backward                  | 56.888 ms                 | 278.650 ms                |
| Optimize                  | 2.688 ms                  | 5.612 ms                  |
| BarrierTimeBeforeRank0    | 3.701 ms                  | 83.754 ms                 |
| BlockToStepN              | 18.443 us                 | 66.704 us                 |
| OneStep                   | 76.351 ms                 | 1.048 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.046 ms                  | 36.370 ms                 |
| Forward                   | 9.993 ms                  | 16.233 ms                 |
| Backward                  | 56.724 ms                 | 161.267 ms                |
| Optimize                  | 2.643 ms                  | 5.287 ms                  |
| BarrierTimeBeforeRank0    | 4.610 ms                  | 69.417 ms                 |
| BlockToStepN              | 18.282 us                 | 56.350 us                 |
| OneStep                   | 78.655 ms                 | 190.593 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 9.317, sample: 0.591, forward: 0.871, backward: 7.139, update: 0.228
[proc 1] 200 steps, total: 9.317, sample: 0.623, forward: 0.901, backward: 6.392, update: 0.222
[proc 0] 200 steps, total: 9.317, sample: 0.571, forward: 0.914, backward: 5.725, update: 0.245
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.058 ms                  | 36.543 ms                 |
| Forward                   | 10.029 ms                 | 16.233 ms                 |
| Backward                  | 56.667 ms                 | 161.267 ms                |
| Optimize                  | 2.675 ms                  | 5.612 ms                  |
| BarrierTimeBeforeRank0    | 4.510 ms                  | 69.417 ms                 |
| BlockToStepN              | 18.443 us                 | 66.704 us                 |
| OneStep                   | 78.049 ms                 | 190.593 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 300 steps, total: 8.332, sample: 0.586, forward: 0.922, backward: 6.091, update: 0.236
[proc 0] 300 steps, total: 8.332, sample: 0.586, forward: 1.014, backward: 5.710, update: 0.276
[proc 2] 300 steps, total: 8.332, sample: 0.567, forward: 0.910, backward: 6.254, update: 0.247
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.056 ms                  | 36.543 ms                 |
| Forward                   | 10.063 ms                 | 16.211 ms                 |
| Backward                  | 56.655 ms                 | 130.895 ms                |
| Optimize                  | 2.683 ms                  | 5.639 ms                  |
| BarrierTimeBeforeRank0    | 4.593 ms                  | 42.443 ms                 |
| BlockToStepN              | 18.494 us                 | 66.704 us                 |
| OneStep                   | 77.626 ms                 | 175.070 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.054 ms                  | 36.543 ms                 |
| Forward                   | 10.060 ms                 | 16.121 ms                 |
| Backward                  | 56.637 ms                 | 129.143 ms                |
| Optimize                  | 2.683 ms                  | 5.652 ms                  |
| BarrierTimeBeforeRank0    | 4.801 ms                  | 50.846 ms                 |
| BlockToStepN              | 18.570 us                 | 66.704 us                 |
| OneStep                   | 78.217 ms                 | 161.970 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 400 steps, total: 8.811, sample: 0.532, forward: 0.993, backward: 6.122, update: 0.233
[proc 0] 400 steps, total: 8.811, sample: 0.577, forward: 0.981, backward: 5.696, update: 0.265
[proc 2] 400 steps, total: 8.811, sample: 0.578, forward: 0.895, backward: 6.380, update: 0.242
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.051 ms                  | 36.564 ms                 |
| Forward                   | 10.063 ms                 | 16.121 ms                 |
| Backward                  | 56.547 ms                 | 129.143 ms                |
| Optimize                  | 2.676 ms                  | 5.652 ms                  |
| BarrierTimeBeforeRank0    | 4.611 ms                  | 50.846 ms                 |
| BlockToStepN              | 18.606 us                 | 73.181 us                 |
| OneStep                   | 78.066 ms                 | 161.970 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.048 ms                  | 36.721 ms                 |
| Forward                   | 10.052 ms                 | 15.472 ms                 |
| Backward                  | 56.539 ms                 | 128.608 ms                |
| Optimize                  | 2.688 ms                  | 5.639 ms                  |
| BarrierTimeBeforeRank0    | 4.500 ms                  | 50.846 ms                 |
| BlockToStepN              | 18.587 us                 | 66.704 us                 |
| OneStep                   | 77.926 ms                 | 160.948 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 1] 500 steps, total: 8.761, sample: 0.610, forward: 0.992, backward: 6.069, update: 0.229
[proc 2] 500 steps, total: 8.761, sample: 0.613, forward: 0.885, backward: 6.101, update: 0.247
[proc 0] 500 steps, total: 8.761, sample: 0.596, forward: 0.993, backward: 5.704, update: 0.274
Successfully xmh. training takes 45.51115274429321 seconds
before call kg_cache_controller.StopThreads()
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
INFO [3388108 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 2.049 ms                  | 36.721 ms                 |
| Forward                   | 10.052 ms                 | 15.472 ms                 |
| Backward                  | 56.530 ms                 | 128.608 ms                |
| Optimize                  | 2.688 ms                  | 5.639 ms                  |
| BarrierTimeBeforeRank0    | 4.506 ms                  | 50.846 ms                 |
| BlockToStepN              | 18.593 us                 | 66.704 us                 |
| OneStep                   | 77.884 ms                 | 160.948 ms                |
+---------------------------+---------------------------+---------------------------+
