WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240211 03:32:38.665737 33822 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240211 03:32:38.674010 33822 IPCTensor.h:369] NewIPCTensor: full_emb [33762578, 32]0x100000002000 4.025 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [33822 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7f696da098a0>==========
Worker 1 pid=37525
Worker 2 pid=37526
Worker 3 pid=37527
Worker 4 pid=37528
Worker 5 pid=37529
Worker 6 pid=37530
INFO [33822 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [37525 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [37526 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [37527 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [37528 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [37529 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [37531 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [37530 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [37529 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37530 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37528 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37531 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37525 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37527 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [37526 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240211 03:32:57.150334 37530 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 03:32:57.150334 37529 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 03:32:57.150532 37526 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 03:32:57.150530 37525 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 03:32:57.150274 37531 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 03:32:57.150281 37528 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 03:32:57.150283 37527 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [33822 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240211 03:32:57.153208 33822 IPCTensor.h:348] IPCTensor full_emb already exists
W20240211 03:33:16.030987 37530 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [1688128, 32]; dev=6; size=206.1 MB
W20240211 03:33:16.031095 37531 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [1688128, 32]; dev=7; size=206.1 MB
W20240211 03:33:16.031677 37527 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [1688128, 32]; dev=3; size=206.1 MB
W20240211 03:33:16.031675 37528 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [1688128, 32]; dev=4; size=206.1 MB
W20240211 03:33:16.031791 37525 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [1688128, 32]; dev=1; size=206.1 MB
W20240211 03:33:16.032507 37529 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [1688128, 32]; dev=5; size=206.1 MB
W20240211 03:33:16.034543 37526 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [1688128, 32]; dev=2; size=206.1 MB
W20240211 03:33:16.035228 33822 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [1688128, 32]; dev=0; size=206.1 MB
W20240211 03:33:16.762888 37531 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x10010196e000 7.629 MB
W20240211 03:33:16.763100 37531 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x100102111000 7.629 MB
W20240211 03:33:16.763164 37531 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x1001028b4000 122.1 MB
W20240211 03:33:16.763249 37531 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x10010a2c8000 122.1 MB
W20240211 03:33:16.763288 37531 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240211 03:33:16.764427 37531 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240211 03:33:16.782738 37525 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x100111ce2000 7.629 MB
W20240211 03:33:16.783018 37525 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100112485000 7.629 MB
W20240211 03:33:16.783077 37525 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x100112c28000 122.1 MB
W20240211 03:33:16.783167 37525 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x10011a63c000 122.1 MB
W20240211 03:33:16.783200 37525 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240211 03:33:16.792831 37525 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240211 03:33:16.793993 37527 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x100122056000 7.629 MB
W20240211 03:33:16.794152 37527 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1001227f9000 7.629 MB
W20240211 03:33:16.794201 37527 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x100122f9c000 122.1 MB
W20240211 03:33:16.794258 37527 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x10012a9b0000 122.1 MB
W20240211 03:33:16.794299 37527 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240211 03:33:16.842073 37530 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x1001323ca000 7.629 MB
W20240211 03:33:16.842099 37527 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240211 03:33:16.842217 37530 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x100132b6d000 7.629 MB
W20240211 03:33:16.842245 37528 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x100133310000 7.629 MB
W20240211 03:33:16.842278 37530 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x100133ab3000 122.1 MB
W20240211 03:33:16.842342 37530 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x10013b4c7000 122.1 MB
W20240211 03:33:16.842381 37530 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240211 03:33:16.842413 37528 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x100142edb000 7.629 MB
W20240211 03:33:16.842463 37528 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x10014367e000 122.1 MB
W20240211 03:33:16.842515 37528 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x10014b092000 122.1 MB
W20240211 03:33:16.842554 37528 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240211 03:33:16.843083 37530 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240211 03:33:16.843108 37528 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240211 03:33:16.854141 37526 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100152ab4000 7.629 MB
W20240211 03:33:16.854249 33822 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100153257000 7.629 MB
W20240211 03:33:16.854372 37526 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x1001539fa000 7.629 MB
W20240211 03:33:16.854445 37526 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x10015419d000 122.1 MB
W20240211 03:33:16.854449 33822 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x10015bbb1000 7.629 MB
W20240211 03:33:16.854513 37526 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x10015c354000 122.1 MB
W20240211 03:33:16.854548 33822 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100163d68000 122.1 MB
W20240211 03:33:16.854568 37526 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240211 03:33:16.854609 33822 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x10016b77c000 122.1 MB
W20240211 03:33:16.854665 33822 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240211 03:33:16.856374 33822 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240211 03:33:16.856375 37526 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240211 03:33:16.865833 37529 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10017319a000 7.629 MB
W20240211 03:33:16.865957 37529 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x10017393d000 7.629 MB
W20240211 03:33:16.866039 37529 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x1001740e0000 122.1 MB
W20240211 03:33:16.866112 37529 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x10017baf4000 122.1 MB
W20240211 03:33:16.866151 37529 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240211 03:33:16.866497 37529 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
Worker 7 pid=37531
New CachedEmbedding, name=full_emb, shape=(33762578, 32), cache_type=KnownLocalCachedEmbeddingSoftware
fixed cache_range is [(0, 1688128), (1688128, 3376256), (3376256, 5064384), (5064384, 6752512), (6752512, 8440640), (8440640, 10128768), (10128768, 11816896), (11816896, 13505024)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
W20240211 03:33:24.592959 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10018350c000 7.629 MB
W20240211 03:33:24.593164 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x100183caf000 7.629 MB
W20240211 03:33:24.593231 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x100184452000 7.629 MB
W20240211 03:33:24.593286 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x100184bf5000 7.629 MB
W20240211 03:33:24.593349 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x100185398000 7.629 MB
W20240211 03:33:24.593390 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100185b3b000 7.629 MB
W20240211 03:33:24.593425 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1001862de000 7.629 MB
W20240211 03:33:24.593484 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100186a81000 7.629 MB
W20240211 03:33:24.593537 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100187224000 7.629 MB
W20240211 03:33:24.593585 37527 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1001879c7000 7.629 MB
W20240211 03:33:24.593622 37527 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x10018816a000 80 B 
W20240211 03:33:24.593660 37527 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x10018816c000 8 B 
W20240211 03:33:24.593709 37527 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x10018816e000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
Construct KGCacheControllerWrapper done
E20240211 03:33:24.594332 37527 recstore.cc:66] init folly done
W20240211 03:33:24.902209 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100188170000 7.629 MB
W20240211 03:33:24.902546 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x100188913000 7.629 MB
W20240211 03:33:24.902601 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1001890b6000 7.629 MB
W20240211 03:33:24.902647 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x100189859000 7.629 MB
W20240211 03:33:24.902705 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100189ffc000 7.629 MB
W20240211 03:33:24.902748 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x10018a79f000 7.629 MB
W20240211 03:33:24.902781 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x10018af42000 7.629 MB
W20240211 03:33:24.902828 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x10018b6e5000 7.629 MB
W20240211 03:33:24.902871 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x10018be88000 7.629 MB
W20240211 03:33:24.902915 33822 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x10018c62b000 7.629 MB
W20240211 03:33:24.902967 33822 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x10018cdce000 80 B 
W20240211 03:33:24.903003 33822 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x10018cdd0000 8 B 
W20240211 03:33:24.903043 33822 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x10018cdd2000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
Construct KGCacheControllerWrapper done
E20240211 03:33:24.903781 33822 recstore.cc:66] init folly done
W20240211 03:33:25.251827 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x10018cdd4000 7.629 MB
W20240211 03:33:25.252013 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x10018d577000 7.629 MB
W20240211 03:33:25.252105 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x10018dd1a000 7.629 MB
W20240211 03:33:25.252164 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x10018e4bd000 7.629 MB
W20240211 03:33:25.252202 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x10018ec60000 7.629 MB
W20240211 03:33:25.252242 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x10018f403000 7.629 MB
W20240211 03:33:25.252278 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x10018fba6000 7.629 MB
W20240211 03:33:25.252343 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x100190349000 7.629 MB
W20240211 03:33:25.252393 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x100190aec000 7.629 MB
W20240211 03:33:25.252445 37531 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x10019128f000 7.629 MB
W20240211 03:33:25.252487 37531 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x100191a32000 80 B 
W20240211 03:33:25.252525 37531 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x100191a34000 8 B 
W20240211 03:33:25.252571 37531 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100191a36000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
Construct KGCacheControllerWrapper done
E20240211 03:33:25.253129 37531 recstore.cc:66] init folly done
W20240211 03:33:25.307582 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x100191a38000 7.629 MB
W20240211 03:33:25.307952 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1001921db000 7.629 MB
W20240211 03:33:25.308151 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x10019297e000 7.629 MB
W20240211 03:33:25.308306 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x100193121000 7.629 MB
W20240211 03:33:25.308452 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1001938c4000 7.629 MB
W20240211 03:33:25.308598 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x100194067000 7.629 MB
W20240211 03:33:25.308719 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x10019480a000 7.629 MB
W20240211 03:33:25.308887 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x100194fad000 7.629 MB
W20240211 03:33:25.309036 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x100195750000 7.629 MB
W20240211 03:33:25.309195 37529 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x100195ef3000 7.629 MB
W20240211 03:33:25.309329 37529 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x100196696000 80 B 
W20240211 03:33:25.309445 37529 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x100196698000 8 B 
W20240211 03:33:25.309585 37529 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x10019669a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
Construct KGCacheControllerWrapper done
E20240211 03:33:25.310729 37529 recstore.cc:66] init folly done
W20240211 03:33:25.444021 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x10019669c000 7.629 MB
W20240211 03:33:25.444236 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100196e3f000 7.629 MB
W20240211 03:33:25.444304 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1001975e2000 7.629 MB
W20240211 03:33:25.444347 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x100197d85000 7.629 MB
W20240211 03:33:25.444387 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100198528000 7.629 MB
W20240211 03:33:25.444432 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100198ccb000 7.629 MB
W20240211 03:33:25.444469 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x10019946e000 7.629 MB
W20240211 03:33:25.444527 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x100199c11000 7.629 MB
W20240211 03:33:25.444584 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10019a3b4000 7.629 MB
W20240211 03:33:25.444633 37525 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x10019ab57000 7.629 MB
W20240211 03:33:25.444705 37525 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x10019b2fa000 80 B 
W20240211 03:33:25.444743 37525 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x10019b2fc000 8 B 
W20240211 03:33:25.444783 37525 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x10019b2fe000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
Construct KGCacheControllerWrapper done
E20240211 03:33:25.445367 37525 recstore.cc:66] init folly done
W20240211 03:33:25.446292 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x10019b300000 7.629 MB
W20240211 03:33:25.446439 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x10019baa3000 7.629 MB
W20240211 03:33:25.446492 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x10019c246000 7.629 MB
W20240211 03:33:25.446537 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x10019c9e9000 7.629 MB
W20240211 03:33:25.446583 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x10019d18c000 7.629 MB
W20240211 03:33:25.446631 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x10019d92f000 7.629 MB
W20240211 03:33:25.446671 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x10019e0d2000 7.629 MB
W20240211 03:33:25.446718 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x10019e875000 7.629 MB
W20240211 03:33:25.446777 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x10019f018000 7.629 MB
W20240211 03:33:25.446820 37530 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x10019f7bb000 7.629 MB
W20240211 03:33:25.446859 37530 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x10019ff5e000 80 B 
W20240211 03:33:25.446906 37530 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x10019ff60000 8 B 
W20240211 03:33:25.446949 37530 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x10019ff62000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
Construct KGCacheControllerWrapper done
E20240211 03:33:25.447458 37530 recstore.cc:66] init folly done
W20240211 03:33:25.692137 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x10019ff64000 7.629 MB
W20240211 03:33:25.692340 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1001a0707000 7.629 MB
W20240211 03:33:25.692415 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1001a0eaa000 7.629 MB
W20240211 03:33:25.692479 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1001a164d000 7.629 MB
W20240211 03:33:25.692538 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1001a1df0000 7.629 MB
W20240211 03:33:25.692595 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1001a2593000 7.629 MB
W20240211 03:33:25.692677 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1001a2d36000 7.629 MB
W20240211 03:33:25.692750 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1001a34d9000 7.629 MB
W20240211 03:33:25.692817 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1001a3c7c000 7.629 MB
W20240211 03:33:25.692880 37528 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1001a441f000 7.629 MB
W20240211 03:33:25.692936 37528 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1001a4bc2000 80 B 
W20240211 03:33:25.692987 37528 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1001a4bc4000 8 B 
W20240211 03:33:25.693048 37528 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1001a4bc6000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
Construct KGCacheControllerWrapper done
E20240211 03:33:25.693655 37528 recstore.cc:66] init folly done
W20240211 03:33:25.786047 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1001a4bc8000 7.629 MB
W20240211 03:33:25.786341 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1001a536b000 7.629 MB
W20240211 03:33:25.786406 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1001a5b0e000 7.629 MB
W20240211 03:33:25.786451 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1001a62b1000 7.629 MB
W20240211 03:33:25.786499 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1001a6a54000 7.629 MB
W20240211 03:33:25.786541 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1001a71f7000 7.629 MB
W20240211 03:33:25.786585 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1001a799a000 7.629 MB
W20240211 03:33:25.786641 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1001a813d000 7.629 MB
W20240211 03:33:25.786692 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1001a88e0000 7.629 MB
W20240211 03:33:25.786741 37526 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1001a9083000 7.629 MB
W20240211 03:33:25.786785 37526 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1001a9826000 80 B 
W20240211 03:33:25.786826 37526 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1001a9828000 8 B 
W20240211 03:33:25.786886 37526 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1001a982a000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/criteo_binary
Dataset loaded
np.max =  33762577
np.min=  1
Construct RecModelSampler done
Construct KGCacheControllerWrapper done
E20240211 03:33:25.787437 37526 recstore.cc:66] init folly done
Before Training
Before Training
Before Training
Before Training
Before Training
I20240211 03:33:26.629331 33822 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240211 03:33:26.629369 37527 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 03:33:26.629410 37526 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 03:33:26.629434 37530 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 03:33:26.629467 37528 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 03:33:26.629489 37525 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
I20240211 03:33:26.630300 37529 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 03:33:26.630329 37531 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 127.346 us                | 127.346 us                |
| GenInput                  | 4.405 ms                  | 4.405 ms                  |
| bucket keys               | 64.137 ms                 | 64.137 ms                 |
| forward: join             | 59.515 ms                 | 59.515 ms                 |
| NN                        | 177.925 ms                | 177.925 ms                |
| Forward                   | 396.011 ms                | 396.011 ms                |
| back: bucket keys         | 632.993 us                | 632.993 us                |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
INFO [33822 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [37525 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [37526 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [37527 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [37530 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [37531 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [37528 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [37529 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 138.010 us                | 218.484 us                |
| GenInput                  | 844.165 us                | 4.405 ms                  |
| bucket keys               | 483.370 us                | 64.137 ms                 |
| forward: join             | 77.523 ms                 | 93.692 ms                 |
| NN                        | 2.649 ms                  | 177.925 ms                |
| Forward                   | 82.308 ms                 | 396.011 ms                |
| back: bucket keys         | 453.149 us                | 632.993 us                |
| back: a2a                 | 27.760 ms                 | 49.499 s                  |
| back: cache               | 127.821 ms                | 164.140 ms                |
| back: aggr dram keys      | 23.429 ms                 | 996.750 ms                |
| back: set dram grad       | 908.958 us                | 1.353 ms                  |
| Backward                  | 174.577 ms                | 50.740 s                  |
| Optimize                  | 16.859 ms                 | 130.501 ms                |
| OneStep                   | 273.227 ms                | 51.274 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 145.723 us                | 486.305 us                |
| GenInput                  | 875.432 us                | 4.405 ms                  |
| bucket keys               | 524.007 us                | 64.137 ms                 |
| forward: join             | 77.523 ms                 | 104.359 ms                |
| NN                        | 1.403 ms                  | 177.925 ms                |
| Forward                   | 81.942 ms                 | 396.011 ms                |
| back: bucket keys         | 411.503 us                | 741.623 us                |
| back: a2a                 | 24.545 ms                 | 49.499 s                  |
| back: cache               | 126.302 ms                | 188.874 ms                |
| back: aggr dram keys      | 23.429 ms                 | 996.750 ms                |
| back: set dram grad       | 914.777 us                | 1.852 ms                  |
| Backward                  | 177.703 ms                | 50.740 s                  |
| Optimize                  | 19.174 ms                 | 130.501 ms                |
| OneStep                   | 273.227 ms                | 51.274 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
Successfully xmh
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 145.723 us                | 2.241 ms                  |
| GenInput                  | 875.432 us                | 12.032 ms                 |
| bucket keys               | 489.086 us                | 64.137 ms                 |
| forward: join             | 70.471 ms                 | 104.359 ms                |
| NN                        | 1.257 ms                  | 177.925 ms                |
| Forward                   | 77.242 ms                 | 396.011 ms                |
| back: bucket keys         | 411.503 us                | 741.623 us                |
| back: a2a                 | 25.036 ms                 | 49.499 s                  |
| back: cache               | 127.465 ms                | 188.874 ms                |
| back: aggr dram keys      | 28.397 ms                 | 996.750 ms                |
| back: set dram grad       | 908.958 us                | 1.852 ms                  |
| Backward                  | 183.751 ms                | 50.740 s                  |
| Optimize                  | 19.013 ms                 | 130.501 ms                |
| OneStep                   | 280.546 ms                | 51.274 s                  |
+---------------------------+---------------------------+---------------------------+
