WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240211 02:22:50.691928 17652 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
W20240211 02:22:50.700078 17652 IPCTensor.h:369] NewIPCTensor: full_emb [9449206, 32]0x100000002000 1.126 GB
/data/home/xieminhui/RecStore/src/framework_adapters/torch/python/perf_rec_model.py:152: DeprecationWarning: The 'warn' function is deprecated, use 'warning' instead
  XLOG.warn("After init DistEmbedding")
WARNING [17652 perf_rec_model.py:152] After init DistEmbedding
========== Running Perf with routine <function routine_local_cache_helper at 0x7fbb22cbd8a0>==========
Worker 1 pid=19884
Worker 2 pid=19885
Worker 3 pid=19886
Worker 4 pid=19887
Worker 5 pid=19889
Worker 6 pid=19890
INFO [17652 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [19884 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [19885 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [19886 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [19887 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [19891 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [19890 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [19889 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [17652 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19884 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19885 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19890 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19891 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [19889 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240211 02:22:57.003149 17652 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 02:22:57.003211 19884 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 02:22:57.003293 19885 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 02:22:57.003417 19890 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 02:22:57.003441 19891 IPCTensor.h:348] IPCTensor full_emb already exists
E20240211 02:22:57.003542 19889 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [19886 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240211 02:22:57.004638 19886 IPCTensor.h:348] IPCTensor full_emb already exists
INFO [19887 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
E20240211 02:22:57.006723 19887 IPCTensor.h:348] IPCTensor full_emb already exists
W20240211 02:23:02.281960 19889 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_5 [944920, 32]; dev=5; size=115.3 MB
W20240211 02:23:02.283571 19890 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_6 [944920, 32]; dev=6; size=115.3 MB
W20240211 02:23:02.283506 19891 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_7 [944920, 32]; dev=7; size=115.3 MB
W20240211 02:23:02.283967 19887 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_4 [944920, 32]; dev=4; size=115.3 MB
W20240211 02:23:02.284286 17652 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_0 [944920, 32]; dev=0; size=115.3 MB
W20240211 02:23:02.284288 19885 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_2 [944920, 32]; dev=2; size=115.3 MB
W20240211 02:23:02.284576 19884 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_1 [944920, 32]; dev=1; size=115.3 MB
W20240211 02:23:02.284670 19886 IPCTensor.h:409] NewIPCGPUTensor: embedding_cache_3 [944920, 32]; dev=3; size=115.3 MB
W20240211 02:23:03.007481 19889 IPCTensor.h:369] NewIPCTensor: input_keys_5 [1000000]0x10004817d000 7.629 MB
W20240211 02:23:03.007674 19889 IPCTensor.h:369] NewIPCTensor: input_keys_neg_5 [1000000]0x100048920000 7.629 MB
W20240211 02:23:03.007746 19889 IPCTensor.h:369] NewIPCTensor: backward_grads_5 [1000000, 32]0x1000490c3000 122.1 MB
W20240211 02:23:03.007784 19889 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_5 [1000000, 32]0x100050ad7000 122.1 MB
W20240211 02:23:03.007833 19889 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240211 02:23:03.008388 19889 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_5_gpu [1000000, 32]; dev=5; size=122.1 MB
W20240211 02:23:03.030251 19884 IPCTensor.h:369] NewIPCTensor: input_keys_1 [1000000]0x1000584f1000 7.629 MB
W20240211 02:23:03.030476 19884 IPCTensor.h:369] NewIPCTensor: input_keys_neg_1 [1000000]0x100058c94000 7.629 MB
W20240211 02:23:03.030550 19884 IPCTensor.h:369] NewIPCTensor: backward_grads_1 [1000000, 32]0x100059437000 122.1 MB
W20240211 02:23:03.030598 19884 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_1 [1000000, 32]0x100060e4b000 122.1 MB
W20240211 02:23:03.030663 19884 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240211 02:23:03.033154 19884 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 32]; dev=1; size=122.1 MB
W20240211 02:23:03.033648 19885 IPCTensor.h:369] NewIPCTensor: input_keys_2 [1000000]0x100068863000 7.629 MB
W20240211 02:23:03.033766 19885 IPCTensor.h:369] NewIPCTensor: input_keys_neg_2 [1000000]0x100069006000 7.629 MB
W20240211 02:23:03.033838 19885 IPCTensor.h:369] NewIPCTensor: backward_grads_2 [1000000, 32]0x1000697a9000 122.1 MB
W20240211 02:23:03.033875 19885 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_2 [1000000, 32]0x1000711bd000 122.1 MB
W20240211 02:23:03.033921 19885 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240211 02:23:03.039175 19885 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 32]; dev=2; size=122.1 MB
W20240211 02:23:03.045114 19890 IPCTensor.h:369] NewIPCTensor: input_keys_6 [1000000]0x100078bd9000 7.629 MB
W20240211 02:23:03.045239 19890 IPCTensor.h:369] NewIPCTensor: input_keys_neg_6 [1000000]0x10007937c000 7.629 MB
W20240211 02:23:03.045306 19890 IPCTensor.h:369] NewIPCTensor: backward_grads_6 [1000000, 32]0x100079b1f000 122.1 MB
W20240211 02:23:03.045343 19890 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_6 [1000000, 32]0x100081533000 122.1 MB
W20240211 02:23:03.045387 19890 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240211 02:23:03.059609 19890 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_6_gpu [1000000, 32]; dev=6; size=122.1 MB
W20240211 02:23:03.060194 17652 IPCTensor.h:369] NewIPCTensor: input_keys_0 [1000000]0x100088f4d000 7.629 MB
W20240211 02:23:03.060369 17652 IPCTensor.h:369] NewIPCTensor: input_keys_neg_0 [1000000]0x1000896f0000 7.629 MB
W20240211 02:23:03.060427 17652 IPCTensor.h:369] NewIPCTensor: backward_grads_0 [1000000, 32]0x100089e93000 122.1 MB
W20240211 02:23:03.060490 17652 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_0 [1000000, 32]0x1000918a7000 122.1 MB
W20240211 02:23:03.060549 17652 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240211 02:23:03.060906 17652 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 32]; dev=0; size=122.1 MB
W20240211 02:23:03.067947 19891 IPCTensor.h:369] NewIPCTensor: input_keys_7 [1000000]0x1000992c1000 7.629 MB
W20240211 02:23:03.068156 19891 IPCTensor.h:369] NewIPCTensor: input_keys_neg_7 [1000000]0x100099a64000 7.629 MB
W20240211 02:23:03.068233 19891 IPCTensor.h:369] NewIPCTensor: backward_grads_7 [1000000, 32]0x10009a209000 122.1 MB
W20240211 02:23:03.068284 19891 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_7 [1000000, 32]0x1000a1c1d000 122.1 MB
W20240211 02:23:03.068338 19891 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240211 02:23:03.068553 19886 IPCTensor.h:369] NewIPCTensor: input_keys_3 [1000000]0x1000a9631000 7.629 MB
W20240211 02:23:03.068718 19886 IPCTensor.h:369] NewIPCTensor: input_keys_neg_3 [1000000]0x1000a9dd6000 7.629 MB
W20240211 02:23:03.068746 19891 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_7_gpu [1000000, 32]; dev=7; size=122.1 MB
W20240211 02:23:03.068794 19886 IPCTensor.h:369] NewIPCTensor: backward_grads_3 [1000000, 32]0x1000aa579000 122.1 MB
W20240211 02:23:03.068838 19886 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_3 [1000000, 32]0x1000b1f8d000 122.1 MB
W20240211 02:23:03.068890 19886 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240211 02:23:03.069342 19886 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 32]; dev=3; size=122.1 MB
W20240211 02:23:03.074221 19887 IPCTensor.h:369] NewIPCTensor: input_keys_4 [1000000]0x1000b99a9000 7.629 MB
W20240211 02:23:03.074371 19887 IPCTensor.h:369] NewIPCTensor: input_keys_neg_4 [1000000]0x1000ba14c000 7.629 MB
W20240211 02:23:03.074434 19887 IPCTensor.h:369] NewIPCTensor: backward_grads_4 [1000000, 32]0x1000ba8ef000 122.1 MB
W20240211 02:23:03.074471 19887 IPCTensor.h:369] NewIPCTensor: backward_grads_neg_4 [1000000, 32]0x1000c2303000 122.1 MB
W20240211 02:23:03.074517 19887 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_4_gpu [1000000, 32]; dev=4; size=122.1 MB
W20240211 02:23:03.074883 19887 IPCTensor.h:409] NewIPCGPUTensor: backward_grads_neg_4_gpu [1000000, 32]; dev=4; size=122.1 MB
cudaHostRegister 0x100000002000
7: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
5: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
2: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
6: KnownLocalCachedEmbedding init done
Worker 7 pid=19891
New CachedEmbedding, name=full_emb, shape=(9449206, 32), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 944920), (944920, 1889840), (1889840, 2834760), (2834760, 3779680), (3779680, 4724600), (4724600, 5669520), (5669520, 6614440), (6614440, 7559360)]
cudaHostRegister 0x100000002000
0: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
4: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100000002000
1: KnownLocalCachedEmbedding init done
W20240211 02:23:08.060884 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_0 [1000000]0x1000c9d1b000 7.629 MB
W20240211 02:23:08.061079 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_1 [1000000]0x1000ca4be000 7.629 MB
W20240211 02:23:08.061120 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_2 [1000000]0x1000cac61000 7.629 MB
W20240211 02:23:08.061167 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_3 [1000000]0x1000cb404000 7.629 MB
W20240211 02:23:08.061218 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_4 [1000000]0x1000cbba7000 7.629 MB
W20240211 02:23:08.061264 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_5 [1000000]0x1000cc34a000 7.629 MB
W20240211 02:23:08.061311 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_6 [1000000]0x1000ccaed000 7.629 MB
W20240211 02:23:08.061370 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_7 [1000000]0x1000cd290000 7.629 MB
W20240211 02:23:08.061420 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_8 [1000000]0x1000cda33000 7.629 MB
W20240211 02:23:08.061465 19887 IPCTensor.h:369] NewIPCTensor: cached_sampler_r4_9 [1000000]0x1000ce1d6000 7.629 MB
W20240211 02:23:08.061506 19887 IPCTensor.h:369] NewIPCTensor: step_r4 [10]0x1000ce979000 80 B 
W20240211 02:23:08.061543 19887 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r4 [1]0x1000ce97b000 8 B 
W20240211 02:23:08.061578 19887 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x1000ce97d000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240211 02:23:08.062026 19887 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
W20240211 02:23:08.067873 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000ce97f000 7.629 MB
W20240211 02:23:08.068068 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_1 [1000000]0x1000cf122000 7.629 MB
W20240211 02:23:08.068113 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_2 [1000000]0x1000cf8c5000 7.629 MB
W20240211 02:23:08.068192 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_3 [1000000]0x1000d0068000 7.629 MB
W20240211 02:23:08.068238 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_4 [1000000]0x1000d080b000 7.629 MB
W20240211 02:23:08.068282 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_5 [1000000]0x1000d0fae000 7.629 MB
W20240211 02:23:08.068328 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_6 [1000000]0x1000d1751000 7.629 MB
W20240211 02:23:08.068387 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_7 [1000000]0x1000d1ef4000 7.629 MB
W20240211 02:23:08.068431 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_8 [1000000]0x1000d2697000 7.629 MB
W20240211 02:23:08.068481 19885 IPCTensor.h:369] NewIPCTensor: cached_sampler_r2_9 [1000000]0x1000d2e3a000 7.629 MB
W20240211 02:23:08.068521 19885 IPCTensor.h:369] NewIPCTensor: step_r2 [10]0x1000d35dd000 80 B 
W20240211 02:23:08.068557 19885 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r2 [1]0x1000d35df000 8 B 
W20240211 02:23:08.068593 19885 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x1000d35e1000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240211 02:23:08.068980 19885 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240211 02:23:08.069272 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_0 [1000000]0x1000d35e3000 7.629 MB
W20240211 02:23:08.069466 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_1 [1000000]0x1000d3d86000 7.629 MB
W20240211 02:23:08.069507 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_2 [1000000]0x1000d4529000 7.629 MB
W20240211 02:23:08.069586 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_3 [1000000]0x1000d4ccc000 7.629 MB
W20240211 02:23:08.069635 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_4 [1000000]0x1000d546f000 7.629 MB
W20240211 02:23:08.069679 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_5 [1000000]0x1000d5c12000 7.629 MB
W20240211 02:23:08.069725 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_6 [1000000]0x1000d63b5000 7.629 MB
W20240211 02:23:08.069780 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_7 [1000000]0x1000d6b58000 7.629 MB
W20240211 02:23:08.069824 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_8 [1000000]0x1000d72fb000 7.629 MB
W20240211 02:23:08.069867 19891 IPCTensor.h:369] NewIPCTensor: cached_sampler_r7_9 [1000000]0x1000d7a9e000 7.629 MB
W20240211 02:23:08.069929 19891 IPCTensor.h:369] NewIPCTensor: step_r7 [10]0x1000d8241000 80 B 
W20240211 02:23:08.069963 19891 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r7 [1]0x1000d8243000 8 B 
W20240211 02:23:08.069999 19891 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x1000d8245000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240211 02:23:08.070361 19891 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240211 02:23:08.231050 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_0 [1000000]0x1000d8247000 7.629 MB
W20240211 02:23:08.231220 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_1 [1000000]0x1000d89ea000 7.629 MB
W20240211 02:23:08.231266 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_2 [1000000]0x1000d918d000 7.629 MB
W20240211 02:23:08.231312 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_3 [1000000]0x1000d9930000 7.629 MB
W20240211 02:23:08.231365 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_4 [1000000]0x1000da0d3000 7.629 MB
W20240211 02:23:08.231429 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_5 [1000000]0x1000da876000 7.629 MB
W20240211 02:23:08.231475 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_6 [1000000]0x1000db019000 7.629 MB
W20240211 02:23:08.231534 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_7 [1000000]0x1000db7bc000 7.629 MB
W20240211 02:23:08.231581 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_8 [1000000]0x1000dbf5f000 7.629 MB
W20240211 02:23:08.231631 19890 IPCTensor.h:369] NewIPCTensor: cached_sampler_r6_9 [1000000]0x1000dc702000 7.629 MB
W20240211 02:23:08.231673 19890 IPCTensor.h:369] NewIPCTensor: step_r6 [10]0x1000dcea5000 80 B 
W20240211 02:23:08.231710 19890 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r6 [1]0x1000dcea7000 8 B 
W20240211 02:23:08.231748 19890 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x1000dcea9000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240211 02:23:08.232098 19890 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240211 02:23:08.322783 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_0 [1000000]0x1000dceab000 7.629 MB
W20240211 02:23:08.322932 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000dd64e000 7.629 MB
W20240211 02:23:08.322979 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_2 [1000000]0x1000dddf1000 7.629 MB
W20240211 02:23:08.323014 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000de594000 7.629 MB
W20240211 02:23:08.323056 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_4 [1000000]0x1000ded37000 7.629 MB
W20240211 02:23:08.323108 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_5 [1000000]0x1000df4da000 7.629 MB
W20240211 02:23:08.323144 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_6 [1000000]0x1000dfc7d000 7.629 MB
W20240211 02:23:08.323195 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_7 [1000000]0x1000e0420000 7.629 MB
W20240211 02:23:08.323232 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_8 [1000000]0x1000e0bc3000 7.629 MB
W20240211 02:23:08.323268 17652 IPCTensor.h:369] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000e1366000 7.629 MB
W20240211 02:23:08.323300 17652 IPCTensor.h:369] NewIPCTensor: step_r0 [10]0x1000e1b09000 80 B 
W20240211 02:23:08.323338 17652 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r0 [1]0x1000e1b0b000 8 B 
W20240211 02:23:08.323374 17652 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000e1b0d000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240211 02:23:08.323693 17652 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240211 02:23:08.630775 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_0 [1000000]0x1000e1b0f000 7.629 MB
W20240211 02:23:08.630950 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_1 [1000000]0x1000e22b2000 7.629 MB
W20240211 02:23:08.630998 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_2 [1000000]0x1000e2a55000 7.629 MB
W20240211 02:23:08.631057 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_3 [1000000]0x1000e31f8000 7.629 MB
W20240211 02:23:08.631108 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000e399b000 7.629 MB
W20240211 02:23:08.631155 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_5 [1000000]0x1000e413e000 7.629 MB
W20240211 02:23:08.631202 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_6 [1000000]0x1000e48e1000 7.629 MB
W20240211 02:23:08.631261 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_7 [1000000]0x1000e5084000 7.629 MB
W20240211 02:23:08.631319 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_8 [1000000]0x1000e5827000 7.629 MB
W20240211 02:23:08.631358 19886 IPCTensor.h:369] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000e5fca000 7.629 MB
W20240211 02:23:08.631400 19886 IPCTensor.h:369] NewIPCTensor: step_r3 [10]0x1000e676d000 80 B 
W20240211 02:23:08.631446 19886 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r3 [1]0x1000e676f000 8 B 
W20240211 02:23:08.631480 19886 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x1000e6771000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240211 02:23:08.631803 19886 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240211 02:23:08.725754 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_0 [1000000]0x1000e6773000 7.629 MB
W20240211 02:23:08.725895 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_1 [1000000]0x1000e6f16000 7.629 MB
W20240211 02:23:08.725939 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_2 [1000000]0x1000e76b9000 7.629 MB
W20240211 02:23:08.725986 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_3 [1000000]0x1000e7e5c000 7.629 MB
W20240211 02:23:08.726032 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_4 [1000000]0x1000e85ff000 7.629 MB
W20240211 02:23:08.726081 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_5 [1000000]0x1000e8da2000 7.629 MB
W20240211 02:23:08.726128 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_6 [1000000]0x1000e9545000 7.629 MB
W20240211 02:23:08.726186 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_7 [1000000]0x1000e9ce8000 7.629 MB
W20240211 02:23:08.726231 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_8 [1000000]0x1000ea48b000 7.629 MB
W20240211 02:23:08.726270 19889 IPCTensor.h:369] NewIPCTensor: cached_sampler_r5_9 [1000000]0x1000eac2e000 7.629 MB
W20240211 02:23:08.726308 19889 IPCTensor.h:369] NewIPCTensor: step_r5 [10]0x1000eb3d1000 80 B 
W20240211 02:23:08.726341 19889 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r5 [1]0x1000eb3d3000 8 B 
W20240211 02:23:08.726375 19889 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x1000eb3d5000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240211 02:23:08.726637 19889 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240211 02:23:08.735287 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_0 [1000000]0x1000eb3d7000 7.629 MB
W20240211 02:23:08.735627 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_1 [1000000]0x1000ebb7a000 7.629 MB
W20240211 02:23:08.735765 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_2 [1000000]0x1000ec31d000 7.629 MB
W20240211 02:23:08.735903 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_3 [1000000]0x1000ecac0000 7.629 MB
W20240211 02:23:08.736070 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_4 [1000000]0x1000ed263000 7.629 MB
W20240211 02:23:08.736212 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_5 [1000000]0x1000eda06000 7.629 MB
W20240211 02:23:08.736347 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_6 [1000000]0x1000ee1a9000 7.629 MB
W20240211 02:23:08.736503 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000ee94c000 7.629 MB
W20240211 02:23:08.736637 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_8 [1000000]0x1000ef0ef000 7.629 MB
W20240211 02:23:08.736760 19884 IPCTensor.h:369] NewIPCTensor: cached_sampler_r1_9 [1000000]0x1000ef892000 7.629 MB
W20240211 02:23:08.736881 19884 IPCTensor.h:369] NewIPCTensor: step_r1 [10]0x1000f0035000 80 B 
W20240211 02:23:08.736989 19884 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_r1 [1]0x1000f0037000 8 B 
W20240211 02:23:08.737108 19884 IPCTensor.h:369] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000f0039000 8 B 
Dataset:  /home/xieminhui/RecStoreDataset/avazu_binary
Dataset loaded
np.max =  9449205
np.min=  1
Construct RecModelSampler done
I20240211 02:23:08.737777 19884 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
E20240211 02:23:10.537626 19885 recstore.cc:66] init folly done
E20240211 02:23:10.537623 17652 recstore.cc:66] init folly done
E20240211 02:23:10.537631 19887 recstore.cc:66] init folly done
E20240211 02:23:10.537650 19886 recstore.cc:66] init folly done
E20240211 02:23:10.537670 19891 recstore.cc:66] init folly done
E20240211 02:23:10.537706 19884 recstore.cc:66] init folly done
E20240211 02:23:10.537703 19890 recstore.cc:66] init folly done
E20240211 02:23:10.537709 19889 recstore.cc:66] init folly done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Construct KGCacheControllerWrapper done
Before Training
I20240211 02:23:11.786681 19886 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
Before Training
I20240211 02:23:11.786936 19889 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
I20240211 02:23:11.787117 17652 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
Before Training
Before Training
Before Training
Before Training
Before Training
I20240211 02:23:11.787207 19884 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 02:23:11.787232 19887 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 02:23:11.787256 19890 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 02:23:11.787278 19885 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240211 02:23:11.787299 19891 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
========== Step 0 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 154.440 us                | 154.440 us                |
| GenInput                  | 2.305 ms                  | 2.305 ms                  |
| NN                        | 201.496 ms                | 201.496 ms                |
| Forward                   | 203.178 ms                | 203.178 ms                |
| back: bucket keys         | 52.331 ms                 | 52.331 ms                 |
| back: a2a                 | 51.479 s                  | 51.479 s                  |
| back: cache               | 83.197 ms                 | 83.197 ms                 |
+---------------------------+---------------------------+---------------------------+
========== Step 1 ========== 
INFO [17652 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [19889 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [19890 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [19886 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [19887 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [19884 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [19885 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
INFO [19891 distributed.py:1140] Reducer buckets have been rebuilt in this iteration.
========== Step 2 ========== 
========== Step 3 ========== 
========== Step 4 ========== 
========== Step 5 ========== 
========== Step 6 ========== 
========== Step 7 ========== 
========== Step 8 ========== 
========== Step 9 ========== 
========== Step 10 ========== 
========== Step 11 ========== 
========== Step 12 ========== 
========== Step 13 ========== 
========== Step 14 ========== 
========== Step 15 ========== 
========== Step 16 ========== 
========== Step 17 ========== 
========== Step 18 ========== 
========== Step 19 ========== 
========== Step 20 ========== 
========== Step 21 ========== 
========== Step 22 ========== 
========== Step 23 ========== 
========== Step 24 ========== 
========== Step 25 ========== 
========== Step 26 ========== 
========== Step 27 ========== 
========== Step 28 ========== 
========== Step 29 ========== 
========== Step 30 ========== 
========== Step 31 ========== 
========== Step 32 ========== 
========== Step 33 ========== 
========== Step 34 ========== 
========== Step 35 ========== 
========== Step 36 ========== 
========== Step 37 ========== 
========== Step 38 ========== 
========== Step 39 ========== 
========== Step 40 ========== 
========== Step 41 ========== 
========== Step 42 ========== 
========== Step 43 ========== 
========== Step 44 ========== 
========== Step 45 ========== 
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 112.365 us                | 238.001 us                |
| GenInput                  | 581.178 us                | 2.305 ms                  |
| NN                        | 942.243 us                | 201.496 ms                |
| Forward                   | 1.190 ms                  | 203.178 ms                |
| back: bucket keys         | 631.681 us                | 52.331 ms                 |
| back: a2a                 | 8.149 ms                  | 51.479 s                  |
| back: cache               | 44.918 ms                 | 83.197 ms                 |
| back: aggr dram keys      | 5.839 ms                  | 859.638 ms                |
| back: set dram grad       | 409.880 us                | 1.441 ms                  |
| Backward                  | 66.369 ms                 | 52.565 s                  |
| Optimize                  | 19.870 ms                 | 159.629 ms                |
| BarrierTimeBeforeRank0    | 30.894 us                 | 177.299 us                |
| BlockToStepN              | 58.230 us                 | 2.488 ms                  |
| OneStep                   | 89.873 ms                 | 52.934 s                  |
+---------------------------+---------------------------+---------------------------+
========== Step 46 ========== 
========== Step 47 ========== 
========== Step 48 ========== 
========== Step 49 ========== 
========== Step 50 ========== 
========== Step 51 ========== 
========== Step 52 ========== 
========== Step 53 ========== 
========== Step 54 ========== 
========== Step 55 ========== 
========== Step 56 ========== 
========== Step 57 ========== 
========== Step 58 ========== 
========== Step 59 ========== 
========== Step 60 ========== 
========== Step 61 ========== 
========== Step 62 ========== 
========== Step 63 ========== 
========== Step 64 ========== 
========== Step 65 ========== 
========== Step 66 ========== 
========== Step 67 ========== 
========== Step 68 ========== 
========== Step 69 ========== 
========== Step 70 ========== 
========== Step 71 ========== 
========== Step 72 ========== 
========== Step 73 ========== 
========== Step 74 ========== 
========== Step 75 ========== 
========== Step 76 ========== 
========== Step 77 ========== 
========== Step 78 ========== 
========== Step 79 ========== 
========== Step 80 ========== 
========== Step 81 ========== 
========== Step 82 ========== 
========== Step 83 ========== 
========== Step 84 ========== 
========== Step 85 ========== 
========== Step 86 ========== 
========== Step 87 ========== 
========== Step 88 ========== 
========== Step 89 ========== 
Successfully xmh
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
INFO [17652 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput:CircleBuffer     | 111.129 us                | 459.607 us                |
| GenInput                  | 447.901 us                | 2.487 ms                  |
| NN                        | 933.909 us                | 7.636 ms                  |
| Forward                   | 1.161 ms                  | 8.921 ms                  |
| back: bucket keys         | 631.972 us                | 7.074 ms                  |
| back: a2a                 | 8.404 ms                  | 28.661 ms                 |
| back: cache               | 44.884 ms                 | 71.421 ms                 |
| back: aggr dram keys      | 5.606 ms                  | 35.531 ms                 |
| back: set dram grad       | 401.713 us                | 847.819 us                |
| Backward                  | 65.327 ms                 | 89.456 ms                 |
| Optimize                  | 20.017 ms                 | 30.173 ms                 |
| BarrierTimeBeforeRank0    | 30.616 us                 | 177.299 us                |
| BlockToStepN              | 51.768 us                 | 1.862 ms                  |
| OneStep                   | 89.675 ms                 | 113.015 ms                |
+---------------------------+---------------------------+---------------------------+
