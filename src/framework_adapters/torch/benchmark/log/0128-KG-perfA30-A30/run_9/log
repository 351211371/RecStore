WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 02:53:00.410152 1165977 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_FB15k_104', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='CppAsync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [1165977 sampler.py:454] Start PreSampling
WARNING [1165977 sampler.py:532] Before construct renumbering_dict
WARNING [1165977 sampler.py:555] PreSampling done
W20240129 02:53:02.613297 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 02:53:02.613413 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 02:53:02.613435 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 02:53:02.613456 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 02:53:02.613471 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 02:53:02.613487 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 02:53:02.613500 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 02:53:02.613520 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 02:53:02.613539 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 02:53:02.613556 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 02:53:02.613576 1165977 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 02:53:02.613592 1165977 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 02:53:02.613608 1165977 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 02:53:02.613680 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 02:53:02.613698 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 02:53:02.613715 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 02:53:02.613746 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 02:53:02.613760 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 02:53:02.613780 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 02:53:02.613793 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 02:53:02.613811 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 02:53:02.613829 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 02:53:02.613847 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 02:53:02.613864 1165977 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 02:53:02.613876 1165977 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 02:53:02.613891 1165977 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 02:53:02.613921 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 02:53:02.613938 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 02:53:02.613955 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 02:53:02.613968 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 02:53:02.613984 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 02:53:02.613998 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 02:53:02.614014 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 02:53:02.614028 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 02:53:02.614043 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 02:53:02.614058 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 02:53:02.614070 1165977 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 02:53:02.614082 1165977 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 02:53:02.614095 1165977 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 02:53:02.614122 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 02:53:02.614141 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 02:53:02.614154 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 02:53:02.614168 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 02:53:02.614181 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 02:53:02.614194 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 02:53:02.614213 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 02:53:02.614229 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 02:53:02.614243 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 02:53:02.614256 1165977 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 02:53:02.614269 1165977 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 02:53:02.614281 1165977 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 02:53:02.614296 1165977 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 02:53:02.729387 1165977 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240129 02:53:02.729501 1165977 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([1647, 1795, 1878,  ..., 2097, 5053, 6397]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.349 seconds
[Rank1] pid = 1166191
[Rank2] pid = 1166256
INFO [1165977 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1166191 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [1166320 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [1166320 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1166256 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1166256 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240129 02:53:06.168815 1166322 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_3 [1495, 400]; dev=3; size=2.281 MB
W20240129 02:53:06.169261 1166322 IPCTensor.h:368] NewIPCTensor: input_keys_3 [1000000]0x100014876000 7.629 MB
W20240129 02:53:06.169375 1166322 IPCTensor.h:368] NewIPCTensor: input_keys_neg_3 [1000000]0x100015019000 7.629 MB
W20240129 02:53:06.169422 1166322 IPCTensor.h:368] NewIPCTensor: backward_grads_3 [1000000, 400]0x1000157bc000 1.49 GB
W20240129 02:53:06.169456 1166322 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_3 [1000000, 400]0x100074d9f000 1.49 GB
W20240129 02:53:06.169483 1166322 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_3_gpu [1000000, 400]; dev=3; size=1.49 GB
INFO [1165977 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240129 02:53:06.170529 1166257 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_2 [1495, 400]; dev=2; size=2.281 MB
W20240129 02:53:06.171350 1166321 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_0 [1495, 400]; dev=0; size=2.281 MB
INFO [1166191 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
W20240129 02:53:06.171452 1166322 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_3_gpu [1000000, 400]; dev=3; size=1.49 GB
W20240129 02:53:06.171663 1166257 IPCTensor.h:368] NewIPCTensor: input_keys_2 [1000000]0x1000d4386000 7.629 MB
W20240129 02:53:06.171905 1166257 IPCTensor.h:368] NewIPCTensor: input_keys_neg_2 [1000000]0x1000d4b29000 7.629 MB
W20240129 02:53:06.172013 1166257 IPCTensor.h:368] NewIPCTensor: backward_grads_2 [1000000, 400]0x1000d52cc000 1.49 GB
W20240129 02:53:06.172101 1166257 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_2 [1000000, 400]0x1001348af000 1.49 GB
W20240129 02:53:06.172165 1166257 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 02:53:06.178288 1166321 IPCTensor.h:368] NewIPCTensor: input_keys_0 [1000000]0x100193e94000 7.629 MB
W20240129 02:53:06.178433 1166257 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_2_gpu [1000000, 400]; dev=2; size=1.49 GB
W20240129 02:53:06.178450 1166321 IPCTensor.h:368] NewIPCTensor: input_keys_neg_0 [1000000]0x100194639000 7.629 MB
W20240129 02:53:06.178550 1166321 IPCTensor.h:368] NewIPCTensor: backward_grads_0 [1000000, 400]0x100194ddc000 1.49 GB
W20240129 02:53:06.178606 1166321 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_0 [1000000, 400]0x1001f43bf000 1.49 GB
W20240129 02:53:06.178670 1166321 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 02:53:06.178915 1166192 IPCTensor.h:408] NewIPCGPUTensor: embedding_cache_1 [1495, 400]; dev=1; size=2.281 MB
W20240129 02:53:06.188365 1166321 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_0_gpu [1000000, 400]; dev=0; size=1.49 GB
W20240129 02:53:06.188513 1166192 IPCTensor.h:368] NewIPCTensor: input_keys_1 [1000000]0x1002539aa000 7.629 MB
W20240129 02:53:06.188728 1166192 IPCTensor.h:368] NewIPCTensor: input_keys_neg_1 [1000000]0x10025414d000 7.629 MB
W20240129 02:53:06.188812 1166192 IPCTensor.h:368] NewIPCTensor: backward_grads_1 [1000000, 400]0x1002548f0000 1.49 GB
W20240129 02:53:06.188891 1166192 IPCTensor.h:368] NewIPCTensor: backward_grads_neg_1 [1000000, 400]0x1002b3ed3000 1.49 GB
W20240129 02:53:06.188966 1166192 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_1_gpu [1000000, 400]; dev=1; size=1.49 GB
W20240129 02:53:06.201435 1166192 IPCTensor.h:408] NewIPCGPUTensor: backward_grads_neg_1_gpu [1000000, 400]; dev=1; size=1.49 GB
[Rank3] pid = 1166320
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
cudaHostRegister 0x100013192000
0: KnownLocalCachedEmbedding init done
WARNING [1165977 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
3: KnownLocalCachedEmbedding init done
WARNING [1166320 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
2: KnownLocalCachedEmbedding init done
WARNING [1166256 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100013192000
1: KnownLocalCachedEmbedding init done
WARNING [1166191 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 02:53:07.270195 1166192 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240129 02:53:07.270360 1166322 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 02:53:07.270428 1166257 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 02:53:07.270529 1166321 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
W20240129 02:53:07.271970 1166321 grad_base.h:55] KGCacheController, config={
        "num_gpus": 4,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsync",
        "cache_ratio": 0.1,
        "update_cache_use_omp":  0,
        "update_pq_use_omp":  0
        }
W20240129 02:53:07.272148 1166321 grad_base.h:184] Init GradProcessingBase done
I20240129 02:53:07.273730 1166321 grad_async_v1.h:199] Use main thread to update emb.
W20240129 02:53:07.273754 1166321 kg_controller.h:75] after init GradAsyncProcessing
I20240129 02:53:07.273757 1166321 kg_controller.h:84] Construct KGCacheController done
E20240129 02:53:07.607335 1166322 recstore.cc:66] init folly done
E20240129 02:53:07.607333 1166192 recstore.cc:66] init folly done
E20240129 02:53:07.607564 1166257 recstore.cc:66] init folly done
E20240129 02:53:07.607623 1166321 recstore.cc:66] init folly done
I20240129 02:53:07.608336 1166321 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240129 02:53:08.304811 1166705 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
I20240129 02:53:08.324810 1166321 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240129 02:53:08.360580 1166257 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 02:53:08.365885 1166322 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 02:53:08.371691 1166192 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
W20240129 02:53:10.929157 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240129 02:53:10.934689 1166705 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 02:53:11.929009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=36, pq.top=36
W20240129 02:53:11.943604 1166705 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 769.157 us                | 16.237 ms                 |
| Forward                   | 2.894 ms                  | 920.103 ms                |
| Backward                  | 5.048 ms                  | 271.314 ms                |
| Optimize                  | 1.020 ms                  | 3.980 ms                  |
| BarrierTimeBeforeRank0    | 20.566 us                 | 127.481 ms                |
| AfterBackward             | 7.709 ms                  | 1.234 s                   |
| BlockToStepN              | 9.515 ms                  | 31.932 ms                 |
| OneStep                   | 31.985 ms                 | 2.562 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.853 ms                  | 165.877 ms                |
| ProcessBack:UpdateCache   | 1.459 ms                  | 349.572 ms                |
| ProcessBack:UpsertPq      | 3.805 ms                  | 6.658 ms                  |
| ProcessOneStep            | 7.702 ms                  | 1.234 s                   |
| BlockToStepN              | 13.595 ms                 | 36.284 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 02:53:12.929008 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=56, pq.top=56
W20240129 02:53:12.947001 1166705 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 02:53:13.929010 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=73, pq.top=73
W20240129 02:53:13.960422 1166705 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 02:53:14.948212 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240129 02:53:15.006464 1166705 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 7.414, sample: 0.147, forward: 1.163, backward: 0.779, update: 0.092
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 7.408, sample: 0.129, forward: 1.142, backward: 0.850, update: 0.088
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 7.403, sample: 0.153, forward: 1.160, backward: 0.806, update: 0.096
train_sampler.Prefill()
-------Step 0-------
tensor([10632,   306,  8040,  6666,  9541,  5751,  8370,  5669, 13081,    76]) tensor([ 1878,  9360,  8094,  1467,  6117, 10156, 11145, 10489,  6885,  6633])
-------Step 1-------
tensor([10632,   306,  8040,  6666,  9541,  5751,  8370,  5669, 13081,    76]) tensor([ 6984, 14402,  9293, 14731,  6128,  7430,  5841,  2128,  3491, 10742])
-------Step 2-------
tensor([10372,  3087,  3430,    11,   699,   289,   292, 12501,  9260,  7234]) tensor([ 9188,  4806,  3447, 14026,  2589,  2533,  9677,  5203, 12927,  8882])
-------Step 3-------
tensor([10372,  3087,  3430,    11,   699,   289,   292, 12501,  9260,  7234]) tensor([  505, 13173,  7450, 11210,   186,   615,  2643, 13911,  6394,   176])
-------Step 4-------
tensor([ 3910, 14912,  9415,  8928,  6239,  6632, 13663,  8734,  4975,  1986]) tensor([11366,  1068,  8278,  9435,  3481,   706,  7686,  1034, 11456, 14817])
-------Step 5-------
tensor([ 3910, 14912,  9415,  8928,  6239,  6632, 13663,  8734,  4975,  1986]) tensor([ 8147,  5504,  6958, 14568,  1222,  9580,  3415, 13731,  6811,  7353])
-------Step 6-------
tensor([11367,   689,  8183,    48, 12512,  9257, 11455,  9415, 11702,  8779]) tensor([ 3109, 12613, 10284, 13301,  7749,  9588,  1906,  3059,  9735,  1276])
-------Step 7-------
tensor([11367,   689,  8183,    48, 12512,  9257, 11455,  9415, 11702,  8779]) tensor([ 4403, 14037, 13269,  6282,  6345,   904,  7502,   965,  9384, 13476])
-------Step 8-------
tensor([11630,  7697, 12321, 11394,  4394,  9110,  1694,  8498,  4345, 13474]) tensor([ 8183, 14208, 14622,  1711, 12673,  9113,  2943, 13290,  6365,  6670])
-------Step 9-------
tensor([11630,  7697, 12321, 11394,  4394,  9110,  1694,  8498,  4345, 13474]) tensor([13703,  9594,  1731,  4082,  2235,   572,  7915,  3426,  3491, 14253])
before start barrier
start train
[proc 0] 100 steps, total: 7.449, sample: 0.215, forward: 1.222, backward: 0.769, update: 0.109
W20240129 02:53:15.948009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=103, pq.top=103
W20240129 02:53:16.009011 1166705 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 02:53:16.948009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=117, pq.top=117
W20240129 02:53:17.011934 1166705 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 997.899 us                | 13.903 ms                 |
| Forward                   | 2.875 ms                  | 10.880 ms                 |
| Backward                  | 5.132 ms                  | 10.004 ms                 |
| Optimize                  | 966.378 us                | 2.549 ms                  |
| BarrierTimeBeforeRank0    | 18.708 us                 | 310.806 us                |
| AfterBackward             | 7.801 ms                  | 12.739 ms                 |
| BlockToStepN              | 38.437 ms                 | 60.000 ms                 |
| OneStep                   | 57.895 ms                 | 83.608 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.788 ms                  | 3.356 ms                  |
| ProcessBack:UpdateCache   | 1.305 ms                  | 2.446 ms                  |
| ProcessBack:UpsertPq      | 4.008 ms                  | 6.658 ms                  |
| ProcessOneStep            | 7.781 ms                  | 12.690 ms                 |
| BlockToStepN              | 39.011 ms                 | 66.063 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 02:53:17.959815 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=130, pq.top=130
W20240129 02:53:18.028527 1166705 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 02:53:18.959009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=142, pq.top=142
W20240129 02:53:19.073882 1166705 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 02:53:19.959009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=154, pq.top=154
W20240129 02:53:20.130020 1166705 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 02:53:20.959005 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=166, pq.top=166
W20240129 02:53:21.160218 1166705 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 02:53:21.959007 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=178, pq.top=178
W20240129 02:53:22.163352 1166705 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 990.003 us                | 10.272 ms                 |
| Forward                   | 2.800 ms                  | 7.042 ms                  |
| Backward                  | 5.138 ms                  | 5.791 ms                  |
| Optimize                  | 947.980 us                | 2.208 ms                  |
| BarrierTimeBeforeRank0    | 18.560 us                 | 601.303 us                |
| AfterBackward             | 7.697 ms                  | 11.562 ms                 |
| BlockToStepN              | 49.499 ms                 | 71.796 ms                 |
| OneStep                   | 68.671 ms                 | 92.896 ms                 |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.748 ms                  | 2.995 ms                  |
| ProcessBack:UpdateCache   | 1.243 ms                  | 2.057 ms                  |
| ProcessBack:UpsertPq      | 4.008 ms                  | 6.376 ms                  |
| ProcessOneStep            | 7.670 ms                  | 11.518 ms                 |
| BlockToStepN              | 49.655 ms                 | 72.041 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 02:53:22.959008 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=190, pq.top=190
W20240129 02:53:23.181417 1166705 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
[proc 0] 200 steps, total: 8.111, sample: 0.205, forward: 0.259, backward: 0.504, update: 0.084
[proc 1] 200 steps, total: 8.111, sample: 0.151, forward: 0.223, backward: 0.493, update: 0.091
[proc 3] 200 steps, total: 8.111, sample: 0.146, forward: 0.210, backward: 0.487, update: 0.086
[proc 2] 200 steps, total: 8.112, sample: 0.159, forward: 0.252, backward: 0.487, update: 0.086
W20240129 02:53:23.959005 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=201, pq.top=201
W20240129 02:53:24.228060 1166705 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 02:53:24.959008 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=213, pq.top=213
W20240129 02:53:25.229914 1166705 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 02:53:25.959008 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=225, pq.top=225
W20240129 02:53:26.283511 1166705 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 02:53:26.959009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=236, pq.top=236
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.022 ms                  | 10.272 ms                 |
| Forward                   | 2.748 ms                  | 7.042 ms                  |
| Backward                  | 5.144 ms                  | 6.153 ms                  |
| Optimize                  | 915.869 us                | 2.208 ms                  |
| BarrierTimeBeforeRank0    | 18.450 us                 | 6.661 ms                  |
| AfterBackward             | 7.601 ms                  | 11.562 ms                 |
| BlockToStepN              | 57.069 ms                 | 79.212 ms                 |
| OneStep                   | 75.335 ms                 | 97.408 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 02:53:27.347874 1166705 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.704 ms                  | 2.723 ms                  |
| ProcessBack:UpdateCache   | 1.232 ms                  | 2.041 ms                  |
| ProcessBack:UpsertPq      | 4.044 ms                  | 6.376 ms                  |
| ProcessOneStep            | 7.578 ms                  | 11.518 ms                 |
| BlockToStepN              | 57.427 ms                 | 79.178 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 02:53:27.959005 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=247, pq.top=247
W20240129 02:53:28.424120 1166705 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 02:53:28.959007 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=259, pq.top=259
W20240129 02:53:29.476500 1166705 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 02:53:29.959008 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=270, pq.top=270
W20240129 02:53:30.528138 1166705 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 02:53:30.959005 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=281, pq.top=281
W20240129 02:53:31.532963 1166705 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 02:53:31.979079 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=293, pq.top=293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.044 ms                  | 10.270 ms                 |
| Forward                   | 2.713 ms                  | 5.604 ms                  |
| Backward                  | 5.148 ms                  | 5.791 ms                  |
| Optimize                  | 905.963 us                | 2.205 ms                  |
| BarrierTimeBeforeRank0    | 18.437 us                 | 6.661 ms                  |
| AfterBackward             | 7.524 ms                  | 10.647 ms                 |
| BlockToStepN              | 60.854 ms                 | 80.490 ms                 |
| OneStep                   | 78.997 ms                 | 103.055 ms                |
+---------------------------+---------------------------+---------------------------+
W20240129 02:53:32.602106 1166705 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.660 ms                  | 2.383 ms                  |
| ProcessBack:UpdateCache   | 1.227 ms                  | 2.031 ms                  |
| ProcessBack:UpsertPq      | 4.063 ms                  | 6.333 ms                  |
| ProcessOneStep            | 7.521 ms                  | 10.609 ms                 |
| BlockToStepN              | 61.027 ms                 | 80.424 ms                 |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 8.808, sample: 0.200, forward: 0.252, backward: 0.511, update: 0.086
[proc 2] 300 steps, total: 8.808, sample: 0.146, forward: 0.244, backward: 0.494, update: 0.079
[proc 1] 300 steps, total: 8.808, sample: 0.136, forward: 0.223, backward: 0.491, update: 0.092
[proc 3] 300 steps, total: 8.808, sample: 0.140, forward: 0.210, backward: 0.490, update: 0.083
W20240129 02:53:32.979009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=304, pq.top=304
W20240129 02:53:33.606371 1166705 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 02:53:33.979004 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=315, pq.top=315
W20240129 02:53:34.667413 1166705 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 02:53:34.979007 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=326, pq.top=326
W20240129 02:53:35.705307 1166705 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 02:53:35.979007 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=338, pq.top=338
W20240129 02:53:36.719033 1166705 grad_async_v1.h:280] Detect new sample comes, old_end5, new_end6
W20240129 02:53:36.979007 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=348, pq.top=348
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.049 ms                  | 10.169 ms                 |
| Forward                   | 2.689 ms                  | 5.355 ms                  |
| Backward                  | 5.156 ms                  | 5.542 ms                  |
| Optimize                  | 897.444 us                | 2.085 ms                  |
| BarrierTimeBeforeRank0    | 18.450 us                 | 6.561 ms                  |
| AfterBackward             | 7.461 ms                  | 10.603 ms                 |
| BlockToStepN              | 62.510 ms                 | 82.721 ms                 |
| OneStep                   | 81.456 ms                 | 105.034 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.647 ms                  | 2.180 ms                  |
| ProcessBack:UpdateCache   | 1.223 ms                  | 1.926 ms                  |
| ProcessBack:UpsertPq      | 4.075 ms                  | 6.376 ms                  |
| ProcessOneStep            | 7.434 ms                  | 10.567 ms                 |
| BlockToStepN              | 62.508 ms                 | 82.674 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 02:53:37.770227 1166705 grad_async_v1.h:280] Detect new sample comes, old_end7, new_end8
W20240129 02:53:37.979007 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=360, pq.top=360
W20240129 02:53:38.834131 1166705 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 02:53:38.979007 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=371, pq.top=371
W20240129 02:53:39.836040 1166705 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
W20240129 02:53:39.979005 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=382, pq.top=382
W20240129 02:53:40.891005 1166705 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 02:53:40.979008 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=393, pq.top=393
[proc 2] 400 steps, total: 8.946, sample: 0.141, forward: 0.246, backward: 0.495, update: 0.084
[proc 1] 400 steps, total: 8.946, sample: 0.147, forward: 0.221, backward: 0.489, update: 0.091
[proc 0] 400 steps, total: 8.946, sample: 0.201, forward: 0.249, backward: 0.511, update: 0.081
[proc 3] 400 steps, total: 8.946, sample: 0.134, forward: 0.209, backward: 0.488, update: 0.084
W20240129 02:53:41.892769 1166705 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
W20240129 02:53:41.986099 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=405, pq.top=405
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.062 ms                  | 10.169 ms                 |
| Forward                   | 2.671 ms                  | 5.355 ms                  |
| Backward                  | 5.156 ms                  | 5.660 ms                  |
| Optimize                  | 893.241 us                | 2.085 ms                  |
| BarrierTimeBeforeRank0    | 18.437 us                 | 6.886 ms                  |
| AfterBackward             | 7.419 ms                  | 10.603 ms                 |
| BlockToStepN              | 64.134 ms                 | 83.369 ms                 |
| OneStep                   | 82.903 ms                 | 105.034 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.641 ms                  | 2.154 ms                  |
| ProcessBack:UpdateCache   | 1.220 ms                  | 1.841 ms                  |
| ProcessBack:UpsertPq      | 4.071 ms                  | 6.333 ms                  |
| ProcessOneStep            | 7.399 ms                  | 10.567 ms                 |
| BlockToStepN              | 64.141 ms                 | 83.329 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 02:53:42.897792 1166705 grad_async_v1.h:280] Detect new sample comes, old_end4, new_end5
W20240129 02:53:42.994380 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=416, pq.top=416
W20240129 02:53:43.968139 1166705 grad_async_v1.h:280] Detect new sample comes, old_end6, new_end7
W20240129 02:53:43.994005 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240129 02:53:44.994009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=438, pq.top=438
W20240129 02:53:45.054767 1166705 grad_async_v1.h:280] Detect new sample comes, old_end8, new_end9
W20240129 02:53:45.994009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240129 02:53:46.059461 1166705 grad_async_v1.h:280] Detect new sample comes, old_end9, new_end0
W20240129 02:53:46.994005 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=460, pq.top=460
W20240129 02:53:47.064281 1166705 grad_async_v1.h:280] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 1.080 ms                  | 10.165 ms                 |
| Forward                   | 2.643 ms                  | 4.788 ms                  |
| Backward                  | 5.157 ms                  | 5.542 ms                  |
| Optimize                  | 894.696 us                | 2.006 ms                  |
| BarrierTimeBeforeRank0    | 18.406 us                 | 6.661 ms                  |
| AfterBackward             | 7.400 ms                  | 10.603 ms                 |
| BlockToStepN              | 65.245 ms                 | 82.932 ms                 |
| OneStep                   | 84.368 ms                 | 104.781 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 1.637 ms                  | 2.154 ms                  |
| ProcessBack:UpdateCache   | 1.220 ms                  | 1.804 ms                  |
| ProcessBack:UpsertPq      | 4.071 ms                  | 6.480 ms                  |
| ProcessOneStep            | 7.383 ms                  | 10.567 ms                 |
| BlockToStepN              | 65.271 ms                 | 82.899 ms                 |
+---------------------------+---------------------------+---------------------------+
W20240129 02:53:47.994009 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240129 02:53:48.064946 1166705 grad_async_v1.h:280] Detect new sample comes, old_end1, new_end2
W20240129 02:53:48.997603 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=482, pq.top=482
W20240129 02:53:49.081707 1166705 grad_async_v1.h:280] Detect new sample comes, old_end2, new_end3
W20240129 02:53:49.997005 1166321 grad_async_v1.h:406] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240129 02:53:50.090193 1166705 grad_async_v1.h:280] Detect new sample comes, old_end3, new_end4
[proc 2] 500 steps, total: 9.063, sample: 0.156, forward: 0.244, backward: 0.493, update: 0.080
[proc 0] 500 steps, total: 9.063, sample: 0.204, forward: 0.249, backward: 0.510, update: 0.085
[proc 1] 500 steps, total: 9.063, sample: 0.135, forward: 0.221, backward: 0.485, update: 0.086
[proc 3] 500 steps, total: 9.063, sample: 0.137, forward: 0.209, backward: 0.490, update: 0.088
Successfully xmh. training takes 42.37762808799744 seconds
before call kg_cache_controller.StopThreads()
W20240129 02:53:50.702457 1166321 grad_async_v1.h:230] call StopThreads. PID = 1165977
W20240129 02:53:50.702478 1166321 grad_base.h:212] before processOneStepNegThread_.join();
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
W20240129 02:53:50.708051 1166321 grad_base.h:214] after processOneStepNegThread_.join();
W20240129 02:53:50.708076 1166321 grad_async_v1.h:232] call GradProcessingBase::StopThreads.
W20240129 02:53:50.727445 1166321 grad_async_v1.h:251] StopThreads done.
