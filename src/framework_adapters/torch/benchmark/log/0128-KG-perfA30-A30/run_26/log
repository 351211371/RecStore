WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240129 03:15:55.774484 1198647 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 483142 train triples.
Reading valid triples....
Finished. Read 50000 valid triples.
Reading test triples....
Finished. Read 59071 test triples.
ARGS:  Namespace(model_name='SimplE', data_path='/home/xieminhui/dgl-data', dataset='FB15k', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/SimplE_FB15k_72', no_save_emb=True, max_step=500, batch_size=1200, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=14951, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=4, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=4, gpu=[0, 1, 2, 3], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='TorchNativeStdEmb', use_my_emb=True, cache_ratio=0.1, shuffle=False, backwardMode='PySync', L=10, update_cache_use_omp=0, update_pq_use_omp=0, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 483142
original graph:  DGLGraph(num_nodes=14951, num_edges=592213,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [1198647 sampler.py:454] Start PreSampling
WARNING [1198647 sampler.py:532] Before construct renumbering_dict
WARNING [1198647 sampler.py:555] PreSampling done
W20240129 03:15:57.959511 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_0 [1000000]0x100000002000 7.629 MB
W20240129 03:15:57.959619 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_1 [1000000]0x1000007a5000 7.629 MB
W20240129 03:15:57.959653 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_2 [1000000]0x100000f48000 7.629 MB
W20240129 03:15:57.959671 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_3 [1000000]0x1000016eb000 7.629 MB
W20240129 03:15:57.959692 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_4 [1000000]0x100001e8e000 7.629 MB
W20240129 03:15:57.959704 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_5 [1000000]0x100002631000 7.629 MB
W20240129 03:15:57.959721 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_6 [1000000]0x100002dd4000 7.629 MB
W20240129 03:15:57.959738 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_7 [1000000]0x100003577000 7.629 MB
W20240129 03:15:57.959756 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_8 [1000000]0x100003d1a000 7.629 MB
W20240129 03:15:57.959779 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r0_9 [1000000]0x1000044bd000 7.629 MB
W20240129 03:15:57.959808 1198647 IPCTensor.h:368] NewIPCTensor: step_r0 [10]0x100004c60000 80 B 
W20240129 03:15:57.959825 1198647 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r0 [1]0x100004c62000 8 B 
W20240129 03:15:57.959838 1198647 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x100004c64000 8 B 
W20240129 03:15:57.959921 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_0 [1000000]0x100004c66000 7.629 MB
W20240129 03:15:57.959946 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_1 [1000000]0x100005409000 7.629 MB
W20240129 03:15:57.959960 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_2 [1000000]0x100005bac000 7.629 MB
W20240129 03:15:57.959995 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_3 [1000000]0x10000634f000 7.629 MB
W20240129 03:15:57.960012 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_4 [1000000]0x100006af2000 7.629 MB
W20240129 03:15:57.960028 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_5 [1000000]0x100007295000 7.629 MB
W20240129 03:15:57.960042 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_6 [1000000]0x100007a38000 7.629 MB
W20240129 03:15:57.960058 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_7 [1000000]0x1000081db000 7.629 MB
W20240129 03:15:57.960078 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_8 [1000000]0x10000897e000 7.629 MB
W20240129 03:15:57.960095 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r1_9 [1000000]0x100009121000 7.629 MB
W20240129 03:15:57.960114 1198647 IPCTensor.h:368] NewIPCTensor: step_r1 [10]0x1000098c4000 80 B 
W20240129 03:15:57.960127 1198647 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r1 [1]0x1000098c6000 8 B 
W20240129 03:15:57.960139 1198647 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x1000098c8000 8 B 
W20240129 03:15:57.960167 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_0 [1000000]0x1000098ca000 7.629 MB
W20240129 03:15:57.960184 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_1 [1000000]0x10000a06d000 7.629 MB
W20240129 03:15:57.960197 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_2 [1000000]0x10000a810000 7.629 MB
W20240129 03:15:57.960214 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_3 [1000000]0x10000afb3000 7.629 MB
W20240129 03:15:57.960228 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_4 [1000000]0x10000b756000 7.629 MB
W20240129 03:15:57.960242 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_5 [1000000]0x10000bef9000 7.629 MB
W20240129 03:15:57.960254 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_6 [1000000]0x10000c69c000 7.629 MB
W20240129 03:15:57.960268 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_7 [1000000]0x10000ce3f000 7.629 MB
W20240129 03:15:57.960280 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_8 [1000000]0x10000d5e2000 7.629 MB
W20240129 03:15:57.960294 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r2_9 [1000000]0x10000dd85000 7.629 MB
W20240129 03:15:57.960306 1198647 IPCTensor.h:368] NewIPCTensor: step_r2 [10]0x10000e528000 80 B 
W20240129 03:15:57.960318 1198647 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r2 [1]0x10000e52a000 8 B 
W20240129 03:15:57.960330 1198647 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x10000e52c000 8 B 
W20240129 03:15:57.960356 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_0 [1000000]0x10000e52e000 7.629 MB
W20240129 03:15:57.960376 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_1 [1000000]0x10000ecd1000 7.629 MB
W20240129 03:15:57.960391 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_2 [1000000]0x10000f474000 7.629 MB
W20240129 03:15:57.960408 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_3 [1000000]0x10000fc17000 7.629 MB
W20240129 03:15:57.960428 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_4 [1000000]0x1000103ba000 7.629 MB
W20240129 03:15:57.960443 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_5 [1000000]0x100010b5d000 7.629 MB
W20240129 03:15:57.960456 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_6 [1000000]0x100011300000 7.629 MB
W20240129 03:15:57.960474 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_7 [1000000]0x100011aa3000 7.629 MB
W20240129 03:15:57.960489 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_8 [1000000]0x100012246000 7.629 MB
W20240129 03:15:57.960505 1198647 IPCTensor.h:368] NewIPCTensor: cached_sampler_r3_9 [1000000]0x1000129e9000 7.629 MB
W20240129 03:15:57.960518 1198647 IPCTensor.h:368] NewIPCTensor: step_r3 [10]0x10001318c000 80 B 
W20240129 03:15:57.960529 1198647 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_r3 [1]0x10001318e000 8 B 
W20240129 03:15:57.960546 1198647 IPCTensor.h:368] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100013190000 8 B 
W20240129 03:15:58.080011 1198647 IPCTensor.h:368] NewIPCTensor: full_emb [14951, 400]0x100013192000 22.81 MB
W20240129 03:15:58.080128 1198647 IPCTensor.h:368] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [14951]0x100014864000 58.4 kB
{0: Graph(num_nodes=10523, num_edges=182012,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=10996, num_edges=244360,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=9404, num_edges=143355,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=10954, num_edges=175447,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 10523 N 182012 E
MertisPartition: part 1 has 10996 N 244360 E
MertisPartition: part 2 has 9404 N 143355 E
MertisPartition: part 3 has 10954 N 175447 E
Rank0: cached key size 373
Rank1: cached key size 373
Rank2: cached key size 373
Rank3: cached key size 373
Before renumbering graph:  {'_ID': tensor([    5,    14,    17,  ..., 11245,  2040,  3009]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
After renumbering graph:  {'_ID': tensor([1645, 1882, 1963,  ..., 2392, 5733, 7000]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 2, 3, 3])}
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=10523, num_edges=182012,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 2.336 seconds
[Rank1] pid = 1198857
[Rank2] pid = 1198922
INFO [1198647 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [1198857 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [1198857 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1198922 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [1198857 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [1198986 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [1198922 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1198986 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1198857 cache_common.py:139] TorchNativeStdEmb construct done
INFO [1198922 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
WARNING [1198857 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [1198986 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [1198922 cache_common.py:139] TorchNativeStdEmb construct done
INFO [1198986 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [1198922 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [1198986 DistTensor.py:56] The tensor name already exists in the kvstore
INFO [1198647 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 4 nodes.
INFO [1198647 cache_common.py:125] TorchNativeStdEmb: weight.shape torch.Size([14951, 400])
INFO [1198647 cache_common.py:139] TorchNativeStdEmb construct done
WARNING [1198647 DistTensor.py:56] The tensor name already exists in the kvstore
I20240129 03:16:01.475719 1198987 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 4
I20240129 03:16:01.475842 1198988 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 03:16:01.475957 1198858 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
I20240129 03:16:01.476061 1198923 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 4
E20240129 03:16:01.803967 1198987 recstore.cc:66] init folly done
E20240129 03:16:01.804081 1198923 recstore.cc:66] init folly done
E20240129 03:16:01.804193 1198858 recstore.cc:66] init folly done
E20240129 03:16:01.804416 1198988 recstore.cc:66] init folly done
I20240129 03:16:01.838495 1198987 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 4
I20240129 03:16:01.875808 1198923 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 03:16:01.875861 1198988 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
I20240129 03:16:01.880105 1198858 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 776.951 us                | 9.920 ms                  |
| Forward                   | 4.444 ms                  | 575.946 ms                |
| Backward                  | 48.234 ms                 | 955.635 ms                |
| Optimize                  | 1.016 ms                  | 36.420 ms                 |
| BarrierTimeBeforeRank0    | 39.819 us                 | 530.244 ms                |
| BlockToStepN              | 8.846 us                  | 65.260 us                 |
| OneStep                   | 54.881 ms                 | 1.455 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 773.629 us                | 9.767 ms                  |
| Forward                   | 4.410 ms                  | 5.764 ms                  |
| Backward                  | 91.253 ms                 | 310.542 ms                |
| Optimize                  | 1.017 ms                  | 2.567 ms                  |
| BarrierTimeBeforeRank0    | 36.446 us                 | 144.474 ms                |
| BlockToStepN              | 8.596 us                  | 65.260 us                 |
| OneStep                   | 101.927 ms                | 1.110 s                   |
+---------------------------+---------------------------+---------------------------+
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 13.465, sample: 0.170, forward: 1.427, backward: 11.087, update: 0.163
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 13.469, sample: 0.181, forward: 1.396, backward: 10.844, update: 0.144
[Rank3] pid = 1198986
New CachedEmbedding, name=full_emb, shape=(14951, 400), cache_type=TorchNativeStdEmb
fixed cache_range is [(0, 1495), (1495, 2990), (2990, 4485), (4485, 5980)]
train_sampler.Prefill()
-------Step 0-------
tensor([ 9774,   257,  8598,  6854,  9107,  5272, 13620,  5930, 13639,    43]) tensor([ 1963,  9483,  8662,  1379,  7080,  9298, 11738,  9658,  7568,  7079])
-------Step 1-------
tensor([ 9774,   257,  8598,  6854,  9107,  5272, 13620,  5930, 13639,    43]) tensor([ 8436, 14113, 11022, 12356,  6493,  7937,  7128,  2146,  2846,  9801])
-------Step 2-------
tensor([10154,  2960,  3638,    11,   726,   225,   251, 12197, 10844,  6996]) tensor([ 9169,  3695,  3511, 13164,  2179,  2620, 10540,  5206, 13091,  8163])
-------Step 3-------
tensor([10154,  2960,  3638,    11,   726,   225,   251, 12197, 10844,  6996]) tensor([  548, 13126,  5905, 11234,   330,   545,  2538, 10051,  6628,   178])
-------Step 4-------
tensor([ 3604, 14906,  9184,  9403,  6260,  5300, 11111,  8200,  4737,  2021]) tensor([14928,   982, 10582,  9388,  5201,   723,  6442,  1076, 10964, 13598])
-------Step 5-------
tensor([ 3604, 14906,  9184,  9403,  6260,  5300, 11111,  8200,  4737,  2021]) tensor([ 8065,  6858,  7445, 14666,  1309, 14513,  3566, 11686,  6740,  7246])
-------Step 6-------
tensor([12610,   646,  7845,    55,  9814, 14330, 12566,  9184, 10647,  5849]) tensor([ 3179, 10188,  8215, 13249,  8355, 10496,  1897,  2542, 14581,  1352])
-------Step 7-------
tensor([12610,   646,  7845,    55,  9814, 14330, 12566,  9184, 10647,  5849]) tensor([ 4494, 14551, 10244,  6880,  6593,   917,  8354,  1004,  9339, 11270])
-------Step 8-------
tensor([11130,  9775, 14215, 11101,  4409,  5988,  1749,  6874,  4649, 13498]) tensor([ 7845, 13193, 14470,  1716, 12177, 10069,  2549, 10268,  6804,  8413])
-------Step 9-------
tensor([11130,  9775, 14215, 11101,  4409,  5988,  1749,  6874,  4649, 13498]) tensor([10862,  9856,  1737,  3373,  2266,   670,  8079,  3458,  2846, 14454])
before start barrier
start train
[proc 0] 100 steps, total: 13.506, sample: 0.169, forward: 1.001, backward: 11.235, update: 0.132
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 13.469, sample: 0.164, forward: 1.374, backward: 10.372, update: 0.146
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 759.396 us                | 9.767 ms                  |
| Forward                   | 4.373 ms                  | 5.764 ms                  |
| Backward                  | 108.365 ms                | 310.542 ms                |
| Optimize                  | 1.005 ms                  | 2.567 ms                  |
| BarrierTimeBeforeRank0    | 35.375 us                 | 144.474 ms                |
| BlockToStepN              | 8.522 us                  | 65.260 us                 |
| OneStep                   | 121.506 ms                | 1.110 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 750.959 us                | 9.767 ms                  |
| Forward                   | 4.348 ms                  | 5.764 ms                  |
| Backward                  | 125.804 ms                | 310.542 ms                |
| Optimize                  | 1.002 ms                  | 2.567 ms                  |
| BarrierTimeBeforeRank0    | 33.179 us                 | 144.474 ms                |
| BlockToStepN              | 8.519 us                  | 77.067 us                 |
| OneStep                   | 132.332 ms                | 1.110 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.196 us                | 9.767 ms                  |
| Forward                   | 4.312 ms                  | 5.764 ms                  |
| Backward                  | 140.911 ms                | 310.860 ms                |
| Optimize                  | 1.003 ms                  | 2.567 ms                  |
| BarrierTimeBeforeRank0    | 32.203 us                 | 144.474 ms                |
| BlockToStepN              | 8.463 us                  | 1.633 ms                  |
| OneStep                   | 147.150 ms                | 1.110 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.637 us                | 9.561 ms                  |
| Forward                   | 4.300 ms                  | 5.303 ms                  |
| Backward                  | 160.528 ms                | 315.148 ms                |
| Optimize                  | 1.012 ms                  | 1.628 ms                  |
| BarrierTimeBeforeRank0    | 32.287 us                 | 30.338 ms                 |
| BlockToStepN              | 8.467 us                  | 77.067 us                 |
| OneStep                   | 166.972 ms                | 321.817 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 733.378 us                | 9.561 ms                  |
| Forward                   | 4.294 ms                  | 5.303 ms                  |
| Backward                  | 168.324 ms                | 357.462 ms                |
| Optimize                  | 1.012 ms                  | 1.628 ms                  |
| BarrierTimeBeforeRank0    | 32.287 us                 | 30.338 ms                 |
| BlockToStepN              | 8.500 us                  | 77.067 us                 |
| OneStep                   | 175.035 ms                | 384.988 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 730.835 us                | 9.561 ms                  |
| Forward                   | 4.294 ms                  | 5.616 ms                  |
| Backward                  | 180.456 ms                | 378.782 ms                |
| Optimize                  | 1.016 ms                  | 1.628 ms                  |
| BarrierTimeBeforeRank0    | 32.183 us                 | 30.338 ms                 |
| BlockToStepN              | 8.523 us                  | 77.067 us                 |
| OneStep                   | 192.836 ms                | 389.439 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 200 steps, total: 28.693, sample: 0.167, forward: 0.370, backward: 24.957, update: 0.096
[proc 3] 200 steps, total: 28.693, sample: 0.167, forward: 0.362, backward: 24.852, update: 0.107
[proc 1] 200 steps, total: 28.694, sample: 0.155, forward: 0.372, backward: 26.190, update: 0.095
[proc 0] 200 steps, total: 28.694, sample: 0.163, forward: 0.413, backward: 27.752, update: 0.096
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 730.835 us                | 9.561 ms                  |
| Forward                   | 4.277 ms                  | 5.616 ms                  |
| Backward                  | 191.087 ms                | 389.784 ms                |
| Optimize                  | 1.017 ms                  | 1.628 ms                  |
| BarrierTimeBeforeRank0    | 32.183 us                 | 30.338 ms                 |
| BlockToStepN              | 8.522 us                  | 77.067 us                 |
| OneStep                   | 205.243 ms                | 411.128 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 730.835 us                | 9.561 ms                  |
| Forward                   | 4.265 ms                  | 5.764 ms                  |
| Backward                  | 207.015 ms                | 419.696 ms                |
| Optimize                  | 1.018 ms                  | 1.628 ms                  |
| BarrierTimeBeforeRank0    | 32.203 us                 | 30.338 ms                 |
| BlockToStepN              | 8.596 us                  | 77.067 us                 |
| OneStep                   | 220.637 ms                | 442.440 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 730.239 us                | 9.561 ms                  |
| Forward                   | 4.234 ms                  | 5.764 ms                  |
| Backward                  | 215.198 ms                | 451.732 ms                |
| Optimize                  | 1.019 ms                  | 1.628 ms                  |
| BarrierTimeBeforeRank0    | 32.160 us                 | 30.338 ms                 |
| BlockToStepN              | 8.697 us                  | 86.727 us                 |
| OneStep                   | 228.375 ms                | 468.266 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 729.336 us                | 9.561 ms                  |
| Forward                   | 4.213 ms                  | 5.764 ms                  |
| Backward                  | 230.066 ms                | 472.535 ms                |
| Optimize                  | 1.023 ms                  | 1.628 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 30.338 ms                 |
| BlockToStepN              | 8.759 us                  | 86.727 us                 |
| OneStep                   | 236.726 ms                | 490.373 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 730.835 us                | 9.561 ms                  |
| Forward                   | 4.213 ms                  | 5.616 ms                  |
| Backward                  | 234.887 ms                | 483.668 ms                |
| Optimize                  | 1.024 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 27.367 ms                 |
| BlockToStepN              | 8.907 us                  | 77.067 us                 |
| OneStep                   | 241.094 ms                | 505.423 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 731.363 us                | 9.561 ms                  |
| Forward                   | 4.228 ms                  | 5.616 ms                  |
| Backward                  | 243.801 ms                | 507.545 ms                |
| Optimize                  | 1.027 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 27.367 ms                 |
| BlockToStepN              | 8.907 us                  | 77.067 us                 |
| OneStep                   | 255.287 ms                | 524.476 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 732.511 us                | 9.561 ms                  |
| Forward                   | 4.228 ms                  | 5.616 ms                  |
| Backward                  | 251.522 ms                | 517.987 ms                |
| Optimize                  | 1.028 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.160 us                 | 27.367 ms                 |
| BlockToStepN              | 8.886 us                  | 77.067 us                 |
| OneStep                   | 263.403 ms                | 532.069 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 732.511 us                | 9.561 ms                  |
| Forward                   | 4.228 ms                  | 5.616 ms                  |
| Backward                  | 262.263 ms                | 527.406 ms                |
| Optimize                  | 1.030 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.160 us                 | 27.367 ms                 |
| BlockToStepN              | 8.931 us                  | 77.067 us                 |
| OneStep                   | 269.131 ms                | 545.793 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 732.511 us                | 9.561 ms                  |
| Forward                   | 4.223 ms                  | 5.616 ms                  |
| Backward                  | 272.961 ms                | 558.189 ms                |
| Optimize                  | 1.033 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.163 us                 | 27.367 ms                 |
| BlockToStepN              | 8.954 us                  | 77.067 us                 |
| OneStep                   | 284.672 ms                | 574.253 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 0] 300 steps, total: 47.326, sample: 0.161, forward: 0.424, backward: 46.476, update: 0.104
[proc 3] 300 steps, total: 47.326, sample: 0.159, forward: 0.358, backward: 40.810, update: 0.102
[proc 1] 300 steps, total: 47.326, sample: 0.145, forward: 0.370, backward: 42.987, update: 0.096
[proc 2] 300 steps, total: 47.326, sample: 0.154, forward: 0.363, backward: 40.936, update: 0.102
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.018 us                | 9.570 ms                  |
| Forward                   | 4.212 ms                  | 5.616 ms                  |
| Backward                  | 279.323 ms                | 577.180 ms                |
| Optimize                  | 1.033 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 27.367 ms                 |
| BlockToStepN              | 9.007 us                  | 77.067 us                 |
| OneStep                   | 290.300 ms                | 589.119 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.387 us                | 9.570 ms                  |
| Forward                   | 4.211 ms                  | 5.616 ms                  |
| Backward                  | 290.980 ms                | 583.880 ms                |
| Optimize                  | 1.034 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.160 us                 | 27.367 ms                 |
| BlockToStepN              | 9.007 us                  | 77.067 us                 |
| OneStep                   | 299.102 ms                | 594.030 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 734.387 us                | 9.570 ms                  |
| Forward                   | 4.211 ms                  | 5.616 ms                  |
| Backward                  | 296.406 ms                | 609.372 ms                |
| Optimize                  | 1.038 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.160 us                 | 27.367 ms                 |
| BlockToStepN              | 9.007 us                  | 77.067 us                 |
| OneStep                   | 308.963 ms                | 624.749 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.637 us                | 9.570 ms                  |
| Forward                   | 4.212 ms                  | 5.616 ms                  |
| Backward                  | 304.865 ms                | 619.972 ms                |
| Optimize                  | 1.039 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.160 us                 | 27.367 ms                 |
| BlockToStepN              | 9.007 us                  | 77.067 us                 |
| OneStep                   | 312.476 ms                | 632.953 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.637 us                | 9.570 ms                  |
| Forward                   | 4.212 ms                  | 5.616 ms                  |
| Backward                  | 309.602 ms                | 634.077 ms                |
| Optimize                  | 1.040 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.160 us                 | 27.367 ms                 |
| BlockToStepN              | 9.083 us                  | 77.067 us                 |
| OneStep                   | 321.370 ms                | 671.548 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.637 us                | 9.570 ms                  |
| Forward                   | 4.212 ms                  | 5.616 ms                  |
| Backward                  | 315.321 ms                | 666.481 ms                |
| Optimize                  | 1.041 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 27.367 ms                 |
| BlockToStepN              | 9.152 us                  | 77.067 us                 |
| OneStep                   | 323.924 ms                | 675.417 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.637 us                | 9.570 ms                  |
| Forward                   | 4.211 ms                  | 5.616 ms                  |
| Backward                  | 318.209 ms                | 673.775 ms                |
| Optimize                  | 1.043 ms                  | 1.622 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 27.367 ms                 |
| BlockToStepN              | 9.159 us                  | 77.067 us                 |
| OneStep                   | 331.226 ms                | 681.280 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.637 us                | 9.561 ms                  |
| Forward                   | 4.223 ms                  | 5.340 ms                  |
| Backward                  | 326.811 ms                | 674.743 ms                |
| Optimize                  | 1.043 ms                  | 1.602 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 26.980 ms                 |
| BlockToStepN              | 9.216 us                  | 65.260 us                 |
| OneStep                   | 335.584 ms                | 682.541 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.025 us                | 9.561 ms                  |
| Forward                   | 4.228 ms                  | 5.340 ms                  |
| Backward                  | 334.977 ms                | 687.666 ms                |
| Optimize                  | 1.046 ms                  | 1.602 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 26.980 ms                 |
| BlockToStepN              | 9.267 us                  | 65.260 us                 |
| OneStep                   | 350.565 ms                | 706.277 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.025 us                | 9.561 ms                  |
| Forward                   | 4.223 ms                  | 5.340 ms                  |
| Backward                  | 345.328 ms                | 702.011 ms                |
| Optimize                  | 1.050 ms                  | 1.602 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 26.980 ms                 |
| BlockToStepN              | 9.337 us                  | 65.260 us                 |
| OneStep                   | 356.932 ms                | 727.693 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.955 us                | 9.561 ms                  |
| Forward                   | 4.228 ms                  | 5.382 ms                  |
| Backward                  | 351.249 ms                | 722.114 ms                |
| Optimize                  | 1.052 ms                  | 1.602 ms                  |
| BarrierTimeBeforeRank0    | 32.160 us                 | 26.980 ms                 |
| BlockToStepN              | 9.400 us                  | 65.260 us                 |
| OneStep                   | 362.737 ms                | 738.796 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 735.637 us                | 9.561 ms                  |
| Forward                   | 4.228 ms                  | 5.382 ms                  |
| Backward                  | 358.051 ms                | 742.291 ms                |
| Optimize                  | 1.053 ms                  | 1.602 ms                  |
| BarrierTimeBeforeRank0    | 32.122 us                 | 26.980 ms                 |
| BlockToStepN              | 9.425 us                  | 65.260 us                 |
| OneStep                   | 365.432 ms                | 750.992 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 737.028 us                | 9.561 ms                  |
| Forward                   | 4.234 ms                  | 5.382 ms                  |
| Backward                  | 359.237 ms                | 750.868 ms                |
| Optimize                  | 1.055 ms                  | 1.602 ms                  |
| BarrierTimeBeforeRank0    | 32.122 us                 | 26.980 ms                 |
| BlockToStepN              | 9.462 us                  | 65.260 us                 |
| OneStep                   | 371.618 ms                | 763.651 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 737.028 us                | 9.561 ms                  |
| Forward                   | 4.237 ms                  | 5.382 ms                  |
| Backward                  | 370.483 ms                | 773.380 ms                |
| Optimize                  | 1.056 ms                  | 1.602 ms                  |
| BarrierTimeBeforeRank0    | 32.122 us                 | 26.980 ms                 |
| BlockToStepN              | 9.531 us                  | 65.260 us                 |
| OneStep                   | 384.988 ms                | 787.383 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 3] 400 steps, total: 65.841, sample: 0.155, forward: 0.360, backward: 57.025, update: 0.104
[proc 1] 400 steps, total: 65.841, sample: 0.157, forward: 0.368, backward: 59.783, update: 0.098
[proc 0] 400 steps, total: 65.841, sample: 0.160, forward: 0.426, backward: 65.030, update: 0.111
[proc 2] 400 steps, total: 65.841, sample: 0.152, forward: 0.362, backward: 57.351, update: 0.103
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 738.220 us                | 9.561 ms                  |
| Forward                   | 4.255 ms                  | 5.382 ms                  |
| Backward                  | 377.800 ms                | 789.383 ms                |
| Optimize                  | 1.059 ms                  | 1.602 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 26.980 ms                 |
| BlockToStepN              | 9.546 us                  | 65.260 us                 |
| OneStep                   | 386.101 ms                | 805.574 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 738.220 us                | 9.561 ms                  |
| Forward                   | 4.264 ms                  | 5.382 ms                  |
| Backward                  | 379.203 ms                | 800.185 ms                |
| Optimize                  | 1.060 ms                  | 1.602 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 26.980 ms                 |
| BlockToStepN              | 9.531 us                  | 65.260 us                 |
| OneStep                   | 391.327 ms                | 823.840 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 738.220 us                | 9.561 ms                  |
| Forward                   | 4.265 ms                  | 5.382 ms                  |
| Backward                  | 384.641 ms                | 816.831 ms                |
| Optimize                  | 1.060 ms                  | 1.628 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 26.980 ms                 |
| BlockToStepN              | 9.566 us                  | 65.260 us                 |
| OneStep                   | 395.812 ms                | 825.862 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 738.318 us                | 9.561 ms                  |
| Forward                   | 4.265 ms                  | 5.382 ms                  |
| Backward                  | 389.784 ms                | 821.563 ms                |
| Optimize                  | 1.060 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.122 us                 | 26.980 ms                 |
| BlockToStepN              | 9.605 us                  | 65.260 us                 |
| OneStep                   | 405.616 ms                | 837.527 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.196 us                | 9.561 ms                  |
| Forward                   | 4.266 ms                  | 5.524 ms                  |
| Backward                  | 397.972 ms                | 830.525 ms                |
| Optimize                  | 1.061 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.122 us                 | 26.980 ms                 |
| BlockToStepN              | 9.626 us                  | 65.260 us                 |
| OneStep                   | 409.327 ms                | 845.299 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.196 us                | 9.561 ms                  |
| Forward                   | 4.266 ms                  | 5.524 ms                  |
| Backward                  | 404.128 ms                | 854.136 ms                |
| Optimize                  | 1.064 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.127 us                 | 26.980 ms                 |
| BlockToStepN              | 9.769 us                  | 65.260 us                 |
| OneStep                   | 411.128 ms                | 862.292 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.831 us                | 9.561 ms                  |
| Forward                   | 4.266 ms                  | 5.524 ms                  |
| Backward                  | 413.575 ms                | 854.136 ms                |
| Optimize                  | 1.066 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.122 us                 | 26.980 ms                 |
| BlockToStepN              | 9.794 us                  | 65.260 us                 |
| OneStep                   | 420.326 ms                | 862.292 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 739.831 us                | 9.561 ms                  |
| Forward                   | 4.272 ms                  | 5.524 ms                  |
| Backward                  | 414.615 ms                | 860.195 ms                |
| Optimize                  | 1.067 ms                  | 1.654 ms                  |
| BarrierTimeBeforeRank0    | 32.055 us                 | 26.980 ms                 |
| BlockToStepN              | 9.794 us                  | 65.260 us                 |
| OneStep                   | 427.135 ms                | 871.923 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 740.016 us                | 9.555 ms                  |
| Forward                   | 4.273 ms                  | 5.382 ms                  |
| Backward                  | 420.334 ms                | 865.287 ms                |
| Optimize                  | 1.069 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.047 us                 | 25.704 ms                 |
| BlockToStepN              | 9.795 us                  | 57.322 us                 |
| OneStep                   | 428.682 ms                | 888.917 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 740.064 us                | 9.555 ms                  |
| Forward                   | 4.273 ms                  | 5.382 ms                  |
| Backward                  | 426.775 ms                | 879.441 ms                |
| Optimize                  | 1.069 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.022 us                 | 25.704 ms                 |
| BlockToStepN              | 9.847 us                  | 57.322 us                 |
| OneStep                   | 434.397 ms                | 890.739 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 742.728 us                | 9.555 ms                  |
| Forward                   | 4.286 ms                  | 5.382 ms                  |
| Backward                  | 431.883 ms                | 883.618 ms                |
| Optimize                  | 1.071 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.047 us                 | 25.704 ms                 |
| BlockToStepN              | 9.855 us                  | 57.322 us                 |
| OneStep                   | 442.440 ms                | 892.870 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 742.728 us                | 9.555 ms                  |
| Forward                   | 4.290 ms                  | 5.382 ms                  |
| Backward                  | 438.068 ms                | 883.849 ms                |
| Optimize                  | 1.072 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.055 us                 | 25.704 ms                 |
| BlockToStepN              | 9.873 us                  | 57.322 us                 |
| OneStep                   | 447.496 ms                | 898.281 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 742.336 us                | 9.555 ms                  |
| Forward                   | 4.290 ms                  | 5.382 ms                  |
| Backward                  | 442.294 ms                | 906.255 ms                |
| Optimize                  | 1.073 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.047 us                 | 25.704 ms                 |
| BlockToStepN              | 10.018 us                 | 57.322 us                 |
| OneStep                   | 457.222 ms                | 920.321 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 741.182 us                | 9.555 ms                  |
| Forward                   | 4.287 ms                  | 5.382 ms                  |
| Backward                  | 451.732 ms                | 926.190 ms                |
| Optimize                  | 1.073 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.047 us                 | 25.704 ms                 |
| BlockToStepN              | 10.059 us                 | 57.322 us                 |
| OneStep                   | 463.156 ms                | 935.831 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 742.728 us                | 9.555 ms                  |
| Forward                   | 4.290 ms                  | 5.382 ms                  |
| Backward                  | 456.356 ms                | 929.551 ms                |
| Optimize                  | 1.074 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.047 us                 | 25.704 ms                 |
| BlockToStepN              | 10.059 us                 | 65.260 us                 |
| OneStep                   | 467.763 ms                | 940.138 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 742.728 us                | 9.555 ms                  |
| Forward                   | 4.290 ms                  | 5.382 ms                  |
| Backward                  | 460.624 ms                | 951.537 ms                |
| Optimize                  | 1.075 ms                  | 1.640 ms                  |
| BarrierTimeBeforeRank0    | 32.047 us                 | 25.704 ms                 |
| BlockToStepN              | 10.091 us                 | 65.260 us                 |
| OneStep                   | 477.692 ms                | 967.509 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 743.231 us                | 9.555 ms                  |
| Forward                   | 4.294 ms                  | 5.382 ms                  |
| Backward                  | 466.549 ms                | 960.780 ms                |
| Optimize                  | 1.079 ms                  | 1.654 ms                  |
| BarrierTimeBeforeRank0    | 32.055 us                 | 25.704 ms                 |
| BlockToStepN              | 10.103 us                 | 71.200 us                 |
| OneStep                   | 480.295 ms                | 999.137 ms                |
+---------------------------+---------------------------+---------------------------+
[proc 2] 500 steps, total: 85.081, sample: 0.170, forward: 0.361, backward: 73.047, update: 0.108
[proc 3] 500 steps, total: 85.081, sample: 0.151, forward: 0.356, backward: 72.793, update: 0.099
[proc 1] 500 steps, total: 85.081, sample: 0.149, forward: 0.371, backward: 76.558, update: 0.098
[proc 0] 500 steps, total: 85.081, sample: 0.162, forward: 0.440, backward: 84.203, update: 0.117
Successfully xmh. training takes 240.45361495018005 seconds
before call kg_cache_controller.StopThreads()
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker3: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker2: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
[W tensorpipe_agent.cpp:725] RPC agent for worker0 encountered error when reading incoming request from worker1: eof (this error originated at tensorpipe/transport/shm/connection_impl.cc:259)
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
INFO [1198647 controller_process.py:421] call rank0 to StopThreads
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 743.231 us                | 9.555 ms                  |
| Forward                   | 4.294 ms                  | 5.382 ms                  |
| Backward                  | 466.549 ms                | 960.780 ms                |
| Optimize                  | 1.079 ms                  | 1.654 ms                  |
| BarrierTimeBeforeRank0    | 32.047 us                 | 25.704 ms                 |
| BlockToStepN              | 10.103 us                 | 71.200 us                 |
| OneStep                   | 480.295 ms                | 999.137 ms                |
+---------------------------+---------------------------+---------------------------+
