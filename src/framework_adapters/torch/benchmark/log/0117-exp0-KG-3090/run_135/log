WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 17:01:46.445065 51520 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='TransE', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/TransE_Freebase_82', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [51520 sampler.py:454] Start PreSampling
WARNING [51520 sampler.py:532] Before construct renumbering_dict
WARNING [51520 sampler.py:555] PreSampling done
W20240124 17:14:54.329627 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 17:14:54.329828 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 17:14:54.329865 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 17:14:54.329903 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 17:14:54.329929 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 17:14:54.329955 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 17:14:54.329979 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 17:14:54.330009 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 17:14:54.330039 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 17:14:54.330061 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 17:14:54.330090 51520 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 17:14:54.330113 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 17:14:54.330140 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 17:14:54.330283 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 17:14:54.330313 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 17:14:54.330335 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 17:14:54.330372 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 17:14:54.330394 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 17:14:54.330415 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 17:14:54.330440 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 17:14:54.330472 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 17:14:54.330497 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 17:14:54.330526 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 17:14:54.330554 51520 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 17:14:54.330571 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 17:14:54.330590 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 17:14:54.330637 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 17:14:54.330667 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 17:14:54.330693 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 17:14:54.330714 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 17:14:54.330736 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 17:14:54.330756 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 17:14:54.330782 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 17:14:54.330802 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 17:14:54.330825 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 17:14:54.330850 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 17:14:54.330871 51520 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 17:14:54.330888 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 17:14:54.330904 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 17:14:54.330945 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 17:14:54.330972 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 17:14:54.330999 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 17:14:54.331027 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 17:14:54.331058 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 17:14:54.331079 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 17:14:54.331104 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 17:14:54.331126 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 17:14:54.331154 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 17:14:54.331177 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 17:14:54.331202 51520 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 17:14:54.331219 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 17:14:54.331235 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 17:14:54.331280 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 17:14:54.331318 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 17:14:54.331341 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 17:14:54.331362 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 17:14:54.331384 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 17:14:54.331404 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 17:14:54.331434 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 17:14:54.331459 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 17:14:54.331490 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 17:14:54.331519 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 17:14:54.331544 51520 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 17:14:54.331561 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 17:14:54.331581 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 17:14:54.331624 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 17:14:54.331652 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 17:14:54.331674 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 17:14:54.331694 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 17:14:54.331714 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 17:14:54.331737 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 17:14:54.331756 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 17:14:54.331782 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 17:14:54.331802 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 17:14:54.331826 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 17:14:54.331851 51520 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 17:14:54.331866 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 17:14:54.331884 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 17:14:54.331923 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 17:14:54.331954 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 17:14:54.331974 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 17:14:54.331995 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 17:14:54.332015 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 17:14:54.332037 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 17:14:54.332057 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 17:14:54.332082 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 17:14:54.332104 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 17:14:54.332129 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 17:14:54.332149 51520 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 17:14:54.332171 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 17:14:54.332187 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 17:14:54.332227 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 17:14:54.332252 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 17:14:54.332276 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 17:14:54.332296 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 17:14:54.332316 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 17:14:54.332342 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 17:14:54.332365 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 17:14:54.332387 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 17:14:54.332410 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 17:14:54.332435 51520 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 17:14:54.332456 51520 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 17:14:54.332473 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 17:14:54.332489 51520 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 17:14:54.663646 51520 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 17:14:54.663823 51520 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302704,  4302721,  4302737,  ..., 49959336, 20407879, 28260443]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 1005.859 seconds
[Rank1] pid = 12063
[Rank2] pid = 12163
[Rank3] pid = 12247
[Rank4] pid = 12329
[Rank5] pid = 12412
[Rank6] pid = 12560
INFO [51520 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [12063 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [12163 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [12247 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [12412 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [12329 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [12647 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [12560 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [12560 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12647 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12329 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12412 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 17:18:41.208496 12563 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
INFO [12247 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [12163 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [51520 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 17:18:41.210697 12659 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240124 17:18:41.210809 12414 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240124 17:18:41.210901 12330 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240124 17:18:41.210906 12700 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
INFO [12063 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 17:18:41.211109 12248 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240124 17:18:41.211282 12164 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240124 17:18:41.213014 12064 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240124 17:18:41.338146 12563 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x102027251000 781.2 kB
W20240124 17:18:41.338328 12700 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x102027316000 781.2 kB
W20240124 17:18:41.338405 12659 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x1020273db000 781.2 kB
W20240124 17:18:41.338443 12248 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x1020274a0000 781.2 kB
W20240124 17:18:41.338490 12330 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x102027565000 781.2 kB
W20240124 17:18:41.338575 12064 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x10202762a000 781.2 kB
W20240124 17:18:41.338595 12414 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x1020276ef000 781.2 kB
W20240124 17:18:41.338608 12164 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x1020277b4000 781.2 kB
W20240124 17:18:41.338647 12563 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x102027879000 781.2 kB
W20240124 17:18:41.338804 12563 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x10202793e000 152.6 MB
W20240124 17:18:41.338896 12563 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x1020311d6000 152.6 MB
W20240124 17:18:41.339243 12563 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 17:18:41.339533 12659 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x10203aa6e000 781.2 kB
W20240124 17:18:41.339543 12248 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x10203ab33000 781.2 kB
W20240124 17:18:41.339570 12064 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x10203acbd000 781.2 kB
W20240124 17:18:41.339565 12164 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x10203abf8000 781.2 kB
W20240124 17:18:41.339596 12414 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x10203ad82000 781.2 kB
W20240124 17:18:41.339638 12330 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x10203ae47000 781.2 kB
W20240124 17:18:41.339663 12700 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x10203af0c000 781.2 kB
W20240124 17:18:41.339928 12064 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x10203afd1000 152.6 MB
W20240124 17:18:41.339973 12659 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x102044869000 152.6 MB
W20240124 17:18:41.340001 12064 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x10204e101000 152.6 MB
W20240124 17:18:41.340013 12414 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x102057999000 152.6 MB
W20240124 17:18:41.340024 12700 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x102061231000 152.6 MB
W20240124 17:18:41.340060 12659 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x102074361000 152.6 MB
W20240124 17:18:41.340051 12330 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x10206aac9000 152.6 MB
W20240124 17:18:41.340083 12164 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x10207dbf9000 152.6 MB
W20240124 17:18:41.340101 12248 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x102087491000 152.6 MB
W20240124 17:18:41.340149 12414 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x102090d29000 152.6 MB
W20240124 17:18:41.340178 12700 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x10209a5c1000 152.6 MB
W20240124 17:18:41.340202 12164 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1020a3e59000 152.6 MB
W20240124 17:18:41.340219 12330 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x1020ad6f1000 152.6 MB
W20240124 17:18:41.340242 12248 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x1020b6f89000 152.6 MB
W20240124 17:18:41.340337 12414 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 17:18:41.340503 12659 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 17:18:41.340521 12330 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 17:18:41.340588 12064 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 17:18:41.340859 12563 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 17:18:41.341040 12248 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 17:18:41.341058 12164 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 17:18:41.341066 12700 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 17:18:41.346086 12414 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 17:18:41.346640 12659 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 17:18:41.346659 12330 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 17:18:41.346693 12064 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 17:18:41.346773 12248 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 17:18:41.347270 12164 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 17:18:41.347342 12700 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [12329 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [12560 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [12247 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [12647 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 12647
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [51520 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
WARNING [12063 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [12163 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [12412 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 17:19:29.780704 12414 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 17:19:29.780745 12164 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 17:19:29.780784 12659 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 17:19:29.780959 12700 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 17:19:29.781031 12248 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 17:19:29.781131 12330 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 17:19:29.781173 12064 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 17:19:29.781201 12563 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240124 17:19:29.782217 12659 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240124 17:19:29.782316 12659 grad_base.h:172] Init GradProcessingBase done
I20240124 17:19:39.200441 12659 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240124 17:19:39.200831 12659 kg_controller.h:78] after init GradAsyncProcessingV2
I20240124 17:19:39.200841 12659 kg_controller.h:84] Construct KGCacheController done
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
[W socket.cpp:601] [c10d] The client socket has failed to connect to [localhost]:29500 (errno: 101 - Network is unreachable).
I20240124 17:19:40.931326 12659 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240124 17:19:57.022806 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 17:19:57.023152 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 17:19:58.104696 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 17:19:58.104807 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 17:19:59.110553 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 17:19:59.110661 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
I20240124 17:19:59.665611 12700 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
W20240124 17:20:00.773052 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 17:20:00.773173 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
E20240124 17:20:01.778693 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 17:20:01.812304 14696 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
I20240124 17:20:01.814225 12164 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 17:20:02.084424 12064 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 17:20:02.866037 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 17:20:02.875917 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 17:20:02.971199 12414 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 17:20:03.558531 12563 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 17:20:05.651439 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 17:20:05.658011 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 17:20:05.750017 12248 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 17:20:08.000777 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 17:20:08.014329 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 17:20:08.051226 12659 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 17:20:08.794214 12330 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 17:20:09.009673 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 17:20:09.014004 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.323 ms                  | 8.323 ms                  |
| Forward                   | 955.144 ms                | 955.144 ms                |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 321.836 ms                | 322.332 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:11.138226 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 17:20:11.220521 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240124 17:20:11.278332 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 17:20:12.138041 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=30883
W20240124 17:20:12.277345 12659 grad_async_v2.h:236] pq is empty
W20240124 17:20:12.392863 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=9, pq.top=9
W20240124 17:20:12.402731 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
E20240124 17:20:13.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=741
W20240124 17:20:13.516384 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
W20240124 17:20:14.005358 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=17, pq.top=17
E20240124 17:20:14.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=454
W20240124 17:20:14.551040 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 12.529 ms                 | 98.816 ms                 |
| Forward                   | 4.927 ms                  | 955.144 ms                |
| Backward                  | 5.050 ms                  | 204.922 ms                |
| Optimize                  | 1.863 ms                  | 3.437 ms                  |
| BarrierTimeBeforeRank0    | 34.875 us                 | 44.796 ms                 |
| AfterBackward             | 62.857 ms                 | 1.208 s                   |
| BlockToStepN              | 5.120 ms                  | 94.212 ms                 |
| OneStep                   | 135.271 ms                | 2.481 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 17:20:15.084403 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=25, pq.top=25
E20240124 17:20:15.138006 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=35190
W20240124 17:20:15.581135 14696 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.353 ms                  | 321.836 ms                |
| ProcessBack:UpdateCache   | 9.219 ms                  | 792.680 ms                |
| ProcessBack:UpsertPq      | 21.796 ms                 | 79.698 ms                 |
| ProcessOneStep            | 62.815 ms                 | 1.208 s                   |
| BlockToStepN              | 13.982 ms                 | 94.086 ms                 |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:16.138736 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 17:20:16.609933 14696 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
W20240124 17:20:16.922119 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=34, pq.top=34
E20240124 17:20:17.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=7959
W20240124 17:20:17.691744 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
W20240124 17:20:17.922058 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=42, pq.top=42
E20240124 17:20:18.138008 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=1330
W20240124 17:20:18.752485 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
W20240124 17:20:18.922019 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=49, pq.top=49
E20240124 17:20:19.138016 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=9965
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.323 ms                  | 90.353 ms                 |
| Forward                   | 4.838 ms                  | 9.220 ms                  |
| Backward                  | 5.220 ms                  | 7.827 ms                  |
| Optimize                  | 1.919 ms                  | 3.549 ms                  |
| BarrierTimeBeforeRank0    | 31.426 us                 | 24.073 ms                 |
| AfterBackward             | 60.774 ms                 | 866.198 ms                |
| BlockToStepN              | 38.329 ms                 | 148.877 ms                |
| OneStep                   | 135.685 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:20:19.798740 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end4
E20240124 17:20:20.138011 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=100
W20240124 17:20:20.392249 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=54, pq.top=54
W20240124 17:20:20.843633 14696 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.159 ms                  | 321.836 ms                |
| ProcessBack:UpdateCache   | 8.961 ms                  | 792.680 ms                |
| ProcessBack:UpsertPq      | 20.669 ms                 | 79.698 ms                 |
| ProcessOneStep            | 58.918 ms                 | 866.148 ms                |
| BlockToStepN              | 34.581 ms                 | 148.737 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:21.138015 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=9761
W20240124 17:20:21.438423 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=63, pq.top=63
W20240124 17:20:21.913347 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end7
E20240124 17:20:22.138011 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=409
W20240124 17:20:22.983211 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
E20240124 17:20:23.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=335
W20240124 17:20:23.286263 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240124 17:20:24.021335 14696 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
E20240124 17:20:24.138011 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=8074
W20240124 17:20:24.286077 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=78, pq.top=78
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.494 ms                  | 90.353 ms                 |
| Forward                   | 4.819 ms                  | 29.666 ms                 |
| Backward                  | 5.220 ms                  | 7.827 ms                  |
| Optimize                  | 1.949 ms                  | 3.549 ms                  |
| BarrierTimeBeforeRank0    | 43.398 us                 | 48.514 ms                 |
| AfterBackward             | 58.969 ms                 | 866.198 ms                |
| BlockToStepN              | 42.098 ms                 | 148.877 ms                |
| OneStep                   | 135.271 ms                | 994.719 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:20:25.034305 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240124 17:20:25.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=49302
W20240124 17:20:25.426345 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=85, pq.top=85
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.324 ms                  | 21.574 ms                 |
| ProcessBack:UpdateCache   | 8.994 ms                  | 12.099 ms                 |
| ProcessBack:UpsertPq      | 22.191 ms                 | 81.288 ms                 |
| ProcessOneStep            | 59.051 ms                 | 866.148 ms                |
| BlockToStepN              | 43.455 ms                 | 148.737 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:20:26.060547 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240124 17:20:26.138011 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=942
W20240124 17:20:26.426070 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=89, pq.top=89
W20240124 17:20:27.130239 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end3
E20240124 17:20:27.138006 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=43919
W20240124 17:20:27.426168 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=95, pq.top=95
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 19.342, sample: 1.066, forward: 1.417, backward: 0.725, update: 0.217
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 24.577, sample: 1.212, forward: 1.193, backward: 0.737, update: 0.209
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 26.051, sample: 1.010, forward: 1.355, backward: 0.787, update: 0.199
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 26.322, sample: 0.890, forward: 1.370, backward: 0.727, update: 0.239
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 22.386, sample: 1.004, forward: 1.511, backward: 0.670, update: 0.207
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 25.164, sample: 0.909, forward: 1.170, backward: 0.825, update: 0.207
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 28.470, sample: 1.008, forward: 1.181, backward: 0.686, update: 0.194
E20240124 17:20:28.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=11377
train_sampler.Prefill()
-------Step 0-------
tensor([  518727,    72879,   371506, 14318201,    72918,    72947,   518746,
           72978,    73013,    73055]) tensor([ 5284233, 11920768, 49245236, 48604858, 20289099,   316223, 17964608,
        51162257, 46229570, 52118625])
-------Step 1-------
tensor([  518727,    72879,   371506, 14318201,    72918,    72947,   518746,
           72978,    73013,    73055]) tensor([79538146, 26721860, 49878312, 52645994, 54043602, 13340047, 47280059,
          591016, 22140721, 48967089])
-------Step 2-------
tensor([   17552,   335850,   469989, 16413929,   148290,   148327,   148365,
          148401,   148438,   148473]) tensor([45257619, 34024062,  1352922, 30025392, 23580065, 24911503,  8391455,
        56275140, 64004119, 31832030])
-------Step 3-------
tensor([   17552,   335850,   469989, 16413929,   148290,   148327,   148365,
          148401,   148438,   148473]) tensor([19581281, 73692744, 82888170, 48704210, 84210142, 76571720, 70180713,
        23587477, 76329901, 11819287])
-------Step 4-------
tensor([  225654,   225685,   225721, 83483196,   225756,   225805,   225845,
          225880,   225911, 23004164]) tensor([69482738, 54988257, 74298218, 35934237,   238199,  4331326, 22932263,
        54341268, 67828792, 11776791])
-------Step 5-------
tensor([  225654,   225685,   225721, 83483196,   225756,   225805,   225845,
          225880,   225911, 23004164]) tensor([41237899, 38221604, 44788487,    29613, 58392266, 58584371, 50882112,
         1353906, 75859029, 29404008])
-------Step 6-------
tensor([ 7279181,  5733391,   302512, 34054304,   302549,   302587, 75001324,
        36879575,   302627,   302670]) tensor([43287358,   282757, 52861885, 16103363, 21561076, 35477789, 16956186,
        66808169, 72929622, 49884059])
-------Step 7-------
tensor([ 7279181,  5733391,   302512, 34054304,   302549,   302587, 75001324,
        36879575,   302627,   302670]) tensor([22822316, 10718895, 31367586,  9952811, 44365657, 56952690,  4320003,
        15249677, 36062992, 66269447])
-------Step 8-------
tensor([  380719,   380750, 78188140,   380785,   374176,   374212, 14085694,
          380818,   380864,   476205]) tensor([24405541, 32731116, 61204994,  5266222, 73863645,  7169224,  5248451,
        15056395, 66718513,  6257410])
-------Step 9-------
tensor([  380719,   380750, 78188140,   380785,   374176,   374212, 14085694,
          380818,   380864,   476205]) tensor([63961255, 23283460, 46178442, 76698701, 49604354, 62351617, 73044390,
        14899465, 16715863,  7248410])
before start barrier
start train
[proc 0] 100 steps, total: 20.084, sample: 1.604, forward: 1.454, backward: 0.754, update: 0.213
W20240124 17:20:28.254644 14696 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240124 17:20:28.602357 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=103, pq.top=103
E20240124 17:20:29.138037 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=58768
W20240124 17:20:29.398327 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end8
W20240124 17:20:29.602563 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=109
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.550 ms                  | 98.816 ms                 |
| Forward                   | 4.875 ms                  | 29.666 ms                 |
| Backward                  | 5.274 ms                  | 7.827 ms                  |
| Optimize                  | 1.951 ms                  | 4.690 ms                  |
| BarrierTimeBeforeRank0    | 41.133 us                 | 51.547 ms                 |
| AfterBackward             | 61.088 ms                 | 866.198 ms                |
| BlockToStepN              | 43.564 ms                 | 168.135 ms                |
| OneStep                   | 138.712 ms                | 994.719 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:30.138012 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=42761
W20240124 17:20:30.482925 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
W20240124 17:20:30.614800 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=114, pq.top=114
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.425 ms                  | 21.574 ms                 |
| ProcessBack:UpdateCache   | 9.068 ms                  | 17.363 ms                 |
| ProcessBack:UpsertPq      | 22.895 ms                 | 97.917 ms                 |
| ProcessOneStep            | 61.044 ms                 | 866.148 ms                |
| BlockToStepN              | 43.850 ms                 | 199.344 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:31.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=56
W20240124 17:20:31.496012 14696 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end9
W20240124 17:20:31.614104 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=119, pq.top=119
E20240124 17:20:32.138012 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=21674
W20240124 17:20:32.534979 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240124 17:20:32.614128 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=125, pq.top=125
E20240124 17:20:33.138327 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=5450
W20240124 17:20:33.551484 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 17:20:33.614104 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=131, pq.top=131
E20240124 17:20:34.138099 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=3165
W20240124 17:20:34.555644 14696 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 17:20:34.639879 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=137, pq.top=137
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.938 ms                  | 98.816 ms                 |
| Forward                   | 4.927 ms                  | 29.666 ms                 |
| Backward                  | 5.193 ms                  | 7.827 ms                  |
| Optimize                  | 1.995 ms                  | 4.690 ms                  |
| BarrierTimeBeforeRank0    | 49.540 us                 | 51.547 ms                 |
| AfterBackward             | 61.088 ms                 | 866.198 ms                |
| BlockToStepN              | 48.806 ms                 | 199.480 ms                |
| OneStep                   | 146.228 ms                | 994.719 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:35.138011 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=4932
W20240124 17:20:35.573947 14696 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 17:20:35.648979 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=143, pq.top=143
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 7.965 ms                  | 17.833 ms                 |
| ProcessBack:UpdateCache   | 9.300 ms                  | 16.871 ms                 |
| ProcessBack:UpsertPq      | 22.499 ms                 | 90.276 ms                 |
| ProcessOneStep            | 60.737 ms                 | 866.148 ms                |
| BlockToStepN              | 49.679 ms                 | 199.344 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:36.138016 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=177
W20240124 17:20:36.598186 14696 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240124 17:20:36.659824 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=149, pq.top=149
E20240124 17:20:37.138008 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=13446
W20240124 17:20:37.618314 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240124 17:20:37.667146 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=154, pq.top=154
E20240124 17:20:38.138010 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=547
W20240124 17:20:38.625159 14696 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240124 17:20:38.697396 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=160, pq.top=160
E20240124 17:20:39.138013 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=6605
W20240124 17:20:39.650411 14696 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 17:20:39.697178 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=165
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.550 ms                  | 90.353 ms                 |
| Forward                   | 4.901 ms                  | 23.556 ms                 |
| Backward                  | 5.205 ms                  | 7.825 ms                  |
| Optimize                  | 2.021 ms                  | 4.690 ms                  |
| BarrierTimeBeforeRank0    | 49.540 us                 | 48.514 ms                 |
| AfterBackward             | 61.505 ms                 | 850.837 ms                |
| BlockToStepN              | 51.873 ms                 | 195.949 ms                |
| OneStep                   | 149.540 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:40.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=47455
W20240124 17:20:40.659634 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240124 17:20:40.697357 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=170, pq.top=170
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.371 ms                  | 17.833 ms                 |
| ProcessBack:UpdateCache   | 9.436 ms                  | 16.871 ms                 |
| ProcessBack:UpsertPq      | 22.739 ms                 | 90.276 ms                 |
| ProcessOneStep            | 61.478 ms                 | 850.790 ms                |
| BlockToStepN              | 51.757 ms                 | 199.344 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:41.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=5332
W20240124 17:20:41.672488 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240124 17:20:41.697579 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=175, pq.top=175
E20240124 17:20:42.138010 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=33861
W20240124 17:20:42.682387 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240124 17:20:42.697329 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=180, pq.top=180
E20240124 17:20:43.138017 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=70924
W20240124 17:20:43.706895 14696 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 17:20:43.747052 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=183
E20240124 17:20:44.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=25929
W20240124 17:20:44.723059 14696 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 17:20:44.747131 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=188, pq.top=188
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.919 ms                  | 90.353 ms                 |
| Forward                   | 4.901 ms                  | 23.556 ms                 |
| Backward                  | 5.195 ms                  | 7.825 ms                  |
| Optimize                  | 2.023 ms                  | 4.690 ms                  |
| BarrierTimeBeforeRank0    | 41.857 us                 | 48.514 ms                 |
| AfterBackward             | 62.857 ms                 | 850.837 ms                |
| BlockToStepN              | 55.800 ms                 | 222.030 ms                |
| OneStep                   | 155.762 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:45.138011 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=4938
W20240124 17:20:45.751001 14696 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
W20240124 17:20:45.757151 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=194, pq.top=194
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.339 ms                  | 17.833 ms                 |
| ProcessBack:UpdateCache   | 9.506 ms                  | 14.382 ms                 |
| ProcessBack:UpsertPq      | 24.074 ms                 | 108.061 ms                |
| ProcessOneStep            | 63.181 ms                 | 850.790 ms                |
| BlockToStepN              | 56.262 ms                 | 221.822 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:46.138013 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=66272
W20240124 17:20:46.765166 14696 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240124 17:20:46.843458 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=199, pq.top=199
[proc 2] 200 steps, total: 18.908, sample: 1.010, forward: 0.506, backward: 0.525, update: 0.239
[proc 1] 200 steps, total: 18.908, sample: 1.026, forward: 0.498, backward: 0.518, update: 0.221
[proc 5] 200 steps, total: 18.908, sample: 0.890, forward: 0.505, backward: 0.525, update: 0.204
[proc 0] 200 steps, total: 18.904, sample: 1.787, forward: 0.532, backward: 0.522, update: 0.224
[proc 6] 200 steps, total: 18.908, sample: 1.009, forward: 0.532, backward: 0.508, update: 0.202
[proc 7] 200 steps, total: 18.908, sample: 0.893, forward: 0.513, backward: 0.505, update: 0.207
[proc 4] 200 steps, total: 18.908, sample: 1.212, forward: 0.527, backward: 0.516, update: 0.202
[proc 3] 200 steps, total: 18.909, sample: 1.169, forward: 0.535, backward: 0.515, update: 0.236
E20240124 17:20:47.138010 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=4236
W20240124 17:20:47.797679 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240124 17:20:47.843037 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=205, pq.top=205
E20240124 17:20:48.138010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=22243
W20240124 17:20:48.800745 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240124 17:20:48.876874 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=210, pq.top=210
E20240124 17:20:49.139432 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=60106
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.974 ms                  | 98.816 ms                 |
| Forward                   | 4.957 ms                  | 23.556 ms                 |
| Backward                  | 5.193 ms                  | 7.827 ms                  |
| Optimize                  | 2.044 ms                  | 4.868 ms                  |
| BarrierTimeBeforeRank0    | 41.857 us                 | 48.514 ms                 |
| AfterBackward             | 63.247 ms                 | 850.837 ms                |
| BlockToStepN              | 59.577 ms                 | 222.030 ms                |
| OneStep                   | 159.599 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:20:49.808444 14696 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
W20240124 17:20:49.876292 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=215, pq.top=215
E20240124 17:20:50.139009 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=22363
W20240124 17:20:50.841658 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
W20240124 17:20:50.876152 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=221, pq.top=221
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.420 ms                  | 17.833 ms                 |
| ProcessBack:UpdateCache   | 9.587 ms                  | 14.382 ms                 |
| ProcessBack:UpsertPq      | 24.074 ms                 | 108.061 ms                |
| ProcessOneStep            | 63.385 ms                 | 850.790 ms                |
| BlockToStepN              | 59.455 ms                 | 221.822 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:20:51.139011 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=3752
W20240124 17:20:51.851577 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240124 17:20:51.911312 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
E20240124 17:20:52.139009 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=5
W20240124 17:20:52.869691 14696 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 17:20:52.955322 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=233, pq.top=233
E20240124 17:20:53.139010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=2137
W20240124 17:20:53.881354 14696 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240124 17:20:53.955629 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=239, pq.top=239
E20240124 17:20:54.139014 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=10063
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.749 ms                  | 98.816 ms                 |
| Forward                   | 4.952 ms                  | 23.556 ms                 |
| Backward                  | 5.179 ms                  | 7.827 ms                  |
| Optimize                  | 2.051 ms                  | 4.868 ms                  |
| BarrierTimeBeforeRank0    | 49.540 us                 | 55.153 ms                 |
| AfterBackward             | 63.247 ms                 | 850.837 ms                |
| BlockToStepN              | 62.674 ms                 | 222.030 ms                |
| OneStep                   | 162.373 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:20:54.917804 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end5
W20240124 17:20:54.955183 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=245, pq.top=245
E20240124 17:20:55.156960 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=186517
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.394 ms                  | 16.000 ms                 |
| ProcessBack:UpdateCache   | 9.586 ms                  | 14.263 ms                 |
| ProcessBack:UpsertPq      | 23.550 ms                 | 105.688 ms                |
| ProcessOneStep            | 63.385 ms                 | 850.790 ms                |
| BlockToStepN              | 62.990 ms                 | 234.376 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:20:55.936432 14696 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 17:20:56.078661 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=247
E20240124 17:20:56.156011 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=6250
W20240124 17:20:56.936635 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240124 17:20:57.078653 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=253, pq.top=253
E20240124 17:20:57.156011 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=43816
W20240124 17:20:57.941074 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240124 17:20:58.078692 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=257, pq.top=257
E20240124 17:20:58.156008 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=41819
W20240124 17:20:58.961939 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 17:20:59.110333 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=262, pq.top=262
E20240124 17:20:59.160745 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.598 ms                  | 98.816 ms                 |
| Forward                   | 5.012 ms                  | 19.744 ms                 |
| Backward                  | 5.177 ms                  | 7.827 ms                  |
| Optimize                  | 2.084 ms                  | 4.755 ms                  |
| BarrierTimeBeforeRank0    | 53.603 us                 | 51.547 ms                 |
| AfterBackward             | 64.441 ms                 | 828.995 ms                |
| BlockToStepN              | 62.674 ms                 | 240.936 ms                |
| OneStep                   | 163.271 ms                | 894.315 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:20:59.980816 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
E20240124 17:21:00.160048 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=2856
W20240124 17:21:00.207123 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=269, pq.top=269
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.360 ms                  | 17.695 ms                 |
| ProcessBack:UpdateCache   | 9.529 ms                  | 14.263 ms                 |
| ProcessBack:UpsertPq      | 23.664 ms                 | 105.688 ms                |
| ProcessOneStep            | 64.394 ms                 | 828.936 ms                |
| BlockToStepN              | 62.526 ms                 | 240.760 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:01.160017 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=38860
W20240124 17:21:01.207017 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=275, pq.top=275
W20240124 17:21:01.250919 14696 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
E20240124 17:21:02.160411 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 17:21:02.336392 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
W20240124 17:21:02.648425 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=277
E20240124 17:21:03.160020 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=59233
W20240124 17:21:03.404788 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 17:21:03.648666 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=283, pq.top=283
E20240124 17:21:04.160022 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=10581
W20240124 17:21:04.572186 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
W20240124 17:21:04.727018 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=288, pq.top=287
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.550 ms                  | 98.816 ms                 |
| Forward                   | 4.983 ms                  | 19.744 ms                 |
| Backward                  | 5.186 ms                  | 8.225 ms                  |
| Optimize                  | 2.074 ms                  | 4.789 ms                  |
| BarrierTimeBeforeRank0    | 53.007 us                 | 51.547 ms                 |
| AfterBackward             | 64.484 ms                 | 850.837 ms                |
| BlockToStepN              | 60.070 ms                 | 242.066 ms                |
| OneStep                   | 163.271 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:05.160020 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=148597
W20240124 17:21:05.678879 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end3
W20240124 17:21:05.727594 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=293, pq.top=293
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.334 ms                  | 19.056 ms                 |
| ProcessBack:UpdateCache   | 9.499 ms                  | 13.994 ms                 |
| ProcessBack:UpsertPq      | 23.842 ms                 | 102.721 ms                |
| ProcessOneStep            | 64.464 ms                 | 850.790 ms                |
| BlockToStepN              | 60.383 ms                 | 277.337 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:06.160009 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=4470
W20240124 17:21:06.727504 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=298, pq.top=298
W20240124 17:21:06.907372 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end9
[proc 2] 300 steps, total: 20.106, sample: 0.900, forward: 0.512, backward: 0.592, update: 0.207
[proc 0] 300 steps, total: 20.106, sample: 1.619, forward: 0.544, backward: 0.569, update: 0.225
[proc 7] 300 steps, total: 20.106, sample: 0.841, forward: 0.522, backward: 0.533, update: 0.218
[proc 6] 300 steps, total: 20.106, sample: 0.930, forward: 0.505, backward: 0.510, update: 0.209
[proc 5] 300 steps, total: 20.106, sample: 0.888, forward: 0.610, backward: 0.541, update: 0.213
[proc 1] 300 steps, total: 20.106, sample: 0.926, forward: 0.488, backward: 0.547, update: 0.221
[proc 4] 300 steps, total: 20.106, sample: 1.570, forward: 0.520, backward: 0.577, update: 0.217
[proc 3] 300 steps, total: 20.106, sample: 1.396, forward: 0.564, backward: 0.501, update: 0.228
E20240124 17:21:07.160015 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=45531
W20240124 17:21:08.066990 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end2
E20240124 17:21:08.160013 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=399
W20240124 17:21:08.550207 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240124 17:21:09.096498 14696 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
E20240124 17:21:09.160416 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=18381
W20240124 17:21:09.550673 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=309, pq.top=309
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.623 ms                  | 98.816 ms                 |
| Forward                   | 4.957 ms                  | 19.744 ms                 |
| Backward                  | 5.177 ms                  | 8.225 ms                  |
| Optimize                  | 2.059 ms                  | 4.789 ms                  |
| BarrierTimeBeforeRank0    | 52.829 us                 | 51.547 ms                 |
| AfterBackward             | 64.465 ms                 | 866.198 ms                |
| BlockToStepN              | 63.095 ms                 | 277.531 ms                |
| OneStep                   | 165.523 ms                | 994.719 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:21:10.099581 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 17:21:10.163576 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=4481
W20240124 17:21:10.550096 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=315, pq.top=315
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.349 ms                  | 19.056 ms                 |
| ProcessBack:UpdateCache   | 9.499 ms                  | 13.994 ms                 |
| ProcessBack:UpsertPq      | 23.664 ms                 | 102.721 ms                |
| ProcessOneStep            | 64.422 ms                 | 866.148 ms                |
| BlockToStepN              | 61.869 ms                 | 277.337 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:11.163009 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=91
W20240124 17:21:11.183625 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end9
W20240124 17:21:11.608688 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=321, pq.top=321
E20240124 17:21:12.163012 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=31836
W20240124 17:21:12.199065 14696 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 17:21:12.633049 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=326, pq.top=326
E20240124 17:21:13.175443 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=66903
W20240124 17:21:13.206844 14696 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
W20240124 17:21:13.637306 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=330, pq.top=330
E20240124 17:21:14.175012 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=44120
W20240124 17:21:14.239617 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end4
W20240124 17:21:14.661682 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=336, pq.top=336
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.623 ms                  | 98.816 ms                 |
| Forward                   | 4.952 ms                  | 19.744 ms                 |
| Backward                  | 5.179 ms                  | 8.225 ms                  |
| Optimize                  | 2.067 ms                  | 4.789 ms                  |
| BarrierTimeBeforeRank0    | 52.829 us                 | 51.547 ms                 |
| AfterBackward             | 64.465 ms                 | 866.198 ms                |
| BlockToStepN              | 62.018 ms                 | 291.478 ms                |
| OneStep                   | 165.523 ms                | 994.719 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:15.175014 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=94402
W20240124 17:21:15.275107 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end1
W20240124 17:21:15.673240 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=343, pq.top=343
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.316 ms                  | 18.642 ms                 |
| ProcessBack:UpdateCache   | 9.329 ms                  | 13.984 ms                 |
| ProcessBack:UpsertPq      | 23.439 ms                 | 102.721 ms                |
| ProcessOneStep            | 64.422 ms                 | 866.148 ms                |
| BlockToStepN              | 61.869 ms                 | 291.324 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:16.175204 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=87764
W20240124 17:21:16.354183 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240124 17:21:16.673152 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=347, pq.top=347
E20240124 17:21:17.175029 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=628
W20240124 17:21:17.427788 14696 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
W20240124 17:21:17.707003 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=351, pq.top=351
E20240124 17:21:18.182621 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 17:21:18.440011 14696 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end4
W20240124 17:21:18.821328 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=357
E20240124 17:21:19.182014 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=67201
W20240124 17:21:19.460525 14696 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.519 ms                  | 96.295 ms                 |
| Forward                   | 4.942 ms                  | 12.834 ms                 |
| Backward                  | 5.177 ms                  | 8.225 ms                  |
| Optimize                  | 2.074 ms                  | 4.755 ms                  |
| BarrierTimeBeforeRank0    | 52.303 us                 | 51.259 ms                 |
| AfterBackward             | 64.465 ms                 | 850.837 ms                |
| BlockToStepN              | 63.095 ms                 | 321.592 ms                |
| OneStep                   | 167.122 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:21:19.821938 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=361, pq.top=361
E20240124 17:21:20.182013 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=8514
W20240124 17:21:20.527662 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240124 17:21:20.914328 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=367, pq.top=367
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.270 ms                  | 18.642 ms                 |
| ProcessBack:UpdateCache   | 9.318 ms                  | 13.984 ms                 |
| ProcessBack:UpsertPq      | 23.664 ms                 | 109.067 ms                |
| ProcessOneStep            | 64.801 ms                 | 850.790 ms                |
| BlockToStepN              | 62.990 ms                 | 321.435 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:21.182011 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=120032
W20240124 17:21:21.625241 14696 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end3
W20240124 17:21:21.975191 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=375, pq.top=375
E20240124 17:21:22.182088 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=25775
W20240124 17:21:22.690855 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end5
W20240124 17:21:23.091537 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=376, pq.top=375
E20240124 17:21:23.211359 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=12393
W20240124 17:21:23.698825 14696 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end9
W20240124 17:21:24.124215 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=382, pq.top=382
E20240124 17:21:24.211023 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=137628
W20240124 17:21:24.704334 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.519 ms                  | 96.295 ms                 |
| Forward                   | 4.946 ms                  | 12.834 ms                 |
| Backward                  | 5.179 ms                  | 8.225 ms                  |
| Optimize                  | 2.066 ms                  | 4.789 ms                  |
| BarrierTimeBeforeRank0    | 47.003 us                 | 51.259 ms                 |
| AfterBackward             | 64.853 ms                 | 850.837 ms                |
| BlockToStepN              | 63.316 ms                 | 452.808 ms                |
| OneStep                   | 166.608 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:21:25.124847 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=387, pq.top=387
E20240124 17:21:25.211006 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=78181
W20240124 17:21:25.742128 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.201 ms                  | 17.833 ms                 |
| ProcessBack:UpdateCache   | 9.266 ms                  | 13.935 ms                 |
| ProcessBack:UpsertPq      | 23.623 ms                 | 109.067 ms                |
| ProcessOneStep            | 64.864 ms                 | 850.790 ms                |
| BlockToStepN              | 63.181 ms                 | 452.349 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:21:26.146615 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=392, pq.top=392
E20240124 17:21:26.211011 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=1292
W20240124 17:21:26.781926 14696 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
[proc 6] 400 steps, total: 19.980, sample: 0.921, forward: 0.509, backward: 0.524, update: 0.213
[proc 0] 400 steps, total: 19.980, sample: 1.622, forward: 0.481, backward: 0.547, update: 0.217
[proc 7] 400 steps, total: 19.980, sample: 0.878, forward: 0.526, backward: 0.520, update: 0.213
[proc 1] 400 steps, total: 19.980, sample: 0.975, forward: 0.492, backward: 0.531, update: 0.223
[proc 4] 400 steps, total: 19.980, sample: 1.196, forward: 0.512, backward: 0.534, update: 0.220
[proc 2] 400 steps, total: 19.980, sample: 0.872, forward: 0.509, backward: 0.562, update: 0.211
[proc 3] 400 steps, total: 19.980, sample: 1.000, forward: 0.495, backward: 0.553, update: 0.234
[proc 5] 400 steps, total: 19.980, sample: 0.927, forward: 0.507, backward: 0.500, update: 0.210
E20240124 17:21:27.211012 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=14003
W20240124 17:21:27.237141 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=401, pq.top=401
W20240124 17:21:27.781234 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 17:21:28.212309 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=67886
W20240124 17:21:28.292587 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=405, pq.top=405
W20240124 17:21:28.803825 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
E20240124 17:21:29.212008 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=60779
W20240124 17:21:29.396843 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=411, pq.top=411
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.516 ms                  | 96.295 ms                 |
| Forward                   | 4.944 ms                  | 12.834 ms                 |
| Backward                  | 5.193 ms                  | 8.225 ms                  |
| Optimize                  | 2.066 ms                  | 4.789 ms                  |
| BarrierTimeBeforeRank0    | 41.857 us                 | 51.259 ms                 |
| AfterBackward             | 65.021 ms                 | 850.837 ms                |
| BlockToStepN              | 63.095 ms                 | 452.808 ms                |
| OneStep                   | 167.774 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:21:29.841804 14696 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240124 17:21:30.212009 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=42427
W20240124 17:21:30.458485 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=417, pq.top=417
W20240124 17:21:30.874310 14696 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end0
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.191 ms                  | 17.833 ms                 |
| ProcessBack:UpdateCache   | 9.194 ms                  | 13.935 ms                 |
| ProcessBack:UpsertPq      | 23.619 ms                 | 109.798 ms                |
| ProcessOneStep            | 64.963 ms                 | 850.790 ms                |
| BlockToStepN              | 62.990 ms                 | 452.349 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:31.217021 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=19012
W20240124 17:21:31.458418 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=421, pq.top=421
W20240124 17:21:31.901016 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
E20240124 17:21:32.217008 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=36108
W20240124 17:21:32.458928 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=427, pq.top=427
W20240124 17:21:32.944729 14696 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
E20240124 17:21:33.217010 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=386
W20240124 17:21:33.536149 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240124 17:21:33.949575 14696 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end8
E20240124 17:21:34.217007 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=23899
W20240124 17:21:34.536952 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=439, pq.top=439
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.449 ms                  | 96.295 ms                 |
| Forward                   | 4.929 ms                  | 12.834 ms                 |
| Backward                  | 5.193 ms                  | 8.257 ms                  |
| Optimize                  | 2.068 ms                  | 4.789 ms                  |
| BarrierTimeBeforeRank0    | 43.398 us                 | 51.259 ms                 |
| AfterBackward             | 65.065 ms                 | 850.837 ms                |
| BlockToStepN              | 63.095 ms                 | 452.808 ms                |
| OneStep                   | 168.465 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:35.217104 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=73179
W20240124 17:21:35.275043 14696 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
W20240124 17:21:35.662658 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=440, pq.top=440
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.172 ms                  | 17.695 ms                 |
| ProcessBack:UpdateCache   | 9.118 ms                  | 13.929 ms                 |
| ProcessBack:UpsertPq      | 23.623 ms                 | 109.798 ms                |
| ProcessOneStep            | 65.022 ms                 | 850.790 ms                |
| BlockToStepN              | 63.181 ms                 | 456.171 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 17:21:36.217010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=48563
W20240124 17:21:36.287317 14696 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240124 17:21:36.665048 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=446, pq.top=446
E20240124 17:21:37.217011 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=238004
W20240124 17:21:37.289285 14696 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240124 17:21:37.665494 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=451, pq.top=451
E20240124 17:21:38.217622 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=77827
W20240124 17:21:38.302994 14696 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 17:21:38.766047 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=455
E20240124 17:21:39.217022 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=13489
W20240124 17:21:39.321295 14696 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.440 ms                  | 93.338 ms                 |
| Forward                   | 4.929 ms                  | 9.220 ms                  |
| Backward                  | 5.195 ms                  | 8.225 ms                  |
| Optimize                  | 2.074 ms                  | 4.755 ms                  |
| BarrierTimeBeforeRank0    | 44.308 us                 | 48.514 ms                 |
| AfterBackward             | 65.200 ms                 | 828.995 ms                |
| BlockToStepN              | 62.831 ms                 | 456.365 ms                |
| OneStep                   | 172.851 ms                | 948.289 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:21:39.889505 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=461
E20240124 17:21:40.217010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=197532
W20240124 17:21:40.345563 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.202 ms                  | 18.642 ms                 |
| ProcessBack:UpdateCache   | 9.067 ms                  | 13.935 ms                 |
| ProcessBack:UpsertPq      | 23.962 ms                 | 119.968 ms                |
| ProcessOneStep            | 65.691 ms                 | 828.936 ms                |
| BlockToStepN              | 62.638 ms                 | 456.171 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:21:41.101438 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=469, pq.top=469
E20240124 17:21:41.217017 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=517
W20240124 17:21:41.431942 14696 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240124 17:21:42.101624 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=471, pq.top=471
E20240124 17:21:42.217039 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=84188
W20240124 17:21:42.620935 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 17:21:43.128724 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=473, pq.top=473
E20240124 17:21:43.217008 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=160403
W20240124 17:21:43.653653 14696 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
W20240124 17:21:44.128751 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=480, pq.top=480
E20240124 17:21:44.217013 12659 parallel_pq_v2.h:76] insert failed, size(hashtable)=2910
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.383 ms                  | 96.295 ms                 |
| Forward                   | 4.944 ms                  | 10.078 ms                 |
| Backward                  | 5.195 ms                  | 8.225 ms                  |
| Optimize                  | 2.085 ms                  | 4.755 ms                  |
| BarrierTimeBeforeRank0    | 43.398 us                 | 48.514 ms                 |
| AfterBackward             | 65.816 ms                 | 828.995 ms                |
| BlockToStepN              | 62.365 ms                 | 499.833 ms                |
| OneStep                   | 172.861 ms                | 994.719 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:21:45.129411 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240124 17:21:45.168732 14696 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 17:21:45.217010 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=82960
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.212 ms                  | 17.833 ms                 |
| ProcessBack:UpdateCache   | 9.047 ms                  | 13.935 ms                 |
| ProcessBack:UpsertPq      | 23.921 ms                 | 128.304 ms                |
| ProcessOneStep            | 65.804 ms                 | 828.936 ms                |
| BlockToStepN              | 62.526 ms                 | 537.349 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 17:21:46.129446 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240124 17:21:46.194517 14696 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 17:21:46.217006 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=21235
W20240124 17:21:47.129637 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=491, pq.top=491
W20240124 17:21:47.202334 14696 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 17:21:47.217010 14696 parallel_pq_v2.h:76] insert failed, size(hashtable)=28356
W20240124 17:21:48.142755 12659 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=497, pq.top=497
W20240124 17:21:48.211670 14696 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
E20240124 17:21:48.217005 14695 parallel_pq_v2.h:76] insert failed, size(hashtable)=228983
[proc 2] 500 steps, total: 21.497, sample: 0.853, forward: 0.497, backward: 0.601, update: 0.212
[proc 1] 500 steps, total: 21.497, sample: 0.879, forward: 0.483, backward: 0.589, update: 0.213
[proc 0] 500 steps, total: 21.497, sample: 1.688, forward: 0.521, backward: 0.563, update: 0.221
[proc 6] 500 steps, total: 21.497, sample: 0.915, forward: 0.557, backward: 0.524, update: 0.209
[proc 5] 500 steps, total: 21.497, sample: 0.887, forward: 0.536, backward: 0.550, update: 0.214
[proc 4] 500 steps, total: 21.497, sample: 1.124, forward: 0.478, backward: 0.529, update: 0.204
[proc 3] 500 steps, total: 21.497, sample: 0.993, forward: 0.521, backward: 0.487, update: 0.226
[proc 7] 500 steps, total: 21.497, sample: 0.810, forward: 0.554, backward: 0.545, update: 0.240
Successfully xmh. training takes 100.57542681694031 seconds
before call kg_cache_controller.StopThreads()
W20240124 17:21:48.626664 12659 grad_async_v2.h:71] call StopThreads. PID = 51520
W20240124 17:21:48.626695 12659 grad_base.h:210] before processOneStepNegThread_.join();
W20240124 17:21:48.627808 12659 grad_base.h:212] after processOneStepNegThread_.join();
W20240124 17:21:48.627823 12659 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
W20240124 17:21:49.168659 12659 grad_async_v2.h:91] StopThreads done.
