WARNING: Logging before InitGoogleLogging() is written to STDERR
I20240124 23:37:27.714448 40937 IPC_barrier.h:128] MultiProcessBarrierFactory->ClearIPCMemory()
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/_deprecate/graph.py:1023: DGLWarning: multigraph will be deprecated.DGL will treat all graphs as multigraph in the future.
  dgl_warning("multigraph will be deprecated." \
/home/xieminhui/RecStore/src/framework_adapters/torch/kg/dgl-0.9.1/python/dgl/heterograph.py:72: DGLWarning: Recommend creating graphs by `dgl.graph(data)` instead of `dgl.DGLGraph(data)`.
  dgl_warning('Recommend creating graphs by `dgl.graph(data)`'
Reading train triples....
Finished. Read 304727650 train triples.
Reading valid triples....
Finished. Read 16929318 valid triples.
Reading test triples....
Finished. Read 16929308 test triples.
ARGS:  Namespace(model_name='DistMult', data_path='/home/xieminhui/dgl-data', dataset='Freebase', format='built_in', data_files=None, delimiter='\t', save_path='/tmp/ckpts/DistMult_Freebase_10', no_save_emb=True, max_step=500, batch_size=1600, batch_size_eval=16, neg_sample_size=200, neg_deg_sample=False, neg_deg_sample_eval=False, neg_sample_size_eval=86054151, eval_percent=1, no_eval_filter=False, log_interval=100, eval_interval=10000, test=False, num_proc=8, num_thread=1, force_sync_interval=1, hidden_dim=400, lr=0.01, gamma=16.0, double_ent=False, double_rel=False, neg_adversarial_sampling=False, adversarial_temperature=1.0, regularization_coef=0.0, regularization_norm=3, pairwise=False, loss_genre='Logsigmoid', margin=1.0, nr_gpus=8, gpu=[0, 1, 2, 3, 4, 5, 6, 7], mix_cpu_gpu=True, valid=False, rel_part=False, async_update=None, has_edge_importance=False, cached_emb_type='KnownLocalCachedEmbedding', use_my_emb=True, cache_ratio=0.05, shuffle=False, backwardMode='CppAsyncV2', L=10, kForwardItersPerStep=2, backgrad_init='both', eval_filter=True, soft_rel_part=False)
|Train|: 304727650
original graph:  DGLGraph(num_nodes=86054151, num_edges=338586276,
         ndata_schemes={}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Loading cached metis
WARNING [40937 sampler.py:454] Start PreSampling
WARNING [40937 sampler.py:532] Before construct renumbering_dict
WARNING [40937 sampler.py:555] PreSampling done
W20240124 23:51:08.020380 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_0 [100000]0x100000002000 781.2 kB
W20240124 23:51:08.020622 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_1 [100000]0x1000000c7000 781.2 kB
W20240124 23:51:08.020653 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_2 [100000]0x10000018c000 781.2 kB
W20240124 23:51:08.020690 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_3 [100000]0x100000251000 781.2 kB
W20240124 23:51:08.020722 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_4 [100000]0x100000316000 781.2 kB
W20240124 23:51:08.020752 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_5 [100000]0x1000003db000 781.2 kB
W20240124 23:51:08.020783 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_6 [100000]0x1000004a0000 781.2 kB
W20240124 23:51:08.020833 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_7 [100000]0x100000565000 781.2 kB
W20240124 23:51:08.020859 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_8 [100000]0x10000062a000 781.2 kB
W20240124 23:51:08.020886 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r0_9 [100000]0x1000006ef000 781.2 kB
W20240124 23:51:08.020917 40937 IPCTensor.h:365] NewIPCTensor: step_r0 [10]0x1000007b4000 80 B 
W20240124 23:51:08.020939 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r0 [1]0x1000007b6000 8 B 
W20240124 23:51:08.020965 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r0 [1]0x1000007b8000 8 B 
W20240124 23:51:08.021126 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_0 [100000]0x1000007ba000 781.2 kB
W20240124 23:51:08.021162 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_1 [100000]0x10000087f000 781.2 kB
W20240124 23:51:08.021186 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_2 [100000]0x100000944000 781.2 kB
W20240124 23:51:08.021225 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_3 [100000]0x100000a09000 781.2 kB
W20240124 23:51:08.021261 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_4 [100000]0x100000ace000 781.2 kB
W20240124 23:51:08.021291 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_5 [100000]0x100000b93000 781.2 kB
W20240124 23:51:08.021324 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_6 [100000]0x100000c58000 781.2 kB
W20240124 23:51:08.021350 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_7 [100000]0x100000d1d000 781.2 kB
W20240124 23:51:08.021371 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_8 [100000]0x100000de2000 781.2 kB
W20240124 23:51:08.021404 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r1_9 [100000]0x100000ea7000 781.2 kB
W20240124 23:51:08.021425 40937 IPCTensor.h:365] NewIPCTensor: step_r1 [10]0x100000f6c000 80 B 
W20240124 23:51:08.021445 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r1 [1]0x100000f6e000 8 B 
W20240124 23:51:08.021463 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r1 [1]0x100000f70000 8 B 
W20240124 23:51:08.021514 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_0 [100000]0x100000f72000 781.2 kB
W20240124 23:51:08.021548 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_1 [100000]0x100001037000 781.2 kB
W20240124 23:51:08.021569 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_2 [100000]0x1000010fc000 781.2 kB
W20240124 23:51:08.021595 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_3 [100000]0x1000011c1000 781.2 kB
W20240124 23:51:08.021616 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_4 [100000]0x100001286000 781.2 kB
W20240124 23:51:08.021646 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_5 [100000]0x10000134b000 781.2 kB
W20240124 23:51:08.021679 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_6 [100000]0x100001410000 781.2 kB
W20240124 23:51:08.021709 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_7 [100000]0x1000014d5000 781.2 kB
W20240124 23:51:08.021733 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_8 [100000]0x10000159a000 781.2 kB
W20240124 23:51:08.021761 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r2_9 [100000]0x10000165f000 781.2 kB
W20240124 23:51:08.021790 40937 IPCTensor.h:365] NewIPCTensor: step_r2 [10]0x100001724000 80 B 
W20240124 23:51:08.021809 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r2 [1]0x100001726000 8 B 
W20240124 23:51:08.021826 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r2 [1]0x100001728000 8 B 
W20240124 23:51:08.021875 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_0 [100000]0x10000172a000 781.2 kB
W20240124 23:51:08.021903 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_1 [100000]0x1000017ef000 781.2 kB
W20240124 23:51:08.021929 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_2 [100000]0x1000018b4000 781.2 kB
W20240124 23:51:08.021952 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_3 [100000]0x100001979000 781.2 kB
W20240124 23:51:08.021973 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_4 [100000]0x100001a3e000 781.2 kB
W20240124 23:51:08.022004 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_5 [100000]0x100001b03000 781.2 kB
W20240124 23:51:08.022025 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_6 [100000]0x100001bc8000 781.2 kB
W20240124 23:51:08.022053 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_7 [100000]0x100001c8d000 781.2 kB
W20240124 23:51:08.022076 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_8 [100000]0x100001d52000 781.2 kB
W20240124 23:51:08.022107 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r3_9 [100000]0x100001e17000 781.2 kB
W20240124 23:51:08.022130 40937 IPCTensor.h:365] NewIPCTensor: step_r3 [10]0x100001edc000 80 B 
W20240124 23:51:08.022148 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r3 [1]0x100001ede000 8 B 
W20240124 23:51:08.022167 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r3 [1]0x100001ee0000 8 B 
W20240124 23:51:08.022212 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_0 [100000]0x100001ee2000 781.2 kB
W20240124 23:51:08.022245 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_1 [100000]0x100001fa7000 781.2 kB
W20240124 23:51:08.022269 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_2 [100000]0x10000206c000 781.2 kB
W20240124 23:51:08.022291 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_3 [100000]0x100002131000 781.2 kB
W20240124 23:51:08.022315 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_4 [100000]0x1000021f6000 781.2 kB
W20240124 23:51:08.022343 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_5 [100000]0x1000022bb000 781.2 kB
W20240124 23:51:08.022370 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_6 [100000]0x100002380000 781.2 kB
W20240124 23:51:08.022392 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_7 [100000]0x100002445000 781.2 kB
W20240124 23:51:08.022416 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_8 [100000]0x10000250a000 781.2 kB
W20240124 23:51:08.022445 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r4_9 [100000]0x1000025cf000 781.2 kB
W20240124 23:51:08.022473 40937 IPCTensor.h:365] NewIPCTensor: step_r4 [10]0x100002694000 80 B 
W20240124 23:51:08.022491 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r4 [1]0x100002696000 8 B 
W20240124 23:51:08.022509 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r4 [1]0x100002698000 8 B 
W20240124 23:51:08.022552 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_0 [100000]0x10000269a000 781.2 kB
W20240124 23:51:08.022574 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_1 [100000]0x10000275f000 781.2 kB
W20240124 23:51:08.022604 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_2 [100000]0x100002824000 781.2 kB
W20240124 23:51:08.022632 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_3 [100000]0x1000028e9000 781.2 kB
W20240124 23:51:08.022657 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_4 [100000]0x1000029ae000 781.2 kB
W20240124 23:51:08.022679 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_5 [100000]0x100002a73000 781.2 kB
W20240124 23:51:08.022704 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_6 [100000]0x100002b38000 781.2 kB
W20240124 23:51:08.022735 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_7 [100000]0x100002bfd000 781.2 kB
W20240124 23:51:08.022758 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_8 [100000]0x100002cc2000 781.2 kB
W20240124 23:51:08.022784 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r5_9 [100000]0x100002d87000 781.2 kB
W20240124 23:51:08.022814 40937 IPCTensor.h:365] NewIPCTensor: step_r5 [10]0x100002e4c000 80 B 
W20240124 23:51:08.022831 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r5 [1]0x100002e4e000 8 B 
W20240124 23:51:08.022853 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r5 [1]0x100002e50000 8 B 
W20240124 23:51:08.022897 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_0 [100000]0x100002e52000 781.2 kB
W20240124 23:51:08.022920 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_1 [100000]0x100002f17000 781.2 kB
W20240124 23:51:08.022944 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_2 [100000]0x100002fdc000 781.2 kB
W20240124 23:51:08.022967 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_3 [100000]0x1000030a1000 781.2 kB
W20240124 23:51:08.022995 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_4 [100000]0x100003166000 781.2 kB
W20240124 23:51:08.023027 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_5 [100000]0x10000322b000 781.2 kB
W20240124 23:51:08.023048 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_6 [100000]0x1000032f0000 781.2 kB
W20240124 23:51:08.023072 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_7 [100000]0x1000033b5000 781.2 kB
W20240124 23:51:08.023093 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_8 [100000]0x10000347a000 781.2 kB
W20240124 23:51:08.023118 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r6_9 [100000]0x10000353f000 781.2 kB
W20240124 23:51:08.023139 40937 IPCTensor.h:365] NewIPCTensor: step_r6 [10]0x100003604000 80 B 
W20240124 23:51:08.023161 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r6 [1]0x100003606000 8 B 
W20240124 23:51:08.023180 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r6 [1]0x100003608000 8 B 
W20240124 23:51:08.023226 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_0 [100000]0x10000360a000 781.2 kB
W20240124 23:51:08.023259 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_1 [100000]0x1000036cf000 781.2 kB
W20240124 23:51:08.023283 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_2 [100000]0x100003794000 781.2 kB
W20240124 23:51:08.023304 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_3 [100000]0x100003859000 781.2 kB
W20240124 23:51:08.023329 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_4 [100000]0x10000391e000 781.2 kB
W20240124 23:51:08.023357 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_5 [100000]0x1000039e3000 781.2 kB
W20240124 23:51:08.023380 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_6 [100000]0x100003aa8000 781.2 kB
W20240124 23:51:08.023404 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_7 [100000]0x100003b6d000 781.2 kB
W20240124 23:51:08.023428 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_8 [100000]0x100003c32000 781.2 kB
W20240124 23:51:08.023450 40937 IPCTensor.h:365] NewIPCTensor: cached_sampler_r7_9 [100000]0x100003cf7000 781.2 kB
W20240124 23:51:08.023478 40937 IPCTensor.h:365] NewIPCTensor: step_r7 [10]0x100003dbc000 80 B 
W20240124 23:51:08.023497 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_r7 [1]0x100003dbe000 8 B 
W20240124 23:51:08.023514 40937 IPCTensor.h:365] NewIPCTensor: circle_buffer_end_cppseen_r7 [1]0x100003dc0000 8 B 
W20240124 23:51:08.349678 40937 IPCTensor.h:365] NewIPCTensor: full_emb [86054151, 400]0x100003dc2000 128.2 GB
W20240124 23:51:08.349858 40937 IPCTensor.h:365] NewIPCTensor: full_emb_SparseRowWiseAdaGrad_sum [86054151]0x1020129fa000 328.3 MB
{0: Graph(num_nodes=18933917, num_edges=55424977,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 1: Graph(num_nodes=13553612, num_edges=52144637,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 2: Graph(num_nodes=12534799, num_edges=46200271,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 3: Graph(num_nodes=12686041, num_edges=52326269,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 4: Graph(num_nodes=15590560, num_edges=56579771,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 5: Graph(num_nodes=14580085, num_edges=37397287,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 6: Graph(num_nodes=12323776, num_edges=47000589,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)}), 7: Graph(num_nodes=13847704, num_edges=34618513,
      ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_node': Scheme(shape=(), dtype=torch.int32), 'part_id': Scheme(shape=(), dtype=torch.int64)}
      edata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64), 'inner_edge': Scheme(shape=(), dtype=torch.int8)})}
MertisPartition: part 0 has 18933917 N 55424977 E
MertisPartition: part 1 has 13553612 N 52144637 E
MertisPartition: part 2 has 12534799 N 46200271 E
MertisPartition: part 3 has 12686041 N 52326269 E
MertisPartition: part 4 has 15590560 N 56579771 E
MertisPartition: part 5 has 14580085 N 37397287 E
MertisPartition: part 6 has 12323776 N 47000589 E
MertisPartition: part 7 has 13847704 N 34618513 E
Rank0: cached key size 537838
Rank1: cached key size 537838
Rank2: cached key size 537838
Rank3: cached key size 537838
Rank4: cached key size 537838
Rank5: cached key size 537838
Rank6: cached key size 537838
Rank7: cached key size 537838
Before renumbering graph:  {'_ID': tensor([       0,        1,        2,  ..., 20485189,  3195844, 27748820]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
After renumbering graph:  {'_ID': tensor([ 4302705,  4302711,  4302722,  ..., 54786587, 17995214, 27623839]), 'inner_node': tensor([1, 1, 1,  ..., 0, 0, 0], dtype=torch.int32), 'part_id': tensor([0, 0, 0,  ..., 4, 6, 4])}
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
part_g: DGLGraph(num_nodes=18933917, num_edges=55424977,
         ndata_schemes={'_ID': Scheme(shape=(), dtype=torch.int64)}
         edata_schemes={'tid': Scheme(shape=(), dtype=torch.int64)})
Total initialize time 999.010 seconds
[Rank1] pid = 54852
[Rank2] pid = 54952
[Rank3] pid = 55036
[Rank4] pid = 55107
[Rank5] pid = 55189
[Rank6] pid = 55276
INFO [40937 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 0
INFO [54852 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 1
INFO [54952 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 2
INFO [55036 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 3
INFO [55107 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 4
INFO [55189 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 5
INFO [55358 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 7
INFO [55276 distributed_c10d.py:442] Added key: store_based_barrier_key:1 to store for rank: 6
INFO [55276 distributed_c10d.py:476] Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55358 distributed_c10d.py:476] Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55189 distributed_c10d.py:476] Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [40937 distributed_c10d.py:476] Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [54852 distributed_c10d.py:476] Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55036 distributed_c10d.py:476] Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [55107 distributed_c10d.py:476] Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO [54952 distributed_c10d.py:476] Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
W20240124 23:54:14.987701 55277 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_6 [4302707, 400]; dev=6; size=6.412 GB
W20240124 23:54:14.988956 55359 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_0 [4302707, 400]; dev=0; size=6.412 GB
W20240124 23:54:14.989944 55422 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_7 [4302707, 400]; dev=7; size=6.412 GB
W20240124 23:54:14.991567 55192 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_5 [4302707, 400]; dev=5; size=6.412 GB
W20240124 23:54:14.991572 55109 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_4 [4302707, 400]; dev=4; size=6.412 GB
W20240124 23:54:14.991575 54853 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_1 [4302707, 400]; dev=1; size=6.412 GB
W20240124 23:54:14.991562 54953 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_2 [4302707, 400]; dev=2; size=6.412 GB
W20240124 23:54:14.991580 55037 IPCTensor.h:405] NewIPCGPUTensor: embedding_cache_3 [4302707, 400]; dev=3; size=6.412 GB
W20240124 23:54:15.126268 55422 IPCTensor.h:365] NewIPCTensor: input_keys_7 [100000]0x102027249000 781.2 kB
W20240124 23:54:15.126541 55277 IPCTensor.h:365] NewIPCTensor: input_keys_6 [100000]0x102027316000 781.2 kB
W20240124 23:54:15.126683 55037 IPCTensor.h:365] NewIPCTensor: input_keys_3 [100000]0x1020274a0000 781.2 kB
W20240124 23:54:15.126685 55109 IPCTensor.h:365] NewIPCTensor: input_keys_4 [100000]0x102027565000 781.2 kB
W20240124 23:54:15.126675 55192 IPCTensor.h:365] NewIPCTensor: input_keys_5 [100000]0x1020273db000 781.2 kB
W20240124 23:54:15.126705 55359 IPCTensor.h:365] NewIPCTensor: input_keys_0 [100000]0x10202762a000 781.2 kB
W20240124 23:54:15.126870 55422 IPCTensor.h:365] NewIPCTensor: input_keys_neg_7 [100000]0x1020276ef000 781.2 kB
W20240124 23:54:15.127014 54853 IPCTensor.h:365] NewIPCTensor: input_keys_1 [100000]0x1020277b4000 781.2 kB
W20240124 23:54:15.127051 55422 IPCTensor.h:365] NewIPCTensor: backward_grads_7 [100000, 400]0x10202793e000 152.6 MB
W20240124 23:54:15.127022 54953 IPCTensor.h:365] NewIPCTensor: input_keys_2 [100000]0x102027879000 781.2 kB
W20240124 23:54:15.127184 55422 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_7 [100000, 400]0x1020311d6000 152.6 MB
W20240124 23:54:15.127295 55422 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 23:54:15.127682 55109 IPCTensor.h:365] NewIPCTensor: input_keys_neg_4 [100000]0x10203ab33000 781.2 kB
W20240124 23:54:15.127679 55359 IPCTensor.h:365] NewIPCTensor: input_keys_neg_0 [100000]0x10203aa6e000 781.2 kB
W20240124 23:54:15.127765 55192 IPCTensor.h:365] NewIPCTensor: input_keys_neg_5 [100000]0x10203abf8000 781.2 kB
W20240124 23:54:15.127775 55277 IPCTensor.h:365] NewIPCTensor: input_keys_neg_6 [100000]0x10203acbd000 781.2 kB
W20240124 23:54:15.127851 55109 IPCTensor.h:365] NewIPCTensor: backward_grads_4 [100000, 400]0x10203ad82000 152.6 MB
W20240124 23:54:15.128296 55109 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_4 [100000, 400]0x10204461a000 152.6 MB
W20240124 23:54:15.128330 55359 IPCTensor.h:365] NewIPCTensor: backward_grads_0 [100000, 400]0x10204deb2000 152.6 MB
W20240124 23:54:15.128351 55192 IPCTensor.h:365] NewIPCTensor: backward_grads_5 [100000, 400]0x10205774a000 152.6 MB
W20240124 23:54:15.128397 54853 IPCTensor.h:365] NewIPCTensor: input_keys_neg_1 [100000]0x102060fe2000 781.2 kB
W20240124 23:54:15.128413 55037 IPCTensor.h:365] NewIPCTensor: input_keys_neg_3 [100000]0x10206116c000 781.2 kB
W20240124 23:54:15.128407 54953 IPCTensor.h:365] NewIPCTensor: input_keys_neg_2 [100000]0x1020610a7000 781.2 kB
W20240124 23:54:15.128423 55277 IPCTensor.h:365] NewIPCTensor: backward_grads_6 [100000, 400]0x102061231000 152.6 MB
W20240124 23:54:15.128465 55359 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_0 [100000, 400]0x10206aac9000 152.6 MB
W20240124 23:54:15.128476 55109 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 23:54:15.128502 55192 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_5 [100000, 400]0x102074361000 152.6 MB
W20240124 23:54:15.128551 55037 IPCTensor.h:365] NewIPCTensor: backward_grads_3 [100000, 400]0x10207dbf9000 152.6 MB
W20240124 23:54:15.128572 55359 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 23:54:15.128582 55277 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_6 [100000, 400]0x102087491000 152.6 MB
W20240124 23:54:15.128597 54953 IPCTensor.h:365] NewIPCTensor: backward_grads_2 [100000, 400]0x102090d29000 152.6 MB
W20240124 23:54:15.128608 55192 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 23:54:15.128628 55037 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_3 [100000, 400]0x10209a5c1000 152.6 MB
W20240124 23:54:15.128641 54853 IPCTensor.h:365] NewIPCTensor: backward_grads_1 [100000, 400]0x1020a3e59000 152.6 MB
W20240124 23:54:15.128671 55037 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 23:54:15.128701 55277 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 23:54:15.128752 54953 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_2 [100000, 400]0x1020ad6f1000 152.6 MB
W20240124 23:54:15.128849 54953 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 23:54:15.128860 54853 IPCTensor.h:365] NewIPCTensor: backward_grads_neg_1 [100000, 400]0x1020b6f89000 152.6 MB
W20240124 23:54:15.128939 54853 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_1_gpu [100000, 400]; dev=1; size=152.6 MB
W20240124 23:54:15.132496 55422 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_7_gpu [100000, 400]; dev=7; size=152.6 MB
W20240124 23:54:15.134421 55109 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_4_gpu [100000, 400]; dev=4; size=152.6 MB
W20240124 23:54:15.134932 55359 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_0_gpu [100000, 400]; dev=0; size=152.6 MB
W20240124 23:54:15.135005 55037 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_3_gpu [100000, 400]; dev=3; size=152.6 MB
W20240124 23:54:15.135080 55192 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_5_gpu [100000, 400]; dev=5; size=152.6 MB
W20240124 23:54:15.135114 55277 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_6_gpu [100000, 400]; dev=6; size=152.6 MB
W20240124 23:54:15.135138 54953 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_2_gpu [100000, 400]; dev=2; size=152.6 MB
W20240124 23:54:15.135396 54853 IPCTensor.h:405] NewIPCGPUTensor: backward_grads_neg_1_gpu [100000, 400]; dev=1; size=152.6 MB
cudaHostRegister 0x100003dc2000
5: KnownLocalCachedEmbedding init done
WARNING [55189 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
4: KnownLocalCachedEmbedding init done
WARNING [55107 DistTensor.py:56] The tensor name already exists in the kvstore
[Rank7] pid = 55358
New CachedEmbedding, name=full_emb, shape=(86054151, 400), cache_type=KnownLocalCachedEmbedding
fixed cache_range is [(0, 4302707), (4302707, 8605414), (8605414, 12908121), (12908121, 17210828), (17210828, 21513535), (21513535, 25816242), (25816242, 30118949), (30118949, 34421656)]
cudaHostRegister 0x100003dc2000
0: KnownLocalCachedEmbedding init done
WARNING [40937 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
3: KnownLocalCachedEmbedding init done
WARNING [55036 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
1: KnownLocalCachedEmbedding init done
cudaHostRegister 0x100003dc2000
7: KnownLocalCachedEmbedding init done
WARNING [54852 DistTensor.py:56] The tensor name already exists in the kvstore
WARNING [55358 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
2: KnownLocalCachedEmbedding init done
WARNING [54952 DistTensor.py:56] The tensor name already exists in the kvstore
cudaHostRegister 0x100003dc2000
6: KnownLocalCachedEmbedding init done
WARNING [55276 DistTensor.py:56] The tensor name already exists in the kvstore
I20240124 23:55:03.257364 55277 IPC_barrier.h:118] CreateBarrier: new barrier, name: kgcachecontroller, count: 8
I20240124 23:55:03.257405 54853 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 23:55:03.257449 55037 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 23:55:03.257481 55422 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 23:55:03.257515 55359 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 23:55:03.257542 55109 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 23:55:03.257578 55192 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
I20240124 23:55:03.257614 54953 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: kgcachecontroller, count: 8
W20240124 23:55:03.258814 55359 grad_base.h:55] KGCacheController, config={
        "num_gpus": 8,
        "L": 10,
        "backgrad_init": "both", 
        "kForwardItersPerStep": 2,
        "clr": 1,
        "nr_background_threads": 32,
        "backwardMode": "CppAsyncV2",
        "cache_ratio": 0.05
        }
W20240124 23:55:03.258911 55359 grad_base.h:172] Init GradProcessingBase done
I20240124 23:55:12.967995 55359 grad_async_v2.h:32] Use background thread to update emb. nr_background_threads=32
W20240124 23:55:12.968191 55359 kg_controller.h:78] after init GradAsyncProcessingV2
I20240124 23:55:12.968199 55359 kg_controller.h:84] Construct KGCacheController done
I20240124 23:55:13.730861 55359 grad_base.h:60] GraphEnv RegTensorsPerProcess
W20240124 23:55:31.858924 56497 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 23:55:31.859292 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 23:55:33.006201 56497 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 23:55:33.006445 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 23:55:34.870860 56497 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 23:55:34.870999 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 23:55:36.525375 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 23:55:36.534049 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 23:55:36.565176 55422 IPC_barrier.h:118] CreateBarrier: new barrier, name: start_barrier, count: 8
W20240124 23:55:38.064131 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 23:55:38.073463 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 23:55:38.110605 55192 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 23:55:39.591032 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 23:55:39.599967 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 23:55:39.633909 55109 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
I20240124 23:55:40.119563 54853 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240124 23:55:40.616590 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 23:55:40.754690 55359 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 23:55:40.811906 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
I20240124 23:55:41.046293 54953 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240124 23:55:41.616025 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 23:55:41.903244 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
I20240124 23:55:41.927938 55277 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
W20240124 23:55:44.188284 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 23:55:44.198285 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
I20240124 23:55:44.254240 55037 IPC_barrier.h:112] CreateBarrier: find existing barrier, name: start_barrier, count: 8
E20240124 23:55:45.198014 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
E20240124 23:55:46.256040 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=0
W20240124 23:55:46.381973 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=1, pq.top=1
W20240124 23:55:46.409474 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
E20240124 23:55:47.256021 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=2381
W20240124 23:55:47.381009 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=7, pq.top=7
W20240124 23:55:47.509263 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end8
E20240124 23:55:48.256021 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=18
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.935 ms                  | 86.067 ms                 |
| Forward                   | 4.854 ms                  | 653.432 ms                |
| Backward                  | 4.119 ms                  | 164.420 ms                |
| Optimize                  | 1.900 ms                  | 35.511 ms                 |
| BarrierTimeBeforeRank0    | 661.357 us                | 39.767 ms                 |
| AfterBackward             | 75.434 ms                 | 1.228 s                   |
| BlockToStepN              | 141.358 us                | 112.580 ms                |
| OneStep                   | 131.398 ms                | 2.152 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 23:55:48.492733 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=13, pq.top=13
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.126 ms                  | 383.500 ms                |
| ProcessBack:UpdateCache   | 11.370 ms                 | 712.863 ms                |
| ProcessBack:UpsertPq      | 42.822 ms                 | 125.345 ms                |
| ProcessOneStep            | 79.675 ms                 | 1.228 s                   |
| BlockToStepN              | 23.025 ms                 | 112.478 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:55:48.906059 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end4
E20240124 23:55:49.256019 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=2
W20240124 23:55:49.989583 56497 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end4
W20240124 23:55:50.225924 55359 grad_async_v2.h:236] pq is empty
E20240124 23:55:50.256027 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=7
W20240124 23:55:50.389569 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=15, pq.top=15
W20240124 23:55:51.056949 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
E20240124 23:55:51.256057 55796 parallel_pq_v2.h:76] insert failed, size(hashtable)=5778
W20240124 23:55:51.511790 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=21, pq.top=21
E20240124 23:55:52.256026 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=13672
W20240124 23:55:52.295951 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end5
W20240124 23:55:52.512306 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=27, pq.top=27
E20240124 23:55:53.256016 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 8.677 ms                  | 93.134 ms                 |
| Forward                   | 4.639 ms                  | 653.432 ms                |
| Backward                  | 4.179 ms                  | 164.420 ms                |
| Optimize                  | 2.007 ms                  | 35.511 ms                 |
| BarrierTimeBeforeRank0    | 53.949 us                 | 39.767 ms                 |
| AfterBackward             | 92.493 ms                 | 1.621 s                   |
| BlockToStepN              | 34.347 ms                 | 121.311 ms                |
| OneStep                   | 185.198 ms                | 2.152 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 23:55:53.467043 56497 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.242 ms                  | 382.848 ms                |
| ProcessBack:UpdateCache   | 10.576 ms                 | 712.844 ms                |
| ProcessBack:UpsertPq      | 44.427 ms                 | 118.848 ms                |
| ProcessOneStep            | 92.445 ms                 | 1.621 s                   |
| BlockToStepN              | 34.210 ms                 | 121.177 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:55:54.068312 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=29, pq.top=29
E20240124 23:55:54.256031 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=177
W20240124 23:55:54.618986 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end3
W20240124 23:55:55.068038 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=36, pq.top=36
E20240124 23:55:55.256028 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=1444
W20240124 23:55:55.871069 56497 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 23:55:56.256009 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=11
W20240124 23:55:56.937995 56497 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 23:55:57.117522 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=43, pq.top=43
E20240124 23:55:57.256029 55796 parallel_pq_v2.h:76] insert failed, size(hashtable)=9490
W20240124 23:55:58.117043 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=49, pq.top=49
W20240124 23:55:58.159533 56497 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
E20240124 23:55:58.256340 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=12210
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.280 ms                  | 93.134 ms                 |
| Forward                   | 4.633 ms                  | 653.432 ms                |
| Backward                  | 4.244 ms                  | 164.420 ms                |
| Optimize                  | 2.032 ms                  | 35.511 ms                 |
| BarrierTimeBeforeRank0    | 98.735 us                 | 39.767 ms                 |
| AfterBackward             | 92.554 ms                 | 1.621 s                   |
| BlockToStepN              | 23.779 ms                 | 121.311 ms                |
| OneStep                   | 164.597 ms                | 2.152 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.339 ms                  | 382.848 ms                |
| ProcessBack:UpdateCache   | 10.503 ms                 | 712.844 ms                |
| ProcessBack:UpsertPq      | 50.830 ms                 | 123.739 ms                |
| ProcessOneStep            | 92.445 ms                 | 1.311 s                   |
| BlockToStepN              | 28.763 ms                 | 115.437 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 23:55:59.256019 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=13
W20240124 23:55:59.307389 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
E20240124 23:56:00.256022 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=26
W20240124 23:56:00.307487 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 23:56:00.624634 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=57, pq.top=57
E20240124 23:56:01.256029 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=33302
W20240124 23:56:01.535892 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end3
W20240124 23:56:01.742827 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=64, pq.top=64
E20240124 23:56:02.256017 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=225
W20240124 23:56:02.824257 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end0
E20240124 23:56:03.256011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=18
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.927 ms                  | 88.456 ms                 |
| Forward                   | 4.633 ms                  | 7.539 ms                  |
| Backward                  | 4.361 ms                  | 9.868 ms                  |
| Optimize                  | 2.133 ms                  | 6.996 ms                  |
| BarrierTimeBeforeRank0    | 50.939 us                 | 36.453 ms                 |
| AfterBackward             | 101.145 ms                | 1.363 s                   |
| BlockToStepN              | 23.678 ms                 | 115.604 ms                |
| OneStep                   | 164.597 ms                | 1.679 s                   |
+---------------------------+---------------------------+---------------------------+
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.703 ms                  | 382.848 ms                |
| ProcessBack:UpdateCache   | 10.595 ms                 | 712.844 ms                |
| ProcessBack:UpsertPq      | 51.814 ms                 | 123.739 ms                |
| ProcessOneStep            | 101.088 ms                | 1.363 s                   |
| BlockToStepN              | 23.025 ms                 | 115.437 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:56:03.935616 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
W20240124 23:56:04.207924 55359 grad_async_v2.h:236] pq is empty
E20240124 23:56:04.256922 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 23:56:04.410130 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=71, pq.top=71
W20240124 23:56:05.085050 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
E20240124 23:56:05.256011 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=8097
W20240124 23:56:05.640444 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=79, pq.top=79
E20240124 23:56:06.256018 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=326
W20240124 23:56:06.304188 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end4
W20240124 23:56:07.243566 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=85, pq.top=85
E20240124 23:56:07.256004 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=30490
W20240124 23:56:07.310632 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end6
E20240124 23:56:08.256011 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=106
W20240124 23:56:08.261480 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=92, pq.top=92
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.372 ms                  | 93.134 ms                 |
| Forward                   | 4.633 ms                  | 18.729 ms                 |
| Backward                  | 4.332 ms                  | 9.868 ms                  |
| Optimize                  | 2.125 ms                  | 6.996 ms                  |
| BarrierTimeBeforeRank0    | 50.939 us                 | 39.767 ms                 |
| AfterBackward             | 92.554 ms                 | 1.594 s                   |
| BlockToStepN              | 23.779 ms                 | 115.604 ms                |
| OneStep                   | 163.784 ms                | 1.679 s                   |
+---------------------------+---------------------------+---------------------------+
W20240124 23:56:08.311800 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.432 ms                  | 40.335 ms                 |
| ProcessBack:UpdateCache   | 10.416 ms                 | 14.787 ms                 |
| ProcessBack:UpsertPq      | 50.762 ms                 | 118.848 ms                |
| ProcessOneStep            | 92.445 ms                 | 1.594 s                   |
| BlockToStepN              | 23.655 ms                 | 115.437 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:09.256021 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=26407
W20240124 23:56:09.261013 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=99, pq.top=99
W20240124 23:56:09.343667 56497 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end0
train_sampler.Prefill()
before start barrier
start train
[proc 4] 100 steps, total: 29.732, sample: 1.112, forward: 0.962, backward: 0.601, update: 0.233
train_sampler.Prefill()
before start barrier
start train
[proc 3] 100 steps, total: 25.112, sample: 1.141, forward: 0.962, backward: 0.675, update: 0.247
train_sampler.Prefill()
before start barrier
start train
[proc 1] 100 steps, total: 29.246, sample: 0.963, forward: 0.965, backward: 0.572, update: 0.252
train_sampler.Prefill()
before start barrier
start train
[proc 7] 100 steps, total: 32.801, sample: 0.904, forward: 0.900, backward: 0.565, update: 0.237
train_sampler.Prefill()
before start barrier
start train
[proc 2] 100 steps, total: 28.320, sample: 0.863, forward: 0.957, backward: 0.679, update: 0.286
train_sampler.Prefill()
before start barrier
start train
[proc 6] 100 steps, total: 27.438, sample: 1.027, forward: 1.130, backward: 0.606, update: 0.244
train_sampler.Prefill()
before start barrier
start train
[proc 5] 100 steps, total: 31.256, sample: 0.920, forward: 1.125, backward: 0.617, update: 0.247
train_sampler.Prefill()
-------Step 0-------
tensor([  529972,    80383,   418406, 14909418,    80440,    80467,   529981,
           80495,    80519,    80586]) tensor([ 5466250, 11324304, 45648811, 47254069, 17886901,   423654, 16591831,
        50570167, 44624911, 51900880])
-------Step 1-------
tensor([  529972,    80383,   418406, 14909418,    80440,    80467,   529981,
           80495,    80519,    80586]) tensor([72289859, 31994176, 45243176, 52692781, 57655512, 13058669, 43193243,
          613487, 21444008, 51795546])
-------Step 2-------
tensor([   25183,   393226,   366477, 14799650,   165218,   165262,   165296,
          165355,   165413,   165457]) tensor([45268848, 31872193,  1499143, 31983893, 20700949, 22785622,  7539590,
        52821759, 55454188, 26931406])
-------Step 3-------
tensor([   25183,   393226,   366477, 14799650,   165218,   165262,   165296,
          165355,   165413,   165457]) tensor([18210140, 83262440, 71541416, 44200720, 69147140, 72882912, 80609804,
        22245993, 66499149, 10816228])
-------Step 4-------
tensor([  251395,   251436,   251516, 85781734,   251546,   251577,   251611,
          251665,   251708, 23052661]) tensor([59027828, 49737484, 66468587, 34744742,   357957,  4335615, 21695254,
        58073161, 60343208, 10351729])
-------Step 5-------
tensor([  251395,   251436,   251516, 85781734,   251546,   251577,   251611,
          251665,   251708, 23052661]) tensor([38639913, 36993172, 41434938,    44239, 54504699, 61106662, 41228437,
         1354860, 79424468, 35703186])
-------Step 6-------
tensor([ 7432070,  6004655,   337145, 33237165,   337165,   337192, 71649383,
        33718614,   337222,   337251]) tensor([39620969,   142251, 56273428, 16652290, 19614028, 34021022, 16275911,
        69410725, 64430369, 48170886])
-------Step 7-------
tensor([ 7432070,  6004655,   337145, 33237165,   337165,   337192, 71649383,
        33718614,   337222,   337251]) tensor([26735194,  9000281, 38593248, 10988331, 56105334, 61235616,  4320371,
        14217737, 32985470, 78543264])
-------Step 8-------
tensor([  379461,   379481, 74061904,   379502,   418202,   418224, 11759679,
          379520,   379539,   369026]) tensor([20710469, 31274260, 55732716,  5211630, 75961556,  6276609,  5231078,
        13161818, 60333339,  5699897])
-------Step 9-------
tensor([  379461,   379481, 74061904,   379502,   418202,   418224, 11759679,
          379520,   379539,   369026]) tensor([76954613, 23595955, 58013045, 82956310, 49333837, 56574954, 77187807,
        13855813, 15578607,  7005087])
before start barrier
start train
[proc 0] 100 steps, total: 28.611, sample: 1.392, forward: 1.123, backward: 0.596, update: 0.265
E20240124 23:56:10.264117 55796 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 23:56:10.362560 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=107, pq.top=107
W20240124 23:56:10.523697 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end8
E20240124 23:56:11.271350 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=27
W20240124 23:56:11.369239 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=109, pq.top=109
W20240124 23:56:11.543421 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240124 23:56:12.271013 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=18278
W20240124 23:56:12.405716 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=116, pq.top=116
W20240124 23:56:12.621893 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.280 ms                  | 93.134 ms                 |
| Forward                   | 4.519 ms                  | 18.729 ms                 |
| Backward                  | 4.261 ms                  | 9.868 ms                  |
| Optimize                  | 2.125 ms                  | 6.996 ms                  |
| BarrierTimeBeforeRank0    | 72.686 us                 | 41.197 ms                 |
| AfterBackward             | 86.942 ms                 | 1.594 s                   |
| BlockToStepN              | 31.473 ms                 | 115.604 ms                |
| OneStep                   | 162.353 ms                | 1.679 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:13.271013 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=19827
W20240124 23:56:13.477895 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=123, pq.top=123
W20240124 23:56:13.714043 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.317 ms                  | 40.335 ms                 |
| ProcessBack:UpdateCache   | 10.042 ms                 | 14.787 ms                 |
| ProcessBack:UpsertPq      | 38.633 ms                 | 118.848 ms                |
| ProcessOneStep            | 86.157 ms                 | 1.594 s                   |
| BlockToStepN              | 31.374 ms                 | 121.177 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:14.271011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=52094
W20240124 23:56:14.563555 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=129, pq.top=129
W20240124 23:56:14.818506 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end1
E20240124 23:56:15.271909 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=37391
W20240124 23:56:15.563306 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=135, pq.top=135
W20240124 23:56:15.982367 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
E20240124 23:56:16.278380 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=1121
W20240124 23:56:16.871234 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=140, pq.top=140
W20240124 23:56:17.002385 56497 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end1
E20240124 23:56:17.278010 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=19273
W20240124 23:56:17.954214 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=147, pq.top=147
W20240124 23:56:18.014523 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 6.901 ms                  | 93.134 ms                 |
| Forward                   | 4.481 ms                  | 18.729 ms                 |
| Backward                  | 4.261 ms                  | 10.648 ms                 |
| Optimize                  | 2.099 ms                  | 6.996 ms                  |
| BarrierTimeBeforeRank0    | 82.729 us                 | 41.197 ms                 |
| AfterBackward             | 72.916 ms                 | 1.594 s                   |
| BlockToStepN              | 39.717 ms                 | 177.579 ms                |
| OneStep                   | 163.784 ms                | 1.679 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:18.278009 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=10
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.231 ms                  | 30.817 ms                 |
| ProcessBack:UpdateCache   | 10.013 ms                 | 14.657 ms                 |
| ProcessBack:UpsertPq      | 35.952 ms                 | 116.445 ms                |
| ProcessOneStep            | 72.875 ms                 | 1.363 s                   |
| BlockToStepN              | 39.613 ms                 | 171.494 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:56:18.954141 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=153, pq.top=153
W20240124 23:56:19.030867 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
E20240124 23:56:19.278009 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=6010
W20240124 23:56:19.972304 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=159, pq.top=159
W20240124 23:56:20.076912 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end0
E20240124 23:56:20.278012 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=21787
W20240124 23:56:21.051204 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=165, pq.top=165
W20240124 23:56:21.091892 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240124 23:56:21.283267 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=4470
W20240124 23:56:22.051023 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=171, pq.top=171
W20240124 23:56:22.108371 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
E20240124 23:56:22.283008 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=16829
W20240124 23:56:23.051453 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=177, pq.top=177
W20240124 23:56:23.210391 56497 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.162 ms                  | 93.134 ms                 |
| Forward                   | 4.463 ms                  | 7.539 ms                  |
| Backward                  | 4.261 ms                  | 9.868 ms                  |
| Optimize                  | 2.081 ms                  | 4.980 ms                  |
| BarrierTimeBeforeRank0    | 98.735 us                 | 40.588 ms                 |
| AfterBackward             | 70.308 ms                 | 1.363 s                   |
| BlockToStepN              | 42.917 ms                 | 180.844 ms                |
| OneStep                   | 163.784 ms                | 1.610 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:23.283008 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=5385
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 9.068 ms                  | 23.931 ms                 |
| ProcessBack:UpdateCache   | 9.666 ms                  | 14.441 ms                 |
| ProcessBack:UpsertPq      | 33.277 ms                 | 115.508 ms                |
| ProcessOneStep            | 71.066 ms                 | 1.363 s                   |
| BlockToStepN              | 42.863 ms                 | 180.698 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:56:24.051270 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=183, pq.top=183
W20240124 23:56:24.231624 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end4
E20240124 23:56:24.283071 55796 parallel_pq_v2.h:76] insert failed, size(hashtable)=37
W20240124 23:56:25.051380 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=189, pq.top=189
E20240124 23:56:25.283010 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=2573
W20240124 23:56:25.293934 56497 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end1
E20240124 23:56:26.283011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=5313
W20240124 23:56:26.328296 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
W20240124 23:56:26.562644 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=194, pq.top=194
E20240124 23:56:27.283008 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=7391
W20240124 23:56:27.363634 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end9
W20240124 23:56:27.616140 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=200, pq.top=200
[proc 5] 200 steps, total: 18.254, sample: 0.918, forward: 0.422, backward: 0.439, update: 0.203
[proc 7] 200 steps, total: 18.254, sample: 0.828, forward: 0.425, backward: 0.458, update: 0.197
[proc 1] 200 steps, total: 18.254, sample: 0.988, forward: 0.414, backward: 0.441, update: 0.202
[proc 2] 200 steps, total: 18.254, sample: 1.054, forward: 0.418, backward: 0.430, update: 0.210
[proc 4] 200 steps, total: 18.254, sample: 1.135, forward: 0.423, backward: 0.439, update: 0.201
[proc 6] 200 steps, total: 18.254, sample: 1.164, forward: 0.440, backward: 0.434, update: 0.248
[proc 3] 200 steps, total: 18.254, sample: 1.450, forward: 0.471, backward: 0.426, update: 0.216
[proc 0] 200 steps, total: 18.252, sample: 1.482, forward: 0.422, backward: 0.434, update: 0.208
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.336 ms                  | 93.134 ms                 |
| Forward                   | 4.463 ms                  | 7.539 ms                  |
| Backward                  | 4.235 ms                  | 9.868 ms                  |
| Optimize                  | 2.071 ms                  | 6.996 ms                  |
| BarrierTimeBeforeRank0    | 98.735 us                 | 41.197 ms                 |
| AfterBackward             | 69.097 ms                 | 1.363 s                   |
| BlockToStepN              | 43.844 ms                 | 183.785 ms                |
| OneStep                   | 165.412 ms                | 1.610 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:28.283010 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=19183
W20240124 23:56:28.363087 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.893 ms                  | 23.931 ms                 |
| ProcessBack:UpdateCache   | 9.712 ms                  | 14.441 ms                 |
| ProcessBack:UpsertPq      | 31.115 ms                 | 115.508 ms                |
| ProcessOneStep            | 69.247 ms                 | 1.363 s                   |
| BlockToStepN              | 43.678 ms                 | 183.662 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:56:28.849594 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=207, pq.top=207
E20240124 23:56:29.285063 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 23:56:29.423254 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end0
W20240124 23:56:29.849409 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=213, pq.top=213
E20240124 23:56:30.285017 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=54651
W20240124 23:56:30.547646 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
W20240124 23:56:30.849640 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=219, pq.top=219
E20240124 23:56:31.285012 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=45203
W20240124 23:56:31.590081 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end4
W20240124 23:56:31.938068 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=227, pq.top=227
E20240124 23:56:32.285010 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=52182
W20240124 23:56:32.611256 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
W20240124 23:56:33.079355 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=231, pq.top=231
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.433 ms                  | 93.134 ms                 |
| Forward                   | 4.474 ms                  | 7.539 ms                  |
| Backward                  | 4.235 ms                  | 9.868 ms                  |
| Optimize                  | 2.057 ms                  | 6.996 ms                  |
| BarrierTimeBeforeRank0    | 98.735 us                 | 41.197 ms                 |
| AfterBackward             | 68.105 ms                 | 1.363 s                   |
| BlockToStepN              | 44.689 ms                 | 197.212 ms                |
| OneStep                   | 166.486 ms                | 1.610 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:33.285010 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=1919
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.675 ms                  | 17.491 ms                 |
| ProcessBack:UpdateCache   | 9.566 ms                  | 14.386 ms                 |
| ProcessBack:UpsertPq      | 28.266 ms                 | 111.831 ms                |
| ProcessOneStep            | 67.876 ms                 | 1.363 s                   |
| BlockToStepN              | 44.614 ms                 | 197.073 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:56:33.748451 56497 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end5
W20240124 23:56:34.079116 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=237, pq.top=237
E20240124 23:56:34.285008 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=5067
W20240124 23:56:34.877167 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end3
W20240124 23:56:35.079574 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=245, pq.top=245
E20240124 23:56:35.285009 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=53350
W20240124 23:56:35.886763 56497 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end7
W20240124 23:56:36.120434 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=248, pq.top=248
E20240124 23:56:36.285559 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=13950
W20240124 23:56:36.936960 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end2
W20240124 23:56:37.168462 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=253, pq.top=253
E20240124 23:56:37.285009 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=50686
W20240124 23:56:37.988226 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end9
W20240124 23:56:38.168100 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=259, pq.top=259
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.728 ms                  | 90.528 ms                 |
| Forward                   | 4.467 ms                  | 7.429 ms                  |
| Backward                  | 4.232 ms                  | 8.148 ms                  |
| Optimize                  | 2.046 ms                  | 4.980 ms                  |
| BarrierTimeBeforeRank0    | 65.260 us                 | 41.197 ms                 |
| AfterBackward             | 66.687 ms                 | 1.311 s                   |
| BlockToStepN              | 48.333 ms                 | 209.740 ms                |
| OneStep                   | 166.486 ms                | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:38.289546 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=62886
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.597 ms                  | 17.491 ms                 |
| ProcessBack:UpdateCache   | 9.504 ms                  | 14.386 ms                 |
| ProcessBack:UpsertPq      | 26.660 ms                 | 111.831 ms                |
| ProcessOneStep            | 66.386 ms                 | 1.311 s                   |
| BlockToStepN              | 48.262 ms                 | 230.790 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:56:39.054715 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
W20240124 23:56:39.168660 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=265, pq.top=265
E20240124 23:56:39.289006 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=48545
W20240124 23:56:40.144893 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end1
W20240124 23:56:40.168522 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=271, pq.top=271
E20240124 23:56:40.289014 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=423
W20240124 23:56:41.168643 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=277, pq.top=277
E20240124 23:56:41.289009 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=61828
W20240124 23:56:41.297291 56497 grad_async_v2.h:120] Detect new sample comes, old_end0, new_end7
E20240124 23:56:42.289007 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=72457
W20240124 23:56:42.359275 56497 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240124 23:56:42.379549 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=281, pq.top=281
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.707 ms                  | 90.528 ms                 |
| Forward                   | 4.475 ms                  | 7.539 ms                  |
| Backward                  | 4.244 ms                  | 8.148 ms                  |
| Optimize                  | 2.072 ms                  | 4.980 ms                  |
| BarrierTimeBeforeRank0    | 73.070 us                 | 41.366 ms                 |
| AfterBackward             | 66.354 ms                 | 1.311 s                   |
| BlockToStepN              | 48.587 ms                 | 262.596 ms                |
| OneStep                   | 166.720 ms                | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:43.289011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=35601
W20240124 23:56:43.371620 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
W20240124 23:56:43.446097 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=286, pq.top=286
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.558 ms                  | 16.990 ms                 |
| ProcessBack:UpdateCache   | 9.374 ms                  | 14.386 ms                 |
| ProcessBack:UpsertPq      | 25.675 ms                 | 110.486 ms                |
| ProcessOneStep            | 66.312 ms                 | 1.311 s                   |
| BlockToStepN              | 48.694 ms                 | 262.448 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:44.289013 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=7582
W20240124 23:56:44.403123 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end1
W20240124 23:56:44.446416 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=291, pq.top=291
E20240124 23:56:45.289021 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=10842
W20240124 23:56:45.432638 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
W20240124 23:56:45.446560 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=297, pq.top=297
[proc 0] 300 steps, total: 18.278, sample: 1.643, forward: 0.441, backward: 0.433, update: 0.213
[proc 2] 300 steps, total: 18.278, sample: 0.886, forward: 0.443, backward: 0.477, update: 0.233
[proc 4] 300 steps, total: 18.278, sample: 0.993, forward: 0.435, backward: 0.443, update: 0.215
[proc 5] 300 steps, total: 18.278, sample: 0.915, forward: 0.426, backward: 0.443, update: 0.203
[proc 7] 300 steps, total: 18.278, sample: 0.855, forward: 0.455, backward: 0.414, update: 0.206
[proc 6] 300 steps, total: 18.278, sample: 0.980, forward: 0.424, backward: 0.444, update: 0.237
[proc 3] 300 steps, total: 18.278, sample: 1.133, forward: 0.428, backward: 0.431, update: 0.204
[proc 1] 300 steps, total: 18.278, sample: 0.946, forward: 0.411, backward: 0.449, update: 0.209
E20240124 23:56:46.289017 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=400
W20240124 23:56:46.446436 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=303, pq.top=303
W20240124 23:56:46.481916 56497 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end3
E20240124 23:56:47.289057 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=10462
W20240124 23:56:47.497530 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=309, pq.top=309
W20240124 23:56:47.517658 56497 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.807 ms                  | 90.528 ms                 |
| Forward                   | 4.474 ms                  | 7.539 ms                  |
| Backward                  | 4.235 ms                  | 8.148 ms                  |
| Optimize                  | 2.056 ms                  | 4.980 ms                  |
| BarrierTimeBeforeRank0    | 65.260 us                 | 41.366 ms                 |
| AfterBackward             | 66.051 ms                 | 1.311 s                   |
| BlockToStepN              | 51.189 ms                 | 262.596 ms                |
| OneStep                   | 168.237 ms                | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:48.289008 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=414
W20240124 23:56:48.497545 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=314, pq.top=314
W20240124 23:56:48.555711 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.542 ms                  | 17.491 ms                 |
| ProcessBack:UpdateCache   | 9.430 ms                  | 14.386 ms                 |
| ProcessBack:UpsertPq      | 26.332 ms                 | 110.486 ms                |
| ProcessOneStep            | 66.001 ms                 | 1.311 s                   |
| BlockToStepN              | 51.096 ms                 | 262.448 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:49.289012 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=8
W20240124 23:56:49.497727 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=319, pq.top=319
W20240124 23:56:49.651677 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end0
E20240124 23:56:50.289016 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=41251
W20240124 23:56:50.497699 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=325, pq.top=325
W20240124 23:56:50.678308 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
E20240124 23:56:51.289011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=12215
W20240124 23:56:51.542968 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=330, pq.top=330
W20240124 23:56:51.893747 56497 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end2
E20240124 23:56:52.289023 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=720
W20240124 23:56:52.914637 56497 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
W20240124 23:56:52.962100 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=333, pq.top=333
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.807 ms                  | 90.528 ms                 |
| Forward                   | 4.460 ms                  | 7.539 ms                  |
| Backward                  | 4.242 ms                  | 8.148 ms                  |
| Optimize                  | 2.044 ms                  | 4.980 ms                  |
| BarrierTimeBeforeRank0    | 65.002 us                 | 41.366 ms                 |
| AfterBackward             | 66.157 ms                 | 1.311 s                   |
| BlockToStepN              | 51.240 ms                 | 262.596 ms                |
| OneStep                   | 170.127 ms                | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:53.289011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=93846
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.542 ms                  | 16.990 ms                 |
| ProcessBack:UpdateCache   | 9.439 ms                  | 14.321 ms                 |
| ProcessBack:UpsertPq      | 26.660 ms                 | 108.690 ms                |
| ProcessOneStep            | 66.110 ms                 | 1.311 s                   |
| BlockToStepN              | 51.064 ms                 | 262.448 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:56:53.928197 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end8
W20240124 23:56:54.105718 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=339, pq.top=339
E20240124 23:56:54.289011 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=1542
W20240124 23:56:55.045495 56497 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end4
W20240124 23:56:55.138083 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=344, pq.top=343
E20240124 23:56:55.289011 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=7100
W20240124 23:56:56.125361 56497 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end1
W20240124 23:56:56.138921 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=351, pq.top=351
E20240124 23:56:56.289026 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=30405
W20240124 23:56:57.168165 56497 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
W20240124 23:56:57.209537 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=355, pq.top=355
E20240124 23:56:57.289011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=165842
W20240124 23:56:58.169246 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end6
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.914 ms                  | 90.528 ms                 |
| Forward                   | 4.454 ms                  | 7.539 ms                  |
| Backward                  | 4.242 ms                  | 7.906 ms                  |
| Optimize                  | 2.046 ms                  | 4.980 ms                  |
| BarrierTimeBeforeRank0    | 53.949 us                 | 41.197 ms                 |
| AfterBackward             | 66.312 ms                 | 1.228 s                   |
| BlockToStepN              | 51.240 ms                 | 364.709 ms                |
| OneStep                   | 170.165 ms                | 1.374 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:56:58.289171 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=1534
W20240124 23:56:58.634903 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=357, pq.top=357
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.517 ms                  | 16.990 ms                 |
| ProcessBack:UpdateCache   | 9.396 ms                  | 14.321 ms                 |
| ProcessBack:UpsertPq      | 26.826 ms                 | 111.831 ms                |
| ProcessOneStep            | 66.312 ms                 | 1.252 s                   |
| BlockToStepN              | 51.096 ms                 | 364.584 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:56:59.213778 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end1
E20240124 23:56:59.289016 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=10240
W20240124 23:56:59.634795 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=363, pq.top=363
E20240124 23:57:00.289011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=129789
W20240124 23:57:00.335601 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end9
W20240124 23:57:00.634691 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=371, pq.top=371
E20240124 23:57:01.289011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=51331
W20240124 23:57:01.497642 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end2
W20240124 23:57:01.775781 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=372, pq.top=372
E20240124 23:57:02.289019 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=29835
W20240124 23:57:02.517429 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end7
W20240124 23:57:02.775688 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=379, pq.top=379
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.807 ms                  | 90.528 ms                 |
| Forward                   | 4.440 ms                  | 7.539 ms                  |
| Backward                  | 4.242 ms                  | 7.906 ms                  |
| Optimize                  | 2.044 ms                  | 5.174 ms                  |
| BarrierTimeBeforeRank0    | 54.035 us                 | 41.366 ms                 |
| AfterBackward             | 65.868 ms                 | 1.252 s                   |
| BlockToStepN              | 51.189 ms                 | 364.709 ms                |
| OneStep                   | 169.398 ms                | 1.374 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:57:03.289011 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=90703
W20240124 23:57:03.593780 56497 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.461 ms                  | 16.755 ms                 |
| ProcessBack:UpdateCache   | 9.310 ms                  | 14.301 ms                 |
| ProcessBack:UpsertPq      | 26.332 ms                 | 110.486 ms                |
| ProcessOneStep            | 65.801 ms                 | 1.252 s                   |
| BlockToStepN              | 51.064 ms                 | 364.584 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:57:03.776499 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=385, pq.top=385
E20240124 23:57:04.289012 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=215627
W20240124 23:57:04.776048 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=391, pq.top=391
W20240124 23:57:04.852461 56497 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end1
E20240124 23:57:05.289013 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=66689
W20240124 23:57:05.913034 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end3
W20240124 23:57:05.955914 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=393, pq.top=393
E20240124 23:57:06.289013 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=27895
W20240124 23:57:06.933519 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end7
W20240124 23:57:06.955343 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=397, pq.top=397
E20240124 23:57:07.289011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=854
[proc 2] 400 steps, total: 21.588, sample: 0.894, forward: 0.427, backward: 0.423, update: 0.200
[proc 7] 400 steps, total: 21.588, sample: 0.782, forward: 0.449, backward: 0.407, update: 0.202
[proc 5] 400 steps, total: 21.588, sample: 0.915, forward: 0.442, backward: 0.490, update: 0.205
[proc 6] 400 steps, total: 21.588, sample: 0.966, forward: 0.451, backward: 0.451, update: 0.222
[proc 1] 400 steps, total: 21.588, sample: 1.070, forward: 0.411, backward: 0.495, update: 0.201
[proc 0] 400 steps, total: 21.588, sample: 1.594, forward: 0.461, backward: 0.434, update: 0.237
[proc 4] 400 steps, total: 21.588, sample: 0.950, forward: 0.427, backward: 0.433, update: 0.204
[proc 3] 400 steps, total: 21.588, sample: 1.088, forward: 0.435, backward: 0.454, update: 0.201
W20240124 23:57:07.955231 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=403, pq.top=403
W20240124 23:57:08.060145 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end4
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.766 ms                  | 90.528 ms                 |
| Forward                   | 4.467 ms                  | 8.854 ms                  |
| Backward                  | 4.240 ms                  | 7.906 ms                  |
| Optimize                  | 2.072 ms                  | 6.996 ms                  |
| BarrierTimeBeforeRank0    | 51.804 us                 | 41.366 ms                 |
| AfterBackward             | 66.051 ms                 | 1.252 s                   |
| BlockToStepN              | 50.679 ms                 | 458.858 ms                |
| OneStep                   | 168.531 ms                | 1.374 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:57:08.289009 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=14064
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.463 ms                  | 17.604 ms                 |
| ProcessBack:UpdateCache   | 9.278 ms                  | 14.321 ms                 |
| ProcessBack:UpsertPq      | 26.063 ms                 | 110.486 ms                |
| ProcessOneStep            | 65.828 ms                 | 1.252 s                   |
| BlockToStepN              | 50.540 ms                 | 458.706 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:57:08.955371 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=407, pq.top=407
W20240124 23:57:09.131062 56497 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end8
E20240124 23:57:09.289011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=31483
W20240124 23:57:10.047962 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=415, pq.top=415
W20240124 23:57:10.267078 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end6
E20240124 23:57:10.289009 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=10752
E20240124 23:57:11.292850 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=1
W20240124 23:57:11.306005 56497 grad_async_v2.h:120] Detect new sample comes, old_end3, new_end6
W20240124 23:57:11.440843 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=416, pq.top=416
E20240124 23:57:12.292016 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=13303
W20240124 23:57:12.377663 56497 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
W20240124 23:57:12.674544 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=423, pq.top=423
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.770 ms                  | 90.528 ms                 |
| Forward                   | 4.467 ms                  | 8.854 ms                  |
| Backward                  | 4.239 ms                  | 7.906 ms                  |
| Optimize                  | 2.063 ms                  | 6.996 ms                  |
| BarrierTimeBeforeRank0    | 51.804 us                 | 41.366 ms                 |
| AfterBackward             | 66.087 ms                 | 1.311 s                   |
| BlockToStepN              | 50.708 ms                 | 458.858 ms                |
| OneStep                   | 169.318 ms                | 1.374 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:57:13.292016 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=486
W20240124 23:57:13.395836 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
W20240124 23:57:13.674374 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=429, pq.top=429
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.454 ms                  | 17.491 ms                 |
| ProcessBack:UpdateCache   | 9.179 ms                  | 14.301 ms                 |
| ProcessBack:UpsertPq      | 26.660 ms                 | 110.486 ms                |
| ProcessOneStep            | 66.110 ms                 | 1.311 s                   |
| BlockToStepN              | 50.545 ms                 | 458.706 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 23:57:14.292016 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=6
W20240124 23:57:14.635830 56497 grad_async_v2.h:120] Detect new sample comes, old_end6, new_end5
E20240124 23:57:15.292016 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=3683
W20240124 23:57:15.673275 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=435, pq.top=435
W20240124 23:57:15.790827 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end6
E20240124 23:57:16.292034 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=14142
W20240124 23:57:16.319504 56496 HazptrDomain.h:767] 10 request backlog for hazptr asynchronous reclamation executor
W20240124 23:57:16.835379 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=441, pq.top=441
W20240124 23:57:16.850159 56497 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
E20240124 23:57:17.292018 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=27570
W20240124 23:57:17.836604 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=445, pq.top=445
W20240124 23:57:17.879873 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end5
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.771 ms                  | 93.134 ms                 |
| Forward                   | 4.475 ms                  | 8.854 ms                  |
| Backward                  | 4.247 ms                  | 8.148 ms                  |
| Optimize                  | 2.063 ms                  | 11.763 ms                 |
| BarrierTimeBeforeRank0    | 49.560 us                 | 41.366 ms                 |
| AfterBackward             | 66.580 ms                 | 1.311 s                   |
| BlockToStepN              | 50.679 ms                 | 458.858 ms                |
| OneStep                   | 169.318 ms                | 1.417 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:57:18.292038 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=11760
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.455 ms                  | 17.850 ms                 |
| ProcessBack:UpdateCache   | 9.147 ms                  | 14.321 ms                 |
| ProcessBack:UpsertPq      | 26.762 ms                 | 111.831 ms                |
| ProcessOneStep            | 66.532 ms                 | 1.311 s                   |
| BlockToStepN              | 50.540 ms                 | 458.706 ms                |
+---------------------------+---------------------------+---------------------------+
W20240124 23:57:18.836705 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=449, pq.top=449
W20240124 23:57:18.910693 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
E20240124 23:57:19.292016 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=31975
W20240124 23:57:19.874668 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=455, pq.top=455
W20240124 23:57:20.080669 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end5
E20240124 23:57:20.292011 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=4788
W20240124 23:57:20.934124 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=461, pq.top=461
W20240124 23:57:21.205878 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end2
E20240124 23:57:21.292011 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=11343
E20240124 23:57:22.300575 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=8078
W20240124 23:57:22.328267 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=462, pq.top=462
W20240124 23:57:22.332576 56497 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.770 ms                  | 90.528 ms                 |
| Forward                   | 4.466 ms                  | 8.380 ms                  |
| Backward                  | 4.239 ms                  | 7.906 ms                  |
| Optimize                  | 2.046 ms                  | 9.684 ms                  |
| BarrierTimeBeforeRank0    | 48.504 us                 | 41.366 ms                 |
| AfterBackward             | 66.682 ms                 | 1.266 s                   |
| BlockToStepN              | 50.679 ms                 | 395.615 ms                |
| OneStep                   | 169.398 ms                | 1.374 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:57:23.300017 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=172320
W20240124 23:57:23.329281 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=469, pq.top=469
W20240124 23:57:23.354852 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end9
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.423 ms                  | 17.850 ms                 |
| ProcessBack:UpdateCache   | 9.049 ms                  | 14.321 ms                 |
| ProcessBack:UpsertPq      | 26.660 ms                 | 115.508 ms                |
| ProcessOneStep            | 66.628 ms                 | 1.266 s                   |
| BlockToStepN              | 50.540 ms                 | 395.443 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 23:57:24.300031 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=69668
W20240124 23:57:24.329427 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=471, pq.top=471
W20240124 23:57:24.410090 56497 grad_async_v2.h:120] Detect new sample comes, old_end9, new_end2
E20240124 23:57:25.300015 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=18534
W20240124 23:57:25.329447 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=475, pq.top=475
W20240124 23:57:25.442449 56497 grad_async_v2.h:120] Detect new sample comes, old_end4, new_end5
E20240124 23:57:26.300012 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=169192
W20240124 23:57:26.411015 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=481, pq.top=481
W20240124 23:57:26.445919 56497 grad_async_v2.h:120] Detect new sample comes, old_end8, new_end1
E20240124 23:57:27.300007 55359 parallel_pq_v2.h:76] insert failed, size(hashtable)=4370
W20240124 23:57:27.411564 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=487, pq.top=487
W20240124 23:57:27.527596 56497 grad_async_v2.h:120] Detect new sample comes, old_end1, new_end7
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| GenInput                  | 7.766 ms                  | 93.134 ms                 |
| Forward                   | 4.467 ms                  | 8.380 ms                  |
| Backward                  | 4.244 ms                  | 7.906 ms                  |
| Optimize                  | 2.046 ms                  | 9.684 ms                  |
| BarrierTimeBeforeRank0    | 47.388 us                 | 41.366 ms                 |
| AfterBackward             | 66.687 ms                 | 1.266 s                   |
| BlockToStepN              | 50.679 ms                 | 458.858 ms                |
| OneStep                   | 170.127 ms                | 1.374 s                   |
+---------------------------+---------------------------+---------------------------+
E20240124 23:57:28.335283 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=99555
W20240124 23:57:28.484995 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=488, pq.top=487
W20240124 23:57:28.536653 56497 grad_async_v2.h:120] Detect new sample comes, old_end7, new_end8
+---------------------------+---------------------------+---------------------------+
| Name                      | P50                       | P99                       |
+---------------------------+---------------------------+---------------------------+
| ProcessBack:Shuffle       | 8.406 ms                  | 17.604 ms                 |
| ProcessBack:UpdateCache   | 8.995 ms                  | 14.301 ms                 |
| ProcessBack:UpsertPq      | 26.601 ms                 | 116.445 ms                |
| ProcessOneStep            | 66.644 ms                 | 1.266 s                   |
| BlockToStepN              | 50.545 ms                 | 577.203 ms                |
+---------------------------+---------------------------+---------------------------+
E20240124 23:57:29.335039 56497 parallel_pq_v2.h:76] insert failed, size(hashtable)=15957
W20240124 23:57:29.484656 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=492, pq.top=492
W20240124 23:57:29.570607 56497 grad_async_v2.h:120] Detect new sample comes, old_end2, new_end3
E20240124 23:57:30.335011 56496 parallel_pq_v2.h:76] insert failed, size(hashtable)=168505
W20240124 23:57:30.493470 55359 grad_async_v2.h:249] Sleep in <BlockToStepN>, step_no=499, pq.top=499
W20240124 23:57:30.598480 56497 grad_async_v2.h:120] Detect new sample comes, old_end5, new_end0
[proc 1] 500 steps, total: 23.197, sample: 0.940, forward: 0.428, backward: 0.412, update: 0.211
[proc 6] 500 steps, total: 23.197, sample: 0.980, forward: 0.458, backward: 0.489, update: 0.206
[proc 2] 500 steps, total: 23.197, sample: 0.897, forward: 0.460, backward: 0.446, update: 0.203
[proc 0] 500 steps, total: 23.197, sample: 1.650, forward: 0.458, backward: 0.454, update: 0.221
[proc 3] 500 steps, total: 23.197, sample: 1.038, forward: 0.432, backward: 0.427, update: 0.221
[proc 4] 500 steps, total: 23.197, sample: 0.938, forward: 0.427, backward: 0.481, update: 0.202
[proc 7] 500 steps, total: 23.197, sample: 0.801, forward: 0.448, backward: 0.422, update: 0.218
[proc 5] 500 steps, total: 23.197, sample: 0.856, forward: 0.472, backward: 0.452, update: 0.204
Successfully xmh. training takes 109.92854356765747 seconds
before call kg_cache_controller.StopThreads()
W20240124 23:57:30.683279 55359 grad_async_v2.h:71] call StopThreads. PID = 40937
W20240124 23:57:30.683321 55359 grad_base.h:210] before processOneStepNegThread_.join();
W20240124 23:57:30.683903 55359 grad_base.h:212] after processOneStepNegThread_.join();
W20240124 23:57:30.683928 55359 grad_async_v2.h:73] call GradProcessingBase::StopThreads.
